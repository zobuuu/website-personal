;/*FB_PKG_DELIM*/

__d("WAWebAddonConstants",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["Unified","Pin","Comment","PollVote","Reaction","EventResponse","None"]);c=b("$InternalEnum").Mirrored(["OnlineReceive","HistorySync","Send","SendRevoke","SendRetry","Revoke","DeleteForMe","DeleteWithParent","Hydration","MarkAsRead","SetAck"]);d=Object.freeze({Regular:"Regular",WithRevokes:"WithRevokes",DualEncrypted:"DualEncrypted",DualEncryptedWithMessageTraits:"DualEncryptedWithMessageTraits"});e=Object.freeze({PinInChat:1});f.AddonTableMode=a;f.AddonProcessMode=c;f.AddonProcessorType=d;f.AddonMinimizedType=e}),66);
__d("WAWebAddonLogUtils",[],(function(a,b,c,d,e,f){function a(a){return a.some(function(a){return a.status==="rejected"})}f.hasSettledWithError=a}),66);
__d("WAWebMsgKeyNewId",["WABinary","WAHex","WATimeUtils","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=function(){var a=d("WATimeUtils").unixTime(),b=d("WAWebUserPrefsMeUser").getMeUser().toString(),c=d("WAHex").parseHex(d("WAHex").randomHex(16)),e=new(d("WABinary").Binary)();e.writeInt64(a);e.writeString(b);e.writeBuffer(c);return e.readByteArray()};a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=new Uint8Array(yield self.crypto.subtle.digest("SHA-256",h()),0,9);return"3EB0"+d("WAHex").toHex(a)});return function(){return a.apply(this,arguments)}}();g.genMsgKeyUint=h;g.getMsgKeyNewSHA256Id=a}),98);
__d("WAWebMsgKey",["WAHex","WALogger","WAWebMsgKeyNewId","WAWebParseMsgKeyString","WAWebUserPrefsMeUser","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["getMsgKeyNewId: ",", message: ",", stack: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[msg-key] generated ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Incorrect Wid MsgKey: remote:"," p:",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["MsgKey case error: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Incorrect Wid MsgKey: from:"," to:"," p:",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["No matching constructor MsgKey: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unclear constructor MsgKey: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["MsgKey error: id is already a MsgKey"]);o=function(){return a};return a}a=function(){function a(b){b=b;if(!b)throw c("err")("MsgKey error: obj is null/undefined");b.id instanceof a&&(b=b.id,d("WALogger").WARN(o()));var e=b.from&&b.to&&b.id,f=b.fromMe!==void 0&&b.remote&&b.id,g,h,i,p,q,r,s,t=d("WAWebUserPrefsMeUser").getMaybeMeUser();if(!t)throw c("err")("MsgKey error: me is undefined. Running tests? Call setupGlobalsForTests first.");else if(e&&f){d("WALogger").WARN(n(),JSON.stringify(b));throw c("err")("MsgKey error: unclear which constructor to use")}else if(!e&&!f){d("WALogger").WARN(m(),JSON.stringify(b));throw c("err")("MsgKey error: don't have a matching constructor")}else if(e){e=b;g=e.from;h=e.to;i=e.id;p=e.participant;q=e.selfDir;if(!(g instanceof c("WAWebWid"))||!(h instanceof c("WAWebWid"))||p&&!(p instanceof c("WAWebWid"))){d("WALogger").WARN(l(),String(g),String(h),String(p));throw c("err")("MsgKey error: something is not a wid")}e=c("WAWebWid").equals(g,h);q=e?q:void 0;e&&d("WAWebUserPrefsMeUser").isMePrimary(g)?(r=q==="out",s=t):d("WAWebUserPrefsMeUser").isMePrimary(g)?(r=!0,s=h):d("WAWebUserPrefsMeUser").isMePrimary(h)?(r=!1,s=g):e&&(c("WAWebWid").isGroup(g)||c("WAWebWid").isBroadcast(g))?(r=!0,s=g):d("WALogger").WARN(k(),[g,h,i,t].join());r!==void 0&&(this.fromMe=r);s&&(this.remote=s);i&&(this.id=i)}else if(f){e=b;r=e.fromMe;s=e.remote;i=e.id;p=e.participant;if(!(s instanceof c("WAWebWid"))||p&&!(p instanceof c("WAWebWid"))){d("WALogger").WARN(j(),String(s),String(p));throw c("err")("MsgKey error: something is not a wid")}d("WAWebUserPrefsMeUser").isMePrimary(s)&&(q=r===!0?"out":"in");r!==void 0&&(this.fromMe=r);s&&(this.remote=s);i&&(this.id=i)}g=[this.fromMe,this.remote,this.id];q!==void 0&&(this.self=q,g.push(this.self));p!==void 0&&(this.participant=p,g.push(this.participant));this._serialized=g.join("_")}var e=a.prototype;e.toString=function(){return this._serialized};e.clone=function(){return new a({fromMe:this.fromMe,remote:this.remote,id:this.id,participant:this.participant})};e.equals=function(b){return b instanceof a&&this.toString()===b.toString()};a.fromString=function(b){if(b==null)throw c("err")("MsgKey.fromString error: str is null or not a string");return a.from(b)};a.from=function(b){if(b instanceof a)return b;var e;typeof b==="string"?e=c("WAWebParseMsgKeyString")(b):e=b;return new a({fromMe:e.fromMe,remote:d("WAWebWidFactory").createWidFromWidLike(e.remote),id:e.id,participant:e.participant?d("WAWebWidFactory").createWidFromWidLike(e.participant):void 0})};a.newId=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var b=(yield d("WAWebMsgKeyNewId").getMsgKeyNewSHA256Id());d("WALogger").DEV(i(),b);return b}catch(b){d("WALogger").ERROR(h(),b.name,b.message,b.stack).devConsole(b).sendLogs("msg_key: error generating sha256 message key");return a.newId_DEPRECATED()}});function e(){return c.apply(this,arguments)}return e}();a.newId_DEPRECATED=function(){return"3EB0"+d("WAHex").randomHex(8)};return a}();g["default"]=a}),98);
__d("WAWebAddonDeleteMsgs",["Promise","WALogger","WAWebAddonConstants","WAWebAddonDBTable","WAWebAddonLogUtils","WAWebAddonPerfUtils","WAWebAddonUpdateDataUtils","WAWebMsgKey","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["delete addons finished with errors"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["deleteAddonMsgsByParentKeys for ",": ",""]);j=function(){return a};return a}function k(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e;try{e=(yield (h||(h=b("Promise"))).all(c.map(function(b){return d("WAWebAddonDBTable").addonInternalDBTable.bulkGetByParentMsgKey(a,[b])})).then(function(a){var b;return(b=[]).concat.apply(b,a)}))}catch(a){return}if(e.length===0)return;c=(yield d("WAWebAddonPerfUtils").createAddonQplMarker(d("WAWebAddonPerfUtils").AddonQplMarkerType.UI,{mode:a,type:d("WAWebAddonPerfUtils").AnnotationRequestType.BulkRemoveByParents,size:e.length}));try{yield d("WAWebAddonUpdateDataUtils").updateAddonsInTableMode({processMode:d("WAWebAddonConstants").AddonProcessMode.DeleteWithParent,tableMode:a},{remove:e}),c==null?void 0:c.success()}catch(b){d("WALogger").WARN(j(),a,b);c==null?void 0:c.fail();throw b}});return l.apply(this,arguments)}function a(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.parentMsgKeys;a=a.map(function(a){return c("WAWebMsgKey").fromString(a)});var e=[];for(var f of d("WAWebAddonConstants").AddonTableMode.members())f!==d("WAWebAddonConstants").AddonTableMode.None&&e.push(k(f,a));a=(yield (h||(h=b("Promise"))).allSettled(e));d("WAWebAddonLogUtils").hasSettledWithError(a)&&d("WALogger").WARN(i()).tags("addons","messaging").sendLogs("deleteAddonMsgsByParentKeys")});return m.apply(this,arguments)}g.deleteAddonMsgsByParentKeys=a}),98);
__d("WAWebAddonCrossWindowUtils",[],(function(a,b,c,d,e,f){function g(a){if(a.realType!=null)return a.realType;return a.revokeAddonType!=null?a.revokeAddonType:a.type}function a(a){return a.type===g(a)}function b(a){a=g(a);switch(a){case"pin_message":case"reaction":case"reaction_enc":case"comment":case"event_edit_encrypted":case"event_response":case"poll_update":return!0;case"keep_in_chat":case"unknown":return!1;default:a;return!1}}f.getAddonProcessorType=g;f.isRealAddonType=a;f.isInfraSupportedAddon=b}),66);
__d("WAWebAddonEncryptAddonMsgData",["WAWebAddonCrossWindowUtils","WAWebAddonPluginProcessor","WAWebAddonProcessRevokeDataUtils","WAWebMsgType"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WAWebAddonCrossWindowUtils").getAddonProcessorType(a);if(a.type!==b)return a.kind===d("WAWebMsgType").MsgKind.ProtocolAddonRevoke?d("WAWebAddonProcessRevokeDataUtils").protocolRevokeToRevokeMsgData(a):a}function a(a,b){var c=h(a);if(c!=null)return;c=d("WAWebAddonPluginProcessor").getAddonProcessor(a);c=c.convert;var e=c.toDualEncryptedMsgData,f=c.toDualDecryptedMsgData;if(e==null||f==null)return;return{decrypt:function(){return f(a,b)},encrypt:function(){return e(a,b)}}}g.createDualEncryptionHelper=a}),98);
__d("WAWebAddonMarkAsReadUtils",["WALogger","WAWebAddonConstants","WAWebAddonSelectUtils","WAWebAddonUpdateDataUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["processMarkAsRead update failed ",""]);h=function(){return a};return a}a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.map(function(a){return a.read!=null?babelHelpers["extends"]({},a,{read:!0}):a});try{a=d("WAWebAddonSelectUtils").getAddonTableMode(a[0]);yield d("WAWebAddonUpdateDataUtils").updateAddonsInTableMode({processMode:d("WAWebAddonConstants").AddonProcessMode.MarkAsRead,tableMode:a},{add:b})}catch(a){d("WALogger").ERROR(h(),a).tags("addons","messaging").sendLogs("processMarkAsRead")}});return function(b){return a.apply(this,arguments)}}();g.processMarkAsRead=a}),98);
__d("WAWebWamEnumDeviceType",[],(function(a,b,c,d,e,f){a=Object.freeze({PRIMARY:1,COMPANION:2});f.DEVICE_TYPE=a}),66);
__d("WAWebWamEnumDsmError",[],(function(a,b,c,d,e,f){a=Object.freeze({INVALID_SENDER:1,MISSING_DSM:2,INVALID_DSM:3});f.DSM_ERROR=a}),66);
__d("WAWebWamEnumEditType",[],(function(a,b,c,d,e,f){a=Object.freeze({NOT_EDITED:0,EDITED:1,SENDER_REVOKE:2,ADMIN_REVOKE:3,ADMIN_EDIT:4,PIN:5});f.EDIT_TYPE=a}),66);
__d("WAWebWamEnumMediaType",[],(function(a,b,c,d,e,f){a=Object.freeze({NONE:1,PHOTO:2,VIDEO:3,AUDIO:4,PTT:5,LOCATION:6,CONTACT:7,DOCUMENT:8,URL:9,CALL:10,GIF:11,FUTURE:12,CONTACT_ARRAY:13,LIVE_LOCATION:14,PROFILE_PIC:15,STICKER:16,HSM:17,PRODUCT_IMAGE:18,TEMPLATE:19,MD_APP_STATE:20,MD_HISTORY_SYNC:21,CATALOG_LINK:22,PRODUCT_LINK:23,ORDER:24,LIST:25,LIST_REPLY:26,BUTTON_MESSAGE:27,BUTTON_RESPONSE_MESSAGE:28,PRODUCT_LIST:29,BUTTON_NFM:30,VIEW_ONCE_IMAGE:31,VIEW_ONCE_VIDEO:32,SHOP_STOREFRONT:33,REACTION:34,INTERACTIVE_NFM:35,INTERACTIVE_RESPONSE_NFM:36,POLL_CREATE:37,POLL_VOTE:38,TEXT:39,KEEP:40,UNKEEP:41,INVISIBLE_HELLO:42,MEDIA_EXPRESS_NOTIFY:43,UNDECRYPTED_MEDIA:44,UNDECRYPTED_TEXT:45,UNDECRYPTED_PAY:46,UNDECRYPTED_POLL:47,UNDECRYPTED_REACTION:48,UNDECRYPTED_MEDIA_NOTIFY:49,VIEW_ONCE_AUDIO:50,SCHEDULED_CALL_CREATE:51,SCHEDULED_CALL_CANCEL:52,PUSH_TO_VIDEO:53,PIN_IN_CHAT:54,INTERACTIVE_CAROUSEL:55,COMMENT:56,EPHEMERAL_SYNC_RESPONSE:57,EVENT_CREATE:58,EVENT_RESPOND:59,LOTTIE_STICKER:60,INTERACTIVE_PRODUCT_CAROUSEL:61,INTERACTIVE_PRODUCT:62,MEDIA_ALBUM:63,STICKER_PACK:64,POLL_RESULT_SNAPSHOT:65,MUSIC_ARTWORK:66});f.MEDIA_TYPE=a}),66);
__d("WAWebWamEnumMessageType",[],(function(a,b,c,d,e,f){a=Object.freeze({INDIVIDUAL:1,GROUP:2,BROADCAST:3,STATUS:4,CHANNEL:5,INTEROP:6});f.MESSAGE_TYPE=a}),66);
__d("WAWebWamEnumRevokeType",[],(function(a,b,c,d,e,f){a=Object.freeze({SENDER:0,ADMIN:1});f.REVOKE_TYPE=a}),66);
__d("WAWebMdBadDeviceSentMessageWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumDeviceType","WAWebWamEnumDsmError","WAWebWamEnumEditType","WAWebWamEnumMediaType","WAWebWamEnumMessageType","WAWebWamEnumRevokeType"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({MdBadDeviceSentMessage:[2176,{dsmError:[2,d("WAWebWamEnumDsmError").DSM_ERROR],editType:[3,d("WAWebWamEnumEditType").EDIT_TYPE],isLid:[4,d("WAWebWamCodegenUtils").TYPES.BOOLEAN],mediaType:[5,d("WAWebWamEnumMediaType").MEDIA_TYPE],messageType:[6,d("WAWebWamEnumMessageType").MESSAGE_TYPE],peerType:[1,d("WAWebWamEnumDeviceType").DEVICE_TYPE],revokeType:[7,d("WAWebWamEnumRevokeType").REVOKE_TYPE]},[1,1,1],"regular"]},{MdBadDeviceSentMessage:[]});g.MdBadDeviceSentMessageWamEvent=a}),98);
__d("WAWebWamEnumE2eFailureReason",[],(function(a,b,c,d,e,f){a=Object.freeze({INVALID_MESSAGE:0,LEGACY_MESSAGE:1,INVALID_VERSION:2,PRE_KEY_MESSAGE_MISSING_PRE_KEY:3,PRE_KEY_MESSAGE_INVALID_KEY:4,UNTRUSTED_IDENTITY:5,NO_SESSION_AVAILABLE:6,PLAINTEXT_BYTE_MISMATCH:7,UNKNOWN_CIPHERTEXT_TYPE:8,UNKNOWN_CIPHERTEXT_VERSION:9,INVALID_PADDING:10,INVALID_PROTOCOL_BUFFER:11,INVALID_NUMBER_OF_MESSAGE_TYPES:12,INVALID_IMAGE_FILE_LENGTH:13,INVALID_IMAGE_FILE_SHA256:14,INVALID_IMAGE_MEDIA_URL:15,INVALID_IMAGE_MEDIA_KEY:16,INVALID_IMAGE_MIME_TYPE:17,UNKNOWN_V2_TAGS:18,INVALID_EDIT_VERSION:19,INVALID_HSM_NAMESPACE:20,INVALID_HSM_ELEMENT:21,UNKNOWN_PROTOCOL_MESSAGE_TYPE:22,DUPLICATE_MESSAGE:23,FINGERPRINT_IDENTITY_MISMATCH:24,FINGERPRINT_VERSION_MISMATCH:25,INVALID_ARGUMENT:26,INVALID_KEY:27,INVALID_KEY_ID:28,INVALID_MAC:29,NO_MEMORY:30,STALE_KEY_EXCHANGE:31,VRF_SIGNATURE_VERIFICATION_FAILED:32,ERROR_MINIMUM_VALUE:33,ERROR_UNKNOWN:34,INVALID_BROADCAST_STANZA_ATTRIBUTE:35,INVALID_LIST_REPLY_MESSAGE:36,INVALID_LIST_REPLY_ROW_IDENTIFIER:37,INVALID_BUTTONS_RESPONSE_MESSAGE:38,INVALID_BUTTONS_RESPONSE_BUTTON_IDENTIFIER:39,INVALID_ORDER_MESSAGE:40,ERROR_CANCELLED:41,FUTURE_MESSAGE:42,INVALID_EMPTY_PROTOBUF_NOT_ALLOWED:43,SELF_SEND:44,INVALID_MEDIA_MIME_TYPE_TEMPLATE_MESSAGE:45,INVALID_MEDIA_ENC_HASH:46,INVALID_IDENTITY:47,PASSTHROUGH:48,NOT_IN_PENDING_DEVICES:49,EDIT_TYPE_AND_PROTOCOL_MISMATCH:50,DECRYPTION_FAILED:51,DESERIALIZE_INVALID_PROTO_FORMAT:52,DESERIALIZE_RATCHET_KEY_BAD_FORMAT:53,DESERIALIZE_PK_INVALID_PROTO_FORMAT:54,DESERIALZE_PK_KEY_BAD_FORMAT:55,TOO_MANY_MESSAGES_IN_FUTURE:56,EMPTY_VERSION_CONTENT_SUFFIX:57,CONTENT_EXCEEDED_EXPECTED_LENGTH:58,GRP_INVALID_PROTO_FORMAT:59,GRP_INVALID_KEY_FORMAT:60,GRP_VERSION_CONTENT_EMPTY:61,GRP_INVALID_VERSION_CONTENT_LENGTH:62,GRP_SENDER_KEY_INVALID_PROTO_FORMAT:63,GRP_SENDER_KEY_PROTO_ERROR:64,GRP_TOO_MANY_MESSAGES_IN_FUTURE:65,MISSING_MESSAGE_SECRET:66,MESSAGE_SECRET_INVALID:67,INVALID_REACTION_TEXT:68,UNSUPPORTED_MESSAGE_TYPE:69,UNSUPPORTED_IN_INTEROP:70,TARGET_MESSAGE_NOT_FOUND:71,STATUS_FROM_HOSTED_DEVICE_UNSUPPORTED:72,GROUP_MESSAGE_FROM_HOSTED_DEVICE_UNSUPPORTED:73,BROADCAST_FROM_HOSTED_DEVICE_UNSUPPORTED:74,LIVE_LOCATION_FROM_HOSTED_DEVICE_UNSUPPORTED:75,MESSAGE_TYPE_MISMATCH:76,ERROR_SESSION_STATE_UNACKED_PKMSG_GET_BASE_KEY:77,ERROR_SIGNAL_MESSAGE_GET_SENDER_RATCHET_KEY:78,ERROR_SESSION_STATE_GET_ROOT_KEY:79,ERROR_SESSION_STATE_GET_SENDER_RATCHET_KEY_PAIR:80,ERROR_SESSION_STATE_SET_SENDER_CHAIN_KEY:81,ERROR_SESSION_STATE_FIND_RECEIVER_CHAIN:82,ERROR_SESSION_RECORD_DESERIALIZE:83,ERROR_SENDER_KEY_STATE_REMOVE_SENDER_MESSAGE_KEY:84,ERROR_EMPTY_PLAINTEXT_DATA:85,ERROR_MAC_LEN_MISMATCH:86,ERROR_INVALID_MAC_LEN:87,ERROR_INVALID_SIGNATURE_LEN:88,ERROR_SENDER_KEY_LOAD_KEY:89,ERROR_FAST_RATCHET_SENDER_KEY_LOAD_KEY:90,ERROR_UNKNOWN_LOAD_KEY:91,ERROR_UNKNOWN_LOAD_SESSION:92,ERROR_SESSION_RECORD_GET_STATE:93,ERROR_SESSION_STATE_GET_SENDER_CHAIN_KEY:94,ERROR_INVALID_KEY_MATEIRAL_DATA_LEN:95,ERROR_SESSION_STATE_GET_SENDER_RATCHET_KEY:96,ERROR_SESSION_STATE_GET_LOCAL_IDENTITY_KEY:97,ERROR_SESSION_STATE_GET_REMOTE_IDENTITY_KEY:98,ERROR_MEDIA_HASH_VERIFICATION_FAILURE:99,ERROR_CIPHERTEXT_TOO_LONG:100,ERROR_THUMBNAIL_HASH_VERIFICATION_FAILURE:101,ERROR_PARENT_CHILD_SENDER_JID_MISMATCH:102,INVALID_EDIT_MESSAGE:103,INVALID_SESSION:104});f.E2E_FAILURE_REASON=a}),66);
__d("WAWebHandleMsgError",["$InternalEnum","WACustomError","WAWebMdBadDeviceSentMessageWamEvent","WAWebWamEnumDsmError","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){c=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){var e;c===d("WAWebWamEnumDsmError").DSM_ERROR.MISSING_DSM?e=a.call(this,"message should be deviceSentMessage")||this:c===d("WAWebWamEnumDsmError").DSM_ERROR.INVALID_SENDER?e=a.call(this,"message should not be deviceSentMessage")||this:c===d("WAWebWamEnumDsmError").DSM_ERROR.INVALID_DSM?e=a.call(this,"invalid deviceSentMessage")||this:e=a.call(this,"unknown deviceSentMessage error")||this;new(d("WAWebMdBadDeviceSentMessageWamEvent").MdBadDeviceSentMessageWamEvent)({peerType:b,dsmError:c}).commit();e.peerType=b;e.dsmError=c;return babelHelpers.assertThisInitialized(e)}return b}((a=d("WACustomError")).customError("DeviceSentMessageError"));e=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(a.customError("UnknownDeviceMessageError"));f=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,d){var e;e=a.call(this,typeof b==="string"?b:String(b))||this;e.code=b;e.e2eFailureReason=c;e.sendLogs=(b=d==null?void 0:d.sendLogs)!=null?b:!0;return e}return b}(a.customError("MessageValidationError"));var h=function(b){babelHelpers.inheritsLoose(a,b);function a(a){var c;c=b.call(this,"Received Nack error code "+((c=a)!=null?c:"")+" from Server on message sent")||this;c.ackErrorCode=a;return c}return a}(a.customError("MessageSentAckError"));a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(a.customError("BizNodeValidationError"));b=b("$InternalEnum")({INVALID_POLL_UPDATE_STANZA:"poll_update_message_stanza_invalid",INVALID_REACTION_STANZA:"reaction_message_stanza_invalid",INVALID_PIN_IN_CHAT_STANZA:"pin_in_chat_message_stanza_invalid",INVALID_COMMENT_STANZA:"comment_message_stanza_invalid",INVALID_EVENT_RESPONSE_STANZA:"event_response_message_stanza_invalid",INVALID_EVENT_EDIT_STANZA:"event_edit_message_stanza_invalid",INVALID_EDIT_STANZA:"edit_message_stanza_invalid"});var i=function(b){babelHelpers.inheritsLoose(a,b);function a(a){a=b.call(this,a,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.MESSAGE_TYPE_MISMATCH)||this;a.name="MessageProtobufMismatchError";return a}return a}(f),j=function(b){babelHelpers.inheritsLoose(a,b);function a(a){a=b.call(this,"Received "+a.length+" message keys: "+a.join(", "),d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_NUMBER_OF_MESSAGE_TYPES)||this;a.name="MessageProtobufInvalidMessageTypes";return a}return a}(f);g.DeviceSentMessageError=c;g.UnknownDeviceMessageError=e;g.MessageValidationError=f;g.MessageSentAckError=h;g.BizNodeValidationError=a;g.MessageProtobufMismatchErrorCode=b;g.MessageProtobufMismatchError=i;g.MessageProtobufInvalidMessageTypes=j}),98);
__d("WAWebAddonProcessMsgs",["AddonPlaceholderMsgsUtils","Promise","WALogger","WAWebABProps","WAWebAddonConstants","WAWebAddonCrossWindowUtils","WAWebAddonEncryptAddonMsgData","WAWebAddonLogUtils","WAWebAddonPluginProcessor","WAWebAddonProcessMsgsUtils","WAWebAddonSelectUtils","WAWebAddonSortUtils","WAWebAddonUpdateDataUtils","WAWebEventsWaitForOfflineDeliveryEnd","WAWebHandleMsgError","WAWebMsgSyncTunnelBatcher","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["process optimistic addon msg send: "," ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[addon-infra]: optimistic update "," (",") addon, id: ",", parent: ",", isParentLid: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[addon-infra]: processed "," addon(s) during ",", table mode ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[addon-infra] Failed to decrypt a message"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot decrypt a message: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[AddonInfraError] failed saving addons in "," with "," ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["failed incoming addons processing ",""]);o=function(){return a};return a}function a(){var b=babelHelpers.taggedTemplateLiteralLoose(["failed saving addons in "," with ",""]);a=function(){return b};return b}function p(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=c.addons,f=c.processor;c=c.processMode;var g=f.convert.toDualDecryptedMsgData;if(g==null)return e;if(c===d("WAWebAddonConstants").AddonProcessMode.HistorySync)return e;if(c!==d("WAWebAddonConstants").AddonProcessMode.OnlineReceive)return e;f=[];e=(yield (h||(h=b("Promise"))).allSettled(e.map(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){return d("WAWebAddonCrossWindowUtils").isRealAddonType(b)?g(b,a.getForAddon(b)):b});return function(a){return c.apply(this,arguments)}}())));for(var i of e)i.status==="fulfilled"?f.push(i.value):d("WALogger").LOG(m(),i.reason);d("WAWebAddonLogUtils").hasSettledWithError(e)&&d("WALogger").ERROR(l()).tags("messagings","addons").sendLogs(String(c)+"-decription-failed",{sampling:.01});return f});return q.apply(this,arguments)}function r(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=b.addons,e=b.processor,f=b.processMode,g=b.tableMode,h=e.convert.toDualDecryptedMsgData;h=h==null?c:yield p(a,b);if(e.type===d("WAWebAddonConstants").AddonProcessorType.DualEncryptedWithMessageTraits){c=d("AddonPlaceholderMsgsUtils").getIncomingPlaceholderKeys(b);if(c!=null){var i=(yield d("AddonPlaceholderMsgsUtils").getPlaceholderMsgKeys(g,c));h=h.filter(function(a){return!i.has(a.id.toString())})}}b=(yield e.beforeUpsert(h,{processMode:f,parents:a}));return{processor:e,processMode:f,tableMode:g,addons:b}});return s.apply(this,arguments)}function t(a,b){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=b.addons,e=b.processor,f=b.processMode;b=b.tableMode;if(e.type===d("WAWebAddonConstants").AddonProcessorType.DualEncryptedWithMessageTraits){b=(yield d("AddonPlaceholderMsgsUtils").getPlaceholderMsgKeys(b,c.map(function(a){return a.id})));yield e.afterUpsert(c,{processMode:f,parents:a,existingPlaceholderKeys:b})}else yield e.afterUpsert(c,{processMode:f,parents:a})});return u.apply(this,arguments)}function v(a,b,c,d,e){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g){var i,j=(yield (h||(h=b("Promise"))).all(d("WAWebAddonSortUtils").groupAddonsByProcessor(a.mode,c,e).map(function(a){return r(f,a)})));i=(i=[]).concat.apply(i,j.map(function(a){a=a.addons;return a}));i.length&&(yield d("WAWebAddonUpdateDataUtils").updateAddonsInTableMode({processMode:a.mode,tableMode:c},{add:i},{metricReporter:g}));yield h.all(j.map(function(a){return t(f,a)}));d("WALogger").DEV(k(),e.length,a.mode,d("WAWebAddonConstants").AddonTableMode.getName(c)).devConsole(e)});return w.apply(this,arguments)}function x(a,b,c,e){var f=e.metricReporter,g=e.failSilently;return Array.from(d("WAWebAddonSortUtils").groupAddonsByTableMode(b)).map(function(e){var h=e[0];e=e[1];return v(a,h,e,c,f)["catch"](function(c){if(c instanceof d("WAWebHandleMsgError").MessageValidationError){var e;d("WALogger").ERROR(o(),c).tags("addons","messaging").sendLogs("processAddonMsgs: "+((e=b[0])==null?void 0:e.type)+" in "+String(h))}else{e="addon-"+String(a.mode)+"-error: "+((e=b[0])==null?void 0:e.type);d("WALogger").ERROR(n(),h,c.message,c.stack).tags("addons","messaging").sendLogs(e)}if(!g)throw c})})}function c(a,b){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){if(a.length===0)return{orphans:[]};var e={mode:d("WAWebAddonConstants").AddonProcessMode.OnlineReceive};a=(yield d("WAWebAddonProcessMsgsUtils").queryAddonParentMsgs(a,e.mode));var f=a[0];a=a[1];a=d("WAWebAddonSortUtils").collectValidAndOrphanAddons(a,f);var g=a.validAddons;a=a.orphans;e=x(e,g,d("WAWebAddonSelectUtils").createAddonParentSelector(f),{metricReporter:c,failSilently:!0});yield (h||(h=b("Promise"))).allSettled(e);return{orphans:a}});return y.apply(this,arguments)}function e(a,b,c,d){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){a={mode:a};a=x(a,[c],d("WAWebAddonSelectUtils").createAddonParentSelector(e),{metricReporter:f,failSilently:!1});yield (h||(h=b("Promise"))).all(a)});return z.apply(this,arguments)}function A(a,b,c,d){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){var g=e.getForAddon(c),i=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=d("WAWebAddonEncryptAddonMsgData").createDualEncryptionHelper(c,g);return a?a.encrypt():c});return function(){return a.apply(this,arguments)}}();i=(yield (h||(h=b("Promise"))).all([i(),v({mode:a},d("WAWebAddonSelectUtils").getAddonTableMode(c),[c],e,f)]));a=i[0];return{encryptedMsgData:a,decryptedMsgData:c,parent:g}});return B.apply(this,arguments)}function f(a,b,c){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){try{var e=d("WAWebAddonPluginProcessor").getAddonProcessor(b);void e.updateCollection({add:[b],remove:[]},a);d("WAWebMsgSyncTunnelBatcher").nonBlockingMsgsSyncTunnel.isActive()&&!d("WAWebABProps").getABPropConfigValue("web_msg_sync_update_tunnel_store_before_postprocess")&&(yield d("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd());e=d("WAWebAddonProcessMsgsUtils").getParentMsgKey(b);d("WALogger").LOG(j(),d("WAWebAddonCrossWindowUtils").getAddonProcessorType(b),b.type,b.id.id,e.id,(e=e.participant)==null?void 0:e.isLid());e=(yield d("WAWebAddonProcessMsgsUtils").queryAddonParentMsgs([b],a));b=e[0];e=e[1];a=(yield A(a,e[0],d("WAWebAddonSelectUtils").createAddonParentSelector(b),c));return a}catch(a){d("WALogger").ERROR(i(),a.message,a.stack).tags("addons","messaging").sendLogs("failed-optimistic-addon-send");throw a}});return C.apply(this,arguments)}function D(a){return E.apply(this,arguments)}function E(){E=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return;var c={mode:d("WAWebAddonConstants").AddonProcessMode.HistorySync},e=d("WAWebAddonSelectUtils").createAddonParentSelector(new Map());c=x(c,a,e,{failSilently:!0});yield (h||(h=b("Promise"))).allSettled(c)});return E.apply(this,arguments)}g.processMsgsAndGetOrphans=c;g.processOutgoingMsg=e;g.processOutgoingMsgOptimisticUpdate=f;g.processHistoryMsgs=D}),98);
__d("WAWebIsCagGroupCache",[],(function(a,b,c,d,e,f){a=function(){function a(){this.$1=new Set()}var b=a.prototype;b.add=function(a){this.$1.add(a.toString())};b.remove=function(a){this.$1["delete"](a.toString())};b.isCag=function(a){return this.$1.has(a.toString())};b.clear=function(){this.$1.clear()};return a}();b=new a();c=b;f["default"]=c}),66);
__d("WAWebMsgKeyUtils",["$InternalEnum","WALogger","WANullthrows","WAWebIsCagGroupCache","WAWebUserPrefsMeUser","WAWebWid"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["unexpected participant "," in ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["missing participant in a group "," "," ",""]);i=function(){return a};return a}var j=b("$InternalEnum").Mirrored(["Addon","Message","EditMessage"]);function a(a){return a.fromMe&&d("WAWebUserPrefsMeUser").isMeAccount(a.remote)}function k(a,b){var e=a.remote;if(e.isGroup()){if(a.participant==null){d("WALogger").WARN(i(),a.id,a.remote,a.fromMe).sendLogs("group-missing-participant");return!1}var f=c("WAWebIsCagGroupCache").isCag(e);return f&&b===j.Addon?!0:Boolean((f=a.participant)==null?void 0:f.isLid())}return e.isLid()}function l(a,b){if(k(b,a))return d("WAWebUserPrefsMeUser").getMeLidUser();switch(a){case j.Addon:return c("WAWebIsCagGroupCache").isCag(b.remote)?d("WAWebUserPrefsMeUser").getMeLidUser():d("WAWebUserPrefsMeUser").getMeUser();case j.EditMessage:case j.Message:return d("WAWebUserPrefsMeUser").getMeUser()}}function e(a,b){var e=a.remote;b=l(b,a);if(e.isBroadcastList()){var f=c("WANullthrows")(a.participant,"missing participant in broadcast"),g=a.fromMe?b:f;f=a.fromMe?f:b;return{from:g,to:f,broadcastId:e}}g=a.fromMe?b:e;f=a.fromMe?e:b;b=e.isGroup()||e.isStatus();!b&&a.participant&&d("WALogger").WARN(h(),a.participant,e).sendLogs("msgKey-unexpected-participant",{sampling:.01});b=b?a.participant:void 0;return e.isStatus()?{from:g,to:f,author:b,broadcastId:e}:{from:g,to:f,author:b}}function f(a,b){return a.fromMe===b.fromMe&&c("WAWebWid").equals(a.remote,b.remote)&&c("WAWebWid").equals(a.participant,b.participant)}g.TranslateMsgKeyType=j;g.isNoteToSelf=a;g.isLidMsgKey=k;g.msgKeyToTargetInfo=e;g.equalSendersAddressingSensitive=f}),98);
__d("WAWebLidMigrationUtils",["WAWebApiContact","WAWebMsgKey","WAWebMsgKeyUtils","WAWebUserPrefsMeUser","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function h(a){return a.isLid()?d("WAWebApiContact").getPhoneNumber(d("WAWebWidFactory").toUserWid(a)):a}function i(a){return a.isLid()?a:d("WAWebApiContact").getCurrentLid(d("WAWebWidFactory").toUserWid(a))}function a(a){return a?i:h}function b(a,b){if(a!=null&&b!=null&&a.isUser()&&b.isUser()&&a.isLid()!==b.isLid()){var c=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").toUserWid(a));if(c!=null)return[c,b];c=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").toUserWid(b));if(c!=null)return[a,c]}return[a,b]}function e(a){return(a=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").toUserWid(d("WAWebWidFactory").createWid(a))))==null?void 0:a.toString()}function f(a){if(a.remote.isGroup())return j(a);else if(a.remote.isUser())return k(a)}function j(a){var b=a.participant!=null?d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").toUserWid(a.participant)):null;if(b==null)return;return new(c("WAWebMsgKey"))({fromMe:a.fromMe,remote:a.remote,id:a.id,participant:b})}function k(a){var b=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").toUserWid(a.remote));if(b==null)return;return new(c("WAWebMsgKey"))({fromMe:a.fromMe,remote:b,id:a.id})}function l(a,b){var c=a.id.isLid(),e=a.isCAG;a=a.isGroup&&Boolean((a=a.groupMetadata)==null?void 0:a.isLidAddressingMode);switch(b){case d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon:return c||e||a?d("WAWebUserPrefsMeUser").getMeLidUser():d("WAWebUserPrefsMeUser").assertGetMeUser();case d("WAWebMsgKeyUtils").TranslateMsgKeyType.EditMessage:case d("WAWebMsgKeyUtils").TranslateMsgKeyType.Message:return e?a?d("WAWebUserPrefsMeUser").getMeLidUser():d("WAWebUserPrefsMeUser").assertGetMeUser():c||a?d("WAWebUserPrefsMeUser").getMeLidUser():d("WAWebUserPrefsMeUser").assertGetMeUser()}}function m(a){if(!a.isLid()){var b=i(a);if(b!=null)return[a,b]}return[a]}g.toPn=h;g.toLid=i;g.toAddressingModeFactory=a;g.toCommonAddressingMode=b;g.getAlternateJid=e;g.getAlternateMsgKey=f;g.getMeUserLidOrJidForChat=l;g.getPnAndLidToUpdate=m}),98);
__d("WAWebMessageAssociationGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("message_association_infra_enabled")}g.isMessageAssociationInfraEnabled=a}),98);
__d("WAWebParentMsgKeyValidation",["$InternalEnum","WACustomError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({MISSING_PARENT_MESSAGE_KEY:"missing_parent_message_key"});c=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){b="errorCode: "+String(b);c!=null&&(b+=" comment: "+c);return a.call(this,b)||this}return b}(d("WACustomError").customError("ParentMsgKeyValidationError"));g.ParentMsgKeyValidationErrorCode=a;g.ParentMsgKeyValidationError=c}),98);
__d("WAWebAddonProcessMsgsUtils",["Promise","WALogger","WAWebAddonConstants","WAWebAddonCrossWindowUtils","WAWebAddonGatingUtils","WAWebAddonPerfUtils","WAWebAddonPluginProcessor","WAWebAddonQueryUtils","WAWebLidMigrationUtils","WAWebMessageAssociationGatingUtils","WAWebMsgKey","WAWebMsgKeyUtils","WAWebMsgType","WAWebParentMsgKeyValidation","WAWebWid","asyncToGeneratorRuntime","nullthrows"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseHistorySyncMsg: error:",""]);i=function(){return a};return a}function j(a){if(a.targetMessageKey!=null)return"targetMessageKey";else if(a.pinParentKey!=null)return"pinParentKey";else if(a.pollUpdateParentKey!=null)return"pollUpdateParentKey";else if(a.reactionParentKey!=null)return"reactionParentKey";else if(d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&a.parentMsgKey!=null)return"parentMsgKey";throw new(d("WAWebParentMsgKeyValidation").ParentMsgKeyValidationError)(d("WAWebParentMsgKeyValidation").ParentMsgKeyValidationErrorCode.MISSING_PARENT_MESSAGE_KEY)}function k(a){var b;b=(b=(b=(b=(b=a.targetMessageKey)!=null?b:a.parentMsgKey)!=null?b:a.pinParentKey)!=null?b:a.pollUpdateParentKey)!=null?b:a.reactionParentKey;if(b instanceof c("WAWebMsgKey"))return b;throw new(d("WAWebParentMsgKeyValidation").ParentMsgKeyValidationError)(d("WAWebParentMsgKeyValidation").ParentMsgKeyValidationErrorCode.MISSING_PARENT_MESSAGE_KEY)}function l(a){a=k(a);if(a.remote.isBroadcastList()){var b=d("WAWebMsgKeyUtils").msgKeyToTargetInfo(a,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Message);b=a.fromMe?b.to:b.from;return new(c("WAWebMsgKey"))({remote:b,fromMe:a.fromMe,id:a.id})}return a}function m(a){var b=d("WAWebAddonCrossWindowUtils").getAddonProcessorType(a);if(d("WAWebAddonPluginProcessor").getAddonProcessorsMap().has(b))return a}function n(a,b){var e=new Map();a=a.map(function(a){var f=l(a),g=d("WAWebLidMigrationUtils").getAlternateMsgKey(f),h=null;if(e.has(f.toString()))h=c("nullthrows")(e.get(f.toString()));else if(g!=null&&e.has(g.toString()))h=c("nullthrows")(e.get(g.toString()));else{var i=b.get(f.toString());i==null&&g&&(i=b.get(g.toString()));i!=null&&!f.equals(i.id)&&(h=i.id,e.set(f.toString(),h))}f=(i=b.get(f.toString()))!=null?i:g!=null?b.get(g.toString()):void 0;if(f==null)return a;if(h==null)return o(a,f);i=p(a,h);return o(i,f)});e.forEach(function(a,c){var d=b.get(c);d!=null&&(b.set(a.toString(),d),b["delete"](c))});return[b,a]}function o(a,b){b=b.broadcastId!=null&&c("WAWebWid").isWid(b.broadcastId)&&Boolean((b=b.broadcastId)==null?void 0:b.isBroadcastList());if(!b)return a;b=l(a);return p(a,new(c("WAWebMsgKey"))({id:b.id,fromMe:b.fromMe,remote:b.remote}))}function p(a,b){var d=j(a),e=a.id;a.id.remote.isUser()&&b.remote.isUser()&&(e=new(c("WAWebMsgKey"))({fromMe:a.id.fromMe,remote:b.remote,id:a.id.id}));return babelHelpers["extends"]({},a,(a={id:e},a[d]=b,a))}function a(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=a.map(l),e;b===d("WAWebAddonConstants").AddonProcessMode.OnlineReceive&&(e=(yield d("WAWebAddonPerfUtils").createMessagesQplMarker(d("WAWebAddonPerfUtils").AddonQplMarkerType.Incoming,{type:d("WAWebAddonPerfUtils").AnnotationRequestType.BulkGetParentMsgs,size:c.length})));try{b=(yield r(a));(c=e)==null?void 0:c.success();return b}catch(b){(a=e)==null?void 0:a.fail();throw b}});return q.apply(this,arguments)}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.map(l);b=(yield d("WAWebAddonQueryUtils").getParentMsgsByMsgKey(b));return n(a,b)});return s.apply(this,arguments)}function e(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{var c=[];for(var e of d("WAWebAddonPluginProcessor").getAddonProcessorsMap().entries()){var f=e[0],g=e[1];d("WAWebAddonGatingUtils").isUnifiedInfraEnabledForType(f)&&c.push(g.convert.fromHistorySyncMsg(a))}f=(yield (h||(h=b("Promise"))).all(c).then(function(a){var b;return(b=[]).concat.apply(b,a)}));return f}catch(a){d("WALogger").WARN(i(),a).tags("addons","messaging").sendLogs("parseHistorySyncMsg");return[]}});return t.apply(this,arguments)}function f(a){var b=[],c=[],e=[];for(a of a){var f=a.parsedMsgPayload;if(d("WAWebAddonGatingUtils").isUnifiedInfraEnabledForType(f.type)){var g=m(f);g!=null?b.push(g):c.push(a)}else f.kind===d("WAWebMsgType").MsgKind.ReactionDecrypted?e.push(f):c.push(a)}return{unifiedAddons:b,otherOrphans:c,legacyReactionAddons:e}}g.getParentMsgKeyName=j;g.getParentMsgKey=l;g.castToAddonMsgData=m;g.updateMsgParentKeyValue=p;g.queryAddonParentMsgs=a;g.queryParentMsgs=r;g.parseHistorySyncMsg=e;g.sortAddonOrphans=f}),98);
__d("WAWebAddonProcessRevoke",["Promise","WALogger","WANullthrows","WAWebAddonConstants","WAWebAddonDBTable","WAWebAddonGatingUtils","WAWebAddonLogUtils","WAWebAddonProcessRevokeDataUtils","WAWebAddonRetryRequestUtils","WAWebAddonSelectUtils","WAWebAddonUpdateDataUtils","WAWebMsgGetters","WAWebNoop","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["process addon revokes: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["process addon revoke ",", ",": ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[addon-infra]: processRevokeMsgs "," addon(s)"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["storeRevokesForTableMode for ",": ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["revoking addons finished with errors"]);m=function(){return a};return a}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=new Map(),f=[];for(var g of d("WAWebAddonConstants").AddonTableMode.members())g!==d("WAWebAddonConstants").AddonTableMode.None&&f.push(d("WAWebAddonDBTable").addonInternalDBTable.bulkGetByMsgKey(g,a,!1).then(function(a){for(a of a)a!=null&&e.set(a.id.toString(),a)})["catch"](c("WAWebNoop")));yield (h||(h=b("Promise"))).all(f);return d("WAWebAddonSelectUtils").createAddonSelector(e)});return o.apply(this,arguments)}function p(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=[],f=function(b){var c=b[0];b=b[1];e.push(d("WAWebAddonUpdateDataUtils").updateAddonsInTableMode({processMode:a.mode,tableMode:c},b)["catch"](function(a){d("WALogger").WARN(l(),c,a);throw a}))};for(c of c)f(c);f=(yield (h||(h=b("Promise"))).allSettled(e));d("WAWebAddonLogUtils").hasSettledWithError(f)&&d("WALogger").WARN(m()).tags("addons","messaging").sendLogs("revokeAddonMsgs")});return q.apply(this,arguments)}function r(a,b,c){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=[],g=new Map();for(b of b){var h=e.get(c("WANullthrows")(b.protocolMessageKey));if(!d("WAWebAddonGatingUtils").isUnifiedInfraEnabled(h))continue;var i=d("WAWebAddonSelectUtils").getTableModeByMsgType(h.type);g.has(i)||g.set(i,{add:[],remove:[]});i=c("WANullthrows")(g.get(i));b.id.equals(h.id)||i.remove.push(h);i.add.push(b);d("WAWebUserPrefsMeUser").isMeAccount(d("WAWebMsgGetters").getFrom(h))&&f.push([h,b])}d("WALogger").DEV(k(),g.size).devConsole(g);yield p(a,g);yield d("WAWebAddonRetryRequestUtils").replaceSelfMessageTypeRows(f)});return s.apply(this,arguments)}function a(a,b){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c={mode:d("WAWebAddonConstants").AddonProcessMode.SendRevoke};try{yield r(c,[d("WAWebAddonProcessRevokeDataUtils").protocolRevokeToRevokeMsgData(a)],d("WAWebAddonSelectUtils").createAddonSelector(new Map([[b.id.toString(),b]])))}catch(c){d("WALogger").ERROR(j(),a.id,b.id,c).tags("addons","messaging").sendLogs("processSentRevokeMsg");throw c}});return t.apply(this,arguments)}function e(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b={mode:d("WAWebAddonConstants").AddonProcessMode.Revoke},c=new Set();try{var e=a.map(function(a){return a.revokeMsgKey});e=(yield n(e));var f=[];for(a of a){var g=a.revokeMsgKey;if(!e.has(g)){c.add(g);continue}g=e.get(g);g=d("WAWebAddonProcessRevokeDataUtils").revokeMsgInfoToRevokeMsgData(a,g);f.push(g)}yield r(b,f,e);return c}catch(a){d("WALogger").ERROR(i(),a).tags("addons","messaging").sendLogs("processAddonRevokes");throw a}});return u.apply(this,arguments)}g.processSentRevokeMsg=a;g.processRevokeMsgs=e}),98);
__d("WAWebProcessBaseMsgInfo",[],(function(a,b,c,d,e,f){a=function(a){return{id:a.id,from:a.from,to:a.to,type:a.type,t:a.t,ack:a.ack,count:null,author:a.author,notifyName:a.notifyName,invis:a.invis,subtype:a.subtype,viewMode:a.viewMode}};b=function(a){return{id:a.id,from:a.from,to:a.to,type:a.type,t:a.t,ack:a.ack,count:null,author:a.author,notifyName:a.notifyName,invis:a.invis,subtype:a.subtype,viewMode:a.viewMode}};f.msgToBaseMsgInfo=a;f.msgDataToBaseMsgInfo=b}),66);
__d("WAWebViewMode.flow",["$InternalEnum"],(function(a,b,c,d,e,f){a={VISIBLE:"VISIBLE",HIDDEN:"HIDDEN",MEDIA_ALBUM:"MEDIA_ALBUM",INVISIBLE_PLACEHOLDER:"INVISIBLE_PLACEHOLDER",NEWSLETTER_TOMBSTONE:"NEWSLETTER_TOMBSTONE"};c=b("$InternalEnum").Mirrored(["CHAT","SEARCH","CHAT_LIST","NOTIFICATION"]);f.ViewModeType=a;f.ViewModeSurface=c}),66);
__d("WAWebAddonProcessRevokeDataUtils",["WAWebAddonCrossWindowUtils","WAWebAddonProcessMsgsUtils","WAWebMsgGetters","WAWebMsgKeyUtils","WAWebMsgType","WAWebProcessBaseMsgInfo","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){a=function(a,b){var c=d("WAWebAddonCrossWindowUtils").getAddonProcessorType(b);return babelHelpers["extends"]({id:a.newMsgKey,type:d("WAWebMsgType").MSG_TYPE.REVOKED,kind:d("WAWebMsgType").MsgKind.RevokedAddon,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:a.subtype==="admin_revoke"?"admin":"sender",revokeTimestamp:(a=a.revokeTimestamp)!=null?a:void 0},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(b.id,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{revokeAddonType:c,protocolMessageKey:b.id,t:d("WAWebMsgGetters").getT(b),parentMsgKey:d("WAWebAddonProcessMsgsUtils").getParentMsgKey(b)})};b=function(a){return babelHelpers["extends"]({},d("WAWebProcessBaseMsgInfo").msgDataToBaseMsgInfo(a),{id:a.id},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(a.id,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{type:d("WAWebMsgType").MSG_TYPE.REVOKED,kind:d("WAWebMsgType").MsgKind.RevokedAddon,subtype:a.subtype==="admin_revoke"?"admin":"sender",revokeTimestamp:a.revokeTimestamp,revokeAddonType:a.revokeAddonType,protocolMessageKey:a.protocolMessageKey,parentMsgKey:a.targetMessageKey})};g.revokeMsgInfoToRevokeMsgData=a;g.protocolRevokeToRevokeMsgData=b}),98);
__d("WAWebMaybe",[],(function(a,b,c,d,e,f){function a(a,b){if(a!=null)return b(a)}f.ifSome=a}),66);
__d("WAWebAddonQueryUtils",["WAWebDBMsgUtils","WAWebLidMigrationUtils","WAWebMaybe","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebDBMsgUtils").getMsgsByMsgKey(a.map(String))),c=new Map(b.map(function(a){return[a.id.toString(),a]}));if(c.size===a.length)return c;b=a.filter(function(a){return!c.has(a.toString())}).map(d("WAWebLidMigrationUtils").getAlternateMsgKey).filter(Boolean);if(b.length>0){a=(yield d("WAWebDBMsgUtils").getMsgsByMsgKey(b.map(String)));a.forEach(function(a){d("WAWebMaybe").ifSome(d("WAWebLidMigrationUtils").getAlternateMsgKey(a.id),function(b){c.set(b.toString(),a)})})}return c});return h.apply(this,arguments)}g.getParentMsgsByMsgKey=a}),98);
__d("WAWebAck",[],(function(a,b,c,d,e,f){a={INACTIVE:-6,CONTENT_UNUPLOADABLE:-5,CONTENT_TOO_BIG:-4,CONTENT_GONE:-3,EXPIRED:-2,FAILED:-1,CLOCK:0,SENT:1,RECEIVED:2,READ:3,PLAYED:4,PEER:5};b={NONE:-1,MESSAGE_EDIT:1,PIN_IN_CHAT:2,SENDER_REVOKE:7,ADMIN_REVOKE:8};c={SENDER:"sender",DELIVERY:"delivery",READ:"read",PLAYED:"played",INACTIVE:"inactive",READ_SELF:"read-self",PLAYED_SELF:"played-self"};f.ACK=a;f.EDIT_ATTR=b;f.ACK_STRING=c}),66);
__d("WAWebAddonRetryRequestUtils",["WALogger","WANullthrows","WAWebAck","WAWebAddonConstants","WAWebAddonCrossWindowUtils","WAWebAddonDBTable","WAWebAddonPluginProcessor","WAWebAddonProcessMsgsUtils","WAWebAddonSelectUtils","WAWebAddonSortUtils","WAWebModelStorageUtils","WAWebSchemaSelfAddonMessageTypeTable","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["msg-retry: can not find addon ","."]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["msg-retry: can not find addon ","."]);i=function(){return a};return a}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return(yield d("WAWebSchemaSelfAddonMessageTypeTable").getSelfAddonMessageTypeTable().equals(["msgId"],a.id))[0]});return k.apply(this,arguments)}function a(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if((yield j(a.id))==null){a={msgId:a.id.id,msgType:d("WAWebAddonCrossWindowUtils").getAddonProcessorType(a)};yield d("WAWebSchemaSelfAddonMessageTypeTable").getSelfAddonMessageTypeTable().createOrReplace(a)}});return l.apply(this,arguments)}function e(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return;return d("WAWebModelStorageUtils").getStorage().lock(["self-addon-message-type"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var c=(yield b.anyOf(["msgId"],a.map(function(a){a=a[0];return a.id.id}))),d=a.map(function(a){var b=a[0];a=a[1];return{msgId:a.id.id,msgType:b.type}});yield b.bulkRemove(c.map(function(a){return a.rowId}).filter(Boolean));yield b.bulkCreateOrReplace(d)});return function(a){return c.apply(this,arguments)}}())});return m.apply(this,arguments)}function f(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield j(a));if(b==null)return;var e=d("WAWebAddonSelectUtils").getTableModeByMsgType(b.msgType);e=(yield d("WAWebAddonDBTable").addonInternalDBTable.getByMsgKey(e,a));if(e==null){d("WALogger").WARN(i(),a.toString());return}if(!d("WAWebAddonCrossWindowUtils").isRealAddonType(e))return{msgData:e,selfMsgRow:b};var f=e.ack;if(f==null||f<d("WAWebAck").ACK.SENT){d("WALogger").WARN(h(),a.toString()).sendLogs("msg-retry");return}f=d("WAWebAddonPluginProcessor").getAddonProcessor(e).convert.toDualEncryptedMsgData;if(f!=null){a=(yield d("WAWebAddonProcessMsgsUtils").queryAddonParentMsgs([e],d("WAWebAddonConstants").AddonProcessMode.Send));var g=a[0];a=a[1];a=d("WAWebAddonSortUtils").collectValidAndOrphanAddons(a,g);a=a.validAddons;a=a[0];g=c("WANullthrows")(g.get(d("WAWebAddonProcessMsgsUtils").getParentMsgKey(a).toString()));return{msgData:yield f(a,g),selfMsgRow:b}}return{msgData:e,selfMsgRow:b}});return n.apply(this,arguments)}g.hasSentAddonMsg=j;g.storeSelfMessageTypeRow=a;g.replaceSelfMessageTypeRows=e;g.getSentAddonMsgRecord=f}),98);
__d("WAWebAddonInfraError",["$InternalEnum","WACustomError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({UnexpectedError:"unexpected_error",NotSupportedFeature:"not_supported_feature",NotSupportedMsgType:"not_supported_msg_type",UnexpectedMsgType:"unexpected_msg_type",InvalidParentMsgKey:"invalid_parent_msg_key",MissingParentMsg:"missing_parent_msg"});c=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){b="errorCode: "+String(b);c!=null&&(b+=" comment: "+c);return a.call(this,b)||this}return b}(d("WACustomError").customError("AddonInfraError"));g.AddonInfraErrorCode=a;g.AddonInfraError=c}),98);
__d("WAWebAddonCommentTableMode",["WAWebAddonConstants","WAWebAddonInfraError","WAWebCommentSchema","WAWebDBCommentMessageSerialization","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){a={mode:d("WAWebAddonConstants").AddonTableMode.Comment,bulkUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(function(a){if(a.kind===d("WAWebMsgType").MsgKind.CommentDecrypted)return d("WAWebDBCommentMessageSerialization").dbRowFromCommentMessage(a);if(a.kind===d("WAWebMsgType").MsgKind.RevokedAddon)return d("WAWebDBCommentMessageSerialization").dbRowFromRevokedMsgData(a);if(a.kind===d("WAWebMsgType").MsgKind.PlaceholderAddon)return d("WAWebDBCommentMessageSerialization").dbRowFromPlaceholderAddon(a);throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedMsgType)});yield d("WAWebCommentSchema").getTable().bulkCreateOrReplace(a)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByParentAndSender:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedFeature)});function c(){return a.apply(this,arguments)}return c}(),bulkGetByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("WAWebCommentSchema").getTable().bulkGet(a.map(function(a){return a.toString()}),b));return a.map(function(a){return a==null?a:d("WAWebDBCommentMessageSerialization").commentMessageFromDbRow(a)})});function c(b,c){return a.apply(this,arguments)}return c}(),bulkGetByParentMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebCommentSchema").getTable().anyOf(["parentMsgKey"],a.map(function(a){return a.toString()})));return a.map(d("WAWebDBCommentMessageSerialization").commentMessageFromDbRow)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByChatWid:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedFeature)});function c(){return a.apply(this,arguments)}return c}(),bulkRemoveByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebCommentSchema").getTable().bulkRemove(a.map(function(a){return a.toString()}))});function c(b){return a.apply(this,arguments)}return c}(),getByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebCommentSchema").getTable().get(a.toString()));return a==null?null:d("WAWebDBCommentMessageSerialization").commentMessageFromDbRow(a)});function c(b){return a.apply(this,arguments)}return c}(),updateAck:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){yield d("WAWebCommentSchema").getTable().merge(a.id.toString(),{ack:b})});function c(b,c){return a.apply(this,arguments)}return c}(),markAsRead:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebCommentSchema").getTable().merge(a.toString(),{read:!0})});function c(b){return a.apply(this,arguments)}return c}(),getTableSize:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebCommentSchema").getTable().count()});function c(){return a.apply(this,arguments)}return c}()};g.commentTableMode=a}),98);
__d("WAWebAddonDBSerializationUtils",["WAWebAddonProcessMsgsUtils"],(function(a,b,c,d,e,f,g){function h(a){a=i(a,"string");return typeof a==="symbol"?a:String(a)}function i(a,b){if(typeof a!=="object"||a===null)return a;var c=a[typeof Symbol==="function"?Symbol.toPrimitive:"@@toPrimitive"];if(c!==void 0){c=c.call(a,b||"default");if(typeof c!=="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(b==="string"?String:Number)(a)}a=function(a){var b=d("WAWebAddonProcessMsgsUtils").getParentMsgKeyName(a),c=a.id,e=a.ack,f=a.t,g=a.read;a.to;a.from;a.type;a.kind;a.notifyName;a.count;a.subtype;a.local;a[b];b=babelHelpers.objectWithoutPropertiesLoose(a,["id","ack","t","read","to","from","type","kind","notifyName","count","subtype","local",b].map(h));return{base:{msgKey:c.toString(),ack:e,t:f,read:g,targetMsgKey:d("WAWebAddonProcessMsgsUtils").getParentMsgKey(a).toString()},addonProps:b}};g.extractAddonForUnifiedTable=a}),98);
__d("WAWebAddonDBTable",["WAWebAddonCommentTableMode","WAWebAddonConstants","WAWebAddonEventResponseTableMode","WAWebAddonInfraError","WAWebAddonPinTableMode","WAWebAddonPollVoteTableMode","WAWebAddonReactionTableMode","WAWebAddonSelectUtils","WAWebAddonUnifiedAddonsTableMode","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=function(a){switch(a){case d("WAWebAddonConstants").AddonTableMode.Pin:return d("WAWebAddonPinTableMode").pinTableMode;case d("WAWebAddonConstants").AddonTableMode.PollVote:return d("WAWebAddonPollVoteTableMode").pollVoteTableMode;case d("WAWebAddonConstants").AddonTableMode.Comment:return d("WAWebAddonCommentTableMode").commentTableMode;case d("WAWebAddonConstants").AddonTableMode.Reaction:return d("WAWebAddonReactionTableMode").reactionTableMode;case d("WAWebAddonConstants").AddonTableMode.EventResponse:return d("WAWebAddonEventResponseTableMode").eventResponseTableMode;case d("WAWebAddonConstants").AddonTableMode.Unified:return d("WAWebAddonUnifiedAddonsTableMode").unifiedAddonsTableMode;case d("WAWebAddonConstants").AddonTableMode.None:throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError)}},i={bulkUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(b.length===0)return;return h(a).bulkUpsert(b)});function c(b,c){return a.apply(this,arguments)}return c}(),bulkGetByParentAndSender:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return b.length===0?[]:h(a).bulkGetByParentAndSender(b)});function c(b,c){return a.apply(this,arguments)}return c}(),bulkGetByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){return h(a).bulkGetByMsgKey(b,c)});function c(b,c,d){return a.apply(this,arguments)}return c}(),bulkGetByParentMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return h(a).bulkGetByParentMsgKey(b)});function c(b,c){return a.apply(this,arguments)}return c}(),bulkGetByChatWid:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return h(a).bulkGetByChatWid(b)});function c(b,c){return a.apply(this,arguments)}return c}(),bulkRemoveByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(b.length===0)return;return h(a).bulkRemoveByMsgKey(b)});function c(b,c){return a.apply(this,arguments)}return c}(),updateAck:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){return h(a).updateAck(b,c)});function c(b,c,d){return a.apply(this,arguments)}return c}(),getByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return h(a).getByMsgKey(b)});function c(b,c){return a.apply(this,arguments)}return c}(),getTableSize:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return h(a).getTableSize()});function c(b){return a.apply(this,arguments)}return c}()};a={bulkGetByParentAndSender:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return i.bulkGetByParentAndSender(d("WAWebAddonSelectUtils").getTableModeByMsgType(a),b)});function c(b,c){return a.apply(this,arguments)}return c}(),getByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return i.getByMsgKey(d("WAWebAddonSelectUtils").getTableModeByMsgType(a),b)});function c(b,c){return a.apply(this,arguments)}return c}()};g.addonInternalDBTable=i;g.addonDBTable=a}),98);
__d("WAWebAddonEventResponseTableMode",["WANullthrows","WAWebAddonConstants","WAWebAddonInfraError","WAWebEventResponseDBSerialization","WAWebEventResponsesSchema","WAWebMsgGetters","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h={mode:d("WAWebAddonConstants").AddonTableMode.EventResponse,bulkUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebEventResponsesSchema").getTable().bulkCreateOrReplace(a.map(function(a){if(a.kind!==d("WAWebMsgType").MsgKind.EventResponseDecrypted)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedMsgType);return d("WAWebEventResponseDBSerialization").dbRowFromEventResponseMessage(a)}))});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByParentAndSender:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebEventResponsesSchema").getTable().anyOf(["parentMsgKey","sender"],a.map(function(a){return[a[0].toString(),a[1].toString()]})));return a.map(d("WAWebEventResponseDBSerialization").eventResponseMessageFromDBRow)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedFeature)});function c(){return a.apply(this,arguments)}return c}(),bulkGetByParentMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebEventResponsesSchema").getTable().anyOf(["parentMsgKey"],a.map(function(a){return a.toString()})));return a.map(d("WAWebEventResponseDBSerialization").eventResponseMessageFromDBRow)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByChatWid:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedFeature)});function c(){return a.apply(this,arguments)}return c}(),bulkRemoveByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebEventResponsesSchema").getTable().bulkRemoveByIndex(["msgKey"],a.map(function(a){return a.toString()}))});function c(b){return a.apply(this,arguments)}return c}(),getByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(a=(yield d("WAWebEventResponsesSchema").getTable().equals(["msgKey"],a.toString())))==null?void 0:a[0];return a==null?a:d("WAWebEventResponseDBSerialization").eventResponseMessageFromDBRow(a)});function c(b){return a.apply(this,arguments)}return c}(),updateAck:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e;if(a.kind===d("WAWebMsgType").MsgKind.EventResponseEncrypted)e=a.targetMessageKey;else if(a.kind===d("WAWebMsgType").MsgKind.EventResponseDecrypted)e=a.parentMsgKey;else throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedMsgType);yield d("WAWebEventResponsesSchema").getTable().merge([e.toString(),c("WANullthrows")(d("WAWebMsgGetters").getSender(a)).toString()],{ack:b})});function e(b,c){return a.apply(this,arguments)}return e}(),markAsRead:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield h.getByMsgKey(a));if(a!=null)return h.bulkUpsert([babelHelpers["extends"]({},a,{read:!0})])});function c(b){return a.apply(this,arguments)}return c}(),getTableSize:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebEventResponsesSchema").getTable().count()});function c(){return a.apply(this,arguments)}return c}()};g.eventResponseTableMode=h}),98);
__d("WAWebCastToPinInChatMsg",["invariant","WAWebMsgType"],(function(a,b,c,d,e,f,g,h){function i(a){return a.type===d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE?a:null}function a(a){a=i(a);a!=null||h(0,76405);return a}g.assertPinInChatMsgData=a}),98);
__d("WAWebAddonPinTableMode",["WAWebAddonConstants","WAWebAddonInfraError","WAWebCastToPinInChatMsg","WAWebDBCRUDOperationsPinInChat","WAWebPinInChatSchema","WAWebPinsDbSerialization","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h={mode:d("WAWebAddonConstants").AddonTableMode.Pin,bulkUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.map(function(a){return d("WAWebPinsDbSerialization").serializePinInChatMsgData(d("WAWebCastToPinInChatMsg").assertPinInChatMsgData(a))});yield d("WAWebDBCRUDOperationsPinInChat").createOrUpdatePinInChat(a[0].id.remote,b)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByParentAndSender:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError)});function c(){return a.apply(this,arguments)}return c}(),bulkGetByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError)});function c(){return a.apply(this,arguments)}return c}(),bulkGetByParentMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length!==1)return[];a=(yield d("WAWebPinInChatSchema").getTable().get(a[0].toString()));return a==null?[]:[d("WAWebPinsDbSerialization").deserializePinInChatMsgData(a)]});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByChatWid:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebPinInChatSchema").getTable().anyOf(["chatId"],a.map(function(a){return a.toString()})));return a.map(d("WAWebPinsDbSerialization").deserializePinInChatMsgData)});function c(b){return a.apply(this,arguments)}return c}(),bulkRemoveByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebPinInChatSchema").getTable().bulkRemoveByIndex(["msgKey"],a.map(function(a){return a.toString()}))});function c(b){return a.apply(this,arguments)}return c}(),getByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebPinInChatSchema").getTable().equals(["msgKey"],a.toString()))[0];return a==null?a:d("WAWebPinsDbSerialization").deserializePinInChatMsgData(a)});function c(b){return a.apply(this,arguments)}return c}(),updateAck:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WAWebPinsDbSerialization").serializePinInChatMsgData(d("WAWebCastToPinInChatMsg").assertPinInChatMsgData(a));yield d("WAWebPinInChatSchema").getTable().merge(a.parentMsgKey,{ack:b})});function c(b,c){return a.apply(this,arguments)}return c}(),markAsRead:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield h.getByMsgKey(a));if(a!=null)return h.bulkUpsert([babelHelpers["extends"]({},a,{read:!0})])});function c(b){return a.apply(this,arguments)}return c}(),getTableSize:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebPinInChatSchema").getTable().count()});function c(){return a.apply(this,arguments)}return c}()};g.pinTableMode=h}),98);
__d("WAWebMaxPerGroup",[],(function(a,b,c,d,e,f){function a(a,b,c){var d=new Map();for(var a=a,e=Array.isArray(a),f=0,a=e?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=a.length)break;g=a[f++]}else{f=a.next();if(f.done)break;g=f.value}g=g;var h=c(g),i=d.get(h);(i==null||b(g)>=b(i))&&d.set(h,g)}return Array.from(d.values())}f.maxPerGroup=a}),66);
__d("WAWebPollsDbSerialization",["WAWebMsgKey","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){var b={msgKey:a.msgKey.toString(),parentMsgKey:a.parentMsgKey.toString(),selectedOptionLocalIds:new Uint8Array(a.selectedOptionLocalIds).buffer,senderTimestampMs:a.senderTimestampMs,sender:a.sender.toString(),read:a.read};a.t!=null&&(b.t=a.t);a.ack!=null&&(b.ack=a.ack);return b}function b(a){return{msgKey:c("WAWebMsgKey").fromString(a.msgKey),parentMsgKey:c("WAWebMsgKey").fromString(a.parentMsgKey),selectedOptionLocalIds:Array.from(new Uint8Array(a.selectedOptionLocalIds)),senderTimestampMs:a.senderTimestampMs,t:a.t,sender:d("WAWebWidFactory").createUserWid(a.sender),ack:a.ack,read:(a=a.read)!=null?a:!0}}g.dbRowFromVote=a;g.voteFromDbRow=b}),98);
__d("WAWebPollsGetVoteKey",["WAWebLidMigrationUtils","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){var b=a.parentMsgKey;a=a.sender;a=d("WAWebWidFactory").createWidFromWidLike(a);return String(b)+"|"+String(d("WAWebLidMigrationUtils").toLid(a))+"|"+String(d("WAWebLidMigrationUtils").toPn(a))}g.getVoteKey=a}),98);
__d("WAWebDBPollsUpsertVotes",["WAWebApiContact","WAWebMaxPerGroup","WAWebModelStorageUtils","WAWebPollsDbSerialization","WAWebPollsGetVoteKey","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){var c=d("WAWebMaxPerGroup").maxPerGroup(a,function(a){return a.senderTimestampMs},d("WAWebPollsGetVoteKey").getVoteKey);return d("WAWebModelStorageUtils").getStorage().lock(["poll-votes"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.anyOf(["parentMsgKey","sender"],h(c))),e=new Map();for(b of b)e.set(d("WAWebPollsGetVoteKey").getVoteKey(b),b);b=[];var f=[],g=[];for(var i of c){var j=e.get(d("WAWebPollsGetVoteKey").getVoteKey(i));if(j!=null){if(j.senderTimestampMs>i.senderTimestampMs){b.push(d("WAWebPollsDbSerialization").voteFromDbRow(j));continue}String(i.sender)!==String(j.sender)&&g.push(j)}var k=i.selectedOptionLocalIds.length===0;j=(j=j==null?void 0:j.read)!=null?j:!1;k=!k&&j&&i.read!==j?babelHelpers["extends"]({},i,{read:!0}):i;b.push(k);f.push(d("WAWebPollsDbSerialization").dbRowFromVote(k))}g.length>0&&(yield a.bulkRemove(f.map(function(a){return[a.parentMsgKey,a.sender]})));f.length>0&&(yield a.bulkCreateOrReplace(f));return b});return function(b){return a.apply(this,arguments)}}())}function h(a){var b=[];for(a of a){var c=a.parentMsgKey,e=a.sender;b.push([c.toString(),e.toString()]);e=d("WAWebApiContact").getAlternateUserWid(e);e!=null&&b.push([c.toString(),e.toString()])}return b}g.upsertVotesDb=a}),98);
__d("WAWebAddonPollVoteTableMode",["WANullthrows","WAWebAddonConstants","WAWebAddonInfraError","WAWebDBPollsUpsertVotes","WAWebMsgType","WAWebPollsDbSerialization","WAWebPollsVoteDataUtils","WAWebPollsVotesSchema","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=function(a){return d("WAWebPollsVoteDataUtils").voteDataToPollVoteMsgData(d("WAWebPollsDbSerialization").voteFromDbRow(a))},i={mode:d("WAWebAddonConstants").AddonTableMode.PollVote,bulkUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(function(a){if(a.kind!==d("WAWebMsgType").MsgKind.PollVoteDecrypted)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedMsgType);return d("WAWebPollsVoteDataUtils").pollVoteMsgDataToVoteData(a)});yield d("WAWebDBPollsUpsertVotes").upsertVotesDb(a)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByParentAndSender:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebPollsVotesSchema").getTable().anyOf(["parentMsgKey","sender"],a.map(function(a){return[a[0].toString(),a[1].toString()]})));return a.map(h)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError)});function c(){return a.apply(this,arguments)}return c}(),bulkGetByParentMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebPollsVotesSchema").getTable().anyOf(["parentMsgKey"],a.map(function(a){return a.toString()})));return a.map(h)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByChatWid:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedFeature)});function c(){return a.apply(this,arguments)}return c}(),bulkRemoveByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebPollsVotesSchema").getTable().bulkRemoveByIndex(["msgKey"],a.map(function(a){return a.toString()}))});function c(b){return a.apply(this,arguments)}return c}(),getByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebPollsVotesSchema").getTable().equals(["msgKey"],a.toString()))[0];return a==null?a:h(a)});function c(b){return a.apply(this,arguments)}return c}(),updateAck:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(a.kind!==d("WAWebMsgType").MsgKind.PollVoteDecrypted&&a.kind!==d("WAWebMsgType").MsgKind.PollVoteEncrypted)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedMsgType);yield d("WAWebPollsVotesSchema").getTable().merge([a.pollUpdateParentKey.toString(),c("WANullthrows")(a.from).toString()],{ack:b})});function e(b,c){return a.apply(this,arguments)}return e}(),markAsRead:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield i.getByMsgKey(a));if(a!=null)return i.bulkUpsert([babelHelpers["extends"]({},a,{read:!0})])});function c(b){return a.apply(this,arguments)}return c}(),getTableSize:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebPollsVotesSchema").getTable().count()});function c(){return a.apply(this,arguments)}return c}()};g.pollVoteTableMode=i}),98);
__d("WAWebCastToReactionMsg",["invariant","WAWebMsgType"],(function(a,b,c,d,e,f,g,h){function i(a){return a.type===d("WAWebMsgType").MSG_TYPE.REACTION?a:null}function a(a){a=i(a);a!=null||h(0,73785);return a}g.castToReactionMsgData=i;g.assertReactionMsgData=a}),98);
__d("WAWebAddonReactionTableMode",["WANullthrows","WAWebAddonConstants","WAWebAddonInfraError","WAWebCastToReactionMsg","WAWebMsgGetters","WAWebMsgType","WAWebReactionDataUtils","WAWebSchemaReactions","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h={mode:d("WAWebAddonConstants").AddonTableMode.Reaction,bulkUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(function(a){return d("WAWebReactionDataUtils").reactionMsgDataToReactionRow(d("WAWebCastToReactionMsg").assertReactionMsgData(a))});yield d("WAWebSchemaReactions").getReactionsTable().bulkCreateOrReplace(a)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByParentAndSender:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaReactions").getReactionsTable().anyOf(["parentMsgKey","senderUserJid"],a.map(function(a){var b=a[0];a=a[1];return[b.toString(),a.toString()]})));return a.map(d("WAWebReactionDataUtils").reactionRowToReactionMsgData)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError)});function c(){return a.apply(this,arguments)}return c}(),bulkGetByParentMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaReactions").getReactionsTable().anyOf(["parentMsgKey"],a.map(function(a){return a.toString()})));return a.map(d("WAWebReactionDataUtils").reactionRowToReactionMsgData)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByChatWid:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedFeature)});function c(){return a.apply(this,arguments)}return c}(),bulkRemoveByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebSchemaReactions").getReactionsTable().bulkRemoveByIndex(["msgKey"],a.map(function(a){return a.toString()}))});function c(b){return a.apply(this,arguments)}return c}(),getByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaReactions").getReactionsTable().equals(["msgKey"],a.toString()))[0];return a==null?a:d("WAWebReactionDataUtils").reactionRowToReactionMsgData(a)});function c(b){return a.apply(this,arguments)}return c}(),updateAck:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e;if(a.kind===d("WAWebMsgType").MsgKind.ReactionEncrypted)e=a.targetMessageKey;else if(a.kind===d("WAWebMsgType").MsgKind.ReactionDecrypted)e=a.reactionParentKey;else throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedMsgType);yield d("WAWebSchemaReactions").getReactionsTable().merge([e.toString(),c("WANullthrows")(d("WAWebMsgGetters").getSender(a)).toString()],{ack:b})});function e(b,c){return a.apply(this,arguments)}return e}(),markAsRead:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield h.getByMsgKey(a));if(a!=null)return h.bulkUpsert([babelHelpers["extends"]({},a,{read:!0})])});function c(b){return a.apply(this,arguments)}return c}(),getTableSize:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebSchemaReactions").getReactionsTable().count()});function c(){return a.apply(this,arguments)}return c}()};g.reactionTableMode=h}),98);
__d("WAWebAddonUnifiedAddonsTableMode",["WAWebAddonConstants","WAWebAddonInfraError","WAWebMsgType","WAWebPinsDbSerialization","WAWebSchemaUnifiedAddons","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=function(a){return a.map(function(a){if(a.rowType===d("WAWebAddonConstants").AddonMinimizedType.PinInChat)return d("WAWebPinsDbSerialization").unifiedAddonRowIntoPinInChatMsgData(a);throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedMsgType)})};a={mode:d("WAWebAddonConstants").AddonTableMode.Unified,bulkUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(function(a){if(a.kind===d("WAWebMsgType").MsgKind.PinInChat)return d("WAWebPinsDbSerialization").pinInChatMsgDatIntoUnifiedAddonRow(a);throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError)});yield d("WAWebSchemaUnifiedAddons").getTable().bulkCreateOrReplace(a)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByParentAndSender:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedFeature)});function c(){return a.apply(this,arguments)}return c}(),bulkGetByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError)});function c(){return a.apply(this,arguments)}return c}(),bulkGetByParentMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaUnifiedAddons").getTable().anyOf(["targetMsgKey"],a.map(function(a){return a.toString()})));return h(a)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByChatWid:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaUnifiedAddons").getTable().anyOf(["arbitraryIndex"],a.map(function(a){return a.toString()})));return h(a)});function c(b){return a.apply(this,arguments)}return c}(),bulkRemoveByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebSchemaUnifiedAddons").getTable().bulkRemove(a.map(function(a){return a.toString()}))});function c(b){return a.apply(this,arguments)}return c}(),getByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaUnifiedAddons").getTable().get(a.toString()));return a==null?null:h([a])[0]});function c(b){return a.apply(this,arguments)}return c}(),updateAck:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){yield d("WAWebSchemaUnifiedAddons").getTable().merge(a.id.toString(),{ack:b})});function c(b,c){return a.apply(this,arguments)}return c}(),markAsRead:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError)});function c(){return a.apply(this,arguments)}return c}(),getTableSize:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebSchemaUnifiedAddons").getTable().count()});function c(){return a.apply(this,arguments)}return c}()};g.unifiedAddonsTableMode=a}),98);
__d("AddonPlaceholderMsgsUtils",["WAWebAddonConstants","WAWebAddonDBTable","WAWebAddonInfraError","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){var b=a.addons;a=a.processor;if(a.type!==d("WAWebAddonConstants").AddonProcessorType.DualEncryptedWithMessageTraits)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedFeature);a=[];for(b of b)b.kind===d("WAWebMsgType").MsgKind.PlaceholderAddon&&a.push(b.id);return a.length===0?null:a}function c(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("WAWebAddonDBTable").addonInternalDBTable.bulkGetByMsgKey(a,b));b=new Set();for(a of a)a!=null&&a.kind===d("WAWebMsgType").MsgKind.PlaceholderAddon&&b.add(a.id.toString());return b});return h.apply(this,arguments)}g.getIncomingPlaceholderKeys=a;g.getPlaceholderMsgKeys=c}),98);
__d("WAWebAddOnParseWebMsgInfo",["WALongInt","WANullthrows","WATimeUtils","WAWebE2EProtoUtils","WAWebMsgKey","WAWebUserPrefsMeUser","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a,b,e){var f=!!a.fromMe,g=d("WAWebE2EProtoUtils").decodeJid(a.remoteJid),h;f?g!=null&&typeof g!=="string"&&!g.isUser()&&(b===!0?h=d("WAWebUserPrefsMeUser").getMaybeMeLidUser():h=d("WAWebUserPrefsMeUser").getMeUser()):h=e!=null?d("WAWebE2EProtoUtils").decodeJid(e):d("WAWebE2EProtoUtils").decodeJid(a.participant);if(typeof g==="string"||g==null)return null;h!=null&&typeof h!=="string"?e=new(c("WAWebMsgKey"))({id:c("WANullthrows")(a.id),fromMe:f,remote:g,participant:h}):e=new(c("WAWebMsgKey"))({id:c("WANullthrows")(a.id),fromMe:f,remote:g});a=b===!0?c("WANullthrows")(d("WAWebUserPrefsMeUser").getMaybeMeLidUser()):d("WAWebUserPrefsMeUser").getMeUser();g=e.participant||e.remote;b=d("WAWebWidFactory").toUserWid(f===!0?a:g);return{msgKey:e,sender:b}}function b(a){return a==null?null:Math.floor(d("WALongInt").numberOrThrowIfTooLarge(a)/1e3)}function e(a){var b=d("WATimeUtils").unixTimeMs();return a==null?b:Math.max(a+1,b)}g.buildAddonMsgKey=a;g.getAddonServerTimestamp=b;g.getIncreasingLatestSenderTimestampMs=e}),98);
__d("WAWebAddonGatingUtils",["WAWebAddonCrossWindowUtils","WAWebAddonPluginProcessor","WAWebAddonProcessMsgsUtils"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebAddonPluginProcessor").hasAddonProcessor(a)?d("WAWebAddonPluginProcessor").getAddonProcessor(a).isEnabled():!1}function b(a){a=d("WAWebAddonProcessMsgsUtils").castToAddonMsgData(a);return a==null||!d("WAWebAddonCrossWindowUtils").isInfraSupportedAddon(a)?!1:d("WAWebAddonPluginProcessor").getAddonProcessor(a).isEnabled()}g.isUnifiedInfraEnabledForType=a;g.isUnifiedInfraEnabled=b}),98);
__d("WAWebReactionGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("flattened_reactions_collection")}function b(){return d("WAWebABProps").getABPropConfigValue("web_reaction_notification_via_add_on_api")}g.isFlattenedReactionsEnabled=a;g.isReactionNotificationAddOnApiEnabled=b}),98);
__d("WAWebProtobufsUserPassword.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({NONE:0,PBKDF2_HMAC_SHA512:1,PBKDF2_HMAC_SHA384:2});c=b("$InternalEnum")({UTF8:0,UTF8_BROKEN:1});e={};f={};b={};e.internalSpec={encoding:[1,(d=d("WAProtoConst")).TYPES.ENUM,c],transformer:[2,d.TYPES.ENUM,a],transformerArg:[3,d.FLAGS.REPEATED|d.TYPES.MESSAGE,f],transformedData:[4,d.TYPES.BYTES]};f.internalSpec={key:[1,d.TYPES.STRING],value:[2,d.TYPES.MESSAGE,b]};b.internalSpec={asBlob:[1,d.TYPES.BYTES],asUnsignedInteger:[2,d.TYPES.UINT32],__oneofs__:{value:["asBlob","asUnsignedInteger"]}};g.UserPassword$Transformer=a;g.UserPassword$Encoding=c;g.UserPasswordSpec=e;g.UserPassword$TransformerArgSpec=f;g.UserPassword$TransformerArg$ValueSpec=b}),98);
__d("WAWebProtobufsChatLockSettings.pb",["WAProtoConst","WAWebProtobufsUserPassword.pb"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={hideLockedChats:[1,d("WAProtoConst").TYPES.BOOL],secretCode:[2,d("WAProtoConst").TYPES.MESSAGE,d("WAWebProtobufsUserPassword.pb").UserPasswordSpec]};g.ChatLockSettingsSpec=a}),98);
__d("WAWebProtobufsDeviceCapabilities.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({NONE:0,MINIMAL:1,FULL:2});c={};c.internalSpec={chatLockSupportLevel:[1,d("WAProtoConst").TYPES.ENUM,a]};g.DeviceCapabilities$ChatLockSupportLevel=a;g.DeviceCapabilitiesSpec=c}),98);
__d("WAWebProtobufsProtocol.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={remoteJid:[1,(b=d("WAProtoConst")).TYPES.STRING],fromMe:[2,b.TYPES.BOOL],id:[3,b.TYPES.STRING],participant:[4,b.TYPES.STRING]};g.MessageKeySpec=a}),98);
__d("WAWebProtobufSyncAction.pb",["$InternalEnum","WAProtoConst","WAWebProtobufsChatLockSettings.pb","WAWebProtobufsDeviceCapabilities.pb","WAWebProtobufsProtocol.pb"],(function(a,b,c,d,e,f,g){var h;c=(a=b("$InternalEnum"))({REGULAR:0,SCHEDULED_CALL:1,VOICE_CHAT:2});e=a({NONE:0,SCHEDULED:1,PRIVACY:2,LIGHTWEIGHT:3});f=a({CONNECTED:0,REJECTED:1,CANCELLED:2,ACCEPTEDELSEWHERE:3,MISSED:4,INVALID:5,UNAVAILABLE:6,UPCOMING:7,FAILED:8,ABANDONED:9,ONGOING:10});b=a({DEFAULT_ALL_MESSAGES:0,ALL_MESSAGES:1,HIGHLIGHTS:2,DEFAULT_HIGHLIGHTS:3});var aa=a({ACTIVE:0}),ba=a({ACTIVE:0,INACTIVE:1}),ca=a({UNSTRUCTURED:1,STRUCTURED:2}),da=a({ALLOW_LIST:0,DENY_LIST:1,CONTACTS:2}),ea=a({PERSONALIZED:0}),fa=a({LID:1,PN:2}),ga=a({NONE:0,UNREAD:1,GROUPS:2,FAVORITES:3,PREDEFINED:4,CUSTOM:5});a=a({ANDROID:0,SMBA:1,IPHONE:2,SMBI:3,WEB:4,UWP:5,DARWIN:6});var i={},j={},k={},l={},m={},n={},o={},p={},q={},r={},s={},t={},u={},v={},w={},x={},y={},z={},A={},B={},C={},D={},E={},F={},G={},H={},I={},J={},K={},L={},M={},N={},O={},P={},Q={},R={},S={},T={},U={},V={},W={},X={},Y={},Z={},$={},ha={},ia={},ja={},ka={},la={},ma={},na={},oa={},pa={},qa={},ra={},sa={},ta={},ua={},va={},wa={},xa={};i.internalSpec={emoji:[1,(h=d("WAProtoConst")).TYPES.STRING],weight:[2,h.TYPES.FLOAT]};j.internalSpec={callResult:[1,h.TYPES.ENUM,f],isDndMode:[2,h.TYPES.BOOL],silenceReason:[3,h.TYPES.ENUM,e],duration:[4,h.TYPES.INT64],startTime:[5,h.TYPES.INT64],isIncoming:[6,h.TYPES.BOOL],isVideo:[7,h.TYPES.BOOL],isCallLink:[8,h.TYPES.BOOL],callLinkToken:[9,h.TYPES.STRING],scheduledCallId:[10,h.TYPES.STRING],callId:[11,h.TYPES.STRING],callCreatorJid:[12,h.TYPES.STRING],groupJid:[13,h.TYPES.STRING],participants:[14,h.FLAGS.REPEATED|h.TYPES.MESSAGE,k],callType:[15,h.TYPES.ENUM,c]};k.internalSpec={userJid:[1,h.TYPES.STRING],callResult:[2,h.TYPES.ENUM,f]};l.internalSpec={timestamp:[1,h.TYPES.INT64],starAction:[2,h.TYPES.MESSAGE,va],contactAction:[3,h.TYPES.MESSAGE,ua],muteAction:[4,h.TYPES.MESSAGE,ta],pinAction:[5,h.TYPES.MESSAGE,sa],securityNotificationSetting:[6,h.TYPES.MESSAGE,ra],pushNameSetting:[7,h.TYPES.MESSAGE,qa],quickReplyAction:[8,h.TYPES.MESSAGE,oa],recentEmojiWeightsAction:[11,h.TYPES.MESSAGE,la],labelEditAction:[14,h.TYPES.MESSAGE,ma],labelAssociationAction:[15,h.TYPES.MESSAGE,na],localeSetting:[16,h.TYPES.MESSAGE,pa],archiveChatAction:[17,h.TYPES.MESSAGE,ka],deleteMessageForMeAction:[18,h.TYPES.MESSAGE,ja],keyExpiration:[19,h.TYPES.MESSAGE,W],markChatAsReadAction:[20,h.TYPES.MESSAGE,ia],clearChatAction:[21,h.TYPES.MESSAGE,ha],deleteChatAction:[22,h.TYPES.MESSAGE,$],unarchiveChatsSetting:[23,h.TYPES.MESSAGE,Z],primaryFeature:[24,h.TYPES.MESSAGE,V],androidUnsupportedActions:[26,h.TYPES.MESSAGE,U],agentAction:[27,h.TYPES.MESSAGE,T],subscriptionAction:[28,h.TYPES.MESSAGE,S],userStatusMuteAction:[29,h.TYPES.MESSAGE,R],timeFormatAction:[30,h.TYPES.MESSAGE,Q],nuxAction:[31,h.TYPES.MESSAGE,P],primaryVersionAction:[32,h.TYPES.MESSAGE,O],stickerAction:[33,h.TYPES.MESSAGE,M],removeRecentStickerAction:[34,h.TYPES.MESSAGE,N],chatAssignment:[35,h.TYPES.MESSAGE,L],chatAssignmentOpenedStatus:[36,h.TYPES.MESSAGE,K],pnForLidChatAction:[37,h.TYPES.MESSAGE,J],marketingMessageAction:[38,h.TYPES.MESSAGE,H],marketingMessageBroadcastAction:[39,h.TYPES.MESSAGE,G],externalWebBetaAction:[40,h.TYPES.MESSAGE,F],privacySettingRelayAllCalls:[41,h.TYPES.MESSAGE,E],callLogAction:[42,h.TYPES.MESSAGE,D],statusPrivacy:[44,h.TYPES.MESSAGE,C],botWelcomeRequestAction:[45,h.TYPES.MESSAGE,B],deleteIndividualCallLog:[46,h.TYPES.MESSAGE,A],labelReorderingAction:[47,h.TYPES.MESSAGE,z],paymentInfoAction:[48,h.TYPES.MESSAGE,y],customPaymentMethodsAction:[49,h.TYPES.MESSAGE,v],lockChatAction:[50,h.TYPES.MESSAGE,u],chatLockSettings:[51,h.TYPES.MESSAGE,d("WAWebProtobufsChatLockSettings.pb").ChatLockSettingsSpec],wamoUserIdentifierAction:[52,h.TYPES.MESSAGE,t],privacySettingDisableLinkPreviewsAction:[53,h.TYPES.MESSAGE,s],deviceCapabilities:[54,h.TYPES.MESSAGE,d("WAWebProtobufsDeviceCapabilities.pb").DeviceCapabilitiesSpec],noteEditAction:[55,h.TYPES.MESSAGE,r],favoritesAction:[56,h.TYPES.MESSAGE,p],merchantPaymentPartnerAction:[57,h.TYPES.MESSAGE,o],waffleAccountLinkStateAction:[58,h.TYPES.MESSAGE,n],usernameChatStartMode:[59,h.TYPES.MESSAGE,I],notificationActivitySettingAction:[60,h.TYPES.MESSAGE,m]};m.internalSpec={notificationActivitySetting:[1,h.TYPES.ENUM,b]};n.internalSpec={linkState:[2,h.TYPES.ENUM,aa]};o.internalSpec={status:[1,h.FLAGS.REQUIRED|h.TYPES.ENUM,ba],country:[2,h.FLAGS.REQUIRED|h.TYPES.STRING],gatewayName:[3,h.TYPES.STRING],credentialId:[4,h.TYPES.STRING]};p.internalSpec={favorites:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,q]};q.internalSpec={id:[1,h.TYPES.STRING]};r.internalSpec={type:[1,h.TYPES.ENUM,ca],chatJid:[2,h.TYPES.STRING],createdAt:[3,h.TYPES.INT64],deleted:[4,h.TYPES.BOOL],unstructuredContent:[5,h.TYPES.STRING]};s.internalSpec={isPreviewsDisabled:[1,h.TYPES.BOOL]};t.internalSpec={identifier:[1,h.TYPES.STRING]};u.internalSpec={locked:[1,h.TYPES.BOOL]};v.internalSpec={customPaymentMethods:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,w]};w.internalSpec={credentialId:[1,h.FLAGS.REQUIRED|h.TYPES.STRING],country:[2,h.FLAGS.REQUIRED|h.TYPES.STRING],type:[3,h.FLAGS.REQUIRED|h.TYPES.STRING],metadata:[4,h.FLAGS.REPEATED|h.TYPES.MESSAGE,x]};x.internalSpec={key:[1,h.FLAGS.REQUIRED|h.TYPES.STRING],value:[2,h.FLAGS.REQUIRED|h.TYPES.STRING]};y.internalSpec={cpi:[1,h.TYPES.STRING]};z.internalSpec={sortedLabelIds:[1,h.FLAGS.REPEATED|h.TYPES.INT32]};A.internalSpec={peerJid:[1,h.TYPES.STRING],isIncoming:[2,h.TYPES.BOOL]};B.internalSpec={isSent:[1,h.TYPES.BOOL]};C.internalSpec={mode:[1,h.TYPES.ENUM,da],userJid:[2,h.FLAGS.REPEATED|h.TYPES.STRING]};D.internalSpec={callLogRecord:[1,h.TYPES.MESSAGE,j]};E.internalSpec={isEnabled:[1,h.TYPES.BOOL]};F.internalSpec={isOptIn:[1,h.TYPES.BOOL]};G.internalSpec={repliedCount:[1,h.TYPES.INT32]};H.internalSpec={name:[1,h.TYPES.STRING],message:[2,h.TYPES.STRING],type:[3,h.TYPES.ENUM,ea],createdAt:[4,h.TYPES.INT64],lastSentAt:[5,h.TYPES.INT64],isDeleted:[6,h.TYPES.BOOL],mediaId:[7,h.TYPES.STRING]};I.internalSpec={chatStartMode:[1,h.TYPES.ENUM,fa]};J.internalSpec={pnJid:[1,h.TYPES.STRING]};K.internalSpec={chatOpened:[1,h.TYPES.BOOL]};L.internalSpec={deviceAgentID:[1,h.TYPES.STRING]};M.internalSpec={url:[1,h.TYPES.STRING],fileEncSha256:[2,h.TYPES.BYTES],mediaKey:[3,h.TYPES.BYTES],mimetype:[4,h.TYPES.STRING],height:[5,h.TYPES.UINT32],width:[6,h.TYPES.UINT32],directPath:[7,h.TYPES.STRING],fileLength:[8,h.TYPES.UINT64],isFavorite:[9,h.TYPES.BOOL],deviceIdHint:[10,h.TYPES.UINT32],isLottie:[11,h.TYPES.BOOL]};N.internalSpec={lastStickerSentTs:[1,h.TYPES.INT64]};O.internalSpec={version:[1,h.TYPES.STRING]};P.internalSpec={acknowledged:[1,h.TYPES.BOOL]};Q.internalSpec={isTwentyFourHourFormatEnabled:[1,h.TYPES.BOOL]};R.internalSpec={muted:[1,h.TYPES.BOOL]};S.internalSpec={isDeactivated:[1,h.TYPES.BOOL],isAutoRenewing:[2,h.TYPES.BOOL],expirationDate:[3,h.TYPES.INT64]};T.internalSpec={name:[1,h.TYPES.STRING],deviceID:[2,h.TYPES.INT32],isDeleted:[3,h.TYPES.BOOL]};U.internalSpec={allowed:[1,h.TYPES.BOOL]};V.internalSpec={flags:[1,h.FLAGS.REPEATED|h.TYPES.STRING]};W.internalSpec={expiredKeyEpoch:[1,h.TYPES.INT32]};X.internalSpec={key:[1,h.TYPES.MESSAGE,d("WAWebProtobufsProtocol.pb").MessageKeySpec],timestamp:[2,h.TYPES.INT64]};Y.internalSpec={lastMessageTimestamp:[1,h.TYPES.INT64],lastSystemMessageTimestamp:[2,h.TYPES.INT64],messages:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,X]};Z.internalSpec={unarchiveChats:[1,h.TYPES.BOOL]};$.internalSpec={messageRange:[1,h.TYPES.MESSAGE,Y]};ha.internalSpec={messageRange:[1,h.TYPES.MESSAGE,Y]};ia.internalSpec={read:[1,h.TYPES.BOOL],messageRange:[2,h.TYPES.MESSAGE,Y]};ja.internalSpec={deleteMedia:[1,h.TYPES.BOOL],messageTimestamp:[2,h.TYPES.INT64]};ka.internalSpec={archived:[1,h.TYPES.BOOL],messageRange:[2,h.TYPES.MESSAGE,Y]};la.internalSpec={weights:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,i]};ma.internalSpec={name:[1,h.TYPES.STRING],color:[2,h.TYPES.INT32],predefinedId:[3,h.TYPES.INT32],deleted:[4,h.TYPES.BOOL],orderIndex:[5,h.TYPES.INT32],isActive:[6,h.TYPES.BOOL],type:[7,h.TYPES.ENUM,ga]};na.internalSpec={labeled:[1,h.TYPES.BOOL]};oa.internalSpec={shortcut:[1,h.TYPES.STRING],message:[2,h.TYPES.STRING],keywords:[3,h.FLAGS.REPEATED|h.TYPES.STRING],count:[4,h.TYPES.INT32],deleted:[5,h.TYPES.BOOL]};pa.internalSpec={locale:[1,h.TYPES.STRING]};qa.internalSpec={name:[1,h.TYPES.STRING]};ra.internalSpec={showNotification:[1,h.TYPES.BOOL]};sa.internalSpec={pinned:[1,h.TYPES.BOOL]};ta.internalSpec={muted:[1,h.TYPES.BOOL],muteEndTimestamp:[2,h.TYPES.INT64],autoMuted:[3,h.TYPES.BOOL]};ua.internalSpec={fullName:[1,h.TYPES.STRING],firstName:[2,h.TYPES.STRING],lidJid:[3,h.TYPES.STRING],saveOnPrimaryAddressbook:[4,h.TYPES.BOOL]};va.internalSpec={starred:[1,h.TYPES.BOOL]};wa.internalSpec={index:[1,h.TYPES.BYTES],value:[2,h.TYPES.MESSAGE,l],padding:[3,h.TYPES.BYTES],version:[4,h.TYPES.INT32]};xa.internalSpec={currentLthash:[1,h.TYPES.BYTES],newLthash:[2,h.TYPES.BYTES],patchVersion:[3,h.TYPES.BYTES],collectionName:[4,h.TYPES.BYTES],firstFourBytesFromAHashOfSnapshotMacKey:[5,h.TYPES.BYTES],newLthashSubtract:[6,h.TYPES.BYTES],numberAdd:[7,h.TYPES.INT32],numberRemove:[8,h.TYPES.INT32],numberOverride:[9,h.TYPES.INT32],senderPlatform:[10,h.TYPES.ENUM,a],isSenderPrimary:[11,h.TYPES.BOOL]};g.CallLogRecord$CallType=c;g.CallLogRecord$SilenceReason=e;g.CallLogRecord$CallResult=f;g.SyncActionValue$NotificationActivitySettingAction$NotificationActivitySetting=b;g.SyncActionValue$WaffleAccountLinkStateAction$AccountLinkState=aa;g.SyncActionValue$MerchantPaymentPartnerAction$Status=ba;g.SyncActionValue$NoteEditAction$NoteType=ca;g.SyncActionValue$StatusPrivacyAction$StatusDistributionMode=da;g.SyncActionValue$MarketingMessageAction$MarketingMessagePrototypeType=ea;g.SyncActionValue$UsernameChatStartModeAction$ChatStartMode=fa;g.SyncActionValue$LabelEditAction$ListType=ga;g.PatchDebugData$Platform=a;g.RecentEmojiWeightSpec=i;g.CallLogRecordSpec=j;g.CallLogRecord$ParticipantInfoSpec=k;g.SyncActionValueSpec=l;g.SyncActionValue$NotificationActivitySettingActionSpec=m;g.SyncActionValue$WaffleAccountLinkStateActionSpec=n;g.SyncActionValue$MerchantPaymentPartnerActionSpec=o;g.SyncActionValue$FavoritesActionSpec=p;g.SyncActionValue$FavoritesAction$FavoriteSpec=q;g.SyncActionValue$NoteEditActionSpec=r;g.SyncActionValue$PrivacySettingDisableLinkPreviewsActionSpec=s;g.SyncActionValue$WamoUserIdentifierActionSpec=t;g.SyncActionValue$LockChatActionSpec=u;g.SyncActionValue$CustomPaymentMethodsActionSpec=v;g.SyncActionValue$CustomPaymentMethodSpec=w;g.SyncActionValue$CustomPaymentMethodMetadataSpec=x;g.SyncActionValue$PaymentInfoActionSpec=y;g.SyncActionValue$LabelReorderingActionSpec=z;g.SyncActionValue$DeleteIndividualCallLogActionSpec=A;g.SyncActionValue$BotWelcomeRequestActionSpec=B;g.SyncActionValue$StatusPrivacyActionSpec=C;g.SyncActionValue$CallLogActionSpec=D;g.SyncActionValue$PrivacySettingRelayAllCallsSpec=E;g.SyncActionValue$ExternalWebBetaActionSpec=F;g.SyncActionValue$MarketingMessageBroadcastActionSpec=G;g.SyncActionValue$MarketingMessageActionSpec=H;g.SyncActionValue$UsernameChatStartModeActionSpec=I;g.SyncActionValue$PnForLidChatActionSpec=J;g.SyncActionValue$ChatAssignmentOpenedStatusActionSpec=K;g.SyncActionValue$ChatAssignmentActionSpec=L;g.SyncActionValue$StickerActionSpec=M;g.SyncActionValue$RemoveRecentStickerActionSpec=N;g.SyncActionValue$PrimaryVersionActionSpec=O;g.SyncActionValue$NuxActionSpec=P;g.SyncActionValue$TimeFormatActionSpec=Q;g.SyncActionValue$UserStatusMuteActionSpec=R;g.SyncActionValue$SubscriptionActionSpec=S;g.SyncActionValue$AgentActionSpec=T;g.SyncActionValue$AndroidUnsupportedActionsSpec=U;g.SyncActionValue$PrimaryFeatureSpec=V;g.SyncActionValue$KeyExpirationSpec=W;g.SyncActionValue$SyncActionMessageSpec=X;g.SyncActionValue$SyncActionMessageRangeSpec=Y;g.SyncActionValue$UnarchiveChatsSettingSpec=Z;g.SyncActionValue$DeleteChatActionSpec=$;g.SyncActionValue$ClearChatActionSpec=ha;g.SyncActionValue$MarkChatAsReadActionSpec=ia;g.SyncActionValue$DeleteMessageForMeActionSpec=ja;g.SyncActionValue$ArchiveChatActionSpec=ka;g.SyncActionValue$RecentEmojiWeightsActionSpec=la;g.SyncActionValue$LabelEditActionSpec=ma;g.SyncActionValue$LabelAssociationActionSpec=na;g.SyncActionValue$QuickReplyActionSpec=oa;g.SyncActionValue$LocaleSettingSpec=pa;g.SyncActionValue$PushNameSettingSpec=qa;g.SyncActionValue$SecurityNotificationSettingSpec=ra;g.SyncActionValue$PinActionSpec=sa;g.SyncActionValue$MuteActionSpec=ta;g.SyncActionValue$ContactActionSpec=ua;g.SyncActionValue$StarActionSpec=va;g.SyncActionDataSpec=wa;g.PatchDebugDataSpec=xa}),98);
__d("WAWebProtobufsCompanionReg.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({UNKNOWN:0,CHROME:1,FIREFOX:2,IE:3,OPERA:4,SAFARI:5,EDGE:6,DESKTOP:7,IPAD:8,ANDROID_TABLET:9,OHANA:10,ALOHA:11,CATALINA:12,TCL_TV:13,IOS_PHONE:14,IOS_CATALYST:15,ANDROID_PHONE:16,ANDROID_AMBIGUOUS:17,WEAR_OS:18,AR_WRIST:19,AR_DEVICE:20,UWP:21,VR:22,CLOUD_API:23,SMARTGLASSES:24});c={};e={};f={};b={};var h={},i={},j={},k={},l={},m={};c.internalSpec={os:[1,(d=d("WAProtoConst")).TYPES.STRING],version:[2,d.TYPES.MESSAGE,f],platformType:[3,d.TYPES.ENUM,a],requireFullSync:[4,d.TYPES.BOOL],historySyncConfig:[5,d.TYPES.MESSAGE,e]};e.internalSpec={fullSyncDaysLimit:[1,d.TYPES.UINT32],fullSyncSizeMbLimit:[2,d.TYPES.UINT32],storageQuotaMb:[3,d.TYPES.UINT32],inlineInitialPayloadInE2EeMsg:[4,d.TYPES.BOOL],recentSyncDaysLimit:[5,d.TYPES.UINT32],supportCallLogHistory:[6,d.TYPES.BOOL],supportBotUserAgentChatHistory:[7,d.TYPES.BOOL],supportCagReactionsAndPolls:[8,d.TYPES.BOOL],supportBizHostedMsg:[9,d.TYPES.BOOL],supportRecentSyncChunkMessageCountTuning:[10,d.TYPES.BOOL],supportHostedGroupMsg:[11,d.TYPES.BOOL],supportFbidBotChatHistory:[12,d.TYPES.BOOL],supportAddOnHistorySyncMigration:[13,d.TYPES.BOOL],supportMessageAssociation:[14,d.TYPES.BOOL]};f.internalSpec={primary:[1,d.TYPES.UINT32],secondary:[2,d.TYPES.UINT32],tertiary:[3,d.TYPES.UINT32],quaternary:[4,d.TYPES.UINT32],quinary:[5,d.TYPES.UINT32]};b.internalSpec={publicKey:[1,d.TYPES.BYTES],deviceType:[2,d.TYPES.ENUM,a],ref:[3,d.TYPES.STRING]};h.internalSpec={hash:[1,d.TYPES.BYTES]};i.internalSpec={companionEphemeralIdentity:[1,d.TYPES.BYTES],commitment:[2,d.TYPES.MESSAGE,h]};j.internalSpec={publicKey:[1,d.TYPES.BYTES],nonce:[2,d.TYPES.BYTES]};k.internalSpec={companionPublicKey:[1,d.TYPES.BYTES],companionIdentityKey:[2,d.TYPES.BYTES],advSecret:[3,d.TYPES.BYTES]};l.internalSpec={encryptedPayload:[1,d.TYPES.BYTES],iv:[2,d.TYPES.BYTES]};m.internalSpec={isChatDbLidMigrated:[1,d.TYPES.BOOL]};g.DeviceProps$PlatformType=a;g.DevicePropsSpec=c;g.DeviceProps$HistorySyncConfigSpec=e;g.DeviceProps$AppVersionSpec=f;g.CompanionEphemeralIdentitySpec=b;g.CompanionCommitmentSpec=h;g.ProloguePayloadSpec=i;g.PrimaryEphemeralIdentitySpec=j;g.PairingRequestSpec=k;g.EncryptedPairingRequestSpec=l;g.ClientPairingPropsSpec=m}),98);
__d("WAWebProtobufsMmsRetry.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({GENERAL_ERROR:0,SUCCESS:1,NOT_FOUND:2,DECRYPTION_ERROR:3});c={};e={};c.internalSpec={stanzaId:[1,(f=d("WAProtoConst")).TYPES.STRING],directPath:[2,f.TYPES.STRING],result:[3,f.TYPES.ENUM,a],messageSecret:[4,f.TYPES.BYTES]};e.internalSpec={stanzaId:[1,f.TYPES.STRING]};g.MediaRetryNotification$ResultType=a;g.MediaRetryNotificationSpec=c;g.ServerErrorReceiptSpec=e}),98);
__d("WAWebProtobufsE2E.pb",["$InternalEnum","WAProtoConst","WAWebProtobufsAdv.pb","WAWebProtobufsCompanionReg.pb","WAWebProtobufsMmsRetry.pb","WAWebProtobufsProtocol.pb"],(function(a,b,c,d,e,f,g){var h,i;c=(a=b("$InternalEnum"))({FIRST_PARTY:0,THIRD_PARTY:1,USER_CREATED:2});e=a({MASK_LINKED_DEVICES:0});f=a({UNKNOWN:0,AUDIO:1,VIDEO:2});b=a({CONNECTED:0,MISSED:1,FAILED:2,REJECTED:3,ACCEPTED_ELSEWHERE:4,ONGOING:5,SILENCED_BY_DND:6,SILENCED_UNKNOWN_CALLER:7});var aa=a({REGULAR:0,SCHEDULED_CALL:1,VOICE_CHAT:2}),ba=a({UNKNOWN:0,CANCEL:1}),ca=a({UNKNOWN:0,VOICE:1,VIDEO:2}),da=a({UNKNOWN:0,GOING:1,NOT_GOING:2,MAYBE:3}),ea=a({UNKNOWN_TYPE:0,PIN_FOR_ALL:1,UNPIN_FOR_ALL:2}),fa=a({POLL:0,QUIZ:1}),ga=a({TEXT:1,IMAGE:2}),ha=a({UNKNOWN:0,DISPLAY_TEXT:1}),ia=a({UNKNOWN:0,RESPONSE:1,NATIVE_FLOW:2}),ja=a({UNKNOWN:0,EMPTY:1,TEXT:2,DOCUMENT:3,IMAGE:4,VIDEO:5,LOCATION:6}),ka=a({UNKNOWN:0,EVENT_EDIT:1}),la=a({DEFAULT:0,PARENT:1}),j=a({DEFAULT:0,EXTENSIONS_1:1}),ma=a({UNKNOWN_SURFACE:0,FB:1,IG:2,WA:3}),na=a({UNKNOWN:0,SINGLE_SELECT:1}),oa=a({UNKNOWN:0,SINGLE_SELECT:1,PRODUCT_LIST:2}),pa=a({CATALOG:1}),qa=a({INQUIRY:1,ACCEPTED:2,DECLINED:3}),ra=a({UNKNOWN:0,FBPAY:1,NOVI:2,UPI:3}),sa=a({GREGORIAN:1,SOLAR_HIJRI:2}),ta=a({MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6,SUNDAY:7}),ua=a({REQUEST_SUCCESS:0,REQUEST_TIME_EXPIRED:1,DECLINED_SHARING_HISTORY:2,GENERIC_ERROR:3,ERROR_REQUEST_ON_NON_SMB_PRIMARY:4,ERROR_HOSTED_DEVICE_NOT_CONNECTED:5,ERROR_HOSTED_DEVICE_LOGIN_TIME_NOT_SET:6}),k=a({UPLOAD_STICKER:0,SEND_RECENT_STICKER_BOOTSTRAP:1,GENERATE_LINK_PREVIEW:2,HISTORY_SYNC_ON_DEMAND:3,PLACEHOLDER_MESSAGE_RESEND:4,WAFFLE_LINKING_NONCE_FETCH:5,FULL_HISTORY_SYNC_ON_DEMAND:6,COMPANION_META_NONCE_FETCH:7}),va=a({INITIAL_BOOTSTRAP:0,INITIAL_STATUS_V3:1,FULL:2,RECENT:3,PUSH_NAME:4,NON_BLOCKING_DATA:5,ON_DEMAND:6,NO_HISTORY:7}),wa=a({EMPTY:0,NON_EMPTY:1}),xa=a({REVOKE:0,EPHEMERAL_SETTING:3,EPHEMERAL_SYNC_RESPONSE:4,HISTORY_SYNC_NOTIFICATION:5,APP_STATE_SYNC_KEY_SHARE:6,APP_STATE_SYNC_KEY_REQUEST:7,MSG_FANOUT_BACKFILL_REQUEST:8,INITIAL_SECURITY_NOTIFICATION_SETTING_SYNC:9,APP_STATE_FATAL_EXCEPTION_NOTIFICATION:10,SHARE_PHONE_NUMBER:11,MESSAGE_EDIT:14,PEER_DATA_OPERATION_REQUEST_MESSAGE:16,PEER_DATA_OPERATION_REQUEST_RESPONSE_MESSAGE:17,REQUEST_WELCOME_MESSAGE:18,BOT_FEEDBACK_MESSAGE:19,MEDIA_NOTIFY_MESSAGE:20,CLOUD_API_THREAD_CONTROL_NOTIFICATION:21,LID_MIGRATION_MAPPING_SYNC:22,REMINDER_MESSAGE:23,BOT_MEMU_ONBOARDING_MESSAGE:24,STATUS_MENTION_MESSAGE:25}),ya=a({UNKNOWN:0,CONTROL_PASSED:1,CONTROL_TAKEN:2}),za=a({GENERIC:0}),Aa=a({BOT_FEEDBACK_MULTIPLE_POSITIVE_GENERIC:1}),Ba=a({BOT_FEEDBACK_MULTIPLE_NEGATIVE_GENERIC:1,BOT_FEEDBACK_MULTIPLE_NEGATIVE_HELPFUL:2,BOT_FEEDBACK_MULTIPLE_NEGATIVE_INTERESTING:4,BOT_FEEDBACK_MULTIPLE_NEGATIVE_ACCURATE:8,BOT_FEEDBACK_MULTIPLE_NEGATIVE_SAFE:16,BOT_FEEDBACK_MULTIPLE_NEGATIVE_OTHER:32,BOT_FEEDBACK_MULTIPLE_NEGATIVE_REFUSED:64,BOT_FEEDBACK_MULTIPLE_NEGATIVE_NOT_VISUALLY_APPEALING:128,BOT_FEEDBACK_MULTIPLE_NEGATIVE_NOT_RELEVANT_TO_TEXT:256}),Ca=a({BOT_FEEDBACK_POSITIVE:0,BOT_FEEDBACK_NEGATIVE_GENERIC:1,BOT_FEEDBACK_NEGATIVE_HELPFUL:2,BOT_FEEDBACK_NEGATIVE_INTERESTING:3,BOT_FEEDBACK_NEGATIVE_ACCURATE:4,BOT_FEEDBACK_NEGATIVE_SAFE:5,BOT_FEEDBACK_NEGATIVE_OTHER:6,BOT_FEEDBACK_NEGATIVE_REFUSED:7,BOT_FEEDBACK_NEGATIVE_NOT_VISUALLY_APPEALING:8,BOT_FEEDBACK_NEGATIVE_NOT_RELEVANT_TO_TEXT:9}),Da=a({NONE:0,GIPHY:1,TENOR:2}),l=a({DEFAULT:0,PARENT:1,SUB:2,DEFAULT_SUB:3}),Ea=a({NONE:0,VIDEO:1,PLACEHOLDER:4,IMAGE:5,PAYMENT_LINKS:6,PROFILE:7}),Fa=a({SYSTEM:0,SYSTEM_TEXT:1,FB_SCRIPT:2,SYSTEM_BOLD:6,MORNINGBREEZE_REGULAR:7,CALISTOGA_REGULAR:8,EXO2_EXTRABOLD:9,COURIERPRIME_BOLD:10}),Ga=a({IMAGE:0,PDF:1}),Ha=a({USER_IMAGE:0,AI_GENERATED:1,AI_MODIFIED:2}),Ia=a({UPDATE:1,UPDATE_CARD:2,LINK_CARD:3}),Ja=a({NONE:0,IMAGE:1,VIDEO:2}),Ka=a({NONE:0,IMAGE:1,VIDEO:2}),m=a({REELS:1,SEARCH:2}),La=a({BING:1,GOOGLE:2,SUPPORT:3}),Ma=a({NULL_STATE:1,TYPEAHEAD:2,USER_INPUT:3,EMU_FLASH:4,EMU_FLASH_FOLLOWUP:5,VOICE:6}),Na=a({CENTER:1,LEFT:2,RIGHT:3}),Oa=a({ONCE:1,DAILY:2,WEEKLY:3,BIWEEKLY:4,MONTHLY:5}),Pa=a({NOTIFY:1,CREATE:2,DELETE:3,UPDATE:4}),Qa=a({AVAILABLE:1,QUOTA_EXCEED_LIMIT:2}),Ra=a({LLAMA_PROD:1,LLAMA_PROD_PREMIUM:2}),Sa=a({PROGRESS_INDICATOR:1,RICH_RESPONSE_HEADING:2,RICH_RESPONSE_NESTED_LIST:3,AI_MEMORY:4,WA_IG_1P_PLUGIN_RANKING_CONTROL:10,WA_IG_1P_PLUGIN_RANKING_UPDATE_1:11,WA_IG_1P_PLUGIN_RANKING_UPDATE_2:12}),Ta=a({UNKNOWN:0,IMAGINE:1,MEMU:2,FLASH:3,EDIT:4}),Ua=a({UNKNOWN:0,MEDIA_ALBUM:1,BOT_PLUGIN:2,EVENT_COVER_IMAGE:3,STATUS_POLL:4,HD_VIDEO_DUAL_UPLOAD:5,STATUS_TAPPABLE_MESSAGE:6,MEDIA_POLL:7,STATUS_ADD_YOURS:8}),Va=a({STATIC:1,DEPENDENT_ON_PARENT:2}),Wa=a({FULL:1,TALL:2,COMPACT:3}),Xa=a({UNKNOWN:0,DEFAULT:1}),Ya=a({UNKNOWN:0,CHAT_SETTING:1,ACCOUNT_SETTING:2,BULK_CHANGE:3,BIZ_SUPPORTS_FB_HOSTING:4,UNKNOWN_GROUPS:5}),Za=a({CHANGED_IN_CHAT:0,INITIATED_BY_ME:1,INITIATED_BY_OTHER:2,BIZ_UPGRADE_FB_HOSTING:3}),$a=a({UNKNOWN:0,KEEP_FOR_ALL:1,UNDO_KEEP_FOR_ALL:2});a=a({UNDEFINED:0,LOW:1,MID:2,HIGH:3});var n={},o={},p={},q={},r={},s={},t={},ab={},bb={},cb={},db={},eb={},fb={},gb={},hb={},ib={},jb={},kb={},lb={},mb={},nb={},ob={},pb={},qb={},rb={},u={},v={},sb={},tb={},ub={},vb={},wb={},xb={},yb={},zb={},w={},Ab={},Bb={},Cb={},Db={},Eb={},x={},y={},z={},A={},B={},Fb={},C={},D={},Gb={},Hb={},Ib={},Jb={},Kb={},Lb={},Mb={},Nb={},Ob={},Pb={},Qb={},Rb={},E={},F={},Sb={},Tb={},Ub={},G={},H={},Vb={},I={},Wb={},Xb={},Yb={},Zb={},$b={},ac={},J={},bc={},cc={},dc={},ec={},fc={},gc={},hc={},ic={},jc={},kc={},lc={},mc={},nc={},oc={},pc={},qc={},rc={},sc={},tc={},uc={},vc={},K={},wc={},xc={},yc={},zc={},Ac={},L={},Bc={},Cc={},Dc={},Ec={},Fc={},Gc={},Hc={},Ic={},M={},Jc={},N={},Kc={},Lc={},O={},P={},Mc={},Q={},R={},S={},T={},Nc={},U={},Oc={},V={},Pc={},Qc={},Rc={},Sc={},Tc={},Uc={},Vc={},Wc={},Xc={},Yc={},W={},Zc={},$c={},ad={},bd={},cd={},dd={},ed={},fd={},gd={},hd={},id={},X={},jd={},kd={},ld={},md={},Y={},nd={},od={},pd={},qd={},rd={},sd={},td={},ud={},vd={},wd={},xd={},Z={},yd={},$={},zd={},Ad={},Bd={},Cd={},Dd={},Ed={};n.internalSpec={conversation:[1,(h=d("WAProtoConst")).TYPES.STRING],senderKeyDistributionMessage:[2,h.TYPES.MESSAGE,R],imageMessage:[3,h.TYPES.MESSAGE,Q],contactMessage:[4,h.TYPES.MESSAGE,P],locationMessage:[5,h.TYPES.MESSAGE,O],extendedTextMessage:[6,h.TYPES.MESSAGE,Kc],documentMessage:[7,h.TYPES.MESSAGE,N],audioMessage:[8,h.TYPES.MESSAGE,Jc],videoMessage:[9,h.TYPES.MESSAGE,M],call:[10,h.TYPES.MESSAGE,Ic],chat:[11,h.TYPES.MESSAGE,Hc],protocolMessage:[12,h.TYPES.MESSAGE,Ec],contactsArrayMessage:[13,h.TYPES.MESSAGE,gc],highlyStructuredMessage:[14,h.TYPES.MESSAGE,J],fastRatchetKeySenderKeyDistributionMessage:[15,h.TYPES.MESSAGE,R],sendPaymentMessage:[16,h.TYPES.MESSAGE,ac],liveLocationMessage:[18,h.TYPES.MESSAGE,Wb],requestPaymentMessage:[22,h.TYPES.MESSAGE,$b],declinePaymentRequestMessage:[23,h.TYPES.MESSAGE,Zb],cancelPaymentRequestMessage:[24,h.TYPES.MESSAGE,Yb],templateMessage:[25,h.TYPES.MESSAGE,G],stickerMessage:[26,h.TYPES.MESSAGE,I],groupInviteMessage:[28,h.TYPES.MESSAGE,Db],templateButtonReplyMessage:[29,h.TYPES.MESSAGE,Ub],productMessage:[30,h.TYPES.MESSAGE,F],deviceSentMessage:[31,h.TYPES.MESSAGE,Ab],messageContextInfo:[35,h.TYPES.MESSAGE,id],listMessage:[36,h.TYPES.MESSAGE,Lb],viewOnceMessage:[37,h.TYPES.MESSAGE,w],orderMessage:[38,h.TYPES.MESSAGE,E],listResponseMessage:[39,h.TYPES.MESSAGE,Jb],ephemeralMessage:[40,h.TYPES.MESSAGE,w],invoiceMessage:[41,h.TYPES.MESSAGE,Mc],buttonsMessage:[42,h.TYPES.MESSAGE,vb],buttonsResponseMessage:[43,h.TYPES.MESSAGE,ub],paymentInviteMessage:[44,h.TYPES.MESSAGE,Xb],interactiveMessage:[45,h.TYPES.MESSAGE,z],reactionMessage:[46,h.TYPES.MESSAGE,tb],stickerSyncRmrMessage:[47,h.TYPES.MESSAGE,sb],interactiveResponseMessage:[48,h.TYPES.MESSAGE,Eb],pollCreationMessage:[49,h.TYPES.MESSAGE,u],pollUpdateMessage:[50,h.TYPES.MESSAGE,rb],keepInChatMessage:[51,h.TYPES.MESSAGE,lb],documentWithCaptionMessage:[53,h.TYPES.MESSAGE,w],requestPhoneNumberMessage:[54,h.TYPES.MESSAGE,Bb],viewOnceMessageV2:[55,h.TYPES.MESSAGE,w],encReactionMessage:[56,h.TYPES.MESSAGE,jb],editedMessage:[58,h.TYPES.MESSAGE,w],viewOnceMessageV2Extension:[59,h.TYPES.MESSAGE,w],pollCreationMessageV2:[60,h.TYPES.MESSAGE,u],scheduledCallCreationMessage:[61,h.TYPES.MESSAGE,db],groupMentionedMessage:[62,h.TYPES.MESSAGE,w],pinInChatMessage:[63,h.TYPES.MESSAGE,kb],pollCreationMessageV3:[64,h.TYPES.MESSAGE,u],scheduledCallEditMessage:[65,h.TYPES.MESSAGE,cb],ptvMessage:[66,h.TYPES.MESSAGE,M],botInvokeMessage:[67,h.TYPES.MESSAGE,w],callLogMesssage:[69,h.TYPES.MESSAGE,ab],messageHistoryBundle:[70,h.TYPES.MESSAGE,t],encCommentMessage:[71,h.TYPES.MESSAGE,ib],bcallMessage:[72,h.TYPES.MESSAGE,s],lottieStickerMessage:[74,h.TYPES.MESSAGE,w],eventMessage:[75,h.TYPES.MESSAGE,gb],encEventResponseMessage:[76,h.TYPES.MESSAGE,fb],commentMessage:[77,h.TYPES.MESSAGE,hb],newsletterAdminInviteMessage:[78,h.TYPES.MESSAGE,Cb],placeholderMessage:[80,h.TYPES.MESSAGE,r],secretEncryptedMessage:[82,h.TYPES.MESSAGE,zb],albumMessage:[83,h.TYPES.MESSAGE,q],eventCoverImage:[85,h.TYPES.MESSAGE,w],stickerPackMessage:[86,h.TYPES.MESSAGE,o],statusMentionMessage:[87,h.TYPES.MESSAGE,w],pollResultSnapshotMessage:[88,h.TYPES.MESSAGE,mb],pollCreationOptionImageMessage:[90,h.TYPES.MESSAGE,w],associatedChildMessage:[91,h.TYPES.MESSAGE,w],groupStatusMentionMessage:[92,h.TYPES.MESSAGE,w],pollCreationMessageV4:[93,h.TYPES.MESSAGE,w],pollCreationMessageV5:[94,h.TYPES.MESSAGE,w]};o.internalSpec={stickerPackId:[1,h.TYPES.STRING],name:[2,h.TYPES.STRING],publisher:[3,h.TYPES.STRING],stickers:[4,h.FLAGS.REPEATED|h.TYPES.MESSAGE,p],fileLength:[5,h.TYPES.UINT64],fileSha256:[6,h.TYPES.BYTES],fileEncSha256:[7,h.TYPES.BYTES],mediaKey:[8,h.TYPES.BYTES],directPath:[9,h.TYPES.STRING],caption:[10,h.TYPES.STRING],contextInfo:[11,h.TYPES.MESSAGE,S],packDescription:[12,h.TYPES.STRING],mediaKeyTimestamp:[13,h.TYPES.INT64],trayIconFileName:[14,h.TYPES.STRING],thumbnailDirectPath:[15,h.TYPES.STRING],thumbnailSha256:[16,h.TYPES.BYTES],thumbnailEncSha256:[17,h.TYPES.BYTES],thumbnailHeight:[18,h.TYPES.UINT32],thumbnailWidth:[19,h.TYPES.UINT32],imageDataHash:[20,h.TYPES.STRING],stickerPackSize:[21,h.TYPES.UINT64],stickerPackOrigin:[22,h.TYPES.ENUM,c]};p.internalSpec={fileName:[1,h.TYPES.STRING],isAnimated:[2,h.TYPES.BOOL],emojis:[3,h.FLAGS.REPEATED|h.TYPES.STRING],accessibilityLabel:[4,h.TYPES.STRING],isLottie:[5,h.TYPES.BOOL],mimetype:[6,h.TYPES.STRING]};q.internalSpec={expectedImageCount:[2,h.TYPES.UINT32],expectedVideoCount:[3,h.TYPES.UINT32],contextInfo:[17,h.TYPES.MESSAGE,S]};r.internalSpec={type:[1,h.TYPES.ENUM,e]};s.internalSpec={sessionId:[1,h.TYPES.STRING],mediaType:[2,h.TYPES.ENUM,f],masterKey:[3,h.TYPES.BYTES],caption:[4,h.TYPES.STRING]};t.internalSpec={mimetype:[2,h.TYPES.STRING],fileSha256:[3,h.TYPES.BYTES],mediaKey:[5,h.TYPES.BYTES],fileEncSha256:[6,h.TYPES.BYTES],directPath:[7,h.TYPES.STRING],mediaKeyTimestamp:[8,h.TYPES.INT64],contextInfo:[9,h.TYPES.MESSAGE,S],participants:[10,h.FLAGS.REPEATED|h.TYPES.STRING]};ab.internalSpec={isVideo:[1,h.TYPES.BOOL],callOutcome:[2,h.TYPES.ENUM,b],durationSecs:[3,h.TYPES.INT64],callType:[4,h.TYPES.ENUM,aa],participants:[5,h.FLAGS.REPEATED|h.TYPES.MESSAGE,bb]};bb.internalSpec={jid:[1,h.TYPES.STRING],callOutcome:[2,h.TYPES.ENUM,b]};cb.internalSpec={key:[1,h.TYPES.MESSAGE,(i=d("WAWebProtobufsProtocol.pb")).MessageKeySpec],editType:[2,h.TYPES.ENUM,ba]};db.internalSpec={scheduledTimestampMs:[1,h.TYPES.INT64],callType:[2,h.TYPES.ENUM,ca],title:[3,h.TYPES.STRING]};eb.internalSpec={response:[1,h.TYPES.ENUM,da],timestampMs:[2,h.TYPES.INT64],extraGuestCount:[3,h.TYPES.INT32]};fb.internalSpec={eventCreationMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],encPayload:[2,h.TYPES.BYTES],encIv:[3,h.TYPES.BYTES]};gb.internalSpec={contextInfo:[1,h.TYPES.MESSAGE,S],isCanceled:[2,h.TYPES.BOOL],name:[3,h.TYPES.STRING],description:[4,h.TYPES.STRING],location:[5,h.TYPES.MESSAGE,O],joinLink:[6,h.TYPES.STRING],startTime:[7,h.TYPES.INT64],endTime:[8,h.TYPES.INT64],extraGuestsAllowed:[9,h.TYPES.BOOL]};hb.internalSpec={message:[1,h.TYPES.MESSAGE,n],targetMessageKey:[2,h.TYPES.MESSAGE,i.MessageKeySpec]};ib.internalSpec={targetMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],encPayload:[2,h.TYPES.BYTES],encIv:[3,h.TYPES.BYTES]};jb.internalSpec={targetMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],encPayload:[2,h.TYPES.BYTES],encIv:[3,h.TYPES.BYTES]};kb.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],type:[2,h.TYPES.ENUM,ea],senderTimestampMs:[3,h.TYPES.INT64]};lb.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],keepType:[2,h.TYPES.ENUM,$a],timestampMs:[3,h.TYPES.INT64]};mb.internalSpec={name:[1,h.TYPES.STRING],pollVotes:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,nb],contextInfo:[3,h.TYPES.MESSAGE,S]};nb.internalSpec={optionName:[1,h.TYPES.STRING],optionVoteCount:[2,h.TYPES.INT64]};ob.internalSpec={selectedOptions:[1,h.FLAGS.REPEATED|h.TYPES.BYTES]};pb.internalSpec={encPayload:[1,h.TYPES.BYTES],encIv:[2,h.TYPES.BYTES]};qb.internalSpec={};rb.internalSpec={pollCreationMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],vote:[2,h.TYPES.MESSAGE,pb],metadata:[3,h.TYPES.MESSAGE,qb],senderTimestampMs:[4,h.TYPES.INT64]};u.internalSpec={encKey:[1,h.TYPES.BYTES],name:[2,h.TYPES.STRING],options:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,v],selectableOptionsCount:[4,h.TYPES.UINT32],contextInfo:[5,h.TYPES.MESSAGE,S],pollMediaType:[6,h.TYPES.ENUM,ga],pollType:[7,h.TYPES.ENUM,fa],correctAnswer:[8,h.TYPES.MESSAGE,v]};v.internalSpec={optionName:[1,h.TYPES.STRING],optionHash:[2,h.TYPES.STRING]};sb.internalSpec={filehash:[1,h.FLAGS.REPEATED|h.TYPES.STRING],rmrSource:[2,h.TYPES.STRING],requestTimestamp:[3,h.TYPES.INT64]};tb.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],text:[2,h.TYPES.STRING],groupingKey:[3,h.TYPES.STRING],senderTimestampMs:[4,h.TYPES.INT64]};ub.internalSpec={selectedButtonId:[1,h.TYPES.STRING],selectedDisplayText:[2,h.TYPES.STRING],contextInfo:[3,h.TYPES.MESSAGE,S],type:[4,h.TYPES.ENUM,ha],__oneofs__:{response:["selectedDisplayText"]}};vb.internalSpec={text:[1,h.TYPES.STRING],documentMessage:[2,h.TYPES.MESSAGE,N],imageMessage:[3,h.TYPES.MESSAGE,Q],videoMessage:[4,h.TYPES.MESSAGE,M],locationMessage:[5,h.TYPES.MESSAGE,O],contentText:[6,h.TYPES.STRING],footerText:[7,h.TYPES.STRING],contextInfo:[8,h.TYPES.MESSAGE,S],buttons:[9,h.FLAGS.REPEATED|h.TYPES.MESSAGE,wb],headerType:[10,h.TYPES.ENUM,ja],__oneofs__:{header:["text","documentMessage","imageMessage","videoMessage","locationMessage"]}};wb.internalSpec={buttonId:[1,h.TYPES.STRING],buttonText:[2,h.TYPES.MESSAGE,yb],type:[3,h.TYPES.ENUM,ia],nativeFlowInfo:[4,h.TYPES.MESSAGE,xb]};xb.internalSpec={name:[1,h.TYPES.STRING],paramsJson:[2,h.TYPES.STRING]};yb.internalSpec={displayText:[1,h.TYPES.STRING]};zb.internalSpec={targetMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],encPayload:[2,h.TYPES.BYTES],encIv:[3,h.TYPES.BYTES],secretEncType:[4,h.TYPES.ENUM,ka]};w.internalSpec={message:[1,h.TYPES.MESSAGE,n]};Ab.internalSpec={destinationJid:[1,h.TYPES.STRING],message:[2,h.TYPES.MESSAGE,n],phash:[3,h.TYPES.STRING]};Bb.internalSpec={contextInfo:[1,h.TYPES.MESSAGE,S]};Cb.internalSpec={newsletterJid:[1,h.TYPES.STRING],newsletterName:[2,h.TYPES.STRING],jpegThumbnail:[3,h.TYPES.BYTES],caption:[4,h.TYPES.STRING],inviteExpiration:[5,h.TYPES.INT64],contextInfo:[6,h.TYPES.MESSAGE,S]};Db.internalSpec={groupJid:[1,h.TYPES.STRING],inviteCode:[2,h.TYPES.STRING],inviteExpiration:[3,h.TYPES.INT64],groupName:[4,h.TYPES.STRING],jpegThumbnail:[5,h.TYPES.BYTES],caption:[6,h.TYPES.STRING],contextInfo:[7,h.TYPES.MESSAGE,S],groupType:[8,h.TYPES.ENUM,la]};Eb.internalSpec={body:[1,h.TYPES.MESSAGE,y],nativeFlowResponseMessage:[2,h.TYPES.MESSAGE,x],contextInfo:[15,h.TYPES.MESSAGE,S],__oneofs__:{interactiveResponseMessage:["nativeFlowResponseMessage"]}};x.internalDefaults={version:1};x.internalSpec={name:[1,h.TYPES.STRING],paramsJson:[2,h.TYPES.STRING],version:[3,h.TYPES.INT32]};y.internalDefaults={format:j.DEFAULT};y.internalSpec={text:[1,h.TYPES.STRING],format:[2,h.TYPES.ENUM,j]};z.internalSpec={header:[1,h.TYPES.MESSAGE,Ib],body:[2,h.TYPES.MESSAGE,Hb],footer:[3,h.TYPES.MESSAGE,Gb],shopStorefrontMessage:[4,h.TYPES.MESSAGE,D],collectionMessage:[5,h.TYPES.MESSAGE,C],nativeFlowMessage:[6,h.TYPES.MESSAGE,B],carouselMessage:[7,h.TYPES.MESSAGE,A],contextInfo:[15,h.TYPES.MESSAGE,S],__oneofs__:{interactiveMessage:["shopStorefrontMessage","collectionMessage","nativeFlowMessage","carouselMessage"]}};A.internalDefaults={messageVersion:1};A.internalSpec={cards:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,z],messageVersion:[2,h.TYPES.INT32]};B.internalDefaults={messageVersion:1};B.internalSpec={buttons:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Fb],messageParamsJson:[2,h.TYPES.STRING],messageVersion:[3,h.TYPES.INT32]};Fb.internalSpec={name:[1,h.TYPES.STRING],buttonParamsJson:[2,h.TYPES.STRING]};C.internalDefaults={messageVersion:1};C.internalSpec={bizJid:[1,h.TYPES.STRING],id:[2,h.TYPES.STRING],messageVersion:[3,h.TYPES.INT32]};D.internalDefaults={messageVersion:1};D.internalSpec={id:[1,h.TYPES.STRING],surface:[2,h.TYPES.ENUM,ma],messageVersion:[3,h.TYPES.INT32]};Gb.internalSpec={text:[1,h.TYPES.STRING]};Hb.internalSpec={text:[1,h.TYPES.STRING]};Ib.internalSpec={title:[1,h.TYPES.STRING],subtitle:[2,h.TYPES.STRING],documentMessage:[3,h.TYPES.MESSAGE,N],imageMessage:[4,h.TYPES.MESSAGE,Q],jpegThumbnail:[6,h.TYPES.BYTES],videoMessage:[7,h.TYPES.MESSAGE,M],locationMessage:[8,h.TYPES.MESSAGE,O],productMessage:[9,h.TYPES.MESSAGE,F],hasMediaAttachment:[5,h.TYPES.BOOL],__oneofs__:{media:["documentMessage","imageMessage","jpegThumbnail","videoMessage","locationMessage","productMessage"]}};Jb.internalSpec={title:[1,h.TYPES.STRING],listType:[2,h.TYPES.ENUM,na],singleSelectReply:[3,h.TYPES.MESSAGE,Kb],contextInfo:[4,h.TYPES.MESSAGE,S],description:[5,h.TYPES.STRING]};Kb.internalSpec={selectedRowId:[1,h.TYPES.STRING]};Lb.internalSpec={title:[1,h.TYPES.STRING],description:[2,h.TYPES.STRING],buttonText:[3,h.TYPES.STRING],listType:[4,h.TYPES.ENUM,oa],sections:[5,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Qb],productListInfo:[6,h.TYPES.MESSAGE,Mb],footerText:[7,h.TYPES.STRING],contextInfo:[8,h.TYPES.MESSAGE,S]};Mb.internalSpec={productSections:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Ob],headerImage:[2,h.TYPES.MESSAGE,Nb],businessOwnerJid:[3,h.TYPES.STRING]};Nb.internalSpec={productId:[1,h.TYPES.STRING],jpegThumbnail:[2,h.TYPES.BYTES]};Ob.internalSpec={title:[1,h.TYPES.STRING],products:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Pb]};Pb.internalSpec={productId:[1,h.TYPES.STRING]};Qb.internalSpec={title:[1,h.TYPES.STRING],rows:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Rb]};Rb.internalSpec={title:[1,h.TYPES.STRING],description:[2,h.TYPES.STRING],rowId:[3,h.TYPES.STRING]};E.internalDefaults={messageVersion:1};E.internalSpec={orderId:[1,h.TYPES.STRING],thumbnail:[2,h.TYPES.BYTES],itemCount:[3,h.TYPES.INT32],status:[4,h.TYPES.ENUM,qa],surface:[5,h.TYPES.ENUM,pa],message:[6,h.TYPES.STRING],orderTitle:[7,h.TYPES.STRING],sellerJid:[8,h.TYPES.STRING],token:[9,h.TYPES.STRING],totalAmount1000:[10,h.TYPES.INT64],totalCurrencyCode:[11,h.TYPES.STRING],contextInfo:[17,h.TYPES.MESSAGE,S],messageVersion:[12,h.TYPES.INT32],orderRequestMessageId:[13,h.TYPES.MESSAGE,i.MessageKeySpec]};F.internalSpec={product:[1,h.TYPES.MESSAGE,Sb],businessOwnerJid:[2,h.TYPES.STRING],catalog:[4,h.TYPES.MESSAGE,Tb],body:[5,h.TYPES.STRING],footer:[6,h.TYPES.STRING],contextInfo:[17,h.TYPES.MESSAGE,S]};Sb.internalSpec={productImage:[1,h.TYPES.MESSAGE,Q],productId:[2,h.TYPES.STRING],title:[3,h.TYPES.STRING],description:[4,h.TYPES.STRING],currencyCode:[5,h.TYPES.STRING],priceAmount1000:[6,h.TYPES.INT64],retailerId:[7,h.TYPES.STRING],url:[8,h.TYPES.STRING],productImageCount:[9,h.TYPES.UINT32],firstImageId:[11,h.TYPES.STRING],salePriceAmount1000:[12,h.TYPES.INT64],signedUrl:[13,h.TYPES.STRING]};Tb.internalSpec={catalogImage:[1,h.TYPES.MESSAGE,Q],title:[2,h.TYPES.STRING],description:[3,h.TYPES.STRING]};Ub.internalSpec={selectedId:[1,h.TYPES.STRING],selectedDisplayText:[2,h.TYPES.STRING],contextInfo:[3,h.TYPES.MESSAGE,S],selectedIndex:[4,h.TYPES.UINT32],selectedCarouselCardIndex:[5,h.TYPES.UINT32]};G.internalSpec={fourRowTemplate:[1,h.TYPES.MESSAGE,Vb],hydratedFourRowTemplate:[2,h.TYPES.MESSAGE,H],interactiveMessageTemplate:[5,h.TYPES.MESSAGE,z],contextInfo:[3,h.TYPES.MESSAGE,S],hydratedTemplate:[4,h.TYPES.MESSAGE,H],templateId:[9,h.TYPES.STRING],__oneofs__:{format:["fourRowTemplate","hydratedFourRowTemplate","interactiveMessageTemplate"]}};H.internalSpec={documentMessage:[1,h.TYPES.MESSAGE,N],hydratedTitleText:[2,h.TYPES.STRING],imageMessage:[3,h.TYPES.MESSAGE,Q],videoMessage:[4,h.TYPES.MESSAGE,M],locationMessage:[5,h.TYPES.MESSAGE,O],hydratedContentText:[6,h.TYPES.STRING],hydratedFooterText:[7,h.TYPES.STRING],hydratedButtons:[8,h.FLAGS.REPEATED|h.TYPES.MESSAGE,td],templateId:[9,h.TYPES.STRING],maskLinkedDevices:[10,h.TYPES.BOOL],__oneofs__:{title:["documentMessage","hydratedTitleText","imageMessage","videoMessage","locationMessage"]}};Vb.internalSpec={documentMessage:[1,h.TYPES.MESSAGE,N],highlyStructuredMessage:[2,h.TYPES.MESSAGE,J],imageMessage:[3,h.TYPES.MESSAGE,Q],videoMessage:[4,h.TYPES.MESSAGE,M],locationMessage:[5,h.TYPES.MESSAGE,O],content:[6,h.TYPES.MESSAGE,J],footer:[7,h.TYPES.MESSAGE,J],buttons:[8,h.FLAGS.REPEATED|h.TYPES.MESSAGE,pd],__oneofs__:{title:["documentMessage","highlyStructuredMessage","imageMessage","videoMessage","locationMessage"]}};I.internalSpec={url:[1,h.TYPES.STRING],fileSha256:[2,h.TYPES.BYTES],fileEncSha256:[3,h.TYPES.BYTES],mediaKey:[4,h.TYPES.BYTES],mimetype:[5,h.TYPES.STRING],height:[6,h.TYPES.UINT32],width:[7,h.TYPES.UINT32],directPath:[8,h.TYPES.STRING],fileLength:[9,h.TYPES.UINT64],mediaKeyTimestamp:[10,h.TYPES.INT64],firstFrameLength:[11,h.TYPES.UINT32],firstFrameSidecar:[12,h.TYPES.BYTES],isAnimated:[13,h.TYPES.BOOL],pngThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,S],stickerSentTs:[18,h.TYPES.INT64],isAvatar:[19,h.TYPES.BOOL],isAiSticker:[20,h.TYPES.BOOL],isLottie:[21,h.TYPES.BOOL],accessibilityLabel:[22,h.TYPES.STRING]};Wb.internalSpec={degreesLatitude:[1,h.TYPES.DOUBLE],degreesLongitude:[2,h.TYPES.DOUBLE],accuracyInMeters:[3,h.TYPES.UINT32],speedInMps:[4,h.TYPES.FLOAT],degreesClockwiseFromMagneticNorth:[5,h.TYPES.UINT32],caption:[6,h.TYPES.STRING],sequenceNumber:[7,h.TYPES.INT64],timeOffset:[8,h.TYPES.UINT32],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,S]};Xb.internalSpec={serviceType:[1,h.TYPES.ENUM,ra],expiryTimestamp:[2,h.TYPES.INT64]};Yb.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec]};Zb.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec]};$b.internalSpec={noteMessage:[4,h.TYPES.MESSAGE,n],currencyCodeIso4217:[1,h.TYPES.STRING],amount1000:[2,h.TYPES.UINT64],requestFrom:[3,h.TYPES.STRING],expiryTimestamp:[5,h.TYPES.INT64],amount:[6,h.TYPES.MESSAGE,xd],background:[7,h.TYPES.MESSAGE,Z]};ac.internalSpec={noteMessage:[2,h.TYPES.MESSAGE,n],requestMessageKey:[3,h.TYPES.MESSAGE,i.MessageKeySpec],background:[4,h.TYPES.MESSAGE,Z]};J.internalSpec={namespace:[1,h.TYPES.STRING],elementName:[2,h.TYPES.STRING],params:[3,h.FLAGS.REPEATED|h.TYPES.STRING],fallbackLg:[4,h.TYPES.STRING],fallbackLc:[5,h.TYPES.STRING],localizableParams:[6,h.FLAGS.REPEATED|h.TYPES.MESSAGE,bc],deterministicLg:[7,h.TYPES.STRING],deterministicLc:[8,h.TYPES.STRING],hydratedHsm:[9,h.TYPES.MESSAGE,G]};bc.internalSpec={"default":[1,h.TYPES.STRING],currency:[2,h.TYPES.MESSAGE,fc],dateTime:[3,h.TYPES.MESSAGE,cc],__oneofs__:{paramOneof:["currency","dateTime"]}};cc.internalSpec={component:[1,h.TYPES.MESSAGE,ec],unixEpoch:[2,h.TYPES.MESSAGE,dc],__oneofs__:{datetimeOneof:["component","unixEpoch"]}};dc.internalSpec={timestamp:[1,h.TYPES.INT64]};ec.internalSpec={dayOfWeek:[1,h.TYPES.ENUM,ta],year:[2,h.TYPES.UINT32],month:[3,h.TYPES.UINT32],dayOfMonth:[4,h.TYPES.UINT32],hour:[5,h.TYPES.UINT32],minute:[6,h.TYPES.UINT32],calendar:[7,h.TYPES.ENUM,sa]};fc.internalSpec={currencyCode:[1,h.TYPES.STRING],amount1000:[2,h.TYPES.INT64]};gc.internalSpec={displayName:[1,h.TYPES.STRING],contacts:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,P],contextInfo:[17,h.TYPES.MESSAGE,S]};hc.internalSpec={securityNotificationEnabled:[1,h.TYPES.BOOL]};ic.internalSpec={peerDataOperationRequestType:[1,h.TYPES.ENUM,k],stanzaId:[2,h.TYPES.STRING],peerDataOperationResult:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,jc]};jc.internalSpec={mediaUploadResult:[1,h.TYPES.ENUM,d("WAWebProtobufsMmsRetry.pb").MediaRetryNotification$ResultType],stickerMessage:[2,h.TYPES.MESSAGE,I],linkPreviewResponse:[3,h.TYPES.MESSAGE,oc],placeholderMessageResendResponse:[4,h.TYPES.MESSAGE,nc],waffleNonceFetchRequestResponse:[5,h.TYPES.MESSAGE,lc],fullHistorySyncOnDemandRequestResponse:[6,h.TYPES.MESSAGE,mc],companionMetaNonceFetchRequestResponse:[7,h.TYPES.MESSAGE,kc]};kc.internalSpec={nonce:[1,h.TYPES.STRING]};lc.internalSpec={nonce:[1,h.TYPES.STRING],waEntFbid:[2,h.TYPES.STRING]};mc.internalSpec={requestMetadata:[1,h.TYPES.MESSAGE,K],responseCode:[2,h.TYPES.ENUM,ua]};nc.internalSpec={webMessageInfoBytes:[1,h.TYPES.BYTES]};oc.internalSpec={url:[1,h.TYPES.STRING],title:[2,h.TYPES.STRING],description:[3,h.TYPES.STRING],thumbData:[4,h.TYPES.BYTES],canonicalUrl:[5,h.TYPES.STRING],matchText:[6,h.TYPES.STRING],previewType:[7,h.TYPES.STRING],hqThumbnail:[8,h.TYPES.MESSAGE,pc]};pc.internalSpec={directPath:[1,h.TYPES.STRING],thumbHash:[2,h.TYPES.STRING],encThumbHash:[3,h.TYPES.STRING],mediaKey:[4,h.TYPES.BYTES],mediaKeyTimestampMs:[5,h.TYPES.INT64],thumbWidth:[6,h.TYPES.INT32],thumbHeight:[7,h.TYPES.INT32]};qc.internalSpec={peerDataOperationRequestType:[1,h.TYPES.ENUM,k],requestStickerReupload:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,vc],requestUrlPreview:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,uc],historySyncOnDemandRequest:[4,h.TYPES.MESSAGE,tc],placeholderMessageResendRequest:[5,h.FLAGS.REPEATED|h.TYPES.MESSAGE,rc],fullHistorySyncOnDemandRequest:[6,h.TYPES.MESSAGE,sc]};rc.internalSpec={messageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec]};sc.internalSpec={requestMetadata:[1,h.TYPES.MESSAGE,K],historySyncConfig:[2,h.TYPES.MESSAGE,d("WAWebProtobufsCompanionReg.pb").DeviceProps$HistorySyncConfigSpec]};tc.internalSpec={chatJid:[1,h.TYPES.STRING],oldestMsgId:[2,h.TYPES.STRING],oldestMsgFromMe:[3,h.TYPES.BOOL],onDemandMsgCount:[4,h.TYPES.INT32],oldestMsgTimestampMs:[5,h.TYPES.INT64],accountLid:[6,h.TYPES.STRING]};uc.internalSpec={url:[1,h.TYPES.STRING],includeHqThumbnail:[2,h.TYPES.BOOL]};vc.internalSpec={fileSha256:[1,h.TYPES.STRING]};K.internalSpec={requestId:[1,h.TYPES.STRING]};wc.internalSpec={collectionNames:[1,h.FLAGS.REPEATED|h.TYPES.STRING],timestamp:[2,h.TYPES.INT64]};xc.internalSpec={keyIds:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,L]};yc.internalSpec={keys:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Bc]};zc.internalSpec={keyData:[1,h.TYPES.BYTES],fingerprint:[2,h.TYPES.MESSAGE,Ac],timestamp:[3,h.TYPES.INT64]};Ac.internalSpec={rawId:[1,h.TYPES.UINT32],currentIndex:[2,h.TYPES.UINT32],deviceIndexes:[3,h.FLAGS.REPEATED|h.FLAGS.PACKED|h.TYPES.UINT32]};L.internalSpec={keyId:[1,h.TYPES.BYTES]};Bc.internalSpec={keyId:[1,h.TYPES.MESSAGE,L],keyData:[2,h.TYPES.MESSAGE,zc]};Cc.internalSpec={fileSha256:[1,h.TYPES.BYTES],fileLength:[2,h.TYPES.UINT64],mediaKey:[3,h.TYPES.BYTES],fileEncSha256:[4,h.TYPES.BYTES],directPath:[5,h.TYPES.STRING],syncType:[6,h.TYPES.ENUM,va],chunkOrder:[7,h.TYPES.UINT32],originalMessageId:[8,h.TYPES.STRING],progress:[9,h.TYPES.UINT32],oldestMsgInChunkTimestampSec:[10,h.TYPES.INT64],initialHistBootstrapInlinePayload:[11,h.TYPES.BYTES],peerDataRequestSessionId:[12,h.TYPES.STRING],fullHistorySyncOnDemandRequestMetadata:[13,h.TYPES.MESSAGE,K],encHandle:[14,h.TYPES.STRING]};Dc.internalSpec={localChatState:[1,h.TYPES.ENUM,wa]};Ec.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],type:[2,h.TYPES.ENUM,xa],ephemeralExpiration:[4,h.TYPES.UINT32],ephemeralSettingTimestamp:[5,h.TYPES.INT64],historySyncNotification:[6,h.TYPES.MESSAGE,Cc],appStateSyncKeyShare:[7,h.TYPES.MESSAGE,yc],appStateSyncKeyRequest:[8,h.TYPES.MESSAGE,xc],initialSecurityNotificationSettingSync:[9,h.TYPES.MESSAGE,hc],appStateFatalExceptionNotification:[10,h.TYPES.MESSAGE,wc],disappearingMode:[11,h.TYPES.MESSAGE,$],editedMessage:[14,h.TYPES.MESSAGE,n],timestampMs:[15,h.TYPES.INT64],peerDataOperationRequestMessage:[16,h.TYPES.MESSAGE,qc],peerDataOperationRequestResponseMessage:[17,h.TYPES.MESSAGE,ic],botFeedbackMessage:[18,h.TYPES.MESSAGE,Gc],invokerJid:[19,h.TYPES.STRING],requestWelcomeMessageMetadata:[20,h.TYPES.MESSAGE,Dc],mediaNotifyMessage:[21,h.TYPES.MESSAGE,Cd],cloudApiThreadControlNotification:[22,h.TYPES.MESSAGE,Fc],lidMigrationMappingSyncMessage:[23,h.TYPES.MESSAGE,Dd]};Fc.internalSpec={status:[1,h.TYPES.ENUM,ya],senderNotificationTimestampMs:[2,h.TYPES.INT64],consumerLid:[3,h.TYPES.STRING],consumerPhoneNumber:[4,h.TYPES.STRING]};Gc.internalSpec={messageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],kind:[2,h.TYPES.ENUM,Ca],text:[3,h.TYPES.STRING],kindNegative:[4,h.TYPES.UINT64],kindPositive:[5,h.TYPES.UINT64],kindReport:[6,h.TYPES.ENUM,za]};Hc.internalSpec={displayName:[1,h.TYPES.STRING],id:[2,h.TYPES.STRING]};Ic.internalSpec={callKey:[1,h.TYPES.BYTES],conversionSource:[2,h.TYPES.STRING],conversionData:[3,h.TYPES.BYTES],conversionDelaySeconds:[4,h.TYPES.UINT32],ctwaSignals:[5,h.TYPES.STRING],ctwaPayload:[6,h.TYPES.BYTES]};M.internalSpec={url:[1,h.TYPES.STRING],mimetype:[2,h.TYPES.STRING],fileSha256:[3,h.TYPES.BYTES],fileLength:[4,h.TYPES.UINT64],seconds:[5,h.TYPES.UINT32],mediaKey:[6,h.TYPES.BYTES],caption:[7,h.TYPES.STRING],gifPlayback:[8,h.TYPES.BOOL],height:[9,h.TYPES.UINT32],width:[10,h.TYPES.UINT32],fileEncSha256:[11,h.TYPES.BYTES],interactiveAnnotations:[12,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Y],directPath:[13,h.TYPES.STRING],mediaKeyTimestamp:[14,h.TYPES.INT64],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,S],streamingSidecar:[18,h.TYPES.BYTES],gifAttribution:[19,h.TYPES.ENUM,Da],viewOnce:[20,h.TYPES.BOOL],thumbnailDirectPath:[21,h.TYPES.STRING],thumbnailSha256:[22,h.TYPES.BYTES],thumbnailEncSha256:[23,h.TYPES.BYTES],staticUrl:[24,h.TYPES.STRING],annotations:[25,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Y],accessibilityLabel:[26,h.TYPES.STRING],processedVideos:[27,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Ed]};Jc.internalSpec={url:[1,h.TYPES.STRING],mimetype:[2,h.TYPES.STRING],fileSha256:[3,h.TYPES.BYTES],fileLength:[4,h.TYPES.UINT64],seconds:[5,h.TYPES.UINT32],ptt:[6,h.TYPES.BOOL],mediaKey:[7,h.TYPES.BYTES],fileEncSha256:[8,h.TYPES.BYTES],directPath:[9,h.TYPES.STRING],mediaKeyTimestamp:[10,h.TYPES.INT64],contextInfo:[17,h.TYPES.MESSAGE,S],streamingSidecar:[18,h.TYPES.BYTES],waveform:[19,h.TYPES.BYTES],backgroundArgb:[20,h.TYPES.FIXED32],viewOnce:[21,h.TYPES.BOOL],accessibilityLabel:[22,h.TYPES.STRING]};N.internalSpec={url:[1,h.TYPES.STRING],mimetype:[2,h.TYPES.STRING],title:[3,h.TYPES.STRING],fileSha256:[4,h.TYPES.BYTES],fileLength:[5,h.TYPES.UINT64],pageCount:[6,h.TYPES.UINT32],mediaKey:[7,h.TYPES.BYTES],fileName:[8,h.TYPES.STRING],fileEncSha256:[9,h.TYPES.BYTES],directPath:[10,h.TYPES.STRING],mediaKeyTimestamp:[11,h.TYPES.INT64],contactVcard:[12,h.TYPES.BOOL],thumbnailDirectPath:[13,h.TYPES.STRING],thumbnailSha256:[14,h.TYPES.BYTES],thumbnailEncSha256:[15,h.TYPES.BYTES],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,S],thumbnailHeight:[18,h.TYPES.UINT32],thumbnailWidth:[19,h.TYPES.UINT32],caption:[20,h.TYPES.STRING],accessibilityLabel:[21,h.TYPES.STRING]};Kc.internalSpec={text:[1,h.TYPES.STRING],matchedText:[2,h.TYPES.STRING],canonicalUrl:[4,h.TYPES.STRING],description:[5,h.TYPES.STRING],title:[6,h.TYPES.STRING],textArgb:[7,h.TYPES.FIXED32],backgroundArgb:[8,h.TYPES.FIXED32],font:[9,h.TYPES.ENUM,Fa],previewType:[10,h.TYPES.ENUM,Ea],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,S],doNotPlayInline:[18,h.TYPES.BOOL],thumbnailDirectPath:[19,h.TYPES.STRING],thumbnailSha256:[20,h.TYPES.BYTES],thumbnailEncSha256:[21,h.TYPES.BYTES],mediaKey:[22,h.TYPES.BYTES],mediaKeyTimestamp:[23,h.TYPES.INT64],thumbnailHeight:[24,h.TYPES.UINT32],thumbnailWidth:[25,h.TYPES.UINT32],inviteLinkGroupType:[26,h.TYPES.ENUM,l],inviteLinkParentGroupSubjectV2:[27,h.TYPES.STRING],inviteLinkParentGroupThumbnailV2:[28,h.TYPES.BYTES],inviteLinkGroupTypeV2:[29,h.TYPES.ENUM,l],viewOnce:[30,h.TYPES.BOOL],videoHeight:[31,h.TYPES.UINT32],videoWidth:[32,h.TYPES.UINT32],faviconMMSMetadata:[33,h.TYPES.MESSAGE,Lc]};Lc.internalSpec={thumbnailDirectPath:[1,h.TYPES.STRING],thumbnailSha256:[2,h.TYPES.BYTES],thumbnailEncSha256:[3,h.TYPES.BYTES],mediaKey:[4,h.TYPES.BYTES],mediaKeyTimestamp:[5,h.TYPES.INT64],thumbnailHeight:[6,h.TYPES.UINT32],thumbnailWidth:[7,h.TYPES.UINT32]};O.internalSpec={degreesLatitude:[1,h.TYPES.DOUBLE],degreesLongitude:[2,h.TYPES.DOUBLE],name:[3,h.TYPES.STRING],address:[4,h.TYPES.STRING],url:[5,h.TYPES.STRING],isLive:[6,h.TYPES.BOOL],accuracyInMeters:[7,h.TYPES.UINT32],speedInMps:[8,h.TYPES.FLOAT],degreesClockwiseFromMagneticNorth:[9,h.TYPES.UINT32],comment:[11,h.TYPES.STRING],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,S]};P.internalSpec={displayName:[1,h.TYPES.STRING],vcard:[16,h.TYPES.STRING],contextInfo:[17,h.TYPES.MESSAGE,S]};Mc.internalSpec={note:[1,h.TYPES.STRING],token:[2,h.TYPES.STRING],attachmentType:[3,h.TYPES.ENUM,Ga],attachmentMimetype:[4,h.TYPES.STRING],attachmentMediaKey:[5,h.TYPES.BYTES],attachmentMediaKeyTimestamp:[6,h.TYPES.INT64],attachmentFileSha256:[7,h.TYPES.BYTES],attachmentFileEncSha256:[8,h.TYPES.BYTES],attachmentDirectPath:[9,h.TYPES.STRING],attachmentJpegThumbnail:[10,h.TYPES.BYTES]};Q.internalSpec={url:[1,h.TYPES.STRING],mimetype:[2,h.TYPES.STRING],caption:[3,h.TYPES.STRING],fileSha256:[4,h.TYPES.BYTES],fileLength:[5,h.TYPES.UINT64],height:[6,h.TYPES.UINT32],width:[7,h.TYPES.UINT32],mediaKey:[8,h.TYPES.BYTES],fileEncSha256:[9,h.TYPES.BYTES],interactiveAnnotations:[10,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Y],directPath:[11,h.TYPES.STRING],mediaKeyTimestamp:[12,h.TYPES.INT64],jpegThumbnail:[16,h.TYPES.BYTES],contextInfo:[17,h.TYPES.MESSAGE,S],firstScanSidecar:[18,h.TYPES.BYTES],firstScanLength:[19,h.TYPES.UINT32],experimentGroupId:[20,h.TYPES.UINT32],scansSidecar:[21,h.TYPES.BYTES],scanLengths:[22,h.FLAGS.REPEATED|h.TYPES.UINT32],midQualityFileSha256:[23,h.TYPES.BYTES],midQualityFileEncSha256:[24,h.TYPES.BYTES],viewOnce:[25,h.TYPES.BOOL],thumbnailDirectPath:[26,h.TYPES.STRING],thumbnailSha256:[27,h.TYPES.BYTES],thumbnailEncSha256:[28,h.TYPES.BYTES],staticUrl:[29,h.TYPES.STRING],annotations:[30,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Y],imageSourceType:[31,h.TYPES.ENUM,Ha],accessibilityLabel:[32,h.TYPES.STRING]};R.internalSpec={groupId:[1,h.TYPES.STRING],axolotlSenderKeyDistributionMessage:[2,h.TYPES.BYTES]};S.internalSpec={stanzaId:[1,h.TYPES.STRING],participant:[2,h.TYPES.STRING],quotedMessage:[3,h.TYPES.MESSAGE,n],remoteJid:[4,h.TYPES.STRING],mentionedJid:[15,h.FLAGS.REPEATED|h.TYPES.STRING],conversionSource:[18,h.TYPES.STRING],conversionData:[19,h.TYPES.BYTES],conversionDelaySeconds:[20,h.TYPES.UINT32],forwardingScore:[21,h.TYPES.UINT32],isForwarded:[22,h.TYPES.BOOL],quotedAd:[23,h.TYPES.MESSAGE,Rc],placeholderKey:[24,h.TYPES.MESSAGE,i.MessageKeySpec],expiration:[25,h.TYPES.UINT32],ephemeralSettingTimestamp:[26,h.TYPES.INT64],ephemeralSharedSecret:[27,h.TYPES.BYTES],externalAdReply:[28,h.TYPES.MESSAGE,Qc],entryPointConversionSource:[29,h.TYPES.STRING],entryPointConversionApp:[30,h.TYPES.STRING],entryPointConversionDelaySeconds:[31,h.TYPES.UINT32],disappearingMode:[32,h.TYPES.MESSAGE,$],actionLink:[33,h.TYPES.MESSAGE,zd],groupSubject:[34,h.TYPES.STRING],parentGroupJid:[35,h.TYPES.STRING],trustBannerType:[37,h.TYPES.STRING],trustBannerAction:[38,h.TYPES.UINT32],isSampled:[39,h.TYPES.BOOL],groupMentions:[40,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Ad],utm:[41,h.TYPES.MESSAGE,Pc],forwardedNewsletterMessageInfo:[43,h.TYPES.MESSAGE,V],businessMessageForwardInfo:[44,h.TYPES.MESSAGE,Sc],smbClientCampaignId:[45,h.TYPES.STRING],smbServerCampaignId:[46,h.TYPES.STRING],dataSharingContext:[47,h.TYPES.MESSAGE,Nc],alwaysShowAdAttribution:[48,h.TYPES.BOOL],featureEligibilities:[49,h.TYPES.MESSAGE,T],entryPointConversionExternalSource:[50,h.TYPES.STRING],entryPointConversionExternalMedium:[51,h.TYPES.STRING],ctwaSignals:[54,h.TYPES.STRING],ctwaPayload:[55,h.TYPES.BYTES],forwardedAiBotMessageInfo:[56,h.TYPES.MESSAGE,Oc]};T.internalDefaults={cannotBeReactedTo:!1,cannotBeRanked:!1,canRequestFeedback:!1};T.internalSpec={cannotBeReactedTo:[1,h.TYPES.BOOL],cannotBeRanked:[2,h.TYPES.BOOL],canRequestFeedback:[3,h.TYPES.BOOL]};Nc.internalSpec={showMmDisclosure:[1,h.TYPES.BOOL],encryptedSignalTokenConsented:[2,h.TYPES.STRING],parameters:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,U]};U.internalSpec={key:[1,h.TYPES.STRING],stringData:[2,h.TYPES.STRING],intData:[3,h.TYPES.INT64],floatData:[4,h.TYPES.FLOAT],contents:[5,h.TYPES.MESSAGE,U]};Oc.internalSpec={botName:[1,h.TYPES.STRING],botJid:[2,h.TYPES.STRING],creatorName:[3,h.TYPES.STRING]};V.internalSpec={newsletterJid:[1,h.TYPES.STRING],serverMessageId:[2,h.TYPES.INT32],newsletterName:[3,h.TYPES.STRING],contentType:[4,h.TYPES.ENUM,Ia],accessibilityText:[5,h.TYPES.STRING]};Pc.internalSpec={utmSource:[1,h.TYPES.STRING],utmCampaign:[2,h.TYPES.STRING]};Qc.internalSpec={title:[1,h.TYPES.STRING],body:[2,h.TYPES.STRING],mediaType:[3,h.TYPES.ENUM,Ja],thumbnailUrl:[4,h.TYPES.STRING],mediaUrl:[5,h.TYPES.STRING],thumbnail:[6,h.TYPES.BYTES],sourceType:[7,h.TYPES.STRING],sourceId:[8,h.TYPES.STRING],sourceUrl:[9,h.TYPES.STRING],containsAutoReply:[10,h.TYPES.BOOL],renderLargerThumbnail:[11,h.TYPES.BOOL],showAdAttribution:[12,h.TYPES.BOOL],ctwaClid:[13,h.TYPES.STRING],ref:[14,h.TYPES.STRING],clickToWhatsappCall:[15,h.TYPES.BOOL],adContextPreviewDismissed:[16,h.TYPES.BOOL],sourceApp:[17,h.TYPES.STRING],automatedGreetingMessageShown:[18,h.TYPES.BOOL],greetingMessageBody:[19,h.TYPES.STRING],ctaPayload:[20,h.TYPES.STRING],disableNudge:[21,h.TYPES.BOOL],originalImageUrl:[22,h.TYPES.STRING]};Rc.internalSpec={advertiserName:[1,h.TYPES.STRING],mediaType:[2,h.TYPES.ENUM,Ka],jpegThumbnail:[16,h.TYPES.BYTES],caption:[17,h.TYPES.STRING]};Sc.internalSpec={businessOwnerJid:[1,h.TYPES.STRING]};Tc.internalSpec={sentiment:[1,h.TYPES.UINT32],behaviorGraph:[2,h.TYPES.STRING],action:[3,h.TYPES.UINT32],intensity:[4,h.TYPES.UINT32],wordCount:[5,h.TYPES.UINT32]};Uc.internalSpec={provider:[1,h.TYPES.ENUM,La],pluginType:[2,h.TYPES.ENUM,m],thumbnailCdnUrl:[3,h.TYPES.STRING],profilePhotoCdnUrl:[4,h.TYPES.STRING],searchProviderUrl:[5,h.TYPES.STRING],referenceIndex:[6,h.TYPES.UINT32],expectedLinksCount:[7,h.TYPES.UINT32],searchQuery:[9,h.TYPES.STRING],parentPluginMessageKey:[10,h.TYPES.MESSAGE,i.MessageKeySpec],deprecatedField:[11,h.TYPES.ENUM,m],parentPluginType:[12,h.TYPES.ENUM,m],faviconCdnUrl:[13,h.TYPES.STRING]};Vc.internalSpec={suggestedPrompts:[1,h.FLAGS.REPEATED|h.TYPES.STRING],selectedPromptIndex:[2,h.TYPES.UINT32],promptSuggestions:[3,h.TYPES.MESSAGE,Wc],selectedPromptId:[4,h.TYPES.STRING]};Wc.internalSpec={suggestions:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,Xc]};Xc.internalSpec={prompt:[1,h.TYPES.STRING],promptId:[2,h.TYPES.STRING]};Yc.internalSpec={addedFacts:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,W],removedFacts:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,W],disclaimer:[3,h.TYPES.STRING]};W.internalSpec={fact:[1,h.TYPES.STRING],factId:[2,h.TYPES.STRING]};Zc.internalSpec={sessionId:[1,h.TYPES.STRING],sessionSource:[2,h.TYPES.ENUM,Ma]};$c.internalSpec={fileSha256:[1,h.TYPES.STRING],mediaKey:[2,h.TYPES.STRING],fileEncSha256:[3,h.TYPES.STRING],directPath:[4,h.TYPES.STRING],mediaKeyTimestamp:[5,h.TYPES.INT64],mimetype:[6,h.TYPES.STRING],orientationType:[7,h.TYPES.ENUM,Na]};ad.internalSpec={faceImages:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,$c]};bd.internalSpec={requestMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],action:[2,h.TYPES.ENUM,Pa],name:[3,h.TYPES.STRING],nextTriggerTimestamp:[4,h.TYPES.UINT64],frequency:[5,h.TYPES.ENUM,Oa]};cd.internalSpec={modelType:[1,h.TYPES.ENUM,Ra],premiumModelStatus:[2,h.TYPES.ENUM,Qa]};dd.internalSpec={progressDescription:[1,h.TYPES.STRING]};ed.internalSpec={capabilities:[1,h.FLAGS.REPEATED|h.TYPES.ENUM,Sa]};fd.internalSpec={imagineType:[1,h.TYPES.ENUM,Ta]};gd.internalSpec={avatarMetadata:[1,h.TYPES.MESSAGE,Tc],personaId:[2,h.TYPES.STRING],pluginMetadata:[3,h.TYPES.MESSAGE,Uc],suggestedPromptMetadata:[4,h.TYPES.MESSAGE,Vc],invokerJid:[5,h.TYPES.STRING],sessionMetadata:[6,h.TYPES.MESSAGE,Zc],memuMetadata:[7,h.TYPES.MESSAGE,ad],timezone:[8,h.TYPES.STRING],reminderMetadata:[9,h.TYPES.MESSAGE,bd],modelMetadata:[10,h.TYPES.MESSAGE,cd],messageDisclaimerText:[11,h.TYPES.STRING],progressIndicatorMetadata:[12,h.TYPES.MESSAGE,dd],capabilityMetadata:[13,h.TYPES.MESSAGE,ed],imagineMetadata:[14,h.TYPES.MESSAGE,fd],memoryMetadata:[15,h.TYPES.MESSAGE,Yc]};hd.internalSpec={associationType:[1,h.TYPES.ENUM,Ua],parentMessageKey:[2,h.TYPES.MESSAGE,i.MessageKeySpec],messageIndex:[3,h.TYPES.INT32]};id.internalSpec={deviceListMetadata:[1,h.TYPES.MESSAGE,X],deviceListMetadataVersion:[2,h.TYPES.INT32],messageSecret:[3,h.TYPES.BYTES],paddingBytes:[4,h.TYPES.BYTES],messageAddOnDurationInSecs:[5,h.TYPES.UINT32],botMessageSecret:[6,h.TYPES.BYTES],botMetadata:[7,h.TYPES.MESSAGE,gd],reportingTokenVersion:[8,h.TYPES.INT32],messageAddOnExpiryType:[9,h.TYPES.ENUM,Va],messageAssociation:[10,h.TYPES.MESSAGE,hd],capiCreatedGroup:[11,h.TYPES.BOOL],supportPayload:[12,h.TYPES.STRING]};X.internalDefaults={senderAccountType:(i=d("WAWebProtobufsAdv.pb")).ADVEncryptionType.E2EE,receiverAccountType:i.ADVEncryptionType.E2EE};X.internalSpec={senderKeyHash:[1,h.TYPES.BYTES],senderTimestamp:[2,h.TYPES.UINT64],senderKeyIndexes:[3,h.FLAGS.REPEATED|h.FLAGS.PACKED|h.TYPES.UINT32],senderAccountType:[4,h.TYPES.ENUM,i.ADVEncryptionType],receiverAccountType:[5,h.TYPES.ENUM,i.ADVEncryptionType],recipientKeyHash:[8,h.TYPES.BYTES],recipientTimestamp:[9,h.TYPES.UINT64],recipientKeyIndexes:[10,h.FLAGS.REPEATED|h.FLAGS.PACKED|h.TYPES.UINT32]};jd.internalSpec={stanzaId:[1,h.TYPES.STRING],message:[2,h.TYPES.MESSAGE,n]};kd.internalSpec={musicContentMediaId:[1,h.TYPES.STRING],songId:[2,h.TYPES.STRING],author:[3,h.TYPES.STRING],title:[4,h.TYPES.STRING],artworkDirectPath:[5,h.TYPES.STRING],artworkSha256:[6,h.TYPES.BYTES],artworkEncSha256:[7,h.TYPES.BYTES],artworkMediaKey:[11,h.TYPES.BYTES],artistAttribution:[8,h.TYPES.STRING],countryBlocklist:[9,h.TYPES.BYTES],isExplicit:[10,h.TYPES.BOOL]};ld.internalSpec={embeddedMessage:[1,h.TYPES.MESSAGE,jd],embeddedMusic:[2,h.TYPES.MESSAGE,kd],__oneofs__:{content:["embeddedMessage","embeddedMusic"]}};md.internalSpec={title:[1,h.TYPES.STRING],tapUrl:[2,h.TYPES.STRING]};Y.internalSpec={polygonVertices:[1,h.FLAGS.REPEATED|h.TYPES.MESSAGE,nd],location:[2,h.TYPES.MESSAGE,od],newsletter:[3,h.TYPES.MESSAGE,V],embeddedAction:[6,h.TYPES.BOOL],tapAction:[7,h.TYPES.MESSAGE,md],shouldSkipConfirmation:[4,h.TYPES.BOOL],embeddedContent:[5,h.TYPES.MESSAGE,ld],__oneofs__:{action:["location","newsletter","embeddedAction","tapAction"]}};nd.internalSpec={xDeprecated:[1,h.TYPES.INT32],yDeprecated:[2,h.TYPES.INT32],x:[3,h.TYPES.DOUBLE],y:[4,h.TYPES.DOUBLE]};od.internalSpec={degreesLatitude:[1,h.TYPES.DOUBLE],degreesLongitude:[2,h.TYPES.DOUBLE],name:[3,h.TYPES.STRING]};pd.internalSpec={quickReplyButton:[1,h.TYPES.MESSAGE,sd],urlButton:[2,h.TYPES.MESSAGE,rd],callButton:[3,h.TYPES.MESSAGE,qd],index:[4,h.TYPES.UINT32],__oneofs__:{button:["quickReplyButton","urlButton","callButton"]}};qd.internalSpec={displayText:[1,h.TYPES.MESSAGE,J],phoneNumber:[2,h.TYPES.MESSAGE,J]};rd.internalSpec={displayText:[1,h.TYPES.MESSAGE,J],url:[2,h.TYPES.MESSAGE,J]};sd.internalSpec={displayText:[1,h.TYPES.MESSAGE,J],id:[2,h.TYPES.STRING]};td.internalSpec={quickReplyButton:[1,h.TYPES.MESSAGE,wd],urlButton:[2,h.TYPES.MESSAGE,vd],callButton:[3,h.TYPES.MESSAGE,ud],index:[4,h.TYPES.UINT32],__oneofs__:{hydratedButton:["quickReplyButton","urlButton","callButton"]}};ud.internalSpec={displayText:[1,h.TYPES.STRING],phoneNumber:[2,h.TYPES.STRING]};vd.internalSpec={displayText:[1,h.TYPES.STRING],url:[2,h.TYPES.STRING],consentedUsersUrl:[3,h.TYPES.STRING],webviewPresentation:[4,h.TYPES.ENUM,Wa]};wd.internalSpec={displayText:[1,h.TYPES.STRING],id:[2,h.TYPES.STRING]};xd.internalSpec={value:[1,h.TYPES.INT64],offset:[2,h.TYPES.UINT32],currencyCode:[3,h.TYPES.STRING]};Z.internalSpec={id:[1,h.TYPES.STRING],fileLength:[2,h.TYPES.UINT64],width:[3,h.TYPES.UINT32],height:[4,h.TYPES.UINT32],mimetype:[5,h.TYPES.STRING],placeholderArgb:[6,h.TYPES.FIXED32],textArgb:[7,h.TYPES.FIXED32],subtextArgb:[8,h.TYPES.FIXED32],mediaData:[9,h.TYPES.MESSAGE,yd],type:[10,h.TYPES.ENUM,Xa]};yd.internalSpec={mediaKey:[1,h.TYPES.BYTES],mediaKeyTimestamp:[2,h.TYPES.INT64],fileSha256:[3,h.TYPES.BYTES],fileEncSha256:[4,h.TYPES.BYTES],directPath:[5,h.TYPES.STRING]};$.internalSpec={initiator:[1,h.TYPES.ENUM,Za],trigger:[2,h.TYPES.ENUM,Ya],initiatorDeviceJid:[3,h.TYPES.STRING],initiatedByMe:[4,h.TYPES.BOOL]};zd.internalSpec={url:[1,h.TYPES.STRING],buttonTitle:[2,h.TYPES.STRING]};Ad.internalSpec={groupJid:[1,h.TYPES.STRING],groupSubject:[2,h.TYPES.STRING]};Bd.internalSpec={version:[1,h.TYPES.SFIXED32],encIv:[2,h.TYPES.BYTES],encPayload:[3,h.TYPES.BYTES]};Cd.internalSpec={expressPathUrl:[1,h.TYPES.STRING],fileEncSha256:[2,h.TYPES.BYTES],fileLength:[3,h.TYPES.UINT64]};Dd.internalSpec={encodedMappingPayload:[1,h.TYPES.BYTES]};Ed.internalSpec={directPath:[1,h.TYPES.STRING],fileSha256:[2,h.TYPES.BYTES],height:[3,h.TYPES.UINT32],width:[4,h.TYPES.UINT32],fileLength:[5,h.TYPES.UINT64],bitrate:[6,h.TYPES.UINT32],quality:[7,h.TYPES.ENUM,a],capabilities:[8,h.FLAGS.REPEATED|h.TYPES.STRING]};g.Message$StickerPackMessage$StickerPackOrigin=c;g.Message$PlaceholderMessage$PlaceholderType=e;g.Message$BCallMessage$MediaType=f;g.Message$CallLogMessage$CallOutcome=b;g.Message$CallLogMessage$CallType=aa;g.Message$ScheduledCallEditMessage$EditType=ba;g.Message$ScheduledCallCreationMessage$CallType=ca;g.Message$EventResponseMessage$EventResponseType=da;g.Message$PinInChatMessage$Type=ea;g.Message$PollCreationMessage$PollType=fa;g.Message$PollMediaType=ga;g.Message$ButtonsResponseMessage$Type=ha;g.Message$ButtonsMessage$Button$Type=ia;g.Message$ButtonsMessage$HeaderType=ja;g.Message$SecretEncryptedMessage$SecretEncType=ka;g.Message$GroupInviteMessage$GroupType=la;g.Message$InteractiveResponseMessage$Body$Format=j;g.Message$InteractiveMessage$ShopMessage$Surface=ma;g.Message$ListResponseMessage$ListType=na;g.Message$ListMessage$ListType=oa;g.Message$OrderMessage$OrderSurface=pa;g.Message$OrderMessage$OrderStatus=qa;g.Message$PaymentInviteMessage$ServiceType=ra;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeComponent$CalendarType=sa;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeComponent$DayOfWeekType=ta;g.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$FullHistorySyncOnDemandResponseCode=ua;g.Message$PeerDataOperationRequestType=k;g.Message$HistorySyncNotification$HistorySyncType=va;g.Message$RequestWelcomeMessageMetadata$LocalChatState=wa;g.Message$ProtocolMessage$Type=xa;g.Message$CloudAPIThreadControlNotification$CloudAPIThreadControl=ya;g.Message$BotFeedbackMessage$ReportKind=za;g.Message$BotFeedbackMessage$BotFeedbackKindMultiplePositive=Aa;g.Message$BotFeedbackMessage$BotFeedbackKindMultipleNegative=Ba;g.Message$BotFeedbackMessage$BotFeedbackKind=Ca;g.Message$VideoMessage$Attribution=Da;g.Message$ExtendedTextMessage$InviteLinkGroupType=l;g.Message$ExtendedTextMessage$PreviewType=Ea;g.Message$ExtendedTextMessage$FontType=Fa;g.Message$InvoiceMessage$AttachmentType=Ga;g.Message$ImageMessage$ImageSourceType=Ha;g.ContextInfo$ForwardedNewsletterMessageInfo$ContentType=Ia;g.ContextInfo$ExternalAdReplyInfo$MediaType=Ja;g.ContextInfo$AdReplyInfo$MediaType=Ka;g.BotPluginMetadata$PluginType=m;g.BotPluginMetadata$SearchProvider=La;g.BotSessionSource=Ma;g.BotMediaMetadata$OrientationType=Na;g.BotReminderMetadata$ReminderFrequency=Oa;g.BotReminderMetadata$ReminderAction=Pa;g.BotModelMetadata$PremiumModelStatus=Qa;g.BotModelMetadata$ModelType=Ra;g.BotCapabilityMetadata$BotCapabilityType=Sa;g.BotImagineMetadata$ImagineType=Ta;g.MessageAssociation$AssociationType=Ua;g.MessageContextInfo$MessageAddonExpiryType=Va;g.HydratedTemplateButton$HydratedURLButton$WebviewPresentationType=Wa;g.PaymentBackground$Type=Xa;g.DisappearingMode$Trigger=Ya;g.DisappearingMode$Initiator=Za;g.KeepType=$a;g.ProcessedVideo$VideoQuality=a;g.MessageSpec=n;g.Message$StickerPackMessageSpec=o;g.Message$StickerPackMessage$StickerSpec=p;g.Message$AlbumMessageSpec=q;g.Message$PlaceholderMessageSpec=r;g.Message$BCallMessageSpec=s;g.Message$MessageHistoryBundleSpec=t;g.Message$CallLogMessageSpec=ab;g.Message$CallLogMessage$CallParticipantSpec=bb;g.Message$ScheduledCallEditMessageSpec=cb;g.Message$ScheduledCallCreationMessageSpec=db;g.Message$EventResponseMessageSpec=eb;g.Message$EncEventResponseMessageSpec=fb;g.Message$EventMessageSpec=gb;g.Message$CommentMessageSpec=hb;g.Message$EncCommentMessageSpec=ib;g.Message$EncReactionMessageSpec=jb;g.Message$PinInChatMessageSpec=kb;g.Message$KeepInChatMessageSpec=lb;g.Message$PollResultSnapshotMessageSpec=mb;g.Message$PollResultSnapshotMessage$PollVoteSpec=nb;g.Message$PollVoteMessageSpec=ob;g.Message$PollEncValueSpec=pb;g.Message$PollUpdateMessageMetadataSpec=qb;g.Message$PollUpdateMessageSpec=rb;g.Message$PollCreationMessageSpec=u;g.Message$PollCreationMessage$OptionSpec=v;g.Message$StickerSyncRMRMessageSpec=sb;g.Message$ReactionMessageSpec=tb;g.Message$ButtonsResponseMessageSpec=ub;g.Message$ButtonsMessageSpec=vb;g.Message$ButtonsMessage$ButtonSpec=wb;g.Message$ButtonsMessage$Button$NativeFlowInfoSpec=xb;g.Message$ButtonsMessage$Button$ButtonTextSpec=yb;g.Message$SecretEncryptedMessageSpec=zb;g.Message$FutureProofMessageSpec=w;g.Message$DeviceSentMessageSpec=Ab;g.Message$RequestPhoneNumberMessageSpec=Bb;g.Message$NewsletterAdminInviteMessageSpec=Cb;g.Message$GroupInviteMessageSpec=Db;g.Message$InteractiveResponseMessageSpec=Eb;g.Message$InteractiveResponseMessage$NativeFlowResponseMessageSpec=x;g.Message$InteractiveResponseMessage$BodySpec=y;g.Message$InteractiveMessageSpec=z;g.Message$InteractiveMessage$CarouselMessageSpec=A;g.Message$InteractiveMessage$NativeFlowMessageSpec=B;g.Message$InteractiveMessage$NativeFlowMessage$NativeFlowButtonSpec=Fb;g.Message$InteractiveMessage$CollectionMessageSpec=C;g.Message$InteractiveMessage$ShopMessageSpec=D;g.Message$InteractiveMessage$FooterSpec=Gb;g.Message$InteractiveMessage$BodySpec=Hb;g.Message$InteractiveMessage$HeaderSpec=Ib;g.Message$ListResponseMessageSpec=Jb;g.Message$ListResponseMessage$SingleSelectReplySpec=Kb;g.Message$ListMessageSpec=Lb;g.Message$ListMessage$ProductListInfoSpec=Mb;g.Message$ListMessage$ProductListHeaderImageSpec=Nb;g.Message$ListMessage$ProductSectionSpec=Ob;g.Message$ListMessage$ProductSpec=Pb;g.Message$ListMessage$SectionSpec=Qb;g.Message$ListMessage$RowSpec=Rb;g.Message$OrderMessageSpec=E;g.Message$ProductMessageSpec=F;g.Message$ProductMessage$ProductSnapshotSpec=Sb;g.Message$ProductMessage$CatalogSnapshotSpec=Tb;g.Message$TemplateButtonReplyMessageSpec=Ub;g.Message$TemplateMessageSpec=G;g.Message$TemplateMessage$HydratedFourRowTemplateSpec=H;g.Message$TemplateMessage$FourRowTemplateSpec=Vb;g.Message$StickerMessageSpec=I;g.Message$LiveLocationMessageSpec=Wb;g.Message$PaymentInviteMessageSpec=Xb;g.Message$CancelPaymentRequestMessageSpec=Yb;g.Message$DeclinePaymentRequestMessageSpec=Zb;g.Message$RequestPaymentMessageSpec=$b;g.Message$SendPaymentMessageSpec=ac;g.Message$HighlyStructuredMessageSpec=J;g.Message$HighlyStructuredMessage$HSMLocalizableParameterSpec=bc;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTimeSpec=cc;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeUnixEpochSpec=dc;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeComponentSpec=ec;g.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMCurrencySpec=fc;g.Message$ContactsArrayMessageSpec=gc;g.Message$InitialSecurityNotificationSettingSyncSpec=hc;g.Message$PeerDataOperationRequestResponseMessageSpec=ic;g.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResultSpec=jc;g.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$CompanionMetaNonceFetchResponseSpec=kc;g.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$WaffleNonceFetchResponseSpec=lc;g.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$FullHistorySyncOnDemandRequestResponseSpec=mc;g.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$PlaceholderMessageResendResponseSpec=nc;g.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$LinkPreviewResponseSpec=oc;g.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$LinkPreviewResponse$LinkPreviewHighQualityThumbnailSpec=pc;g.Message$PeerDataOperationRequestMessageSpec=qc;g.Message$PeerDataOperationRequestMessage$PlaceholderMessageResendRequestSpec=rc;g.Message$PeerDataOperationRequestMessage$FullHistorySyncOnDemandRequestSpec=sc;g.Message$PeerDataOperationRequestMessage$HistorySyncOnDemandRequestSpec=tc;g.Message$PeerDataOperationRequestMessage$RequestUrlPreviewSpec=uc;g.Message$PeerDataOperationRequestMessage$RequestStickerReuploadSpec=vc;g.Message$FullHistorySyncOnDemandRequestMetadataSpec=K;g.Message$AppStateFatalExceptionNotificationSpec=wc;g.Message$AppStateSyncKeyRequestSpec=xc;g.Message$AppStateSyncKeyShareSpec=yc;g.Message$AppStateSyncKeyDataSpec=zc;g.Message$AppStateSyncKeyFingerprintSpec=Ac;g.Message$AppStateSyncKeyIdSpec=L;g.Message$AppStateSyncKeySpec=Bc;g.Message$HistorySyncNotificationSpec=Cc;g.Message$RequestWelcomeMessageMetadataSpec=Dc;g.Message$ProtocolMessageSpec=Ec;g.Message$CloudAPIThreadControlNotificationSpec=Fc;g.Message$BotFeedbackMessageSpec=Gc;g.Message$ChatSpec=Hc;g.Message$CallSpec=Ic;g.Message$VideoMessageSpec=M;g.Message$AudioMessageSpec=Jc;g.Message$DocumentMessageSpec=N;g.Message$ExtendedTextMessageSpec=Kc;g.Message$MMSThumbnailMetadataSpec=Lc;g.Message$LocationMessageSpec=O;g.Message$ContactMessageSpec=P;g.Message$InvoiceMessageSpec=Mc;g.Message$ImageMessageSpec=Q;g.Message$SenderKeyDistributionMessageSpec=R;g.ContextInfoSpec=S;g.ContextInfo$FeatureEligibilitiesSpec=T;g.ContextInfo$DataSharingContextSpec=Nc;g.ContextInfo$DataSharingContext$ParametersSpec=U;g.ContextInfo$ForwardedAIBotMessageInfoSpec=Oc;g.ContextInfo$ForwardedNewsletterMessageInfoSpec=V;g.ContextInfo$UTMInfoSpec=Pc;g.ContextInfo$ExternalAdReplyInfoSpec=Qc;g.ContextInfo$AdReplyInfoSpec=Rc;g.ContextInfo$BusinessMessageForwardInfoSpec=Sc;g.BotAvatarMetadataSpec=Tc;g.BotPluginMetadataSpec=Uc;g.BotSuggestedPromptMetadataSpec=Vc;g.BotPromptSuggestionsSpec=Wc;g.BotPromptSuggestionSpec=Xc;g.BotMemoryMetadataSpec=Yc;g.BotMemoryFactSpec=W;g.BotSessionMetadataSpec=Zc;g.BotMediaMetadataSpec=$c;g.BotMemuMetadataSpec=ad;g.BotReminderMetadataSpec=bd;g.BotModelMetadataSpec=cd;g.BotProgressIndicatorMetadataSpec=dd;g.BotCapabilityMetadataSpec=ed;g.BotImagineMetadataSpec=fd;g.BotMetadataSpec=gd;g.MessageAssociationSpec=hd;g.MessageContextInfoSpec=id;g.DeviceListMetadataSpec=X;g.EmbeddedMessageSpec=jd;g.EmbeddedMusicSpec=kd;g.EmbeddedContentSpec=ld;g.TapLinkActionSpec=md;g.InteractiveAnnotationSpec=Y;g.PointSpec=nd;g.LocationSpec=od;g.TemplateButtonSpec=pd;g.TemplateButton$CallButtonSpec=qd;g.TemplateButton$URLButtonSpec=rd;g.TemplateButton$QuickReplyButtonSpec=sd;g.HydratedTemplateButtonSpec=td;g.HydratedTemplateButton$HydratedCallButtonSpec=ud;g.HydratedTemplateButton$HydratedURLButtonSpec=vd;g.HydratedTemplateButton$HydratedQuickReplyButtonSpec=wd;g.MoneySpec=xd;g.PaymentBackgroundSpec=Z;g.PaymentBackground$MediaDataSpec=yd;g.DisappearingModeSpec=$;g.ActionLinkSpec=zd;g.GroupMentionSpec=Ad;g.MessageSecretMessageSpec=Bd;g.MediaNotifyMessageSpec=Cd;g.LIDMigrationMappingSyncMessageSpec=Dd;g.ProcessedVideoSpec=Ed}),98);
__d("WAWebProtobufsWeb.pb",["$InternalEnum","WAProtoConst","WAWebProtobufsE2E.pb","WAWebProtobufsProtocol.pb"],(function(a,b,c,d,e,f,g){var h,i;c=(a=b("$InternalEnum"))({E2EE:0,FB:2,BSP:1,BSP_AND_FB:3});e=a({UNKNOWN:0,REVOKE:1,CIPHERTEXT:2,FUTUREPROOF:3,NON_VERIFIED_TRANSITION:4,UNVERIFIED_TRANSITION:5,VERIFIED_TRANSITION:6,VERIFIED_LOW_UNKNOWN:7,VERIFIED_HIGH:8,VERIFIED_INITIAL_UNKNOWN:9,VERIFIED_INITIAL_LOW:10,VERIFIED_INITIAL_HIGH:11,VERIFIED_TRANSITION_ANY_TO_NONE:12,VERIFIED_TRANSITION_ANY_TO_HIGH:13,VERIFIED_TRANSITION_HIGH_TO_LOW:14,VERIFIED_TRANSITION_HIGH_TO_UNKNOWN:15,VERIFIED_TRANSITION_UNKNOWN_TO_LOW:16,VERIFIED_TRANSITION_LOW_TO_UNKNOWN:17,VERIFIED_TRANSITION_NONE_TO_LOW:18,VERIFIED_TRANSITION_NONE_TO_UNKNOWN:19,GROUP_CREATE:20,GROUP_CHANGE_SUBJECT:21,GROUP_CHANGE_ICON:22,GROUP_CHANGE_INVITE_LINK:23,GROUP_CHANGE_DESCRIPTION:24,GROUP_CHANGE_RESTRICT:25,GROUP_CHANGE_ANNOUNCE:26,GROUP_PARTICIPANT_ADD:27,GROUP_PARTICIPANT_REMOVE:28,GROUP_PARTICIPANT_PROMOTE:29,GROUP_PARTICIPANT_DEMOTE:30,GROUP_PARTICIPANT_INVITE:31,GROUP_PARTICIPANT_LEAVE:32,GROUP_PARTICIPANT_CHANGE_NUMBER:33,BROADCAST_CREATE:34,BROADCAST_ADD:35,BROADCAST_REMOVE:36,GENERIC_NOTIFICATION:37,E2E_IDENTITY_CHANGED:38,E2E_ENCRYPTED:39,CALL_MISSED_VOICE:40,CALL_MISSED_VIDEO:41,INDIVIDUAL_CHANGE_NUMBER:42,GROUP_DELETE:43,GROUP_ANNOUNCE_MODE_MESSAGE_BOUNCE:44,CALL_MISSED_GROUP_VOICE:45,CALL_MISSED_GROUP_VIDEO:46,PAYMENT_CIPHERTEXT:47,PAYMENT_FUTUREPROOF:48,PAYMENT_TRANSACTION_STATUS_UPDATE_FAILED:49,PAYMENT_TRANSACTION_STATUS_UPDATE_REFUNDED:50,PAYMENT_TRANSACTION_STATUS_UPDATE_REFUND_FAILED:51,PAYMENT_TRANSACTION_STATUS_RECEIVER_PENDING_SETUP:52,PAYMENT_TRANSACTION_STATUS_RECEIVER_SUCCESS_AFTER_HICCUP:53,PAYMENT_ACTION_ACCOUNT_SETUP_REMINDER:54,PAYMENT_ACTION_SEND_PAYMENT_REMINDER:55,PAYMENT_ACTION_SEND_PAYMENT_INVITATION:56,PAYMENT_ACTION_REQUEST_DECLINED:57,PAYMENT_ACTION_REQUEST_EXPIRED:58,PAYMENT_ACTION_REQUEST_CANCELLED:59,BIZ_VERIFIED_TRANSITION_TOP_TO_BOTTOM:60,BIZ_VERIFIED_TRANSITION_BOTTOM_TO_TOP:61,BIZ_INTRO_TOP:62,BIZ_INTRO_BOTTOM:63,BIZ_NAME_CHANGE:64,BIZ_MOVE_TO_CONSUMER_APP:65,BIZ_TWO_TIER_MIGRATION_TOP:66,BIZ_TWO_TIER_MIGRATION_BOTTOM:67,OVERSIZED:68,GROUP_CHANGE_NO_FREQUENTLY_FORWARDED:69,GROUP_V4_ADD_INVITE_SENT:70,GROUP_PARTICIPANT_ADD_REQUEST_JOIN:71,CHANGE_EPHEMERAL_SETTING:72,E2E_DEVICE_CHANGED:73,VIEWED_ONCE:74,E2E_ENCRYPTED_NOW:75,BLUE_MSG_BSP_FB_TO_BSP_PREMISE:76,BLUE_MSG_BSP_FB_TO_SELF_FB:77,BLUE_MSG_BSP_FB_TO_SELF_PREMISE:78,BLUE_MSG_BSP_FB_UNVERIFIED:79,BLUE_MSG_BSP_FB_UNVERIFIED_TO_SELF_PREMISE_VERIFIED:80,BLUE_MSG_BSP_FB_VERIFIED:81,BLUE_MSG_BSP_FB_VERIFIED_TO_SELF_PREMISE_UNVERIFIED:82,BLUE_MSG_BSP_PREMISE_TO_SELF_PREMISE:83,BLUE_MSG_BSP_PREMISE_UNVERIFIED:84,BLUE_MSG_BSP_PREMISE_UNVERIFIED_TO_SELF_PREMISE_VERIFIED:85,BLUE_MSG_BSP_PREMISE_VERIFIED:86,BLUE_MSG_BSP_PREMISE_VERIFIED_TO_SELF_PREMISE_UNVERIFIED:87,BLUE_MSG_CONSUMER_TO_BSP_FB_UNVERIFIED:88,BLUE_MSG_CONSUMER_TO_BSP_PREMISE_UNVERIFIED:89,BLUE_MSG_CONSUMER_TO_SELF_FB_UNVERIFIED:90,BLUE_MSG_CONSUMER_TO_SELF_PREMISE_UNVERIFIED:91,BLUE_MSG_SELF_FB_TO_BSP_PREMISE:92,BLUE_MSG_SELF_FB_TO_SELF_PREMISE:93,BLUE_MSG_SELF_FB_UNVERIFIED:94,BLUE_MSG_SELF_FB_UNVERIFIED_TO_SELF_PREMISE_VERIFIED:95,BLUE_MSG_SELF_FB_VERIFIED:96,BLUE_MSG_SELF_FB_VERIFIED_TO_SELF_PREMISE_UNVERIFIED:97,BLUE_MSG_SELF_PREMISE_TO_BSP_PREMISE:98,BLUE_MSG_SELF_PREMISE_UNVERIFIED:99,BLUE_MSG_SELF_PREMISE_VERIFIED:100,BLUE_MSG_TO_BSP_FB:101,BLUE_MSG_TO_CONSUMER:102,BLUE_MSG_TO_SELF_FB:103,BLUE_MSG_UNVERIFIED_TO_BSP_FB_VERIFIED:104,BLUE_MSG_UNVERIFIED_TO_BSP_PREMISE_VERIFIED:105,BLUE_MSG_UNVERIFIED_TO_SELF_FB_VERIFIED:106,BLUE_MSG_UNVERIFIED_TO_VERIFIED:107,BLUE_MSG_VERIFIED_TO_BSP_FB_UNVERIFIED:108,BLUE_MSG_VERIFIED_TO_BSP_PREMISE_UNVERIFIED:109,BLUE_MSG_VERIFIED_TO_SELF_FB_UNVERIFIED:110,BLUE_MSG_VERIFIED_TO_UNVERIFIED:111,BLUE_MSG_BSP_FB_UNVERIFIED_TO_BSP_PREMISE_VERIFIED:112,BLUE_MSG_BSP_FB_UNVERIFIED_TO_SELF_FB_VERIFIED:113,BLUE_MSG_BSP_FB_VERIFIED_TO_BSP_PREMISE_UNVERIFIED:114,BLUE_MSG_BSP_FB_VERIFIED_TO_SELF_FB_UNVERIFIED:115,BLUE_MSG_SELF_FB_UNVERIFIED_TO_BSP_PREMISE_VERIFIED:116,BLUE_MSG_SELF_FB_VERIFIED_TO_BSP_PREMISE_UNVERIFIED:117,E2E_IDENTITY_UNAVAILABLE:118,GROUP_CREATING:119,GROUP_CREATE_FAILED:120,GROUP_BOUNCED:121,BLOCK_CONTACT:122,EPHEMERAL_SETTING_NOT_APPLIED:123,SYNC_FAILED:124,SYNCING:125,BIZ_PRIVACY_MODE_INIT_FB:126,BIZ_PRIVACY_MODE_INIT_BSP:127,BIZ_PRIVACY_MODE_TO_FB:128,BIZ_PRIVACY_MODE_TO_BSP:129,DISAPPEARING_MODE:130,E2E_DEVICE_FETCH_FAILED:131,ADMIN_REVOKE:132,GROUP_INVITE_LINK_GROWTH_LOCKED:133,COMMUNITY_LINK_PARENT_GROUP:134,COMMUNITY_LINK_SIBLING_GROUP:135,COMMUNITY_LINK_SUB_GROUP:136,COMMUNITY_UNLINK_PARENT_GROUP:137,COMMUNITY_UNLINK_SIBLING_GROUP:138,COMMUNITY_UNLINK_SUB_GROUP:139,GROUP_PARTICIPANT_ACCEPT:140,GROUP_PARTICIPANT_LINKED_GROUP_JOIN:141,COMMUNITY_CREATE:142,EPHEMERAL_KEEP_IN_CHAT:143,GROUP_MEMBERSHIP_JOIN_APPROVAL_REQUEST:144,GROUP_MEMBERSHIP_JOIN_APPROVAL_MODE:145,INTEGRITY_UNLINK_PARENT_GROUP:146,COMMUNITY_PARTICIPANT_PROMOTE:147,COMMUNITY_PARTICIPANT_DEMOTE:148,COMMUNITY_PARENT_GROUP_DELETED:149,COMMUNITY_LINK_PARENT_GROUP_MEMBERSHIP_APPROVAL:150,GROUP_PARTICIPANT_JOINED_GROUP_AND_PARENT_GROUP:151,MASKED_THREAD_CREATED:152,MASKED_THREAD_UNMASKED:153,BIZ_CHAT_ASSIGNMENT:154,CHAT_PSA:155,CHAT_POLL_CREATION_MESSAGE:156,CAG_MASKED_THREAD_CREATED:157,COMMUNITY_PARENT_GROUP_SUBJECT_CHANGED:158,CAG_INVITE_AUTO_ADD:159,BIZ_CHAT_ASSIGNMENT_UNASSIGN:160,CAG_INVITE_AUTO_JOINED:161,SCHEDULED_CALL_START_MESSAGE:162,COMMUNITY_INVITE_RICH:163,COMMUNITY_INVITE_AUTO_ADD_RICH:164,SUB_GROUP_INVITE_RICH:165,SUB_GROUP_PARTICIPANT_ADD_RICH:166,COMMUNITY_LINK_PARENT_GROUP_RICH:167,COMMUNITY_PARTICIPANT_ADD_RICH:168,SILENCED_UNKNOWN_CALLER_AUDIO:169,SILENCED_UNKNOWN_CALLER_VIDEO:170,GROUP_MEMBER_ADD_MODE:171,GROUP_MEMBERSHIP_JOIN_APPROVAL_REQUEST_NON_ADMIN_ADD:172,COMMUNITY_CHANGE_DESCRIPTION:173,SENDER_INVITE:174,RECEIVER_INVITE:175,COMMUNITY_ALLOW_MEMBER_ADDED_GROUPS:176,PINNED_MESSAGE_IN_CHAT:177,PAYMENT_INVITE_SETUP_INVITER:178,PAYMENT_INVITE_SETUP_INVITEE_RECEIVE_ONLY:179,PAYMENT_INVITE_SETUP_INVITEE_SEND_AND_RECEIVE:180,LINKED_GROUP_CALL_START:181,REPORT_TO_ADMIN_ENABLED_STATUS:182,EMPTY_SUBGROUP_CREATE:183,SCHEDULED_CALL_CANCEL:184,SUBGROUP_ADMIN_TRIGGERED_AUTO_ADD_RICH:185,GROUP_CHANGE_RECENT_HISTORY_SHARING:186,PAID_MESSAGE_SERVER_CAMPAIGN_ID:187,GENERAL_CHAT_CREATE:188,GENERAL_CHAT_ADD:189,GENERAL_CHAT_AUTO_ADD_DISABLED:190,SUGGESTED_SUBGROUP_ANNOUNCE:191,BIZ_BOT_1P_MESSAGING_ENABLED:192,CHANGE_USERNAME:193,BIZ_COEX_PRIVACY_INIT_SELF:194,BIZ_COEX_PRIVACY_TRANSITION_SELF:195,SUPPORT_AI_EDUCATION:196,BIZ_BOT_3P_MESSAGING_ENABLED:197,REMINDER_SETUP_MESSAGE:198,REMINDER_SENT_MESSAGE:199,REMINDER_CANCEL_MESSAGE:200,BIZ_COEX_PRIVACY_INIT:201,BIZ_COEX_PRIVACY_TRANSITION:202,GROUP_DEACTIVATED:203,COMMUNITY_DEACTIVATE_SIBLING_GROUP:204,EVENT_UPDATED:205,EVENT_CANCELED:206,COMMUNITY_OWNER_UPDATED:207,COMMUNITY_SUB_GROUP_VISIBILITY_HIDDEN:208,CAPI_GROUP_NE2EE_SYSTEM_MESSAGE:209,STATUS_MENTION:210,USER_CONTROLS_SYSTEM_MESSAGE:211});f=a({ERROR:0,PENDING:1,SERVER_ACK:2,DELIVERY_ACK:3,READ:4,PLAYED:5});b=a({UNKNOWN:0,PENDING_SETUP:1,PENDING_RECEIVER_SETUP:2,INIT:3,SUCCESS:4,COMPLETED:5,FAILED:6,FAILED_RISK:7,FAILED_PROCESSING:8,FAILED_RECEIVER_PROCESSING:9,FAILED_DA:10,FAILED_DA_FINAL:11,REFUNDED_TXN:12,REFUND_FAILED:13,REFUND_FAILED_PROCESSING:14,REFUND_FAILED_DA:15,EXPIRED_TXN:16,AUTH_CANCELED:17,AUTH_CANCEL_FAILED_PROCESSING:18,AUTH_CANCEL_FAILED:19,COLLECT_INIT:20,COLLECT_SUCCESS:21,COLLECT_FAILED:22,COLLECT_FAILED_RISK:23,COLLECT_REJECTED:24,COLLECT_EXPIRED:25,COLLECT_CANCELED:26,COLLECT_CANCELLING:27,IN_REVIEW:28,REVERSAL_SUCCESS:29,REVERSAL_PENDING:30,REFUND_PENDING:31});var j=a({UNKNOWN_STATUS:0,PROCESSING:1,SENT:2,NEED_TO_ACCEPT:3,COMPLETE:4,COULD_NOT_COMPLETE:5,REFUNDED:6,EXPIRED:7,REJECTED:8,CANCELLED:9,WAITING_FOR_PAYER:10,WAITING:11}),k=a({UNKNOWN_CURRENCY:0,INR:1}),l=a({NOT_STARTED:0,FORCE_UPGRADE:1,DEVELOPMENT:2,PRODUCTION:3}),m=a({UNKNOWN_TYPE:0,PIN_FOR_ALL:1,UNPIN_FOR_ALL:2});a=a({UNDEFINED:0,REACTION:1,EVENT_RESPONSE:2,POLL_UPDATE:3,PIN_IN_CHAT:4});var n={},o={},p={},q={},r={},s={},t={},u={},v={},w={},x={},y={},z={},A={},B={},C={},D={},E={},F={},G={},H={},I={},J={};n.internalDefaults={status:f.PENDING};n.internalSpec={key:[1,(h=d("WAProtoConst")).FLAGS.REQUIRED|h.TYPES.MESSAGE,(i=d("WAWebProtobufsProtocol.pb")).MessageKeySpec],message:[2,h.TYPES.MESSAGE,(d=d("WAWebProtobufsE2E.pb")).MessageSpec],messageTimestamp:[3,h.TYPES.UINT64],status:[4,h.TYPES.ENUM,f],participant:[5,h.TYPES.STRING],messageC2STimestamp:[6,h.TYPES.UINT64],ignore:[16,h.TYPES.BOOL],starred:[17,h.TYPES.BOOL],broadcast:[18,h.TYPES.BOOL],pushName:[19,h.TYPES.STRING],mediaCiphertextSha256:[20,h.TYPES.BYTES],multicast:[21,h.TYPES.BOOL],urlText:[22,h.TYPES.BOOL],urlNumber:[23,h.TYPES.BOOL],messageStubType:[24,h.TYPES.ENUM,e],clearMedia:[25,h.TYPES.BOOL],messageStubParameters:[26,h.FLAGS.REPEATED|h.TYPES.STRING],duration:[27,h.TYPES.UINT32],labels:[28,h.FLAGS.REPEATED|h.TYPES.STRING],paymentInfo:[29,h.TYPES.MESSAGE,p],finalLiveLocation:[30,h.TYPES.MESSAGE,d.Message$LiveLocationMessageSpec],quotedPaymentInfo:[31,h.TYPES.MESSAGE,p],ephemeralStartTimestamp:[32,h.TYPES.UINT64],ephemeralDuration:[33,h.TYPES.UINT32],ephemeralOffToOn:[34,h.TYPES.BOOL],ephemeralOutOfSync:[35,h.TYPES.BOOL],bizPrivacyStatus:[36,h.TYPES.ENUM,c],verifiedBizName:[37,h.TYPES.STRING],mediaData:[38,h.TYPES.MESSAGE,u],photoChange:[39,h.TYPES.MESSAGE,v],userReceipt:[40,h.FLAGS.REPEATED|h.TYPES.MESSAGE,x],reactions:[41,h.FLAGS.REPEATED|h.TYPES.MESSAGE,y],quotedStickerData:[42,h.TYPES.MESSAGE,u],futureproofData:[43,h.TYPES.BYTES],statusPsa:[44,h.TYPES.MESSAGE,w],pollUpdates:[45,h.FLAGS.REPEATED|h.TYPES.MESSAGE,z],pollAdditionalMetadata:[46,h.TYPES.MESSAGE,A],agentId:[47,h.TYPES.STRING],statusAlreadyViewed:[48,h.TYPES.BOOL],messageSecret:[49,h.TYPES.BYTES],keepInChat:[50,h.TYPES.MESSAGE,C],originalSelfAuthorUserJidString:[51,h.TYPES.STRING],revokeMessageTimestamp:[52,h.TYPES.UINT64],pinInChat:[54,h.TYPES.MESSAGE,D],premiumMessageInfo:[55,h.TYPES.MESSAGE,F],is1PBizBotMessage:[56,h.TYPES.BOOL],isGroupHistoryMessage:[57,h.TYPES.BOOL],botMessageInvokerJid:[58,h.TYPES.STRING],commentMetadata:[59,h.TYPES.MESSAGE,o],eventResponses:[61,h.FLAGS.REPEATED|h.TYPES.MESSAGE,G],reportingTokenInfo:[62,h.TYPES.MESSAGE,t],newsletterServerId:[63,h.TYPES.UINT64],eventAdditionalMetadata:[64,h.TYPES.MESSAGE,B],isMentionedInStatus:[65,h.TYPES.BOOL],statusMentions:[66,h.FLAGS.REPEATED|h.TYPES.STRING],targetMessageId:[67,h.TYPES.MESSAGE,i.MessageKeySpec],messageAddOns:[68,h.FLAGS.REPEATED|h.TYPES.MESSAGE,I],statusMentionMessageInfo:[69,h.TYPES.MESSAGE,J],isSupportAiMessage:[70,h.TYPES.BOOL]};o.internalSpec={commentParentKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],replyCount:[2,h.TYPES.UINT32]};p.internalSpec={currencyDeprecated:[1,h.TYPES.ENUM,k],amount1000:[2,h.TYPES.UINT64],receiverJid:[3,h.TYPES.STRING],status:[4,h.TYPES.ENUM,j],transactionTimestamp:[5,h.TYPES.UINT64],requestMessageKey:[6,h.TYPES.MESSAGE,i.MessageKeySpec],expiryTimestamp:[7,h.TYPES.UINT64],futureproofed:[8,h.TYPES.BOOL],currency:[9,h.TYPES.STRING],txnStatus:[10,h.TYPES.ENUM,b],useNoviFiatFormat:[11,h.TYPES.BOOL],primaryAmount:[12,h.TYPES.MESSAGE,d.MoneySpec],exchangeAmount:[13,h.TYPES.MESSAGE,d.MoneySpec]};q.internalSpec={timestamp:[2,h.TYPES.UINT64],unreadChats:[3,h.TYPES.UINT32],notifyMessageCount:[4,h.TYPES.UINT32],notifyMessages:[5,h.FLAGS.REPEATED|h.TYPES.MESSAGE,n]};r.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],message:[2,h.TYPES.MESSAGE,d.MessageSpec],messageTimestamp:[3,h.TYPES.UINT64],participant:[4,h.TYPES.STRING]};s.internalSpec={labelsDisplay:[1,h.TYPES.ENUM,l],voipIndividualOutgoing:[2,h.TYPES.ENUM,l],groupsV3:[3,h.TYPES.ENUM,l],groupsV3Create:[4,h.TYPES.ENUM,l],changeNumberV2:[5,h.TYPES.ENUM,l],queryStatusV3Thumbnail:[6,h.TYPES.ENUM,l],liveLocations:[7,h.TYPES.ENUM,l],queryVname:[8,h.TYPES.ENUM,l],voipIndividualIncoming:[9,h.TYPES.ENUM,l],quickRepliesQuery:[10,h.TYPES.ENUM,l],payments:[11,h.TYPES.ENUM,l],stickerPackQuery:[12,h.TYPES.ENUM,l],liveLocationsFinal:[13,h.TYPES.ENUM,l],labelsEdit:[14,h.TYPES.ENUM,l],mediaUpload:[15,h.TYPES.ENUM,l],mediaUploadRichQuickReplies:[18,h.TYPES.ENUM,l],vnameV2:[19,h.TYPES.ENUM,l],videoPlaybackUrl:[20,h.TYPES.ENUM,l],statusRanking:[21,h.TYPES.ENUM,l],voipIndividualVideo:[22,h.TYPES.ENUM,l],thirdPartyStickers:[23,h.TYPES.ENUM,l],frequentlyForwardedSetting:[24,h.TYPES.ENUM,l],groupsV4JoinPermission:[25,h.TYPES.ENUM,l],recentStickers:[26,h.TYPES.ENUM,l],catalog:[27,h.TYPES.ENUM,l],starredStickers:[28,h.TYPES.ENUM,l],voipGroupCall:[29,h.TYPES.ENUM,l],templateMessage:[30,h.TYPES.ENUM,l],templateMessageInteractivity:[31,h.TYPES.ENUM,l],ephemeralMessages:[32,h.TYPES.ENUM,l],e2ENotificationSync:[33,h.TYPES.ENUM,l],recentStickersV2:[34,h.TYPES.ENUM,l],recentStickersV3:[36,h.TYPES.ENUM,l],userNotice:[37,h.TYPES.ENUM,l],support:[39,h.TYPES.ENUM,l],groupUiiCleanup:[40,h.TYPES.ENUM,l],groupDogfoodingInternalOnly:[41,h.TYPES.ENUM,l],settingsSync:[42,h.TYPES.ENUM,l],archiveV2:[43,h.TYPES.ENUM,l],ephemeralAllowGroupMembers:[44,h.TYPES.ENUM,l],ephemeral24HDuration:[45,h.TYPES.ENUM,l],mdForceUpgrade:[46,h.TYPES.ENUM,l],disappearingMode:[47,h.TYPES.ENUM,l],externalMdOptInAvailable:[48,h.TYPES.ENUM,l],noDeleteMessageTimeLimit:[49,h.TYPES.ENUM,l]};t.internalSpec={reportingTag:[1,h.TYPES.BYTES]};u.internalSpec={localPath:[1,h.TYPES.STRING]};v.internalSpec={oldPhoto:[1,h.TYPES.BYTES],newPhoto:[2,h.TYPES.BYTES],newPhotoId:[3,h.TYPES.UINT32]};w.internalSpec={campaignId:[44,h.FLAGS.REQUIRED|h.TYPES.UINT64],campaignExpirationTimestamp:[45,h.TYPES.UINT64]};x.internalSpec={userJid:[1,h.FLAGS.REQUIRED|h.TYPES.STRING],receiptTimestamp:[2,h.TYPES.INT64],readTimestamp:[3,h.TYPES.INT64],playedTimestamp:[4,h.TYPES.INT64],pendingDeviceJid:[5,h.FLAGS.REPEATED|h.TYPES.STRING],deliveredDeviceJid:[6,h.FLAGS.REPEATED|h.TYPES.STRING]};y.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],text:[2,h.TYPES.STRING],groupingKey:[3,h.TYPES.STRING],senderTimestampMs:[4,h.TYPES.INT64],unread:[5,h.TYPES.BOOL]};z.internalSpec={pollUpdateMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],vote:[2,h.TYPES.MESSAGE,d.Message$PollVoteMessageSpec],senderTimestampMs:[3,h.TYPES.INT64],serverTimestampMs:[4,h.TYPES.INT64],unread:[5,h.TYPES.BOOL]};A.internalSpec={pollInvalidated:[1,h.TYPES.BOOL]};B.internalSpec={isStale:[1,h.TYPES.BOOL]};C.internalSpec={keepType:[1,h.TYPES.ENUM,d.KeepType],serverTimestamp:[2,h.TYPES.INT64],key:[3,h.TYPES.MESSAGE,i.MessageKeySpec],deviceJid:[4,h.TYPES.STRING],clientTimestampMs:[5,h.TYPES.INT64],serverTimestampMs:[6,h.TYPES.INT64]};D.internalSpec={type:[1,h.TYPES.ENUM,m],key:[2,h.TYPES.MESSAGE,i.MessageKeySpec],senderTimestampMs:[3,h.TYPES.INT64],serverTimestampMs:[4,h.TYPES.INT64],messageAddOnContextInfo:[5,h.TYPES.MESSAGE,E]};E.internalSpec={messageAddOnDurationInSecs:[1,h.TYPES.UINT32],messageAddOnExpiryType:[2,h.TYPES.ENUM,d.MessageContextInfo$MessageAddonExpiryType]};F.internalSpec={serverCampaignId:[1,h.TYPES.STRING]};G.internalSpec={eventResponseMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],timestampMs:[2,h.TYPES.INT64],eventResponseMessage:[3,h.TYPES.MESSAGE,d.Message$EventResponseMessageSpec],unread:[4,h.TYPES.BOOL]};H.internalSpec={eventResponseMessage:[1,h.TYPES.MESSAGE,d.Message$EventResponseMessageSpec],pollVote:[2,h.TYPES.MESSAGE,d.Message$PollVoteMessageSpec]};I.internalDefaults={status:f.PENDING};I.internalSpec={messageAddOnType:[1,h.TYPES.ENUM,a],messageAddOn:[2,h.TYPES.MESSAGE,d.MessageSpec],senderTimestampMs:[3,h.TYPES.INT64],serverTimestampMs:[4,h.TYPES.INT64],status:[5,h.TYPES.ENUM,f],addOnContextInfo:[6,h.TYPES.MESSAGE,E],messageAddOnKey:[7,h.TYPES.MESSAGE,i.MessageKeySpec],legacyMessage:[8,h.TYPES.MESSAGE,H]};J.internalSpec={quotedStatus:[1,h.TYPES.MESSAGE,d.MessageSpec]};g.WebMessageInfo$BizPrivacyStatus=c;g.WebMessageInfo$StubType=e;g.WebMessageInfo$Status=f;g.PaymentInfo$TxnStatus=b;g.PaymentInfo$Status=j;g.PaymentInfo$Currency=k;g.WebFeatures$Flag=l;g.PinInChat$Type=m;g.MessageAddOn$MessageAddOnType=a;g.WebMessageInfoSpec=n;g.CommentMetadataSpec=o;g.PaymentInfoSpec=p;g.WebNotificationsInfoSpec=q;g.NotificationMessageInfoSpec=r;g.WebFeaturesSpec=s;g.ReportingTokenInfoSpec=t;g.MediaDataSpec=u;g.PhotoChangeSpec=v;g.StatusPSASpec=w;g.UserReceiptSpec=x;g.ReactionSpec=y;g.PollUpdateSpec=z;g.PollAdditionalMetadataSpec=A;g.EventAdditionalMetadataSpec=B;g.KeepInChatSpec=C;g.PinInChatSpec=D;g.MessageAddOnContextInfoSpec=E;g.PremiumMessageInfoSpec=F;g.EventResponseSpec=G;g.LegacyMessageSpec=H;g.MessageAddOnSpec=I;g.StatusMentionMessageSpec=J}),98);
__d("WAWebProtobufsHistorySync.pb",["$InternalEnum","WAProtoConst","WAWebProtobufSyncAction.pb","WAWebProtobufsChatLockSettings.pb","WAWebProtobufsE2E.pb","WAWebProtobufsWeb.pb"],(function(a,b,c,d,e,f,g){var h;c=(a=b("$InternalEnum"))({IN_WAITLIST:0,AI_AVAILABLE:1});e=a({INITIAL_BOOTSTRAP:0,INITIAL_STATUS_V3:1,FULL:2,RECENT:3,PUSH_NAME:4,NON_BLOCKING_DATA:5,ON_DEMAND:6});f=a({COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY:0,COMPLETE_AND_NO_MORE_MESSAGE_REMAIN_ON_PRIMARY:1,COMPLETE_ON_DEMAND_SYNC_BUT_MORE_MSG_REMAIN_ON_PRIMARY:2});b=a({REGULAR:0,ADMIN:1,SUPERADMIN:2});var i=a({DEFAULT:0,OFF:1,ON:2}),j=a({LEFT:0,REMOVED:1});a=a({E2EE_MSG:1,NE2EE_SELF:2,NE2EE_OTHER:3});var k={},l={},m={},n={},o={},p={},q={},r={},s={},t={},u={},v={},w={},x={};k.internalSpec={syncType:[1,(h=d("WAProtoConst")).FLAGS.REQUIRED|h.TYPES.ENUM,e],conversations:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,l],statusV3Messages:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,d("WAWebProtobufsWeb.pb").WebMessageInfoSpec],chunkOrder:[5,h.TYPES.UINT32],progress:[6,h.TYPES.UINT32],pushnames:[7,h.FLAGS.REPEATED|h.TYPES.MESSAGE,o],globalSettings:[8,h.TYPES.MESSAGE,r],threadIdUserSecret:[9,h.TYPES.BYTES],threadDsTimeframeOffset:[10,h.TYPES.UINT32],recentStickers:[11,h.FLAGS.REPEATED|h.TYPES.MESSAGE,t],pastParticipants:[12,h.FLAGS.REPEATED|h.TYPES.MESSAGE,u],callLogRecords:[13,h.FLAGS.REPEATED|h.TYPES.MESSAGE,d("WAWebProtobufSyncAction.pb").CallLogRecordSpec],aiWaitListState:[14,h.TYPES.ENUM,c],phoneNumberToLidMappings:[15,h.FLAGS.REPEATED|h.TYPES.MESSAGE,m],companionMetaNonce:[16,h.TYPES.STRING],shareableChatIdentifierEncryptionKey:[17,h.TYPES.BYTES]};l.internalSpec={id:[1,h.FLAGS.REQUIRED|h.TYPES.STRING],messages:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,n],newJid:[3,h.TYPES.STRING],oldJid:[4,h.TYPES.STRING],lastMsgTimestamp:[5,h.TYPES.UINT64],unreadCount:[6,h.TYPES.UINT32],readOnly:[7,h.TYPES.BOOL],endOfHistoryTransfer:[8,h.TYPES.BOOL],ephemeralExpiration:[9,h.TYPES.UINT32],ephemeralSettingTimestamp:[10,h.TYPES.INT64],endOfHistoryTransferType:[11,h.TYPES.ENUM,f],conversationTimestamp:[12,h.TYPES.UINT64],name:[13,h.TYPES.STRING],pHash:[14,h.TYPES.STRING],notSpam:[15,h.TYPES.BOOL],archived:[16,h.TYPES.BOOL],disappearingMode:[17,h.TYPES.MESSAGE,d("WAWebProtobufsE2E.pb").DisappearingModeSpec],unreadMentionCount:[18,h.TYPES.UINT32],markedAsUnread:[19,h.TYPES.BOOL],participant:[20,h.FLAGS.REPEATED|h.TYPES.MESSAGE,p],tcToken:[21,h.TYPES.BYTES],tcTokenTimestamp:[22,h.TYPES.UINT64],contactPrimaryIdentityKey:[23,h.TYPES.BYTES],pinned:[24,h.TYPES.UINT32],muteEndTime:[25,h.TYPES.UINT64],wallpaper:[26,h.TYPES.MESSAGE,q],mediaVisibility:[27,h.TYPES.ENUM,i],tcTokenSenderTimestamp:[28,h.TYPES.UINT64],suspended:[29,h.TYPES.BOOL],terminated:[30,h.TYPES.BOOL],createdAt:[31,h.TYPES.UINT64],createdBy:[32,h.TYPES.STRING],description:[33,h.TYPES.STRING],support:[34,h.TYPES.BOOL],isParentGroup:[35,h.TYPES.BOOL],parentGroupId:[37,h.TYPES.STRING],isDefaultSubgroup:[36,h.TYPES.BOOL],displayName:[38,h.TYPES.STRING],pnJid:[39,h.TYPES.STRING],shareOwnPn:[40,h.TYPES.BOOL],pnhDuplicateLidThread:[41,h.TYPES.BOOL],lidJid:[42,h.TYPES.STRING],username:[43,h.TYPES.STRING],lidOriginType:[44,h.TYPES.STRING],commentsCount:[45,h.TYPES.UINT32],locked:[46,h.TYPES.BOOL],systemMessageToInsert:[47,h.TYPES.ENUM,a],capiCreatedGroup:[48,h.TYPES.BOOL]};m.internalSpec={pnJid:[1,h.TYPES.STRING],lidJid:[2,h.TYPES.STRING]};n.internalSpec={message:[1,h.TYPES.MESSAGE,d("WAWebProtobufsWeb.pb").WebMessageInfoSpec],msgOrderId:[2,h.TYPES.UINT64]};o.internalSpec={id:[1,h.TYPES.STRING],pushname:[2,h.TYPES.STRING]};p.internalSpec={userJid:[1,h.FLAGS.REQUIRED|h.TYPES.STRING],rank:[2,h.TYPES.ENUM,b]};q.internalSpec={filename:[1,h.TYPES.STRING],opacity:[2,h.TYPES.UINT32]};r.internalSpec={lightThemeWallpaper:[1,h.TYPES.MESSAGE,q],mediaVisibility:[2,h.TYPES.ENUM,i],darkThemeWallpaper:[3,h.TYPES.MESSAGE,q],autoDownloadWiFi:[4,h.TYPES.MESSAGE,s],autoDownloadCellular:[5,h.TYPES.MESSAGE,s],autoDownloadRoaming:[6,h.TYPES.MESSAGE,s],showIndividualNotificationsPreview:[7,h.TYPES.BOOL],showGroupNotificationsPreview:[8,h.TYPES.BOOL],disappearingModeDuration:[9,h.TYPES.INT32],disappearingModeTimestamp:[10,h.TYPES.INT64],avatarUserSettings:[11,h.TYPES.MESSAGE,w],fontSize:[12,h.TYPES.INT32],securityNotifications:[13,h.TYPES.BOOL],autoUnarchiveChats:[14,h.TYPES.BOOL],videoQualityMode:[15,h.TYPES.INT32],photoQualityMode:[16,h.TYPES.INT32],individualNotificationSettings:[17,h.TYPES.MESSAGE,x],groupNotificationSettings:[18,h.TYPES.MESSAGE,x],chatLockSettings:[19,h.TYPES.MESSAGE,d("WAWebProtobufsChatLockSettings.pb").ChatLockSettingsSpec]};s.internalSpec={downloadImages:[1,h.TYPES.BOOL],downloadAudio:[2,h.TYPES.BOOL],downloadVideo:[3,h.TYPES.BOOL],downloadDocuments:[4,h.TYPES.BOOL]};t.internalSpec={url:[1,h.TYPES.STRING],fileSha256:[2,h.TYPES.BYTES],fileEncSha256:[3,h.TYPES.BYTES],mediaKey:[4,h.TYPES.BYTES],mimetype:[5,h.TYPES.STRING],height:[6,h.TYPES.UINT32],width:[7,h.TYPES.UINT32],directPath:[8,h.TYPES.STRING],fileLength:[9,h.TYPES.UINT64],weight:[10,h.TYPES.FLOAT],lastStickerSentTs:[11,h.TYPES.INT64],isLottie:[12,h.TYPES.BOOL]};u.internalSpec={groupJid:[1,h.TYPES.STRING],pastParticipants:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,v]};v.internalSpec={userJid:[1,h.TYPES.STRING],leaveReason:[2,h.TYPES.ENUM,j],leaveTs:[3,h.TYPES.UINT64]};w.internalSpec={fbid:[1,h.TYPES.STRING],password:[2,h.TYPES.STRING]};x.internalSpec={messageVibrate:[1,h.TYPES.STRING],messagePopup:[2,h.TYPES.STRING],messageLight:[3,h.TYPES.STRING],lowPriorityNotifications:[4,h.TYPES.BOOL],reactionsMuted:[5,h.TYPES.BOOL],callVibrate:[6,h.TYPES.STRING]};g.HistorySync$BotAIWaitListState=c;g.HistorySync$HistorySyncType=e;g.Conversation$EndOfHistoryTransferType=f;g.GroupParticipant$Rank=b;g.MediaVisibility=i;g.PastParticipant$LeaveReason=j;g.PrivacySystemMessage=a;g.HistorySyncSpec=k;g.ConversationSpec=l;g.PhoneNumberToLIDMappingSpec=m;g.HistorySyncMsgSpec=n;g.PushnameSpec=o;g.GroupParticipantSpec=p;g.WallpaperSettingsSpec=q;g.GlobalSettingsSpec=r;g.AutoDownloadSettingsSpec=s;g.StickerMetadataSpec=t;g.PastParticipantsSpec=u;g.PastParticipantSpec=v;g.AvatarUserSettingsSpec=w;g.NotificationSettingsSpec=x}),98);
__d("WAWebUserPrefsHistorySync",["WALogger","WATimeUtils","WAWebPermanentStorage","WAWebProtobufsHistorySync.pb","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsKeys","WAWebUserPrefsMultiDevice","WAWebUserPrefsStore","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[history sync] set recent sync single chunk "," status to ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[history sync] set last history sync chunk with chunk order ",""]);i=function(){return a};return a}function a(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){if(a==null||b==null)return;a===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT&&(d("WALogger").LOG(i(),b),yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.MD_HISTORY_LAST_RECENT_SYNC_CHUNK_PROCESSED,{chunkOrder:b,progress:e}));yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.MD_HISTORY_LAST_CHUNK_PROCESSED,a+"_"+b);c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").MD_KEYS.MD_HISTORY_LAST_CHUNK_PROCESSED,a+"_"+b,{shouldWriteToIdb:!1})});return j.apply(this,arguments)}function e(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.MD_HISTORY_LAST_CHUNK_PROCESSED);return a}function f(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.MD_HISTORY_LAST_RECENT_SYNC_CHUNK_PROCESSED);return a}function k(){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.INITIAL_HISTORY_SYNCED,!0);return c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").MD_KEYS.INITIAL_HISTORY_SYNCED,"true",{shouldWriteToIdb:!1})});return l.apply(this,arguments)}function m(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.INITIAL_HISTORY_SYNCED);return a===!0}function n(){return!!c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").MD_KEYS.INITIAL_HISTORY_SYNCED,{storage:c("WAWebPermanentStorage")})}function o(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(b=(yield q()))!=null?b:{};yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_STATUS,babelHelpers["extends"]({},b,a));c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").MD_KEYS.HISTORY_SYNC_STATUS,babelHelpers["extends"]({},b,a),{shouldWriteToIdb:!1})});return p.apply(this,arguments)}function q(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_STATUS);return a}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_CHUNK_COUNT_FOR_END_OF_RECENT_SYNC,a)});return s.apply(this,arguments)}function t(){var a;return(a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_CHUNK_COUNT_FOR_END_OF_RECENT_SYNC))!=null?a:0}function u(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.ESTIMATED_HISTORY_SYNC_CHUNK_COUNT_FOR_END_OF_RECENT_SYNC,a)});return v.apply(this,arguments)}function w(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.ESTIMATED_HISTORY_SYNC_CHUNK_COUNT_FOR_END_OF_RECENT_SYNC);return(a=a)!=null?a:0}function x(){var a=c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").MD_KEYS.HISTORY_SYNC_REMAINING_PAUSED_SECONDS);if(typeof a==="number")return a}function y(a){c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").MD_KEYS.HISTORY_SYNC_REMAINING_PAUSED_SECONDS,a)}function z(){var a=c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").KEYS.HISTORY_SYNC_EARLIEST_DATE);if(typeof a!=="number"||a===0){var b;b=(b=d("WAWebUserPrefsMultiDevice").getPairingTimestamp())!=null?b:d("WATimeUtils").unixTime();var e=90*d("WATimeUtils").DAY_SECONDS;return b-e}return a}function A(a){c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.HISTORY_SYNC_EARLIEST_DATE,a)}function B(a,b,c){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){if(c==null||a!==d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT)return;d("WALogger").LOG(h(),c,b);c=(a={},a[c]=b,a);a=(b=(yield D()))!=null?b:{};yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_SINGLE_CHUNK_STATUS,babelHelpers["extends"]({},a,c))});return C.apply(this,arguments)}function D(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_SINGLE_CHUNK_STATUS);return a}function E(a){return F.apply(this,arguments)}function F(){F=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").HASHED_KEYS.INITIAL_HIST_BOUNDARY,a)});return F.apply(this,arguments)}function G(){return d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").HASHED_KEYS.INITIAL_HIST_BOUNDARY)}function H(a){return I.apply(this,arguments)}function I(){I=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_STATUS_AFTER_PAIRING_LOGGING_COUNT,a)});return I.apply(this,arguments)}function J(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_STATUS_AFTER_PAIRING_LOGGING_COUNT);return a}function K(a){return L.apply(this,arguments)}function L(){L=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(b=M())!=null?b:0;yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_TOTAL_PROCESSED_MESSAGE_COUNT,b+a)});return L.apply(this,arguments)}function M(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_TOTAL_PROCESSED_MESSAGE_COUNT);return a}g.setLastHistorySyncedChunk=a;g.getLastHistorySyncedChunk=e;g.getLastHistoryRecentSyncedChunk=f;g.setInitialHistorySyncComplete=k;g.getInitialHistorySyncComplete=m;g.getInitialHistorySyncCompleteLocalStorage=n;g.setHistorySyncStatus=o;g.getHistorySyncStatus=q;g.setChunkCountForEndOfRecentHistorySync=r;g.getChunkCountForEndOfRecentHistorySync=t;g.setEstimatedChunkCountForEndOfRecentHistorySync=u;g.getEstimatedChunkCountForEndOfRecentHistorySync=w;g.getHistorySyncRemainingPausedSeconds=x;g.setHistorySyncRemainingPausedSeconds=y;g.getHistorySyncEarliestDate=z;g.setHistorySyncEarliestDate=A;g.setRecentSyncSingleChunkStatus=B;g.getRecentSyncSingleChunkStatus=D;g.setHistoryInitialSyncBoundary=E;g.getHistoryInitialSyncBoundary=G;g.setHistorySyncStatusAfterPairingLoggingCount=H;g.getHistorySyncStatusAfterPairingLoggingCount=J;g.setHistorySyncTotalProcessedMessageCount=K;g.getHistorySyncTotalProcessedMessageCount=M}),98);
__d("WAWebAddonHydrationUtils",["WALogger","WAWebABProps","WAWebAddonConstants","WAWebAddonCrossWindowUtils","WAWebAddonDBTable","WAWebAddonPerfUtils","WAWebAddonPluginProcessor","WAWebAddonProcessMsgsUtils","WAWebAddonSelectUtils","WAWebMsgKey","WAWebMsgType","WAWebReactionGatingUtils","WAWebUserPrefsHistorySync","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Addon][Hydration] Failed to hydrate "," for "," with error, ",""]);h=function(){return a};return a}var i={};function a(a){var b,c=a;b=c.length&&((b=d("WAWebUserPrefsHistorySync").getHistorySyncStatus())==null?void 0:b.recentCompleted)===!0&&!(c[0].type===d("WAWebMsgType").MSG_TYPE.REACTION&&!d("WAWebReactionGatingUtils").isFlattenedReactionsEnabled())&&d("WAWebABProps").getABPropConfigValue("enable_collection_update_for_hydrated_addons_only");b&&(c=a.filter(function(a){var b;a.type===d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE?b=a.id.remote:b=d("WAWebAddonProcessMsgsUtils").getParentMsgKey(a);return k(b,d("WAWebAddonCrossWindowUtils").getAddonProcessorType(a))}));return c}function e(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.ids,e=a.hydrationType;a=function(a){i[e]||(i[e]=new Set());if(k(a,e))return;i[e].add(a.toString())};b=b.filter(function(a){return!k(a,e)});if(b.length===0)return;var f;try{var g=d("WAWebAddonSelectUtils").getTableModeByMsgType(e);if(e===d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE){f=(yield d("WAWebAddonPerfUtils").createAddonQplMarker(d("WAWebAddonPerfUtils").AddonQplMarkerType.UI,{mode:g,type:d("WAWebAddonPerfUtils").AnnotationRequestType.BulkGetByChatWid,size:1}));var j=b.map(function(a){return a instanceof c("WAWebWid")?a:null}).filter(Boolean);j=(yield d("WAWebAddonDBTable").addonInternalDBTable.bulkGetByChatWid(g,j))}else{f=(yield d("WAWebAddonPerfUtils").createAddonQplMarker(d("WAWebAddonPerfUtils").AddonQplMarkerType.UI,{mode:g,type:d("WAWebAddonPerfUtils").AnnotationRequestType.BulkGetByParentMsgKeys,size:1}));var l=b.map(function(a){return a instanceof c("WAWebMsgKey")?a:null}).filter(Boolean);j=(yield d("WAWebAddonDBTable").addonInternalDBTable.bulkGetByParentMsgKey(g,l))}(g=f)==null?void 0:g.success();j.length&&(yield d("WAWebAddonPluginProcessor").getAddonProcessor(e).updateCollection({add:j,remove:[]},d("WAWebAddonConstants").AddonProcessMode.Hydration));l=d("WAWebUserPrefsHistorySync").getHistorySyncStatus();(l==null?void 0:l.recentCompleted)===!0&&b.forEach(a)}catch(a){(g=f)==null?void 0:g.fail();d("WALogger").ERROR(h(),e,b.map(function(a){return a.toString()}),a).sendLogs("hydratingAddonMsgs",{sampling:.01})}});return j.apply(this,arguments)}function k(a,b){return Boolean((b=i[b])==null?void 0:b.has(a.toString()))}function f(a,b){return k(a,b)}function l(){for(var a of Object.keys(i))delete i[a]}g.filterAddonsByHydratedStatus=a;g.hydrateAddons=e;g.haveAddonsBeenHydratedForParent=f;g.clearHydrationCache=l}),98);
__d("WAWebAddonPerfUtils",["$InternalEnum","WANullthrows","WAQplTypes","WAWebABProps","WAWebAddonConstants","WAWebAddonDBTable","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","WAWebSchemaMessage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum")({BulkUpsert:"bulk_upsert",BulkRemoveByParents:"bulk_remove_by_parents",BulkGetByParentMsgKeys:"bulk_get_by_parent_msg_keys",BulkGetByChatWid:"bulk_get_by_chat_wid",BulkGetParentMsgs:"bulk_get_parent_msgs"}),i=b("$InternalEnum").Mirrored(["Incoming","Outgoing","UI"]);function j(a){if(a<10001)return 1e4;else if(a<30001)return 3e4;else if(a<500001)return 5e4;else if(a<1000001)return 1e5;else if(a<3000001)return 3e5;else if(a<5000001)return 5e5;else if(a<8000001)return 8e5;return 1e6}var k={date:0,values:new Map()};function l(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=k,c=new Date().setHours(0,0,0,0);if(b.date===c){var e=b.values.get(a);if(e==null){var f=j(yield d("WAWebAddonDBTable").addonInternalDBTable.getTableSize(a));b.values.set(a,f);return f}return e}b.date=c;b.values.clear();f=j(yield d("WAWebAddonDBTable").addonInternalDBTable.getTableSize(a));b.values.set(a,f);return f});return m.apply(this,arguments)}function n(){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a="messages",b=k,c=new Date().setHours(0,0,0,0);if(b.date===c){var e=b.values.get(a);if(e==null){var f=j(yield d("WAWebSchemaMessage").getMessageTable().count());b.values.set(a,f);return f}return e}b.date=c;b.values.clear();f=j(yield d("WAWebSchemaMessage").getMessageTable().count());b.values.set(a,f);return f});return o.apply(this,arguments)}function p(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return{string:{request_type:h.getName(a.type),table_mode:d("WAWebAddonConstants").AddonTableMode.getName(a.mode)},"int":{request_size:a.size,table_size:yield l(a.mode)}}});return q.apply(this,arguments)}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return{string:{request_type:h.getName(a.type),table_mode:"messages"},"int":{request_size:a.size,table_size:yield n()}}});return s.apply(this,arguments)}function t(){return d("WAWebABProps").getABPropConfigValue("addon_infra_enable_perf_logging")}function u(a){return{success:function(){return a==null?void 0:a.end(d("WAQplTypes").QuickLogActionType.SUCCESS)},fail:function(){return a==null?void 0:a.end(d("WAQplTypes").QuickLogActionType.FAIL)}}}function v(a){var b=Math.random();return b<=a/100?!0:!1}function w(a,b){switch(a){case i.Incoming:return b===d("WAWebAddonConstants").AddonTableMode.Reaction?v(3):v(10);case i.Outgoing:return v(25);case i.UI:return v(1)}}function x(a,b,c){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){if(!t())return;if(!w(a,b))return;var f;switch(a){case i.Incoming:f=d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.ADDON_PROCESS_INCOMING;break;case i.Outgoing:f=d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.ADDON_PROCESS_OUTGOING;break;case i.UI:f=d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.ADDON_CHAT_REQUEST;break}b=d("WAWebQplQuickPerformanceLoggerModule").QPL.markerStart(c("WANullthrows")(f),{annotations:yield e()});return u(b)});return y.apply(this,arguments)}function a(a,b){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return x(a,b.mode,function(){return p(b)})});return z.apply(this,arguments)}function e(a,b){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return x(a,d("WAWebAddonConstants").AddonTableMode.None,function(){return r(b)})});return A.apply(this,arguments)}g.AnnotationRequestType=h;g.AddonQplMarkerType=i;g.getCachedTableSize=l;g.createAddonQplMarker=a;g.createMessagesQplMarker=e}),98);
__d("WAWebAddonSelectUtils",["WAWebABProps","WAWebAddonConstants","WAWebAddonCrossWindowUtils","WAWebAddonInfraError","WAWebAddonProcessMsgsUtils","WAWebMsgType"],(function(a,b,c,d,e,f,g){function h(a){if(a===d("WAWebMsgType").MSG_TYPE.REVOKED)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedMsgType,"revoke is not expected to cross this path");if(a===d("WAWebMsgType").MSG_TYPE.PROTOCOL)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedMsgType,"protocol revoke is not expected to cross this path");switch(a){case d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE:return d("WAWebABProps").getABPropConfigValue("unified_pin_addon_table_enabled")?d("WAWebAddonConstants").AddonTableMode.Unified:d("WAWebAddonConstants").AddonTableMode.Pin;case d("WAWebMsgType").MSG_TYPE.COMMENT:return d("WAWebAddonConstants").AddonTableMode.Comment;case d("WAWebMsgType").MSG_TYPE.POLL_UPDATE:return d("WAWebAddonConstants").AddonTableMode.PollVote;case d("WAWebMsgType").MSG_TYPE.REACTION_ENC:case d("WAWebMsgType").MSG_TYPE.REACTION:return d("WAWebAddonConstants").AddonTableMode.Reaction;case d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE:return d("WAWebAddonConstants").AddonTableMode.EventResponse;case d("WAWebMsgType").MSG_TYPE.EVENT_EDIT_ENCRYPTED:return d("WAWebAddonConstants").AddonTableMode.None;default:throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedMsgType,"received "+a+" msgType")}}function a(a){return h(d("WAWebAddonCrossWindowUtils").getAddonProcessorType(a))}function b(a){return{getByParentMsgKey:function(b){b=a.get(b);if(b==null)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError);return b},getForAddon:function(b){b=a.get(d("WAWebAddonProcessMsgsUtils").getParentMsgKey(b).toString());if(b==null)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError);return b}}}function c(a){return{get:function(b){b=a.get(b.toString());if(b==null)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError);return b},has:function(b){return Boolean(a.get(b.toString()))}}}g.getTableModeByMsgType=h;g.getAddonTableMode=a;g.createAddonParentSelector=b;g.createAddonSelector=c}),98);
__d("WAWebMessageAssociationConstants",["WAWebMsgType"],(function(a,b,c,d,e,f,g){a=new Set([d("WAWebMsgType").MSG_TYPE.ALBUM]);g.orphanIneligibleFutureproofTypes=a}),98);
__d("WAWebAddonSortUtils",["WAWebAddonCrossWindowUtils","WAWebAddonPluginProcessor","WAWebAddonProcessMsgsUtils","WAWebAddonSelectUtils","WAWebMessageAssociationConstants","WAWebMsgType","WAWebWid"],(function(a,b,c,d,e,f,g){function a(a,b){a=h(a,b);b=a.orphans;a=a.nonOrphans;return{orphans:b,validAddons:a}}function h(a,b){var e=[],f=[];for(var a=a,g=Array.isArray(a),h=0,a=g?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=a.length)break;i=a[h++]}else{h=a.next();if(h.done)break;i=h.value}i=i;var j=b.get(d("WAWebAddonProcessMsgsUtils").getParentMsgKey(i).toString()),k=j==null||(j==null?void 0:j.type)===d("WAWebMsgType").MSG_TYPE.UNKNOWN;(j==null?void 0:j.futureproofType)!=null?k=!d("WAWebMessageAssociationConstants").orphanIneligibleFutureproofTypes.has(j.futureproofType):(j==null?void 0:j.type)===d("WAWebMsgType").MSG_TYPE.CIPHERTEXT&&(k=!0);if(k)e.push(i);else if(j!=null){j=j.broadcastId!=null&&c("WAWebWid").isWid(j.broadcastId)&&Boolean((k=j.broadcastId)==null?void 0:k.isBroadcastList());j?f.push(babelHelpers["extends"]({},i,{author:void 0})):f.push(i)}}return{orphans:e,nonOrphans:f}}function b(a){var b=new Map();for(var a=a,c=Array.isArray(a),e=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(c){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;var g=d("WAWebAddonSelectUtils").getAddonTableMode(f);b.has(g)||b.set(g,[]);(g=b.get(g))==null?void 0:g.push(f)}return b}function e(a,b,c){var e=new Map();for(var c=c,f=Array.isArray(c),g=0,c=f?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=c.length)break;h=c[g++]}else{g=c.next();if(g.done)break;h=g.value}h=h;var i=d("WAWebAddonCrossWindowUtils").getAddonProcessorType(h);if(!e.has(i)){var j=d("WAWebAddonPluginProcessor").getAddonProcessor(i);e.set(i,{processor:j,processMode:a,tableMode:b,addons:[]})}(j=e.get(i))==null?void 0:j.addons.push(h)}return Array.from(e.values())}g.collectValidAndOrphanAddons=a;g.collectValidAndOrphans=h;g.groupAddonsByTableMode=b;g.groupAddonsByProcessor=e}),98);
__d("WAWebAddonUpdateDataUtils",["Promise","WANullthrows","WAWebABProps","WAWebAddonConstants","WAWebAddonDBTable","WAWebAddonHydrationUtils","WAWebAddonInfraError","WAWebAddonPerfUtils","WAWebAddonProcessMsgsUtils","WAWebAddonSelectUtils","WAWebAddonSortUtils","WAWebCommentUtils","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=new Set([(e=d("WAWebAddonConstants")).AddonProcessMode.OnlineReceive,e.AddonProcessMode.Revoke,e.AddonProcessMode.DeleteForMe,e.AddonProcessMode.DeleteWithParent]);function j(a,b,c,d){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){var i,j,k=[];i=(i=f.removeByMsgKey)!=null?i:[];j=(j=f.removeByMsgKey)!=null?j:[];f.remove!=null&&f.remove.length>0&&(i=i.concat(f.remove.map(function(a){return a.id})),j=j.concat(d("WAWebAddonHydrationUtils").filterAddonsByHydratedStatus(f.remove).map(function(a){return a.id})));if(e!==d("WAWebAddonConstants").AddonTableMode.None){if(f.add!=null&&f.add.length>0){var l=function(){var i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var i;g==null?void 0:(i=g.sendPerfReporter)==null?void 0:i.startSavedStage();i=(yield d("WAWebAddonPerfUtils").createAddonQplMarker(a===d("WAWebAddonConstants").AddonProcessMode.Send?d("WAWebAddonPerfUtils").AddonQplMarkerType.Outgoing:d("WAWebAddonPerfUtils").AddonQplMarkerType.Incoming,{mode:e,type:d("WAWebAddonPerfUtils").AnnotationRequestType.BulkUpsert,size:f.add.length}));try{a===d("WAWebAddonConstants").AddonProcessMode.SetAck?yield (h||(h=b("Promise"))).all(f.add.map(function(a){return d("WAWebAddonDBTable").addonInternalDBTable.updateAck(e,a,c("WANullthrows")(a.ack,"ack is not defined"))})):yield d("WAWebAddonDBTable").addonInternalDBTable.bulkUpsert(e,f.add),i==null?void 0:i.success()}catch(a){i==null?void 0:i.fail();throw a}g==null?void 0:(i=g.sendPerfReporter)==null?void 0:i.postSavedStage()});return function(){return i.apply(this,arguments)}}();k.push(l())}i.length>0&&k.push(d("WAWebAddonDBTable").addonInternalDBTable.bulkRemoveByMsgKey(e,i))}k.length>0&&(yield (h||(h=b("Promise"))).all(k));return{removeFromUICollection:j}});return k.apply(this,arguments)}function a(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){var f=a.processMode;a=a.tableMode;e=e==null?void 0:e.metricReporter;if(f===d("WAWebAddonConstants").AddonProcessMode.Hydration)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError);var g=(yield j(f,a,c,e)),k=g.removeFromUICollection;if(f===d("WAWebAddonConstants").AddonProcessMode.HistorySync&&d("WAWebABProps").getABPropConfigValue("enable_collection_update_for_hydrated_addons_only"))return;if(c.add!=null){e==null?void 0:(g=e.sendPerfReporter)==null?void 0:g.startRenderedStage();yield (h||(h=b("Promise"))).all(d("WAWebAddonSortUtils").groupAddonsByProcessor(f,a,c.add).map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebAddonHydrationUtils").filterAddonsByHydratedStatus(a.addons),c=b.length!==0||k.length!==0||f===d("WAWebAddonConstants").AddonProcessMode.OnlineReceive;c&&(yield a.processor.updateCollection({add:b,remove:k},f),i.has(f)&&(yield a.processor.manageNotifications({add:f===d("WAWebAddonConstants").AddonProcessMode.Revoke?[]:a.addons,remove:k},{processMode:f})))});return function(b){return a.apply(this,arguments)}}()));e==null?void 0:(g=e.sendPerfReporter)==null?void 0:g.postRenderedStage()}else if(c.remove!=null){yield (h||(h=b("Promise"))).all(d("WAWebAddonSortUtils").groupAddonsByProcessor(f,a,c.remove).map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield a.processor.updateCollection({add:[],remove:k},f),i.has(f)&&(yield a.processor.manageNotifications({add:[],remove:k},{processMode:f}))});return function(b){return a.apply(this,arguments)}}()));if(f===d("WAWebAddonConstants").AddonProcessMode.DeleteForMe&&a===d("WAWebAddonConstants").AddonTableMode.Comment){e=(yield d("WAWebAddonProcessMsgsUtils").queryAddonParentMsgs(c.remove,d("WAWebAddonConstants").AddonProcessMode.DeleteForMe));g=e[0];a=[];for(e of c.remove)e.kind===d("WAWebMsgType").MsgKind.CommentDecrypted&&a.push(e);yield d("WAWebCommentUtils").updateReplyCount([],d("WAWebAddonSelectUtils").createAddonParentSelector(g),a)}}else throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError)});return l.apply(this,arguments)}g.updateAddonsInTableMode=a}),98);
__d("WAWebBusinessProfileVersioningBridge",["WAWebBizGatingUtils","WAWebServerPropsModel"],(function(a,b,c,d,e,f,g){var h=3,i=4,j=16,k=32,l=64,m=128,n=256;function a(){return o(d("WAWebServerPropsModel").ServerProps.webBizProfileOptions)}function o(a){var b=h|i|j|l|m|k;d("WAWebBizGatingUtils").bizLinkedAccountsEnabled()&&(b|=n);return a&b}g.DIRECT_CONNECTION_FLAG=m;g.getBusinessProfileQueryVersion=a;g.getBusinessProfileQueryVersionWithCustomBizProfileOptions=o}),98);
__d("WAWebApiMembershipApprovalRequestStore",["WAWebSchemaMembershipApprovalRequest","WAWebWidFactory"],(function(a,b,c,d,e,f,g){a=function(a){return d("WAWebSchemaMembershipApprovalRequest").getMembershipApprovalRequestTable().equals(["groupId"],a.toString()).then(function(a){return a.map(function(a){var b=a.id,c=a.t,e=a.addedBy,f=a.requestMethod;a=a.parentGroupId;return{id:d("WAWebWidFactory").createWid(b),t:c,addedBy:d("WAWebWidFactory").createWid(e),requestMethod:f,parentGroupId:a!=null?d("WAWebWidFactory").createWid(a):void 0}})})};b=function(a,b){b=b.map(function(b){var c=b.id,d=b.t,e=b.addedBy,f=b.requestMethod;b=b.parentGroupId;return{groupId:a.toString(),id:c.toString(),t:d,addedBy:e.toString(),requestMethod:f,parentGroupId:b==null?void 0:b.toString()}});return d("WAWebSchemaMembershipApprovalRequest").getMembershipApprovalRequestTable().bulkCreateOrReplace(b)};c=function(a,b){var c=a.toString();return d("WAWebSchemaMembershipApprovalRequest").getMembershipApprovalRequestTable().bulkRemove(b.map(function(a){return[c,a.toString()]}))};e=function(a){return d("WAWebSchemaMembershipApprovalRequest").getMembershipApprovalRequestTable().bulkRemoveByIndex(["groupId"],[a.toString()])};g.getMembershipApprovalRequests=a;g.addMembershipApprovalRequests=b;g.removeMembershipApprovalRequests=c;g.removeAllMembershipApprovalRequests=e}),98);
__d("WAWebWamEnumTypeOfGroupEnum",[],(function(a,b,c,d,e,f){a=Object.freeze({GROUP:1,SUBGROUP:2,DEFAULT_SUBGROUP:3});f.TYPE_OF_GROUP_ENUM=a}),66);
__d("WAWebGroupType",["$InternalEnum","WAWebWamEnumTypeOfGroupEnum"],(function(a,b,c,d,e,f,g){f=(e=b("$InternalEnum"))({On:"on",Off:"off"});b=e({Admin:"admin",Regular:"regular"});var h=e({Server:"server",Full:"full"}),i=Object.freeze({SUBJECT:"subject",ADD:"add",PROMOTE:"promote",DEMOTE:"demote",DELETE:"delete",REMOVE:"remove",MODIFY:"modify",INVITE_CODE:"invite",DESC_ADD:"desc_add",DESC_REMOVE:"desc_remove",RESTRICT:"restrict",ANNOUNCE:"announce",NO_FORWARD:"no_frequently_forwarded",EPHEMERAL:"ephemeral",REVOKE_INVITE:"revoke_invite",SUSPEND:"suspend",GROWTH_LOCKED:"growth_locked",GROWTH_UNLOCKED:"growth_unlocked",SUB_GROUP_LINK:"sub_group_link",PARENT_GROUP_LINK:"parent_group_link",SIBLING_GROUP_LINK:"sibling_group_link",SUB_GROUP_UNLINK:"sub_group_unlink",PARENT_GROUP_UNLINK:"parent_group_unlink",SIBLING_GROUP_UNLINK:"sibling_group_unlink",DELETE_PARENT_GROUP:"delete_parent_group",DELETE_PARENT_GROUP_UNLINK:"delete_parent_group_unlink",DELETE_PARENT_SUB_GROUP_UNLINK:"delete_parent_sub_group_unlink",INTEGRITY_PARENT_GROUP_UNLINK:"integrity_parent_group_unlink",INTEGRITY_SUB_GROUP_UNLINK:"integrity_sub_group_unlink",LINKED_GROUP_PROMOTE:"linked_group_promote",LINKED_GROUP_DEMOTE:"linked_group_demote",MEMBERSHIP_APPROVAL_MODE:"membership_approval_mode",MEMBERSHIP_APPROVAL_REQUEST:"membership_approval_request",CREATED_MEMBERSHIP_REQUESTS:"created_membership_requests",REVOKED_MEMBERSHIP_REQUESTS:"revoked_membership_requests",ALLOW_NON_ADMIN_SUB_GROUP_CREATION:"allow_non_admin_sub_group_creation",ALLOW_ADMIN_REPORTS:"allow_admin_reports",ADMIN_REPORT_RECIEVED:"admin_report_received",CREATED_SUBGROUP_SUGGESTION:"created_subgroup_suggestion",REVOKED_SUB_GROUP_SUGGESTIONS:"revoked_sub_group_suggestions",SUBGROUP_SUGGESTIONS_CHANGE_NUMBER:"subgroup_suggestions_change_number",MEMBER_ADD_MODE:"member_add_mode",GENERAL_CHAT_AUTO_ADD_DISABLED:"general_chat_auto_add_disabled",COMMUNITY_OWNER_UPDATE:"community_owner_update",HIDDEN_GROUP:"hidden_group"}),j=Object.freeze({INTEGRITY_DELETE_PARENT:"integrity_delete_parent",DELETE_PARENT:"delete_parent"}),k=Object.freeze({INVITE:"invite",LINKED_GROUP_JOIN:"linked_group_join",AUTO_ADD:"auto_add",DEFAULT_SUBGROUP_ADMIN_ADD:"default_subgroup_admin_add",DEFAULT_SUBGROUP_PROMOTE:"default_sub_group_promote",INVITE_AUTO_ADD:"invite_auto_add",GENERAL_CHAT_AUTO_ADD:"general_chat_auto_add"}),l=Object.freeze({DEFAULT_SUBGROUP_DEMOTE:"default_sub_group_demote"}),m=e({APPROVED:"approved",REJECTED:"rejected",CANCELLED:"cancelled"}),n=e.Mirrored(["DEFAULT","COMMUNITY","LINKED_SUBGROUP","LINKED_ANNOUNCEMENT_GROUP","LINKED_GENERAL_GROUP"]);function a(a){if(a.defaultSubgroup===!0)return n.LINKED_ANNOUNCEMENT_GROUP;if(a.generalSubgroup===!0)return n.LINKED_GENERAL_GROUP;if(a.parentGroup!=null)return n.LINKED_SUBGROUP;return a.isParentGroup===!0?n.COMMUNITY:n.DEFAULT}function c(a){switch(a){case n.LINKED_ANNOUNCEMENT_GROUP:return d("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM.DEFAULT_SUBGROUP;case n.LINKED_SUBGROUP:return d("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM.SUBGROUP;default:return d("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM.GROUP}}g.GroupSettingChangeSystemMessageToggleEnabled=f;g.GroupSettingChangeSystemMessageIsAdmin=b;g.GeneralChatAutoAddDisabledReasonEnum=h;g.GROUP_ACTIONS=i;g.DELETE_REASON=j;g.ADD_REASON=k;g.REMOVE_REASON=l;g.RevokedSubGroupSuggestionReason=m;g.GroupType=n;g.getGroupTypeFromGroupMetadata=a;g.groupTypeToWamEnum=c}),98);
__d("WAWebDBParticipantTypes",[],(function(a,b,c,d,e,f,g){a=Object.freeze({ADD:"add",REMOVE:"remove",DEMOTE:"demote",PROMOTE:"promote",LINKED_GROUP_PROMOTE:"linked_group_promote",LINKED_GROUP_DEMOTE:"linked_group_demote"});b=Object.freeze({DEVICE:"device",PARTICIPANT:"participant"});c=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="GroupUnSyncedError",b)||babelHelpers.assertThisInitialized(c)}return b}(babelHelpers.wrapNativeSuper(Error));g.PARTICIPANT_OPERATION=a;g.STALE_TYPES=b;g.GroupUnSyncedError=c}),98);
__d("WAWebLeaveReasonType",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["Left","Removed"]);f.LeaveReason=a}),66);
__d("WAWebPnhCagIncognito",["WAWebLidMigrationUtils","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){var b=a.participants.iAmAdmin();a=a.participants.toArray();var c=[],e=[];if(b)for(var b=a,f=Array.isArray(b),g=0,b=f?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=b.length)break;h=b[g++]}else{g=b.next();if(g.done)break;h=g.value}h=h;c.push(h.id);e.push(d("WAWebLidMigrationUtils").toLid(d("WAWebWidFactory").toUserWid(h.id)))}else for(h=a,g=Array.isArray(h),f=0,h=g?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(g){if(f>=h.length)break;b=h[f++]}else{f=h.next();if(f.done)break;b=f.value}a=b;a.id.isLid()?c.push(a.id):e.push(d("WAWebLidMigrationUtils").toLid(d("WAWebWidFactory").toUserWid(a.id)))}return[].concat(c,e).filter(Boolean)}function b(a,b){var c=[];if(a){for(a=0;a<b.length;a++){var d=b[a];c.push(d.id);d.lid&&c.push(d.lid)}return c}for(d=0;d<b.length;d++){a=b[d];a.id.isLid()?c.push(a.id):a.lid&&c.push(a.lid)}return c}g.augmentedCagGroupMetadataParticipantList=a;g.augmentedCagGroupParticipantList=b}),98);
__d("WAWebWamEnumMessageChatType",[],(function(a,b,c,d,e,f){a=Object.freeze({OTHER:0,INDIVIDUAL:1,GROUP:2,STATUS:3,BROADCAST:4,CHANNEL:5});f.MESSAGE_CHAT_TYPE=a}),66);
__d("WAWebGetMessageChatTypeFromWid",["WAWebWamEnumMessageChatType"],(function(a,b,c,d,e,f,g){function a(a){if(a.isUser())return d("WAWebWamEnumMessageChatType").MESSAGE_CHAT_TYPE.INDIVIDUAL;if(a.isGroup())return d("WAWebWamEnumMessageChatType").MESSAGE_CHAT_TYPE.GROUP;if(a.isBroadcast())return d("WAWebWamEnumMessageChatType").MESSAGE_CHAT_TYPE.BROADCAST;if(a.isStatus())return d("WAWebWamEnumMessageChatType").MESSAGE_CHAT_TYPE.STATUS;return a.isNewsletter()?d("WAWebWamEnumMessageChatType").MESSAGE_CHAT_TYPE.CHANNEL:d("WAWebWamEnumMessageChatType").MESSAGE_CHAT_TYPE.OTHER}g.getMessageChatTypeFromWid=a}),98);
__d("WAWebWamEnumExpiryReason",[],(function(a,b,c,d,e,f){a=Object.freeze({USER_LEAVE:1,DEVICE_UNPAIR:2,IDENTITY_CHANGE:3,AUDIENCE_CHANGE:4,PERIODIC_ROTATION:5,KEY_CORRUPTION:6,PEER_COMPANION_UNPAIR:7,OTHER_DEVICE_UNPAIR:8});f.EXPIRY_REASON=a}),66);
__d("WAWebWamEnumSizeBucket",[],(function(a,b,c,d,e,f){a=Object.freeze({LT32:1,LT64:2,LT128:3,LT256:4,LT512:5,LT1000:6,LT1024:16,LT1500:7,LT2000:8,LT2500:9,LT3000:10,LT3500:11,LT4000:12,LT4500:13,LT5000:14,LARGEST_BUCKET:15});f.SIZE_BUCKET=a}),66);
__d("WAWebSenderKeyExpiredWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumExpiryReason","WAWebWamEnumMessageChatType","WAWebWamEnumSizeBucket"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({SenderKeyExpired:[3130,{chatType:[1,d("WAWebWamEnumMessageChatType").MESSAGE_CHAT_TYPE],deviceSizeBucket:[2,d("WAWebWamEnumSizeBucket").SIZE_BUCKET],expiryReason:[3,d("WAWebWamEnumExpiryReason").EXPIRY_REASON]},[1,1,1],"regular"]},{SenderKeyExpired:[]});g.SenderKeyExpiredWamEvent=a}),98);
__d("WAWebWamNumberToSizeBucket",["WAWebWamEnumSizeBucket"],(function(a,b,c,d,e,f,g){function a(a){if(a<32)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT32;if(a<64)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT64;if(a<128)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT128;if(a<256)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT256;if(a<512)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT512;if(a<1024)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT1024;if(a<1500)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT1500;if(a<2e3)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT2000;if(a<2500)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT2500;if(a<3e3)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT3000;if(a<3500)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT3500;if(a<4e3)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT4000;if(a<4500)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT4500;return a<5e3?d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT5000:d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LARGEST_BUCKET}g["default"]=a}),98);
__d("WAWebPostSenderKeyExpiredMetric",["WAWebGetMessageChatTypeFromWid","WAWebSenderKeyExpiredWamEvent","WAWebWamNumberToSizeBucket","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){var b=a.chatId,e=a.expiryReason;a=a.deviceCount;var f=new(d("WAWebSenderKeyExpiredWamEvent").SenderKeyExpiredWamEvent)();e!=null&&(f.expiryReason=e);if(b!=null){e=d("WAWebWidFactory").createWidFromWidLike(b);f.chatType=d("WAWebGetMessageChatTypeFromWid").getMessageChatTypeFromWid(e)}a!=null&&a>0&&(f.deviceSizeBucket=c("WAWebWamNumberToSizeBucket")(a));f.commit()}g.postSenderKeyExpiredMetric=a}),98);
__d("WAWebWamGroupMetricUtils",["WAWebWamNumberToSizeBucket"],(function(a,b,c,d,e,f,g){function h(a){return Math.max(a,32)}function a(a){var b=Object.freeze({}),c=a.participants.length;c!=null&&(b=babelHelpers["extends"]({participantCount:h(c)},b));c=a.cachedDeviceCount;c!=null&&(b=babelHelpers["extends"]({deviceCount:h(c)},b));return b}function b(a){return{participantCount:h(a.participants.length),deviceCount:h(a.senderKey.size),deviceSizeBucket:c("WAWebWamNumberToSizeBucket")(a.senderKey.size)}}g.capCount=h;g.getGroupCountMetricsFromGroupMetadata=a;g.getGroupMetricsFromDbRecord=b}),98);
__d("WAWebWamGroupMetricCache",["Promise","WALogger","WAWebSchemaParticipant","WAWebWamGroupMetricUtils"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["_getGroupMetricsFromDb: failed to get for ",": ",""]);i=function(){return a};return a}var j=new Map();function a(a){if(!a.isGroup())return(h||(h=b("Promise"))).resolve(null);a=a.toString();j.has(a)||j.set(a,k(a));return j.get(a)||(h||(h=b("Promise"))).resolve(null)}function k(a){return d("WAWebSchemaParticipant").getParticipantTable().get(a).then(function(a){return a&&d("WAWebWamGroupMetricUtils").getGroupMetricsFromDbRecord(a)})["catch"](function(b){d("WALogger").WARN(i(),a,b)})}function c(a){if(a.participants==null||a.senderKey==null)return;j.set(a.groupId,(h||(h=b("Promise"))).resolve(d("WAWebWamGroupMetricUtils").getGroupMetricsFromDbRecord(a)))}g.getGroupMetrics=a;g.cacheGroupMetrics=c}),98);
__d("WAWebDBGroupParticipant",["$InternalEnum","Promise","WABatcher","WAJids","WALogger","WANullthrows","WAWebDBParticipantTypes","WAWebGroupType","WAWebLeaveReasonType","WAWebLidMigrationUtils","WAWebModelStorageUtils","WAWebPnhCagIncognito","WAWebPostSenderKeyExpiredMetric","WAWebSchemaParticipant","WAWebUserPrefsMeUser","WAWebWamEnumExpiryReason","WAWebWamGroupMetricCache","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["addressing mode migration failed for ",": ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateCommunityParticipantsBatched: failed with unknown action ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateCommunityParticipantsBatched: no local record found for group ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateCommunityParticipantsBatched: aggregating "," changes"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateParticipants: failed with unknown action ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateParticipantsBatched: no local record found for group ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateParticipantsBatched: aggregating "," changes"]);o=function(){return a};return a}var p=3e3;function a(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.groupInfos;var b=(yield d("WAWebSchemaParticipant").getParticipantTable().bulkGet(a.map(function(a){return a.id.toString()}))),c=new Map();b.forEach(function(a){return a&&c.set(a.groupId,a.senderKey)});b=a.map(function(a){var b,e=[],f=[],g=[],h=a.id.toString(),i=c.get(h)||new Map();(b=a.participants)==null?void 0:b.forEach(function(a){a.isAdmin&&f.push(a.id),a.isSuperAdmin&&g.push(a.id),e.push(a.id)});b=(b=(b=a.pastParticipants)==null?void 0:b.map(function(a){var b=a.id,c=a.leaveTs;a=a.leaveReason;return{jid:b.toString(),leaveTs:c,leaveReason:a}}))!=null?b:[];var j=Boolean(a.incognito)&&Boolean(a.defaultSubgroup);if(j){j=f.some(function(a){return d("WAWebUserPrefsMeUser").isMeAccount(a)});j=d("WAWebPnhCagIncognito").augmentedCagGroupParticipantList(j,a.participants);j.forEach(function(a){a=String(a);i.has(a)||i.set(a,!1)})}else{(j=a.participants)==null?void 0:j.forEach(function(a){i.set(String(a.id),!1)})}return{groupId:h,participants:e.map(String),pastParticipants:b,admins:f.map(String),superAdmins:g.map(String),senderKey:i,rotateKey:!1,staleType:d("WAWebDBParticipantTypes").STALE_TYPES.DEVICE}});return d("WAWebSchemaParticipant").getParticipantTable().bulkCreateOrReplace(b)});return q.apply(this,arguments)}function e(a){var c=a.group,e=a.participants,f=a.admins,g=a.superAdmins,h=a.deviceIds;a=a.groupInfo;var i=!1;a!=null&&(i=Boolean(a.incognito)&&Boolean(a.defaultSubgroup));var j=c.toString();return d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.get(j));if(!b)return a.create(E(j,{participants:e,admins:f,superAdmins:g,deviceIds:h}));yield a.createOrReplace(i?K(b,{participants:e,admins:f,superAdmins:g,deviceIds:h}):F(b,{participants:e,admins:f,superAdmins:g,deviceIds:h}))});return function(b){return a.apply(this,arguments)}}())}function f(a){return d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var c=(yield b.bulkGet(a.map(function(a){return a.groupId}))),d=a.map(function(a,b){var d=a.groupId;a=a.pastParticipants;b=c[b];return!b?E(d,{pastParticipants:a}):y(b,a)});return b.bulkCreateOrReplace(d)});return function(a){return c.apply(this,arguments)}}())}var r=function(){return d("WABatcher").batch({delayMs:p},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").DEV(o(),a.length).devConsole(a);var c=Array.from(new Set(a.map(function(a){return a.id})));yield d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var e=new Map((yield b.bulkGet(c)).filter(Boolean).map(function(a){return[a.groupId,a]}));a.forEach(function(a){var b=a.id,c=a.data;a=a.groupMetadata;a=Boolean(a==null?void 0:a.defaultSubgroup);var f=e.get(b);if(!f){d("WALogger").LOG(n(),b);return}b=c.participants;var g=null;switch(c.action){case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.ADD:g=a?x(f,b,c.deviceIds):w(f,b,c.deviceIds);break;case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.REMOVE:g=a?A(f,b,c.timestamp,c.author,c.reason):z(f,b,c.timestamp,c.author,c.reason);break;case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.DEMOTE:g=a?C(f,b,c.deviceIds,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.DEMOTE):B(f,b,c.deviceIds,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.DEMOTE);break;case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.PROMOTE:g=a?C(f,b,c.deviceIds,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.PROMOTE):B(f,b,c.deviceIds,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.PROMOTE);break;default:d("WALogger").LOG(m(),c.action)}g!=null&&e.set(g.groupId,g)});return b.bulkCreateOrReplace(Array.from(e.values()))});return function(a){return e.apply(this,arguments)}}());return a.map(function(a){return void 0})});return function(b){return a.apply(this,arguments)}}())}(),s=function(){return d("WABatcher").batch({delayMs:p},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").DEV(l(),a.length).devConsole(a);var c=Array.from(new Set(a.map(function(a){return a.id})));yield d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var e=new Map((yield b.bulkGet(c)).filter(Boolean).map(function(a){return[a.groupId,a]}));a.forEach(function(a){var b=a.id;a=a.data;var c=e.get(b);if(!c){d("WALogger").LOG(k(),b);return}b=a.participants;var f=null;switch(a.action){case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_PROMOTE:f=D(c,b,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_PROMOTE);break;case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_DEMOTE:f=D(c,b,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_DEMOTE);break;default:d("WALogger").LOG(j(),a.action)}f!=null&&e.set(f.groupId,f)});return b.bulkCreateOrReplace(Array.from(e.values()))});return function(a){return e.apply(this,arguments)}}());return a.map(function(a){return void 0})});return function(b){return a.apply(this,arguments)}}())}();function t(a,e,f){f===void 0&&(f=!1);if(f)return s({id:String(a),data:e});var g=e.participants,h=a.toString();return d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.get(h));if(!b)throw new(d("WAWebDBParticipantTypes").GroupUnSyncedError)("updateCommunityParticipants: group participant info missing for action "+e.action);switch(e.action){case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_PROMOTE:return a.createOrReplace(D(b,g,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_PROMOTE));case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_DEMOTE:return a.createOrReplace(D(b,g,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_DEMOTE));default:throw c("err")("updateCommunityParticipants: failed with unknown action "+e.action)}});return function(b){return a.apply(this,arguments)}}())}function u(a,c){return d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var e=(yield b.get(a.toString()));if(!e)throw new(d("WAWebDBParticipantTypes").GroupUnSyncedError)("updateParticipants: group participant info missing when trying to update super admin");return b.createOrReplace(babelHelpers["extends"]({},e,{superAdmins:[c.toString()]}))});return function(a){return e.apply(this,arguments)}}())}function v(a,e,f,g){g===void 0&&(g=!1);var h=Boolean(f==null?void 0:f.defaultSubgroup);if(g)return r({id:String(a),data:e,groupMetadata:f});var i=e.participants,j=a.toString();return d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.get(j));if(!b)throw new(d("WAWebDBParticipantTypes").GroupUnSyncedError)("updateParticipants: group participant info missing for action "+e.action);switch(e.action){case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.ADD:return a.createOrReplace(h?x(b,i,e.deviceIds):w(b,i,e.deviceIds));case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.REMOVE:return a.createOrReplace(h?A(b,i,e.timestamp,e.author,e.reason):z(b,i,e.timestamp,e.author,e.reason));case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.DEMOTE:return a.createOrReplace(h?C(b,i,e.deviceIds,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.DEMOTE):B(b,i,e.deviceIds,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.DEMOTE));case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.PROMOTE:return a.createOrReplace(h?C(b,i,e.deviceIds,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.PROMOTE):B(b,i,e.deviceIds,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.PROMOTE));default:throw c("err")("updateParticipants: failed with unknown action "+e.action)}});return function(b){return a.apply(this,arguments)}}())}function w(a,b,c){var e=new Map(a.senderKey);c.forEach(function(a){if(d("WAWebUserPrefsMeUser").isMeDevice(a))return;if(a.isHosted())return;a=String(a);e.set(a,!1)});var f=new Set();for(c of b){b=c.id;f.add(String(b))}b=(c=(b=a.pastParticipants)==null?void 0:b.filter(function(a){return!f.has(a.jid)}))!=null?c:[];c=a.participants;for(var g of f.values())c.push(g);return{groupId:a.groupId,senderKey:e,participants:c,pastParticipants:b,admins:a.admins,superAdmins:a.superAdmins,rotateKey:a.rotateKey,staleType:a.staleType}}function x(a,b,c){var e=new Map(a.senderKey);c.forEach(function(a){if(d("WAWebUserPrefsMeUser").isMeDevice(a))return;if(a.isHosted())return;a=String(a);e.set(a,!1)});var f=new Set(),g=new Set();for(c of b){b=c.id;var h=c.lid;g.add(String(b));h!=null&&!b.isLid()&&f.add(String(h))}c=(h=(b=a.pastParticipants)==null?void 0:b.filter(function(a){return!g.has(a.jid)}))!=null?h:[];b=a.participants.filter(function(a){return!f.has(a)});for(h of g.values())b.push(h);return{groupId:a.groupId,senderKey:e,participants:b,pastParticipants:c,admins:a.admins,superAdmins:a.superAdmins,rotateKey:a.rotateKey,staleType:a.staleType}}function y(a,b){return{groupId:a.groupId,senderKey:a.senderKey,participants:a.participants,pastParticipants:b.map(function(a){var b=a.id,c=a.leaveReason;a=a.leaveTs;return{jid:b.toString(),leaveTs:a,leaveReason:c}}),admins:a.admins,superAdmins:a.superAdmins,rotateKey:a.rotateKey,staleType:a.staleType}}function z(a,b,c,e,f){var g,h=new Map(a.senderKey),i=a.rotateKey;h.forEach(function(a,c){var e=d("WAWebWidFactory").createWid(c),f=b.some(function(a){return a.id.isSameAccount(e)});f&&(i=i||a,h["delete"](c))});i&&h.forEach(function(a,b){h.set(b,!1)});var j=b.map(function(a){a=a.id;return String(a)});f=(f=a.pastParticipants)==null?void 0:f.concat((f=b.map(function(a){return{jid:a.id.toString(),leaveTs:c,leaveReason:a.id.equals(e)?d("WAWebLeaveReasonType").LeaveReason.Left:d("WAWebLeaveReasonType").LeaveReason.Removed}}))!=null?f:[]);!a.rotateKey&&i&&d("WAWebPostSenderKeyExpiredMetric").postSenderKeyExpiredMetric({chatId:a.groupId,deviceCount:a.senderKey.size,expiryReason:d("WAWebWamEnumExpiryReason").EXPIRY_REASON.USER_LEAVE});var k=a.admins.filter(function(a){return!j.includes(a)});g=(g=a.superAdmins)==null?void 0:g.filter(function(a){return!j.includes(a)});var l=a.participants.filter(function(a){return!j.includes(a)});return{groupId:a.groupId,senderKey:h,participants:l,pastParticipants:f,admins:k,superAdmins:g,rotateKey:i,staleType:a.staleType}}function A(a,b,c,e,f){var g,h,i=new Map(a.senderKey),j=a.rotateKey,k=b.map(function(a){return a.id.isLid()?a.id:a.lid}).filter(Boolean);i.forEach(function(a,c){var e=d("WAWebWidFactory").createWid(c);if(e.isLid()&&f!==d("WAWebGroupType").REMOVE_REASON.DEFAULT_SUBGROUP_DEMOTE){var g=k.some(function(a){return a.isSameAccount(e)});g&&i["delete"](c);return}if(!e.isLid()&&f===d("WAWebGroupType").REMOVE_REASON.DEFAULT_SUBGROUP_DEMOTE){i["delete"](c);return}g=b.some(function(a){return a.id.user===e.user&&a.id.server===e.server});g&&(j=j||a,i["delete"](c))});j&&i.forEach(function(a,b){a=d("WAWebWidFactory").createWid(b);a.isLid()||i.set(b,!1)});var l=b.map(function(a){a=a.id;return String(a)});g=(g=a.pastParticipants)==null?void 0:g.concat((g=b.map(function(a){return{jid:a.id.toString(),leaveTs:c,leaveReason:a.id.equals(e)?d("WAWebLeaveReasonType").LeaveReason.Left:d("WAWebLeaveReasonType").LeaveReason.Removed}}))!=null?g:[]);!a.rotateKey&&j&&d("WAWebPostSenderKeyExpiredMetric").postSenderKeyExpiredMetric({chatId:a.groupId,deviceCount:a.senderKey.size,expiryReason:d("WAWebWamEnumExpiryReason").EXPIRY_REASON.USER_LEAVE});var m=a.admins.filter(function(a){return!l.includes(a)});h=(h=a.superAdmins)==null?void 0:h.filter(function(a){return!l.includes(a)});var n=a.participants;if(f===d("WAWebGroupType").REMOVE_REASON.DEFAULT_SUBGROUP_DEMOTE){var o=b.reduce(function(a,b){var c=b.lid;b=b.id;return c==null||b.isLid()?a:a.set(b.toString(),c.toString())},new Map());n=n.map(function(a){var b;return(b=o.get(a))!=null?b:a})}else n=n.filter(function(a){return!l.includes(a)});return{groupId:a.groupId,senderKey:i,participants:n,pastParticipants:g,admins:m,superAdmins:h,rotateKey:j,staleType:a.staleType}}function B(a,b,c,e){c=a.admins;var f=b.map(function(a){a=a.id;return String(a)});if(e===d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.DEMOTE)c=a.admins.filter(function(a){return!f.includes(a)});else if(e===d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.PROMOTE){var g=new Set(a.admins);f.forEach(function(a){return g.add(a)});c=Array.from(g)}return{groupId:a.groupId,senderKey:a.senderKey,participants:a.participants,pastParticipants:a.pastParticipants,admins:c,superAdmins:a.superAdmins,rotateKey:a.rotateKey,staleType:a.staleType}}function C(a,b,c,e){var f=a.admins,g=b.map(function(a){a=a.id;return String(a)}),h=new Map(a.senderKey);c!=null&&c.length>0&&c.forEach(function(a){if(d("WAWebUserPrefsMeUser").isMeDevice(a))return;if(a.isHosted())return;a=String(a);h.set(a,!1)});c=a.participants;if(e===d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.DEMOTE){f=a.admins.filter(function(a){return!g.includes(a)});var i=f.some(function(a){return d("WAWebUserPrefsMeUser").isMeAccount(d("WAWebWidFactory").createWid(a))});if(!i){var j=b.reduce(function(a,b){var c=b.lid;b=b.id;return c==null||b.isLid()?a:a.set(b.toString(),c.toString())},new Map());c=c.map(function(a){var b;return(b=j.get(a))!=null?b:a})}}else if(e===d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.PROMOTE){var k=b.reduce(function(a,b){var c=b.lid;b=b.id;return c==null||b.isLid()?a:a.set(c.toString(),b.toString())},new Map());f=a.admins.concat(g);c=c.map(function(a){var b;return(b=k.get(a))!=null?b:a})}return{groupId:a.groupId,senderKey:h,participants:c,pastParticipants:a.pastParticipants,admins:f,superAdmins:a.superAdmins,rotateKey:a.rotateKey,staleType:a.staleType}}function D(a,b,c){var e=a.admins,f=a.participants,g=b.map(function(a){a=a.id;return String(a)});if(c===d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_DEMOTE)e=a.admins.filter(function(a){return!g.includes(a)}),f=e;else if(c===d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_PROMOTE){b=g.filter(function(b){return!a.admins.includes(b)});e=a.admins.concat(b);f=e}return{groupId:a.groupId,senderKey:a.senderKey,participants:f,pastParticipants:a.pastParticipants,admins:e,superAdmins:a.superAdmins,rotateKey:a.rotateKey,staleType:a.staleType}}function E(a,b){var c=b.participants;c=c===void 0?[]:c;var e=b.pastParticipants;e=e===void 0?[]:e;var f=b.admins;f=f===void 0?[]:f;var g=b.deviceIds;g=g===void 0?[]:g;var h=new Map();g.forEach(function(a){if(d("WAWebUserPrefsMeUser").isMeDevice(a))return;if(a.isHosted())return;a=String(a);h.has(a)||h.set(a,!1)});return{groupId:a,senderKey:h,participants:c.map(function(a){a=a.id;return String(a)}),pastParticipants:e.map(function(a){var b=a.id,c=a.leaveReason;a=a.leaveTs;return{jid:b.toString(),leaveTs:a,leaveReason:c}}),admins:f.map(String),superAdmins:(g=b.superAdmins)==null?void 0:g.map(String),rotateKey:!1,staleType:c.length===0?d("WAWebDBParticipantTypes").STALE_TYPES.PARTICIPANT:void 0}}function F(a,b){var c=b.participants,e=b.admins,f=b.superAdmins;b=b.deviceIds;var g=a.rotateKey,h=a.senderKey,i=new Map();b.forEach(function(a){if(d("WAWebUserPrefsMeUser").isMeDevice(a))return;if(a.isHosted())return;a=String(a);var b=h.get(a);b==null?i.set(a,!1):(i.set(a,b),h["delete"](a))});for(b of h.values())g=g||b;return{groupId:a.groupId,senderKey:i,participants:c.map(function(a){a=a.id;return String(a)}),pastParticipants:a.pastParticipants,admins:e.map(String),superAdmins:f==null?void 0:f.map(String),rotateKey:g}}var G=b("$InternalEnum").Mirrored(["Success","Error"]);function H(a,b){return I.apply(this,arguments)}function I(){I=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=G.Error;yield d("WAWebModelStorageUtils").getStorage().lock(["participant","group-metadata"],function(){var g=b("asyncToGeneratorRuntime").asyncToGenerator(function*(g){var j=g[0];g=g[1];var k=e?d("WAWebLidMigrationUtils").toLid:d("WAWebLidMigrationUtils").toPn;try{var l=c("WANullthrows")(yield j.get(a.toString()),"missing participant record to migrate"),m=Array.from(l.senderKey.entries());l={admins:l.admins.map(function(a){return c("WANullthrows")(k(d("WAWebWidFactory").createWid(a)),"admin missing a LID-PN mapping").toString()}),participants:l.participants.map(function(a){return c("WANullthrows")(k(d("WAWebWidFactory").createWid(a)),"participant missing a LID-PN mapping").toString()}),senderKey:new Map(m.map(function(a){var b=a[0];a[1];return[J(b,k).toString(),!1]}))};m={isLidAddressingMode:e};yield (h||(h=b("Promise"))).all([j.merge(a.toString(),l),g.merge(a.toString(),m)]);f=G.Success}catch(b){d("WALogger").ERROR(i(),a,b.message)}});return function(a){return g.apply(this,arguments)}}());return f});return I.apply(this,arguments)}function J(a,b){a=d("WAWebWidFactory").createDeviceWid(a);b=c("WANullthrows")(b(d("WAWebWidFactory").toUserWid(a)),"senderkey device missing a LID-PN mapping");return d("WAWebWidFactory").createDeviceWidFromUserAndDevice(b.user,b.server,(b=a.device)!=null?b:d("WAJids").DEFAULT_DEVICE_ID).toString()}function K(a,b){var c=b.participants,e=b.admins,f=b.superAdmins;b=b.deviceIds;var g=a.rotateKey,h=a.senderKey,i=new Map();b.forEach(function(a){if(d("WAWebUserPrefsMeUser").isMeDevice(a))return;if(a.isHosted())return;a=String(a);var b=h.get(a);b==null?i.set(a,!1):(i.set(a,b),h["delete"](a))});for(b of h.entries()){var j=b[0],k=b[1];if(k&&!d("WAWebWidFactory").createWid(j).isLid()){g=!0;break}}return{groupId:a.groupId,senderKey:i,participants:c.map(function(a){a=a.id;return String(a)}),pastParticipants:a.pastParticipants,admins:e.map(String),superAdmins:f==null?void 0:f.map(String),rotateKey:g}}function L(a){var b=a.group;return d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(a){a=a[0];return a.merge(String(b),{staleType:d("WAWebDBParticipantTypes").STALE_TYPES.PARTICIPANT})})}function M(a){var b=a.groupIds;return d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(a){a=a[0];return a.bulkCreateOrMerge(b.map(function(a){return{groupId:String(a),staleType:d("WAWebDBParticipantTypes").STALE_TYPES.PARTICIPANT}}))})}function N(a){var c=a.group,e=a.oldId,f=a.newId,g=String(c);return d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.get(g));if(!b)throw new(d("WAWebDBParticipantTypes").GroupUnSyncedError)("modifyGroupParticipant: group participant info missing");return a.createOrReplace(O(b,e,f))});return function(b){return a.apply(this,arguments)}}())}function O(a,b,c){var e,f=String(b),g=String(c),h=new Map(a.senderKey);c=a.participants.filter(function(a){return a!==f}).concat(g);Array.from(h.keys()).forEach(function(a){var c=d("WAWebWidFactory").createWid(a).user;b.user===c?h["delete"](a):h.set(a,!1)});h.set(g,!1);var i=a.admins.map(function(a){return a===f?g:a});e=(e=a.superAdmins)==null?void 0:e.map(function(a){return a===f?g:a});return babelHelpers["extends"]({},a,{participants:c,senderKey:h,admins:i,superAdmins:e,rotateKey:!0})}function P(a){return Q.apply(this,arguments)}function Q(){Q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,c;a=a.groupWid;a=(yield d("WAWebSchemaParticipant").getParticipantTable().get(String(a)));if(!a)return null;var e=new Set(a.admins),f=new Set(a.superAdmins);b=(b=(b=a.participants)==null?void 0:b.map(function(a){return{id:d("WAWebWidFactory").createWid(a),isAdmin:e.has(a),isSuperAdmin:f.has(a)}}))!=null?b:[];c=(c=(c=a.pastParticipants)==null?void 0:c.map(function(a){var b=a.jid,c=a.leaveTs;a=a.leaveReason;return{id:d("WAWebWidFactory").createWid(b),leaveTs:c,leaveReason:a}}))!=null?c:[];d("WAWebWamGroupMetricCache").cacheGroupMetrics(a);var g=a.deviceSyncComplete!=null&&!a.deviceSyncComplete?d("WAWebDBParticipantTypes").STALE_TYPES.PARTICIPANT:void 0;return{participants:b,pastParticipants:c,staleType:(b=a.staleType)!=null?b:g,deviceCount:a.senderKey.size}});return Q.apply(this,arguments)}g.updateGroupParticipantTableWithoutDeviceSync=a;g.replaceParticipants=e;g.addPastParticipants=f;g.updateCommunityParticipants=t;g.setDBGroupSuperAdmin=u;g.updateDBParticipants=v;g.addParticipantInfo=w;g.addParticipantInfoIncognitoCag=x;g.removeParticipantInfo=z;g.removeParticipantInfoIncognitoCag=A;g.createParticipantInfo=E;g.replaceParticipantInfo=F;g.AddressingModeMigrationResult=G;g.migrateParticipantInfoAddressingMode=H;g.replaceParticipantInfoIncognitoCag=K;g.markGroupParticipantStale=L;g.bulkMarkGroupParticipantStale=M;g.modifyGroupParticipant=N;g.getGroupParticipant=P}),98);
__d("WAWebWamEnumMismatchOriginType",[],(function(a,b,c,d,e,f){a=Object.freeze({INCOMING_GROUP_MESSAGE:1,ACK_OUTGOING_MESSAGE:2,GROUP_NOTIFICATION:3,GROUP_PROFILE_PICTURE_NOTIFICATION:4,IQ_RESPONSES:5});f.MISMATCH_ORIGIN_TYPE=a}),66);
__d("WAWebGroupQueryBridgeOneAlreadyInFlightLogger",["WALogger","WAWebABProps","WAWebWamEnumMismatchOriginType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["lid_migration - ",""]);h=function(){return a};return a}var i=Object.fromEntries(Object.entries(d("WAWebWamEnumMismatchOriginType").MISMATCH_ORIGIN_TYPE).map(function(a){var b=a[0];a=a[1];return[a,b]})),j=function(){function a(){this.$1=new Map()}var b=a.prototype;b.$2=function(a){return(a=this.$1.get(a))!=null?a:0};b.increment=function(a){a=a.toString();var b=this.$2(a)+1;this.$1.set(a,b);return b};b.decrement=function(a){a=a.toString();this.$1.set(a,Math.max(this.$2(a)-1,0))};return a}();function a(a){var c=new j();return function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,e){if(!d("WAWebABProps").getABPropConfigValue("web_extra_lid_group_logging_attributes"))return a(b);c.increment(b)>1&&d("WALogger").ERROR(h(),i[e]).sendLogs("GroupLidInfra/one_in_flight_group_info_mismatch");try{e=(yield a(b));c.decrement(b);return e}catch(a){c.decrement(b);throw a}});function f(a,b){return e.apply(this,arguments)}return f}()}g.logDuplicateRequestsWrapper=a}),98);
__d("WAWebHandleMsgCommon",["WACustomError"],(function(a,b,c,d,e,f,g){a={text:"text",media:"media",pay:"pay",poll:"poll",reaction:"reaction",event:"event"};b={ctwa:"ctwa",username:"username"};c={pn:"pn",lid:"lid"};e={creation:"creation",vote:"vote"};f={creation:"creation",response:"response",edit:"edit"};var h={high:"high",low:"low",unknown:"unknown"},i="peer";d=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(d("WACustomError").customError("HSMMismatchError"));var j={send:"send",request:"request",futureproof:"futureproof","request-decline":"request-decline","request-cancel":"request-cancel",invite:"invite"},k="biz_source",l={"default":"default"};g.STANZA_MSG_TYPES=a;g.STANZA_MSG_ORIGIN=b;g.STANZA_MSG_ADDRESSING_MODE=c;g.POLL_TYPES=e;g.EVENT_TYPES=f;g.MSG_VERIFIED_LEVEL=h;g.CATEGORY_PEER=i;g.HsmMismatchError=d;g.PAY_NODE_TYPES=j;g.BIZ_SOURCE_ATTR=k;g.APPDATA=l}),98);
__d("WAWebWamEnumAddressingMode",[],(function(a,b,c,d,e,f){a=Object.freeze({PN:1,LID:2});f.ADDRESSING_MODE=a}),66);
__d("WAWebWamEnumIqResponseType",[],(function(a,b,c,d,e,f){a=Object.freeze({ADD_PARTICIPANT:1,REMOVE_PARTICIPANT:2,PROMOTE_PARTICIPANT:3,DEMOTE_PARTICIPANT:4});f.IQ_RESPONSE_TYPE=a}),66);
__d("WAWebAddressingModeMismatchWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumAddressingMode","WAWebWamEnumIqResponseType","WAWebWamEnumMismatchOriginType"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({AddressingModeMismatch:[4750,{iqResponse:[1,d("WAWebWamEnumIqResponseType").IQ_RESPONSE_TYPE],localAddressingMode:[2,d("WAWebWamEnumAddressingMode").ADDRESSING_MODE],mismatchOrigin:[6,d("WAWebWamEnumMismatchOriginType").MISMATCH_ORIGIN_TYPE],notificationTag:[3,d("WAWebWamCodegenUtils").TYPES.STRING],serverAddressingMode:[5,d("WAWebWamEnumAddressingMode").ADDRESSING_MODE]},[1,1,1],"regular"]},{AddressingModeMismatch:[]});g.AddressingModeMismatchWamEvent=a}),98);
__d("WAWebWamAddressingModeUtils",["WAWebABProps","WAWebHandleMsgCommon","WAWebWamEnumAddressingMode"],(function(a,b,c,d,e,f,g){"use strict";function h(a){switch(a){case!0:return d("WAWebWamEnumAddressingMode").ADDRESSING_MODE.LID;case!1:return d("WAWebWamEnumAddressingMode").ADDRESSING_MODE.PN}}function a(a){return a===d("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.lid?d("WAWebWamEnumAddressingMode").ADDRESSING_MODE.LID:d("WAWebWamEnumAddressingMode").ADDRESSING_MODE.PN}function b(a){if(!d("WAWebABProps").getABPropConfigValue("web_extra_lid_group_logging_attributes"))return{};return a.isLidAddressingMode==null?{}:{localAddressingMode:h(a.isLidAddressingMode)}}g.getWamAddressingModeFromString=a;g.getAddressingModeMetricsFromGroupMetadata=b}),98);
__d("WAWebWamAddressingModeMismatchReporter",["WAWebABProps","WAWebAddressingModeMismatchWamEvent","WAWebWamAddressingModeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(!d("WAWebABProps").getABPropConfigValue("web_extra_lid_group_logging_attributes"))return;new(d("WAWebAddressingModeMismatchWamEvent").AddressingModeMismatchWamEvent)(babelHelpers["extends"]({},a,{localAddressingMode:d("WAWebWamAddressingModeUtils").getWamAddressingModeFromString(a.localAddressingMode),serverAddressingMode:d("WAWebWamAddressingModeUtils").getWamAddressingModeFromString(a.serverAddressingMode)})).commit()}g.logAddressingModeMismatch=a}),98);
__d("WAWebGroupHandleAddressingModeMismatch",["WALogger","WANullthrows","WAWebABProps","WAWebApiMembershipApprovalRequestStore","WAWebBackendApi","WAWebDBGroupParticipant","WAWebGroupQueryBridge","WAWebGroupQueryBridgeOneAlreadyInFlightLogger","WAWebHandleMsgCommon","WAWebLidMigrationUtils","WAWebModelStorageUtils","WAWebWamAddressingModeMismatchReporter","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unable to migrate pending approvals in "," with local data"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unable to migrate participants in "," with local data"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Migrating group "," to addressing mode ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[lid-migration] lid_groups_handle_server_addressing_mode = false, skipping migration of ",""]);k=function(){return a};return a}var l=d("WAWebGroupQueryBridgeOneAlreadyInFlightLogger").logDuplicateRequestsWrapper(d("WAWebGroupQueryBridge").sendQueryGroup);function a(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c===void 0&&(c={force:!1});var e=b.serverAddressingMode===d("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.lid;if(c.force===!1&&!d("WAWebABProps").getABPropConfigValue("lid_groups_handle_server_addressing_mode")){d("WALogger").LOG(k(),a.toString());return}d("WALogger").LOG(j(),a.toString(),b.serverAddressingMode);d("WAWebWamAddressingModeMismatchReporter").logAddressingModeMismatch(b);yield n(a,e,b);yield p(a,e)});return m.apply(this,arguments)}function n(a,b,c){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=(yield d("WAWebDBGroupParticipant").migrateParticipantInfoAddressingMode(a,b));if(e===d("WAWebDBGroupParticipant").AddressingModeMigrationResult.Success){e=(yield d("WAWebDBGroupParticipant").getGroupParticipant({groupWid:a}));d("WAWebBackendApi").frontendFireAndForget("updateGroupAddressingMode",{id:a,isLidAddressingMode:b,groupInfoUpdate:{participants:e==null?void 0:e.participants}})}else d("WALogger").LOG(i(),a.toString()),yield l(a,c.mismatchOrigin)});return o.apply(this,arguments)}function p(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=d("WAWebLidMigrationUtils").toAddressingModeFactory(e),g=(yield d("WAWebApiMembershipApprovalRequestStore").getMembershipApprovalRequests(a));if(g.length===0)return;try{var i=g.map(function(a){return babelHelpers["extends"]({},a,{id:c("WANullthrows")(f(a.id)),addedBy:c("WANullthrows")(f(a.addedBy))})});yield d("WAWebModelStorageUtils").getStorage().lock(["pending-membership-approval-request"],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebApiMembershipApprovalRequestStore").removeMembershipApprovalRequests(a,g.map(function(a){return a.id})),yield d("WAWebApiMembershipApprovalRequestStore").addMembershipApprovalRequests(a,i)}));d("WAWebBackendApi").frontendFireAndForget("removeMembershipApprovalRequests",{groupId:a,requestIds:g.map(function(a){return a.id})});d("WAWebBackendApi").frontendFireAndForget("addMembershipApprovalRequests",{groupId:a,requests:i})}catch(b){d("WALogger").LOG(h(),a.toString())}});return q.apply(this,arguments)}g.handleAddressingModeMismatch=a}),98);
__d("WAWebBackendErrors",["WACustomError","WALogger"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["",", error"]);h=function(){return a};return a}c=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){c=a.call(this,c)||this;c.status=b;c.statusCode=b;return c}return b}((b=d("WACustomError")).customError("ServerStatusCodeError"));e=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,d){d=a.call(this,d)||this;d.errors=c;d.status=b;d.statusCode=b;return d}return b}(b.customError("ServerStatusCodeError"));f=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.call(this,"CollectionReorderError")||this}return b}(b.customError("CollectionReorderError",!0,Error));var i=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.call(this,451,"commerce features disabled")||this}return a}(b.customError("E451",!0,c)),j=function(b){babelHelpers.inheritsLoose(a,b);function a(a){return b.call(this,404,a)||this}return a}(b.customError("E404",!0,c)),k=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c){a=b.call(this,507,a)||this;a.backoff=Number.isNaN(c)?null:c;return a}return a}(b.customError("E507",!0,c)),l=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}return a}(b.customError("Drop")),m=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}return a}(b.customError("LogoutDrop",!0,l));l=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b.customError("EphemeralDrop",!0,l));function a(a,b){return a["catch"](function(a){d("WALogger").ERROR(h(),b).verbose().devConsole(a).sendLogs(b);throw a})}var n=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c,d){d=b.call(this,d)||this;d.gid=a;d.membershipApprovalMode=c;return d}return a}(b.customError("UnexpectedJoinGroupViaInviteResponse")),o=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c){c=b.call(this,c)||this;c.membershipApprovalMode=a;return c}return a}(b.customError("UnexpectedJoinSubgroupResponse")),p=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c,d){d=b.call(this,d)||this;d.status=a;d.participantLimit=c;return d}return a}(b.customError("GroupAddParticipantCountRateLimitServerError"));b=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,d,e){e=a.call(this,e)||this;e.status=b;e.backoff=c;e.limitType=d;return e}return b}(b.customError("GroupAddParticipantTimeRateLimitServerError"));g.ServerStatusCodeError=c;g.CatalogEditServerError=e;g.CollectionReorderError=f;g.E451=i;g.E404=j;g.E507=k;g.LogoutDrop=m;g.EphemeralDrop=l;g.attachErrorLogger=a;g.UnexpectedJoinGroupViaInviteResponse=n;g.UnexpectedJoinSubgroupResponse=o;g.GroupAddParticipantCountRateLimitServerError=p;g.GroupAddParticipantTimeRateLimitServerError=b}),98);
__d("WAWebGroupQueryBridge",["WALogger","WATypeUtils","WAWebBackendApi","WAWebBackendErrors","WAWebGroupQueryGroupJob","WAWebGroupQueryJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Store:GroupMetadata Unexpected server response"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["querying server for groupMetadata of group id ",""]);i=function(){return a};return a}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(i(),a.toLogString()).tags("groups");var b=d("WAWebGroupQueryGroupJob").queryGroupJob(a);try{b=(yield b);if(b==null?void 0:b.id){var c;k(a,b.subject);l(a,(c=b.isLidAddressingMode)!=null?c:!1);return{id:b.id,owner:b.owner,creation:b.creation,subject:b.subject,desc:b.desc,descId:b.descId,descOwner:b.descOwner,descTime:b.descTime,restrict:(c=b.restrict)!=null?c:!1,announce:(c=b.announce)!=null?c:!1,noFrequentlyForwarded:(c=b.noFrequentlyForwarded)!=null?c:!1,ephemeralDuration:(c=b.ephemeralDuration)!=null?c:0,membershipApprovalMode:b.membershipApprovalMode,participants:b.participants,support:(c=b.support)!=null?c:!1,suspended:(c=b.suspended)!=null?c:!1,terminated:(c=b.terminated)!=null?c:!1,parentGroup:b.parentGroup,isParentGroup:(c=b.isParentGroup)!=null?c:!1,isParentGroupClosed:(c=b.isParentGroupClosed)!=null?c:!1,defaultSubgroup:(c=b.defaultSubgroup)!=null?c:!1,generalSubgroup:(c=b.generalSubgroup)!=null?c:!1,incognito:(c=b.incognito)!=null?c:!1,isLidAddressingMode:(c=b.isLidAddressingMode)!=null?c:!1,allowNonAdminSubGroupCreation:b.allowNonAdminSubGroupCreation,generalChatAutoAddDisabled:b.generalChatAutoAddDisabled,hiddenSubgroup:(c=b.hiddenSubgroup)!=null?c:!1}}d("WALogger").WARN(h()).devConsole(b)}catch(b){if(b instanceof d("WAWebBackendErrors").ServerStatusCodeError&&b.status>=400)return{id:a,stale:!1};throw b}});return j.apply(this,arguments)}function c(a){return d("WAWebGroupQueryJob").queryGroupInvite(a).then(function(a){return babelHelpers["extends"]({status:200},a)})}function k(a,b){d("WATypeUtils").isString(b)&&d("WAWebBackendApi").frontendFireAndForget("updateGroupSubject",{id:a,subject:b})}function l(a,b){d("WAWebBackendApi").frontendFireAndForget("updateGroupAddressingMode",{id:a,isLidAddressingMode:b})}g.sendQueryGroup=a;g.sendQueryGroupInvite=c;g.updateSubject=k}),98);
__d("WAWebMsgTunnelBridge",["WAWebMsgSyncTunnelConfig"],(function(a,b,c,d,e,f,g){a={setActiveChat:function(a){if(a==null)return;d("WAWebMsgSyncTunnelConfig").setMsgSyncTunnelConfig({openedChat:a})},resetActiveChat:function(a){if(a==null)return;d("WAWebMsgSyncTunnelConfig").resetMsgSyncTunnelOpenedChat(a)}};g.msgSyncTunnelBridge=a}),98);
__d("WAWeb-curve25519-donna",[],(function $module_WAWeb_curve25519_donna(global,require,requireDynamic,requireLazy,module,exports){var IS_SMALL_CURVE25519_BUFFER_ENABLED=typeof self!="undefined"&&self.IS_SMALL_CURVE25519_BUFFER_ENABLED==!0,e={},aa={},l;for(l in e)e.hasOwnProperty(l)&&(aa[l]=e[l]);e.read=function(a){var b=new XMLHttpRequest;b.open("GET",a,!1);b.send(null);return b.responseText};"undefined"!=typeof arguments&&(e.arguments=arguments);"undefined"!==typeof console?(e.print||(e.print=function(a){}),e.printErr||(e.printErr=function(a){})):e.print||(e.print=function(){});"undefined"===typeof e.setWindowTitle&&(e.setWindowTitle=function(a){document.title=a});function ba(a){eval.call(null,a)}!e.load&&e.read&&(e.load=function(a){ba(e.read(a))});e.print||(e.print=function(){});e.printErr||(e.printErr=e.print);e.arguments||(e.arguments=[]);e.thisProgram||(e.thisProgram="./this.program");e.print=e.print;e.S=e.printErr;e.preRun=[];e.postRun=[];for(l in aa)aa.hasOwnProperty(l)&&(e[l]=aa[l]);var n={cb:function(a){ca=a},Ua:function(){return ca},na:function(){return m},X:function(a){m=a},Aa:function(a){switch(a){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:return"*"===a[a.length-1]?n.H:"i"===a[0]?(a=parseInt(a.substr(1)),assert(0===a%8),a/8):0}},Ta:function(a){return Math.max(n.Aa(a),n.H)},dd:16,Bd:function(a,b){"double"===b||"i64"===b?a&7&&(assert(4===(a&7)),a+=4):assert(0===(a&3));return a},od:function(a,b,c){return c||"i64"!=a&&"double"!=a?a?Math.min(b||(a?n.Ta(a):0),n.H):Math.min(b,8):8},J:function(a,b,c){return c&&c.length?(c.splice||(c=Array.prototype.slice.call(c)),c.splice(0,0,b),e["dynCall_"+a].apply(null,c)):e["dynCall_"+a].call(null,b)},U:[],Ma:function(a){for(var b=0;b<n.U.length;b++)if(!n.U[b])return n.U[b]=a,2*(1+b);throw"Finished up all reserved function pointers. Use a higher value for RESERVED_FUNCTION_POINTERS."},$a:function(a){n.U[(a-2)/2]=null},M:function(a){n.M.ma||(n.M.ma={}),n.M.ma[a]||(n.M.ma[a]=1,e.S(a))},ha:{},rd:function(a,b){assert(b);n.ha[b]||(n.ha[b]={});var c=n.ha[b];c[a]||(c[a]=function(){return n.J(b,a,arguments)});return c[a]},pd:function(){throw"You must build with -s RETAIN_COMPILER_SETTINGS=1 for Runtime.getCompilerSetting or emscripten_get_compiler_setting to work"},W:function(a){var b=m;m=m+a|0;m=m+15&-16;return b},Ia:function(a){var b=p;p=p+a|0;p=p+15&-16;return b},P:function(a){var b=v;v=v+a|0;v=v+15&-16;(a=v>=w)&&(z("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+w+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which adjusts the size at runtime but prevents some optimizations, (3) set Module.TOTAL_MEMORY to a higher value before the program runs, or if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 "),a=!0);return a?(v=b,0):b},ea:function(a,b){return Math.ceil(a/(b?b:16))*(b?b:16)},xd:function(a,b,c){return c?+(a>>>0)+4294967296*+(b>>>0):+(a>>>0)+4294967296*+(b|0)},La:8,H:4,ed:0};e.Runtime=n;n.addFunction=n.Ma;n.removeFunction=n.$a;var A=!1,da,fa,ca;function assert(a,b){a||z("Assertion failed: "+b)}function ga(a){var b=e["_"+a];if(!b)try{b=eval("_"+a)}catch(c){}assert(b,"Cannot call unknown function "+a+" (perhaps LLVM optimizations or closure removed it?)");return b}var ha,ia;(function(){function a(a){a=a.toString().match(d).slice(1);return{arguments:a[0],body:a[1],returnValue:a[2]}}var b={stackSave:function(){n.na()},stackRestore:function(){n.X()},arrayToC:function(a){var b=n.W(a.length);ja(a,b);return b},stringToC:function(a){var b=0;null!==a&&void 0!==a&&0!==a&&(b=n.W((a.length<<2)+1),ka(a,b));return b}},c={string:b.stringToC,array:b.arrayToC};ia=function(a,b,d,f,h){a=ga(a);var q=[],y=0;if(f)for(var B=0;B<f.length;B++){var J=c[d[B]];J?(0===y&&(y=n.na()),q[B]=J(f[B])):q[B]=f[B]}d=a.apply(null,q);"string"===b&&(d=la(d));if(0!==y){if(h&&h.async){EmterpreterAsync.hd.push(function(){n.X(y)});return}n.X(y)}return d};var d=/^function\s*\(([^)]*)\)\s*{\s*([^*]*?)[\s;]*(?:return\s*(.*?)[;\s]*)?}$/,f={},h;for(h in b)b.hasOwnProperty(h)&&(f[h]=a(b[h]));ha=function(b,c,d){d=d||[];var h=ga(b);b=d.every(function(a){return"number"===a});var u="string"!==c;if(u&&b)return h;var q=d.map(function(a,b){return"$"+b});c="(function("+q.join(",")+") {";var y=d.length;if(!b){c+="var stack = "+f.stackSave.body+";";for(var B=0;B<y;B++){var J=q[B],ea=d[B];"number"!==ea&&(ea=f[ea+"ToC"],c+="var "+ea.arguments+" = "+J+";",c+=ea.body+";",c+=J+"="+ea.returnValue+";")}}d=a(function(){return h}).returnValue;c+="var ret = "+d+"("+q.join(",")+");";u||(d=a(function(){return la}).returnValue,c+="ret = "+d+"(ret);");b||(c+=f.stackRestore.body.replace("()","(stack)")+";");return eval(c+"return ret})")}})();e.ccall=ia;e.cwrap=ha;function ma(a,b,c){c=c||"i8";"*"===c.charAt(c.length-1)&&(c="i32");switch(c){case"i1":D[a>>0]=b;break;case"i8":D[a>>0]=b;break;case"i16":E[a>>1]=b;break;case"i32":F[a>>2]=b;break;case"i64":fa=[b>>>0,(da=b,1<=+na(da)?0<da?(oa(+pa(da/4294967296),4294967295)|0)>>>0:~~+qa((da-+(~~da>>>0))/4294967296)>>>0:0)];F[a>>2]=fa[0];F[a+4>>2]=fa[1];break;case"float":ra[a>>2]=b;break;case"double":sa[a>>3]=b;break;default:z("invalid type for setValue: "+c)}}e.setValue=ma;function ta(a,b){b=b||"i8";"*"===b.charAt(b.length-1)&&(b="i32");switch(b){case"i1":return D[a>>0];case"i8":return D[a>>0];case"i16":return E[a>>1];case"i32":return F[a>>2];case"i64":return F[a>>2];case"float":return ra[a>>2];case"double":return sa[a>>3];default:z("invalid type for setValue: "+b)}return null}e.getValue=ta;e.ALLOC_NORMAL=0;e.ALLOC_STACK=1;e.ALLOC_STATIC=2;e.ALLOC_DYNAMIC=3;e.ALLOC_NONE=4;function G(a,b,c,d){var f,h;"number"===typeof a?(f=!0,h=a):(f=!1,h=a.length);var g="string"===typeof b?b:null;c=4==c?d:[ua,n.W,n.Ia,n.P][void 0===c?2:c](Math.max(h,g?1:b.length));if(f){d=c;assert(0==(c&3));for(a=c+(h&-4);d<a;d+=4)F[d>>2]=0;for(a=c+h;d<a;)D[d++>>0]=0;return c}if("i8"===g)return a.subarray||a.slice?H.set(a,c):H.set(new Uint8Array(a),c),c;d=0;for(var k,t;d<h;){var r=a[d];"function"===typeof r&&(r=n.sd(r));f=g||b[d];0===f?d++:("i64"==f&&(f="i32"),ma(c+d,r,f),t!==f&&(k=n.Aa(f),t=f),d+=k)}return c}e.allocate=G;e.getMemory=function(a){return va?"undefined"!==typeof wa&&!wa.C||!xa?n.P(a):ua(a):n.Ia(a)};function la(a,b){if(0===b||!a)return"";for(var c=0,d,f=0;;){d=H[a+f>>0];c|=d;if(0==d&&!b)break;f++;if(b&&f==b)break}b||(b=f);d="";if(128>c){for(;0<b;)c=String.fromCharCode.apply(String,H.subarray(a,a+Math.min(b,1024))),d=d?d+c:c,a+=1024,b-=1024;return d}return e.UTF8ToString(a)}e.Pointer_stringify=la;e.AsciiToString=function(a){for(var b="";;){var c=D[a++>>0];if(!c)return b;b+=String.fromCharCode(c)}};e.stringToAscii=function(a,b){return ya(a,b,!1)};function za(a,b){for(var c,d,f,h,g,k,t="";;){c=a[b++];if(!c)return t;c&128?(d=a[b++]&63,192==(c&224)?t+=String.fromCharCode((c&31)<<6|d):(f=a[b++]&63,224==(c&240)?c=(c&15)<<12|d<<6|f:(h=a[b++]&63,240==(c&248)?c=(c&7)<<18|d<<12|f<<6|h:(g=a[b++]&63,248==(c&252)?c=(c&3)<<24|d<<18|f<<12|h<<6|g:(k=a[b++]&63,c=(c&1)<<30|d<<24|f<<18|h<<12|g<<6|k))),65536>c?t+=String.fromCharCode(c):(c-=65536,t+=String.fromCharCode(55296|c>>10,56320|c&1023)))):t+=String.fromCharCode(c)}}e.UTF8ArrayToString=za;e.UTF8ToString=function(a){return za(H,a)};function Aa(a,b,c,d){if(!(0<d))return 0;var f=c;d=c+d-1;for(var h=0;h<a.length;++h){var g=a.charCodeAt(h);55296<=g&&57343>=g&&(g=65536+((g&1023)<<10)|a.charCodeAt(++h)&1023);if(127>=g){if(c>=d)break;b[c++]=g}else{if(2047>=g){if(c+1>=d)break;b[c++]=192|g>>6}else{if(65535>=g){if(c+2>=d)break;b[c++]=224|g>>12}else{if(2097151>=g){if(c+3>=d)break;b[c++]=240|g>>18}else{if(67108863>=g){if(c+4>=d)break;b[c++]=248|g>>24}else{if(c+5>=d)break;b[c++]=252|g>>30;b[c++]=128|g>>24&63}b[c++]=128|g>>18&63}b[c++]=128|g>>12&63}b[c++]=128|g>>6&63}b[c++]=128|g&63}}b[c]=0;return c-f}e.stringToUTF8Array=Aa;e.stringToUTF8=function(a,b,c){return Aa(a,H,b,c)};function Ba(a){for(var b=0,c=0;c<a.length;++c){var d=a.charCodeAt(c);55296<=d&&57343>=d&&(d=65536+((d&1023)<<10)|a.charCodeAt(++c)&1023);127>=d?++b:b=2047>=d?b+2:65535>=d?b+3:2097151>=d?b+4:67108863>=d?b+5:b+6}return b}e.lengthBytesUTF8=Ba;e.UTF16ToString=function(a){for(var b=0,c="";;){var d=E[a+2*b>>1];if(0==d)return c;++b;c+=String.fromCharCode(d)}};e.stringToUTF16=function(a,b,c){void 0===c&&(c=2147483647);if(2>c)return 0;c-=2;var d=b;c=c<2*a.length?c/2:a.length;for(var f=0;f<c;++f)E[b>>1]=a.charCodeAt(f),b+=2;E[b>>1]=0;return b-d};e.lengthBytesUTF16=function(a){return 2*a.length};e.UTF32ToString=function(a){for(var b=0,c="";;){var d=F[a+4*b>>2];if(0==d)return c;++b;65536<=d?(d=d-65536,c+=String.fromCharCode(55296|d>>10,56320|d&1023)):c+=String.fromCharCode(d)}};e.stringToUTF32=function(a,b,c){void 0===c&&(c=2147483647);if(4>c)return 0;var d=b;c=d+c-4;for(var f=0;f<a.length;++f){var h=a.charCodeAt(f);if(55296<=h&&57343>=h)var g=a.charCodeAt(++f),h=65536+((h&1023)<<10)|g&1023;F[b>>2]=h;b+=4;if(b+4>c)break}F[b>>2]=0;return b-d};e.lengthBytesUTF32=function(a){for(var b=0,c=0;c<a.length;++c){var d=a.charCodeAt(c);55296<=d&&57343>=d&&++c;b+=4}return b};function Ca(a){function b(c,d,f){d=d||Infinity;var h="",g=[],q;if("N"===a[k]){k++;"K"===a[k]&&k++;for(q=[];"E"!==a[k];)if("S"===a[k]){k++;var x=a.indexOf("_",k);q.push(r[a.substring(k,x)||0]||"?");k=x+1}else if("C"===a[k])q.push(q[q.length-1]),k+=2;else{var x=parseInt(a.substr(k)),Q=x.toString().length;if(!x||!Q){k--;break}var Bb=a.substr(k+Q,x);q.push(Bb);r.push(Bb);k+=Q+x}k++;q=q.join("::");d--;if(0===d)return c?[q]:q}else(("K"===a[k]||u&&"L"===a[k])&&k++,x=parseInt(a.substr(k)))&&(Q=x.toString().length,q=a.substr(k+Q,x),k+=Q+x);u=!1;"I"===a[k]?(k++,x=b(!0),Q=b(!0,1,!0),h+=Q[0]+" "+q+"<"+x.join(", ")+">"):h=q;a:for(;k<a.length&&0<d--;)if(q=a[k++],q in t)g.push(t[q]);else switch(q){case"P":g.push(b(!0,1,!0)[0]+"*");break;case"R":g.push(b(!0,1,!0)[0]+"&");break;case"L":k++;x=a.indexOf("E",k)-k;g.push(a.substr(k,x));k+=x+2;break;case"A":x=parseInt(a.substr(k));k+=x.toString().length;if("_"!==a[k])throw"?";k++;g.push(b(!0,1,!0)[0]+" ["+x+"]");break;case"E":break a;default:h+="?"+q;break a}f||1!==g.length||"void"!==g[0]||(g=[]);return c?(h&&g.push(h+"?"),g):h+("("+g.join(", ")+")")}var c=!!e.___cxa_demangle;if(c)try{var d=ua(a.length);ka(a.substr(1),d);var f=ua(4),h=e.___cxa_demangle(d,0,0,f);if(0===ta(f,"i32")&&h)return la(h)}catch(g){}finally{d&&Da(d),f&&Da(f),h&&Da(h)}var k=3,t={v:"void",b:"bool",c:"char",s:"short",i:"int",l:"long",f:"float",d:"double",w:"wchar_t",a:"signed char",h:"unsigned char",t:"unsigned short",j:"unsigned int",m:"unsigned long",x:"long long",y:"unsigned long long",z:"..."},r=[],u=!0,d=a;try{if("Object._main"==a||"_main"==a)return"main()";"number"===typeof a&&(a=la(a));if("_"!==a[0]||"_"!==a[1]||"Z"!==a[2])return a;switch(a[3]){case"n":return"operator new()";case"d":return"operator delete()"}d=b()}catch(q){d+="?"}0<=d.indexOf("?")&&!c&&n.M("warning: a problem occurred in builtin C++ name demangling; build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling");return d}function Ea(){return Fa().replace(/__Z[\w\d_]+/g,function(a){var b=Ca(a);return a===b?a:a+" ["+b+"]"})}function Fa(){var a=Error();if(!a.stack){try{throw Error(0)}catch(b){a=b}if(!a.stack)return"(no stack trace available)"}return a.stack.toString()}e.stackTrace=function(){return Ea()};function Ga(){var a=v;0<a%4096&&(a+=4096-a%4096);return a}for(var D,H,E,Ha,F,Ia,ra,sa,Ja=0,p=0,va=!1,Ka=0,m=0,La=0,Ma=0,v=0,Na=e.TOTAL_STACK||(IS_SMALL_CURVE25519_BUFFER_ENABLED?524288:5242880),w=e.TOTAL_MEMORY||(IS_SMALL_CURVE25519_BUFFER_ENABLED?1048576:16777216),I=65536;I<w||I<2*Na;)I=16777216>I?2*I:I+16777216;I!==w&&(w=I);assert("undefined"!==typeof Int32Array&&"undefined"!==typeof Float64Array&&!!new Int32Array(1).subarray&&!!new Int32Array(1).set,"JS engine does not provide full typed array support");var buffer;buffer=new ArrayBuffer(w);D=new Int8Array(buffer);E=new Int16Array(buffer);F=new Int32Array(buffer);H=new Uint8Array(buffer);Ha=new Uint16Array(buffer);Ia=new Uint32Array(buffer);ra=new Float32Array(buffer);sa=new Float64Array(buffer);F[0]=255;assert(255===H[0]&&0===H[3],"Typed arrays 2 must be run on a little-endian system");e.HEAP=void 0;e.buffer=buffer;e.HEAP8=D;e.HEAP16=E;e.HEAP32=F;e.HEAPU8=H;e.HEAPU16=Ha;e.HEAPU32=Ia;e.HEAPF32=ra;e.HEAPF64=sa;function Oa(a){for(;0<a.length;){var b=a.shift();if("function"==typeof b)b();else{var c=b.Qa;"number"===typeof c?void 0===b.T?n.J("v",c):n.J("vi",c,[b.T]):c(void 0===b.T?null:b.T)}}}var Pa=[],Qa=[],Ra=[],K=[],Sa=[],xa=!1;function Ta(a){Pa.unshift(a)}e.addOnPreRun=Ta;e.addOnInit=function(a){Qa.unshift(a)};e.addOnPreMain=function(a){Ra.unshift(a)};e.addOnExit=function(a){K.unshift(a)};function Ua(a){Sa.unshift(a)}e.addOnPostRun=Ua;function Va(a,b,c){c=Array(0<c?c:Ba(a)+1);a=Aa(a,c,0,c.length);b&&(c.length=a);return c}e.intArrayFromString=Va;e.intArrayToString=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];255<d&&(d&=255);b.push(String.fromCharCode(d))}return b.join("")};function ka(a,b,c){a=Va(a,c);for(c=0;c<a.length;)D[b+c>>0]=a[c],c+=1}e.writeStringToMemory=ka;function ja(a,b){for(var c=0;c<a.length;c++)D[b++>>0]=a[c]}e.writeArrayToMemory=ja;function ya(a,b,c){for(var d=0;d<a.length;++d)D[b++>>0]=a.charCodeAt(d);c||(D[b>>0]=0)}e.writeAsciiToMemory=ya;Math.imul&&-5===Math.imul(4294967295,5)||(Math.imul=function(a,b){var c=a&65535,d=b&65535;return c*d+((a>>>16)*d+c*(b>>>16)<<16)|0});Math.td=Math.imul;Math.clz32||(Math.clz32=function(a){a=a>>>0;for(var b=0;32>b;b++)if(a&1<<31-b)return b;return 32});Math.kd=Math.clz32;var na=Math.abs,qa=Math.ceil,pa=Math.floor,oa=Math.min,L=0,Wa=null,Xa=null;function Ya(){L++,e.monitorRunDependencies&&e.monitorRunDependencies(L)}e.addRunDependency=Ya;function Za(){L--;e.monitorRunDependencies&&e.monitorRunDependencies(L);if(0==L&&(null!==Wa&&(clearInterval(Wa),Wa=null),Xa)){var a=Xa;Xa=null;a()}}e.removeRunDependency=Za;e.preloadedImages={};e.preloadedAudios={};Ja=8;p=Ja+1696;Qa.push();G([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,60,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,0,0,0,164,2,0,0,0,4,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"i8",4,n.La);var $a=n.ea(G(12,"i8",2),8);assert(0==$a%8);e._bitshift64Ashr=ab;e._i64Subtract=bb;e._i64Add=cb;e._memset=db;function eb(a,b){K.push(function(){n.J("vi",a,[b])}),eb.level=K.length}e._bitshift64Lshr=fb;e._bitshift64Shl=gb;var M={G:1,B:2,Qc:3,Nb:4,F:5,sa:6,gb:7,kc:8,Z:9,ub:10,oa:11,$c:11,Ka:12,Y:13,Gb:14,wc:15,$:16,pa:17,ad:18,ba:19,qa:20,N:21,u:22,fc:23,Ja:24,O:25,Xc:26,Hb:27,sc:28,da:29,Nc:30,Zb:31,Gc:32,Db:33,Kc:34,oc:42,Kb:43,vb:44,Qb:45,Rb:46,Sb:47,Yb:48,Yc:49,ic:50,Pb:51,Ab:35,lc:37,mb:52,pb:53,bd:54,gc:55,qb:56,rb:57,Bb:35,sb:59,uc:60,jc:61,Uc:62,tc:63,pc:64,qc:65,Mc:66,mc:67,jb:68,Rc:69,wb:70,Hc:71,ac:72,Eb:73,ob:74,Bc:76,nb:77,Lc:78,Tb:79,Ub:80,Xb:81,Wb:82,Vb:83,vc:38,ra:39,bc:36,aa:40,Cc:95,Fc:96,zb:104,hc:105,kb:97,Jc:91,zc:88,rc:92,Oc:108,yb:111,hb:98,xb:103,ec:101,cc:100,Vc:110,Ib:112,Jb:113,Mb:115,lb:114,Cb:89,$b:90,Ic:93,Pc:94,ib:99,dc:102,Ob:106,xc:107,Wc:109,Zc:87,Fb:122,Sc:116,Ac:95,nc:123,Lb:84,Dc:75,tb:125,yc:131,Ec:130,Tc:86},hb={0:"Success",1:"Not super-user",2:"No such file or directory",3:"No such process",4:"Interrupted system call",5:"I/O error",6:"No such device or address",7:"Arg list too long",8:"Exec format error",9:"Bad file number",10:"No children",11:"No more processes",12:"Not enough core",13:"Permission denied",14:"Bad address",15:"Block device required",16:"Mount device busy",17:"File exists",18:"Cross-device link",19:"No such device",20:"Not a directory",21:"Is a directory",22:"Invalid argument",23:"Too many open files in system",24:"Too many open files",25:"Not a typewriter",26:"Text file busy",27:"File too large",28:"No space left on device",29:"Illegal seek",30:"Read only file system",31:"Too many links",32:"Broken pipe",33:"Math arg out of domain of func",34:"Math result not representable",35:"File locking deadlock error",36:"File or path name too long",37:"No record locks available",38:"Function not implemented",39:"Directory not empty",40:"Too many symbolic links",42:"No message of desired type",43:"Identifier removed",44:"Channel number out of range",45:"Level 2 not synchronized",46:"Level 3 halted",47:"Level 3 reset",48:"Link number out of range",49:"Protocol driver not attached",50:"No CSI structure available",51:"Level 2 halted",52:"Invalid exchange",53:"Invalid request descriptor",54:"Exchange full",55:"No anode",56:"Invalid request code",57:"Invalid slot",59:"Bad font file fmt",60:"Device not a stream",61:"No data (for no delay io)",62:"Timer expired",63:"Out of streams resources",64:"Machine is not on the network",65:"Package not installed",66:"The object is remote",67:"The link has been severed",68:"Advertise error",69:"Srmount error",70:"Communication error on send",71:"Protocol error",72:"Multihop attempted",73:"Cross mount point (not really error)",74:"Trying to read unreadable message",75:"Value too large for defined data type",76:"Given log. name not unique",77:"f.d. invalid for this operation",78:"Remote address changed",79:"Can   access a needed shared lib",80:"Accessing a corrupted shared lib",81:".lib section in a.out corrupted",82:"Attempting to link in too many libs",83:"Attempting to exec a shared library",84:"Illegal byte sequence",86:"Streams pipe error",87:"Too many users",88:"Socket operation on non-socket",89:"Destination address required",90:"Message too long",91:"Protocol wrong type for socket",92:"Protocol not available",93:"Unknown protocol",94:"Socket type not supported",95:"Not supported",96:"Protocol family not supported",97:"Address family not supported by protocol family",98:"Address already in use",99:"Address not available",100:"Network interface is not configured",101:"Network is unreachable",102:"Connection reset by network",103:"Connection aborted",104:"Connection reset by peer",105:"No buffer space available",106:"Socket is already connected",107:"Socket is not connected",108:"Can't send after socket shutdown",109:"Too many references",110:"Connection timed out",111:"Connection refused",112:"Host is down",113:"Host is unreachable",114:"Socket already connected",115:"Connection already in progress",116:"Stale file handle",122:"Quota exceeded",123:"No medium (in tape drive)",125:"Operation canceled",130:"Previous owner died",131:"State not recoverable"};function ib(a){e.___errno_location&&(F[e.___errno_location()>>2]=a);return a}function jb(a,b){for(var c=0,d=a.length-1;0<=d;d--){var f=a[d];"."===f?a.splice(d,1):".."===f?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}function N(a){var b="/"===a.charAt(0),c="/"===a.substr(-1);(a=jb(a.split("/").filter(function(a){return!!a}),!b).join("/"))||b||(a=".");a&&c&&(a+="/");return(b?"/":"")+a}function kb(a){var b=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(a).slice(1);a=b[0];b=b[1];if(!a&&!b)return".";b&&(b=b.substr(0,b.length-1));return a+b}function lb(a){if("/"===a)return"/";var b=a.lastIndexOf("/");return-1===b?a:a.substr(b+1)}function mb(){for(var a="",b=!1,c=arguments.length-1;-1<=c&&!b;c--){b=0<=c?arguments[c]:"/";if("string"!==typeof b)throw new TypeError("Arguments to path.resolve must be strings");if(!b)return"";a=b+"/"+a;b="/"===b.charAt(0)}a=jb(a.split("/").filter(function(a){return!!a}),!b).join("/");return(b?"/":"")+a||"."}var nb=[];function ob(a,b){nb[a]={input:[],output:[],L:b},pb(a,qb)}var qb={open:function(a){var b=nb[a.g.rdev];if(!b)throw new O(M.ba);a.tty=b;a.seekable=!1},close:function(a){a.tty.L.flush(a.tty)},flush:function(a){a.tty.L.flush(a.tty)},read:function(a,b,c,d){if(!a.tty||!a.tty.L.Ba)throw new O(M.sa);for(var f=0,h=0;h<d;h++){var g;try{g=a.tty.L.Ba(a.tty)}catch(k){throw new O(M.F)}if(void 0===g&&0===f)throw new O(M.oa);if(null===g||void 0===g)break;f++;b[c+h]=g}f&&(a.g.timestamp=Date.now());return f},write:function(a,b,c,d){if(!a.tty||!a.tty.L.ja)throw new O(M.sa);for(var f=0;f<d;f++)try{a.tty.L.ja(a.tty,b[c+f])}catch(h){throw new O(M.F)}d&&(a.g.timestamp=Date.now());return f}},rb={Ba:function(a){if(!a.input.length){var b=null;"undefined"!=typeof window&&"function"==typeof window.prompt?(b=window.prompt("Input: "),null!==b&&(b+="\n")):"function"==typeof readline&&(b=readline(),null!==b&&(b+="\n"));if(!b)return null;a.input=Va(b,!0)}return a.input.shift()},ja:function(a,b){null===b||10===b?(e.print(za(a.output,0)),a.output=[]):0!=b&&a.output.push(b)},flush:function(a){a.output&&0<a.output.length&&(e.print(za(a.output,0)),a.output=[])}},sb={ja:function(a,b){null===b||10===b?(e.printErr(za(a.output,0)),a.output=[]):0!=b&&a.output.push(b)},flush:function(a){a.output&&0<a.output.length&&(e.printErr(za(a.output,0)),a.output=[])}},P={q:null,A:function(){return P.createNode(null,"/",16895,0)},createNode:function(a,b,c,d){if(24576===(c&61440)||4096===(c&61440))throw new O(M.G);P.q||(P.q={dir:{g:{D:P.k.D,p:P.k.p,lookup:P.k.lookup,V:P.k.V,rename:P.k.rename,unlink:P.k.unlink,rmdir:P.k.rmdir,readdir:P.k.readdir,symlink:P.k.symlink},stream:{I:P.n.I}},file:{g:{D:P.k.D,p:P.k.p},stream:{I:P.n.I,read:P.n.read,write:P.n.write,ta:P.n.ta,Ea:P.n.Ea,Ga:P.n.Ga}},link:{g:{D:P.k.D,p:P.k.p,readlink:P.k.readlink},stream:{}},va:{g:{D:P.k.D,p:P.k.p},stream:tb}});c=ub(a,b,c,d);16384===(c.mode&61440)?(c.k=P.q.dir.g,c.n=P.q.dir.stream,c.e={}):32768===(c.mode&61440)?(c.k=P.q.file.g,c.n=P.q.file.stream,c.o=0,c.e=null):40960===(c.mode&61440)?(c.k=P.q.link.g,c.n=P.q.link.stream):8192===(c.mode&61440)&&(c.k=P.q.va.g,c.n=P.q.va.stream);c.timestamp=Date.now();a&&(a.e[b]=c);return c},Sa:function(a){if(a.e&&a.e.subarray){for(var b=[],c=0;c<a.o;++c)b.push(a.e[c]);return b}return a.e},qd:function(a){return a.e?a.e.subarray?a.e.subarray(0,a.o):new Uint8Array(a.e):new Uint8Array},ya:function(a,b){a.e&&a.e.subarray&&b>a.e.length&&(a.e=P.Sa(a),a.o=a.e.length);if(!a.e||a.e.subarray){var c=a.e?a.e.buffer.byteLength:0;c>=b||(b=Math.max(b,c*(1048576>c?2:1.125)|0),0!=c&&(b=Math.max(b,256)),c=a.e,a.e=new Uint8Array(b),0<a.o&&a.e.set(c.subarray(0,a.o),0))}else for(!a.e&&0<b&&(a.e=[]);a.e.length<b;)a.e.push(0)},ab:function(a,b){if(a.o!=b)if(0==b)a.e=null,a.o=0;else{if(!a.e||a.e.subarray){var c=a.e;a.e=new Uint8Array(new ArrayBuffer(b));c&&a.e.set(c.subarray(0,Math.min(b,a.o)))}else if(a.e||(a.e=[]),a.e.length>b)a.e.length=b;else for(;a.e.length<b;)a.e.push(0);a.o=b}},k:{D:function(a){var b={};b.dev=8192===(a.mode&61440)?a.id:1;b.ino=a.id;b.mode=a.mode;b.nlink=1;b.uid=0;b.gid=0;b.rdev=a.rdev;16384===(a.mode&61440)?b.size=4096:32768===(a.mode&61440)?b.size=a.o:40960===(a.mode&61440)?b.size=a.link.length:b.size=0;b.atime=new Date(a.timestamp);b.mtime=new Date(a.timestamp);b.ctime=new Date(a.timestamp);b.Pa=4096;b.blocks=Math.ceil(b.size/b.Pa);return b},p:function(a,b){void 0!==b.mode&&(a.mode=b.mode),void 0!==b.timestamp&&(a.timestamp=b.timestamp),void 0!==b.size&&P.ab(a,b.size)},lookup:function(){throw vb[M.B]},V:function(a,b,c,d){return P.createNode(a,b,c,d)},rename:function(a,b,c){if(16384===(a.mode&61440)){var d;try{d=wb(b,c)}catch(f){}if(d)for(var h in d.e)throw new O(M.ra)}delete a.parent.e[a.name];a.name=c;b.e[c]=a;a.parent=b},unlink:function(a,b){delete a.e[b]},rmdir:function(a,b){var c=wb(a,b),d;for(d in c.e)throw new O(M.ra);delete a.e[b]},readdir:function(a){var b=[".",".."],c;for(c in a.e)a.e.hasOwnProperty(c)&&b.push(c);return b},symlink:function(a,b,c){a=P.createNode(a,b,41471,0);a.link=c;return a},readlink:function(a){if(40960!==(a.mode&61440))throw new O(M.u);return a.link}},n:{read:function(a,b,c,d,f){var h=a.g.e;if(f>=a.g.o)return 0;a=Math.min(a.g.o-f,d);assert(0<=a);if(8<a&&h.subarray)b.set(h.subarray(f,f+a),c);else for(d=0;d<a;d++)b[c+d]=h[f+d];return a},write:function(a,b,c,d,f,h){if(!d)return 0;a=a.g;a.timestamp=Date.now();if(b.subarray&&(!a.e||a.e.subarray)){if(h)return a.e=b.subarray(c,c+d),a.o=d;if(0===a.o&&0===f)return a.e=new Uint8Array(b.subarray(c,c+d)),a.o=d;if(f+d<=a.o)return a.e.set(b.subarray(c,c+d),f),d}P.ya(a,f+d);if(a.e.subarray&&b.subarray)a.e.set(b.subarray(c,c+d),f);else for(h=0;h<d;h++)a.e[f+h]=b[c+h];a.o=Math.max(a.o,f+d);return d},I:function(a,b,c){1===c?b+=a.position:2===c&&32768===(a.g.mode&61440)&&(b+=a.g.o);if(0>b)throw new O(M.u);return b},ta:function(a,b,c){P.ya(a.g,b+c),a.g.o=Math.max(a.g.o,b+c)},Ea:function(a,b,c,d,f,h,g){if(32768!==(a.g.mode&61440))throw new O(M.ba);c=a.g.e;if(g&2||c.buffer!==b&&c.buffer!==b.buffer){(0<f||f+d<a.g.o)&&(c.subarray?c=c.subarray(f,f+d):c=Array.prototype.slice.call(c,f,f+d));a=!0;d=ua(d);if(!d)throw new O(M.Ka);b.set(c,d)}else a=!1,d=c.byteOffset;return{Cd:d,gd:a}},Ga:function(a,b,c,d,f){if(32768!==(a.g.mode&61440))throw new O(M.ba);if(f&2)return 0;P.n.write(a,b,0,d,c,!1);return 0}}};G(1,"i32*",2);G(1,"i32*",2);G(1,"i32*",2);var xb=null,yb=[null],zb=[],Ab=1,R=null,Cb=!0,S={},O=null,vb={};function T(a,b){a=mb("/",a);b=b||{};if(!a)return{path:"",g:null};var c={za:!0,ka:0},d;for(d in c)void 0===b[d]&&(b[d]=c[d]);if(8<b.ka)throw new O(M.aa);var c=jb(a.split("/").filter(function(a){return!!a}),!1),f=xb;d="/";for(var h=0;h<c.length;h++){var g=h===c.length-1;if(g&&b.parent)break;f=wb(f,c[h]);d=N(d+"/"+c[h]);f.R&&(!g||g&&b.za)&&(f=f.R.root);if(!g||b.ga)for(g=0;40960===(f.mode&61440);)if(f=Db(d),d=mb(kb(d),f),f=T(d,{ka:b.ka}).g,40<g++)throw new O(M.aa)}return{path:d,g:f}}function U(a){for(var b;;){if(a===a.parent)return a=a.A.Fa,b?"/"!==a[a.length-1]?a+"/"+b:a+b:a;b=b?a.name+"/"+b:a.name;a=a.parent}}function Eb(a,b){for(var c=0,d=0;d<b.length;d++)c=(c<<5)-c+b.charCodeAt(d)|0;return(a+c>>>0)%R.length}function Fb(a){var b=Eb(a.parent.id,a.name);a.K=R[b];R[b]=a}function wb(a,b){var c;if(c=(c=Gb(a,"x"))?c:a.k.lookup?0:M.Y)throw new O(c,a);for(c=R[Eb(a.id,b)];c;c=c.K){var d=c.name;if(c.parent.id===a.id&&d===b)return c}return a.k.lookup(a,b)}function ub(a,b,c,d){Hb||(Hb=function(a,b,c,d){a||(a=this),this.parent=a,this.A=a.A,this.R=null,this.id=Ab++,this.name=b,this.mode=c,this.k={},this.n={},this.rdev=d},Hb.prototype={},Object.defineProperties(Hb.prototype,{read:{get:function(){return 365===(this.mode&365)},set:function(a){a?this.mode|=365:this.mode&=-366}},write:{get:function(){return 146===(this.mode&146)},set:function(a){a?this.mode|=146:this.mode&=-147}},Xa:{get:function(){return 16384===(this.mode&61440)}},Ca:{get:function(){return 8192===(this.mode&61440)}}}));a=new Hb(a,b,c,d);Fb(a);return a}var Ib={r:0,rs:1052672,"r+":2,w:577,wx:705,xw:705,"w+":578,"wx+":706,"xw+":706,a:1089,ax:1217,xa:1217,"a+":1090,"ax+":1218,"xa+":1218};function Gb(a,b){if(Cb)return 0;if(-1===b.indexOf("r")||a.mode&292){if(-1!==b.indexOf("w")&&!(a.mode&146)||-1!==b.indexOf("x")&&!(a.mode&73))return M.Y}else return M.Y;return 0}function Jb(a,b){try{return wb(a,b),M.pa}catch(c){}return Gb(a,"wx")}function Kb(){var a;a=4096;for(var b=0;b<=a;b++)if(!zb[b])return b;throw new O(M.Ja)}function Lb(a){Mb||(Mb=function(){},Mb.prototype={},Object.defineProperties(Mb.prototype,{object:{get:function(){return this.g},set:function(a){this.g=a}},vd:{get:function(){return 1!==(this.flags&2097155)}},wd:{get:function(){return 0!==(this.flags&2097155)}},ud:{get:function(){return this.flags&1024}}}));var b=new Mb,c;for(c in a)b[c]=a[c];a=b;b=Kb();a.fd=b;return zb[b]=a}var tb={open:function(a){a.n=yb[a.g.rdev].n,a.n.open&&a.n.open(a)},I:function(){throw new O(M.da)}};function pb(a,b){yb[a]={n:b}}function Nb(a,b){var c="/"===b,d=!b,f;if(c&&xb)throw new O(M.$);if(!c&&!d){f=T(b,{za:!1});b=f.path;f=f.g;if(f.R)throw new O(M.$);if(16384!==(f.mode&61440))throw new O(M.qa)}var d={type:a,Ad:{},Fa:b,Ya:[]},h=a.A(d);h.A=d;d.root=h;c?xb=h:f&&(f.R=d,f.A&&f.A.Ya.push(d))}function Ob(a,b,c){var d=T(a,{parent:!0}).g;a=lb(a);if(!a||"."===a||".."===a)throw new O(M.u);var f=Jb(d,a);if(f)throw new O(f);if(!d.k.V)throw new O(M.G);return d.k.V(d,a,b,c)}function Pb(a,b){b=(void 0!==b?b:438)&4095;b|=32768;return Ob(a,b,0)}function V(a,b){b=(void 0!==b?b:511)&1023;b|=16384;return Ob(a,b,0)}function Qb(a,b,c){"undefined"===typeof c&&(c=b,b=438);return Ob(a,b|8192,c)}function Rb(a,b){if(!mb(a))throw new O(M.B);var c=T(b,{parent:!0}).g;if(!c)throw new O(M.B);var d=lb(b),f=Jb(c,d);if(f)throw new O(f);if(!c.k.symlink)throw new O(M.G);return c.k.symlink(c,d,a)}function Db(a){a=T(a).g;if(!a)throw new O(M.B);if(!a.k.readlink)throw new O(M.u);return mb(U(a.parent),a.k.readlink(a))}function Sb(a,b){var c;"string"===typeof a?c=T(a,{ga:!0}).g:c=a;if(!c.k.p)throw new O(M.G);c.k.p(c,{mode:b&4095|c.mode&-4096,timestamp:Date.now()})}function Tb(a,b){var c;if(""===a)throw new O(M.B);var d;if("string"===typeof b){if(d=Ib[b],"undefined"===typeof d)throw Error("Unknown file open mode: "+b)}else d=b;b=d;c=b&64?("undefined"===typeof c?438:c)&4095|32768:0;var f;if("object"===typeof a)f=a;else{a=N(a);try{f=T(a,{ga:!(b&131072)}).g}catch(h){}}d=!1;if(b&64)if(f){if(b&128)throw new O(M.pa)}else f=Ob(a,c,0),d=!0;if(!f)throw new O(M.B);8192===(f.mode&61440)&&(b&=-513);if(b&65536&&16384!==(f.mode&61440))throw new O(M.qa);if(!d&&(f?40960===(f.mode&61440)?c=M.aa:16384===(f.mode&61440)&&(0!==(b&2097155)||b&512)?c=M.N:(c=["r","w","rw"][b&3],b&512&&(c+="w"),c=Gb(f,c)):c=M.B,c))throw new O(c);if(b&512){c=f;var g;"string"===typeof c?g=T(c,{ga:!0}).g:g=c;if(!g.k.p)throw new O(M.G);if(16384===(g.mode&61440))throw new O(M.N);if(32768!==(g.mode&61440))throw new O(M.u);if(c=Gb(g,"w"))throw new O(c);g.k.p(g,{size:0,timestamp:Date.now()})}b&=-641;f=Lb({g:f,path:U(f),flags:b,seekable:!0,position:0,n:f.n,eb:[],error:!1});f.n.open&&f.n.open(f);!e.logReadFiles||b&1||(Ub||(Ub={}),a in Ub||(Ub[a]=1,e.printErr("read file: "+a)));try{S.onOpenFile&&(g=0,1!==(b&2097155)&&(g|=1),0!==(b&2097155)&&(g|=2),S.onOpenFile(a,g))}catch(k){}return f}function Vb(a){a.ia&&(a.ia=null);try{a.n.close&&a.n.close(a)}catch(b){throw b}finally{zb[a.fd]=null}}function Wb(a,b,c){if(!a.seekable||!a.n.I)throw new O(M.da);a.position=a.n.I(a,b,c);a.eb=[]}function Xb(a,b,c,d,f,h){if(0>d||0>f)throw new O(M.u);if(0===(a.flags&2097155))throw new O(M.Z);if(16384===(a.g.mode&61440))throw new O(M.N);if(!a.n.write)throw new O(M.u);a.flags&1024&&Wb(a,0,2);var g=!0;if("undefined"===typeof f)f=a.position,g=!1;else if(!a.seekable)throw new O(M.da);b=a.n.write(a,b,c,d,f,h);g||(a.position+=b);try{a.path&&S.onWriteToFile&&S.onWriteToFile(a.path)}catch(k){}return b}function Yb(){O||(O=function(a,b){this.g=b,this.bb=function(a){this.Q=a;for(var b in M)if(M[b]===a){this.code=b;break}},this.bb(a),this.message=hb[a]},O.prototype=Error(),O.prototype.constructor=O,[M.B].forEach(function(a){vb[a]=new O(a),vb[a].stack="<generic error, no stack>"}))}var Zb;function $b(a,b){var c=0;a&&(c|=365);b&&(c|=146);return c}function ac(a,b,c,d){a=N(("string"===typeof a?a:U(a))+"/"+b);return Pb(a,$b(c,d))}function bc(a,b,c,d,f,h){a=b?N(("string"===typeof a?a:U(a))+"/"+b):a;d=$b(d,f);f=Pb(a,d);if(c){if("string"===typeof c){a=Array(c.length);b=0;for(var g=c.length;b<g;++b)a[b]=c.charCodeAt(b);c=a}Sb(f,d|146);a=Tb(f,"w");Xb(a,c,0,c.length,0,h);Vb(a);Sb(f,d)}return f}function W(a,b,c,d){a=N(("string"===typeof a?a:U(a))+"/"+b);b=$b(!!c,!!d);W.Da||(W.Da=64);var f=W.Da++<<8|0;pb(f,{open:function(a){a.seekable=!1},close:function(){d&&d.buffer&&d.buffer.length&&d(10)},read:function(a,b,d,f){for(var r=0,u=0;u<f;u++){var q;try{q=c()}catch(y){throw new O(M.F)}if(void 0===q&&0===r)throw new O(M.oa);if(null===q||void 0===q)break;r++;b[d+u]=q}r&&(a.g.timestamp=Date.now());return r},write:function(a,b,c,f){for(var r=0;r<f;r++)try{d(b[c+r])}catch(u){throw new O(M.F)}f&&(a.g.timestamp=Date.now());return r}});return Qb(a,b,f)}function cc(a){if(a.Ca||a.Xa||a.link||a.e)return!0;var b=!0;if("undefined"!==typeof XMLHttpRequest)throw Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(e.read)try{a.e=Va(e.read(a.url),!0),a.o=a.e.length}catch(c){b=!1}else throw Error("Cannot load without read() or XMLHttpRequest.");b||ib(M.F);return b}var dc={},Hb,Mb,Ub,ec=0;function X(){ec+=4;return F[ec-4>>2]}function fc(){var a;a=X();a=zb[a];if(!a)throw new O(M.Z);return a}function wa(a){wa.C||(v=Ga(),wa.C=!0,assert(n.P),wa.Ra=n.P,n.P=function(){z("cannot dynamically allocate, sbrk now has control")});var b=v;return 0==a||wa.Ra(a)?b:4294967295}e._memcpy=gc;function hc(a,b){ic=a;jc=b;if(!kc)return 1;if(0==a)Y=function(){setTimeout(lc,b)},mc="timeout";else if(1==a)Y=function(){nc(lc)},mc="rAF";else if(2==a){if(!window.setImmediate){var c=[];window.addEventListener("message",function(a){a.source===window&&"__emcc"===a.data&&(a.stopPropagation(),c.shift()())},!0);window.setImmediate=function(a){c.push(a),window.postMessage("__emcc","*")}}Y=function(){window.setImmediate(lc)};mc="immediate"}return 0}function oc(a,b,c,d,f){e.noExitRuntime=!0;assert(!kc,"emscripten_set_main_loop: there can only be one main loop function at once: call emscripten_cancel_main_loop to cancel the previous one before setting a new one with different parameters.");kc=a;pc=d;var h=qc;lc=function(){if(!A)if(0<rc.length){var b=Date.now(),c=rc.shift();c.Qa(c.T);if(sc){var f=sc,r=0==f%1?f-1:Math.floor(f);sc=c.ld?r:(8*f+(r+.5))/9}tc();setTimeout(lc,0)}else h<qc||(uc=uc+1|0,1==ic&&1<jc&&0!=uc%jc?Y():("timeout"===mc&&e.fa&&(e.S("Looks like you are rendering without using requestAnimationFrame for the main loop. You should use 0 for the frame rate in emscripten_set_main_loop in order to use requestAnimationFrame, as that can greatly improve your frame rates!"),mc=""),vc(function(){"undefined"!==typeof d?n.J("vi",a,[d]):n.J("v",a)}),h<qc||("object"===typeof SDL&&SDL.audio&&SDL.audio.Za&&SDL.audio.Za(),Y())))};f||(b&&0<b?hc(0,1e3/b):hc(1,1),Y());if(c)throw"SimulateInfiniteLoop"}var Y=null,mc="",qc=0,kc=null,pc=0,ic=0,jc=0,uc=0,rc=[];function tc(){if(e.setStatus){var a=e.statusMessage||"Please wait...",b=sc,c=wc.nd;b?b<c?e.setStatus(a+" ("+(c-b)+"/"+c+")"):e.setStatus(a):e.setStatus("")}}function vc(a){if(!(A||e.preMainLoop&&!1===e.preMainLoop())){try{a()}catch(b){if(b instanceof xc)return;b&&"object"===typeof b&&b.stack&&e.S("exception thrown: "+[b,b.stack]);throw b}e.postMainLoop&&e.postMainLoop()}}var wc={},lc,sc,yc=!1,zc=!1,Ac=[];function Bc(){function a(){zc=document.pointerLockElement===c||document.mozPointerLockElement===c||document.webkitPointerLockElement===c||document.msPointerLockElement===c}e.preloadPlugins||(e.preloadPlugins=[]);if(!Cc){Cc=!0;try{Dc=!0}catch(b){Dc=!1,!1}Ec="undefined"!=typeof MozBlobBuilder?MozBlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:Dc?null:!1;Fc="undefined"!=typeof window?window.URL?window.URL:window.webkitURL:void 0;e.Ha||"undefined"!==typeof Fc||(!1,e.Ha=!0);e.preloadPlugins.push({canHandle:function(a){return!e.Ha&&/\.(jpg|jpeg|png|bmp)$/i.test(a)},handle:function(a,b,c,g){var k=null;if(Dc)try{k=new Blob([a],{type:Gc(b)}),k.size!==a.length&&(k=new Blob([new Uint8Array(a).buffer],{type:Gc(b)}))}catch(t){n.M("Blob constructor present but fails: "+t+"; falling back to blob builder")}k||(k=new Ec,k.append(new Uint8Array(a).buffer),k=k.getBlob());var r=Fc.createObjectURL(k),u=new Image;u.onload=function(){assert(u.complete,"Image "+b+" could not be decoded");var g=document.createElement("canvas");g.width=u.width;g.height=u.height;g.getContext("2d").drawImage(u,0,0);e.preloadedImages[b]=g;Fc.revokeObjectURL(r);c&&c(a)};u.onerror=function(){g&&g()};u.src=r}});e.preloadPlugins.push({canHandle:function(a){return!e.zd&&a.substr(-4)in{".ogg":1,".wav":1,".mp3":1}},handle:function(a,b,c,g){function k(g){r||(r=!0,e.preloadedAudios[b]=g,c&&c(a))}function t(){r||(r=!0,e.preloadedAudios[b]=new Audio,g&&g())}var r=!1;if(Dc){try{var u=new Blob([a],{type:Gc(b)})}catch(q){return t()}var u=Fc.createObjectURL(u),y=new Audio;y.addEventListener("canplaythrough",function(){k(y)},!1);y.onerror=function(){if(!r){for(var c="",h=0,g=0,q=0;q<a.length;q++)for(h=h<<8|a[q],g+=8;6<=g;)var t=h>>g-6&63,g=g-6,c=c+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[t];2==g?(c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(h&3)<<4],c+="=="):4==g&&(c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(h&15)<<2],c+="=");y.src="data:audio/x-"+b.substr(-3)+";base64,"+c;k(y)}};y.src=u;Hc(function(){k(y)})}else return t()}});var c=e.canvas;c&&(c.la=c.requestPointerLock||c.mozRequestPointerLock||c.webkitRequestPointerLock||c.msRequestPointerLock||function(){},c.wa=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock||document.msExitPointerLock||function(){},c.wa=c.wa.bind(document),document.addEventListener("pointerlockchange",a,!1),document.addEventListener("mozpointerlockchange",a,!1),document.addEventListener("webkitpointerlockchange",a,!1),document.addEventListener("mspointerlockchange",a,!1),e.elementPointerLock&&c.addEventListener("click",function(a){!zc&&c.la&&(c.la(),a.preventDefault())},!1))}}function Ic(a,b,c,d){if(b&&e.fa&&a==e.canvas)return e.fa;var f,h;if(b){h={antialias:!1,alpha:!1};if(d)for(var g in d)h[g]=d[g];(h=GL.createContext(a,h))&&(f=GL.getContext(h).cd);a.style.backgroundColor="black"}else f=a.getContext("2d");if(!f)return null;c&&(b||assert("undefined"===typeof GLctx,"cannot set in module if GLctx is used, but we are a non-GL context that would replace it"),e.fa=f,b&&GL.yd(h),e.Dd=b,Ac.forEach(function(a){a()}),Bc());return f}var Jc=!1,Kc=void 0,Lc=void 0;function Mc(a,b,c){function d(){yc=!1;var a=f.parentNode;(document.webkitFullScreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.mozFullscreenElement||document.fullScreenElement||document.fullscreenElement||document.msFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement)===a?(f.ua=document.cancelFullScreen||document.mozCancelFullScreen||document.webkitCancelFullScreen||document.msExitFullscreen||document.exitFullscreen||function(){},f.ua=f.ua.bind(document),Kc&&f.la(),yc=!0,Lc&&Nc()):(a.parentNode.insertBefore(f,a),a.parentNode.removeChild(a),Lc&&Oc());e.onFullScreen&&e.onFullScreen(yc);Pc(f)}Kc=a;Lc=b;Qc=c;"undefined"===typeof Kc&&(Kc=!0);"undefined"===typeof Lc&&(Lc=!1);"undefined"===typeof Qc&&(Qc=null);var f=e.canvas;Jc||(Jc=!0,document.addEventListener("fullscreenchange",d,!1),document.addEventListener("mozfullscreenchange",d,!1),document.addEventListener("webkitfullscreenchange",d,!1),document.addEventListener("MSFullscreenChange",d,!1));var h=document.createElement("div");f.parentNode.insertBefore(h,f);h.appendChild(f);h.C=h.requestFullScreen||h.mozRequestFullScreen||h.msRequestFullscreen||(h.webkitRequestFullScreen?function(){h.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}:null);c?h.C({Ed:c}):h.C()}var Rc=0;function Sc(a){var b=Date.now();if(0===Rc)Rc=b+1e3/60;else for(;b+2>=Rc;)Rc+=1e3/60;b=Math.max(Rc-b,0);setTimeout(a,b)}function nc(a){"undefined"===typeof window?Sc(a):(window.requestAnimationFrame||(window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||Sc),window.requestAnimationFrame(a))}function Hc(a){e.noExitRuntime=!0,setTimeout(function(){A||a()},1e4)}function Gc(a){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",bmp:"image/bmp",ogg:"audio/ogg",wav:"audio/wav",mp3:"audio/mpeg"}[a.substr(a.lastIndexOf(".")+1)]}function Tc(a,b,c){var d=new XMLHttpRequest;d.open("GET",a,!0);d.responseType="arraybuffer";d.onload=function(){200==d.status||0==d.status&&d.response?b(d.response):c()};d.onerror=c;d.send(null)}function Uc(a,b,c){Tc(a,function(c){assert(c,'Loading data file "'+a+'" failed (no arrayBuffer).'),b(new Uint8Array(c)),Za()},function(){if(c)c();else throw'Loading data file "'+a+'" failed.'}),Ya()}var Vc=[];function Wc(){var a=e.canvas;Vc.forEach(function(b){b(a.width,a.height)})}function Nc(){if("undefined"!=typeof SDL){var a=Ia[SDL.screen+0*n.H>>2];F[SDL.screen+0*n.H>>2]=a|8388608}Wc()}function Oc(){if("undefined"!=typeof SDL){var a=Ia[SDL.screen+0*n.H>>2];F[SDL.screen+0*n.H>>2]=a&-8388609}Wc()}function Pc(a,b,c){b&&c?(a.fb=b,a.Va=c):(b=a.fb,c=a.Va);var d=b,f=c;e.forcedAspectRatio&&0<e.forcedAspectRatio&&(d/f<e.forcedAspectRatio?d=Math.round(f*e.forcedAspectRatio):f=Math.round(d/e.forcedAspectRatio));if((document.webkitFullScreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.mozFullscreenElement||document.fullScreenElement||document.fullscreenElement||document.msFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement)===a.parentNode&&"undefined"!=typeof screen)var h=Math.min(screen.width/d,screen.height/f),d=Math.round(d*h),f=Math.round(f*h);Lc?(a.width!=d&&(a.width=d),a.height!=f&&(a.height=f),"undefined"!=typeof a.style&&(a.style.removeProperty("width"),a.style.removeProperty("height"))):(a.width!=b&&(a.width=b),a.height!=c&&(a.height=c),"undefined"!=typeof a.style&&(d!=b||f!=c?(a.style.setProperty("width",d+"px","important"),a.style.setProperty("height",f+"px","important")):(a.style.removeProperty("width"),a.style.removeProperty("height"))))}var Cc,Dc,Ec,Fc,Qc;Yb();R=Array(4096);Nb(P,"/");V("/tmp");V("/home");V("/home/web_user");(function(){V("/dev");pb(259,{read:function(){return 0},write:function(a,b,f,h){return h}});Qb("/dev/null",259);ob(1280,rb);ob(1536,sb);Qb("/dev/tty",1280);Qb("/dev/tty1",1536);var a;if("undefined"!==typeof crypto){var b=new Uint8Array(1);a=function(){crypto.getRandomValues(b);return b[0]}}else a=function(){return 256*Math.random()|0};W("/dev","random",a);W("/dev","urandom",a);V("/dev/shm");V("/dev/shm/tmp")})();V("/proc");V("/proc/self");V("/proc/self/fd");Nb({A:function(){var a=ub("/proc/self","fd",16895,73);a.k={lookup:function(a,c){var d=zb[+c];if(!d)throw new O(M.Z);var f={parent:null,A:{Fa:"fake"},k:{readlink:function(){return d.path}}};return f.parent=f}};return a}},"/proc/self/fd");Qa.unshift(function(){if(!e.noFSInit&&!Zb){assert(!Zb,"FS.init was previously called. If you want to initialize later with custom parameters, remove any earlier calls (note that one is automatically added to the generated code)");Zb=!0;Yb();e.stdin=e.stdin;e.stdout=e.stdout;e.stderr=e.stderr;e.stdin?W("/dev","stdin",e.stdin):Rb("/dev/tty","/dev/stdin");e.stdout?W("/dev","stdout",null,e.stdout):Rb("/dev/tty","/dev/stdout");e.stderr?W("/dev","stderr",null,e.stderr):Rb("/dev/tty1","/dev/stderr");var a=Tb("/dev/stdin","r");assert(0===a.fd,"invalid handle for stdin ("+a.fd+")");a=Tb("/dev/stdout","w");assert(1===a.fd,"invalid handle for stdout ("+a.fd+")");a=Tb("/dev/stderr","w");assert(2===a.fd,"invalid handle for stderr ("+a.fd+")")}});Ra.push(function(){Cb=!1});K.push(function(){Zb=!1;var a=e._fflush;a&&a(0);for(a=0;a<zb.length;a++){var b=zb[a];b&&Vb(b)}});e.FS_createFolder=function(a,b,c,d){a=N(("string"===typeof a?a:U(a))+"/"+b);return V(a,$b(c,d))};e.FS_createPath=function(a,b){a="string"===typeof a?a:U(a);for(var c=b.split("/").reverse();c.length;){var d=c.pop();if(d){var f=N(a+"/"+d);try{V(f)}catch(h){}a=f}}return f};e.FS_createDataFile=bc;e.FS_createPreloadedFile=function(a,b,c,d,f,h,g,k,t,r){function u(c){function u(c){r&&r(),k||bc(a,b,c,d,f,t),h&&h(),Za()}var J=!1;e.preloadPlugins.forEach(function(a){!J&&a.canHandle(q)&&(a.handle(c,q,u,function(){g&&g(),Za()}),J=!0)});J||u(c)}Bc();var q=b?mb(N(a+"/"+b)):a;Ya();"string"==typeof c?Uc(c,function(a){u(a)},g):u(c)};e.FS_createLazyFile=function(a,b,c,d,f){if("undefined"!==typeof XMLHttpRequest)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";c={Ca:!1,url:c};var h=ac(a,b,d,f);c.e?h.e=c.e:c.url&&(h.e=null,h.url=c.url);Object.defineProperty(h,"usedBytes",{get:function(){return this.e.length}});var g={};Object.keys(h.n).forEach(function(a){var b=h.n[a];g[a]=function(){if(!cc(h))throw new O(M.F);return b.apply(null,arguments)}});g.read=function(a,b,c,d,f){if(!cc(h))throw new O(M.F);a=a.g.e;if(f>=a.length)return 0;d=Math.min(a.length-f,d);assert(0<=d);if(a.slice)for(var g=0;g<d;g++)b[c+g]=a[f+g];else for(g=0;g<d;g++)b[c+g]=a.get(f+g);return d};h.n=g;return h};e.FS_createLink=function(a,b,c){a=N(("string"===typeof a?a:U(a))+"/"+b);return Rb(c,a)};e.FS_createDevice=W;e.FS_unlink=function(a){var b=T(a,{parent:!0}).g,c=lb(a),d=wb(b,c),f;a:{try{f=wb(b,c)}catch(h){f=h.Q;break a}var g=Gb(b,"wx");f=g?g:16384===(f.mode&61440)?M.N:0}if(f)throw f===M.N&&(f=M.G),new O(f);if(!b.k.unlink)throw new O(M.G);if(d.R)throw new O(M.$);try{S.willDeletePath&&S.willDeletePath(a)}catch(k){}b.k.unlink(b,c);b=Eb(d.parent.id,d.name);if(R[b]===d)R[b]=d.K;else for(b=R[b];b;){if(b.K===d){b.K=d.K;break}b=b.K}try{S.onDeletePath&&S.onDeletePath(a)}catch(t){}};Qa.unshift(function(){});K.push(function(){});e.requestFullScreen=function(a,b,c){Mc(a,b,c)};e.requestAnimationFrame=function(a){nc(a)};e.setCanvasSize=function(a,b,c){Pc(e.canvas,a,b),c||Wc()};e.pauseMainLoop=function(){Y=null,qc++};e.resumeMainLoop=function(){qc++;var a=ic,b=jc,c=kc;kc=null;oc(c,0,!1,pc,!0);hc(a,b);Y()};e.getUserMedia=function(){window.C||(window.C=navigator.getUserMedia||navigator.mozGetUserMedia),window.C(void 0)};e.createContext=function(a,b,c,d){return Ic(a,b,c,d)};Ka=m=n.ea(p);va=!0;La=Ka+Na;Ma=v=n.ea(La);assert(Ma<w,"TOTAL_MEMORY not big enough for stack");var Xc=G([8,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,7,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0],"i8",3);e.Na={Math:Math,Int8Array:Int8Array,Int16Array:Int16Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:Infinity};e.Oa={abort:z,assert:assert,invoke_ii:function(a,b){try{return e.dynCall_ii(a,b)}catch(c){if("number"!==typeof c&&"longjmp"!==c)throw c;Z.setThrew(1,0)}},invoke_iiii:function(a,b,c,d){try{return e.dynCall_iiii(a,b,c,d)}catch(f){if("number"!==typeof f&&"longjmp"!==f)throw f;Z.setThrew(1,0)}},invoke_vi:function(a,b){try{e.dynCall_vi(a,b)}catch(c){if("number"!==typeof c&&"longjmp"!==c)throw c;Z.setThrew(1,0)}},_pthread_cleanup_pop:function(){assert(eb.level==K.length,"cannot pop if something else added meanwhile!"),K.pop(),eb.level=K.length},___lock:function(){},_emscripten_set_main_loop:oc,_pthread_self:function(){return 0},___syscall6:function(a,b){ec=b;try{var c=fc();Vb(c);return 0}catch(d){return"undefined"!==typeof dc&&d instanceof O||z(d),-d.Q}},_emscripten_set_main_loop_timing:hc,_abort:function(){e.abort()},_sbrk:wa,_time:function(a){var b=Date.now()/1e3|0;a&&(F[a>>2]=b);return b},___setErrNo:ib,_emscripten_memcpy_big:function(a,b,c){H.set(H.subarray(b,b+c),a);return a},___syscall54:function(a,b){ec=b;try{var c=fc(),d=X();switch(d){case 21505:return c.tty?0:-M.O;case 21506:return c.tty?0:-M.O;case 21519:if(!c.tty)return-M.O;var f=X();return F[f>>2]=0;case 21520:return c.tty?-M.u:-M.O;case 21531:f=X();if(!c.n.Wa)throw new O(M.O);return c.n.Wa(c,d,f);default:z("bad ioctl syscall "+d)}}catch(h){return"undefined"!==typeof dc&&h instanceof O||z(h),-h.Q}},___unlock:function(){},___syscall140:function(a,b){ec=b;try{var c=fc(),d=X(),f=X(),h=X(),g=X();assert(0===d);Wb(c,f,g);F[h>>2]=c.position;c.ia&&0===f&&0===g&&(c.ia=null);return 0}catch(k){return"undefined"!==typeof dc&&k instanceof O||z(k),-k.Q}},_pthread_cleanup_push:eb,_sysconf:function(a){switch(a){case 30:return 4096;case 85:return I/4096;case 132:case 133:case 12:case 137:case 138:case 15:case 235:case 16:case 17:case 18:case 19:case 20:case 149:case 13:case 10:case 236:case 153:case 9:case 21:case 22:case 159:case 154:case 14:case 77:case 78:case 139:case 80:case 81:case 82:case 68:case 67:case 164:case 11:case 29:case 47:case 48:case 95:case 52:case 51:case 46:return 200809;case 79:return 0;case 27:case 246:case 127:case 128:case 23:case 24:case 160:case 161:case 181:case 182:case 242:case 183:case 184:case 243:case 244:case 245:case 165:case 178:case 179:case 49:case 50:case 168:case 169:case 175:case 170:case 171:case 172:case 97:case 76:case 32:case 173:case 35:return-1;case 176:case 177:case 7:case 155:case 8:case 157:case 125:case 126:case 92:case 93:case 129:case 130:case 131:case 94:case 91:return 1;case 74:case 60:case 69:case 70:case 4:return 1024;case 31:case 42:case 72:return 32;case 87:case 26:case 33:return 2147483647;case 34:case 1:return 47839;case 38:case 36:return 99;case 43:case 37:return 2048;case 0:return 2097152;case 3:return 65536;case 28:return 32768;case 44:return 32767;case 75:return 16384;case 39:return 1e3;case 89:return 700;case 71:return 256;case 40:return 255;case 2:return 100;case 180:return 64;case 25:return 20;case 5:return 16;case 6:return 6;case 73:return 4;case 84:return"object"===typeof navigator?navigator.hardwareConcurrency||1:1}ib(M.u);return-1},___syscall146:function(a,b){ec=b;try{var c=fc(),d=X(),f;a:{for(var h=X(),g=0,k=0;k<h;k++){var t=Xb(c,D,F[d+8*k>>2],F[d+(8*k+4)>>2],void 0);if(0>t){f=-1;break a}g+=t}f=g}return f}catch(r){return"undefined"!==typeof dc&&r instanceof O||z(r),-r.Q}},STACKTOP:m,STACK_MAX:La,tempDoublePtr:$a,ABORT:A,cttz_i8:Xc};var Z=function(global,env,buffer){var a=new global.Int8Array(buffer),b=new global.Int16Array(buffer),c=new global.Int32Array(buffer),d=new global.Uint8Array(buffer),e=new global.Uint16Array(buffer),f=new global.Uint32Array(buffer),g=new global.Float32Array(buffer),h=new global.Float64Array(buffer),i=env.STACKTOP|0,j=env.STACK_MAX|0,k=env.tempDoublePtr|0,l=env.ABORT|0,m=env.cttz_i8|0,n=0,o=0,p=0,q=0,r=global.NaN,s=global.Infinity,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0,M=global.Math.floor,N=global.Math.abs,O=global.Math.sqrt,P=global.Math.pow,Q=global.Math.cos,R=global.Math.sin,S=global.Math.tan,T=global.Math.acos,U=global.Math.asin,V=global.Math.atan,W=global.Math.atan2,X=global.Math.exp,Y=global.Math.log,Z=global.Math.ceil,_=global.Math.imul,$=global.Math.min,aa=global.Math.clz32,ba=env.abort,ca=env.assert,da=env.invoke_ii,ea=env.invoke_iiii,fa=env.invoke_vi,ga=env._pthread_cleanup_pop,ha=env.___lock,ia=env._emscripten_set_main_loop,ja=env._pthread_self,ka=env.___syscall6,la=env._emscripten_set_main_loop_timing,ma=env._abort,na=env._sbrk,oa=env._time,pa=env.___setErrNo,qa=env._emscripten_memcpy_big,ra=env.___syscall54,sa=env.___unlock,ta=env.___syscall140,ua=env._pthread_cleanup_push,va=env._sysconf,wa=env.___syscall146,xa=0;function Ba(a){a=a|0;var b=0;b=i;i=i+a|0;i=i+15&-16;return b|0}function Ca(){return i|0}function Da(a){a=a|0,i=a}function Ea(a,b){a=a|0,b=b|0,i=a,j=b}function Fa(a,b){a=a|0,b=b|0,n||(n=a,o=b)}function Ga(b){b=b|0,a[k>>0]=a[b>>0],a[k+1>>0]=a[b+1>>0],a[k+2>>0]=a[b+2>>0],a[k+3>>0]=a[b+3>>0]}function Ha(b){b=b|0,a[k>>0]=a[b>>0],a[k+1>>0]=a[b+1>>0],a[k+2>>0]=a[b+2>>0],a[k+3>>0]=a[b+3>>0],a[k+4>>0]=a[b+4>>0],a[k+5>>0]=a[b+5>>0],a[k+6>>0]=a[b+6>>0],a[k+7>>0]=a[b+7>>0]}function Ia(a){a=a|0,C=a}function Ja(){return C|0}function Ka(b,e,f){b=b|0;e=e|0;f=f|0;var g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0,M=0,N=0,O=0,P=0,Q=0,R=0,S=0,T=0,U=0,V=0,W=0,X=0,Y=0,Z=0,$=0,aa=0,ba=0,ca=0,da=0,ea=0,fa=0,ga=0,ha=0,ia=0,ja=0,ka=0,la=0,ma=0,na=0,oa=0,pa=0,qa=0,ra=0,sa=0,ta=0,ua=0,va=0,wa=0,xa=0,ya=0,za=0,Aa=0,Ba=0,Ca=0,Da=0,Ea=0,Fa=0,Ga=0,Ha=0,Ia=0,Ja=0,Ka=0,Oa=0,Pa=0,Qa=0,Ra=0,Sa=0,Ta=0,Ua=0,Va=0,Wa=0,Xa=0,Ya=0,Za=0,_a=0,$a=0,gb=0,hb=0,ib=0,jb=0,kb=0,mb=0,nb=0,ob=0,pb=0,qb=0,rb=0,sb=0,tb=0,ub=0,vb=0,wb=0,xb=0,yb=0,zb=0,Ab=0,Bb=0,Cb=0,Db=0,Eb=0,Fb=0,Gb=0,Hb=0,Ib=0,Jb=0,Kb=0,Lb=0,Mb=0,Nb=0,Ob=0,Pb=0,Qb=0,Rb=0,Sb=0,Tb=0,Ub=0,Vb=0,Wb=0,Xb=0,Yb=0,Zb=0,_b=0,$b=0,ac=0,bc=0,cc=0,dc=0,ec=0,fc=0,gc=0,hc=0,ic=0,jc=0,kc=0,lc=0,mc=0,nc=0,oc=0,pc=0,qc=0,rc=0,sc=0,tc=0,uc=0,vc=0,wc=0,xc=0,yc=0,zc=0,Ac=0,Bc=0,Cc=0,Dc=0,Ec=0,Fc=0,Gc=0,Hc=0;g=i;i=i+2640|0;h=g+2456|0;j=g+2304|0;k=g+2152|0;l=g+2e3|0;m=g+1848|0;n=g+1696|0;o=g+1544|0;p=g+1392|0;q=g+1240|0;r=g+1088|0;s=g+936|0;t=g+784|0;u=g+632|0;v=g+480|0;w=g+328|0;x=g+248|0;y=g+168|0;z=g+80|0;A=g;B=g+2608|0;D=B;E=e;e=D+32|0;do a[D>>0]=a[E>>0]|0,D=D+1|0,E=E+1|0;while((D|0)<(e|0));a[B>>0]=(d[B>>0]|0)&248;F=B+31|0;a[F>>0]=(d[F>>0]|0)&63|64;F=d[f>>0]|0;G=fb(d[f+1>>0]|0|0,0,8)|0;H=C;I=fb(d[f+2>>0]|0|0,0,16)|0;J=H|C;H=d[f+3>>0]|0;K=fb(H|0,0,24)|0;L=x;c[L>>2]=G|F|I|K&50331648;c[L+4>>2]=J;J=fb(d[f+4>>0]|0|0,0,8)|0;L=C;K=fb(d[f+5>>0]|0|0,0,16)|0;I=L|C;L=d[f+6>>0]|0;F=fb(L|0,0,24)|0;G=eb(J|H|K|F|0,I|C|0,2)|0;I=x+8|0;c[I>>2]=G&33554431;c[I+4>>2]=0;I=fb(d[f+7>>0]|0|0,0,8)|0;G=C;F=fb(d[f+8>>0]|0|0,0,16)|0;K=G|C;G=d[f+9>>0]|0;H=fb(G|0,0,24)|0;J=eb(I|L|F|H|0,K|C|0,3)|0;K=x+16|0;c[K>>2]=J&67108863;c[K+4>>2]=0;K=fb(d[f+10>>0]|0|0,0,8)|0;J=C;H=fb(d[f+11>>0]|0|0,0,16)|0;F=J|C;J=d[f+12>>0]|0;L=fb(J|0,0,24)|0;I=eb(K|G|H|L|0,F|C|0,5)|0;F=x+24|0;c[F>>2]=I&33554431;c[F+4>>2]=0;F=fb(d[f+13>>0]|0|0,0,8)|0;I=C;L=fb(d[f+14>>0]|0|0,0,16)|0;H=I|C;I=fb(d[f+15>>0]|0|0,0,24)|0;G=eb(F|J|L|I|0,H|C|0,6)|0;H=x+32|0;c[H>>2]=G&67108863;c[H+4>>2]=0;H=d[f+16>>0]|0;G=fb(d[f+17>>0]|0|0,0,8)|0;I=C;L=fb(d[f+18>>0]|0|0,0,16)|0;J=I|C;I=d[f+19>>0]|0;F=fb(I|0,0,24)|0;K=x+40|0;c[K>>2]=G|H|L|F&16777216;c[K+4>>2]=J;J=fb(d[f+20>>0]|0|0,0,8)|0;K=C;F=fb(d[f+21>>0]|0|0,0,16)|0;L=K|C;K=d[f+22>>0]|0;H=fb(K|0,0,24)|0;G=eb(J|I|F|H|0,L|C|0,1)|0;L=x+48|0;c[L>>2]=G&67108863;c[L+4>>2]=0;L=fb(d[f+23>>0]|0|0,0,8)|0;G=C;H=fb(d[f+24>>0]|0|0,0,16)|0;F=G|C;G=d[f+25>>0]|0;I=fb(G|0,0,24)|0;J=eb(L|K|H|I|0,F|C|0,3)|0;F=x+56|0;c[F>>2]=J&33554431;c[F+4>>2]=0;F=fb(d[f+26>>0]|0|0,0,8)|0;J=C;I=fb(d[f+27>>0]|0|0,0,16)|0;H=J|C;J=d[f+28>>0]|0;K=fb(J|0,0,24)|0;L=eb(F|G|I|K|0,H|C|0,4)|0;H=x+64|0;c[H>>2]=L&67108863;c[H+4>>2]=0;H=fb(d[f+29>>0]|0|0,0,8)|0;L=C;K=fb(d[f+30>>0]|0|0,0,16)|0;I=L|C;L=fb(d[f+31>>0]|0|0,0,24)|0;f=eb(H|J|K|L|0,I|C|0,6)|0;I=x+72|0;c[I>>2]=f&33554431;c[I+4>>2]=0;db(q|0,0,152)|0;I=q;c[I>>2]=1;c[I+4>>2]=0;db(r|0,0,152)|0;I=r;c[I>>2]=1;c[I+4>>2]=0;db(s|0,0,152)|0;db(t|0,0,152)|0;db(u|0,0,152)|0;I=u;c[I>>2]=1;c[I+4>>2]=0;db(v|0,0,152)|0;db(w|0,0,152)|0;I=w;c[I>>2]=1;c[I+4>>2]=0;D=p+80|0;e=D+72|0;do c[D>>2]=0,D=D+4|0;while((D|0)<(e|0));D=p;E=x;e=D+80|0;do c[D>>2]=c[E>>2],D=D+4|0,E=E+4|0;while((D|0)<(e|0));I=l+144|0;f=l+64|0;L=l+136|0;K=l+56|0;J=l+128|0;H=l+48|0;G=l+120|0;F=l+40|0;M=l+112|0;N=l+32|0;O=l+104|0;P=l+24|0;Q=l+96|0;R=l+16|0;S=l+88|0;T=l+8|0;U=l+80|0;V=m+144|0;W=m+64|0;X=m+136|0;Y=m+56|0;Z=m+128|0;$=m+48|0;aa=m+120|0;ba=m+40|0;ca=m+112|0;da=m+32|0;ea=m+104|0;fa=m+24|0;ga=m+96|0;ha=m+16|0;ia=m+88|0;ja=m+8|0;ka=m+80|0;la=l+72|0;ma=m+72|0;na=j+8|0;oa=k+8|0;pa=j+16|0;qa=k+16|0;ra=j+24|0;sa=k+24|0;ta=j+32|0;ua=k+32|0;va=j+40|0;wa=k+40|0;xa=j+48|0;ya=k+48|0;za=j+56|0;Aa=k+56|0;Ba=j+64|0;Ca=k+64|0;Da=j+72|0;Ea=k+72|0;Fa=h+80|0;Ga=h+8|0;Ha=h+16|0;Ia=h+24|0;Ja=h+32|0;Ka=h+40|0;Oa=h+48|0;Pa=h+56|0;Qa=h+64|0;Ra=h+72|0;Sa=0;Ta=p;Ua=t;t=q;Va=u;u=r;Wa=v;v=s;s=w;while(1){w=a[B+(31-Sa)>>0]|0;Xa=0;Ya=Ta;Za=Ua;_a=t;$a=Va;gb=u;hb=Wa;ib=v;jb=s;while(1){kb=w&255;mb=bb(0,0,kb>>>7|0,0)|0;nb=C;ob=0;do pb=gb+(ob<<3)|0,qb=pb,rb=c[qb>>2]|0,sb=c[qb+4>>2]|0,qb=Ya+(ob<<3)|0,tb=qb,ub=c[tb>>2]|0,vb=c[tb+4>>2]|0,tb=(ub^rb)&mb,wb=(vb^sb)&nb,sb=ab(0,tb^rb|0,32)|0,rb=pb,c[rb>>2]=sb,c[rb+4>>2]=C,rb=ab(0,tb^ub|0,32)|0,ub=qb,c[ub>>2]=rb,c[ub+4>>2]=C,ob=ob+1|0;while((ob|0)!=10);xb=0;do ob=ib+(xb<<3)|0,ub=ob,rb=c[ub>>2]|0,qb=c[ub+4>>2]|0,ub=_a+(xb<<3)|0,tb=ub,sb=c[tb>>2]|0,pb=c[tb+4>>2]|0,tb=(sb^rb)&mb,vb=(pb^qb)&nb,qb=ab(0,tb^rb|0,32)|0,rb=ob,c[rb>>2]=qb,c[rb+4>>2]=C,rb=ab(0,tb^sb|0,32)|0,sb=ub,c[sb>>2]=rb,c[sb+4>>2]=C,xb=xb+1|0;while((xb|0)!=10);sb=gb;rb=c[sb>>2]|0;ub=c[sb+4>>2]|0;sb=gb+8|0;tb=sb;qb=c[tb>>2]|0;ob=c[tb+4>>2]|0;tb=gb+16|0;pb=tb;vb=c[pb>>2]|0;wb=c[pb+4>>2]|0;pb=gb+24|0;yb=pb;zb=c[yb>>2]|0;Ab=c[yb+4>>2]|0;yb=gb+32|0;Bb=yb;Cb=c[Bb>>2]|0;Db=c[Bb+4>>2]|0;Bb=gb+40|0;Eb=Bb;Fb=c[Eb>>2]|0;Gb=c[Eb+4>>2]|0;Eb=gb+48|0;Hb=Eb;Ib=c[Hb>>2]|0;Jb=c[Hb+4>>2]|0;Hb=gb+56|0;Kb=Hb;Lb=c[Kb>>2]|0;Mb=c[Kb+4>>2]|0;Kb=gb+64|0;Nb=Kb;Ob=c[Nb>>2]|0;Pb=c[Nb+4>>2]|0;Nb=gb+72|0;Qb=Nb;Rb=c[Qb>>2]|0;Sb=c[Qb+4>>2]|0;Qb=ib;Tb=c[Qb>>2]|0;Ub=c[Qb+4>>2]|0;Qb=cb(Tb|0,Ub|0,rb|0,ub|0)|0;Vb=gb;c[Vb>>2]=Qb;c[Vb+4>>2]=C;Vb=ib+8|0;Qb=Vb;Wb=c[Qb>>2]|0;Xb=c[Qb+4>>2]|0;Qb=cb(Wb|0,Xb|0,qb|0,ob|0)|0;Yb=sb;c[Yb>>2]=Qb;c[Yb+4>>2]=C;Yb=ib+16|0;Qb=Yb;sb=c[Qb>>2]|0;Zb=c[Qb+4>>2]|0;Qb=cb(sb|0,Zb|0,vb|0,wb|0)|0;_b=tb;c[_b>>2]=Qb;c[_b+4>>2]=C;_b=ib+24|0;Qb=_b;tb=c[Qb>>2]|0;$b=c[Qb+4>>2]|0;Qb=cb(tb|0,$b|0,zb|0,Ab|0)|0;ac=pb;c[ac>>2]=Qb;c[ac+4>>2]=C;ac=ib+32|0;Qb=ac;pb=c[Qb>>2]|0;bc=c[Qb+4>>2]|0;Qb=cb(pb|0,bc|0,Cb|0,Db|0)|0;cc=yb;c[cc>>2]=Qb;c[cc+4>>2]=C;cc=ib+40|0;Qb=cc;yb=c[Qb>>2]|0;dc=c[Qb+4>>2]|0;Qb=cb(yb|0,dc|0,Fb|0,Gb|0)|0;ec=Bb;c[ec>>2]=Qb;c[ec+4>>2]=C;ec=ib+48|0;Qb=ec;Bb=c[Qb>>2]|0;fc=c[Qb+4>>2]|0;Qb=cb(Bb|0,fc|0,Ib|0,Jb|0)|0;gc=Eb;c[gc>>2]=Qb;c[gc+4>>2]=C;gc=ib+56|0;Qb=gc;Eb=c[Qb>>2]|0;hc=c[Qb+4>>2]|0;Qb=cb(Eb|0,hc|0,Lb|0,Mb|0)|0;ic=Hb;c[ic>>2]=Qb;c[ic+4>>2]=C;ic=ib+64|0;Qb=ic;Hb=c[Qb>>2]|0;jc=c[Qb+4>>2]|0;Qb=cb(Hb|0,jc|0,Ob|0,Pb|0)|0;kc=Kb;c[kc>>2]=Qb;c[kc+4>>2]=C;kc=ib+72|0;Qb=kc;Kb=c[Qb>>2]|0;lc=c[Qb+4>>2]|0;Qb=cb(Kb|0,lc|0,Rb|0,Sb|0)|0;mc=Nb;c[mc>>2]=Qb;c[mc+4>>2]=C;mc=bb(rb|0,ub|0,Tb|0,Ub|0)|0;Ub=ib;c[Ub>>2]=mc;c[Ub+4>>2]=C;Ub=bb(qb|0,ob|0,Wb|0,Xb|0)|0;Xb=Vb;c[Xb>>2]=Ub;c[Xb+4>>2]=C;Xb=bb(vb|0,wb|0,sb|0,Zb|0)|0;Zb=Yb;c[Zb>>2]=Xb;c[Zb+4>>2]=C;Zb=bb(zb|0,Ab|0,tb|0,$b|0)|0;$b=_b;c[$b>>2]=Zb;c[$b+4>>2]=C;$b=bb(Cb|0,Db|0,pb|0,bc|0)|0;bc=ac;c[bc>>2]=$b;c[bc+4>>2]=C;bc=bb(Fb|0,Gb|0,yb|0,dc|0)|0;dc=cc;c[dc>>2]=bc;c[dc+4>>2]=C;dc=bb(Ib|0,Jb|0,Bb|0,fc|0)|0;fc=ec;c[fc>>2]=dc;c[fc+4>>2]=C;fc=bb(Lb|0,Mb|0,Eb|0,hc|0)|0;hc=gc;c[hc>>2]=fc;c[hc+4>>2]=C;hc=bb(Ob|0,Pb|0,Hb|0,jc|0)|0;jc=ic;c[jc>>2]=hc;c[jc+4>>2]=C;jc=bb(Rb|0,Sb|0,Kb|0,lc|0)|0;lc=kc;c[lc>>2]=jc;c[lc+4>>2]=C;lc=Ya;jc=c[lc>>2]|0;kc=c[lc+4>>2]|0;lc=Ya+8|0;Kb=lc;Sb=c[Kb>>2]|0;Rb=c[Kb+4>>2]|0;Kb=Ya+16|0;hc=Kb;ic=c[hc>>2]|0;Hb=c[hc+4>>2]|0;hc=Ya+24|0;Pb=hc;Ob=c[Pb>>2]|0;fc=c[Pb+4>>2]|0;Pb=Ya+32|0;gc=Pb;Eb=c[gc>>2]|0;Mb=c[gc+4>>2]|0;gc=Ya+40|0;Lb=gc;dc=c[Lb>>2]|0;ec=c[Lb+4>>2]|0;Lb=Ya+48|0;Bb=Lb;Jb=c[Bb>>2]|0;Ib=c[Bb+4>>2]|0;Bb=Ya+56|0;bc=Bb;cc=c[bc>>2]|0;yb=c[bc+4>>2]|0;bc=Ya+64|0;Gb=bc;Fb=c[Gb>>2]|0;$b=c[Gb+4>>2]|0;Gb=Ya+72|0;ac=Gb;pb=c[ac>>2]|0;Db=c[ac+4>>2]|0;ac=_a;Cb=c[ac>>2]|0;Zb=c[ac+4>>2]|0;ac=cb(Cb|0,Zb|0,jc|0,kc|0)|0;_b=Ya;c[_b>>2]=ac;c[_b+4>>2]=C;_b=_a+8|0;ac=_b;tb=c[ac>>2]|0;Ab=c[ac+4>>2]|0;ac=cb(tb|0,Ab|0,Sb|0,Rb|0)|0;zb=lc;c[zb>>2]=ac;c[zb+4>>2]=C;zb=_a+16|0;ac=zb;lc=c[ac>>2]|0;Xb=c[ac+4>>2]|0;ac=cb(lc|0,Xb|0,ic|0,Hb|0)|0;Yb=Kb;c[Yb>>2]=ac;c[Yb+4>>2]=C;Yb=_a+24|0;ac=Yb;Kb=c[ac>>2]|0;sb=c[ac+4>>2]|0;ac=cb(Kb|0,sb|0,Ob|0,fc|0)|0;wb=hc;c[wb>>2]=ac;c[wb+4>>2]=C;wb=_a+32|0;ac=wb;hc=c[ac>>2]|0;vb=c[ac+4>>2]|0;ac=cb(hc|0,vb|0,Eb|0,Mb|0)|0;Ub=Pb;c[Ub>>2]=ac;c[Ub+4>>2]=C;Ub=_a+40|0;ac=Ub;Pb=c[ac>>2]|0;Vb=c[ac+4>>2]|0;ac=cb(Pb|0,Vb|0,dc|0,ec|0)|0;Wb=gc;c[Wb>>2]=ac;c[Wb+4>>2]=C;Wb=_a+48|0;ac=Wb;gc=c[ac>>2]|0;ob=c[ac+4>>2]|0;ac=cb(gc|0,ob|0,Jb|0,Ib|0)|0;qb=Lb;c[qb>>2]=ac;c[qb+4>>2]=C;qb=_a+56|0;ac=qb;Lb=c[ac>>2]|0;mc=c[ac+4>>2]|0;ac=cb(Lb|0,mc|0,cc|0,yb|0)|0;Tb=Bb;c[Tb>>2]=ac;c[Tb+4>>2]=C;Tb=_a+64|0;ac=Tb;Bb=c[ac>>2]|0;ub=c[ac+4>>2]|0;ac=cb(Bb|0,ub|0,Fb|0,$b|0)|0;rb=bc;c[rb>>2]=ac;c[rb+4>>2]=C;rb=_a+72|0;ac=rb;bc=c[ac>>2]|0;Qb=c[ac+4>>2]|0;ac=cb(bc|0,Qb|0,pb|0,Db|0)|0;Nb=Gb;c[Nb>>2]=ac;c[Nb+4>>2]=C;Nb=bb(jc|0,kc|0,Cb|0,Zb|0)|0;Zb=_a;c[Zb>>2]=Nb;c[Zb+4>>2]=C;Zb=bb(Sb|0,Rb|0,tb|0,Ab|0)|0;Ab=_b;c[Ab>>2]=Zb;c[Ab+4>>2]=C;Ab=bb(ic|0,Hb|0,lc|0,Xb|0)|0;Xb=zb;c[Xb>>2]=Ab;c[Xb+4>>2]=C;Xb=bb(Ob|0,fc|0,Kb|0,sb|0)|0;sb=Yb;c[sb>>2]=Xb;c[sb+4>>2]=C;sb=bb(Eb|0,Mb|0,hc|0,vb|0)|0;vb=wb;c[vb>>2]=sb;c[vb+4>>2]=C;vb=bb(dc|0,ec|0,Pb|0,Vb|0)|0;Vb=Ub;c[Vb>>2]=vb;c[Vb+4>>2]=C;Vb=bb(Jb|0,Ib|0,gc|0,ob|0)|0;ob=Wb;c[ob>>2]=Vb;c[ob+4>>2]=C;ob=bb(cc|0,yb|0,Lb|0,mc|0)|0;mc=qb;c[mc>>2]=ob;c[mc+4>>2]=C;mc=bb(Fb|0,$b|0,Bb|0,ub|0)|0;ub=Tb;c[ub>>2]=mc;c[ub+4>>2]=C;ub=bb(pb|0,Db|0,bc|0,Qb|0)|0;Qb=rb;c[Qb>>2]=ub;c[Qb+4>>2]=C;Ma(l,Ya,ib);Ma(m,gb,_a);Qb=I;ub=c[Qb>>2]|0;rb=c[Qb+4>>2]|0;Qb=f;bc=c[Qb>>2]|0;Db=c[Qb+4>>2]|0;Qb=lb(ub|0,rb|0,18,0)|0;pb=C;mc=cb(bc|0,Db|0,ub|0,rb|0)|0;rb=cb(mc|0,C|0,Qb|0,pb|0)|0;pb=f;c[pb>>2]=rb;c[pb+4>>2]=C;pb=L;rb=c[pb>>2]|0;Qb=c[pb+4>>2]|0;pb=K;mc=c[pb>>2]|0;ub=c[pb+4>>2]|0;pb=lb(rb|0,Qb|0,18,0)|0;Db=C;bc=cb(mc|0,ub|0,rb|0,Qb|0)|0;Qb=cb(bc|0,C|0,pb|0,Db|0)|0;Db=K;c[Db>>2]=Qb;c[Db+4>>2]=C;Db=J;Qb=c[Db>>2]|0;pb=c[Db+4>>2]|0;Db=H;bc=c[Db>>2]|0;rb=c[Db+4>>2]|0;Db=lb(Qb|0,pb|0,18,0)|0;ub=C;mc=cb(bc|0,rb|0,Qb|0,pb|0)|0;pb=cb(mc|0,C|0,Db|0,ub|0)|0;ub=H;c[ub>>2]=pb;c[ub+4>>2]=C;ub=G;pb=c[ub>>2]|0;Db=c[ub+4>>2]|0;ub=F;mc=c[ub>>2]|0;Qb=c[ub+4>>2]|0;ub=lb(pb|0,Db|0,18,0)|0;rb=C;bc=cb(mc|0,Qb|0,pb|0,Db|0)|0;Db=cb(bc|0,C|0,ub|0,rb|0)|0;rb=F;c[rb>>2]=Db;c[rb+4>>2]=C;rb=M;Db=c[rb>>2]|0;ub=c[rb+4>>2]|0;rb=N;bc=c[rb>>2]|0;pb=c[rb+4>>2]|0;rb=lb(Db|0,ub|0,18,0)|0;Qb=C;mc=cb(bc|0,pb|0,Db|0,ub|0)|0;ub=cb(mc|0,C|0,rb|0,Qb|0)|0;Qb=N;c[Qb>>2]=ub;c[Qb+4>>2]=C;Qb=O;ub=c[Qb>>2]|0;rb=c[Qb+4>>2]|0;Qb=P;mc=c[Qb>>2]|0;Db=c[Qb+4>>2]|0;Qb=lb(ub|0,rb|0,18,0)|0;pb=C;bc=cb(mc|0,Db|0,ub|0,rb|0)|0;rb=cb(bc|0,C|0,Qb|0,pb|0)|0;pb=P;c[pb>>2]=rb;c[pb+4>>2]=C;pb=Q;rb=c[pb>>2]|0;Qb=c[pb+4>>2]|0;pb=R;bc=c[pb>>2]|0;ub=c[pb+4>>2]|0;pb=lb(rb|0,Qb|0,18,0)|0;Db=C;mc=cb(bc|0,ub|0,rb|0,Qb|0)|0;Qb=cb(mc|0,C|0,pb|0,Db|0)|0;Db=R;c[Db>>2]=Qb;c[Db+4>>2]=C;Db=S;Qb=c[Db>>2]|0;pb=c[Db+4>>2]|0;Db=T;mc=c[Db>>2]|0;rb=c[Db+4>>2]|0;Db=lb(Qb|0,pb|0,18,0)|0;ub=C;bc=cb(mc|0,rb|0,Qb|0,pb|0)|0;pb=cb(bc|0,C|0,Db|0,ub|0)|0;ub=T;c[ub>>2]=pb;c[ub+4>>2]=C;ub=U;pb=c[ub>>2]|0;Db=c[ub+4>>2]|0;ub=l;bc=c[ub>>2]|0;Qb=c[ub+4>>2]|0;ub=lb(pb|0,Db|0,18,0)|0;rb=C;mc=cb(bc|0,Qb|0,pb|0,Db|0)|0;Db=cb(mc|0,C|0,ub|0,rb|0)|0;rb=C;ub=l;c[ub>>2]=Db;c[ub+4>>2]=rb;ub=U;c[ub>>2]=0;c[ub+4>>2]=0;ub=rb;rb=Db;Db=0;do mc=cb(ub>>31>>>6|0,0,rb|0,ub|0)|0,pb=ab(mc|0,C|0,26)|0,mc=C,Qb=fb(pb|0,mc|0,26)|0,bc=bb(rb|0,ub|0,Qb|0,C|0)|0,Qb=l+(Db<<3)|0,c[Qb>>2]=bc,c[Qb+4>>2]=C,Qb=l+((Db|1)<<3)|0,bc=Qb,Tb=cb(pb|0,mc|0,c[bc>>2]|0,c[bc+4>>2]|0)|0,bc=C,mc=cb(bc>>31>>>7|0,0,Tb|0,bc|0)|0,pb=ab(mc|0,C|0,25)|0,mc=C,Bb=fb(pb|0,mc|0,25)|0,$b=bb(Tb|0,bc|0,Bb|0,C|0)|0,Bb=Qb,c[Bb>>2]=$b,c[Bb+4>>2]=C,Db=Db+2|0,Bb=l+(Db<<3)|0,$b=Bb,rb=cb(pb|0,mc|0,c[$b>>2]|0,c[$b+4>>2]|0)|0,ub=C,$b=Bb,c[$b>>2]=rb,c[$b+4>>2]=ub;while(Db>>>0<10);Db=U;ub=c[Db>>2]|0;rb=c[Db+4>>2]|0;Db=l;$b=c[Db>>2]|0;Bb=c[Db+4>>2]|0;Db=lb(ub|0,rb|0,18,0)|0;mc=C;pb=cb($b|0,Bb|0,ub|0,rb|0)|0;rb=cb(pb|0,C|0,Db|0,mc|0)|0;mc=C;Db=U;c[Db>>2]=0;c[Db+4>>2]=0;Db=cb(mc>>31>>>6|0,0,rb|0,mc|0)|0;pb=ab(Db|0,C|0,26)|0;Db=C;ub=fb(pb|0,Db|0,26)|0;Bb=bb(rb|0,mc|0,ub|0,C|0)|0;ub=C;mc=l;c[mc>>2]=Bb;c[mc+4>>2]=ub;mc=T;rb=cb(pb|0,Db|0,c[mc>>2]|0,c[mc+4>>2]|0)|0;mc=C;Db=T;c[Db>>2]=rb;c[Db+4>>2]=mc;Db=V;pb=c[Db>>2]|0;$b=c[Db+4>>2]|0;Db=W;Qb=c[Db>>2]|0;bc=c[Db+4>>2]|0;Db=lb(pb|0,$b|0,18,0)|0;Tb=C;Fb=cb(Qb|0,bc|0,pb|0,$b|0)|0;$b=cb(Fb|0,C|0,Db|0,Tb|0)|0;Tb=W;c[Tb>>2]=$b;c[Tb+4>>2]=C;Tb=X;$b=c[Tb>>2]|0;Db=c[Tb+4>>2]|0;Tb=Y;Fb=c[Tb>>2]|0;pb=c[Tb+4>>2]|0;Tb=lb($b|0,Db|0,18,0)|0;bc=C;Qb=cb(Fb|0,pb|0,$b|0,Db|0)|0;Db=cb(Qb|0,C|0,Tb|0,bc|0)|0;bc=Y;c[bc>>2]=Db;c[bc+4>>2]=C;bc=Z;Db=c[bc>>2]|0;Tb=c[bc+4>>2]|0;bc=$;Qb=c[bc>>2]|0;$b=c[bc+4>>2]|0;bc=lb(Db|0,Tb|0,18,0)|0;pb=C;Fb=cb(Qb|0,$b|0,Db|0,Tb|0)|0;Tb=cb(Fb|0,C|0,bc|0,pb|0)|0;pb=$;c[pb>>2]=Tb;c[pb+4>>2]=C;pb=aa;Tb=c[pb>>2]|0;bc=c[pb+4>>2]|0;pb=ba;Fb=c[pb>>2]|0;Db=c[pb+4>>2]|0;pb=lb(Tb|0,bc|0,18,0)|0;$b=C;Qb=cb(Fb|0,Db|0,Tb|0,bc|0)|0;bc=cb(Qb|0,C|0,pb|0,$b|0)|0;$b=ba;c[$b>>2]=bc;c[$b+4>>2]=C;$b=ca;bc=c[$b>>2]|0;pb=c[$b+4>>2]|0;$b=da;Qb=c[$b>>2]|0;Tb=c[$b+4>>2]|0;$b=lb(bc|0,pb|0,18,0)|0;Db=C;Fb=cb(Qb|0,Tb|0,bc|0,pb|0)|0;pb=cb(Fb|0,C|0,$b|0,Db|0)|0;Db=da;c[Db>>2]=pb;c[Db+4>>2]=C;Db=ea;pb=c[Db>>2]|0;$b=c[Db+4>>2]|0;Db=fa;Fb=c[Db>>2]|0;bc=c[Db+4>>2]|0;Db=lb(pb|0,$b|0,18,0)|0;Tb=C;Qb=cb(Fb|0,bc|0,pb|0,$b|0)|0;$b=cb(Qb|0,C|0,Db|0,Tb|0)|0;Tb=fa;c[Tb>>2]=$b;c[Tb+4>>2]=C;Tb=ga;$b=c[Tb>>2]|0;Db=c[Tb+4>>2]|0;Tb=ha;Qb=c[Tb>>2]|0;pb=c[Tb+4>>2]|0;Tb=lb($b|0,Db|0,18,0)|0;bc=C;Fb=cb(Qb|0,pb|0,$b|0,Db|0)|0;Db=cb(Fb|0,C|0,Tb|0,bc|0)|0;bc=ha;c[bc>>2]=Db;c[bc+4>>2]=C;bc=ia;Db=c[bc>>2]|0;Tb=c[bc+4>>2]|0;bc=ja;Fb=c[bc>>2]|0;$b=c[bc+4>>2]|0;bc=lb(Db|0,Tb|0,18,0)|0;pb=C;Qb=cb(Fb|0,$b|0,Db|0,Tb|0)|0;Tb=cb(Qb|0,C|0,bc|0,pb|0)|0;pb=ja;c[pb>>2]=Tb;c[pb+4>>2]=C;pb=ka;Tb=c[pb>>2]|0;bc=c[pb+4>>2]|0;pb=m;Qb=c[pb>>2]|0;Db=c[pb+4>>2]|0;pb=lb(Tb|0,bc|0,18,0)|0;$b=C;Fb=cb(Qb|0,Db|0,Tb|0,bc|0)|0;bc=cb(Fb|0,C|0,pb|0,$b|0)|0;$b=C;pb=m;c[pb>>2]=bc;c[pb+4>>2]=$b;pb=ka;c[pb>>2]=0;c[pb+4>>2]=0;pb=$b;$b=bc;bc=0;do Fb=cb(pb>>31>>>6|0,0,$b|0,pb|0)|0,Tb=ab(Fb|0,C|0,26)|0,Fb=C,Db=fb(Tb|0,Fb|0,26)|0,Qb=bb($b|0,pb|0,Db|0,C|0)|0,Db=m+(bc<<3)|0,c[Db>>2]=Qb,c[Db+4>>2]=C,Db=m+((bc|1)<<3)|0,Qb=Db,ob=cb(Tb|0,Fb|0,c[Qb>>2]|0,c[Qb+4>>2]|0)|0,Qb=C,Fb=cb(Qb>>31>>>7|0,0,ob|0,Qb|0)|0,Tb=ab(Fb|0,C|0,25)|0,Fb=C,qb=fb(Tb|0,Fb|0,25)|0,Lb=bb(ob|0,Qb|0,qb|0,C|0)|0,qb=Db,c[qb>>2]=Lb,c[qb+4>>2]=C,bc=bc+2|0,qb=m+(bc<<3)|0,Lb=qb,$b=cb(Tb|0,Fb|0,c[Lb>>2]|0,c[Lb+4>>2]|0)|0,pb=C,Lb=qb,c[Lb>>2]=$b,c[Lb+4>>2]=pb;while(bc>>>0<10);bc=ka;pb=c[bc>>2]|0;$b=c[bc+4>>2]|0;bc=m;Lb=c[bc>>2]|0;qb=c[bc+4>>2]|0;bc=lb(pb|0,$b|0,18,0)|0;Fb=C;Tb=cb(Lb|0,qb|0,pb|0,$b|0)|0;$b=cb(Tb|0,C|0,bc|0,Fb|0)|0;Fb=C;bc=ka;c[bc>>2]=0;c[bc+4>>2]=0;bc=cb(Fb>>31>>>6|0,0,$b|0,Fb|0)|0;Tb=ab(bc|0,C|0,26)|0;bc=C;pb=fb(Tb|0,bc|0,26)|0;qb=bb($b|0,Fb|0,pb|0,C|0)|0;pb=C;Fb=ja;$b=cb(Tb|0,bc|0,c[Fb>>2]|0,c[Fb+4>>2]|0)|0;Fb=C;bc=R;Tb=c[bc>>2]|0;Lb=c[bc+4>>2]|0;bc=P;Db=c[bc>>2]|0;Qb=c[bc+4>>2]|0;bc=N;ob=c[bc>>2]|0;yb=c[bc+4>>2]|0;bc=F;cc=c[bc>>2]|0;Vb=c[bc+4>>2]|0;bc=H;Wb=c[bc>>2]|0;gc=c[bc+4>>2]|0;bc=K;Ib=c[bc>>2]|0;Jb=c[bc+4>>2]|0;bc=f;vb=c[bc>>2]|0;Ub=c[bc+4>>2]|0;bc=la;Pb=c[bc>>2]|0;ec=c[bc+4>>2]|0;bc=cb(qb|0,pb|0,Bb|0,ub|0)|0;dc=l;c[dc>>2]=bc;c[dc+4>>2]=C;dc=cb($b|0,Fb|0,rb|0,mc|0)|0;bc=T;c[bc>>2]=dc;c[bc+4>>2]=C;bc=ha;dc=c[bc>>2]|0;sb=c[bc+4>>2]|0;bc=cb(dc|0,sb|0,Tb|0,Lb|0)|0;wb=R;c[wb>>2]=bc;c[wb+4>>2]=C;wb=fa;bc=c[wb>>2]|0;hc=c[wb+4>>2]|0;wb=cb(bc|0,hc|0,Db|0,Qb|0)|0;Mb=P;c[Mb>>2]=wb;c[Mb+4>>2]=C;Mb=da;wb=c[Mb>>2]|0;Eb=c[Mb+4>>2]|0;Mb=cb(wb|0,Eb|0,ob|0,yb|0)|0;Xb=N;c[Xb>>2]=Mb;c[Xb+4>>2]=C;Xb=ba;Mb=c[Xb>>2]|0;Yb=c[Xb+4>>2]|0;Xb=cb(Mb|0,Yb|0,cc|0,Vb|0)|0;Kb=F;c[Kb>>2]=Xb;c[Kb+4>>2]=C;Kb=$;Xb=c[Kb>>2]|0;fc=c[Kb+4>>2]|0;Kb=cb(Xb|0,fc|0,Wb|0,gc|0)|0;Ob=H;c[Ob>>2]=Kb;c[Ob+4>>2]=C;Ob=Y;Kb=c[Ob>>2]|0;Ab=c[Ob+4>>2]|0;Ob=cb(Kb|0,Ab|0,Ib|0,Jb|0)|0;zb=K;c[zb>>2]=Ob;c[zb+4>>2]=C;zb=W;Ob=c[zb>>2]|0;lc=c[zb+4>>2]|0;zb=cb(Ob|0,lc|0,vb|0,Ub|0)|0;Hb=f;c[Hb>>2]=zb;c[Hb+4>>2]=C;Hb=ma;zb=c[Hb>>2]|0;ic=c[Hb+4>>2]|0;Hb=cb(zb|0,ic|0,Pb|0,ec|0)|0;Zb=la;c[Zb>>2]=Hb;c[Zb+4>>2]=C;Zb=bb(Bb|0,ub|0,qb|0,pb|0)|0;pb=m;c[pb>>2]=Zb;c[pb+4>>2]=C;pb=bb(rb|0,mc|0,$b|0,Fb|0)|0;Fb=ja;c[Fb>>2]=pb;c[Fb+4>>2]=C;Fb=bb(Tb|0,Lb|0,dc|0,sb|0)|0;sb=ha;c[sb>>2]=Fb;c[sb+4>>2]=C;sb=bb(Db|0,Qb|0,bc|0,hc|0)|0;hc=fa;c[hc>>2]=sb;c[hc+4>>2]=C;hc=bb(ob|0,yb|0,wb|0,Eb|0)|0;Eb=da;c[Eb>>2]=hc;c[Eb+4>>2]=C;Eb=bb(cc|0,Vb|0,Mb|0,Yb|0)|0;Yb=ba;c[Yb>>2]=Eb;c[Yb+4>>2]=C;Yb=bb(Wb|0,gc|0,Xb|0,fc|0)|0;fc=$;c[fc>>2]=Yb;c[fc+4>>2]=C;fc=bb(Ib|0,Jb|0,Kb|0,Ab|0)|0;Ab=Y;c[Ab>>2]=fc;c[Ab+4>>2]=C;Ab=bb(vb|0,Ub|0,Ob|0,lc|0)|0;lc=W;c[lc>>2]=Ab;c[lc+4>>2]=C;lc=bb(Pb|0,ec|0,zb|0,ic|0)|0;ic=ma;c[ic>>2]=lc;c[ic+4>>2]=C;Na(o,l);Na(n,m);Ma(m,n,x);ic=V;lc=c[ic>>2]|0;zb=c[ic+4>>2]|0;ic=W;ec=c[ic>>2]|0;Pb=c[ic+4>>2]|0;ic=lb(lc|0,zb|0,18,0)|0;Ab=C;Ob=cb(ec|0,Pb|0,lc|0,zb|0)|0;zb=cb(Ob|0,C|0,ic|0,Ab|0)|0;Ab=W;c[Ab>>2]=zb;c[Ab+4>>2]=C;Ab=X;zb=c[Ab>>2]|0;ic=c[Ab+4>>2]|0;Ab=Y;Ob=c[Ab>>2]|0;lc=c[Ab+4>>2]|0;Ab=lb(zb|0,ic|0,18,0)|0;Pb=C;ec=cb(Ob|0,lc|0,zb|0,ic|0)|0;ic=cb(ec|0,C|0,Ab|0,Pb|0)|0;Pb=Y;c[Pb>>2]=ic;c[Pb+4>>2]=C;Pb=Z;ic=c[Pb>>2]|0;Ab=c[Pb+4>>2]|0;Pb=$;ec=c[Pb>>2]|0;zb=c[Pb+4>>2]|0;Pb=lb(ic|0,Ab|0,18,0)|0;lc=C;Ob=cb(ec|0,zb|0,ic|0,Ab|0)|0;Ab=cb(Ob|0,C|0,Pb|0,lc|0)|0;lc=$;c[lc>>2]=Ab;c[lc+4>>2]=C;lc=aa;Ab=c[lc>>2]|0;Pb=c[lc+4>>2]|0;lc=ba;Ob=c[lc>>2]|0;ic=c[lc+4>>2]|0;lc=lb(Ab|0,Pb|0,18,0)|0;zb=C;ec=cb(Ob|0,ic|0,Ab|0,Pb|0)|0;Pb=cb(ec|0,C|0,lc|0,zb|0)|0;zb=ba;c[zb>>2]=Pb;c[zb+4>>2]=C;zb=ca;Pb=c[zb>>2]|0;lc=c[zb+4>>2]|0;zb=da;ec=c[zb>>2]|0;Ab=c[zb+4>>2]|0;zb=lb(Pb|0,lc|0,18,0)|0;ic=C;Ob=cb(ec|0,Ab|0,Pb|0,lc|0)|0;lc=cb(Ob|0,C|0,zb|0,ic|0)|0;ic=da;c[ic>>2]=lc;c[ic+4>>2]=C;ic=ea;lc=c[ic>>2]|0;zb=c[ic+4>>2]|0;ic=fa;Ob=c[ic>>2]|0;Pb=c[ic+4>>2]|0;ic=lb(lc|0,zb|0,18,0)|0;Ab=C;ec=cb(Ob|0,Pb|0,lc|0,zb|0)|0;zb=cb(ec|0,C|0,ic|0,Ab|0)|0;Ab=fa;c[Ab>>2]=zb;c[Ab+4>>2]=C;Ab=ga;zb=c[Ab>>2]|0;ic=c[Ab+4>>2]|0;Ab=ha;ec=c[Ab>>2]|0;lc=c[Ab+4>>2]|0;Ab=lb(zb|0,ic|0,18,0)|0;Pb=C;Ob=cb(ec|0,lc|0,zb|0,ic|0)|0;ic=cb(Ob|0,C|0,Ab|0,Pb|0)|0;Pb=ha;c[Pb>>2]=ic;c[Pb+4>>2]=C;Pb=ia;ic=c[Pb>>2]|0;Ab=c[Pb+4>>2]|0;Pb=ja;Ob=c[Pb>>2]|0;zb=c[Pb+4>>2]|0;Pb=lb(ic|0,Ab|0,18,0)|0;lc=C;ec=cb(Ob|0,zb|0,ic|0,Ab|0)|0;Ab=cb(ec|0,C|0,Pb|0,lc|0)|0;lc=ja;c[lc>>2]=Ab;c[lc+4>>2]=C;lc=ka;Ab=c[lc>>2]|0;Pb=c[lc+4>>2]|0;lc=m;ec=c[lc>>2]|0;ic=c[lc+4>>2]|0;lc=lb(Ab|0,Pb|0,18,0)|0;zb=C;Ob=cb(ec|0,ic|0,Ab|0,Pb|0)|0;Pb=cb(Ob|0,C|0,lc|0,zb|0)|0;zb=C;lc=m;c[lc>>2]=Pb;c[lc+4>>2]=zb;lc=ka;c[lc>>2]=0;c[lc+4>>2]=0;lc=zb;zb=Pb;Pb=0;do Ob=cb(lc>>31>>>6|0,0,zb|0,lc|0)|0,Ab=ab(Ob|0,C|0,26)|0,Ob=C,ic=fb(Ab|0,Ob|0,26)|0,ec=bb(zb|0,lc|0,ic|0,C|0)|0,ic=m+(Pb<<3)|0,c[ic>>2]=ec,c[ic+4>>2]=C,ic=m+((Pb|1)<<3)|0,ec=ic,Ub=cb(Ab|0,Ob|0,c[ec>>2]|0,c[ec+4>>2]|0)|0,ec=C,Ob=cb(ec>>31>>>7|0,0,Ub|0,ec|0)|0,Ab=ab(Ob|0,C|0,25)|0,Ob=C,vb=fb(Ab|0,Ob|0,25)|0,fc=bb(Ub|0,ec|0,vb|0,C|0)|0,vb=ic,c[vb>>2]=fc,c[vb+4>>2]=C,Pb=Pb+2|0,vb=m+(Pb<<3)|0,fc=vb,zb=cb(Ab|0,Ob|0,c[fc>>2]|0,c[fc+4>>2]|0)|0,lc=C,fc=vb,c[fc>>2]=zb,c[fc+4>>2]=lc;while(Pb>>>0<10);Pb=ka;lc=c[Pb>>2]|0;zb=c[Pb+4>>2]|0;Pb=m;mc=c[Pb>>2]|0;rb=c[Pb+4>>2]|0;Pb=lb(lc|0,zb|0,18,0)|0;ub=C;Bb=cb(mc|0,rb|0,lc|0,zb|0)|0;zb=cb(Bb|0,C|0,Pb|0,ub|0)|0;ub=C;Pb=ka;c[Pb>>2]=0;c[Pb+4>>2]=0;Pb=cb(ub>>31>>>6|0,0,zb|0,ub|0)|0;Bb=ab(Pb|0,C|0,26)|0;Pb=C;lc=fb(Bb|0,Pb|0,26)|0;rb=bb(zb|0,ub|0,lc|0,C|0)|0;lc=m;c[lc>>2]=rb;c[lc+4>>2]=C;lc=ja;rb=cb(Bb|0,Pb|0,c[lc>>2]|0,c[lc+4>>2]|0)|0;lc=ja;c[lc>>2]=rb;c[lc+4>>2]=C;D=Za;E=o;e=D+80|0;do c[D>>2]=c[E>>2],D=D+4|0,E=E+4|0;while((D|0)<(e|0));D=$a;E=m;e=D+80|0;do c[D>>2]=c[E>>2],D=D+4|0,E=E+4|0;while((D|0)<(e|0));Na(j,gb);Na(k,ib);Ma(hb,j,k);lc=hb+144|0;rb=c[lc>>2]|0;Pb=c[lc+4>>2]|0;lc=hb+64|0;Bb=lc;ub=c[Bb>>2]|0;zb=c[Bb+4>>2]|0;Bb=lb(rb|0,Pb|0,18,0)|0;mc=C;fc=cb(ub|0,zb|0,rb|0,Pb|0)|0;Pb=cb(fc|0,C|0,Bb|0,mc|0)|0;mc=lc;c[mc>>2]=Pb;c[mc+4>>2]=C;mc=hb+136|0;Pb=c[mc>>2]|0;lc=c[mc+4>>2]|0;mc=hb+56|0;Bb=mc;fc=c[Bb>>2]|0;rb=c[Bb+4>>2]|0;Bb=lb(Pb|0,lc|0,18,0)|0;zb=C;ub=cb(fc|0,rb|0,Pb|0,lc|0)|0;lc=cb(ub|0,C|0,Bb|0,zb|0)|0;zb=mc;c[zb>>2]=lc;c[zb+4>>2]=C;zb=hb+128|0;lc=c[zb>>2]|0;mc=c[zb+4>>2]|0;zb=hb+48|0;Bb=zb;ub=c[Bb>>2]|0;Pb=c[Bb+4>>2]|0;Bb=lb(lc|0,mc|0,18,0)|0;rb=C;fc=cb(ub|0,Pb|0,lc|0,mc|0)|0;mc=cb(fc|0,C|0,Bb|0,rb|0)|0;rb=zb;c[rb>>2]=mc;c[rb+4>>2]=C;rb=hb+120|0;mc=c[rb>>2]|0;zb=c[rb+4>>2]|0;rb=hb+40|0;Bb=rb;fc=c[Bb>>2]|0;lc=c[Bb+4>>2]|0;Bb=lb(mc|0,zb|0,18,0)|0;Pb=C;ub=cb(fc|0,lc|0,mc|0,zb|0)|0;zb=cb(ub|0,C|0,Bb|0,Pb|0)|0;Pb=rb;c[Pb>>2]=zb;c[Pb+4>>2]=C;Pb=hb+112|0;zb=c[Pb>>2]|0;rb=c[Pb+4>>2]|0;Pb=hb+32|0;Bb=Pb;ub=c[Bb>>2]|0;mc=c[Bb+4>>2]|0;Bb=lb(zb|0,rb|0,18,0)|0;lc=C;fc=cb(ub|0,mc|0,zb|0,rb|0)|0;rb=cb(fc|0,C|0,Bb|0,lc|0)|0;lc=Pb;c[lc>>2]=rb;c[lc+4>>2]=C;lc=hb+104|0;rb=c[lc>>2]|0;Pb=c[lc+4>>2]|0;lc=hb+24|0;Bb=lc;fc=c[Bb>>2]|0;zb=c[Bb+4>>2]|0;Bb=lb(rb|0,Pb|0,18,0)|0;mc=C;ub=cb(fc|0,zb|0,rb|0,Pb|0)|0;Pb=cb(ub|0,C|0,Bb|0,mc|0)|0;mc=lc;c[mc>>2]=Pb;c[mc+4>>2]=C;mc=hb+96|0;Pb=c[mc>>2]|0;lc=c[mc+4>>2]|0;mc=hb+16|0;Bb=mc;ub=c[Bb>>2]|0;rb=c[Bb+4>>2]|0;Bb=lb(Pb|0,lc|0,18,0)|0;zb=C;fc=cb(ub|0,rb|0,Pb|0,lc|0)|0;lc=cb(fc|0,C|0,Bb|0,zb|0)|0;zb=mc;c[zb>>2]=lc;c[zb+4>>2]=C;zb=hb+88|0;lc=c[zb>>2]|0;mc=c[zb+4>>2]|0;zb=hb+8|0;Bb=zb;fc=c[Bb>>2]|0;Pb=c[Bb+4>>2]|0;Bb=lb(lc|0,mc|0,18,0)|0;rb=C;ub=cb(fc|0,Pb|0,lc|0,mc|0)|0;mc=cb(ub|0,C|0,Bb|0,rb|0)|0;rb=zb;c[rb>>2]=mc;c[rb+4>>2]=C;rb=hb+80|0;mc=rb;Bb=c[mc>>2]|0;ub=c[mc+4>>2]|0;mc=hb;lc=c[mc>>2]|0;Pb=c[mc+4>>2]|0;mc=lb(Bb|0,ub|0,18,0)|0;fc=C;vb=cb(lc|0,Pb|0,Bb|0,ub|0)|0;ub=cb(vb|0,C|0,mc|0,fc|0)|0;fc=C;mc=hb;c[mc>>2]=ub;c[mc+4>>2]=fc;mc=rb;c[mc>>2]=0;c[mc+4>>2]=0;mc=fc;fc=ub;ub=0;do vb=cb(mc>>31>>>6|0,0,fc|0,mc|0)|0,Bb=ab(vb|0,C|0,26)|0,vb=C,Pb=fb(Bb|0,vb|0,26)|0,lc=bb(fc|0,mc|0,Pb|0,C|0)|0,Pb=hb+(ub<<3)|0,c[Pb>>2]=lc,c[Pb+4>>2]=C,Pb=hb+((ub|1)<<3)|0,lc=Pb,Ob=cb(Bb|0,vb|0,c[lc>>2]|0,c[lc+4>>2]|0)|0,lc=C,vb=cb(lc>>31>>>7|0,0,Ob|0,lc|0)|0,Bb=ab(vb|0,C|0,25)|0,vb=C,Ab=fb(Bb|0,vb|0,25)|0,ic=bb(Ob|0,lc|0,Ab|0,C|0)|0,Ab=Pb,c[Ab>>2]=ic,c[Ab+4>>2]=C,ub=ub+2|0,Ab=hb+(ub<<3)|0,ic=Ab,fc=cb(Bb|0,vb|0,c[ic>>2]|0,c[ic+4>>2]|0)|0,mc=C,ic=Ab,c[ic>>2]=fc,c[ic+4>>2]=mc;while(ub>>>0<10);ub=rb;mc=c[ub>>2]|0;fc=c[ub+4>>2]|0;ub=hb;ic=c[ub>>2]|0;Ab=c[ub+4>>2]|0;ub=lb(mc|0,fc|0,18,0)|0;vb=C;Bb=cb(ic|0,Ab|0,mc|0,fc|0)|0;fc=cb(Bb|0,C|0,ub|0,vb|0)|0;vb=C;ub=rb;c[ub>>2]=0;c[ub+4>>2]=0;ub=cb(vb>>31>>>6|0,0,fc|0,vb|0)|0;Bb=ab(ub|0,C|0,26)|0;ub=C;mc=fb(Bb|0,ub|0,26)|0;Ab=bb(fc|0,vb|0,mc|0,C|0)|0;mc=hb;c[mc>>2]=Ab;c[mc+4>>2]=C;mc=zb;Ab=cb(Bb|0,ub|0,c[mc>>2]|0,c[mc+4>>2]|0)|0;mc=zb;c[mc>>2]=Ab;c[mc+4>>2]=C;mc=j;Ab=c[mc>>2]|0;ub=c[mc+4>>2]|0;mc=k;Bb=bb(Ab|0,ub|0,c[mc>>2]|0,c[mc+4>>2]|0)|0;mc=C;vb=k;c[vb>>2]=Bb;c[vb+4>>2]=mc;vb=na;fc=c[vb>>2]|0;ic=c[vb+4>>2]|0;vb=oa;Pb=bb(fc|0,ic|0,c[vb>>2]|0,c[vb+4>>2]|0)|0;vb=C;lc=oa;c[lc>>2]=Pb;c[lc+4>>2]=vb;lc=pa;Ob=c[lc>>2]|0;ec=c[lc+4>>2]|0;lc=qa;Ub=bb(Ob|0,ec|0,c[lc>>2]|0,c[lc+4>>2]|0)|0;lc=C;Kb=qa;c[Kb>>2]=Ub;c[Kb+4>>2]=lc;Kb=ra;Jb=c[Kb>>2]|0;Ib=c[Kb+4>>2]|0;Kb=sa;Yb=bb(Jb|0,Ib|0,c[Kb>>2]|0,c[Kb+4>>2]|0)|0;Kb=C;Xb=sa;c[Xb>>2]=Yb;c[Xb+4>>2]=Kb;Xb=ta;gc=c[Xb>>2]|0;Wb=c[Xb+4>>2]|0;Xb=ua;Eb=bb(gc|0,Wb|0,c[Xb>>2]|0,c[Xb+4>>2]|0)|0;Xb=C;Mb=ua;c[Mb>>2]=Eb;c[Mb+4>>2]=Xb;Mb=va;Vb=c[Mb>>2]|0;cc=c[Mb+4>>2]|0;Mb=wa;hc=bb(Vb|0,cc|0,c[Mb>>2]|0,c[Mb+4>>2]|0)|0;Mb=C;wb=wa;c[wb>>2]=hc;c[wb+4>>2]=Mb;wb=xa;yb=c[wb>>2]|0;ob=c[wb+4>>2]|0;wb=ya;sb=bb(yb|0,ob|0,c[wb>>2]|0,c[wb+4>>2]|0)|0;wb=C;bc=ya;c[bc>>2]=sb;c[bc+4>>2]=wb;bc=za;Qb=c[bc>>2]|0;Db=c[bc+4>>2]|0;bc=Aa;Fb=bb(Qb|0,Db|0,c[bc>>2]|0,c[bc+4>>2]|0)|0;bc=C;dc=Aa;c[dc>>2]=Fb;c[dc+4>>2]=bc;dc=Ba;Lb=c[dc>>2]|0;Tb=c[dc+4>>2]|0;dc=Ca;pb=bb(Lb|0,Tb|0,c[dc>>2]|0,c[dc+4>>2]|0)|0;dc=C;$b=Ca;c[$b>>2]=pb;c[$b+4>>2]=dc;$b=Da;Zb=c[$b>>2]|0;qb=c[$b+4>>2]|0;$b=Ea;Hb=bb(Zb|0,qb|0,c[$b>>2]|0,c[$b+4>>2]|0)|0;$b=C;_b=Ea;c[_b>>2]=Hb;c[_b+4>>2]=$b;D=Fa;e=D+72|0;do c[D>>2]=0,D=D+4|0;while((D|0)<(e|0));zb=lb(Bb|0,mc|0,121665,0)|0;rb=C;_b=h;c[_b>>2]=zb;c[_b+4>>2]=rb;_b=lb(Pb|0,vb|0,121665,0)|0;tb=Ga;c[tb>>2]=_b;c[tb+4>>2]=C;tb=lb(Ub|0,lc|0,121665,0)|0;_b=Ha;c[_b>>2]=tb;c[_b+4>>2]=C;_b=lb(Yb|0,Kb|0,121665,0)|0;tb=Ia;c[tb>>2]=_b;c[tb+4>>2]=C;tb=lb(Eb|0,Xb|0,121665,0)|0;_b=Ja;c[_b>>2]=tb;c[_b+4>>2]=C;_b=lb(hc|0,Mb|0,121665,0)|0;tb=Ka;c[tb>>2]=_b;c[tb+4>>2]=C;tb=lb(sb|0,wb|0,121665,0)|0;_b=Oa;c[_b>>2]=tb;c[_b+4>>2]=C;_b=lb(Fb|0,bc|0,121665,0)|0;tb=Pa;c[tb>>2]=_b;c[tb+4>>2]=C;tb=lb(pb|0,dc|0,121665,0)|0;_b=Qa;c[_b>>2]=tb;c[_b+4>>2]=C;_b=lb(Hb|0,$b|0,121665,0)|0;tb=Ra;c[tb>>2]=_b;c[tb+4>>2]=C;tb=Fa;c[tb>>2]=0;c[tb+4>>2]=0;tb=rb;rb=zb;zb=0;do _b=cb(tb>>31>>>6|0,0,rb|0,tb|0)|0,Rb=ab(_b|0,C|0,26)|0,_b=C,Sb=fb(Rb|0,_b|0,26)|0,Nb=bb(rb|0,tb|0,Sb|0,C|0)|0,Sb=h+(zb<<3)|0,c[Sb>>2]=Nb,c[Sb+4>>2]=C,Sb=h+((zb|1)<<3)|0,Nb=Sb,Cb=cb(Rb|0,_b|0,c[Nb>>2]|0,c[Nb+4>>2]|0)|0,Nb=C,_b=cb(Nb>>31>>>7|0,0,Cb|0,Nb|0)|0,Rb=ab(_b|0,C|0,25)|0,_b=C,kc=fb(Rb|0,_b|0,25)|0,jc=bb(Cb|0,Nb|0,kc|0,C|0)|0,kc=Sb,c[kc>>2]=jc,c[kc+4>>2]=C,zb=zb+2|0,kc=h+(zb<<3)|0,jc=kc,rb=cb(Rb|0,_b|0,c[jc>>2]|0,c[jc+4>>2]|0)|0,tb=C,jc=kc,c[jc>>2]=rb,c[jc+4>>2]=tb;while(zb>>>0<10);zb=Fa;tb=c[zb>>2]|0;rb=c[zb+4>>2]|0;zb=h;$b=c[zb>>2]|0;Hb=c[zb+4>>2]|0;zb=lb(tb|0,rb|0,18,0)|0;dc=C;pb=cb($b|0,Hb|0,tb|0,rb|0)|0;rb=cb(pb|0,C|0,zb|0,dc|0)|0;dc=C;zb=Fa;c[zb>>2]=0;c[zb+4>>2]=0;zb=cb(dc>>31>>>6|0,0,rb|0,dc|0)|0;pb=ab(zb|0,C|0,26)|0;zb=C;tb=fb(pb|0,zb|0,26)|0;Hb=C;$b=Ga;bc=c[$b>>2]|0;Fb=c[$b+4>>2]|0;$b=cb(rb|0,dc|0,Ab|0,ub|0)|0;dc=bb($b|0,C|0,tb|0,Hb|0)|0;Hb=h;c[Hb>>2]=dc;c[Hb+4>>2]=C;Hb=cb(bc|0,Fb|0,fc|0,ic|0)|0;Fb=cb(Hb|0,C|0,pb|0,zb|0)|0;zb=Ga;c[zb>>2]=Fb;c[zb+4>>2]=C;zb=Ha;Fb=cb(c[zb>>2]|0,c[zb+4>>2]|0,Ob|0,ec|0)|0;zb=Ha;c[zb>>2]=Fb;c[zb+4>>2]=C;zb=Ia;Fb=cb(c[zb>>2]|0,c[zb+4>>2]|0,Jb|0,Ib|0)|0;zb=Ia;c[zb>>2]=Fb;c[zb+4>>2]=C;zb=Ja;Fb=cb(c[zb>>2]|0,c[zb+4>>2]|0,gc|0,Wb|0)|0;zb=Ja;c[zb>>2]=Fb;c[zb+4>>2]=C;zb=Ka;Fb=cb(c[zb>>2]|0,c[zb+4>>2]|0,Vb|0,cc|0)|0;zb=Ka;c[zb>>2]=Fb;c[zb+4>>2]=C;zb=Oa;Fb=cb(c[zb>>2]|0,c[zb+4>>2]|0,yb|0,ob|0)|0;zb=Oa;c[zb>>2]=Fb;c[zb+4>>2]=C;zb=Pa;Fb=cb(c[zb>>2]|0,c[zb+4>>2]|0,Qb|0,Db|0)|0;zb=Pa;c[zb>>2]=Fb;c[zb+4>>2]=C;zb=Qa;Fb=cb(c[zb>>2]|0,c[zb+4>>2]|0,Lb|0,Tb|0)|0;zb=Qa;c[zb>>2]=Fb;c[zb+4>>2]=C;zb=Ra;Fb=cb(c[zb>>2]|0,c[zb+4>>2]|0,Zb|0,qb|0)|0;zb=Ra;c[zb>>2]=Fb;c[zb+4>>2]=C;Ma(jb,k,h);zb=jb+144|0;Fb=c[zb>>2]|0;pb=c[zb+4>>2]|0;zb=jb+64|0;Hb=zb;bc=c[Hb>>2]|0;dc=c[Hb+4>>2]|0;Hb=lb(Fb|0,pb|0,18,0)|0;tb=C;$b=cb(bc|0,dc|0,Fb|0,pb|0)|0;pb=cb($b|0,C|0,Hb|0,tb|0)|0;tb=zb;c[tb>>2]=pb;c[tb+4>>2]=C;tb=jb+136|0;pb=c[tb>>2]|0;zb=c[tb+4>>2]|0;tb=jb+56|0;Hb=tb;$b=c[Hb>>2]|0;Fb=c[Hb+4>>2]|0;Hb=lb(pb|0,zb|0,18,0)|0;dc=C;bc=cb($b|0,Fb|0,pb|0,zb|0)|0;zb=cb(bc|0,C|0,Hb|0,dc|0)|0;dc=tb;c[dc>>2]=zb;c[dc+4>>2]=C;dc=jb+128|0;zb=c[dc>>2]|0;tb=c[dc+4>>2]|0;dc=jb+48|0;Hb=dc;bc=c[Hb>>2]|0;pb=c[Hb+4>>2]|0;Hb=lb(zb|0,tb|0,18,0)|0;Fb=C;$b=cb(bc|0,pb|0,zb|0,tb|0)|0;tb=cb($b|0,C|0,Hb|0,Fb|0)|0;Fb=dc;c[Fb>>2]=tb;c[Fb+4>>2]=C;Fb=jb+120|0;tb=c[Fb>>2]|0;dc=c[Fb+4>>2]|0;Fb=jb+40|0;Hb=Fb;$b=c[Hb>>2]|0;zb=c[Hb+4>>2]|0;Hb=lb(tb|0,dc|0,18,0)|0;pb=C;bc=cb($b|0,zb|0,tb|0,dc|0)|0;dc=cb(bc|0,C|0,Hb|0,pb|0)|0;pb=Fb;c[pb>>2]=dc;c[pb+4>>2]=C;pb=jb+112|0;dc=c[pb>>2]|0;Fb=c[pb+4>>2]|0;pb=jb+32|0;Hb=pb;bc=c[Hb>>2]|0;tb=c[Hb+4>>2]|0;Hb=lb(dc|0,Fb|0,18,0)|0;zb=C;$b=cb(bc|0,tb|0,dc|0,Fb|0)|0;Fb=cb($b|0,C|0,Hb|0,zb|0)|0;zb=pb;c[zb>>2]=Fb;c[zb+4>>2]=C;zb=jb+104|0;Fb=c[zb>>2]|0;pb=c[zb+4>>2]|0;zb=jb+24|0;Hb=zb;$b=c[Hb>>2]|0;dc=c[Hb+4>>2]|0;Hb=lb(Fb|0,pb|0,18,0)|0;tb=C;bc=cb($b|0,dc|0,Fb|0,pb|0)|0;pb=cb(bc|0,C|0,Hb|0,tb|0)|0;tb=zb;c[tb>>2]=pb;c[tb+4>>2]=C;tb=jb+96|0;pb=c[tb>>2]|0;zb=c[tb+4>>2]|0;tb=jb+16|0;Hb=tb;bc=c[Hb>>2]|0;Fb=c[Hb+4>>2]|0;Hb=lb(pb|0,zb|0,18,0)|0;dc=C;$b=cb(bc|0,Fb|0,pb|0,zb|0)|0;zb=cb($b|0,C|0,Hb|0,dc|0)|0;dc=tb;c[dc>>2]=zb;c[dc+4>>2]=C;dc=jb+88|0;zb=c[dc>>2]|0;tb=c[dc+4>>2]|0;dc=jb+8|0;Hb=dc;$b=c[Hb>>2]|0;pb=c[Hb+4>>2]|0;Hb=lb(zb|0,tb|0,18,0)|0;Fb=C;bc=cb($b|0,pb|0,zb|0,tb|0)|0;tb=cb(bc|0,C|0,Hb|0,Fb|0)|0;Fb=dc;c[Fb>>2]=tb;c[Fb+4>>2]=C;Fb=jb+80|0;tb=Fb;Hb=c[tb>>2]|0;bc=c[tb+4>>2]|0;tb=jb;zb=c[tb>>2]|0;pb=c[tb+4>>2]|0;tb=lb(Hb|0,bc|0,18,0)|0;$b=C;rb=cb(zb|0,pb|0,Hb|0,bc|0)|0;bc=cb(rb|0,C|0,tb|0,$b|0)|0;$b=C;tb=jb;c[tb>>2]=bc;c[tb+4>>2]=$b;tb=Fb;c[tb>>2]=0;c[tb+4>>2]=0;tb=$b;$b=bc;bc=0;do rb=cb(tb>>31>>>6|0,0,$b|0,tb|0)|0,Hb=ab(rb|0,C|0,26)|0,rb=C,pb=fb(Hb|0,rb|0,26)|0,zb=bb($b|0,tb|0,pb|0,C|0)|0,pb=jb+(bc<<3)|0,c[pb>>2]=zb,c[pb+4>>2]=C,pb=jb+((bc|1)<<3)|0,zb=pb,wb=cb(Hb|0,rb|0,c[zb>>2]|0,c[zb+4>>2]|0)|0,zb=C,rb=cb(zb>>31>>>7|0,0,wb|0,zb|0)|0,Hb=ab(rb|0,C|0,25)|0,rb=C,sb=fb(Hb|0,rb|0,25)|0,Mb=bb(wb|0,zb|0,sb|0,C|0)|0,sb=pb,c[sb>>2]=Mb,c[sb+4>>2]=C,bc=bc+2|0,sb=jb+(bc<<3)|0,Mb=sb,$b=cb(Hb|0,rb|0,c[Mb>>2]|0,c[Mb+4>>2]|0)|0,tb=C,Mb=sb,c[Mb>>2]=$b,c[Mb+4>>2]=tb;while(bc>>>0<10);bc=Fb;tb=c[bc>>2]|0;$b=c[bc+4>>2]|0;bc=jb;qb=c[bc>>2]|0;Zb=c[bc+4>>2]|0;bc=lb(tb|0,$b|0,18,0)|0;Tb=C;Lb=cb(qb|0,Zb|0,tb|0,$b|0)|0;$b=cb(Lb|0,C|0,bc|0,Tb|0)|0;Tb=C;bc=Fb;c[bc>>2]=0;c[bc+4>>2]=0;bc=cb(Tb>>31>>>6|0,0,$b|0,Tb|0)|0;Lb=ab(bc|0,C|0,26)|0;bc=C;tb=fb(Lb|0,bc|0,26)|0;Zb=bb($b|0,Tb|0,tb|0,C|0)|0;tb=jb;c[tb>>2]=Zb;c[tb+4>>2]=C;tb=dc;Zb=cb(Lb|0,bc|0,c[tb>>2]|0,c[tb+4>>2]|0)|0;tb=dc;c[tb>>2]=Zb;c[tb+4>>2]=C;tb=0;do Zb=hb+(tb<<3)|0,bc=Zb,Lb=c[bc>>2]|0,Tb=c[bc+4>>2]|0,bc=Za+(tb<<3)|0,$b=bc,qb=c[$b>>2]|0,Db=c[$b+4>>2]|0,$b=(qb^Lb)&mb,Qb=(Db^Tb)&nb,Tb=ab(0,$b^Lb|0,32)|0,Lb=Zb,c[Lb>>2]=Tb,c[Lb+4>>2]=C,Lb=ab(0,$b^qb|0,32)|0,qb=bc,c[qb>>2]=Lb,c[qb+4>>2]=C,tb=tb+1|0;while((tb|0)!=10);nc=0;do tb=jb+(nc<<3)|0,dc=tb,Fb=c[dc>>2]|0,qb=c[dc+4>>2]|0,dc=$a+(nc<<3)|0,Lb=dc,bc=c[Lb>>2]|0,$b=c[Lb+4>>2]|0,Lb=(bc^Fb)&mb,Tb=($b^qb)&nb,qb=ab(0,Lb^Fb|0,32)|0,Fb=tb,c[Fb>>2]=qb,c[Fb+4>>2]=C,Fb=ab(0,Lb^bc|0,32)|0,bc=dc,c[bc>>2]=Fb,c[bc+4>>2]=C,nc=nc+1|0;while((nc|0)!=10);Xa=Xa+1|0;if((Xa|0)==8){oc=Ya;pc=Za;qc=_a;rc=$a;sc=gb;tc=hb;uc=ib;vc=jb;break}else nb=jb,mb=hb,bc=$a,Fb=Za,w=kb<<1&255,jb=ib,ib=nb,hb=gb,gb=mb,$a=_a,_a=bc,Za=Ya,Ya=Fb}Ya=Sa+1|0;if((Ya|0)==32){wc=tc;xc=vc;break}else Sa=Ya,Ta=pc,Ua=oc,t=rc,Va=qc,u=tc,Wa=sc,v=vc,s=uc}D=y;E=wc;e=D+80|0;do c[D>>2]=c[E>>2],D=D+4|0,E=E+4|0;while((D|0)<(e|0));D=z;E=xc;e=D+80|0;do c[D>>2]=c[E>>2],D=D+4|0,E=E+4|0;while((D|0)<(e|0));Na(h,z);Na(r,h);Na(q,r);La(j,q,z);La(k,j,h);Na(q,k);La(l,q,j);Na(q,l);Na(r,q);Na(q,r);Na(r,q);Na(q,r);La(m,q,l);Na(q,m);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);La(n,r,m);Na(q,n);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);La(q,r,n);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);La(o,q,m);Na(q,o);Na(r,q);m=2;do Na(q,r),Na(r,q),m=m+2|0;while((m|0)<50);La(p,r,o);Na(r,p);Na(q,r);m=2;do Na(r,q),Na(q,r),m=m+2|0;while((m|0)<100);La(r,q,p);Na(q,r);Na(r,q);p=2;do Na(q,r),Na(r,q),p=p+2|0;while((p|0)<50);La(q,r,o);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);La(A,r,k);La(z,y,A);A=c[z>>2]|0;c[h>>2]=A;y=h+4|0;c[y>>2]=c[z+8>>2];k=h+8|0;c[k>>2]=c[z+16>>2];r=h+12|0;c[r>>2]=c[z+24>>2];q=h+16|0;c[q>>2]=c[z+32>>2];o=h+20|0;c[o>>2]=c[z+40>>2];p=h+24|0;c[p>>2]=c[z+48>>2];m=h+28|0;c[m>>2]=c[z+56>>2];n=h+32|0;c[n>>2]=c[z+64>>2];l=h+36|0;c[l>>2]=c[z+72>>2];z=A;A=0;while(1){j=h+(A<<2)|0;E=z>>31&z;!(A&1)?(D=E>>26,c[j>>2]=(_(D,-67108864)|0)+z,e=A+1|0,xc=h+(e<<2)|0,wc=(c[xc>>2]|0)+D|0,c[xc>>2]=wc,yc=wc,zc=e):(e=E>>25,c[j>>2]=(_(e,-33554432)|0)+z,j=A+1|0,E=h+(j<<2)|0,wc=(c[E>>2]|0)+e|0,c[E>>2]=wc,yc=wc,zc=j);if((zc|0)==9)break;else z=yc,A=zc}zc=c[l>>2]|0;A=(zc>>31&zc)>>25;c[l>>2]=(_(A,-33554432)|0)+zc;zc=(A*19|0)+(c[h>>2]|0)|0;c[h>>2]=zc;A=zc;zc=0;while(1){yc=h+(zc<<2)|0;z=A>>31&A;!(zc&1)?(j=z>>26,c[yc>>2]=(_(j,-67108864)|0)+A,wc=zc+1|0,E=h+(wc<<2)|0,e=(c[E>>2]|0)+j|0,c[E>>2]=e,Ac=wc,Bc=e):(e=z>>25,c[yc>>2]=(_(e,-33554432)|0)+A,yc=zc+1|0,z=h+(yc<<2)|0,wc=(c[z>>2]|0)+e|0,c[z>>2]=wc,Ac=yc,Bc=wc);if((Ac|0)==9)break;else A=Bc,zc=Ac}Ac=c[l>>2]|0;zc=(Ac>>31&Ac)>>25;c[l>>2]=(_(zc,-33554432)|0)+Ac;Ac=(zc*19|0)+(c[h>>2]|0)|0;zc=(Ac>>31&Ac)>>26;Bc=(_(zc,-67108864)|0)+Ac|0;c[h>>2]=Bc;c[y>>2]=zc+(c[y>>2]|0);zc=Bc;Bc=0;while(1){Ac=h+(Bc<<2)|0;!(Bc&1)?(c[Ac>>2]=zc&67108863,A=Bc+1|0,wc=h+(A<<2)|0,yc=(c[wc>>2]|0)+(zc>>26)|0,c[wc>>2]=yc,Cc=A,Dc=yc):(c[Ac>>2]=zc&33554431,Ac=Bc+1|0,yc=h+(Ac<<2)|0,A=(c[yc>>2]|0)+(zc>>25)|0,c[yc>>2]=A,Cc=Ac,Dc=A);if((Cc|0)==9)break;else zc=Dc,Bc=Cc}Cc=c[l>>2]|0;c[l>>2]=Cc&33554431;Bc=((Cc>>25)*19|0)+(c[h>>2]|0)|0;c[h>>2]=Bc;Cc=Bc;Bc=0;while(1){Dc=h+(Bc<<2)|0;!(Bc&1)?(c[Dc>>2]=Cc&67108863,zc=Bc+1|0,A=h+(zc<<2)|0,Ac=(c[A>>2]|0)+(Cc>>26)|0,c[A>>2]=Ac,Ec=zc,Fc=Ac):(c[Dc>>2]=Cc&33554431,Dc=Bc+1|0,Ac=h+(Dc<<2)|0,zc=(c[Ac>>2]|0)+(Cc>>25)|0,c[Ac>>2]=zc,Ec=Dc,Fc=zc);if((Ec|0)==9)break;else Cc=Fc,Bc=Ec}Ec=c[l>>2]|0;Bc=Ec&33554431;c[l>>2]=Bc;Fc=((Ec>>25)*19|0)+(c[h>>2]|0)|0;c[h>>2]=Fc;Ec=1;Cc=~(Fc+-67108845>>31);while(1){zc=c[h+(Ec<<2)>>2]|0;!(Ec&1)?(Dc=zc<<16&(zc^-67108864),Ac=Dc<<8&Dc,Dc=Ac<<4&Ac,Ac=Dc<<2&Dc,Gc=Ac<<1&Ac):(Ac=zc<<16&(zc^-33554432),zc=Ac<<8&Ac,Ac=zc<<4&zc,zc=Ac<<2&Ac,Gc=zc<<1&zc);zc=Gc>>31&Cc;Ec=Ec+1|0;if((Ec|0)==10){Hc=zc;break}else Cc=zc}Cc=Fc-(Hc&67108845)|0;c[h>>2]=Cc;h=Hc&67108863;Fc=Hc&33554431;Ec=(c[y>>2]|0)-Fc|0;Gc=Ec<<2;zc=(c[k>>2]|0)-h|0;Ac=zc<<3;Dc=(c[r>>2]|0)-Fc|0;A=Dc<<5;yc=(c[q>>2]|0)-Hc|0;Hc=yc<<6;wc=(c[o>>2]|0)-Fc|0;c[o>>2]=wc;o=(c[p>>2]|0)-h|0;z=o<<1;e=(c[m>>2]|0)-Fc|0;E=e<<3;j=(c[n>>2]|0)-h<<4;c[y>>2]=Gc;c[k>>2]=Ac;c[r>>2]=A;c[q>>2]=Hc;c[p>>2]=z;c[m>>2]=E;c[n>>2]=j;c[l>>2]=Bc-Fc<<6;a[b>>0]=Cc;a[b+1>>0]=Cc>>>8;a[b+2>>0]=Cc>>>16;a[b+3>>0]=Gc|Cc>>>24;a[b+4>>0]=Ec>>>6;a[b+5>>0]=Ec>>>14;a[b+6>>0]=Ac|Ec>>>22;a[b+7>>0]=zc>>>5;a[b+8>>0]=zc>>>13;a[b+9>>0]=A|zc>>>21;a[b+10>>0]=Dc>>>3;a[b+11>>0]=Dc>>>11;a[b+12>>0]=Hc|Dc>>>19;a[b+13>>0]=yc>>>2;a[b+14>>0]=yc>>>10;a[b+15>>0]=yc>>>18;a[b+16>>0]=wc;a[b+17>>0]=wc>>>8;a[b+18>>0]=wc>>>16;a[b+19>>0]=wc>>>24|z;a[b+20>>0]=o>>>7;a[b+21>>0]=o>>>15;a[b+22>>0]=o>>>23|E;a[b+23>>0]=e>>>5;a[b+24>>0]=e>>>13;E=c[n>>2]|0;a[b+25>>0]=e>>>21|E;a[b+26>>0]=E>>>8;a[b+27>>0]=E>>>16;e=c[l>>2]|0;a[b+28>>0]=E>>>24|e;a[b+29>>0]=e>>>8;a[b+30>>0]=e>>>16;a[b+31>>0]=e>>>24;i=g;return 0}function La(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0;e=i;i=i+160|0;f=e;Ma(f,b,d);d=f+144|0;b=c[d>>2]|0;g=c[d+4>>2]|0;d=f+64|0;h=d;j=c[h>>2]|0;k=c[h+4>>2]|0;h=lb(b|0,g|0,18,0)|0;l=C;m=cb(j|0,k|0,b|0,g|0)|0;g=cb(m|0,C|0,h|0,l|0)|0;l=d;c[l>>2]=g;c[l+4>>2]=C;l=f+136|0;g=c[l>>2]|0;d=c[l+4>>2]|0;l=f+56|0;h=l;m=c[h>>2]|0;b=c[h+4>>2]|0;h=lb(g|0,d|0,18,0)|0;k=C;j=cb(m|0,b|0,g|0,d|0)|0;d=cb(j|0,C|0,h|0,k|0)|0;k=l;c[k>>2]=d;c[k+4>>2]=C;k=f+128|0;d=c[k>>2]|0;l=c[k+4>>2]|0;k=f+48|0;h=k;j=c[h>>2]|0;g=c[h+4>>2]|0;h=lb(d|0,l|0,18,0)|0;b=C;m=cb(j|0,g|0,d|0,l|0)|0;l=cb(m|0,C|0,h|0,b|0)|0;b=k;c[b>>2]=l;c[b+4>>2]=C;b=f+120|0;l=c[b>>2]|0;k=c[b+4>>2]|0;b=f+40|0;h=b;m=c[h>>2]|0;d=c[h+4>>2]|0;h=lb(l|0,k|0,18,0)|0;g=C;j=cb(m|0,d|0,l|0,k|0)|0;k=cb(j|0,C|0,h|0,g|0)|0;g=b;c[g>>2]=k;c[g+4>>2]=C;g=f+112|0;k=c[g>>2]|0;b=c[g+4>>2]|0;g=f+32|0;h=g;j=c[h>>2]|0;l=c[h+4>>2]|0;h=lb(k|0,b|0,18,0)|0;d=C;m=cb(j|0,l|0,k|0,b|0)|0;b=cb(m|0,C|0,h|0,d|0)|0;d=g;c[d>>2]=b;c[d+4>>2]=C;d=f+104|0;b=c[d>>2]|0;g=c[d+4>>2]|0;d=f+24|0;h=d;m=c[h>>2]|0;k=c[h+4>>2]|0;h=lb(b|0,g|0,18,0)|0;l=C;j=cb(m|0,k|0,b|0,g|0)|0;g=cb(j|0,C|0,h|0,l|0)|0;l=d;c[l>>2]=g;c[l+4>>2]=C;l=f+96|0;g=c[l>>2]|0;d=c[l+4>>2]|0;l=f+16|0;h=l;j=c[h>>2]|0;b=c[h+4>>2]|0;h=lb(g|0,d|0,18,0)|0;k=C;m=cb(j|0,b|0,g|0,d|0)|0;d=cb(m|0,C|0,h|0,k|0)|0;k=l;c[k>>2]=d;c[k+4>>2]=C;k=f+88|0;d=c[k>>2]|0;l=c[k+4>>2]|0;k=f+8|0;h=k;m=c[h>>2]|0;g=c[h+4>>2]|0;h=lb(d|0,l|0,18,0)|0;b=C;j=cb(m|0,g|0,d|0,l|0)|0;l=cb(j|0,C|0,h|0,b|0)|0;b=k;c[b>>2]=l;c[b+4>>2]=C;b=f+80|0;l=b;h=c[l>>2]|0;j=c[l+4>>2]|0;l=f;d=c[l>>2]|0;g=c[l+4>>2]|0;l=lb(h|0,j|0,18,0)|0;m=C;n=cb(d|0,g|0,h|0,j|0)|0;j=cb(n|0,C|0,l|0,m|0)|0;m=C;l=f;c[l>>2]=j;c[l+4>>2]=m;l=b;c[l>>2]=0;c[l+4>>2]=0;l=m;m=j;j=0;do n=cb(l>>31>>>6|0,0,m|0,l|0)|0,h=ab(n|0,C|0,26)|0,n=C,g=fb(h|0,n|0,26)|0,d=bb(m|0,l|0,g|0,C|0)|0,g=f+(j<<3)|0,c[g>>2]=d,c[g+4>>2]=C,g=f+((j|1)<<3)|0,d=g,o=cb(h|0,n|0,c[d>>2]|0,c[d+4>>2]|0)|0,d=C,n=cb(d>>31>>>7|0,0,o|0,d|0)|0,h=ab(n|0,C|0,25)|0,n=C,p=fb(h|0,n|0,25)|0,q=bb(o|0,d|0,p|0,C|0)|0,p=g,c[p>>2]=q,c[p+4>>2]=C,j=j+2|0,p=f+(j<<3)|0,q=p,m=cb(h|0,n|0,c[q>>2]|0,c[q+4>>2]|0)|0,l=C,q=p,c[q>>2]=m,c[q+4>>2]=l;while(j>>>0<10);j=b;l=c[j>>2]|0;m=c[j+4>>2]|0;j=f;q=c[j>>2]|0;p=c[j+4>>2]|0;j=lb(l|0,m|0,18,0)|0;n=C;h=cb(q|0,p|0,l|0,m|0)|0;m=cb(h|0,C|0,j|0,n|0)|0;n=C;j=b;c[j>>2]=0;c[j+4>>2]=0;j=cb(n>>31>>>6|0,0,m|0,n|0)|0;b=ab(j|0,C|0,26)|0;j=C;h=fb(b|0,j|0,26)|0;l=bb(m|0,n|0,h|0,C|0)|0;h=f;c[h>>2]=l;c[h+4>>2]=C;h=k;l=cb(b|0,j|0,c[h>>2]|0,c[h+4>>2]|0)|0;h=k;c[h>>2]=l;c[h+4>>2]=C;h=a;a=f;f=h+80|0;do c[h>>2]=c[a>>2],h=h+4|0,a=a+4|0;while((h|0)<(f|0));i=e;return}function Ma(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0;e=ab(0,c[b>>2]|0,32)|0;f=C;g=ab(0,c[d>>2]|0,32)|0;h=lb(g|0,C|0,e|0,f|0)|0;f=a;c[f>>2]=h;c[f+4>>2]=C;f=ab(0,c[b>>2]|0,32)|0;h=C;e=d+8|0;g=ab(0,c[e>>2]|0,32)|0;i=lb(g|0,C|0,f|0,h|0)|0;h=C;f=b+8|0;g=ab(0,c[f>>2]|0,32)|0;j=C;k=ab(0,c[d>>2]|0,32)|0;l=lb(k|0,C|0,g|0,j|0)|0;j=cb(l|0,C|0,i|0,h|0)|0;h=a+8|0;c[h>>2]=j;c[h+4>>2]=C;h=ab(0,c[f>>2]|0,31)|0;j=C;i=ab(0,c[e>>2]|0,32)|0;l=lb(i|0,C|0,h|0,j|0)|0;j=C;h=ab(0,c[b>>2]|0,32)|0;i=C;g=d+16|0;k=ab(0,c[g>>2]|0,32)|0;m=lb(k|0,C|0,h|0,i|0)|0;i=cb(m|0,C|0,l|0,j|0)|0;j=C;l=b+16|0;m=ab(0,c[l>>2]|0,32)|0;h=C;k=ab(0,c[d>>2]|0,32)|0;n=lb(k|0,C|0,m|0,h|0)|0;h=cb(i|0,j|0,n|0,C|0)|0;n=a+16|0;c[n>>2]=h;c[n+4>>2]=C;n=ab(0,c[f>>2]|0,32)|0;h=C;j=ab(0,c[g>>2]|0,32)|0;i=lb(j|0,C|0,n|0,h|0)|0;h=C;n=ab(0,c[l>>2]|0,32)|0;j=C;m=ab(0,c[e>>2]|0,32)|0;k=lb(m|0,C|0,n|0,j|0)|0;j=cb(k|0,C|0,i|0,h|0)|0;h=C;i=ab(0,c[b>>2]|0,32)|0;k=C;n=d+24|0;m=ab(0,c[n>>2]|0,32)|0;o=lb(m|0,C|0,i|0,k|0)|0;k=cb(j|0,h|0,o|0,C|0)|0;o=C;h=b+24|0;j=ab(0,c[h>>2]|0,32)|0;i=C;m=ab(0,c[d>>2]|0,32)|0;p=lb(m|0,C|0,j|0,i|0)|0;i=cb(k|0,o|0,p|0,C|0)|0;p=a+24|0;c[p>>2]=i;c[p+4>>2]=C;p=ab(0,c[l>>2]|0,32)|0;i=C;o=ab(0,c[g>>2]|0,32)|0;k=lb(o|0,C|0,p|0,i|0)|0;i=C;p=ab(0,c[f>>2]|0,32)|0;o=C;j=ab(0,c[n>>2]|0,32)|0;m=lb(j|0,C|0,p|0,o|0)|0;o=C;p=ab(0,c[h>>2]|0,32)|0;j=C;q=ab(0,c[e>>2]|0,32)|0;r=lb(q|0,C|0,p|0,j|0)|0;j=cb(r|0,C|0,m|0,o|0)|0;o=fb(j|0,C|0,1)|0;j=cb(o|0,C|0,k|0,i|0)|0;i=C;k=ab(0,c[b>>2]|0,32)|0;o=C;m=d+32|0;r=ab(0,c[m>>2]|0,32)|0;p=lb(r|0,C|0,k|0,o|0)|0;o=cb(j|0,i|0,p|0,C|0)|0;p=C;i=b+32|0;j=ab(0,c[i>>2]|0,32)|0;k=C;r=ab(0,c[d>>2]|0,32)|0;q=lb(r|0,C|0,j|0,k|0)|0;k=cb(o|0,p|0,q|0,C|0)|0;q=a+32|0;c[q>>2]=k;c[q+4>>2]=C;q=ab(0,c[l>>2]|0,32)|0;k=C;p=ab(0,c[n>>2]|0,32)|0;o=lb(p|0,C|0,q|0,k|0)|0;k=C;q=ab(0,c[h>>2]|0,32)|0;p=C;j=ab(0,c[g>>2]|0,32)|0;r=lb(j|0,C|0,q|0,p|0)|0;p=cb(r|0,C|0,o|0,k|0)|0;k=C;o=ab(0,c[f>>2]|0,32)|0;r=C;q=ab(0,c[m>>2]|0,32)|0;j=lb(q|0,C|0,o|0,r|0)|0;r=cb(p|0,k|0,j|0,C|0)|0;j=C;k=ab(0,c[i>>2]|0,32)|0;p=C;o=ab(0,c[e>>2]|0,32)|0;q=lb(o|0,C|0,k|0,p|0)|0;p=cb(r|0,j|0,q|0,C|0)|0;q=C;j=ab(0,c[b>>2]|0,32)|0;r=C;k=d+40|0;o=ab(0,c[k>>2]|0,32)|0;s=lb(o|0,C|0,j|0,r|0)|0;r=cb(p|0,q|0,s|0,C|0)|0;s=C;q=b+40|0;p=ab(0,c[q>>2]|0,32)|0;j=C;o=ab(0,c[d>>2]|0,32)|0;t=lb(o|0,C|0,p|0,j|0)|0;j=cb(r|0,s|0,t|0,C|0)|0;t=a+40|0;c[t>>2]=j;c[t+4>>2]=C;t=ab(0,c[h>>2]|0,32)|0;j=C;s=ab(0,c[n>>2]|0,32)|0;r=lb(s|0,C|0,t|0,j|0)|0;j=C;t=ab(0,c[f>>2]|0,32)|0;s=C;p=ab(0,c[k>>2]|0,32)|0;o=lb(p|0,C|0,t|0,s|0)|0;s=cb(o|0,C|0,r|0,j|0)|0;j=C;r=ab(0,c[q>>2]|0,32)|0;o=C;t=ab(0,c[e>>2]|0,32)|0;p=lb(t|0,C|0,r|0,o|0)|0;o=cb(s|0,j|0,p|0,C|0)|0;p=fb(o|0,C|0,1)|0;o=C;j=ab(0,c[l>>2]|0,32)|0;s=C;r=ab(0,c[m>>2]|0,32)|0;t=lb(r|0,C|0,j|0,s|0)|0;s=cb(p|0,o|0,t|0,C|0)|0;t=C;o=ab(0,c[i>>2]|0,32)|0;p=C;j=ab(0,c[g>>2]|0,32)|0;r=lb(j|0,C|0,o|0,p|0)|0;p=cb(s|0,t|0,r|0,C|0)|0;r=C;t=ab(0,c[b>>2]|0,32)|0;s=C;o=d+48|0;j=ab(0,c[o>>2]|0,32)|0;u=lb(j|0,C|0,t|0,s|0)|0;s=cb(p|0,r|0,u|0,C|0)|0;u=C;r=b+48|0;p=ab(0,c[r>>2]|0,32)|0;t=C;j=ab(0,c[d>>2]|0,32)|0;v=lb(j|0,C|0,p|0,t|0)|0;t=cb(s|0,u|0,v|0,C|0)|0;v=a+48|0;c[v>>2]=t;c[v+4>>2]=C;v=ab(0,c[h>>2]|0,32)|0;t=C;u=ab(0,c[m>>2]|0,32)|0;s=lb(u|0,C|0,v|0,t|0)|0;t=C;v=ab(0,c[i>>2]|0,32)|0;u=C;p=ab(0,c[n>>2]|0,32)|0;j=lb(p|0,C|0,v|0,u|0)|0;u=cb(j|0,C|0,s|0,t|0)|0;t=C;s=ab(0,c[l>>2]|0,32)|0;j=C;v=ab(0,c[k>>2]|0,32)|0;p=lb(v|0,C|0,s|0,j|0)|0;j=cb(u|0,t|0,p|0,C|0)|0;p=C;t=ab(0,c[q>>2]|0,32)|0;u=C;s=ab(0,c[g>>2]|0,32)|0;v=lb(s|0,C|0,t|0,u|0)|0;u=cb(j|0,p|0,v|0,C|0)|0;v=C;p=ab(0,c[f>>2]|0,32)|0;j=C;t=ab(0,c[o>>2]|0,32)|0;s=lb(t|0,C|0,p|0,j|0)|0;j=cb(u|0,v|0,s|0,C|0)|0;s=C;v=ab(0,c[r>>2]|0,32)|0;u=C;p=ab(0,c[e>>2]|0,32)|0;t=lb(p|0,C|0,v|0,u|0)|0;u=cb(j|0,s|0,t|0,C|0)|0;t=C;s=ab(0,c[b>>2]|0,32)|0;j=C;v=d+56|0;p=ab(0,c[v>>2]|0,32)|0;w=lb(p|0,C|0,s|0,j|0)|0;j=cb(u|0,t|0,w|0,C|0)|0;w=C;t=b+56|0;u=ab(0,c[t>>2]|0,32)|0;s=C;p=ab(0,c[d>>2]|0,32)|0;x=lb(p|0,C|0,u|0,s|0)|0;s=cb(j|0,w|0,x|0,C|0)|0;x=a+56|0;c[x>>2]=s;c[x+4>>2]=C;x=ab(0,c[i>>2]|0,32)|0;s=C;w=ab(0,c[m>>2]|0,32)|0;j=lb(w|0,C|0,x|0,s|0)|0;s=C;x=ab(0,c[h>>2]|0,32)|0;w=C;u=ab(0,c[k>>2]|0,32)|0;p=lb(u|0,C|0,x|0,w|0)|0;w=C;x=ab(0,c[q>>2]|0,32)|0;u=C;y=ab(0,c[n>>2]|0,32)|0;z=lb(y|0,C|0,x|0,u|0)|0;u=cb(z|0,C|0,p|0,w|0)|0;w=C;p=ab(0,c[f>>2]|0,32)|0;z=C;x=ab(0,c[v>>2]|0,32)|0;y=lb(x|0,C|0,p|0,z|0)|0;z=cb(u|0,w|0,y|0,C|0)|0;y=C;w=ab(0,c[t>>2]|0,32)|0;u=C;p=ab(0,c[e>>2]|0,32)|0;x=lb(p|0,C|0,w|0,u|0)|0;u=cb(z|0,y|0,x|0,C|0)|0;x=fb(u|0,C|0,1)|0;u=cb(x|0,C|0,j|0,s|0)|0;s=C;j=ab(0,c[l>>2]|0,32)|0;x=C;y=ab(0,c[o>>2]|0,32)|0;z=lb(y|0,C|0,j|0,x|0)|0;x=cb(u|0,s|0,z|0,C|0)|0;z=C;s=ab(0,c[r>>2]|0,32)|0;u=C;j=ab(0,c[g>>2]|0,32)|0;y=lb(j|0,C|0,s|0,u|0)|0;u=cb(x|0,z|0,y|0,C|0)|0;y=C;z=ab(0,c[b>>2]|0,32)|0;x=C;s=d+64|0;j=ab(0,c[s>>2]|0,32)|0;w=lb(j|0,C|0,z|0,x|0)|0;x=cb(u|0,y|0,w|0,C|0)|0;w=C;y=b+64|0;u=ab(0,c[y>>2]|0,32)|0;z=C;j=ab(0,c[d>>2]|0,32)|0;p=lb(j|0,C|0,u|0,z|0)|0;z=cb(x|0,w|0,p|0,C|0)|0;p=a+64|0;c[p>>2]=z;c[p+4>>2]=C;p=ab(0,c[i>>2]|0,32)|0;z=C;w=ab(0,c[k>>2]|0,32)|0;x=lb(w|0,C|0,p|0,z|0)|0;z=C;p=ab(0,c[q>>2]|0,32)|0;w=C;u=ab(0,c[m>>2]|0,32)|0;j=lb(u|0,C|0,p|0,w|0)|0;w=cb(j|0,C|0,x|0,z|0)|0;z=C;x=ab(0,c[h>>2]|0,32)|0;j=C;p=ab(0,c[o>>2]|0,32)|0;u=lb(p|0,C|0,x|0,j|0)|0;j=cb(w|0,z|0,u|0,C|0)|0;u=C;z=ab(0,c[r>>2]|0,32)|0;w=C;x=ab(0,c[n>>2]|0,32)|0;p=lb(x|0,C|0,z|0,w|0)|0;w=cb(j|0,u|0,p|0,C|0)|0;p=C;u=ab(0,c[l>>2]|0,32)|0;j=C;z=ab(0,c[v>>2]|0,32)|0;x=lb(z|0,C|0,u|0,j|0)|0;j=cb(w|0,p|0,x|0,C|0)|0;x=C;p=ab(0,c[t>>2]|0,32)|0;w=C;u=ab(0,c[g>>2]|0,32)|0;z=lb(u|0,C|0,p|0,w|0)|0;w=cb(j|0,x|0,z|0,C|0)|0;z=C;x=ab(0,c[f>>2]|0,32)|0;j=C;p=ab(0,c[s>>2]|0,32)|0;u=lb(p|0,C|0,x|0,j|0)|0;j=cb(w|0,z|0,u|0,C|0)|0;u=C;z=ab(0,c[y>>2]|0,32)|0;w=C;x=ab(0,c[e>>2]|0,32)|0;p=lb(x|0,C|0,z|0,w|0)|0;w=cb(j|0,u|0,p|0,C|0)|0;p=C;u=ab(0,c[b>>2]|0,32)|0;j=C;z=d+72|0;x=ab(0,c[z>>2]|0,32)|0;A=lb(x|0,C|0,u|0,j|0)|0;j=cb(w|0,p|0,A|0,C|0)|0;A=C;p=b+72|0;b=ab(0,c[p>>2]|0,32)|0;w=C;u=ab(0,c[d>>2]|0,32)|0;d=lb(u|0,C|0,b|0,w|0)|0;w=cb(j|0,A|0,d|0,C|0)|0;d=a+72|0;c[d>>2]=w;c[d+4>>2]=C;d=ab(0,c[q>>2]|0,32)|0;w=C;A=ab(0,c[k>>2]|0,32)|0;j=lb(A|0,C|0,d|0,w|0)|0;w=C;d=ab(0,c[h>>2]|0,32)|0;A=C;b=ab(0,c[v>>2]|0,32)|0;u=lb(b|0,C|0,d|0,A|0)|0;A=cb(u|0,C|0,j|0,w|0)|0;w=C;j=ab(0,c[t>>2]|0,32)|0;u=C;d=ab(0,c[n>>2]|0,32)|0;b=lb(d|0,C|0,j|0,u|0)|0;u=cb(A|0,w|0,b|0,C|0)|0;b=C;w=ab(0,c[f>>2]|0,32)|0;f=C;A=ab(0,c[z>>2]|0,32)|0;j=lb(A|0,C|0,w|0,f|0)|0;f=cb(u|0,b|0,j|0,C|0)|0;j=C;b=ab(0,c[p>>2]|0,32)|0;u=C;w=ab(0,c[e>>2]|0,32)|0;e=lb(w|0,C|0,b|0,u|0)|0;u=cb(f|0,j|0,e|0,C|0)|0;e=fb(u|0,C|0,1)|0;u=C;j=ab(0,c[i>>2]|0,32)|0;f=C;b=ab(0,c[o>>2]|0,32)|0;w=lb(b|0,C|0,j|0,f|0)|0;f=cb(e|0,u|0,w|0,C|0)|0;w=C;u=ab(0,c[r>>2]|0,32)|0;e=C;j=ab(0,c[m>>2]|0,32)|0;b=lb(j|0,C|0,u|0,e|0)|0;e=cb(f|0,w|0,b|0,C|0)|0;b=C;w=ab(0,c[l>>2]|0,32)|0;f=C;u=ab(0,c[s>>2]|0,32)|0;j=lb(u|0,C|0,w|0,f|0)|0;f=cb(e|0,b|0,j|0,C|0)|0;j=C;b=ab(0,c[y>>2]|0,32)|0;e=C;w=ab(0,c[g>>2]|0,32)|0;u=lb(w|0,C|0,b|0,e|0)|0;e=cb(f|0,j|0,u|0,C|0)|0;u=a+80|0;c[u>>2]=e;c[u+4>>2]=C;u=ab(0,c[q>>2]|0,32)|0;e=C;j=ab(0,c[o>>2]|0,32)|0;f=lb(j|0,C|0,u|0,e|0)|0;e=C;u=ab(0,c[r>>2]|0,32)|0;j=C;b=ab(0,c[k>>2]|0,32)|0;w=lb(b|0,C|0,u|0,j|0)|0;j=cb(w|0,C|0,f|0,e|0)|0;e=C;f=ab(0,c[i>>2]|0,32)|0;w=C;u=ab(0,c[v>>2]|0,32)|0;b=lb(u|0,C|0,f|0,w|0)|0;w=cb(j|0,e|0,b|0,C|0)|0;b=C;e=ab(0,c[t>>2]|0,32)|0;j=C;f=ab(0,c[m>>2]|0,32)|0;u=lb(f|0,C|0,e|0,j|0)|0;j=cb(w|0,b|0,u|0,C|0)|0;u=C;b=ab(0,c[h>>2]|0,32)|0;w=C;e=ab(0,c[s>>2]|0,32)|0;f=lb(e|0,C|0,b|0,w|0)|0;w=cb(j|0,u|0,f|0,C|0)|0;f=C;u=ab(0,c[y>>2]|0,32)|0;j=C;b=ab(0,c[n>>2]|0,32)|0;e=lb(b|0,C|0,u|0,j|0)|0;j=cb(w|0,f|0,e|0,C|0)|0;e=C;f=ab(0,c[l>>2]|0,32)|0;l=C;w=ab(0,c[z>>2]|0,32)|0;u=lb(w|0,C|0,f|0,l|0)|0;l=cb(j|0,e|0,u|0,C|0)|0;u=C;e=ab(0,c[p>>2]|0,32)|0;j=C;f=ab(0,c[g>>2]|0,32)|0;g=lb(f|0,C|0,e|0,j|0)|0;j=cb(l|0,u|0,g|0,C|0)|0;g=a+88|0;c[g>>2]=j;c[g+4>>2]=C;g=ab(0,c[r>>2]|0,32)|0;j=C;u=ab(0,c[o>>2]|0,32)|0;l=lb(u|0,C|0,g|0,j|0)|0;j=C;g=ab(0,c[q>>2]|0,32)|0;u=C;e=ab(0,c[v>>2]|0,32)|0;f=lb(e|0,C|0,g|0,u|0)|0;u=C;g=ab(0,c[t>>2]|0,32)|0;e=C;w=ab(0,c[k>>2]|0,32)|0;b=lb(w|0,C|0,g|0,e|0)|0;e=cb(b|0,C|0,f|0,u|0)|0;u=C;f=ab(0,c[h>>2]|0,32)|0;h=C;b=ab(0,c[z>>2]|0,32)|0;g=lb(b|0,C|0,f|0,h|0)|0;h=cb(e|0,u|0,g|0,C|0)|0;g=C;u=ab(0,c[p>>2]|0,32)|0;e=C;f=ab(0,c[n>>2]|0,32)|0;n=lb(f|0,C|0,u|0,e|0)|0;e=cb(h|0,g|0,n|0,C|0)|0;n=fb(e|0,C|0,1)|0;e=cb(n|0,C|0,l|0,j|0)|0;j=C;l=ab(0,c[i>>2]|0,32)|0;n=C;g=ab(0,c[s>>2]|0,32)|0;h=lb(g|0,C|0,l|0,n|0)|0;n=cb(e|0,j|0,h|0,C|0)|0;h=C;j=ab(0,c[y>>2]|0,32)|0;e=C;l=ab(0,c[m>>2]|0,32)|0;g=lb(l|0,C|0,j|0,e|0)|0;e=cb(n|0,h|0,g|0,C|0)|0;g=a+96|0;c[g>>2]=e;c[g+4>>2]=C;g=ab(0,c[r>>2]|0,32)|0;e=C;h=ab(0,c[v>>2]|0,32)|0;n=lb(h|0,C|0,g|0,e|0)|0;e=C;g=ab(0,c[t>>2]|0,32)|0;h=C;j=ab(0,c[o>>2]|0,32)|0;l=lb(j|0,C|0,g|0,h|0)|0;h=cb(l|0,C|0,n|0,e|0)|0;e=C;n=ab(0,c[q>>2]|0,32)|0;l=C;g=ab(0,c[s>>2]|0,32)|0;j=lb(g|0,C|0,n|0,l|0)|0;l=cb(h|0,e|0,j|0,C|0)|0;j=C;e=ab(0,c[y>>2]|0,32)|0;h=C;n=ab(0,c[k>>2]|0,32)|0;g=lb(n|0,C|0,e|0,h|0)|0;h=cb(l|0,j|0,g|0,C|0)|0;g=C;j=ab(0,c[i>>2]|0,32)|0;i=C;l=ab(0,c[z>>2]|0,32)|0;e=lb(l|0,C|0,j|0,i|0)|0;i=cb(h|0,g|0,e|0,C|0)|0;e=C;g=ab(0,c[p>>2]|0,32)|0;h=C;j=ab(0,c[m>>2]|0,32)|0;m=lb(j|0,C|0,g|0,h|0)|0;h=cb(i|0,e|0,m|0,C|0)|0;m=a+104|0;c[m>>2]=h;c[m+4>>2]=C;m=ab(0,c[t>>2]|0,32)|0;h=C;e=ab(0,c[v>>2]|0,32)|0;i=lb(e|0,C|0,m|0,h|0)|0;h=C;m=ab(0,c[q>>2]|0,32)|0;q=C;e=ab(0,c[z>>2]|0,32)|0;g=lb(e|0,C|0,m|0,q|0)|0;q=cb(g|0,C|0,i|0,h|0)|0;h=C;i=ab(0,c[p>>2]|0,32)|0;g=C;m=ab(0,c[k>>2]|0,32)|0;k=lb(m|0,C|0,i|0,g|0)|0;g=cb(q|0,h|0,k|0,C|0)|0;k=fb(g|0,C|0,1)|0;g=C;h=ab(0,c[r>>2]|0,32)|0;q=C;i=ab(0,c[s>>2]|0,32)|0;m=lb(i|0,C|0,h|0,q|0)|0;q=cb(k|0,g|0,m|0,C|0)|0;m=C;g=ab(0,c[y>>2]|0,32)|0;k=C;h=ab(0,c[o>>2]|0,32)|0;i=lb(h|0,C|0,g|0,k|0)|0;k=cb(q|0,m|0,i|0,C|0)|0;i=a+112|0;c[i>>2]=k;c[i+4>>2]=C;i=ab(0,c[t>>2]|0,32)|0;k=C;m=ab(0,c[s>>2]|0,32)|0;q=lb(m|0,C|0,i|0,k|0)|0;k=C;i=ab(0,c[y>>2]|0,32)|0;m=C;g=ab(0,c[v>>2]|0,32)|0;h=lb(g|0,C|0,i|0,m|0)|0;m=cb(h|0,C|0,q|0,k|0)|0;k=C;q=ab(0,c[r>>2]|0,32)|0;r=C;h=ab(0,c[z>>2]|0,32)|0;i=lb(h|0,C|0,q|0,r|0)|0;r=cb(m|0,k|0,i|0,C|0)|0;i=C;k=ab(0,c[p>>2]|0,32)|0;m=C;q=ab(0,c[o>>2]|0,32)|0;o=lb(q|0,C|0,k|0,m|0)|0;m=cb(r|0,i|0,o|0,C|0)|0;o=a+120|0;c[o>>2]=m;c[o+4>>2]=C;o=ab(0,c[y>>2]|0,32)|0;m=C;i=ab(0,c[s>>2]|0,32)|0;r=lb(i|0,C|0,o|0,m|0)|0;m=C;o=ab(0,c[t>>2]|0,32)|0;t=C;i=ab(0,c[z>>2]|0,32)|0;k=lb(i|0,C|0,o|0,t|0)|0;t=C;o=ab(0,c[p>>2]|0,32)|0;i=C;q=ab(0,c[v>>2]|0,32)|0;v=lb(q|0,C|0,o|0,i|0)|0;i=cb(v|0,C|0,k|0,t|0)|0;t=fb(i|0,C|0,1)|0;i=cb(t|0,C|0,r|0,m|0)|0;m=a+128|0;c[m>>2]=i;c[m+4>>2]=C;m=ab(0,c[y>>2]|0,32)|0;y=C;i=ab(0,c[z>>2]|0,32)|0;r=lb(i|0,C|0,m|0,y|0)|0;y=C;m=ab(0,c[p>>2]|0,32)|0;i=C;t=ab(0,c[s>>2]|0,32)|0;s=lb(t|0,C|0,m|0,i|0)|0;i=cb(s|0,C|0,r|0,y|0)|0;y=a+136|0;c[y>>2]=i;c[y+4>>2]=C;y=ab(0,c[p>>2]|0,31)|0;p=C;i=ab(0,c[z>>2]|0,32)|0;z=lb(i|0,C|0,y|0,p|0)|0;p=a+144|0;c[p>>2]=z;c[p+4>>2]=C;return}function Na(a,b){a=a|0;b=b|0;var d=0,e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0,M=0,N=0,O=0,P=0,Q=0,R=0,S=0;d=i;i=i+160|0;e=d;f=c[b>>2]|0;g=ab(0,f|0,32)|0;h=C;j=lb(g|0,h|0,g|0,h|0)|0;k=e;c[k>>2]=j;c[k+4>>2]=C;k=ab(0,f|0,31)|0;f=C;j=b+8|0;l=c[j>>2]|0;m=ab(0,l|0,32)|0;n=C;o=lb(m|0,n|0,k|0,f|0)|0;p=e+8|0;q=p;c[q>>2]=o;c[q+4>>2]=C;q=lb(m|0,n|0,m|0,n|0)|0;o=C;r=b+16|0;s=ab(0,c[r>>2]|0,32)|0;t=C;u=lb(s|0,t|0,g|0,h|0)|0;v=cb(u|0,C|0,q|0,o|0)|0;o=fb(v|0,C|0,1)|0;v=e+16|0;q=v;c[q>>2]=o;c[q+4>>2]=C;q=lb(s|0,t|0,m|0,n|0)|0;o=C;u=b+24|0;w=ab(0,c[u>>2]|0,32)|0;x=C;y=lb(w|0,x|0,g|0,h|0)|0;z=cb(y|0,C|0,q|0,o|0)|0;o=fb(z|0,C|0,1)|0;z=e+24|0;q=z;c[q>>2]=o;c[q+4>>2]=C;q=lb(s|0,t|0,s|0,t|0)|0;o=C;y=ab(0,l|0,30)|0;A=lb(w|0,x|0,y|0,C|0)|0;y=cb(A|0,C|0,q|0,o|0)|0;o=C;q=b+32|0;A=ab(0,c[q>>2]|0,32)|0;B=C;D=lb(A|0,B|0,k|0,f|0)|0;f=cb(y|0,o|0,D|0,C|0)|0;D=e+32|0;o=D;c[o>>2]=f;c[o+4>>2]=C;o=lb(w|0,x|0,s|0,t|0)|0;f=C;y=lb(A|0,B|0,m|0,n|0)|0;k=cb(y|0,C|0,o|0,f|0)|0;f=C;o=b+40|0;y=ab(0,c[o>>2]|0,32)|0;E=C;F=lb(y|0,E|0,g|0,h|0)|0;G=cb(k|0,f|0,F|0,C|0)|0;F=fb(G|0,C|0,1)|0;G=e+40|0;f=G;c[f>>2]=F;c[f+4>>2]=C;f=lb(w|0,x|0,w|0,x|0)|0;F=C;k=lb(A|0,B|0,s|0,t|0)|0;H=cb(k|0,C|0,f|0,F|0)|0;F=C;f=b+48|0;k=ab(0,c[f>>2]|0,32)|0;I=C;J=lb(k|0,I|0,g|0,h|0)|0;K=cb(H|0,F|0,J|0,C|0)|0;J=C;F=ab(0,l|0,31)|0;l=lb(y|0,E|0,F|0,C|0)|0;F=cb(K|0,J|0,l|0,C|0)|0;l=fb(F|0,C|0,1)|0;F=e+48|0;J=F;c[J>>2]=l;c[J+4>>2]=C;J=lb(A|0,B|0,w|0,x|0)|0;l=C;K=lb(y|0,E|0,s|0,t|0)|0;H=cb(K|0,C|0,J|0,l|0)|0;l=C;J=lb(k|0,I|0,m|0,n|0)|0;K=cb(H|0,l|0,J|0,C|0)|0;J=C;l=b+56|0;H=ab(0,c[l>>2]|0,32)|0;L=C;M=lb(H|0,L|0,g|0,h|0)|0;N=cb(K|0,J|0,M|0,C|0)|0;M=fb(N|0,C|0,1)|0;N=e+56|0;J=N;c[J>>2]=M;c[J+4>>2]=C;J=lb(A|0,B|0,A|0,B|0)|0;M=C;K=lb(k|0,I|0,s|0,t|0)|0;O=C;P=b+64|0;Q=ab(0,c[P>>2]|0,32)|0;R=C;S=lb(Q|0,R|0,g|0,h|0)|0;h=cb(S|0,C|0,K|0,O|0)|0;O=C;K=lb(H|0,L|0,m|0,n|0)|0;n=C;m=lb(y|0,E|0,w|0,x|0)|0;S=cb(m|0,C|0,K|0,n|0)|0;n=fb(S|0,C|0,1)|0;S=cb(h|0,O|0,n|0,C|0)|0;n=fb(S|0,C|0,1)|0;S=cb(n|0,C|0,J|0,M|0)|0;M=e+64|0;J=M;c[J>>2]=S;c[J+4>>2]=C;J=lb(y|0,E|0,A|0,B|0)|0;S=C;n=lb(k|0,I|0,w|0,x|0)|0;x=cb(n|0,C|0,J|0,S|0)|0;S=C;J=lb(H|0,L|0,s|0,t|0)|0;t=cb(x|0,S|0,J|0,C|0)|0;J=C;S=ab(0,c[j>>2]|0,32)|0;j=C;x=lb(Q|0,R|0,S|0,j|0)|0;s=cb(t|0,J|0,x|0,C|0)|0;x=C;J=ab(0,c[b>>2]|0,32)|0;t=C;n=c[b+72>>2]|0;b=ab(0,n|0,32)|0;w=C;O=lb(b|0,w|0,J|0,t|0)|0;t=cb(s|0,x|0,O|0,C|0)|0;O=fb(t|0,C|0,1)|0;t=e+72|0;c[t>>2]=O;c[t+4>>2]=C;t=lb(y|0,E|0,y|0,E|0)|0;O=C;x=lb(k|0,I|0,A|0,B|0)|0;B=cb(x|0,C|0,t|0,O|0)|0;O=C;t=ab(0,c[r>>2]|0,32)|0;r=C;x=lb(Q|0,R|0,t|0,r|0)|0;A=cb(B|0,O|0,x|0,C|0)|0;x=C;O=ab(0,c[u>>2]|0,32)|0;u=C;B=lb(H|0,L|0,O|0,u|0)|0;s=C;J=lb(b|0,w|0,S|0,j|0)|0;j=cb(J|0,C|0,B|0,s|0)|0;s=fb(j|0,C|0,1)|0;j=cb(A|0,x|0,s|0,C|0)|0;s=fb(j|0,C|0,1)|0;j=e+80|0;x=j;c[x>>2]=s;c[x+4>>2]=C;x=lb(k|0,I|0,y|0,E|0)|0;E=C;y=ab(0,c[q>>2]|0,32)|0;q=C;s=lb(H|0,L|0,y|0,q|0)|0;A=cb(s|0,C|0,x|0,E|0)|0;E=C;x=lb(Q|0,R|0,O|0,u|0)|0;s=cb(A|0,E|0,x|0,C|0)|0;x=C;E=lb(b|0,w|0,t|0,r|0)|0;r=cb(s|0,x|0,E|0,C|0)|0;E=C;x=fb(r|0,E|0,1)|0;s=C;t=e+88|0;c[t>>2]=x;c[t+4>>2]=s;t=lb(k|0,I|0,k|0,I|0)|0;I=C;k=lb(Q|0,R|0,y|0,q|0)|0;A=C;B=c[o>>2]|0;o=ab(0,B|0,32)|0;J=C;S=lb(H|0,L|0,o|0,J|0)|0;h=C;K=lb(b|0,w|0,O|0,u|0)|0;u=cb(K|0,C|0,S|0,h|0)|0;h=fb(u|0,C|0,1)|0;u=cb(h|0,C|0,k|0,A|0)|0;A=fb(u|0,C|0,1)|0;u=cb(A|0,C|0,t|0,I|0)|0;I=C;t=e+96|0;c[t>>2]=u;c[t+4>>2]=I;t=ab(0,c[f>>2]|0,32)|0;f=C;A=lb(H|0,L|0,t|0,f|0)|0;L=C;H=lb(Q|0,R|0,o|0,J|0)|0;J=cb(H|0,C|0,A|0,L|0)|0;L=C;A=lb(b|0,w|0,y|0,q|0)|0;q=cb(J|0,L|0,A|0,C|0)|0;A=C;L=fb(q|0,A|0,1)|0;J=C;y=e+104|0;c[y>>2]=L;c[y+4>>2]=J;y=c[l>>2]|0;l=ab(0,y|0,32)|0;H=C;o=lb(l|0,H|0,l|0,H|0)|0;k=C;h=lb(Q|0,R|0,t|0,f|0)|0;R=cb(h|0,C|0,o|0,k|0)|0;k=C;o=ab(0,B|0,31)|0;B=lb(b|0,w|0,o|0,C|0)|0;o=cb(R|0,k|0,B|0,C|0)|0;B=C;k=fb(o|0,B|0,1)|0;R=C;h=e+112|0;c[h>>2]=k;c[h+4>>2]=R;h=c[P>>2]|0;P=ab(0,h|0,32)|0;Q=C;S=lb(P|0,Q|0,l|0,H|0)|0;H=C;l=lb(b|0,w|0,t|0,f|0)|0;f=cb(l|0,C|0,S|0,H|0)|0;H=C;S=fb(f|0,H|0,1)|0;l=C;t=e+120|0;c[t>>2]=S;c[t+4>>2]=l;t=lb(P|0,Q|0,P|0,Q|0)|0;Q=C;P=ab(0,y|0,30)|0;y=lb(b|0,w|0,P|0,C|0)|0;P=cb(y|0,C|0,t|0,Q|0)|0;Q=C;t=e+128|0;c[t>>2]=P;c[t+4>>2]=Q;t=ab(0,h|0,31)|0;h=lb(b|0,w|0,t|0,C|0)|0;t=C;y=e+136|0;c[y>>2]=h;c[y+4>>2]=t;y=ab(0,n|0,31)|0;n=lb(y|0,C|0,b|0,w|0)|0;w=C;b=e+144|0;c[b>>2]=n;c[b+4>>2]=w;b=M;y=c[b>>2]|0;K=c[b+4>>2]|0;b=lb(n|0,w|0,18,0)|0;O=C;m=cb(n|0,w|0,y|0,K|0)|0;K=cb(m|0,C|0,b|0,O|0)|0;O=M;c[O>>2]=K;c[O+4>>2]=C;O=N;K=c[O>>2]|0;M=c[O+4>>2]|0;O=lb(h|0,t|0,18,0)|0;b=C;m=cb(K|0,M|0,h|0,t|0)|0;t=cb(m|0,C|0,O|0,b|0)|0;b=N;c[b>>2]=t;c[b+4>>2]=C;b=F;t=c[b>>2]|0;N=c[b+4>>2]|0;b=lb(P|0,Q|0,18,0)|0;O=C;m=cb(t|0,N|0,P|0,Q|0)|0;Q=cb(m|0,C|0,b|0,O|0)|0;O=F;c[O>>2]=Q;c[O+4>>2]=C;O=G;Q=c[O>>2]|0;F=c[O+4>>2]|0;O=lb(f|0,H|0,36,0)|0;H=C;f=cb(Q|0,F|0,S|0,l|0)|0;l=cb(f|0,C|0,O|0,H|0)|0;H=G;c[H>>2]=l;c[H+4>>2]=C;H=D;l=c[H>>2]|0;G=c[H+4>>2]|0;H=lb(o|0,B|0,36,0)|0;B=C;o=cb(l|0,G|0,k|0,R|0)|0;R=cb(o|0,C|0,H|0,B|0)|0;B=D;c[B>>2]=R;c[B+4>>2]=C;B=z;R=c[B>>2]|0;D=c[B+4>>2]|0;B=lb(q|0,A|0,36,0)|0;A=C;q=cb(R|0,D|0,L|0,J|0)|0;J=cb(q|0,C|0,B|0,A|0)|0;A=z;c[A>>2]=J;c[A+4>>2]=C;A=v;J=c[A>>2]|0;z=c[A+4>>2]|0;A=lb(u|0,I|0,18,0)|0;B=C;q=cb(J|0,z|0,u|0,I|0)|0;I=cb(q|0,C|0,A|0,B|0)|0;B=v;c[B>>2]=I;c[B+4>>2]=C;B=p;I=c[B>>2]|0;v=c[B+4>>2]|0;B=lb(r|0,E|0,36,0)|0;E=C;r=cb(I|0,v|0,x|0,s|0)|0;s=cb(r|0,C|0,B|0,E|0)|0;E=p;c[E>>2]=s;c[E+4>>2]=C;E=j;s=c[E>>2]|0;B=c[E+4>>2]|0;E=e;r=c[E>>2]|0;x=c[E+4>>2]|0;E=lb(s|0,B|0,18,0)|0;v=C;I=cb(r|0,x|0,s|0,B|0)|0;B=cb(I|0,C|0,E|0,v|0)|0;v=C;E=e;c[E>>2]=B;c[E+4>>2]=v;E=j;c[E>>2]=0;c[E+4>>2]=0;E=v;v=B;B=0;do I=cb(E>>31>>>6|0,0,v|0,E|0)|0,s=ab(I|0,C|0,26)|0,I=C,x=fb(s|0,I|0,26)|0,r=bb(v|0,E|0,x|0,C|0)|0,x=e+(B<<3)|0,c[x>>2]=r,c[x+4>>2]=C,x=e+((B|1)<<3)|0,r=x,A=cb(s|0,I|0,c[r>>2]|0,c[r+4>>2]|0)|0,r=C,I=cb(r>>31>>>7|0,0,A|0,r|0)|0,s=ab(I|0,C|0,25)|0,I=C,q=fb(s|0,I|0,25)|0,u=bb(A|0,r|0,q|0,C|0)|0,q=x,c[q>>2]=u,c[q+4>>2]=C,B=B+2|0,q=e+(B<<3)|0,u=q,v=cb(s|0,I|0,c[u>>2]|0,c[u+4>>2]|0)|0,E=C,u=q,c[u>>2]=v,c[u+4>>2]=E;while(B>>>0<10);B=j;E=c[B>>2]|0;v=c[B+4>>2]|0;B=e;u=c[B>>2]|0;q=c[B+4>>2]|0;B=lb(E|0,v|0,18,0)|0;I=C;s=cb(u|0,q|0,E|0,v|0)|0;v=cb(s|0,C|0,B|0,I|0)|0;I=C;B=j;c[B>>2]=0;c[B+4>>2]=0;B=cb(I>>31>>>6|0,0,v|0,I|0)|0;j=ab(B|0,C|0,26)|0;B=C;s=fb(j|0,B|0,26)|0;E=bb(v|0,I|0,s|0,C|0)|0;s=e;c[s>>2]=E;c[s+4>>2]=C;s=p;E=cb(j|0,B|0,c[s>>2]|0,c[s+4>>2]|0)|0;s=p;c[s>>2]=E;c[s+4>>2]=C;s=a;a=e;e=s+80|0;do c[s>>2]=c[a>>2],s=s+4|0,a=a+4|0;while((s|0)<(e|0));i=d;return}function Oa(){var a=0;!(c[2]|0)?a=56:a=c[(ja()|0)+60>>2]|0;return a|0}function Pa(a){a=a|0;var b=0;a>>>0>4294963200?(c[(Oa()|0)>>2]=0-a,b=-1):b=a;return b|0}function Qa(a){a=a|0;return 0}function Ra(a){a=a|0;return}function Sa(a){a=a|0;var b=0,d=0;b=i;i=i+16|0;d=b;c[d>>2]=c[a+60>>2];a=Pa(ka(6,d|0)|0)|0;i=b;return a|0}function Ta(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,g=0,h=0;e=i;i=i+32|0;f=e;g=e+20|0;c[f>>2]=c[a+60>>2];c[f+4>>2]=0;c[f+8>>2]=b;c[f+12>>2]=g;c[f+16>>2]=d;(Pa(ta(140,f|0)|0)|0)<0?(c[g>>2]=-1,h=-1):h=c[g>>2]|0;i=e;return h|0}function Ua(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0;e=i;i=i+48|0;f=e+16|0;g=e;h=e+32|0;j=a+28|0;k=c[j>>2]|0;c[h>>2]=k;l=a+20|0;m=(c[l>>2]|0)-k|0;c[h+4>>2]=m;c[h+8>>2]=b;c[h+12>>2]=d;b=a+60|0;k=a+44|0;n=h;h=2;o=m+d|0;while(1){!(c[2]|0)?(c[f>>2]=c[b>>2],c[f+4>>2]=n,c[f+8>>2]=h,p=Pa(wa(146,f|0)|0)|0):(ua(1,a|0),c[g>>2]=c[b>>2],c[g+4>>2]=n,c[g+8>>2]=h,m=Pa(wa(146,g|0)|0)|0,ga(0),p=m);if((o|0)==(p|0)){q=6;break}if((p|0)<0){r=n;s=h;q=8;break}m=o-p|0;t=c[n+4>>2]|0;p>>>0<=t>>>0?(h|0)==2?(c[j>>2]=(c[j>>2]|0)+p,u=t,v=p,w=n,x=2):(u=t,v=p,w=n,x=h):(y=c[k>>2]|0,c[j>>2]=y,c[l>>2]=y,u=c[n+12>>2]|0,v=p-t|0,w=n+8|0,x=h+-1|0);c[w>>2]=(c[w>>2]|0)+v;c[w+4>>2]=u-v;n=w;h=x;o=m}(q|0)==6?(o=c[k>>2]|0,c[a+16>>2]=o+(c[a+48>>2]|0),k=o,c[j>>2]=k,c[l>>2]=k,z=d):(q|0)==8&&(c[a+16>>2]=0,c[j>>2]=0,c[l>>2]=0,c[a>>2]=c[a>>2]|32,(s|0)==2?z=0:z=d-(c[r+4>>2]|0)|0);i=e;return z|0}function Va(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,g=0;f=i;i=i+80|0;g=f;c[b+36>>2]=3;((c[b>>2]&64|0)==0?(c[g>>2]=c[b+60>>2],c[g+4>>2]=21505,c[g+8>>2]=f+12,(ra(54,g|0)|0)!=0):0)&&(a[b+75>>0]=-1);g=Ua(b,d,e)|0;i=f;return g|0}function Wa(a){a=a|0;var b=0,d=0,e=0,f=0,g=0,h=0,i=0;do if(a){if((c[a+76>>2]|0)<=-1){b=Ya(a)|0;break}d=(Qa(a)|0)==0;e=Ya(a)|0;d?b=e:(Ra(a),b=e)}else{!(c[13]|0)?f=0:f=Wa(c[13]|0)|0;ha(36);e=c[8]|0;if(!e)g=f;else{d=e;e=f;while(1){(c[d+76>>2]|0)>-1?h=Qa(d)|0:h=0;(c[d+20>>2]|0)>>>0>(c[d+28>>2]|0)>>>0?i=Ya(d)|0|e:i=e;h&&Ra(d);d=c[d+56>>2]|0;if(!d){g=i;break}else e=i}}sa(36);b=g}while(0);return b|0}function Xa(a){a=a|0;c[a+68>>2]|0||Ra(a);return}function Ya(a){a=a|0;var b=0,d=0,e=0,f=0,g=0,h=0,i=0;b=a+20|0;d=a+28|0;((c[b>>2]|0)>>>0>(c[d>>2]|0)>>>0?(za[c[a+36>>2]&3](a,0,0)|0,(c[b>>2]|0)==0):0)?e=-1:(f=a+4|0,g=c[f>>2]|0,h=a+8|0,i=c[h>>2]|0,g>>>0<i>>>0&&za[c[a+40>>2]&3](a,g-i|0,1)|0,c[a+16>>2]=0,c[d>>2]=0,c[b>>2]=0,c[h>>2]=0,c[f>>2]=0,e=0);return e|0}function Za(a){a=a|0;var b=0,d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0,M=0,N=0,O=0,P=0,Q=0,R=0,S=0,T=0,U=0,V=0,W=0,X=0,Y=0,Z=0,_=0,$=0,aa=0,ba=0,ca=0,da=0,ea=0,fa=0,ga=0,ha=0,ia=0,ja=0,ka=0,la=0,pa=0,qa=0,ra=0,sa=0,ta=0,ua=0,wa=0,xa=0,ya=0,za=0,Aa=0,Ba=0,Ca=0,Da=0,Ea=0,Fa=0,Ga=0,Ha=0,Ia=0,Ja=0,Ka=0,La=0,Ma=0,Na=0,Pa=0,Qa=0,Ra=0;do if(a>>>0<245){b=a>>>0<11?16:a+11&-8;d=b>>>3;e=c[43]|0;f=e>>>d;if(f&3){g=(f&1^1)+d|0;h=212+(g<<1<<2)|0;i=h+8|0;j=c[i>>2]|0;k=j+8|0;l=c[k>>2]|0;do if((h|0)!=(l|0)){l>>>0<(c[47]|0)>>>0&&ma();m=l+12|0;if((c[m>>2]|0)==(j|0)){c[m>>2]=h;c[i>>2]=l;break}else ma()}else c[43]=e&~(1<<g);while(0);l=g<<3;c[j+4>>2]=l|3;i=j+l+4|0;c[i>>2]=c[i>>2]|1;n=k;return n|0}i=c[45]|0;if(b>>>0>i>>>0){if(f){l=2<<d;h=f<<d&(l|0-l);l=(h&0-h)+-1|0;h=l>>>12&16;m=l>>>h;l=m>>>5&8;o=m>>>l;m=o>>>2&4;p=o>>>m;o=p>>>1&2;q=p>>>o;p=q>>>1&1;r=(l|h|m|o|p)+(q>>>p)|0;p=212+(r<<1<<2)|0;q=p+8|0;o=c[q>>2]|0;m=o+8|0;h=c[m>>2]|0;do if((p|0)!=(h|0)){h>>>0<(c[47]|0)>>>0&&ma();l=h+12|0;if((c[l>>2]|0)==(o|0)){c[l>>2]=p;c[q>>2]=h;s=c[45]|0;break}else ma()}else c[43]=e&~(1<<r),s=i;while(0);i=(r<<3)-b|0;c[o+4>>2]=b|3;e=o+b|0;c[e+4>>2]=i|1;c[e+i>>2]=i;s&&(h=c[48]|0,q=s>>>3,p=212+(q<<1<<2)|0,d=c[43]|0,f=1<<q,d&f?(q=p+8|0,k=c[q>>2]|0,k>>>0<(c[47]|0)>>>0?ma():(t=q,u=k)):(c[43]=d|f,t=p+8|0,u=p),c[t>>2]=h,c[u+12>>2]=h,c[h+8>>2]=u,c[h+12>>2]=p);c[45]=i;c[48]=e;n=m;return n|0}e=c[44]|0;if(e){i=(e&0-e)+-1|0;e=i>>>12&16;p=i>>>e;i=p>>>5&8;h=p>>>i;p=h>>>2&4;f=h>>>p;h=f>>>1&2;d=f>>>h;f=d>>>1&1;k=c[476+((i|e|p|h|f)+(d>>>f)<<2)>>2]|0;f=(c[k+4>>2]&-8)-b|0;d=k;h=k;while(1){k=c[d+16>>2]|0;if(!k){p=c[d+20>>2]|0;if(!p){v=f;w=h;break}else x=p}else x=k;k=(c[x+4>>2]&-8)-b|0;p=k>>>0<f>>>0;f=p?k:f;d=x;h=p?x:h}h=c[47]|0;w>>>0<h>>>0&&ma();d=w+b|0;w>>>0>=d>>>0&&ma();f=c[w+24>>2]|0;m=c[w+12>>2]|0;do if((m|0)==(w|0)){o=w+20|0;r=c[o>>2]|0;if(!r){p=w+16|0;k=c[p>>2]|0;if(!k){y=0;break}else z=k,A=p}else z=r,A=o;while(1){o=z+20|0;r=c[o>>2]|0;if(r){z=r;A=o;continue}o=z+16|0;r=c[o>>2]|0;if(!r){B=z;C=A;break}else z=r,A=o}if(C>>>0<h>>>0)ma();else{c[C>>2]=0;y=B;break}}else{o=c[w+8>>2]|0;o>>>0<h>>>0&&ma();r=o+12|0;(c[r>>2]|0)!=(w|0)&&ma();p=m+8|0;if((c[p>>2]|0)==(w|0)){c[r>>2]=m;c[p>>2]=o;y=m;break}else ma()}while(0);do if(f){m=c[w+28>>2]|0;h=476+(m<<2)|0;if((w|0)==(c[h>>2]|0)){c[h>>2]=y;if(!y){c[44]=c[44]&~(1<<m);break}}else{f>>>0<(c[47]|0)>>>0&&ma();m=f+16|0;(c[m>>2]|0)==(w|0)?c[m>>2]=y:c[f+20>>2]=y;if(!y)break}m=c[47]|0;y>>>0<m>>>0&&ma();c[y+24>>2]=f;h=c[w+16>>2]|0;do if(h)if(h>>>0<m>>>0)ma();else{c[y+16>>2]=h;c[h+24>>2]=y;break}while(0);h=c[w+20>>2]|0;if(h)if(h>>>0<(c[47]|0)>>>0)ma();else{c[y+20>>2]=h;c[h+24>>2]=y;break}}while(0);v>>>0<16?(f=v+b|0,c[w+4>>2]=f|3,h=w+f+4|0,c[h>>2]=c[h>>2]|1):(c[w+4>>2]=b|3,c[d+4>>2]=v|1,c[d+v>>2]=v,h=c[45]|0,h&&(f=c[48]|0,m=h>>>3,h=212+(m<<1<<2)|0,o=c[43]|0,p=1<<m,o&p?(m=h+8|0,r=c[m>>2]|0,r>>>0<(c[47]|0)>>>0?ma():(D=m,E=r)):(c[43]=o|p,D=h+8|0,E=h),c[D>>2]=f,c[E+12>>2]=f,c[f+8>>2]=E,c[f+12>>2]=h),c[45]=v,c[48]=d);n=w+8|0;return n|0}else F=b}else F=b}else if(a>>>0<=4294967231){h=a+11|0;f=h&-8;p=c[44]|0;if(p){o=0-f|0;r=h>>>8;r?f>>>0>16777215?G=31:(h=(r+1048320|0)>>>16&8,m=r<<h,r=(m+520192|0)>>>16&4,k=m<<r,m=(k+245760|0)>>>16&2,e=14-(r|h|m)+(k<<m>>>15)|0,G=f>>>(e+7|0)&1|e<<1):G=0;e=c[476+(G<<2)>>2]|0;a:do if(!e)H=o,I=0,J=0,K=86;else{m=o;k=0;h=f<<((G|0)==31?0:25-(G>>>1)|0);r=e;i=0;while(1){q=c[r+4>>2]&-8;j=q-f|0;if(j>>>0<m>>>0)if((q|0)==(f|0)){L=j;M=r;N=r;K=90;break a}else O=j,P=r;else O=m,P=i;j=c[r+20>>2]|0;r=c[r+16+(h>>>31<<2)>>2]|0;q=(j|0)==0|(j|0)==(r|0)?k:j;j=(r|0)==0;if(j){H=O;I=q;J=P;K=86;break}else m=O,k=q,h=h<<(j&1^1),i=P}}while(0);if((K|0)==86){if((I|0)==0&(J|0)==0){e=2<<G;o=p&(e|0-e);if(!o){F=f;break}e=(o&0-o)+-1|0;o=e>>>12&16;b=e>>>o;e=b>>>5&8;d=b>>>e;b=d>>>2&4;i=d>>>b;d=i>>>1&2;h=i>>>d;i=h>>>1&1;Q=c[476+((e|o|b|d|i)+(h>>>i)<<2)>>2]|0}else Q=I;!Q?(R=H,S=J):(L=H,M=Q,N=J,K=90)}if((K|0)==90)while(1){K=0;i=(c[M+4>>2]&-8)-f|0;h=i>>>0<L>>>0;d=h?i:L;i=h?M:N;h=c[M+16>>2]|0;if(h){L=d;M=h;N=i;K=90;continue}M=c[M+20>>2]|0;if(!M){R=d;S=i;break}else L=d,N=i,K=90}if((S|0)!=0?R>>>0<((c[45]|0)-f|0)>>>0:0){p=c[47]|0;S>>>0<p>>>0&&ma();i=S+f|0;S>>>0>=i>>>0&&ma();d=c[S+24>>2]|0;h=c[S+12>>2]|0;do if((h|0)==(S|0)){b=S+20|0;o=c[b>>2]|0;if(!o){e=S+16|0;k=c[e>>2]|0;if(!k){T=0;break}else U=k,V=e}else U=o,V=b;while(1){b=U+20|0;o=c[b>>2]|0;if(o){U=o;V=b;continue}b=U+16|0;o=c[b>>2]|0;if(!o){W=U;X=V;break}else U=o,V=b}if(X>>>0<p>>>0)ma();else{c[X>>2]=0;T=W;break}}else{b=c[S+8>>2]|0;b>>>0<p>>>0&&ma();o=b+12|0;(c[o>>2]|0)!=(S|0)&&ma();e=h+8|0;if((c[e>>2]|0)==(S|0)){c[o>>2]=h;c[e>>2]=b;T=h;break}else ma()}while(0);do if(d){h=c[S+28>>2]|0;p=476+(h<<2)|0;if((S|0)==(c[p>>2]|0)){c[p>>2]=T;if(!T){c[44]=c[44]&~(1<<h);break}}else{d>>>0<(c[47]|0)>>>0&&ma();h=d+16|0;(c[h>>2]|0)==(S|0)?c[h>>2]=T:c[d+20>>2]=T;if(!T)break}h=c[47]|0;T>>>0<h>>>0&&ma();c[T+24>>2]=d;p=c[S+16>>2]|0;do if(p)if(p>>>0<h>>>0)ma();else{c[T+16>>2]=p;c[p+24>>2]=T;break}while(0);p=c[S+20>>2]|0;if(p)if(p>>>0<(c[47]|0)>>>0)ma();else{c[T+20>>2]=p;c[p+24>>2]=T;break}}while(0);do if(R>>>0>=16){c[S+4>>2]=f|3;c[i+4>>2]=R|1;c[i+R>>2]=R;d=R>>>3;if(R>>>0<256){p=212+(d<<1<<2)|0;h=c[43]|0;b=1<<d;h&b?(d=p+8|0,e=c[d>>2]|0,e>>>0<(c[47]|0)>>>0?ma():(Y=d,Z=e)):(c[43]=h|b,Y=p+8|0,Z=p);c[Y>>2]=i;c[Z+12>>2]=i;c[i+8>>2]=Z;c[i+12>>2]=p;break}p=R>>>8;p?R>>>0>16777215?_=31:(b=(p+1048320|0)>>>16&8,h=p<<b,p=(h+520192|0)>>>16&4,e=h<<p,h=(e+245760|0)>>>16&2,d=14-(p|b|h)+(e<<h>>>15)|0,_=R>>>(d+7|0)&1|d<<1):_=0;d=476+(_<<2)|0;c[i+28>>2]=_;h=i+16|0;c[h+4>>2]=0;c[h>>2]=0;h=c[44]|0;e=1<<_;if(!(h&e)){c[44]=h|e;c[d>>2]=i;c[i+24>>2]=d;c[i+12>>2]=i;c[i+8>>2]=i;break}e=R<<((_|0)==31?0:25-(_>>>1)|0);h=c[d>>2]|0;while(1){if((c[h+4>>2]&-8|0)==(R|0)){$=h;K=148;break}d=h+16+(e>>>31<<2)|0;b=c[d>>2]|0;if(!b){aa=d;ba=h;K=145;break}else e=e<<1,h=b}if((K|0)==145)if(aa>>>0<(c[47]|0)>>>0)ma();else{c[aa>>2]=i;c[i+24>>2]=ba;c[i+12>>2]=i;c[i+8>>2]=i;break}else if((K|0)==148){h=$+8|0;e=c[h>>2]|0;b=c[47]|0;if(e>>>0>=b>>>0&$>>>0>=b>>>0){c[e+12>>2]=i;c[h>>2]=i;c[i+8>>2]=e;c[i+12>>2]=$;c[i+24>>2]=0;break}else ma()}}else e=R+f|0,c[S+4>>2]=e|3,h=S+e+4|0,c[h>>2]=c[h>>2]|1;while(0);n=S+8|0;return n|0}else F=f}else F=f}else F=-1;while(0);S=c[45]|0;if(S>>>0>=F>>>0){R=S-F|0;$=c[48]|0;R>>>0>15?(ba=$+F|0,c[48]=ba,c[45]=R,c[ba+4>>2]=R|1,c[ba+R>>2]=R,c[$+4>>2]=F|3):(c[45]=0,c[48]=0,c[$+4>>2]=S|3,R=$+S+4|0,c[R>>2]=c[R>>2]|1);n=$+8|0;return n|0}$=c[46]|0;if($>>>0>F>>>0){R=$-F|0;c[46]=R;$=c[49]|0;S=$+F|0;c[49]=S;c[S+4>>2]=R|1;c[$+4>>2]=F|3;n=$+8|0;return n|0}do if(!(c[161]|0)){$=va(30)|0;if(!($+-1&$)){c[163]=$;c[162]=$;c[164]=-1;c[165]=-1;c[166]=0;c[154]=0;c[161]=(oa(0)|0)&-16^1431655768;break}else ma()}while(0);$=F+48|0;R=c[163]|0;S=F+47|0;ba=R+S|0;aa=0-R|0;R=ba&aa;if(R>>>0<=F>>>0){n=0;return n|0}_=c[153]|0;if((_|0)!=0?(Z=c[151]|0,Y=Z+R|0,Y>>>0<=Z>>>0|Y>>>0>_>>>0):0){n=0;return n|0}b:do if(!(c[154]&4)){_=c[49]|0;c:do if(_){Y=620;while(1){Z=c[Y>>2]|0;if(Z>>>0<=_>>>0?(T=Y+4|0,(Z+(c[T>>2]|0)|0)>>>0>_>>>0):0){ca=Y;da=T;break}Y=c[Y+8>>2]|0;if(!Y){K=173;break c}}Y=ba-(c[46]|0)&aa;if(Y>>>0<2147483647){T=na(Y|0)|0;if((T|0)==((c[ca>>2]|0)+(c[da>>2]|0)|0)){if((T|0)!=(-1|0)){ea=T;fa=Y;K=193;break b}}else ga=T,ha=Y,K=183}}else K=173;while(0);do if((K|0)==173?(_=na(0)|0,(_|0)!=(-1|0)):0){f=_;Y=c[162]|0;T=Y+-1|0;!(T&f)?ia=R:ia=R-f+(T+f&0-Y)|0;Y=c[151]|0;f=Y+ia|0;if(ia>>>0>F>>>0&ia>>>0<2147483647){T=c[153]|0;if((T|0)!=0?f>>>0<=Y>>>0|f>>>0>T>>>0:0)break;T=na(ia|0)|0;if((T|0)==(_|0)){ea=_;fa=ia;K=193;break b}else ga=T,ha=ia,K=183}}while(0);d:do if((K|0)==183){T=0-ha|0;do if($>>>0>ha>>>0&(ha>>>0<2147483647&(ga|0)!=(-1|0))?(_=c[163]|0,f=S-ha+_&0-_,f>>>0<2147483647):0)if((na(f|0)|0)==(-1|0)){na(T|0)|0;break d}else{ja=f+ha|0;break}else ja=ha;while(0);if((ga|0)!=(-1|0)){ea=ga;fa=ja;K=193;break b}}while(0);c[154]=c[154]|4;K=190}else K=190;while(0);((((K|0)==190?R>>>0<2147483647:0)?(ja=na(R|0)|0,R=na(0)|0,ja>>>0<R>>>0&((ja|0)!=(-1|0)&(R|0)!=(-1|0))):0)?(ga=R-ja|0,ga>>>0>(F+40|0)>>>0):0)&&(ea=ja,fa=ga,K=193);if((K|0)==193){ga=(c[151]|0)+fa|0;c[151]=ga;ga>>>0>(c[152]|0)>>>0&&(c[152]=ga);ga=c[49]|0;do if(ga){ja=620;do{R=c[ja>>2]|0;ha=ja+4|0;S=c[ha>>2]|0;if((ea|0)==(R+S|0)){ka=R;la=ha;pa=S;qa=ja;K=203;break}ja=c[ja+8>>2]|0}while((ja|0)!=0);if(((K|0)==203?(c[qa+12>>2]&8|0)==0:0)?ga>>>0<ea>>>0&ga>>>0>=ka>>>0:0){c[la>>2]=pa+fa;ja=ga+8|0;S=(ja&7|0)==0?0:0-ja&7;ja=ga+S|0;ha=fa-S+(c[46]|0)|0;c[49]=ja;c[46]=ha;c[ja+4>>2]=ha|1;c[ja+ha+4>>2]=40;c[50]=c[165];break}ha=c[47]|0;ea>>>0<ha>>>0?(c[47]=ea,ra=ea):ra=ha;ha=ea+fa|0;ja=620;while(1){if((c[ja>>2]|0)==(ha|0)){sa=ja;ta=ja;K=211;break}ja=c[ja+8>>2]|0;if(!ja){ua=620;break}}if((K|0)==211)if(!(c[ta+12>>2]&8)){c[sa>>2]=ea;ja=ta+4|0;c[ja>>2]=(c[ja>>2]|0)+fa;ja=ea+8|0;S=ea+((ja&7|0)==0?0:0-ja&7)|0;ja=ha+8|0;R=ha+((ja&7|0)==0?0:0-ja&7)|0;ja=S+F|0;$=R-S-F|0;c[S+4>>2]=F|3;do if((R|0)!=(ga|0)){if((R|0)==(c[48]|0)){ia=(c[45]|0)+$|0;c[45]=ia;c[48]=ja;c[ja+4>>2]=ia|1;c[ja+ia>>2]=ia;break}ia=c[R+4>>2]|0;if((ia&3|0)==1){da=ia&-8;ca=ia>>>3;e:do if(ia>>>0>=256){aa=c[R+24>>2]|0;ba=c[R+12>>2]|0;do if((ba|0)==(R|0)){T=R+16|0;f=T+4|0;_=c[f>>2]|0;if(!_){Y=c[T>>2]|0;if(!Y){wa=0;break}else xa=Y,ya=T}else xa=_,ya=f;while(1){f=xa+20|0;_=c[f>>2]|0;if(_){xa=_;ya=f;continue}f=xa+16|0;_=c[f>>2]|0;if(!_){za=xa;Aa=ya;break}else xa=_,ya=f}if(Aa>>>0<ra>>>0)ma();else{c[Aa>>2]=0;wa=za;break}}else{f=c[R+8>>2]|0;f>>>0<ra>>>0&&ma();_=f+12|0;(c[_>>2]|0)!=(R|0)&&ma();T=ba+8|0;if((c[T>>2]|0)==(R|0)){c[_>>2]=ba;c[T>>2]=f;wa=ba;break}else ma()}while(0);if(!aa)break;ba=c[R+28>>2]|0;f=476+(ba<<2)|0;do if((R|0)!=(c[f>>2]|0)){aa>>>0<(c[47]|0)>>>0&&ma();T=aa+16|0;(c[T>>2]|0)==(R|0)?c[T>>2]=wa:c[aa+20>>2]=wa;if(!wa)break e}else{c[f>>2]=wa;if(wa)break;c[44]=c[44]&~(1<<ba);break e}while(0);ba=c[47]|0;wa>>>0<ba>>>0&&ma();c[wa+24>>2]=aa;f=R+16|0;T=c[f>>2]|0;do if(T)if(T>>>0<ba>>>0)ma();else{c[wa+16>>2]=T;c[T+24>>2]=wa;break}while(0);T=c[f+4>>2]|0;if(!T)break;if(T>>>0<(c[47]|0)>>>0)ma();else{c[wa+20>>2]=T;c[T+24>>2]=wa;break}}else{T=c[R+8>>2]|0;ba=c[R+12>>2]|0;aa=212+(ca<<1<<2)|0;do if((T|0)!=(aa|0)){T>>>0<ra>>>0&&ma();if((c[T+12>>2]|0)==(R|0))break;ma()}while(0);if((ba|0)==(T|0)){c[43]=c[43]&~(1<<ca);break}do if((ba|0)==(aa|0))Ba=ba+8|0;else{ba>>>0<ra>>>0&&ma();f=ba+8|0;if((c[f>>2]|0)==(R|0)){Ba=f;break}ma()}while(0);c[T+12>>2]=ba;c[Ba>>2]=T}while(0);Ca=R+da|0;Da=da+$|0}else Ca=R,Da=$;ca=Ca+4|0;c[ca>>2]=c[ca>>2]&-2;c[ja+4>>2]=Da|1;c[ja+Da>>2]=Da;ca=Da>>>3;if(Da>>>0<256){ia=212+(ca<<1<<2)|0;aa=c[43]|0;f=1<<ca;do if(!(aa&f))c[43]=aa|f,Ea=ia+8|0,Fa=ia;else{ca=ia+8|0;_=c[ca>>2]|0;if(_>>>0>=(c[47]|0)>>>0){Ea=ca;Fa=_;break}ma()}while(0);c[Ea>>2]=ja;c[Fa+12>>2]=ja;c[ja+8>>2]=Fa;c[ja+12>>2]=ia;break}f=Da>>>8;do if(!f)Ga=0;else{if(Da>>>0>16777215){Ga=31;break}aa=(f+1048320|0)>>>16&8;da=f<<aa;_=(da+520192|0)>>>16&4;ca=da<<_;da=(ca+245760|0)>>>16&2;Y=14-(_|aa|da)+(ca<<da>>>15)|0;Ga=Da>>>(Y+7|0)&1|Y<<1}while(0);f=476+(Ga<<2)|0;c[ja+28>>2]=Ga;ia=ja+16|0;c[ia+4>>2]=0;c[ia>>2]=0;ia=c[44]|0;Y=1<<Ga;if(!(ia&Y)){c[44]=ia|Y;c[f>>2]=ja;c[ja+24>>2]=f;c[ja+12>>2]=ja;c[ja+8>>2]=ja;break}Y=Da<<((Ga|0)==31?0:25-(Ga>>>1)|0);ia=c[f>>2]|0;while(1){if((c[ia+4>>2]&-8|0)==(Da|0)){Ha=ia;K=281;break}f=ia+16+(Y>>>31<<2)|0;da=c[f>>2]|0;if(!da){Ia=f;Ja=ia;K=278;break}else Y=Y<<1,ia=da}if((K|0)==278)if(Ia>>>0<(c[47]|0)>>>0)ma();else{c[Ia>>2]=ja;c[ja+24>>2]=Ja;c[ja+12>>2]=ja;c[ja+8>>2]=ja;break}else if((K|0)==281){ia=Ha+8|0;Y=c[ia>>2]|0;da=c[47]|0;if(Y>>>0>=da>>>0&Ha>>>0>=da>>>0){c[Y+12>>2]=ja;c[ia>>2]=ja;c[ja+8>>2]=Y;c[ja+12>>2]=Ha;c[ja+24>>2]=0;break}else ma()}}else Y=(c[46]|0)+$|0,c[46]=Y,c[49]=ja,c[ja+4>>2]=Y|1;while(0);n=S+8|0;return n|0}else ua=620;while(1){ja=c[ua>>2]|0;if(ja>>>0<=ga>>>0?($=ja+(c[ua+4>>2]|0)|0,$>>>0>ga>>>0):0){Ka=$;break}ua=c[ua+8>>2]|0}S=Ka+-47|0;$=S+8|0;ja=S+(($&7|0)==0?0:0-$&7)|0;$=ga+16|0;S=ja>>>0<$>>>0?ga:ja;ja=S+8|0;R=ea+8|0;ha=(R&7|0)==0?0:0-R&7;R=ea+ha|0;Y=fa+-40-ha|0;c[49]=R;c[46]=Y;c[R+4>>2]=Y|1;c[R+Y+4>>2]=40;c[50]=c[165];Y=S+4|0;c[Y>>2]=27;c[ja>>2]=c[155];c[ja+4>>2]=c[156];c[ja+8>>2]=c[157];c[ja+12>>2]=c[158];c[155]=ea;c[156]=fa;c[158]=0;c[157]=ja;ja=S+24|0;do ja=ja+4|0,c[ja>>2]=7;while((ja+4|0)>>>0<Ka>>>0);if((S|0)!=(ga|0)){ja=S-ga|0;c[Y>>2]=c[Y>>2]&-2;c[ga+4>>2]=ja|1;c[S>>2]=ja;R=ja>>>3;if(ja>>>0<256){ha=212+(R<<1<<2)|0;ia=c[43]|0;da=1<<R;ia&da?(R=ha+8|0,f=c[R>>2]|0,f>>>0<(c[47]|0)>>>0?ma():(La=R,Ma=f)):(c[43]=ia|da,La=ha+8|0,Ma=ha);c[La>>2]=ga;c[Ma+12>>2]=ga;c[ga+8>>2]=Ma;c[ga+12>>2]=ha;break}ha=ja>>>8;ha?ja>>>0>16777215?Na=31:(da=(ha+1048320|0)>>>16&8,ia=ha<<da,ha=(ia+520192|0)>>>16&4,f=ia<<ha,ia=(f+245760|0)>>>16&2,R=14-(ha|da|ia)+(f<<ia>>>15)|0,Na=ja>>>(R+7|0)&1|R<<1):Na=0;R=476+(Na<<2)|0;c[ga+28>>2]=Na;c[ga+20>>2]=0;c[$>>2]=0;ia=c[44]|0;f=1<<Na;if(!(ia&f)){c[44]=ia|f;c[R>>2]=ga;c[ga+24>>2]=R;c[ga+12>>2]=ga;c[ga+8>>2]=ga;break}f=ja<<((Na|0)==31?0:25-(Na>>>1)|0);ia=c[R>>2]|0;while(1){if((c[ia+4>>2]&-8|0)==(ja|0)){Pa=ia;K=307;break}R=ia+16+(f>>>31<<2)|0;da=c[R>>2]|0;if(!da){Qa=R;Ra=ia;K=304;break}else f=f<<1,ia=da}if((K|0)==304)if(Qa>>>0<(c[47]|0)>>>0)ma();else{c[Qa>>2]=ga;c[ga+24>>2]=Ra;c[ga+12>>2]=ga;c[ga+8>>2]=ga;break}else if((K|0)==307){ia=Pa+8|0;f=c[ia>>2]|0;ja=c[47]|0;if(f>>>0>=ja>>>0&Pa>>>0>=ja>>>0){c[f+12>>2]=ga;c[ia>>2]=ga;c[ga+8>>2]=f;c[ga+12>>2]=Pa;c[ga+24>>2]=0;break}else ma()}}}else{f=c[47]|0;(f|0)==0|ea>>>0<f>>>0&&(c[47]=ea);c[155]=ea;c[156]=fa;c[158]=0;c[52]=c[161];c[51]=-1;f=0;do ia=212+(f<<1<<2)|0,c[ia+12>>2]=ia,c[ia+8>>2]=ia,f=f+1|0;while((f|0)!=32);f=ea+8|0;ia=(f&7|0)==0?0:0-f&7;f=ea+ia|0;ja=fa+-40-ia|0;c[49]=f;c[46]=ja;c[f+4>>2]=ja|1;c[f+ja+4>>2]=40;c[50]=c[165]}while(0);fa=c[46]|0;if(fa>>>0>F>>>0){ea=fa-F|0;c[46]=ea;fa=c[49]|0;ga=fa+F|0;c[49]=ga;c[ga+4>>2]=ea|1;c[fa+4>>2]=F|3;n=fa+8|0;return n|0}}c[(Oa()|0)>>2]=12;n=0;return n|0}function _a(a){a=a|0;var b=0,d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0;if(!a)return;b=a+-8|0;d=c[47]|0;b>>>0<d>>>0&&ma();e=c[a+-4>>2]|0;a=e&3;(a|0)==1&&ma();f=e&-8;g=b+f|0;do if(!(e&1)){h=c[b>>2]|0;if(!a)return;i=b+(0-h)|0;j=h+f|0;i>>>0<d>>>0&&ma();if((i|0)==(c[48]|0)){k=g+4|0;l=c[k>>2]|0;if((l&3|0)!=3){m=i;n=j;break}c[45]=j;c[k>>2]=l&-2;c[i+4>>2]=j|1;c[i+j>>2]=j;return}l=h>>>3;if(h>>>0<256){h=c[i+8>>2]|0;k=c[i+12>>2]|0;o=212+(l<<1<<2)|0;(h|0)!=(o|0)&&(h>>>0<d>>>0&&ma(),(c[h+12>>2]|0)!=(i|0)&&ma());if((k|0)==(h|0)){c[43]=c[43]&~(1<<l);m=i;n=j;break}(k|0)!=(o|0)?(k>>>0<d>>>0&&ma(),o=k+8|0,(c[o>>2]|0)==(i|0)?p=o:ma()):p=k+8|0;c[h+12>>2]=k;c[p>>2]=h;m=i;n=j;break}h=c[i+24>>2]|0;k=c[i+12>>2]|0;do if((k|0)==(i|0)){o=i+16|0;l=o+4|0;q=c[l>>2]|0;if(!q){r=c[o>>2]|0;if(!r){s=0;break}else t=r,u=o}else t=q,u=l;while(1){l=t+20|0;q=c[l>>2]|0;if(q){t=q;u=l;continue}l=t+16|0;q=c[l>>2]|0;if(!q){v=t;w=u;break}else t=q,u=l}if(w>>>0<d>>>0)ma();else{c[w>>2]=0;s=v;break}}else{l=c[i+8>>2]|0;l>>>0<d>>>0&&ma();q=l+12|0;(c[q>>2]|0)!=(i|0)&&ma();o=k+8|0;if((c[o>>2]|0)==(i|0)){c[q>>2]=k;c[o>>2]=l;s=k;break}else ma()}while(0);if(h){k=c[i+28>>2]|0;l=476+(k<<2)|0;if((i|0)==(c[l>>2]|0)){c[l>>2]=s;if(!s){c[44]=c[44]&~(1<<k);m=i;n=j;break}}else{h>>>0<(c[47]|0)>>>0&&ma();k=h+16|0;(c[k>>2]|0)==(i|0)?c[k>>2]=s:c[h+20>>2]=s;if(!s){m=i;n=j;break}}k=c[47]|0;s>>>0<k>>>0&&ma();c[s+24>>2]=h;l=i+16|0;o=c[l>>2]|0;do if(o)if(o>>>0<k>>>0)ma();else{c[s+16>>2]=o;c[o+24>>2]=s;break}while(0);o=c[l+4>>2]|0;if(o)if(o>>>0<(c[47]|0)>>>0)ma();else{c[s+20>>2]=o;c[o+24>>2]=s;m=i;n=j;break}else m=i,n=j}else m=i,n=j}else m=b,n=f;while(0);m>>>0>=g>>>0&&ma();f=g+4|0;b=c[f>>2]|0;b&1||ma();if(!(b&2)){if((g|0)==(c[49]|0)){s=(c[46]|0)+n|0;c[46]=s;c[49]=m;c[m+4>>2]=s|1;if((m|0)!=(c[48]|0))return;c[48]=0;c[45]=0;return}if((g|0)==(c[48]|0)){s=(c[45]|0)+n|0;c[45]=s;c[48]=m;c[m+4>>2]=s|1;c[m+s>>2]=s;return}s=(b&-8)+n|0;d=b>>>3;do if(b>>>0>=256){v=c[g+24>>2]|0;w=c[g+12>>2]|0;do if((w|0)==(g|0)){u=g+16|0;t=u+4|0;p=c[t>>2]|0;if(!p){a=c[u>>2]|0;if(!a){x=0;break}else y=a,z=u}else y=p,z=t;while(1){t=y+20|0;p=c[t>>2]|0;if(p){y=p;z=t;continue}t=y+16|0;p=c[t>>2]|0;if(!p){A=y;B=z;break}else y=p,z=t}if(B>>>0<(c[47]|0)>>>0)ma();else{c[B>>2]=0;x=A;break}}else{t=c[g+8>>2]|0;t>>>0<(c[47]|0)>>>0&&ma();p=t+12|0;(c[p>>2]|0)!=(g|0)&&ma();u=w+8|0;if((c[u>>2]|0)==(g|0)){c[p>>2]=w;c[u>>2]=t;x=w;break}else ma()}while(0);if(v){w=c[g+28>>2]|0;j=476+(w<<2)|0;if((g|0)==(c[j>>2]|0)){c[j>>2]=x;if(!x){c[44]=c[44]&~(1<<w);break}}else{v>>>0<(c[47]|0)>>>0&&ma();w=v+16|0;(c[w>>2]|0)==(g|0)?c[w>>2]=x:c[v+20>>2]=x;if(!x)break}w=c[47]|0;x>>>0<w>>>0&&ma();c[x+24>>2]=v;j=g+16|0;i=c[j>>2]|0;do if(i)if(i>>>0<w>>>0)ma();else{c[x+16>>2]=i;c[i+24>>2]=x;break}while(0);i=c[j+4>>2]|0;if(i)if(i>>>0<(c[47]|0)>>>0)ma();else{c[x+20>>2]=i;c[i+24>>2]=x;break}}}else{i=c[g+8>>2]|0;w=c[g+12>>2]|0;v=212+(d<<1<<2)|0;(i|0)!=(v|0)&&(i>>>0<(c[47]|0)>>>0&&ma(),(c[i+12>>2]|0)!=(g|0)&&ma());if((w|0)==(i|0)){c[43]=c[43]&~(1<<d);break}(w|0)!=(v|0)?(w>>>0<(c[47]|0)>>>0&&ma(),v=w+8|0,(c[v>>2]|0)==(g|0)?C=v:ma()):C=w+8|0;c[i+12>>2]=w;c[C>>2]=i}while(0);c[m+4>>2]=s|1;c[m+s>>2]=s;if((m|0)==(c[48]|0)){c[45]=s;return}else D=s}else c[f>>2]=b&-2,c[m+4>>2]=n|1,c[m+n>>2]=n,D=n;n=D>>>3;if(D>>>0<256){b=212+(n<<1<<2)|0;f=c[43]|0;s=1<<n;f&s?(n=b+8|0,C=c[n>>2]|0,C>>>0<(c[47]|0)>>>0?ma():(E=n,F=C)):(c[43]=f|s,E=b+8|0,F=b);c[E>>2]=m;c[F+12>>2]=m;c[m+8>>2]=F;c[m+12>>2]=b;return}b=D>>>8;b?D>>>0>16777215?G=31:(F=(b+1048320|0)>>>16&8,E=b<<F,b=(E+520192|0)>>>16&4,s=E<<b,E=(s+245760|0)>>>16&2,f=14-(b|F|E)+(s<<E>>>15)|0,G=D>>>(f+7|0)&1|f<<1):G=0;f=476+(G<<2)|0;c[m+28>>2]=G;c[m+20>>2]=0;c[m+16>>2]=0;E=c[44]|0;s=1<<G;do if(E&s){F=D<<((G|0)==31?0:25-(G>>>1)|0);b=c[f>>2]|0;while(1){if((c[b+4>>2]&-8|0)==(D|0)){H=b;I=130;break}C=b+16+(F>>>31<<2)|0;n=c[C>>2]|0;if(!n){J=C;K=b;I=127;break}else F=F<<1,b=n}if((I|0)==127)if(J>>>0<(c[47]|0)>>>0)ma();else{c[J>>2]=m;c[m+24>>2]=K;c[m+12>>2]=m;c[m+8>>2]=m;break}else if((I|0)==130){b=H+8|0;F=c[b>>2]|0;j=c[47]|0;if(F>>>0>=j>>>0&H>>>0>=j>>>0){c[F+12>>2]=m;c[b>>2]=m;c[m+8>>2]=F;c[m+12>>2]=H;c[m+24>>2]=0;break}else ma()}}else c[44]=E|s,c[f>>2]=m,c[m+24>>2]=f,c[m+12>>2]=m,c[m+8>>2]=m;while(0);m=(c[51]|0)+-1|0;c[51]=m;if(!m)L=628;else return;while(1){m=c[L>>2]|0;if(!m)break;else L=m+8|0}c[51]=-1;return}function $a(){}function ab(a,b,c){a=a|0;b=b|0;c=c|0;if((c|0)<32){C=b>>c;return a>>>c|(b&(1<<c)-1)<<32-c}C=(b|0)<0?-1:0;return b>>c-32|0}function bb(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0;e=b-d>>>0;e=b-d-(c>>>0>a>>>0|0)>>>0;return(C=e,a-c>>>0|0)|0}function cb(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0;e=a+c>>>0;return(C=b+d+(e>>>0<a>>>0|0)>>>0,e|0)|0}function db(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,g=0,h=0,i=0;f=b+e|0;if((e|0)>=20){d=d&255;g=b&3;h=d|d<<8|d<<16|d<<24;i=f&-4;if(g){g=b+4-g|0;while((b|0)<(g|0))a[b>>0]=d,b=b+1|0}while((b|0)<(i|0))c[b>>2]=h,b=b+4|0}while((b|0)<(f|0))a[b>>0]=d,b=b+1|0;return b-e|0}function eb(a,b,c){a=a|0;b=b|0;c=c|0;if((c|0)<32){C=b>>>c;return a>>>c|(b&(1<<c)-1)<<32-c}C=0;return b>>>c-32|0}function fb(a,b,c){a=a|0;b=b|0;c=c|0;if((c|0)<32){C=b<<c|(a&(1<<c)-1<<32-c)>>>32-c;return a<<c}C=a<<c-32;return 0}function gb(b,d,e){b=b|0;d=d|0;e=e|0;var f=0;if((e|0)>=4096)return qa(b|0,d|0,e|0)|0;f=b|0;if((b&3)==(d&3)){while(b&3){if(!e)return f|0;a[b>>0]=a[d>>0]|0;b=b+1|0;d=d+1|0;e=e-1|0}while((e|0)>=4)c[b>>2]=c[d>>2],b=b+4|0,d=d+4|0,e=e-4|0}while((e|0)>0)a[b>>0]=a[d>>0]|0,b=b+1|0,d=d+1|0,e=e-1|0;return f|0}function hb(b){b=b|0;var c=0;c=a[m+(b&255)>>0]|0;if((c|0)<8)return c|0;c=a[m+(b>>8&255)>>0]|0;if((c|0)<8)return c+8|0;c=a[m+(b>>16&255)>>0]|0;return(c|0)<8?c+16|0:(a[m+(b>>>24)>>0]|0)+24|0}function ib(a,b){a=a|0;b=b|0;var c=0,d=0,e=0,f=0;c=a&65535;d=b&65535;e=_(d,c)|0;f=a>>>16;a=(e>>>16)+(_(d,f)|0)|0;d=b>>>16;b=_(d,c)|0;return(C=(a>>>16)+(_(d,f)|0)+(((a&65535)+b|0)>>>16)|0,a+b<<16|e&65535|0)|0}function jb(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0,f=0,g=0,h=0,i=0;e=b>>31|((b|0)<0?-1:0)<<1;f=((b|0)<0?-1:0)>>31|((b|0)<0?-1:0)<<1;g=d>>31|((d|0)<0?-1:0)<<1;h=((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1;i=bb(e^a,f^b,e,f)|0;b=C;a=g^e;e=h^f;return bb((ob(i,b,bb(g^c,h^d,g,h)|0,C,0)|0)^a,C^e,a,e)|0}function kb(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,g=0,h=0,j=0,k=0,l=0,m=0;f=i;i=i+16|0;g=f|0;h=b>>31|((b|0)<0?-1:0)<<1;j=((b|0)<0?-1:0)>>31|((b|0)<0?-1:0)<<1;k=e>>31|((e|0)<0?-1:0)<<1;l=((e|0)<0?-1:0)>>31|((e|0)<0?-1:0)<<1;m=bb(h^a,j^b,h,j)|0;b=C;ob(m,b,bb(k^d,l^e,k,l)|0,C,g)|0;l=bb(c[g>>2]^h,c[g+4>>2]^j,h,j)|0;j=C;i=f;return(C=j,l)|0}function lb(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0,f=0;e=a;a=c;c=ib(e,a)|0;f=C;return(C=(_(b,a)|0)+(_(d,e)|0)+f|f&0,c|0|0)|0}function mb(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;return ob(a,b,c,d,0)|0}function nb(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,g=0;f=i;i=i+16|0;g=f|0;ob(a,b,d,e,g)|0;i=f;return(C=c[g+4>>2]|0,c[g>>2]|0)|0}function ob(a,b,d,e,f){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;var g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,D=0,E=0,F=0,G=0,H=0;g=a;h=b;i=h;j=d;k=e;l=k;if(!i){m=(f|0)!=0;if(!l){m&&(c[f>>2]=(g>>>0)%(j>>>0),c[f+4>>2]=0);n=0;o=(g>>>0)/(j>>>0)>>>0;return(C=n,o)|0}else{if(!m){n=0;o=0;return(C=n,o)|0}c[f>>2]=a|0;c[f+4>>2]=b&0;n=0;o=0;return(C=n,o)|0}}m=(l|0)==0;do if(j){if(!m){p=(aa(l|0)|0)-(aa(i|0)|0)|0;if(p>>>0<=31){q=p+1|0;r=31-p|0;s=p-31>>31;t=q;u=g>>>(q>>>0)&s|i<<r;v=i>>>(q>>>0)&s;w=0;x=g<<r;break}if(!f){n=0;o=0;return(C=n,o)|0}c[f>>2]=a|0;c[f+4>>2]=h|b&0;n=0;o=0;return(C=n,o)|0}r=j-1|0;if(r&j){s=(aa(j|0)|0)+33-(aa(i|0)|0)|0;q=64-s|0;p=32-s|0;y=p>>31;z=s-32|0;A=z>>31;t=s;u=p-1>>31&i>>>(z>>>0)|(i<<p|g>>>(s>>>0))&A;v=A&i>>>(s>>>0);w=g<<q&y;x=(i<<q|g>>>(z>>>0))&y|g<<p&s-33>>31;break}f&&(c[f>>2]=r&g,c[f+4>>2]=0);if((j|0)==1){n=h|b&0;o=a|0|0;return(C=n,o)|0}else{r=hb(j|0)|0;n=i>>>(r>>>0)|0;o=i<<32-r|g>>>(r>>>0)|0;return(C=n,o)|0}}else{if(m){f&&(c[f>>2]=(i>>>0)%(j>>>0),c[f+4>>2]=0);n=0;o=(i>>>0)/(j>>>0)>>>0;return(C=n,o)|0}if(!g){f&&(c[f>>2]=0,c[f+4>>2]=(i>>>0)%(l>>>0));n=0;o=(i>>>0)/(l>>>0)>>>0;return(C=n,o)|0}r=l-1|0;if(!(r&l)){f&&(c[f>>2]=a|0,c[f+4>>2]=r&i|b&0);n=0;o=i>>>((hb(l|0)|0)>>>0);return(C=n,o)|0}r=(aa(l|0)|0)-(aa(i|0)|0)|0;if(r>>>0<=30){s=r+1|0;p=31-r|0;t=s;u=i<<p|g>>>(s>>>0);v=i>>>(s>>>0);w=0;x=g<<p;break}if(!f){n=0;o=0;return(C=n,o)|0}c[f>>2]=a|0;c[f+4>>2]=h|b&0;n=0;o=0;return(C=n,o)|0}while(0);if(!t)B=x,D=w,E=v,F=u,G=0,H=0;else{b=d|0|0;d=k|e&0;e=cb(b|0,d|0,-1,-1)|0;k=C;h=x;x=w;w=v;v=u;u=t;t=0;do a=h,h=x>>>31|h<<1,x=t|x<<1,g=v<<1|a>>>31|0,a=v>>>31|w<<1|0,bb(e,k,g,a)|0,i=C,l=i>>31|((i|0)<0?-1:0)<<1,t=l&1,v=bb(g,a,l&b,(((i|0)<0?-1:0)>>31|((i|0)<0?-1:0)<<1)&d)|0,w=C,u=u-1|0;while((u|0)!=0);B=h;D=x;E=w;F=v;G=0;H=t}t=D;D=0;f&&(c[f>>2]=F,c[f+4>>2]=E);n=(t|0)>>>31|(B|D)<<1|(D<<1|t>>>31)&0|G;o=(t<<1|0>>>31)&-2|H;return(C=n,o)|0}function pb(a,b){a=a|0;b=b|0;return ya[a&1](b|0)|0}function qb(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;return za[a&3](b|0,c|0,d|0)|0}function rb(a,b){a=a|0,b=b|0,Aa[a&1](b|0)}function sb(a){a=a|0;ba(0);return 0}function tb(a,b,c){a=a|0;b=b|0;c=c|0;ba(1);return 0}function ub(a){a=a|0,ba(2)}var ya=[sb,Sa],za=[tb,Va,Ta,Ua],Aa=[ub,Xa];return{_curve25519_donna:Ka,_free:_a,_i64Add:cb,_bitshift64Ashr:ab,_i64Subtract:bb,_memset:db,_malloc:Za,_memcpy:gb,_bitshift64Lshr:eb,_fflush:Wa,___errno_location:Oa,_bitshift64Shl:fb,runPostSets:$a,stackAlloc:Ba,stackSave:Ca,stackRestore:Da,establishStackSpace:Ea,setThrew:Fa,setTempRet0:Ia,getTempRet0:Ja,dynCall_ii:pb,dynCall_iiii:qb,dynCall_vi:rb}}(e.Na,e.Oa,buffer);e._curve25519_donna=Z._curve25519_donna;var Da=e._free=Z._free;e.runPostSets=Z.runPostSets;var cb=e._i64Add=Z._i64Add,ab=e._bitshift64Ashr=Z._bitshift64Ashr,bb=e._i64Subtract=Z._i64Subtract,db=e._memset=Z._memset,ua=e._malloc=Z._malloc,gc=e._memcpy=Z._memcpy,fb=e._bitshift64Lshr=Z._bitshift64Lshr;e._fflush=Z._fflush;e.___errno_location=Z.___errno_location;var gb=e._bitshift64Shl=Z._bitshift64Shl;e.dynCall_ii=Z.dynCall_ii;e.dynCall_iiii=Z.dynCall_iiii;e.dynCall_vi=Z.dynCall_vi;n.W=Z.stackAlloc;n.na=Z.stackSave;n.X=Z.stackRestore;n.md=Z.establishStackSpace;n.cb=Z.setTempRet0;n.Ua=Z.getTempRet0;function xc(a){this.name="ExitStatus",this.message="Program terminated with exit("+a+")",this.status=a}xc.prototype=Error();xc.prototype.constructor=xc;var Yc=null,Xa=function Zc(){e.calledRun||$c(),e.calledRun||(Xa=Zc)};e.callMain=e.jd=function(a){function b(){for(var a=0;3>a;a++)d.push(0)}assert(0==L,"cannot call main when async dependencies remain! (listen on __ATMAIN__)");assert(0==Pa.length,"cannot call main when preRun functions remain to be called");a=a||[];xa||(xa=!0,Oa(Qa));var c=a.length+1,d=[G(Va(e.thisProgram),"i8",0)];b();for(var f=0;f<c-1;f+=1)d.push(G(Va(a[f]),"i8",0)),b();d.push(0);d=G(d,"i32",0);try{var h=e._main(c,d,0);ad(h,!0)}catch(g){if(!(g instanceof xc))if("SimulateInfiniteLoop"==g)e.noExitRuntime=!0;else throw g&&"object"===typeof g&&g.stack&&e.S("exception thrown: "+[g,g.stack]),g}finally{}};function $c(a){function b(){if(!e.calledRun&&(e.calledRun=!0,!A)){xa||(xa=!0,Oa(Qa));Oa(Ra);e.onRuntimeInitialized&&e.onRuntimeInitialized();e._main&&bd&&e.callMain(a);if(e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;)Ua(e.postRun.shift());Oa(Sa)}}a=a||e.arguments;null===Yc&&(Yc=Date.now());if(!(0<L)){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)Ta(e.preRun.shift());Oa(Pa);0<L||e.calledRun||(e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),b()},1)):b())}}e.run=e.run=$c;function ad(a,b){if(!b||!e.noExitRuntime){!e.noExitRuntime&&(A=!0,m=void 0,Oa(K),e.onExit)&&e.onExit(a);throw new xc(a)}}e.exit=e.exit=ad;var cd=[];function z(a){void 0!==a?(e.print(a),e.S(a),a=JSON.stringify(a)):a="";A=!0;var b="abort("+a+") at "+Ea()+"\nIf this abort() is unexpected, build with -s ASSERTIONS=1 which can give more information.";cd&&cd.forEach(function(c){b=c(b,a)});throw b}e.abort=e.abort=z;if(e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);0<e.preInit.length;)e.preInit.pop()();var bd=!0;e.noInitialRun&&(bd=!1);$c();module.exports=e}),null);
__d("WAWebCryptoCurve25519",["Promise","WAWeb-curve25519-donna","WAWebABProps","WAWebCryptoLibraryUtilsApi","WAWebEnvironment","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i;function j(){i||(self.IS_SMALL_CURVE25519_BUFFER_ENABLED=x(),i=b("WAWeb-curve25519-donna"))}var k=new Uint8Array(32);k[0]=9;function a(a){var b;a===void 0?(b=new Uint8Array(32),self.crypto.getRandomValues(b)):b=new Uint8Array(a);b[0]&=248;b[31]&=127;b[31]|=64;return t({pubKey:32,privKey:b,basepoint:k},function(a){var d=i._curve25519_donna(a.pubKey,a.privKey,a.basepoint);if(d)throw c("err")("Curve25519:keyPair Error Code "+d);return{pubKey:s(a.pubKey,32),privKey:b.buffer}})}function e(a,d){return(h||(h=b("Promise"))).resolve().then(function(){return t({sharedKey:32,pubKey:a,privKey:d},function(a){var b=i._curve25519_donna(a.sharedKey,a.privKey,a.pubKey);if(b)throw c("err")("Curve25519:sharedSecret Error Code "+b);return s(a.sharedKey,32)})})}var l=5;function m(a){return a.pubKey.byteLength===33&&a.privKey.byteLength===32}function f(a){if(m(a))return a;if(a.pubKey.byteLength!==32||a.privKey.byteLength!==32)throw c("err")("Invalid key pair type");var b=n(a.pubKey),d=new Uint8Array(32);d.set(new Uint8Array(a.privKey));return{pubKey:b,privKey:d.buffer}}function n(a){if(a.byteLength!==32)throw c("err")("Invalid key type");var b=new Uint8Array(33);b[0]=l;b.set(new Uint8Array(a),1);return b.buffer}function o(a){return a.privKey.byteLength===32&&a.pubKey.byteLength===32}function p(a){if(o(a))return a;if(a.pubKey.byteLength!==33||a.privKey.byteLength!==32)throw c("err")("Invalid key pair type");var b=new Uint8Array(32),d=new Uint8Array(32);b.set(new Uint8Array(a.pubKey).subarray(1));d.set(new Uint8Array(a.privKey));return{pubKey:b.buffer,privKey:d.buffer}}function q(a){if(a.byteLength!==33)throw c("err")("Invalid key type");var b=new Uint8Array(32);b.set(new Uint8Array(a).subarray(1));return b.buffer}function r(a){if(typeof a==="number")return i._malloc(a);a=new Uint8Array(a.buffer||a);var b=i._malloc(a.length);i.HEAPU8.set(a,b);return b}function s(a,b){var c=new Uint8Array(b);c.set(i.HEAPU8.subarray(a,a+b));return c.buffer}function t(a,b){j();var c={};try{for(var d in a)c[d]=r(a[d]);return b(c)}finally{for(d in c)i._free(c[d])}}function u(a,b){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield c("WAWebCryptoLibraryUtilsApi").signMsg(a.pubKey,a.privKey,b));return a});return v.apply(this,arguments)}function w(a,b,d){if(a.byteLength!==32)throw c("err")("Invalid public key length: "+a.byteLength);var e=new Uint8Array(33);e[0]=l;e.set(a,1);return c("WAWebCryptoLibraryUtilsApi").verifySignature(e,b,d)}function x(){return c("WAWebEnvironment").isWindows||d("WAWebABProps").getABPropConfigValue("web_curve25519_donna_small_buffer_size_enabled")}g.keyPair=a;g.sharedSecret=e;g.toSignalCurveKeyPair=f;g.toSignalCurvePubKey=n;g.toCurveKeyPair=p;g.toCurveKeyPubKey=q;g.calculateSignature=u;g.verifySignature=w}),98);
__d("WAWebChatThreadLoggingLocalstorageMetadataHandler",["Promise","WABase64","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;a=function(){function a(){}var c=a.prototype;c.setOffset=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebUserPrefsMultiDevice").setChatThreadLoggingOffset(a);return!0});function c(b){return a.apply(this,arguments)}return c}();c.getOffset=function(){return(h||(h=b("Promise"))).resolve(d("WAWebUserPrefsMultiDevice").getChatThreadLoggingOffset())};c.setSecret=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebUserPrefsMultiDevice").setChatThreadLoggingSecretB64(d("WABase64").encodeB64(a));return!0});function c(b){return a.apply(this,arguments)}return c}();c.getSecret=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebUserPrefsMultiDevice").getChatThreadLoggingSecretB64());return a==null?null:d("WABase64").decodeB64(a)});function c(){return a.apply(this,arguments)}return c}();c.setLastUploadedStartTs=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebUserPrefsMultiDevice").setChatThreadLoggingLastUploadedStartTs(a);return!0});function c(b){return a.apply(this,arguments)}return c}();c.getLastUploadedStartTs=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebUserPrefsMultiDevice").getChatThreadLoggingLastUploadedStartTs());return(a=a)!=null?a:0});function c(){return a.apply(this,arguments)}return c}();return a}();g.ChatThreadLoggingMetadataLocalStorage=a}),98);
__d("WAWebChatThreadLogging",["Promise","WALogger","WATimeUtils","WAWebABProps","WAWebChatThreadLoggingEventStore","WAWebChatThreadLoggingEventUploader","WAWebChatThreadLoggingLocalstorageMetadataHandler","WAWebChatThreadLoggingUtils","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[ctwa] labels: cannot generate getChatThreadIDHMAC because secret is unset"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: cannot generate getChatThreadID because secret is unset."]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: cannot get user secret from the thread logging metadata store"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: uploaded "," events"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: attempting to upload but secret is unset."]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: attempting to upload but offset is unset."]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: uploading events"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: setting offset"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["chat thread logging initialized"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: will upload in "," seconds."]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: error handling activities"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: handling "," message(s)"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: setting thread_id_user_secret"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["getChatThreadLoggingState: init incomplete!"]);v=function(){return a};return a}var w=null;function x(){w==null&&d("WALogger").ERROR(v());return w}function a(a){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a===void 0&&(a=!0);a=a&&d("WAWebABProps").getABPropConfigValue("message_count_logging_md_enabled");(yield d("WAWebUserPrefsMultiDevice").getChatThreadLoggingLastUploadedStartTs())==null&&(yield d("WAWebUserPrefsMultiDevice").setChatThreadLoggingLastUploadedStartTs(0));var c=new(d("WAWebChatThreadLoggingLocalstorageMetadataHandler").ChatThreadLoggingMetadataLocalStorage)(),e=a?new(d("WAWebChatThreadLoggingEventStore").ChatThreadLoggingEventStoreImpl)(c):{handleMessages:function(){return(h||(h=b("Promise"))).resolve()},getEvent:function(){return(h||(h=b("Promise"))).resolve()},getBeforeInclusive:function(){return(h||(h=b("Promise"))).resolve([])},deleteBeforeInclusive:function(){return(h||(h=b("Promise"))).resolve(0)}};a=a?new(d("WAWebChatThreadLoggingEventUploader").ChatThreadLoggingEventUploaderImpl)(c,e):{uploadEvents:function(){return(h||(h=b("Promise"))).resolve(0)}};var f=(yield c.getOffset());f!=null&&D(f);w={metadataStore:c,eventStore:e,eventUploader:a};d("WALogger").LOG(q())});return y.apply(this,arguments)}function e(a){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;d("WALogger").LOG(p());b=(b=(yield (b=x())==null?void 0:b.metadataStore.setOffset(a)))!=null?b:!1;b&&D(a);return b});return z.apply(this,arguments)}function f(a){var c;d("WALogger").LOG(u());return(c=(c=x())==null?void 0:c.metadataStore.setSecret(a))!=null?c:(h||(h=b("Promise"))).resolve(!1)}function A(a){var b;d("WALogger").LOG(t(),a.length).devConsole({activities:a});(b=x())==null?void 0:b.eventStore.handleMessages(a)["catch"](function(a){d("WALogger").ERROR(s())})}function B(a){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;d("WALogger").DEV(o());b=(yield (b=x())==null?void 0:b.metadataStore.getOffset());if(b==null){d("WALogger").ERROR(n());return}b=(yield (b=x())==null?void 0:b.metadataStore.getSecret());if(b==null){d("WALogger").ERROR(m());return}b=(yield (b=x())==null?void 0:b.eventUploader.uploadEvents(a));d("WALogger").DEV(l(),b)});return C.apply(this,arguments)}function D(a){var c=d("WATimeUtils").unixTime(),e=c-c%86400;e=e+a;e=e-c;e<0&&(e+=d("WATimeUtils").DAY_SECONDS);d("WALogger").DEV(r(),e);self.setTimeout(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b;yield (b=x())==null?void 0:b.eventUploader.uploadEvents();D(a)}),e*1e3)}function E(){if(!c("gkx")("26258"))return x()}function F(){return G.apply(this,arguments)}function G(){G=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield x());a=(yield a==null?void 0:a.metadataStore.getSecret());if(a==null){d("WALogger").WARN(k()).sendLogs("ctl-secret-unset");return null}return a});return G.apply(this,arguments)}function H(a,b){return I.apply(this,arguments)}function I(){I=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield F());if(c==null){d("WALogger").WARN(j());return void 0}b=d("WAWebChatThreadLoggingUtils").getThreadDs((b=b)!=null?b:d("WATimeUtils").unixTime());return d("WAWebChatThreadLoggingUtils").generateThreadID(c,a,b)});return I.apply(this,arguments)}function J(a){return K.apply(this,arguments)}function K(){K=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield F());if(b==null){d("WALogger").WARN(i()).sendLogs("ctwa-labels-thread-id-hmac-error");return null}return d("WAWebChatThreadLoggingUtils").generateThreadIDHMAC(b,a)});return K.apply(this,arguments)}g.initChatThreadLogging=a;g.setThreadDsTimeframeOffset=e;g.setThreadIdUserSecret=f;g.handleActivitiesForChatThreadLogging=A;g.uploadChatThreadLoggingEvents=B;g.getChatThreadLoggingStateDebug=E;g.getChatThreadID=H;g.getChatThreadIDHMAC=J}),98);
__d("WAWebPromiseQueue",["Promise","WALogger","WAPromiseQueue","WAWebABProps","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["PromiseQueue: wait called more than 10 times"]);i=function(){return a};return a}a=function(a){babelHelpers.inheritsLoose(c,a);function c(b){return a.call(this,b)||this}var e=c.prototype;e.wait=function(){return!d("WAWebABProps").getABPropConfigValue("web_promise_queue_wait_mutation_bug_fix")?a.prototype.wait.call(this):this.waitUntilResolved()};e.waitUntilResolved=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(c){var e=this;c===void 0&&(c=0);if(c>9){d("WALogger").ERROR(i()).sendLogs("promise_queue_long_wait_time");return}var f=a.prototype.wait.call(this);return new(h||(h=b("Promise")))(function(){var d=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,d){try{yield f,f!==a.prototype.wait.call(e)&&(yield e.waitUntilResolved(c+1)),b()}catch(a){d(a)}});return function(a,b){return d.apply(this,arguments)}}())});function e(a){return c.apply(this,arguments)}return e}();return c}(d("WAPromiseQueue").PromiseQueue);g.PromiseQueue=a}),98);
__d("WAWebApiChatThreadLoggingPendingEvents",["WAWebChatThreadLoggingBoolFlagFields","WAWebChatThreadLoggingCountFields","WAWebPromiseQueue","WAWebSchemaChatThreadLoggingPendingEvents","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=Object.freeze({msgsSent:0,msgsReceived:0,msgsRead:0,viewOnceMsgsSent:0,viewOnceMsgsReceived:0,viewOnceMessagesOpened:0,callOffersSent:0,callOffersReceived:0,totalCallDuration:0,commerceMsgsSent:0,commerceMsgsReceived:0,pdpInquiriesSent:0,reactionsSent:0,reactionsReceived:0,forwardMessagesSent:0,forwardMessagesReceived:0,editedMsgsSent:0,botMessagesSent:0,botMessagesReceived:0,botMessagesEdited:0,eventCreationMessagesSent:0,eventCreationMessagesReceived:0,eventResponseMessagesSent:0,eventResponseMessagesReceived:0}),i=Object.freeze(babelHelpers["extends"]({},d("WAWebChatThreadLoggingCountFields").COUNT_FIELDS,d("WAWebChatThreadLoggingBoolFlagFields").FLAG_FIELDS,h)),j=new(d("WAWebPromiseQueue").PromiseQueue)();function a(a){return j.enqueue(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield d("WAWebSchemaChatThreadLoggingPendingEvents").getChatThreadLoggingPendingEventsTable().bulkGet(a.map(function(a){var b=a.chatId;a=a.startTs;return[b,a]})));b=b.map(function(b,c){var e=a[c],f=k(e.chatId,e.startTs,b);d("WAWebChatThreadLoggingCountFields").COUNT_FIELD_NAMES.forEach(function(a){f[a]+=e[a]});d("WAWebChatThreadLoggingBoolFlagFields").FLAG_FIELD_NAMES.forEach(function(a){f[a]=e[a]});f.msgsSent+=e.addMsgsSent;f.msgsReceived+=e.addMsgsReceived;f.msgsRead+=e.addMsgsRead;f.viewOnceMsgsSent+=e.addViewOnceMsgsSent;f.viewOnceMsgsReceived+=e.addViewOnceMsgsReceived;f.viewOnceMessagesOpened+=e.addViewOnceMsgsOpened;f.callOffersSent+=e.addCallOffersSent;f.callOffersReceived+=e.addCallOffersReceived;f.totalCallDuration+=e.addTotalCallDuration;f.commerceMsgsSent+=e.addCommerceMsgsSent;f.commerceMsgsReceived+=e.addCommerceMsgsReceived;f.pdpInquiriesSent+=e.addPdpInquiriesSent;f.reactionsSent+=e.addReactionsSent;f.reactionsReceived+=e.addReactionsReceived;f.forwardMessagesSent+=e.addForwardMessagesSent;f.forwardMessagesReceived+=e.addForwardMessagesReceived;f.editedMsgsSent+=e.addEditedMsgsSent;f.botMessagesSent+=e.addBotMessagesSent;f.botMessagesReceived+=e.addBotMessagesReceived;f.botMessagesEdited+=e.addBotMessagesEdited;f.eventCreationMessagesSent+=e.addEventCreationMessagesSent;f.eventCreationMessagesReceived+=e.addEventCreationMessagesReceived;f.eventResponseMessagesSent+=e.addEventResponseMessagesSent;f.eventResponseMessagesReceived+=e.addEventResponseMessagesReceived;return f});return d("WAWebSchemaChatThreadLoggingPendingEvents").getChatThreadLoggingPendingEventsTable().bulkCreateOrReplace(b)}))}function k(a,b,c){if(c==null)return babelHelpers["extends"]({chatId:a,startTs:b},i);d("WAWebChatThreadLoggingBoolFlagFields").FLAG_FIELD_NAMES.forEach(function(a){c[a]==null&&(c[a]=i[a])});d("WAWebChatThreadLoggingCountFields").COUNT_FIELD_NAMES.forEach(function(a){c[a]==null&&(c[a]=i[a])});Object.keys(h).forEach(function(a){c[a]==null&&(c[a]=i[a])});return c}function c(a,b){return d("WAWebSchemaChatThreadLoggingPendingEvents").getChatThreadLoggingPendingEventsTable().get([a,b])}function e(a){return d("WAWebSchemaChatThreadLoggingPendingEvents").getChatThreadLoggingPendingEventsTable().lessThan(["startTs"],a,{inclusive:!0})}function f(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaChatThreadLoggingPendingEvents").getChatThreadLoggingPendingEventsTable().bulkDeleteRange(["startTs"],0,a+1));return a});return l.apply(this,arguments)}g.createOrUpdateChatEvents=a;g.getChatEvent=c;g.getBeforeInclusive=e;g.deleteBeforeInclusive=f}),98);
__d("WAWebBotTypes",["$InternalEnum"],(function(a,b,c,d,e,f){c=(a=b("$InternalEnum"))({FIRST:"first",INNER:"inner",LAST:"last",FULL:"full"});d=a({BIZ_1P:"biz_1p",BIZ_3P:"biz_3p"});e=a.Mirrored(["POSITIVE","NEGATIVE_GENERIC","NEGATIVE_HELPFUL","NEGATIVE_INTERESTING","NEGATIVE_ACCURATE","NEGATIVE_SAFE","NEGATIVE_OTHER","NEGATIVE_REFUSED","NEGATIVE_NOT_VISUALLY_APPEALING","NEGATIVE_NOT_RELEVANT_TO_TEXT"]);b=a({UNKNOWN:"unknown",PARTIAL_1P:"1p_partial",FULL_3P:"3p_full"});var g=a({NONE:"none",BASIC:"basic"});a=a({PROMPT:"prompt",COMMAND:"command",VOICE:"voice"});f.BotMsgEditType=c;f.BizBotType=d;f.BotFeedbackKind=e;f.BizBotAutomatedType=b;f.BotWelcomeMsgProtocolModeType=g;f.BotMsgBodyType=a}),66);
__d("WAWebDBBulkGetIsContactABusiness",["WAWebSchemaVerifiedBusinessName"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebSchemaVerifiedBusinessName").getVerifiedBusinessNameTable().bulkGet(a.map(function(a){return(a=a==null?void 0:a.user)!=null?a:""})).then(function(a){return a.map(function(a){return a!=null})})}g.bulkGetIsContactABusiness=a}),98);
__d("WAWebApiHydrateWidsUtil",["WAWebWidFactory","WAWebWidJsonReviver"],(function(a,b,c,d,e,f,g){function h(a){if(Array.isArray(a))return a.map(function(b,a){return h(d("WAWebWidJsonReviver").widReviver(a,b,d("WAWebWidFactory").isWidlike,d("WAWebWidFactory").createWidFromWidLike))});else if(a&&typeof a==="object"){var b=Object.keys(a);for(var c=0;c<b.length;c++){var e=b[c];a[e]=h(d("WAWebWidJsonReviver").widReviver(e,a[e],d("WAWebWidFactory").isWidlike,d("WAWebWidFactory").createWidFromWidLike))}return a}return a}g.hydrateWids=h}),98);
__d("WAWebVcardParsingUtils",["WALogger","WATypeUtils","WAWeb-moment","WAWebURLUtils","WAWebWidFactory","lodash"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["vcard:parse failed because the vCard is not formatted as expected:\n                Header as expected? ","\n                Version as expected? ","\n                Footer as expected? ","\n                Lines: ",""]);h=function(){return a};return a}var i="wa-biz-name",j=/X-([^;:]+)(?:;[^:]+)*:(.+)/,k={"X-ABLabel":[/X-ABLabel(?:;([^:]+))*:(.+)/,1],ADR:[/ADR(?:;([^:]+))*:;;(.*);(.*);(.*);(.*);(.*)/,5],"X-ABADR":[/X-ABADR(?:;([^:]+))*:(.*)/,1],URL:[/URL(?:;([^:]+))*:(.*)/,1],EMAIL:[/EMAIL(?:;([^:]+))*:(.+)/,1],TEL:[/TEL(?:;([^:]+))*:(.+)/,1]},l={N:[/N(?:;([^:]+))*:([^;]*);([^;]*);([^;]*);([^;]*);(.*)/,5],FN:[/FN(?:;([^:]+))*:(.*)/,1],NICKNAME:[/NICKNAME(?:;([^:]+))*:(.*)/,1],"X-PHONETIC-FIRST-NAME":[/X-PHONETIC-FIRST-NAME(?:;([^:]+))*:(.*)/,1],"X-PHONETIC-LAST-NAME":[/X-PHONETIC-LAST-NAME(?:;([^:]+))*:(.*)/,1],ORG:[/ORG(?:;([^:]+))*:([^;]*)(?:;(.*))*/,2],TITLE:[/TITLE(?:;([^:]+))*:(.*)/,1],TEL:[/TEL(?:;([^:]+))*:(.*)/,1],PHOTO:[/PHOTO(?:;([^:]+))*:(.*)/,1],BDAY:[/BDAY(?:;([^:]+))*:(.*)/,1],URL:[/URL(?:;([^:]+))*:(.+)/,1],EMAIL:[/EMAIL(?:;([^:]+))*:(.+)/,1]},m=function(a,b,c,d){this.type=a,this.index=b,this.properties=c||{},this.value=d};function n(a,b,c){a[b]||(a[b]=[]),a[b].push(c)}function o(a){var b={};if(!a)return b;a.split(";").forEach(function(a){a=a.split(/=/);if(a.length===1){var c=a[0];n(b,c.toLowerCase(),!0)}else if(a.length===2){c=a[0];a=a[1];n(b,c.toLowerCase(),a.toLowerCase())}});return b}function a(a){if(!a)return;return a.replace(/^_\$!<([^>]*)>!\$_$/,"$1").replace(/\\,/,",").replace(/\\;/,";").replace(/\\\\/,"\\")}function p(a){var b={};c("lodash").forOwn(a,function(a,d){b[d]=c("lodash").sortBy(a,function(a){return a.index})});return b}function b(a){var b=[/-([^-]*)-([^-]*)-([^-]*)/,/([^-]*)-([^-]*)-([^-]*)/],d=a;c("lodash").forEach(b,function(b){b=a.match(b);if(b){var e=!b[1].length||b[1]==="1604",f=e?"0000":b[1];d=c("WAWeb-moment")(f+"-"+b[2]+"-"+b[3]).format("l");e&&(d=d.replace(/[.,-\/\s]*0000[.,-\/\s]*/,""));return!1}});return d}function e(a){var b=[];if(a==null?void 0:a.TEL)a.TEL.forEach(function(a){var c;((c=(c=a.properties)==null?void 0:(c=c.waid)==null?void 0:c.length)!=null?c:0)>0&&(b=b.concat(a.properties.waid.map(function(a){return d("WAWebWidFactory").createUserWid(a)})))});else{a=((a==null?void 0:a.SERVICE)||[]).find(function(a){return a.type.toLowerCase()==="wa-lid"});(a==null?void 0:a.value)&&(b=b.concat(d("WAWebWidFactory").createUserWid(a.value,"lid")))}return b}function q(a){a=a==null?void 0:a.replace(/\r?\n|\r/g,"\n").replace(/\n^[ \t]/gm,"").split("\n").filter(function(a){return a.trim().length!==0});var b={},c={};if(a==null||a.length<3)return void 0;var e=a[0].trim().toUpperCase(),f=a[1].trim().toUpperCase(),g=a[a.length-1].trim().toUpperCase();f=f==="VERSION:2.1"||f==="VERSION:3.0"||f==="VERSION:4.0";if(e!=="BEGIN:VCARD"||!f||g!=="END:VCARD"){d("WALogger").ERROR(h(),String(e==="BEGIN:VCARD"),String(f),String(g==="END:VCARD"),a.length).sendLogs("vcard-fault");return void 0}for(e=2;e<a.length-1;e++){var i;f=a[e];g=f.match(/item(\d+)\.(.*)/);f=g?g[2]:f;i=(i=f.match(/([^:;]*)[:;].*/))==null?void 0:i[1];if(i==null)continue;var q=g?k:l,r=i;i=i;var s=void 0,t=void 0;if(q[r]){q=q[r];var u=q[0];q=q[1];u=f.match(u);u&&(s=o(u[1]),t=q===1?t=u[2]:u.slice(2,2+q))}else{u=f.match(j);u&&(i="SERVICE",r=u[1],t=u[2],s={})}q=Array.isArray(t)?t:[t];if(q.some(function(a){return a&&d("WATypeUtils").isString(a)&&a.trim()}))if(g){f=g[1];c[f]?c[f].fields.push(new m(r,null,s,t)):c[f]={type:r,index:e,key:i,properties:s,value:t,fields:[]}}else n(b,i,new m(r,e,s,t))}Object.keys(c).forEach(function(f){f=c[f];var g=f.key,h=f.index,a=f.type,e=f.value,d=f.properties;f=f.fields;f.forEach(function(a){d[a.type]=a.value});n(b,g,new m(a,h,d,e))});return p(b)}function f(a){if(!a)return void 0;a=a.PHOTO;if((a==null?void 0:a[0])&&c("WAWebURLUtils").isData(a[0].value))return a[0].value}function r(a){a=a.match(/BEGIN:VCARD([\0-\uFFFF]*?)END:VCARD/g);return a?a.map(function(a){return q(a)}).filter(Boolean):[]}function s(a){return(a.SERVICE||[]).some(function(a){return a.type.toLowerCase()===i&&a.value})}g.WA_BIZ_NAME=i;g.Field=m;g.clean=a;g.vcardGetDate=b;g.vcardWids=e;g.parseVcard=q;g.vcardThumbnail=f;g.parseMultiVcard=r;g.vcardIsBiz=s}),98);
__d("WAWebDBMessageUtils",["$InternalEnum","WAWebVcardParsingUtils"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum")({IncomingChatMessage:"1",Outgoing:"2",SystemMessage:"3"});function i(a){a=a.toString(16);return(a.length-1).toString(16)+a}function j(a){return parseInt(a.substring(1),16)}function a(a){return a.toString()+"_/"}function c(a){return a.toString()+"_g"}function e(a,b){b=i(b);return a+"_"+b+"_m"}function f(a){a=a.split("_")[1];return j(a)}function k(a,b,c,d){c?c=h.SystemMessage:!b?c=h.Outgoing:c=h.IncomingChatMessage;return a+"_"+c+"_"+(d!=null?i(d):"")}function l(a){var b;if(a.type==="vcard")b=[a.body];else if(a.type==="multi_vcard")b=a.vcardList.map(function(a){return a.vcard});else return;return b.filter(Boolean).reduce(function(a,b){b=d("WAWebVcardParsingUtils").vcardWids(d("WAWebVcardParsingUtils").parseVcard(b));return a.concat(b.map(function(a){return a.toString()}))},[])}g.MessagePropertyType=h;g.undoOrderPreservingHex=j;g.beginningOfChat=a;g.endOfChat=c;g.craftInternalId=e;g.getInChatMsgId=f;g.craftMessageRangeIndex=k;g.getVcardWids=l}),98);
__d("WAWebDBMsgOpaqueDataKeys",[],(function(a,b,c,d,e,f){b=["body","caption","paymentAmount1000","futureproofBuffer","messageSecret","clientUrl","loc","lng","lat","isLive","matchedText","title","description","pollName","pollSelectableOptionsCount","isSentCagPollCreation","pollUpdateParentKey","encPollVote","senderTimestampMs","targetMessageKey","encIv","encPayload","eventName","isEventCanceled","eventDescription","eventJoinLink","eventStartTime","eventLocation","eventEndTime"];c=["targetMessageKey","pollUpdateParentKey"];var g={targetMessageKey:"encReactionTargetMessageKey",encIv:"encReactionEncIv",encPayload:"encReactionEncPayload",encReactionTargetMessageKey:"targetMessageKey",encReactionEncIv:"encIv",encReactionEncPayload:"encPayload"};function a(a,b){return a==="reaction_enc"?g[b]:b}f.MSG_OPAQUE_DATA_KEYS=b;f.MsgKeyFieldsInOpaqueData=c;f.getKey=a}),66);
__d("WAWebPollsDbUtils",["invariant","WANullthrows"],(function(a,b,c,d,e,f,g,h){function a(a){return a==null?void 0:a.slice().sort(function(a,b){return a.localId-b.localId}).map(function(a,b){var c=a.localId;a=a.name;c===b||h(0,59784);return{name:a}})}function b(a){a=(a=a==null?void 0:a.pollVotes)!=null?a:[];a=a==null?void 0:a.slice().sort(function(a,b){return a.option.localId-b.option.localId}).map(function(a,b){var c=a.option;a=a.optionVoteCount;c.localId===b||h(0,59784);return{option:{name:c.name},optionVoteCount:a}});return{pollVotes:a}}function d(a){return a==null?void 0:a.map(function(a,b){a=a.name;return{name:c("WANullthrows")(a),localId:b}})}function e(a){a=(a=a==null?void 0:a.pollVotes)!=null?a:[];a=a==null?void 0:a.map(function(a,b){var d=a.option;a=a.optionVoteCount;return{option:{name:c("WANullthrows")(d==null?void 0:d.name),localId:b},optionVoteCount:c("WANullthrows")(a)}});return{pollVotes:a}}g.compressPollOptions=a;g.compressPollVotesSnapshot=b;g.expandPollOptions=d;g.expandPollVotesSnapshot=e}),98);
__d("WAWebDBMessageSerialization",["invariant","WAJids","WAWebApiHydrateWidsUtil","WAWebDBMessageUtils","WAWebDBMsgOpaqueDataKeys","WAWebMsgKey","WAWebMsgType","WAWebPollsDbUtils","WAWebProtobufsMdStorageMsgRowOpaqueData.pb","WAWebViewMode.flow","WAWebWid","WAWebWidFactory","WAWebWidToJid","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g,h){var i=1e9,j=new Set(Object.values(d("WAWebMsgType").MSG_TYPE)),k=["id","parentMsgId","protocolMessageKey","paymentRequestMessageKey","keptMessageKey","pollUpdateParentKey","kicKey","latestEditMsgKey","targetMessageKey","pinParentKey","reactionParentKey","parentMsgKey"];function a(a,b){var e,f=babelHelpers["extends"]({},a);a.quotedMsg&&(f.quotedMsg=babelHelpers["extends"]({},a.quotedMsg));((e=a.quotedMsg)==null?void 0:e.paymentNoteMsg)&&(f.quotedMsg.paymentNoteMsg=babelHelpers["extends"]({},a.quotedMsg.paymentNoteMsg));a.paymentNoteMsg&&(f.paymentNoteMsg=babelHelpers["extends"]({},a.paymentNoteMsg));a.paymentBackground&&(f.paymentBackground=babelHelpers["extends"]({},a.paymentBackground));a.groupMentions&&(f.groupMentions=a.groupMentions.map(function(a){return{groupSubject:a.groupSubject,groupJid:d("WAWebWidFactory").createWidFromWidLike(a.groupJid)}}));f.star=f.isStarred!==void 0;f.isMdHistoryMsg=f.rowId<i;f.internalId!=null&&(((e=f.to)==null?void 0:e.server)==="newsletter"||((a=f.from)==null?void 0:a.endsWith("@newsletter")))&&(f.serverId=d("WAWebDBMessageUtils").getInChatMsgId(f.internalId));delete f.internalId;delete f.isStarred;delete f.count;delete f.hasLink;delete f.isMediaMsg;delete f.isDocMsg;delete f.isCarouselMsg;delete f.isEventMsg;delete f.expiredTimestamp;delete f.pendingReadReceipt;m(f);d("WAWebApiHydrateWidsUtil").hydrateWids(f);k.forEach(function(a){f[a]!=null&&(f[a]=c("WAWebMsgKey").from(f[a]))});((e=f.quotedMsg)==null?void 0:e.id)!=null&&(f.quotedMsg.id=c("WAWebMsgKey").from(f.quotedMsg.id));f.messageSecret!=null&&(f.messageSecret=new Uint8Array(f.messageSecret));f.botMessageSecret!=null&&(f.botMessageSecret=new Uint8Array(f.botMessageSecret));a=l(f);e=a[0];var g=a[1];a=a[2];f.futureproofType=e;f.futureproofSubtype=g;f.subtype=(e=a)!=null?e:void 0;f.viewMode=(g=f.viewMode)!=null?g:d("WAWebViewMode.flow").ViewModeType.VISIBLE;f.carouselCardsParsed!=null&&(f.carouselCardsParsed=f.carouselCardsParsed.map(function(a){return babelHelpers["extends"]({},a,{id:a.id instanceof c("WAWebMsgKey")?a.id:new(c("WAWebMsgKey"))(a.id),parentMsgId:a.parentMsgId instanceof c("WAWebMsgKey")?a.parentMsgId:new(c("WAWebMsgKey"))(a.parentMsgId)})}));f.self!=null&&(f.local=f.self==="out",delete f.self);b==null?void 0:b(f);return f}function l(a){var b=a.futureproofType,c=a.futureproofSubtype,e=a.subtype;if(a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType==null&&a.subtype!=null){switch(a.subtype){case"poll_update":b=d("WAWebMsgType").MSG_TYPE.POLL_UPDATE;c="poll_vote";break;case"message_edit":b=d("WAWebMsgType").MSG_TYPE.PROTOCOL;c="message_edit";break;case"phone":case"phone_only_feature":break;default:j.has(a.subtype)||h(0,67194),b=a.subtype}a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&b!=null&&(e=void 0)}a.type===d("WAWebMsgType").MSG_TYPE.POLL_UPDATE&&e==null&&(e="poll_vote");return[b,c,e]}function m(a){var b=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsMdStorageMsgRowOpaqueData.pb").MsgRowOpaqueDataSpec,a.msgRowOpaqueData);if(b.currentMsg){if(b.currentMsg.paymentNoteMsgBody&&a.paymentNoteMsg){var e;a.paymentNoteMsg.body=(e=b.currentMsg)==null?void 0:e.paymentNoteMsgBody}d("WAWebDBMsgOpaqueDataKeys").MSG_OPAQUE_DATA_KEYS.forEach(function(c){var e;a[c]=(e=b.currentMsg)==null?void 0:e[d("WAWebDBMsgOpaqueDataKeys").getKey(a.type,c)]});a.pollOptions=d("WAWebPollsDbUtils").expandPollOptions((e=b.currentMsg)==null?void 0:e.pollOptions);a.pollVotesSnapshot=d("WAWebPollsDbUtils").expandPollVotesSnapshot((e=b.currentMsg)==null?void 0:e.pollVotesSnapshot);e=(e=b.currentMsg)==null?void 0:e.originalSelfAuthor;e!=null&&c("WAWebWid").isWid(e)&&(a.originalSelfAuthor=d("WAWebWidFactory").createWid(e))}if(a.quotedMsg&&b.quotedMsg){b.quotedMsg.paymentNoteMsgBody&&(a.quotedMsg.paymentNoteMsg.body=b.quotedMsg.paymentNoteMsgBody);d("WAWebDBMsgOpaqueDataKeys").MSG_OPAQUE_DATA_KEYS.forEach(function(c){var e;a.quotedMsg[c]=(e=b.quotedMsg)==null?void 0:e[d("WAWebDBMsgOpaqueDataKeys").getKey(a.type,c)]});a.quotedMsg.pollOptions=d("WAWebPollsDbUtils").expandPollOptions((e=b.quotedMsg)==null?void 0:e.pollOptions)}}function b(a){var b,c=babelHelpers["extends"]({},a);a.quotedMsg&&(c.quotedMsg=babelHelpers["extends"]({},a.quotedMsg));((b=a.quotedMsg)==null?void 0:b.paymentNoteMsg)&&(c.quotedMsg.paymentNoteMsg=babelHelpers["extends"]({},a.quotedMsg.paymentNoteMsg));a.paymentNoteMsg&&(c.paymentNoteMsg=babelHelpers["extends"]({},a.paymentNoteMsg));a.from&&(c.from=a.from.toString());k.forEach(function(a){c[a]!=null&&(c[a]=c[a].toString())});delete c.notifyName;delete c.isNewMsg;delete c.clearMedia;delete c.multicast;delete c.urlNumber;delete c.urlText;delete c.linkPreview;delete c.star;delete c.forwardedFromWeb;n(c);return c}function n(a){var b,c={currentMsg:{},quotedMsg:{}};if((b=a.paymentNoteMsg)==null?void 0:b.body){c.currentMsg.paymentNoteMsgBody=a.paymentNoteMsg.body;(b=a.paymentNoteMsg)==null?void 0:delete b.body}((b=a.quotedMsg)==null?void 0:(b=b.paymentNoteMsg)==null?void 0:b.body)&&(c.quotedMsg.paymentNoteMsgBody=a.quotedMsg.paymentNoteMsg.body,delete a.quotedMsg.paymentNoteMsg.body);d("WAWebDBMsgOpaqueDataKeys").MSG_OPAQUE_DATA_KEYS.forEach(function(b){c.currentMsg[d("WAWebDBMsgOpaqueDataKeys").getKey(a.type,b)]=a[b],delete a[b]});a.originalSelfAuthor&&(c.currentMsg.originalSelfAuthor=d("WAJids").extractUserJid(d("WAWebWidToJid").widToDeviceJid(a.originalSelfAuthor)),delete a.originalSelfAuthor);c.currentMsg.pollOptions=d("WAWebPollsDbUtils").compressPollOptions(a.pollOptions);delete a.pollOptions;c.currentMsg.pollVotesSnapshot=d("WAWebPollsDbUtils").compressPollVotesSnapshot(a.pollVotesSnapshot);delete a.pollVotesSnapshot;a.quotedMsg&&(d("WAWebDBMsgOpaqueDataKeys").MSG_OPAQUE_DATA_KEYS.forEach(function(b){c.quotedMsg[b]=a.quotedMsg[b],delete a.quotedMsg[b]}),c.quotedMsg.pollOptions=d("WAWebPollsDbUtils").compressPollOptions(a.quotedMsg.pollOptions),delete a.quotedMsg.pollOptions);b=d("encodeProtobuf").encodeProtobuf(d("WAWebProtobufsMdStorageMsgRowOpaqueData.pb").MsgRowOpaqueDataSpec,c);a.msgRowOpaqueData=b.readBuffer()}g.messageFromDbRow=a;g.movFieldFromOpaqueDataBackToMsg=m;g.dbRowFromMessage=b;g.movEncFieldToOpaqueData=n}),98);
__d("WAWebDBGetStarredMessagesForChat",["Promise","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebSchemaMessage"],(function(a,b,c,d,e,f,g){var h;function a(a,c,e){return(h||(h=b("Promise"))).resolve().then(function(){if(e!=null)return d("WAWebSchemaMessage").getMessageTable().get(e.toString())}).then(function(b){b=b==null?[d("WAWebDBMessageUtils").endOfChat(a),Infinity]:[b.internalId,b.isStarred];var e=[d("WAWebDBMessageUtils").beginningOfChat(a),0];return d("WAWebSchemaMessage").getMessageTable().between(["internalId","isStarred"],e,b,{lowerInclusive:!1,upperInclusive:!1,reverse:!0,limit:c}).then(function(a){return a.map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)})})})}g.getStarredMessagesForChat=a}),98);
__d("WAWebDBGroupsGroupMetadata",["Promise","WABatcher","WALogger","WAWebABProps","WAWebModelStorageUtils","WAWebSchemaGroupMetadata","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["persistGroupMetadataBatched: persisting "," records"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["persistGroupMetadataBatched: aggregating "," changes"]);j=function(){return a};return a}function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.groupInfos;yield d("WAWebModelStorageUtils").getStorage().lock(["group-metadata"],function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var e=(yield b.bulkGet(c.map(function(a){return a.id.toString()})));a=c.map(function(a,b){var c;b=e[b];var f={subject:a.subject,subjectTime:a.subjectTime||0},g={announce:a.announce,a_v_id:a.a_v_id||0};c={desc:a.desc,descId:a.descId,descOwner:(c=a.descOwner)==null?void 0:c.toString(),descTime:a.descTime||0};if(b){var h=b.subjectTime||0,i=b.a_v_id||0,j=b.descTime||0;h>f.subjectTime&&(f={subject:b.subject,subjectTime:h});i>g.a_v_id&&(g={announce:b.announce,a_v_id:i});j>c.descTime&&(c={desc:b.desc,descId:b.descId,descOwner:b.descOwner,descTime:j})}d("WAWebABProps").getABPropConfigValue("dm_initiator_trigger_groups")?h={ephemeralDuration:a.ephemeralDuration||0,disappearingModeTrigger:a.disappearingModeTrigger,disappearingModeInitiatedByMe:a.disappearingModeInitiatedByMe}:h={ephemeralDuration:a.ephemeralDuration||0};return babelHelpers["extends"]({id:a.id.toString(),creation:a.creation,owner:(i=a.owner)==null?void 0:i.toString(),restrict:a.restrict,noFrequentlyForwarded:a.noFrequentlyForwarded,membershipApprovalMode:a.membershipApprovalMode,memberAddMode:a.memberAddMode,growthLockExpiration:a.growthLockExpiration,growthLockType:a.growthLockType,size:a.size||0,support:(j=a.support)!=null?j:!1,suspended:(i=a.suspended)!=null?i:!1,terminated:(j=a.terminated)!=null?j:!1,parentGroup:(i=a.parentGroup)==null?void 0:i.toString(),isParentGroup:a.isParentGroup,isParentGroupClosed:a.isParentGroupClosed,defaultSubgroup:a.defaultSubgroup,generalSubgroup:a.generalSubgroup,lastActivityTimestamp:(j=b==null?void 0:b.lastActivityTimestamp)!=null?j:0,lastSeenActivityTimestamp:(i=b==null?void 0:b.lastSeenActivityTimestamp)!=null?i:0,incognito:a.incognito,isLidAddressingMode:a.isLidAddressingMode,reportToAdminMode:(j=a.reportToAdminMode)!=null?j:!1,lastReportToAdminTimestamp:b==null?void 0:b.lastReportToAdminTimestamp,allowNonAdminSubGroupCreation:a.allowNonAdminSubGroupCreation,generalChatAutoAddDisabled:a.generalChatAutoAddDisabled,hasCapi:a.hasCapi===!0,hiddenSubgroup:a.hiddenSubgroup,lastCommunityPollTimestamp:b==null?void 0:b.lastCommunityPollTimestamp},f,c,g,h)});return b.bulkCreateOrMerge(a)});return function(a){return e.apply(this,arguments)}}())});return k.apply(this,arguments)}function c(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.groupWid;var b=(yield d("WAWebSchemaGroupMetadata").getGroupMetadataTable().get(String(a)));return!b?null:{id:a,owner:b.owner==null?null:d("WAWebWidFactory").createWid(b.owner),creation:b.creation,desc:(a=b.desc)!=null?a:void 0,descId:(a=b.descId)!=null?a:void 0,descOwner:b.descOwner==null?null:d("WAWebWidFactory").createWid(b.descOwner),descTime:(a=b.descTime)!=null?a:void 0,restrict:b.restrict||!1,announce:b.announce||!1,noFrequentlyForwarded:b.noFrequentlyForwarded||!1,ephemeralDuration:b.ephemeralDuration||0,membershipApprovalMode:(a=b.membershipApprovalMode)!=null?a:!1,memberAddMode:b.memberAddMode,subject:b.subject,support:b.support===!0,lastActivityTimestamp:(a=b.lastActivityTimestamp)!=null?a:0,lastSeenActivityTimestamp:(a=b.lastSeenActivityTimestamp)!=null?a:0,lastReportToAdminTimestamp:(a=b.lastReportToAdminTimestamp)!=null?a:null,incognito:b.incognito,isLidAddressingMode:b.isLidAddressingMode,allowNonAdminSubGroupCreation:(a=b.allowNonAdminSubGroupCreation)!=null?a:!1,generalChatAutoAddDisabled:(a=b.generalChatAutoAddDisabled)!=null?a:!1,hasCapi:b.hasCapi===!0,lastCommunityPollTimestamp:(a=b.lastCommunityPollTimestamp)!=null?a:0}});return l.apply(this,arguments)}var m=function(){var a=3e3;return d("WABatcher").batch({delayMs:a},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").DEV(j(),a.length);b=b();d("WALogger").DEV(i(),b.length);yield d("WAWebSchemaGroupMetadata").getGroupMetadataTable().bulkCreateOrMerge(b);return a.map(function(a){return void 0});function b(){return Array.from(a.reduce(function(a,b){var c;a.set(b.id,babelHelpers["extends"]({},(c=a.get(b.id))!=null?c:{},b));return a},new Map()).values())}});return function(b){return a.apply(this,arguments)}}())}();function e(a,b,c){c===void 0&&(c=!1);return c?m(babelHelpers["extends"]({id:a.toString()},b)):d("WAWebSchemaGroupMetadata").getGroupMetadataTable().createOrMerge(a.toString(),babelHelpers["extends"]({id:a.toString()},b))}function f(a){return d("WAWebSchemaGroupMetadata").getGroupMetadataTable().get(a.toString())}function n(a){return a.length===0?(h||(h=b("Promise"))).resolve([]):d("WAWebSchemaGroupMetadata").getGroupMetadataTable().bulkGet(a.map(function(a){return a==null?"":a.toString()}))}g.updateGroupMetadataTable=a;g.getGroupMetadataUNSAFE=c;g.persistGroupMetadata=e;g.getGroupMetadata=f;g.bulkGetGroupMetadata=n}),98);
__d("WAWebUsernameTypes",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({CTWA:"ctwa",USERNAME:"username",GENERAL:"general"});f.LidOriginType=a}),66);
__d("WAWebWamEnumChatOriginsType",[],(function(a,b,c,d,e,f){a=Object.freeze({LID_USERNAME:1,LID_CTWA:2,OTHERS:3});f.CHAT_ORIGINS_TYPE=a}),66);
__d("WAWebChatThreadLoggingEventStore",["Promise","WAJids","WALogger","WAShiftTimer","WAWebABProps","WAWebApiChat","WAWebApiChatThreadLoggingPendingEvents","WAWebApiContact","WAWebBotTypes","WAWebChatThreadLoggingBoolFlagFields","WAWebChatThreadLoggingCountFields","WAWebChatThreadLoggingUtils","WAWebDBBulkGetIsContactABusiness","WAWebDBGetStarredMessagesForChat","WAWebDBGroupsGroupMetadata","WAWebGroupType","WAWebLidAwareContactsDB","WAWebSchemaBusinessProfile","WAWebSchemaParticipant","WAWebUserPrefsMeUser","WAWebUsernameTypes","WAWebWamEnumChatOriginsType","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["ChatThreadLoggingEventStoreImpl: flushing cache with "," updates"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Passed event store info type not valid: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["ChatThreadLoggingEventStoreImpl: lastUploadedStartTs=",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["ChatThreadLoggingEventStoreImpl: handleMessages: offset unset."]);l=function(){return a};return a}var m=5;a=function(){function a(a,b){var c=this;this.metadataStore=a;this.$1=new Map();this.$2=(a=b)!=null?a:m;this.$3=new(d("WAShiftTimer").ShiftTimer)(function(){c.$4()})}var e=a.prototype;e.handleMessages=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this,c=(yield this.metadataStore.getOffset());if(c==null){d("WALogger").LOG(l());return}var e=(yield this.metadataStore.getLastUploadedStartTs());d("WALogger").LOG(k(),e);a.forEach(function(a){var f;if(!d("WAWebChatThreadLoggingUtils").shouldUpdateChatEvent(c,a.ts,e))return;var g=d("WAWebChatThreadLoggingUtils").computeStartTs(c,a.ts),h=a.chatId.toString({legacy:!0}),i=h+"_"+String(g),k=b.$1.get(i);f=(f=k)!=null?f:babelHelpers["extends"]({},d("WAWebChatThreadLoggingCountFields").COUNT_FIELDS,d("WAWebChatThreadLoggingBoolFlagFields").FLAG_FIELDS,{startTs:g,chatId:h,addMsgsSent:0,addMsgsReceived:0,addMsgsRead:0,addViewOnceMsgsSent:0,addViewOnceMsgsReceived:0,addViewOnceMsgsOpened:0,addCallOffersSent:0,addCallOffersReceived:0,addTotalCallDuration:0,addCommerceMsgsSent:0,addCommerceMsgsReceived:0,addPdpInquiriesSent:0,addReactionsSent:0,addReactionsReceived:0,addForwardMessagesSent:0,addForwardMessagesReceived:0,addEditedMsgsSent:0,addBotMessagesSent:0,addBotMessagesReceived:0,addBotMessagesEdited:0,addEventCreationMessagesSent:0,addEventCreationMessagesReceived:0,addEventResponseMessagesSent:0,addEventResponseMessagesReceived:0});k==null&&b.$1.set(i,f);g=d("WAWebChatThreadLoggingCountFields").toMaybeCountActionType(a.activityType);h=d("WAWebChatThreadLoggingBoolFlagFields").toMaybeBoolFlagActionType(a.activityType);if(g!=null)f[g]+=1;else if(h!=null)f[h]=a.boolValue===void 0?!0:a.boolValue;else switch(a.activityType){case"msgSend":f.addMsgsSent+=1;a.isViewOnce&&(f.addViewOnceMsgsSent+=1);a.isCommerceMessage===!0&&(f.addCommerceMsgsSent+=1);a.isPdpInquiry===!0&&(f.addPdpInquiriesSent+=1);a.isReply&&(f.repliesSent+=1);a.isReaction&&(f.addReactionsSent+=1);a.isForwarded&&(f.addForwardMessagesSent+=1);a.isEdit&&(f.addEditedMsgsSent+=1);a.isBot&&(f.addBotMessagesSent+=1);a.isEventCreation&&(f.addEventCreationMessagesSent+=1);a.isEventResponse&&(f.addEventResponseMessagesSent+=1);break;case"msgReceive":f.addMsgsReceived+=1;a.isViewOnce&&(f.addViewOnceMsgsReceived+=1);a.isCommerceMessage===!0&&(f.addCommerceMsgsReceived+=1);a.isReaction&&(f.addReactionsReceived+=1);a.isForwarded&&(f.addForwardMessagesReceived+=1);a.isBot&&(a.isEdit?f.addBotMessagesEdited+=1:f.addBotMessagesReceived+=1);a.isEventCreation&&(f.addEventCreationMessagesReceived+=1);a.isEventResponse&&(f.addEventResponseMessagesReceived+=1);break;case"msgRead":f.addMsgsRead+=a.readCount;break;case"viewOnceOpen":f.addViewOnceMsgsOpened+=1;break;case"voipCall":a.outgoing?f.addCallOffersSent+=1:f.addCallOffersReceived+=1;f.addTotalCallDuration+=a.durationInSeconds;break;default:d("WALogger").WARN(j(),a.activityType)}});yield this.$5()});function c(b){return a.apply(this,arguments)}return c}();e.$5=function(){this.$3.onOrBefore(this.$2*1e3)};e.$4=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=Array.from(this.$1.values());d("WALogger").DEV(i(),a.length).devConsole({updates:a});this.$1.clear();yield d("WAWebApiChatThreadLoggingPendingEvents").createOrUpdateChatEvents(a)});function c(){return a.apply(this,arguments)}return c}();e.$6=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=d("WAWebApiChat").bulkGetChats(a.map(function(a){return d("WAWebWidFactory").createWid(a.chatId)})),f=e.then(function(a){return t(a)}),g=e.then(function(a){return u(a)}),i=e.then(function(a){return v(a)}),j=e.then(function(a){return x(a)}),k=e.then(function(a){return y(a)});w=e.then(w);e=(yield (h||(h=b("Promise"))).all([e,f,g,i,w,j,k]));var l=e[0],m=e[1],n=e[2],o=e[3],p=e[4],q=e[5],r=e[6],s=d("WAWebUserPrefsMeUser").getMeUser()!=null?yield d("WAWebChatThreadLoggingUtils").getMeHasUsername():!1;return h.all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e,f,g,h,i,j=l[b],k=c("WAWebWid").isGroup(a.chatId),t=o[b];e=d("WAWebBotTypes").BizBotAutomatedType.cast((e=q[b])==null?void 0:e.automatedType);f=k?{isAGroup:k,groupSize:(f=(f=p[b])==null?void 0:(f=f.participants)==null?void 0:f.length)!=null?f:1,groupType:t==null?d("WAWebGroupType").GroupType.DEFAULT:d("WAWebGroupType").getGroupTypeFromGroupMetadata(t)}:{isAGroup:k,isAContact:yield d("WAWebApiContact").isAddressBookContact(a.chatId),automatedType:e};k=d("WAWebWidFactory").createWid(a.chatId);e=((e=j==null?void 0:j.pin)!=null?e:0)>0;g=(g=j==null?void 0:j.archive)!=null?g:!1;var u=m[b];h=(h=j==null?void 0:j.unreadCount)!=null?h:0;i=((i=j==null?void 0:j.muteExpiration)!=null?i:0)!==0;var v=n[b]?yield d("WAWebChatThreadLoggingUtils").getBizCatalogType(k):null,w=c("WAWebWid").isLid(a.chatId)||(t==null?void 0:t.defaultSubgroup)===!0,x=d("WAWebUserPrefsMeUser").isMeAccount(k),y=k.isBot(),z=d("WAWebChatThreadLoggingUtils").getWamDisappearingModeInitiatedByMe(j==null?void 0:j.disappearingModeInitiatedByMe),A=d("WAWebChatThreadLoggingUtils").getWamDisappearingModeTrigger(j==null?void 0:j.disappearingModeTrigger);d("WAWebABProps").getABPropConfigValue("dm_initiator_trigger_groups")&&c("WAWebWid").isGroup(j==null?void 0:j.id)&&(z=d("WAWebChatThreadLoggingUtils").getWamDisappearingModeInitiatedByMe(t==null?void 0:t.disappearingModeInitiatedByMe),A=d("WAWebChatThreadLoggingUtils").getWamDisappearingModeTriggerGroups(t==null?void 0:t.disappearingModeTrigger));t=s;var B=null;b=r[b];if(b!=null){var C=d("WAWebWidFactory").createWid(b.id).isLid()?"lid":"pn";B=d("WAWebChatThreadLoggingUtils").getOppositeVisibleIdentificationType(b,C)}b=d("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.OTHERS;k.isLid()&&(b=d("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.LID_CTWA);if(j==null?void 0:j.lidOriginType)switch(j==null?void 0:j.lidOriginType){case d("WAWebUsernameTypes").LidOriginType.CTWA:b=d("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.LID_CTWA;break;case d("WAWebUsernameTypes").LidOriginType.USERNAME:b=d("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.LID_USERNAME;break;case d("WAWebUsernameTypes").LidOriginType.GENERAL:b=d("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.OTHERS;break}return babelHelpers["extends"]({},a,{isPinned:e,isArchived:g,contactInfo:f,messagesStarred:u,messagesUnread:h,isMuted:i,bizCatalogType:v,isPnhEnabledChat:w,isMessageYourself:x,isUserAgent:y,ephemeralityInitiator:z,ephemeralityTriggerAction:A,hasUsername:t,oppositeVisibleIdentification:B,chatOrigins:b})});return function(b,c){return a.apply(this,arguments)}}()));function t(a){return(h||(h=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return a==null?0:(yield d("WAWebDBGetStarredMessagesForChat").getStarredMessagesForChat(d("WAWebWidFactory").createWid(a.id),Number.MAX_SAFE_INTEGER)).length});return function(b){return a.apply(this,arguments)}}()))}function u(a){return d("WAWebDBBulkGetIsContactABusiness").bulkGetIsContactABusiness(a.map(function(a){return a==null?null:d("WAWebWidFactory").createWid(a.id)}))}function v(a){return d("WAWebDBGroupsGroupMetadata").bulkGetGroupMetadata(a.map(function(a){return a==null?null:d("WAWebWidFactory").createWid(a.id)}))}function w(a){return d("WAWebSchemaParticipant").getParticipantTable().bulkGet(a.map(function(a){return a==null?"":d("WAWebWidFactory").createWid(a.id).toString()}))}function x(a){return d("WAWebSchemaBusinessProfile").getBusinessProfileTable().bulkGet(a.map(function(a){return a==null?"":d("WAWebWidFactory").createWid(a.id).toString()}))}function y(a){return c("WAWebLidAwareContactsDB").bulkGet(a.map(function(a){if(a==null)return null;a=d("WAWebWidFactory").createWid(a.id);if(!a.isUserNotPSA())return null;if(a.isLid()){var b=d("WAWebApiContact").getPhoneNumber(d("WAWebWidFactory").toUserWid(a));if(b==null)return a.toString()}return d("WAJids").toPhoneUserJid(a.user.toString())}).filter(Boolean))}});function e(b){return a.apply(this,arguments)}return e}();e.getEvent=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){this.$1.size>0&&(yield this.$4());a=(yield d("WAWebApiChatThreadLoggingPendingEvents").getChatEvent(a,b));return a==null?null:(yield this.$6([a]))[0]});function c(b,c){return a.apply(this,arguments)}return c}();e.getBeforeInclusive=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){this.$1.size>0&&(yield this.$4());return this.$6(yield d("WAWebApiChatThreadLoggingPendingEvents").getBeforeInclusive(a))});function c(b){return a.apply(this,arguments)}return c}();e.deleteBeforeInclusive=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){this.$1.size>0&&(yield this.$4());return d("WAWebApiChatThreadLoggingPendingEvents").deleteBeforeInclusive(a)});function c(b){return a.apply(this,arguments)}return c}();return a}();g.ChatThreadLoggingEventStoreImpl=a}),98);
__d("WAWebWamEnumBizCatalogType",[],(function(a,b,c,d,e,f){a=Object.freeze({SHOPS:0,NATIVE:1});f.BIZ_CATALOG_TYPE=a}),66);
__d("WAWebWamEnumBlockReason",[],(function(a,b,c,d,e,f){a=Object.freeze({OTHER:0,NO_LONGER_NEEDED:1,NO_SIGN_UP:2,SPAM:3,OFFENSIVE_MESSAGES:4,OTP_DID_NOT_REQUEST:5});f.BLOCK_REASON=a}),66);
__d("WAWebWamEnumChatMutedType",[],(function(a,b,c,d,e,f){a=Object.freeze({NOT_MUTED:1,MUTED_NO_NOTIFICATIONS:2,MUTED_SILENT_NOTIFICATIONS:3});f.CHAT_MUTED_TYPE=a}),66);
__d("WAWebWamEnumChatType",[],(function(a,b,c,d,e,f){a=Object.freeze({INDIVIDUAL:1,SMB:2,ENT:3,INTEROP:4});f.CHAT_TYPE=a}),66);
__d("WAWebWamEnumDisappearingChatInitiatorType",[],(function(a,b,c,d,e,f){a=Object.freeze({CHAT:1,INITIATED_BY_ME:2,INITIATED_BY_OTHER:3,CHAT_PICKER:4,BIZ_UPGRADE_FB_HOSTING:5});f.DISAPPEARING_CHAT_INITIATOR_TYPE=a}),66);
__d("WAWebWamEnumEphemeralityInitiatorType",[],(function(a,b,c,d,e,f){a=Object.freeze({INITIATED_BY_ME:1,INITIATED_BY_OTHER:2,BIZ_UPGRADE_FB_HOSTING:3});f.EPHEMERALITY_INITIATOR_TYPE=a}),66);
__d("WAWebWamEnumEphemeralityTriggerActionType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,CHAT_SETTINGS:1,ACCOUNT_SETTINGS:2,BULK_CHANGE:3,BIZ_SUPPORTS_FB_HOSTING:4,UNKNOWN_GROUP:5});f.EPHEMERALITY_TRIGGER_ACTION_TYPE=a}),66);
__d("WAWebWamEnumGaStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({NEW:0,RETAINED:1,RESURRECTED:2});f.GA_STATUS=a}),66);
__d("WAWebWamEnumGroupInfoSettingType",[],(function(a,b,c,d,e,f){a=Object.freeze({ADMINS_ONLY:1,ALL_PARTICIPANTS:2});f.GROUP_INFO_SETTING_TYPE=a}),66);
__d("WAWebWamEnumOppositeVisibleIdentificationType",[],(function(a,b,c,d,e,f){a=Object.freeze({PHONE_NUMBER:1,SAVED_CONTACT_NAME:2,USERNAME:3,MASKED_PHONE_NUMBER:4,VERIFIED_BUSINESS_NAME:5,PLACEHOLDER:6,PUSHNAME:7});f.OPPOSITE_VISIBLE_IDENTIFICATION_TYPE=a}),66);
__d("WAWebChatMessageCountsWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumBizCatalogType","WAWebWamEnumBlockReason","WAWebWamEnumChatMutedType","WAWebWamEnumChatOriginsType","WAWebWamEnumChatType","WAWebWamEnumDisappearingChatInitiatorType","WAWebWamEnumEphemeralityInitiatorType","WAWebWamEnumEphemeralityTriggerActionType","WAWebWamEnumGaStatus","WAWebWamEnumGroupInfoSettingType","WAWebWamEnumOppositeVisibleIdentificationType","WAWebWamEnumTypeOfGroupEnum"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({ChatMessageCounts:[1644,{aiDiscoveryTab:[195,a.TYPES.STRING],aptTestId:[212,a.TYPES.STRING],audioMessagesReceived:[149,a.TYPES.INTEGER],audioMessagesSent:[150,a.TYPES.INTEGER],autoReplyFromIcebreakerSent:[190,a.TYPES.INTEGER],awayMsgsSent:[56,a.TYPES.INTEGER],bizCatalogType:[60,d("WAWebWamEnumBizCatalogType").BIZ_CATALOG_TYPE],bizConversationDepth:[65,a.TYPES.INTEGER],blockReason:[33,d("WAWebWamEnumBlockReason").BLOCK_REASON],bottomSheetAnimatedSent:[206,a.TYPES.INTEGER],bottomSheetEditedAnimatedSent:[207,a.TYPES.INTEGER],bottomSheetEditedSent:[208,a.TYPES.INTEGER],bottomSheetForwardMessagesSent:[196,a.TYPES.INTEGER],bottomSheetImagesEdited:[209,a.TYPES.INTEGER],bottomSheetImagesGenerated:[197,a.TYPES.INTEGER],bottomSheetMemuImagesGenerated:[220,a.TYPES.INTEGER],bottomSheetMemuInitiated:[221,a.TYPES.INTEGER],bottomSheetMemuMessagesSent:[222,a.TYPES.INTEGER],bottomSheetMessagesDownloaded:[198,a.TYPES.INTEGER],bottomSheetMessagesReceived:[199,a.TYPES.INTEGER],bottomSheetMessagesSent:[200,a.TYPES.INTEGER],bottomSheetPromptsInitiated:[201,a.TYPES.INTEGER],bottomSheetRegeneratedSent:[210,a.TYPES.INTEGER],broadcastMsgsReceived:[30,a.TYPES.INTEGER],broadcastMsgsSent:[29,a.TYPES.INTEGER],callOffersReceived:[27,a.TYPES.INTEGER],callOffersSent:[26,a.TYPES.INTEGER],callsResultBusy:[70,a.TYPES.INTEGER],callsResultCancelled:[71,a.TYPES.INTEGER],callsResultConnected:[72,a.TYPES.INTEGER],callsResultError:[78,a.TYPES.INTEGER],callsResultMissed:[73,a.TYPES.INTEGER],callsResultRejected:[74,a.TYPES.INTEGER],canEditDmSettings:[88,a.TYPES.BOOLEAN],cartViews:[86,a.TYPES.INTEGER],chatEphemeralityDuration:[15,a.TYPES.INTEGER],chatMuted:[8,d("WAWebWamEnumChatMutedType").CHAT_MUTED_TYPE],chatOrigins:[179,d("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE],chatOverflowClicks:[79,a.TYPES.INTEGER],chatTypeInd:[2,d("WAWebWamEnumChatType").CHAT_TYPE],collectionInquiriesSent:[44,a.TYPES.INTEGER],commandSheetShow:[174,a.TYPES.INTEGER],commentsReceived:[126,a.TYPES.INTEGER],commerceMsgsReceived:[41,a.TYPES.INTEGER],commerceMsgsSent:[40,a.TYPES.INTEGER],deviceLanguage:[219,a.TYPES.STRING],disappearingChatInitiator:[59,d("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE],documentMessagesReceived:[151,a.TYPES.INTEGER],documentMessagesSent:[152,a.TYPES.INTEGER],editedMsgsSent:[100,a.TYPES.INTEGER],emuFlashPlaybacks:[184,a.TYPES.INTEGER],emuFlashPreviewShow:[182,a.TYPES.INTEGER],emuFlashSent:[183,a.TYPES.INTEGER],entryPointConversionApp:[47,a.TYPES.STRING],entryPointConversionSource:[46,a.TYPES.STRING],ephemeralMessagesReceived:[14,a.TYPES.INTEGER],ephemeralMessagesSent:[13,a.TYPES.INTEGER],ephemeralMessagesUnreadExpired:[69,a.TYPES.INTEGER],ephemeralityInitiator:[109,d("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE],ephemeralityTriggerAction:[110,d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE],eventCreationMessagesReceived:[142,a.TYPES.INTEGER],eventCreationMessagesSent:[143,a.TYPES.INTEGER],eventResponseMessagesReceived:[144,a.TYPES.INTEGER],eventResponseMessagesSent:[145,a.TYPES.INTEGER],fbCtaInquiriesSent:[45,a.TYPES.INTEGER],firstResponseTime:[25,a.TYPES.INTEGER],forwardAudioMessagesReceived:[153,a.TYPES.INTEGER],forwardAudioMessagesSent:[154,a.TYPES.INTEGER],forwardDocumentMessagesReceived:[155,a.TYPES.INTEGER],forwardDocumentMessagesSent:[156,a.TYPES.INTEGER],forwardGifMessagesReceived:[157,a.TYPES.INTEGER],forwardGifMessagesSent:[158,a.TYPES.INTEGER],forwardMessagesReceived:[89,a.TYPES.INTEGER],forwardMessagesSent:[90,a.TYPES.INTEGER],forwardPhotoMessagesReceived:[128,a.TYPES.INTEGER],forwardPhotoMessagesSent:[129,a.TYPES.INTEGER],forwardPtvMessagesReceived:[159,a.TYPES.INTEGER],forwardPtvMessagesSent:[160,a.TYPES.INTEGER],forwardStatusReplyMessagesReceived:[161,a.TYPES.INTEGER],forwardStatusReplyMessagesSent:[162,a.TYPES.INTEGER],forwardStickerMessagesReceived:[163,a.TYPES.INTEGER],forwardStickerMessagesSent:[164,a.TYPES.INTEGER],forwardTextMessagesReceived:[130,a.TYPES.INTEGER],forwardTextMessagesSent:[131,a.TYPES.INTEGER],forwardUrlMessagesReceived:[132,a.TYPES.INTEGER],forwardUrlMessagesSent:[133,a.TYPES.INTEGER],forwardVideoMessagesReceived:[165,a.TYPES.INTEGER],forwardVideoMessagesSent:[166,a.TYPES.INTEGER],gaStatus:[22,d("WAWebWamEnumGaStatus").GA_STATUS],gifMessagesReceived:[167,a.TYPES.INTEGER],gifMessagesSent:[168,a.TYPES.INTEGER],googleSearchClick:[214,a.TYPES.INTEGER],googleSearchShow:[215,a.TYPES.INTEGER],greetingMsgsSent:[57,a.TYPES.INTEGER],groupContainsBiz:[75,a.TYPES.BOOLEAN],groupInfoSetting:[87,d("WAWebWamEnumGroupInfoSettingType").GROUP_INFO_SETTING_TYPE],groupMembershipReplies:[51,a.TYPES.INTEGER],groupPrivateReplies:[52,a.TYPES.INTEGER],groupSize:[19,a.TYPES.INTEGER],hasReplied1On1:[216,a.TYPES.BOOLEAN],hasUsername:[180,a.TYPES.BOOLEAN],imagineCommandClick:[175,a.TYPES.INTEGER],imagineMeMessagesSent:[202,a.TYPES.INTEGER],imagineMePromptsInitiatedCount:[203,a.TYPES.INTEGER],imagineMentionClick:[146,a.TYPES.INTEGER],imagineMentionShow:[176,a.TYPES.INTEGER],isAContact:[6,a.TYPES.BOOLEAN],isAContactAtThreadCreation:[213,a.TYPES.BOOLEAN],isAGroup:[5,a.TYPES.BOOLEAN],isArchived:[10,a.TYPES.BOOLEAN],isAutoMuted:[108,a.TYPES.BOOLEAN],isBlocked:[32,a.TYPES.BOOLEAN],isCartAddClicked:[36,a.TYPES.BOOLEAN],isCommerceViewed:[35,a.TYPES.BOOLEAN],isCtaOnPdpClicked:[37,a.TYPES.BOOLEAN],isDeleted:[185,a.TYPES.BOOLEAN],isInviteCreatedThread:[106,a.TYPES.BOOLEAN],isLabelled:[54,a.TYPES.BOOLEAN],isMessageYourself:[91,a.TYPES.BOOLEAN],isMetaAiAssistant:[211,a.TYPES.BOOLEAN],isOppositePartyInitiated:[62,a.TYPES.BOOLEAN],isPinned:[9,a.TYPES.BOOLEAN],isPnhEnabledChat:[92,a.TYPES.BOOLEAN],isReported:[186,a.TYPES.BOOLEAN],isUser1pBizBotChat:[141,a.TYPES.BOOLEAN],isUser3pBotChat:[140,a.TYPES.BOOLEAN],isUserAgent:[111,a.TYPES.BOOLEAN],isUserCreatedAgent:[123,a.TYPES.BOOLEAN],isWaPayRegistered:[81,a.TYPES.BOOLEAN],labelledMsgs:[55,a.TYPES.INTEGER],locationsSent:[96,a.TYPES.INTEGER],markedReadCnt:[193,a.TYPES.INTEGER],markedReadMessageCnt:[194,a.TYPES.INTEGER],messagesRead:[127,a.TYPES.INTEGER],messagesReceived:[4,a.TYPES.INTEGER],messagesSent:[3,a.TYPES.INTEGER],messagesStarred:[12,a.TYPES.INTEGER],messagesUnread:[11,a.TYPES.INTEGER],metaAiMentionClick:[147,a.TYPES.INTEGER],metaAiMentionShow:[148,a.TYPES.INTEGER],newThread:[68,a.TYPES.BOOLEAN],odReceived:[82,a.TYPES.INTEGER],oppositePartyHasBusinessIntent:[204,a.TYPES.BOOLEAN],oppositePartyHasProfilePhoto:[217,a.TYPES.BOOLEAN],oppositeVisibleIdentification:[181,d("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE],ordersSent:[38,a.TYPES.INTEGER],p2mOdNnpTransactionsSent:[83,a.TYPES.INTEGER],p2mOdNpTransactionsSent:[84,a.TYPES.INTEGER],paymentsSent:[39,a.TYPES.INTEGER],pdpInquiriesSent:[42,a.TYPES.INTEGER],pdpViews:[61,a.TYPES.INTEGER],photoMessagesReceived:[134,a.TYPES.INTEGER],photoMessagesSent:[135,a.TYPES.INTEGER],pollCreationMessagesReceived:[115,a.TYPES.INTEGER],pollCreationMessagesSent:[116,a.TYPES.INTEGER],pollUpdateMessagesReceived:[117,a.TYPES.INTEGER],pollUpdateMessagesSent:[118,a.TYPES.INTEGER],profileReplies:[64,a.TYPES.INTEGER],profileViews:[63,a.TYPES.INTEGER],pttMessagesReceived:[119,a.TYPES.INTEGER],pttMessagesSent:[120,a.TYPES.INTEGER],ptvMessagesReceived:[121,a.TYPES.INTEGER],ptvMessagesSent:[122,a.TYPES.INTEGER],quickRepliesSent:[58,a.TYPES.INTEGER],reactionsReceived:[97,a.TYPES.INTEGER],reactionsSent:[98,a.TYPES.INTEGER],receiverDefaultDisappearingDuration:[21,a.TYPES.INTEGER],repliesSent:[80,a.TYPES.INTEGER],requestedPhoneNumber:[93,a.TYPES.BOOLEAN],seenMaskedPhoneNumber:[94,a.TYPES.BOOLEAN],senderDefaultDisappearingDuration:[20,a.TYPES.INTEGER],sharedPhoneNumber:[99,a.TYPES.BOOLEAN],sharesCommonGroup:[218,a.TYPES.BOOLEAN],smbMarketingMessagesReactionsSent:[101,a.TYPES.INTEGER],smbMarketingMessagesRepliesSent:[102,a.TYPES.INTEGER],smbMarketingMessagesSpamReports:[103,a.TYPES.INTEGER],smbMarketingMsgsReceived:[104,a.TYPES.INTEGER],smbMarketingMsgsSent:[105,a.TYPES.INTEGER],spamReports:[31,a.TYPES.INTEGER],startTime:[7,a.TYPES.INTEGER],statusReactionsReceived:[191,a.TYPES.INTEGER],statusReactionsSent:[192,a.TYPES.INTEGER],statusReplies:[50,a.TYPES.INTEGER],statusReplyMessagesReceived:[169,a.TYPES.INTEGER],statusViews:[49,a.TYPES.INTEGER],stickerMessagesReceived:[170,a.TYPES.INTEGER],stickerMessagesSent:[171,a.TYPES.INTEGER],storefrontInquiriesSent:[43,a.TYPES.INTEGER],suggestionPromptsClick:[177,a.TYPES.INTEGER],suggestionPromptsShow:[178,a.TYPES.INTEGER],textMessagesReceived:[136,a.TYPES.INTEGER],textMessagesSent:[137,a.TYPES.INTEGER],textMessagesToUserCreatedAgentCnt:[124,a.TYPES.INTEGER],threadCreationDate:[189,a.TYPES.STRING],threadDs:[66,a.TYPES.STRING],threadId:[67,a.TYPES.STRING],totalCallDuration:[28,a.TYPES.INTEGER],totalMessageEditsFromAgentCnt:[112,a.TYPES.INTEGER],totalMessageFromAgentCnt:[113,a.TYPES.INTEGER],totalMessageToAgentCnt:[114,a.TYPES.INTEGER],totalMessagesToUserCreatedAgentCnt:[125,a.TYPES.INTEGER],typeOfGroup:[85,d("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM],urlMessagesReceived:[138,a.TYPES.INTEGER],urlMessagesSent:[139,a.TYPES.INTEGER],userHasBusinessIntent:[205,a.TYPES.BOOLEAN],viaContactlessChats:[107,a.TYPES.BOOLEAN],videoCallsOffered:[76,a.TYPES.INTEGER],videoMessagesReceived:[172,a.TYPES.INTEGER],videoMessagesSent:[173,a.TYPES.INTEGER],viewOnceMessagesOpened:[18,a.TYPES.INTEGER],viewOnceMessagesReceived:[17,a.TYPES.INTEGER],viewOnceMessagesSent:[16,a.TYPES.INTEGER],voiceCallsOffered:[77,a.TYPES.INTEGER]},[1,1,1],"regular"]},{ChatMessageCounts:[]});g.ChatMessageCountsWamEvent=b}),98);
__d("WAWebChatThreadLoggingEventUploader",["Promise","WALogger","WANullthrows","WATimeUtils","WAWebABProps","WAWebBotGating","WAWebBotTypes","WAWebChatMessageCountsWamEvent","WAWebChatThreadLoggingBoolFlagFields","WAWebChatThreadLoggingCountFields","WAWebChatThreadLoggingUtils","WAWebGroupType","WAWebWamEnumChatMutedType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["uploadEvents: uploaded "," events but only deleted "," (they should be the same!)"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: error uploading events: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["ChatThreadLoggingBatchEventUploader: secret not in store!"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["ChatThreadLoggingBatchEventUploader: offset not in store!"]);l=function(){return a};return a}a=function(){function a(a,b){this.eventStore=b,this.metadataStore=a}var e=a.prototype;e.uploadEvents=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e,f=this;e=(e=a==null?void 0:a.purgeAfter)!=null?e:!0;var g=(yield this.metadataStore.getOffset());if(g==null){d("WALogger").WARN(l());return-1}a=(a=a==null?void 0:a.lastStartTs)!=null?a:d("WAWebChatThreadLoggingUtils").computeStartTs(g,d("WATimeUtils").unixTime()-d("WATimeUtils").DAY_SECONDS);if(this.secret==null){g=(yield this.metadataStore.getSecret());if(g==null){d("WALogger").WARN(k());return-1}this.secret=g}g=(yield this.eventStore.getBeforeInclusive(a));try{yield (h||(h=b("Promise"))).all(g.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebChatThreadLoggingUtils").getThreadDs(a.startTs),e=a.contactInfo,g=new(d("WAWebChatMessageCountsWamEvent").ChatMessageCountsWamEvent)({messagesSent:a.msgsSent,messagesReceived:a.msgsReceived,commentsReceived:a.commentsReceived,viewOnceMessagesSent:a.viewOnceMsgsSent,viewOnceMessagesReceived:a.viewOnceMsgsReceived,viewOnceMessagesOpened:a.viewOnceMessagesOpened,threadDs:b,threadId:yield d("WAWebChatThreadLoggingUtils").generateThreadID(c("WANullthrows")(f.secret),a.chatId,b),isAGroup:a.contactInfo.isAGroup,groupSize:e.isAGroup?e.groupSize:void 0,isAContact:e.isAGroup?void 0:e.isAContact,isArchived:a.isArchived,isPinned:a.isPinned,messagesStarred:a.messagesStarred,messagesRead:a.msgsRead,messagesUnread:a.messagesUnread,chatMuted:a.isMuted?d("WAWebWamEnumChatMutedType").CHAT_MUTED_TYPE.MUTED_NO_NOTIFICATIONS:d("WAWebWamEnumChatMutedType").CHAT_MUTED_TYPE.NOT_MUTED,callOffersSent:a.callOffersSent,callOffersReceived:a.callOffersReceived,totalCallDuration:a.totalCallDuration,typeOfGroup:a.contactInfo.groupType!=null?d("WAWebGroupType").groupTypeToWamEnum(a.contactInfo.groupType):void 0,isPnhEnabledChat:a.isPnhEnabledChat,reactionsSent:a.reactionsSent,reactionsReceived:a.reactionsReceived,isMessageYourself:a.isMessageYourself,forwardMessagesSent:a.forwardMessagesSent,forwardMessagesReceived:a.forwardMessagesReceived,editedMsgsSent:a.editedMsgsSent,totalMessageToAgentCnt:a.botMessagesSent,totalMessageFromAgentCnt:a.botMessagesReceived,totalMessageEditsFromAgentCnt:a.botMessagesEdited,isUserAgent:a.isUserAgent,hasUsername:a.hasUsername,oppositeVisibleIdentification:a.oppositeVisibleIdentification!=null?a.oppositeVisibleIdentification:void 0,chatOrigins:a.chatOrigins!=null?a.chatOrigins:void 0,eventCreationMessagesReceived:a.eventCreationMessagesReceived,eventCreationMessagesSent:a.eventCreationMessagesSent,eventResponseMessagesReceived:a.eventResponseMessagesReceived,eventResponseMessagesSent:a.eventResponseMessagesSent});d("WAWebABProps").getABPropConfigValue("dm_initiator_trigger")&&(a.ephemeralityTriggerAction!=null&&(g.ephemeralityTriggerAction=a.ephemeralityTriggerAction),a.ephemeralityInitiator!=null&&(g.ephemeralityInitiator=a.ephemeralityInitiator));d("WAWebChatThreadLoggingCountFields").COUNT_FIELD_NAMES.forEach(function(b){g[b]=a[b]});d("WAWebChatThreadLoggingBoolFlagFields").FLAG_FIELD_NAMES.forEach(function(b){g[b]=a[b]});e.isAGroup||(d("WAWebBotGating").isBizBot3pEnabled()&&(g.isUser3pBotChat=e.automatedType===d("WAWebBotTypes").BizBotAutomatedType.FULL_3P),d("WAWebBotGating").isBizBot1pEnabled()&&(g.isUser1pBizBotChat=e.automatedType===d("WAWebBotTypes").BizBotAutomatedType.PARTIAL_1P));g.commit()});return function(b){return a.apply(this,arguments)}}()))}catch(a){d("WALogger").ERROR(j(),a.toString()).sendLogs("thread-logging-upload-failure")}if(e){e=(yield this.eventStore.deleteBeforeInclusive(a));e!==g.length&&d("WALogger").ERROR(i(),g.length,e)}yield this.metadataStore.setLastUploadedStartTs(a);return g.length});function e(b){return a.apply(this,arguments)}return e}();return a}();g.ChatThreadLoggingEventUploaderImpl=a}),98);
__d("WAWebBusinessProfileTypes",["$InternalEnum"],(function(a,b,c,d,e,f){var g={UNKNOWN:0,LOW:1,HIGH:2};function a(a){if(a==null)return;switch(a){case"unknown":return g.UNKNOWN;case"low":return g.LOW;case"high":return g.HIGH;default:return g.UNKNOWN}}d=["sun","mon","tue","wed","thu","fri","sat"];e={OPEN_24H:"open_24h",SPECIFIC_HOURS:"specific_hours",APPOINTMENT_ONLY:"appointment_only"};b=b("$InternalEnum")({CATALOG:"catalog",NONE:"none",SHOP:"shop",META_CATALOG:"smb_meta_catalog"});function c(a){return a==="sun"||a==="mon"||a==="tue"||a==="wed"||a==="thu"||a==="fri"||a==="sat"}var h={limitedLiabilityPartnership:"Limited liability partnership",soleProprietorship:"Sole proprietorship",partnership:"Partnership",publicCompany:"Public Company",privateCompany:"Private Company",other:"Other"},i={WEBSITE:256,DESCRIPTION:512,EMAIL:128,ADDRESS:256};f.VERIFIED_LEVEL=g;f.convertLevel=a;f.DAYS_OF_WEEK=d;f.BUSINESS_HOUR_MODES=e;f.CommerceExperienceTypes=b;f.isBusinessHoursDayName=c;f.businessTypeOptions=h;f.BUSINESS_PROFILE_FIELDS_LENGTH=i}),66);
__d("WAWebEphemeralityTypes",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({ChangedInChat:"chat",InitiatedByMe:"me",InitiatedByOther:"other",BizUpgradeFbHosting:"biz_upgrade_fb_hosting"});c=b("$InternalEnum")({Unknown:"unknown",ChatSettings:"chat_settings",AccountSettings:"account_settings",BulkChange:"bulk_change",BizSupportFbHosting:"biz_supports_fb_hosting",UnknownGroups:"unknown_groups"});f.DisappearingModeInitiator=a;f.DisappearingModeTrigger=c}),66);
__d("WAWebInteractiveMessagesNativeFlowName",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({ORDER_DETAILS:"order_details",ORDER_STATUS:"order_status",PAYMENT_STATUS:"payment_status",PAYMENT_METHOD:"payment_method",MESSAGE_WITH_LINK:"message_with_link",MESSAGE_WITH_LINK_STATUS:"message_with_link_status",QUICK_REPLY:"quick_reply",CTA_CALL:"cta_call",CTA_URL:"cta_url",CTA_CATALOG:"cta_catalog",PAYMENT_INFO:"payment_info",CTA_COPY_CODE:"cta_copy"});c=a;f["default"]=c}),66);
__d("WAWebChatThreadLoggingUtils",["WABase64","WACryptoHmac","WAJids","WALogger","WATimeUtils","WAWebApiContact","WAWebApiParse","WAWebBusinessProfileTypes","WAWebEphemeralityTypes","WAWebInteractiveMessagesNativeFlowName","WAWebLidAwareContactsDB","WAWebModelStorageUtils","WAWebMsgType","WAWebQueryBusinessProfile","WAWebUserPrefsMeUser","WAWebWamEnumChatOriginsType","WAWebWamEnumEphemeralityInitiatorType","WAWebWamEnumEphemeralityTriggerActionType","WAWebWamEnumOppositeVisibleIdentificationType","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["getChatOriginType: could not find chat with id ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["getOppositeVisibleIdentificationType: could not find contact with id ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["getMeHasUsername: could not find contact with id ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["getMeHasUsername: wid is not a valid user ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(['Thread Logging: Failed to query business profile to set "biz_catalog_type"']);l=function(){return a};return a}var m=new TextEncoder(),n=function(a){return m.encode(a).buffer};function o(a,b){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("WACryptoHmac").hmacSha256(a,b));return d("WABase64").encodeB64(a)});return p.apply(this,arguments)}function a(a,b,c){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=n(b+c);return o(a,b)});return q.apply(this,arguments)}function e(a,b){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=n(b);return o(a,b)});return r.apply(this,arguments)}function f(a){return d("WATimeUtils").toDate(d("WATimeUtils").castToUnixTime(a-8*d("WATimeUtils").HOUR_SECONDS)).toISOString().split("T")[0].replace(/-/g,"/")}function s(a,b){var c=b%d("WATimeUtils").DAY_SECONDS;b=b-c;return c>=a?b+a:b-d("WATimeUtils").DAY_SECONDS+a}function t(a,b,c){return s(a,b)>c}function u(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;try{b=(yield d("WAWebQueryBusinessProfile").queryBusinessProfile([{wid:a}]))}catch(a){d("WALogger").ERROR(l()).verbose().devConsole(a).sendLogs("query-business-profile-fail");return null}a=b[0];if(!a)return null;a=(a=a.profile)==null?void 0:(a=a.profile_options)==null?void 0:a.commerce_experience;if(a===d("WAWebBusinessProfileTypes").CommerceExperienceTypes.CATALOG)return"native";else if(a===d("WAWebBusinessProfileTypes").CommerceExperienceTypes.SHOP)return"shop";return null});return v.apply(this,arguments)}function w(a){return[d("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT].includes(a.type)?!1:!0}function x(a){var b=new Set([d("WAWebMsgType").MSG_TYPE.PRODUCT,d("WAWebMsgType").MSG_TYPE.ORDER,d("WAWebMsgType").MSG_TYPE.LIST]);return b.has(a.type)||b.has((b=a.quotedMsg)==null?void 0:b.type)||!!(a.matchedText!=null&&a.matchedText!==""&&y(a.matchedText))||a.type===d("WAWebMsgType").MSG_TYPE.NATIVE_FLOW&&(a.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS||a.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS)}function y(a){return d("WAWebApiParse").matchCatalogUrl(a)||d("WAWebApiParse").matchProductUrl(a)}function z(a){if(a==null)return null;switch(a){case d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.ACCOUNT_SETTINGS;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.CHAT_SETTINGS;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.BulkChange:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.BULK_CHANGE;default:return null}}function A(a){if(a==null)return null;switch(a){case d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.ACCOUNT_SETTINGS;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.CHAT_SETTINGS;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.BulkChange:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.BULK_CHANGE;default:return null}}function B(a){if(a==null)return null;return a?d("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE.INITIATED_BY_ME:d("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE.INITIATED_BY_OTHER}function C(){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=d("WAWebUserPrefsMeUser").getMeUser();if(!a.isUser()){d("WALogger").ERROR(k(),a);return!1}var b=!1,e=(yield c("WAWebLidAwareContactsDB").get(a.toJid().toString()));(e==null?void 0:e.username)!=null&&e.username!==""&&(b=!0);if(!a.isLid()){e=d("WAWebApiContact").getCurrentLid(a);if(e){e=(yield c("WAWebLidAwareContactsDB").get(e.toString()));(e==null?void 0:e.username)!=null&&e.username!==""&&(b=!0)}return b}d("WALogger").ERROR(j(),a);return b});return D.apply(this,arguments)}function E(a){return F.apply(this,arguments)}function F(){F=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return J(a)?null:d("WAWebModelStorageUtils").getStorage().lock(["contact"],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b,e;if(a.isLid()){var f=d("WAWebApiContact").getPhoneNumber(d("WAWebWidFactory").toUserWid(a));f==null?(b=a.toString(),e="lid"):(b=d("WAJids").toPhoneUserJid(f.user.toString()),e="pn")}else b=d("WAJids").toPhoneUserJid(a.user.toString()),e="pn";f=(yield c("WAWebLidAwareContactsDB").get(b));if(f==null){d("WALogger").ERROR(i(),a);return null}return G(f,e)}))});return F.apply(this,arguments)}function G(a,b){if(a==null)return d("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE.PLACEHOLDER;var c=d("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE.MASKED_PHONE_NUMBER;a==null?c=d("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE.PLACEHOLDER:a.isAddressBookContact?c=d("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE.SAVED_CONTACT_NAME:a.verifiedName?c=d("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE.VERIFIED_BUSINESS_NAME:b==="pn"?c=d("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE.PHONE_NUMBER:a.username!=null&&a.username!==""&&(c=d("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE.USERNAME);return c}function H(a){return I.apply(this,arguments)}function I(){I=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return J(a)?null:d("WAWebModelStorageUtils").getStorage().lock(["chat"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var c=a.toString();b=(yield b.get(c));if(b==null){d("WALogger").ERROR(h(),c);return}switch(b.lidOriginType){case"ctwa":return d("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.LID_CTWA;case"username":return d("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.LID_USERNAME;default:return d("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.OTHERS}});return function(a){return c.apply(this,arguments)}}())});return I.apply(this,arguments)}function J(a){return!a.isUser()||a.isPSA()||a.isBot()}g.generateThreadID=a;g.generateThreadIDHMAC=e;g.getThreadDs=f;g.computeStartTs=s;g.shouldUpdateChatEvent=t;g.getBizCatalogType=u;g.shouldIncrementMsgSendAndReceive=w;g.isCommerceMessage=x;g.getWamDisappearingModeTrigger=z;g.getWamDisappearingModeTriggerGroups=A;g.getWamDisappearingModeInitiatedByMe=B;g.getMeHasUsername=C;g.getOppositeVisibleIdentification=E;g.getOppositeVisibleIdentificationType=G;g.getChatOriginType=H}),98);
__d("WAWebDBMarkAsReadForTable",["WAWebModelStorageUtils","WAWebMsgKey","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,e){return d("WAWebModelStorageUtils").getStorage().lock([a],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.anyOf(["msgKey"],e));b.length!==0&&(yield a.bulkCreateOrReplace(b.map(function(a){return babelHelpers["extends"]({},a,{read:!0})})));return b.map(function(a){a=a.msgKey;return c("WAWebMsgKey").from(a)})});return function(b){return a.apply(this,arguments)}}())}g.markAsReadForTable=a}),98);
__d("WAWebDBUpdateAddOnAcksForTable",["WANullthrows","WAWebModelStorageUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,e,f){return d("WAWebModelStorageUtils").getStorage().lock([a],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=[],d=new Map();for(var g of e){var h=g.msgKey.toString();b.push(h);d.set(g.msgKey.toString(),g)}h=(yield a.anyOf(["msgKey"],b,{shouldDecrypt:!1}));g=[];b=[];for(h of h){var i=c("WANullthrows")(d.get(h.msgKey));if(!f(h,i))continue;var j=babelHelpers["extends"]({},h,{ack:i.ack});g.push(j);b.push(i)}yield a.bulkCreateOrReplace_ALREADY_ENCRYPTED_RECORDS_ONLY(g);return b});return function(b){return a.apply(this,arguments)}}())}g.updateAddOnAcksForTable=a}),98);
__d("WAWebMessageAddOnType",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({Reaction:"reaction",ReactionEnc:"reaction_enc",PollVote:"poll_vote",KeepInChat:"keep_in_chat",MessageEdit:"message_edit",PinMessage:"pin_message",Comment:"comment",Unknown:"unknown"});f.MessageAddOnType=a}),66);
__d("WAWebDBCommentAddOnProvider",["Promise","WAWebDBMarkAsReadForTable","WAWebDBUpdateAddOnAcksForTable","WAWebMessageAddOnType","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;a={type:d("WAWebMessageAddOnType").MessageAddOnType.Comment,matches:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.COMMENT},matchesFutureproof:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType===d("WAWebMsgType").MSG_TYPE.COMMENT},canRenderInUi:function(){return!0},processOrphansForNewMsg:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){return(h||(h=b("Promise"))).resolve()});function c(b,c){return a.apply(this,arguments)}return c}(),updateAcks:function(a,b){return d("WAWebDBUpdateAddOnAcksForTable").updateAddOnAcksForTable("comments",a,b)},markAsRead:function(a){return d("WAWebDBMarkAsReadForTable").markAsReadForTable("comments",a.map(String))}};g.commentsAddOnProvider=a}),98);
__d("WAWebDBReactionsAddOnProvider",["WAWebDBMarkAsReadForTable","WAWebDBUpdateAddOnAcksForTable","WAWebMessageAddOnType","WAWebMsgType","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){a={type:d("WAWebMessageAddOnType").MessageAddOnType.Reaction,matches:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.REACTION},matchesFutureproof:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType===d("WAWebMsgType").MSG_TYPE.REACTION},canRenderInUi:function(){return!0},processOrphansForNewMsg:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw c("err")("Reactions not yet integrated into orphan framework")});function d(){return a.apply(this,arguments)}return d}(),updateAcks:function(a,b){return d("WAWebDBUpdateAddOnAcksForTable").updateAddOnAcksForTable("reactions",a,b)},markAsRead:function(a){return d("WAWebDBMarkAsReadForTable").markAsReadForTable("reactions",a.map(String))}};g.reactionsAddOnProvider=a}),98);
__d("WAWebDBReactionsEncAddOnProvider",["WAWebMessageAddOnType","WAWebMsgType","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){a={type:d("WAWebMessageAddOnType").MessageAddOnType.ReactionEnc,matches:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.REACTION_ENC},matchesFutureproof:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.type===d("WAWebMsgType").MSG_TYPE.REACTION_ENC},canRenderInUi:function(){return!0},processOrphansForNewMsg:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw c("err")("Reactions provider is deprecated")});function d(){return a.apply(this,arguments)}return d}()};g.reactionsEncAddOnProvider=a}),98);
__d("WAWebDBAddOnProviders",["WAWebDBCommentAddOnProvider","WAWebDBKeepInChatAddOnProvider","WAWebDBMessageEditAddOnProvider","WAWebDBPinInChatAddOnProvider","WAWebDBPollVotesAddOnProvider","WAWebDBReactionsAddOnProvider","WAWebDBReactionsEncAddOnProvider"],(function(a,b,c,d,e,f,g){var h=[d("WAWebDBPollVotesAddOnProvider").pollVotesAddOnProvider,d("WAWebDBKeepInChatAddOnProvider").keepInChatAddOnProvider,d("WAWebDBReactionsAddOnProvider").reactionsAddOnProvider,d("WAWebDBReactionsEncAddOnProvider").reactionsEncAddOnProvider,d("WAWebDBMessageEditAddOnProvider").messageEditAddOnProvider,d("WAWebDBPinInChatAddOnProvider").pinInChatAddOnProvider,d("WAWebDBCommentAddOnProvider").commentsAddOnProvider];function a(a){var b;return(b=h.find(function(b){return b.type===a}))!=null?b:null}function b(a){return h.find(function(b){return b.matches(a)})}function c(a){return h.find(function(b){return b.matchesFutureproof(a)})}g.addOnProviders=h;g.getProviderForAddOnType=a;g.getAddOnProviderForMsg=b;g.getAddOnProviderForFutureproofMsg=c}),98);
__d("WAWebMsgDataFromModel",[],(function(a,b,c,d,e,f){function g(a){a=a.toJSON();return babelHelpers["extends"]({},a,{paymentNoteMsg:a.paymentNoteMsg?g(a.paymentNoteMsg):void 0})}f.msgDataFromMsgModel=g}),66);
__d("WAWebDBKeepInChatAddOnProvider",["WALogger","WAWebBackendApi","WAWebEphemeralKeepInChatUtils","WAWebMessageAddOnType","WAWebMsgDataFromModel","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["keepInChatAddOnProvider: found orphan"]);h=function(){return a};return a}a={type:d("WAWebMessageAddOnType").MessageAddOnType.KeepInChat,matches:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT},matchesFutureproof:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType===d("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT},canRenderInUi:function(){return!0},processOrphansForNewMsg:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=b.map(function(a){return a.parsedMsgPayload});b=d("WAWebEphemeralKeepInChatUtils").runKeepInChatTieBreaker(a);d("WALogger").LOG(h()).devConsole({winningOrphanMsg:b});if(b!=null){a=d("WAWebMsgDataFromModel").msgDataFromMsgModel(b);yield d("WAWebBackendApi").frontendSendAndReceive("processKeepInChatMessage",{keepInChatMessage:a,allowNotification:!1})}});function c(b,c){return a.apply(this,arguments)}return c}()};g.keepInChatAddOnProvider=a}),98);
__d("WAWebDBMapOrphansToProviders",["WAWebDBAddOnProviders"],(function(a,b,c,d,e,f,g){function a(a){var b=new Map();for(var c=0;c<a.length;c++){var e,f=a[c],g=d("WAWebDBAddOnProviders").getProviderForAddOnType(f.type);if(!g)continue;e=(e=b.get(g))!=null?e:[];e.push(f);b.set(g,e)}return b}g.mapOrphansToProviders=a}),98);
__d("WAWebMessageEditGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("message_edit_receive")||h()}function h(){return d("WAWebABProps").getABPropConfigValue("message_edit_send")}function b(){return d("WAWebABProps").getABPropConfigValue("caption_edit_receive")||i()}function i(){return d("WAWebABProps").getABPropConfigValue("caption_edit_send")}function c(){return d("WAWebABProps").getABPropConfigValue("web_message_edit_processing_reply_messages")}function e(){return d("WAWebABProps").getABPropConfigValue("cag_message_edit_send")}function f(){return d("WAWebABProps").getABPropConfigValue("cag_message_edit_receive")}g.receiveTextEditEnabled=a;g.sendTextEditEnabled=h;g.receiveCaptionEditEnabled=b;g.sendCaptionEditEnabled=i;g.processReplyMessagesEnabled=c;g.sendCagMsgEditEnabled=e;g.receiveCagMsgEditEnabled=f}),98);
__d("WAWebMessageEditUtils",["$InternalEnum","WATimeUtils","WAWebABProps","WAWebMsgType","WAWebWid"],(function(a,b,c,d,e,f,g){var h=30*24*60*60;function i(a){if(a)return h;a=d("WAWebABProps").getABPropConfigValue("message_edit_window_duration_seconds");return a==null||a<=0?20*60:a}function j(a){if(a)return h;a=d("WAWebABProps").getABPropConfigValue("message_edit_client_entry_point_limit_seconds");return a==null||a<=0?15*60:a}var k=b("$InternalEnum").Mirrored(["TextEdit","CaptionEdit","EventEdit"]);function a(a){switch(a){case d("WAWebMsgType").MSG_TYPE.CHAT:return k.TextEdit;case d("WAWebMsgType").MSG_TYPE.IMAGE:case d("WAWebMsgType").MSG_TYPE.VIDEO:case d("WAWebMsgType").MSG_TYPE.DOCUMENT:return k.CaptionEdit;case d("WAWebMsgType").MSG_TYPE.EVENT_CREATION:return k.EventEdit;default:return null}}var l=[(b=d("WAWebMsgType")).MSG_TYPE.CHAT,b.MSG_TYPE.IMAGE,b.MSG_TYPE.VIDEO,b.MSG_TYPE.DOCUMENT,b.MSG_TYPE.EVENT_CREATION];function e(a){return l.includes(a)?!0:!1}function f(a){var b=a.parentTsInSeconds,e=a.editTsInSeconds;a=a.msgKey;a=c("WAWebWid").isNewsletter(a.remote);return e!=null?e<b+i(a):d("WATimeUtils").unixTime()<b+i(a)}function m(a){var b=a.parentTsInSeconds;a=a.msgKey;return d("WATimeUtils").unixTime()<b+j(c("WAWebWid").isNewsletter(a.remote))}g.getMessageEditProcessingWindowDurationSeconds=i;g.MsgEditType=k;g.getMsgEditType=a;g.msgTypeSupportsEditing=e;g.isParentWithinEditProcessingWindow=f;g.isParentWithinEditUIWindow=m}),98);
__d("WAWebDBMessageEditAddOnProvider",["WAWebDBProcessEditProtocolMsgs","WAWebMessageAddOnType","WAWebMessageEditGatingUtils","WAWebMessageEditUtils","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){a={type:d("WAWebMessageAddOnType").MessageAddOnType.MessageEdit,matches:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&a.subtype==="message_edit"},matchesFutureproof:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&a.futureproofSubtype==="message_edit"},canRenderInUi:function(a){a=a.editMsgType?d("WAWebMessageEditUtils").getMsgEditType(a.editMsgType):d("WAWebMessageEditUtils").MsgEditType.TextEdit;if(!a)return!1;switch(a){case d("WAWebMessageEditUtils").MsgEditType.TextEdit:return d("WAWebMessageEditGatingUtils").receiveTextEditEnabled();case d("WAWebMessageEditUtils").MsgEditType.CaptionEdit:return d("WAWebMessageEditGatingUtils").receiveCaptionEditEnabled();case d("WAWebMessageEditUtils").MsgEditType.EventEdit:return!1}},processOrphansForNewMsg:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("WAWebDBProcessEditProtocolMsgs").processEditProtocolMsgs(b.map(function(a){return a.parsedMsgPayload})));b=(b=b.find(function(b){return b.parentMsg.id.equals(a.id)}))==null?void 0:b.editedMsgData;b&&Object.assign(a,b)});function c(b,c){return a.apply(this,arguments)}return c}()};g.messageEditAddOnProvider=a}),98);
__d("WAWebPinMsgGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("pinned_messages_m1_receiver")}function b(){return d("WAWebABProps").getABPropConfigValue("pinned_messages_m1_sender")}function h(){return d("WAWebABProps").getABPropConfigValue("pinned_messages_m2")}function c(){return h()?d("WAWebABProps").getABPropConfigValue("pinned_messages_m2_pin_max"):1}g.isPinnedMessagesM1ReceiverEnabled=a;g.isPinnedMessagesM1SenderEnabled=b;g.isPinnedMessagesM2Enabled=h;g.getMaxPins=c}),98);
__d("WAWebDBPinInChatAddOnProvider",["WAWebDBUpdateAddOnAcksForTable","WAWebMessageAddOnType","WAWebMsgType","WAWebPinMessageProcessor","WAWebPinMsgGatingUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){a={type:d("WAWebMessageAddOnType").MessageAddOnType.PinMessage,matches:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE},matchesFutureproof:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType===d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE},canRenderInUi:function(){return d("WAWebPinMsgGatingUtils").isPinnedMessagesM1ReceiverEnabled()},processOrphansForNewMsg:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b.map(function(a){return a.parsedMsgPayload});yield d("WAWebPinMessageProcessor").processPinMessages(a.id.remote,b)});function c(b,c){return a.apply(this,arguments)}return c}(),updateAcks:function(a,b){return d("WAWebDBUpdateAddOnAcksForTable").updateAddOnAcksForTable("pinned-messages",a,b)}};g.pinInChatAddOnProvider=a}),98);
__d("WAWebDBPollVotesAddOnProvider",["WAWebDBMarkAsReadForTable","WAWebDBProcessPollUpdateMsgs","WAWebDBUpdateAddOnAcksForTable","WAWebMessageAddOnType","WAWebMsgType","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){a={type:d("WAWebMessageAddOnType").MessageAddOnType.PollVote,matches:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.POLL_UPDATE&&a.subtype==="poll_vote"},matchesFutureproof:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType===d("WAWebMsgType").MSG_TYPE.POLL_UPDATE},canRenderInUi:function(){return!0},processOrphansForNewMsg:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=new Map();for(a of b)e.set(a.msgKey,a);a=(yield d("WAWebDBProcessPollUpdateMsgs").processPollUpdateMsgs(b.map(function(a){a=a.parsedMsgPayload;if(a.type===d("WAWebMsgType").MSG_TYPE.POLL_UPDATE&&a.addonEncrypted)return a;throw c("err")("Invalid poll vote orphan type")})));return a.map(function(a){var b;b=a.read||((b=(b=e.get(a.msgKey.toString()))==null?void 0:b.read)!=null?b:!1);return a.read===b?a:babelHelpers["extends"]({},a,{read:b})})});function e(b,c){return a.apply(this,arguments)}return e}(),updateAcks:function(a,b){return d("WAWebDBUpdateAddOnAcksForTable").updateAddOnAcksForTable("poll-votes",a,b)},markAsRead:function(a){return d("WAWebDBMarkAsReadForTable").markAsReadForTable("poll-votes",a.map(String))}};g.pollVotesAddOnProvider=a}),98);
__d("WAWebDBOrphanDbSerialization",["WAWebDBMessageSerialization","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){return babelHelpers["extends"]({},a,{sender:a.sender==null?null:d("WAWebWidFactory").createUserWid(a.sender),parsedMsgPayload:d("WAWebDBMessageSerialization").messageFromDbRow(a.parsedMsgPayload)})}g.orphanFromDbRow=a}),98);
__d("WAWebDBGetByParentMsgKey",["WAWebDBOrphanDbSerialization","WAWebSchemaMessageOrphans"],(function(a,b,c,d,e,f,g){function a(a){return h([a])}function h(a){return d("WAWebSchemaMessageOrphans").getMessageOrphanTable().anyOf(["parentMsgKey"],a.map(String)).then(function(a){return a.filter(Boolean).map(d("WAWebDBOrphanDbSerialization").orphanFromDbRow)})}g.getMessageOrphansByParentMsgKey=a;g.bulkGetMessageOrphansByParentMsgKey=h}),98);
__d("WAWebDBProcessOrphansForNewMsg",["Promise","WALogger","WAWebAddonProcessMsgsUtils","WAWebDBGetByParentMsgKey","WAWebDBMapOrphansToProviders","WAWebDBProcessReactionsMsgs","WAWebLidMigrationUtils","WAWebSchemaMessageOrphans","WAWebStoreMsgs","asyncToGeneratorRuntime","lodash"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["processOrphansForNewMsg: found orphans"]);i=function(){return a};return a}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=d("WAWebLidMigrationUtils").getAlternateMsgKey(a.id);e=(yield d("WAWebDBGetByParentMsgKey").bulkGetMessageOrphansByParentMsgKey([a.id,e].filter(Boolean)));e.length&&d("WALogger").LOG(i()).devConsole({orphans:e});e=d("WAWebAddonProcessMsgsUtils").sortAddonOrphans(e);var f=e.unifiedAddons,g=e.otherOrphans;e=e.legacyReactionAddons;g=(yield d("WAWebDBMapOrphansToProviders").mapOrphansToProviders(g));var j=[d("WAWebStoreMsgs").storeMsgs(f),d("WAWebDBProcessReactionsMsgs").processReactionMsgs(e)];for(var k of g.entries()){var l=k[0],m=k[1];j.push(l.processOrphansForNewMsg(a,m))}yield (h||(h=b("Promise"))).all(j);l=c("lodash").flatten(Array.from(g.values())).map(function(a){return a.msgKey});l=l.concat(f.map(function(a){return a.id.toString()}));e.length&&(l=l.concat(e.map(function(a){return a.id.toString()})));yield d("WAWebSchemaMessageOrphans").getMessageOrphanTable().bulkRemove(l)});return j.apply(this,arguments)}g.processOrphansForNewMsg=a}),98);
__d("WAWebDBUpdateLastAddOnPreviewChat",["WAWebApiChat"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebApiChat").bulkUpdateChatLastAddOnPreview(a)}g.updateDatabaseForLastAddOnPreview=a}),98);
__d("WAWebDBCreateLidPnMappings",["Promise","WALogger","WATimeUtils","WAWebApiContact","WAWebBackendApi","WAWebContactsDbLidMigrationUtils","WAWebIdentityChangeApi","WAWebSchemaContact_DEPRECATED","WAWebSingleSignalSession","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["getPnRowData failed! ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["createLidPnMappings: "," identity change notifications generated"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["lidPnCacheDirtySet: "," flushed"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["flush lidPnCacheDirtySet: get dirty updates for ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["flushLidPnMappingsToDb failed!"]);m=function(){return a};return a}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.mappings,e=a.flushImmediately;a=a.identityChangeHandlingEnabled;var f=(a=a)!=null?a:!0;d("WAWebBackendApi").frontendFireAndForget("bulkUpdatePhoneNumberJids",{lidPhoneNumberMappings:c.map(function(a){var b=a.lid;a=a.pn;return{lid:b.toString(),phoneNumber:a.toString()}})});var g=[],i=new Map(c.map(function(a){return[a.pn,a.lid]})),m=d("WATimeUtils").unixTime(),n=[];c.forEach(function(a){var b=a.lid,c=d("WAWebApiContact").lidPnCache.getPhoneNumber(b),h=c!=null?d("WAWebApiContact").lidPnCache.getCurrentLid(c):null;if(c==null||h!=null&&!h.equals(a.lid)){c=i.get(a.pn)===b?m:d("WATimeUtils").castToUnixTime(0);d("WAWebApiContact").lidPnCache.getCurrentLid(a.pn)!=null&&d("WAWebSingleSignalSession").isUsingAccountIdentifierForSignalStorage()&&f&&n.push(d("WAWebIdentityChangeApi").handleNewIdentity(a.pn,!e));d("WAWebApiContact").lidPnCache.add(b,{lid:b,phoneNumber:a.pn,phoneNumberCreatedAt:c});e?g.push(babelHelpers["extends"]({},a,{phoneNumberCreatedAt:c})):d("WAWebApiContact").lidPnCacheDirtySet.add(b.toString())}});if(e&&d("WAWebApiContact").lidPnCacheDirtySet.size>0){d("WALogger").LOG(l(),Array.from((a=d("WAWebApiContact")).lidPnCacheDirtySet).join(","));a.lidPnCacheDirtySet.forEach(function(a){a=d("WAWebWidFactory").createUserWid(a);var b=d("WAWebApiContact").lidPnCache.getLidEntry(a);b!=null&&g.push({lid:a,pn:d("WAWebWidFactory").toUserWid(b.phoneNumber),phoneNumberCreatedAt:d("WATimeUtils").castToUnixTime(b.phoneNumberCreatedAt)})});d("WALogger").LOG(k(),a.lidPnCacheDirtySet.size);a.lidPnCacheDirtySet.clear()}c=(h||(h=b("Promise"))).all(n).then(function(a){var b=0;for(a of a){var c;b+=(c=a==null?void 0:(c=a.notifications)==null?void 0:c.length)!=null?c:0}d("WALogger").LOG(j(),b)});if(g.length===0)return c;var o=(yield p(g.map(function(a){a=a.pn;return a.toJid()})));a=g.map(function(a){var b=a.lid,c=a.pn;a=a.phoneNumberCreatedAt;var e=o.get(c.toJid());return babelHelpers["extends"]({id:b.toString(),phoneNumber:c.toString(),phoneNumberCreatedAt:a},e?d("WAWebContactsDbLidMigrationUtils").createContactLidRowFromPnRow(b.toString(),e):null)});return h.all([c,d("WAWebSchemaContact_DEPRECATED").getContactTable().bulkCreateOrMerge(a)])});return o.apply(this,arguments)}function p(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{a=(yield d("WAWebSchemaContact_DEPRECATED").getContactTable().bulkGet(a));return new Map(a==null?void 0:a.map(function(a){return[(a==null?void 0:a.id)||"",a]}))}catch(a){d("WALogger").ERROR(i(),a.stack).sendLogs("getPnRowData failed while creating new pn-lid mapping")}return new Map()});return q.apply(this,arguments)}function a(){return n({mappings:[],flushImmediately:!0})["catch"](function(a){d("WALogger").ERROR(m()).devConsole(a).sendLogs("Failed to flushLidPnMappingsToDb")})}g.createLidPnMappings=n;g.flushLidPnMappingsToDb=a}),98);
__d("WAWebDBCommunityTypes",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["SubGroupLink","SiblingGroupLink","SubGroupUnlink","SiblingGroupUnlink"]);f.CommunityLinkOperation=a}),66);
__d("WAWebDBCommunity",["Promise","WABatcher","WALogger","WAWebDBCommunityTypes","WAWebGroupsParticipantsApi","WAWebSchemaChat","WAWebSchemaGroupMetadata","WAWebSchemaUnjoinedSubgroupMetadata","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["bulkPersistCommunityLink"]);i=function(){return a};return a}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").DEV(i()).devConsole(a);var c=new Map(),e=new Map();a.forEach(function(a){a.subgroups.forEach(function(a){e.set(String(a.id),null)});switch(a.action){case d("WAWebDBCommunityTypes").CommunityLinkOperation.SiblingGroupLink:case d("WAWebDBCommunityTypes").CommunityLinkOperation.SiblingGroupUnlink:c.set(String(a.chatId),null);break;default:return}});(yield d("WAWebSchemaGroupMetadata").getGroupMetadataTable().bulkGet(Array.from(c.keys()))).forEach(function(a){a&&a.parentGroup!=null&&c.set(a.id,String(a.parentGroup))});(yield d("WAWebSchemaChat").getChatTable().bulkGet(Array.from(e.keys()))).forEach(function(a){a&&e.set(a.id,a)});var f=new Map(),g=new Map(),j=new Set(),k=function(a,b,c){b.forEach(function(b){var d=String(b.id),h=e.get(d);if(h!=null&&!h.isReadOnly)f.set(d,{id:d,parentGroup:c?a:void 0});else if(c){j["delete"](d);b={id:d,subject:b.subject,subjectTime:(h=b.subjectTime)!=null?h:0,parentGroup:a};h=g.get(d);h&&h.subjectTime>b.subjectTime&&(b.subject=h.subject,b.subjectTime=h.subjectTime);g.set(d,b)}else g["delete"](d),j.add(d)})};a.forEach(function(a){var b=null,e=!1;switch(a.action){case d("WAWebDBCommunityTypes").CommunityLinkOperation.SiblingGroupLink:b=c.get(String(a.chatId));e=!0;break;case d("WAWebDBCommunityTypes").CommunityLinkOperation.SiblingGroupUnlink:b=c.get(String(a.chatId));e=!1;break;case d("WAWebDBCommunityTypes").CommunityLinkOperation.SubGroupLink:b=String(a.chatId);e=!0;break;case d("WAWebDBCommunityTypes").CommunityLinkOperation.SubGroupUnlink:b=String(a.chatId),e=!1}b!=null&&k(b,a.subgroups,e)});yield (h||(h=b("Promise"))).all([d("WAWebSchemaGroupMetadata").getGroupMetadataTable().bulkCreateOrMerge(Array.from(f.values())),d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().bulkRemove(Array.from(j)),d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().bulkGet(Array.from(g.keys())).then(function(a){a.forEach(function(a){if(!a)return;var b=g.get(a.id);if(!b)return;a.subjectTime!=null&&a.subjectTime>b.subjectTime&&(b.subjectTime=a.subjectTime,b.subject=a.subject)});return d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().bulkCreateOrMerge(Array.from(g.values()).map(function(a){return babelHelpers["extends"]({},a)}))})])});return k.apply(this,arguments)}var l=function(){var a=5e3;return d("WABatcher").batch({delayMs:a},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield j(a);return(h||(h=b("Promise"))).resolve(a.map(function(a){return void 0}))});return function(b){return a.apply(this,arguments)}}())}();function a(a,b,c,d){d===void 0&&(d=!1);a={chatId:a,subgroups:b,action:c};return d?l(a):j([a])}function m(a){return d("WAWebSchemaGroupMetadata").getGroupMetadataTable().equals(["parentGroup"],a.toString())}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return(yield m(a)).find(function(a){return a.defaultSubgroup===!0})});return o.apply(this,arguments)}function c(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield n(a));return a==null?null:d("WAWebWidFactory").createWid(a.id)});return p.apply(this,arguments)}function q(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield m(a));a=(yield d("WAWebGroupsParticipantsApi").bulkCheckMyMembership(b.map(function(a){a=a.id;return d("WAWebWidFactory").createWid(a)}))).map(function(a,c){return[b[c],a]});return a.filter(function(a){a=a[1];return a}).map(function(a){a=a[0];return a})});return r.apply(this,arguments)}function s(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return(yield q(a)).map(function(a){a=a.id;return d("WAWebWidFactory").createWid(a)})});return t.apply(this,arguments)}function e(a){return d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().equals(["parentGroup"],a.toString())}function f(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.parentGroup;if(b==null)return!1;a=d("WAWebWidFactory").createWid(a.id);b=(yield s(d("WAWebWidFactory").createWid(b)));return b.length===1&&b[0].equals(a)});return u.apply(this,arguments)}g.persistCommunityLink=a;g.getDefaultSubgroup=c;g.getJoinedSubgroupsMetadata=q;g.getJoinedSubgroups=s;g.getUnjoinedSubgroupsMetadata=e;g.isLastJoinedSubgroup=f}),98);
__d("WAWebApiGroupInviteV4Store",["WATimeUtils","WAWebSchemaGroupInviteV4","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return d("WAWebSchemaGroupInviteV4").getGroupInviteV4Table().createOrMerge(a,b)}function c(a){return d("WAWebSchemaGroupInviteV4").getGroupInviteV4Table().bulkCreateOrMerge(a)}function e(a,b,c,d){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){a=(yield d("WAWebSchemaGroupInviteV4").getGroupInviteV4Table().equals(["from","to","groupId"],[a,b,c]).then(function(a){return a.filter(function(a){return!a.expired&&a.expiration<=e})}));d("WAWebSchemaGroupInviteV4").getGroupInviteV4Table().bulkCreateOrReplace(a.map(function(a){return babelHelpers["extends"]({},a,{expired:!0})}));return a});return h.apply(this,arguments)}function f(a){var b;b=(b=d("WAWebUserPrefsMeUser").getMaybeMeUser())==null?void 0:b.toString();return d("WAWebSchemaGroupInviteV4").getGroupInviteV4Table().equals(["from","groupId"],[b,a.toString()]).then(function(a){return a.filter(function(a){return!a.expired&&d("WATimeUtils").unixTime()<=a.expiration})}).then(function(a){return a.map(function(a){return a.to})})}g.persistGroupInviteV4Msg=a;g.persistGroupInviteV4Msgs=c;g.revokeGroupInvites=e;g.getPendingParticipants=f}),98);
__d("WAWebDBRevokeInviteV4",["WAWebApiGroupInviteV4Store","WAWebBackendApi","WAWebDBMsgUtils","WAWebDBProcessMessage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b,c,d){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){a=(yield d("WAWebApiGroupInviteV4Store").revokeGroupInvites(a,b,c,e));b=(a==null?void 0:a.map(function(a){return a.id}))||[];c=(yield d("WAWebDBMsgUtils").getMsgsByMsgKey(b,function(a){a.inviteCodeExp="0"}));for(e of c)d("WAWebBackendApi").frontendFireAndForget("expireGroupInviteV4",{inviteMsgId:e.id}),d("WAWebDBProcessMessage").updateExistingMessages([e],e.id.remote)});return h.apply(this,arguments)}g.revokeGroupInviteV4=a}),98);
__d("WAWebDBStoreMessageOrphans",["WALogger","WAWebDBAddOnProviders","WAWebDBMessageSerialization","WAWebMessageAddOnType","WAWebMsgGetters","WAWebSchemaMessageOrphans","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["storeMessageOrphans:"]);h=function(){return a};return a}function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){d("WALogger").LOG(h()).devConsole({msgs:a});a=a.map(function(a){var c;return{msgKey:a.id.toString(),parentMsgKey:b(a).toString(),sender:d("WAWebMsgGetters").getSender(a).toString(),parsedMsgPayload:d("WAWebDBMessageSerialization").dbRowFromMessage(babelHelpers["extends"]({},a)),type:(c=(c=d("WAWebDBAddOnProviders").addOnProviders.find(function(b){return b.matches(a)}))==null?void 0:c.type)!=null?c:d("WAWebMessageAddOnType").MessageAddOnType.Unknown,senderTimestampMs:a.senderTimestampMs,t:a.t}});yield d("WAWebSchemaMessageOrphans").getMessageOrphanTable().bulkCreateOrReplace(a)});return i.apply(this,arguments)}g.storeMessageOrphans=a}),98);
__d("WAWebLid1X1MigrationGating",["$InternalEnum","WAWebABProps","WAWebUserPrefsIndexedDBStorage"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({DEFAULT:0,PN_JID:1,LID_JID:2});c=function(){function a(){}var b=a.prototype;b.isLidMigrated=function(){return d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WAIsAccountLidFieldMigrated")===!0};b.setIsLidMigrated=function(a){return d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set("WAIsAccountLidFieldMigrated",a)};b.shouldApplyNonMigratedMessagingRules=function(){return d("WAWebABProps").getABPropConfigValue("lid_one_on_one_pre_migration_mat_enabled")===!0};b.isSyncdSessionMigrated=function(){return!1};return a}();e=new c();g.OutgoingStanzaMigrationStatus=a;g.Lid1X1MigrationUtils=e}),98);
__d("WAWebPnhGatingUtils",[],(function(a,b,c,d,e,f){function a(){return!1}f.isMatFullyEnabled=a}),66);
__d("WAWebDBBulkGetRootMsgs",["WALogger","WAWebApiChat","WAWebApiContact","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebMsgKey","WAWebPnhGatingUtils","WAWebSchemaChat","WAWebSchemaMessage","WAWebWidFactory","asyncToGeneratorRuntime","nullthrows"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["bulkGetRootMsgs: missing original idx for msgkey"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["_bulkGetRootMsgsByAccountLid: no chat record found for accountLid"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["_bulkGetRootMsgsByAccountLid: couldn't find lid for PN"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["_bulkGetRootMsgsByAccountLid: missing mapping for PN remote"]);k=function(){return a};return a}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=a;d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&(c=(yield r(a)));a=(yield p(c,b));a.some(function(a){return a==null})&&d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.shouldApplyNonMigratedMessagingRules()&&(yield n(c,a));return a});return m.apply(this,arguments)}function n(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var d=a.map(function(a){return c("WAWebMsgKey").fromString(a)}),e=new Map(),f=[];for(var g=0;g<b.length;g++)b[g]==null&&d[g].remote.isLid()&&(e.set(a[g],g),f.push(d[g]));if(f.length===0)return;g=t(f);d=new Map(g.map(function(a,b){return[a.toString(),c("nullthrows")(e.get(f[b].toString()))]}));a=(yield l(g.map(String),!1)).filter(Boolean);for(g of a)if(g!=null){a=c("nullthrows")(d.get(g.id));b[a]=g}});return o.apply(this,arguments)}function a(){a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){if(!d("WAWebPnhGatingUtils").isMatFullyEnabled())return;var f=new Map();for(var g=0;g<b.length;g++)b[g]==null&&f.set(a[g],g);if(f.size===0)return;g=Array.from(f.keys()).map(function(a){return c("WAWebMsgKey").from(a)});var i=(yield d("WAWebApiChat").getMatChatBulk_DEPRECATED(g.map(function(a){return a.remote})));a=g.map(function(a){var b=i.get(a.remote);return b==null||!a.remote.isUser()||a.remote.equals(b)?null:[a.toString(),new(c("WAWebMsgKey"))({fromMe:a.fromMe,remote:b,id:a.id})]}).filter(Boolean);if(a.length===0)return;g=(yield p(a.map(function(a){a=a[1];return a.toString()}),e));for(e=0;e<g.length;e++)if(g[e]!=null){var j=a[e][0];j=f.get(j);j!=null?b[j]=g[e]:d("WALogger").DEV(h())}});return a.apply(this,arguments)}function p(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet(a,b));var c=new Map();for(var e=0;e<a.length;e++)(b[e]==null||b[e].subtype==="message_edit")&&(c.set(a[e],e),b[e]=null);if(c.size===0)return b;e=(yield d("WAWebSchemaMessage").getMessageTable().anyOf(["latestEditMsgKey"],Array.from(c.keys())));for(a of e){if(a.latestEditMsgKey==null||a.subtype==="message_edit")continue;e=c.get(a.latestEditMsgKey);if(e==null)continue;b[e]=a}return b});return q.apply(this,arguments)}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated())return a;a=a.map(function(a){return c("WAWebMsgKey").fromString(a)});var b=u(a.map(function(a){return a.remote}));b=(yield d("WAWebSchemaChat").getChatTable().anyOf(["accountLid"],Array.from(b).map(function(a){return a.toString()})));b=new Map(b.map(function(a){return[d("WAWebWidFactory").createWid(c("nullthrows")(a.accountLid)),d("WAWebWidFactory").createWid(a.id)]}));return v(a,b).map(String)});return s.apply(this,arguments)}function t(a){var b=new Map(a.map(function(a){return[a.remote,d("WAWebLidMigrationUtils").toPn(a.remote)]}));return v(a,b)}function u(a){a=a.filter(function(a){return a.isUser()}).map(d("WAWebLidMigrationUtils").toLid);a.some(function(a){return a==null})&&d("WALogger").ERROR(k()).sendLogs("bulk-get-root-msgs-missing-mapping");return new Set(a.filter(Boolean))}function v(a,b){return a.map(function(a){if(!a.remote.isUser())return a;var e=a.remote.isLid()?a.remote:d("WAWebApiContact").getCurrentLid(d("WAWebWidFactory").toUserWid(a.remote));if(e==null){d("WALogger").ERROR(j());return a}e=b.get(e);if(e==null){d("WALogger").ERROR(i()).sendLogs("bulk-get-root-msgs-chat-not-found");return a}return c("WAWebMsgKey").from({fromMe:a.fromMe,remote:e,id:a.id})})}g.bulkGetRootMsgs=l;g.fixMsgKeysWithChatId=r;g.fixMsgKeysWithPnMapping=t}),98);
__d("WAWebDBEphemeralMessage",["WALogger","WATimeUtils","WAWebDBMessageDelete","WAWebEphemeralKeepInChatUtils","WAWebSchemaMessage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["pruneExpiredMessages completed"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["pruneExpiredMessages started"]);i=function(){return a};return a}function a(){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").LOG(i()).tags("ephemeral-messages");var a=(yield d("WAWebSchemaMessage").getMessageTable().lessThan(["expiredTimestamp"],d("WATimeUtils").unixTime(),{shouldDecrypt:!1}));a=a.filter(function(a){return!d("WAWebEphemeralKeepInChatUtils").isKept(a.kicState)});yield d("WAWebDBMessageDelete").removeMessagesFromHistory(a.map(function(a){return a.id.toString()}));d("WALogger").LOG(h()).tags("ephemeral-messages");return a});return j.apply(this,arguments)}function c(a){return d("WAWebDBMessageDelete").removeMessagesFromHistory(a.map(function(a){return a.id.toString()}))}g.pruneExpiredMessages=a;g.removeExpiredMessagesFromHistory=c}),98);
__d("WATopLevelDomains",[],(function(a,b,c,d,e,f){a=new Set(["aaa","abb","abbott","abogado","abudhabi","ac","academy","accountant","accountants","ad","adult","ae","aero","af","afl","africa","ag","agency","ai","aig","airforce","al","alsace","am","amazon","amex","amsterdam","android","ao","apartments","app","apple","ar","arab","archi","army","arpa","art","as","asia","associates","at","au","auction","audi","audio","auspost","auto","autos","aw","aws","ax","az","ba","baby","band","bank","bar","barcelona","barclaycard","barclays","bargains","basketball","bauhaus","bayern","bb","bbva","bd","be","beauty","beer","berlin","best","bet","bf","bg","bh","bi","bible","bid","bike","bingo","bio","biz","bj","black","blackfriday","blog","blue","bm","bmw","bn","bnpparibas","bo","boats","bond","boo","boston","bot","boutique","box","br","bradesco","broker","brother","brussels","bs","bt","build","builders","business","buzz","bw","by","bz","bzh","ca","cab","cafe","cam","camera","camp","canon","capetown","capital","car","cards","care","career","careers","cars","casa","cash","casino","cat","catering","cba","cc","cd","center","ceo","cern","cf","cfd","cg","ch","charity","chase","chat","cheap","christmas","chrome","church","ci","citic","city","ck","cl","claims","cleaning","click","clinic","clothing","cloud","club","clubmed","cm","cn","co","coach","codes","coffee","college","cologne","com","community","company","computer","condos","construction","consulting","contact","contractors","cooking","cool","coop","corsica","country","coupons","courses","cpa","cr","credit","cricket","crs","cu","cuisinella","cv","cw","cx","cy","cymru","cyou","cz","dad","dance","date","dating","day","de","dealer","deals","delivery","deloitte","democrat","dental","desi","design","dev","dhl","diamonds","diet","digital","direct","directory","discount","diy","dj","dk","dm","do","doctor","dog","domains","download","durban","dvag","dz","earth","ec","eco","edeka","edu","education","ee","eg","email","energy","engineer","engineering","enterprises","epson","equipment","es","esq","estate","et","eu","eus","events","exchange","expert","exposed","express","extraspace","fail","faith","family","fan","fans","farm","fashion","feedback","fi","film","finance","financial","fish","fishing","fit","fitness","fj","fk","flights","flir","florist","flowers","fm","fo","foo","food","football","forex","forsale","forum","foundation","fox","fr","frl","fujitsu","fun","fund","furniture","futbol","fyi","ga","gal","gallery","game","games","garden","gay","gd","gdn","ge","gent","gf","gg","gh","gi","gift","gifts","gives","giving","gl","glass","gle","global","globo","gm","gmbh","gn","godaddy","gold","golf","goog","google","gop","gov","gp","gq","gr","graphics","gratis","green","group","gs","gt","guide","guru","gw","gy","hair","hamburg","haus","health","healthcare","help","hermes","hiphop","hk","hm","hn","hockey","holdings","holiday","homes","honda","horse","host","hosting","house","how","hr","ht","hu","ice","icu","id","ie","ikano","il","im","immo","immobilien","in","inc","industries","info","ing","ink","institute","insurance","insure","int","international","investments","io","iq","ir","irish","is","ismaili","ist","istanbul","it","itau","itv","java","jcb","je","jetzt","jewelry","jio","jm","jnj","jo","jobs","joburg","jp","kaufen","ke","kg","kh","ki","kids","kim","kitchen","kiwi","kn","koeln","komatsu","kp","kpmg","kr","krd","kred","kw","ky","kyoto","kz","la","land","landrover","lat","law","lawyer","lb","lc","leclerc","legal","lgbt","li","lidl","life","lighting","lilly","limited","limo","link","live","lk","llc","loan","loans","local","lol","london","love","ls","lt","ltd","ltda","lu","lundbeck","luxe","luxury","lv","ly","ma","madrid","makeup","man","management","mango","market","marketing","markets","mba","mc","md","me","media","meet","melbourne","meme","memorial","men","menu","mg","mh","miami","microsoft","mil","mk","ml","mm","mn","mo","mobi","moda","moe","mom","monash","money","monster","mortgage","moscow","motorcycles","mov","movie","mp","mq","mr","ms","mt","mu","museum","music","mv","mw","mx","my","mz","na","nab","nagoya","name","navy","nc","ne","net","network","neustar","new","news","next","nexus","nf","ng","ngo","ni","nico","nike","ninja","nl","no","np","nr","nrw","ntt","nu","nyc","nz","observer","okinawa","om","one","ong","onion","onl","online","ooo","orange","org","organic","ovh","pa","page","panasonic","paris","partners","parts","party","pe","pet","pf","pg","ph","pharmacy","phd","photo","photography","photos","pics","pictet","pictures","pink","pioneer","pizza","pk","pl","place","plumbing","plus","pm","pn","poker","politie","porn","post","pr","press","pro","productions","prof","promo","properties","property","ps","pt","pub","pw","py","qa","qpon","quebec","quest","racing","radio","re","realestate","realtor","recipes","red","rehab","reisen","ren","rent","rentals","repair","report","republican","rest","restaurant","review","reviews","rio","rip","ro","rocks","rodeo","rs","rsvp","ru","rugby","ruhr","run","rw","ryukyu","sa","saarland","sale","salon","sandvik","sanofi","sap","sarl","saxo","sb","sbi","sbs","sc","scb","schmidt","school","schule","schwarz","science","scot","sd","se","seat","security","select","sener","services","sex","sexy","sg","sh","sharp","shell","shiksha","shoes","shop","shopping","show","si","singles","site","sk","ski","skin","sky","sl","sm","sn","sncf","so","soccer","social","software","solar","solutions","sony","soy","space","sport","sr","srl","ss","st","statebank","statefarm","stockholm","storage","store","stream","studio","study","style","su","sucks","supplies","supply","support","surf","surgery","suzuki","sv","swiss","sx","sy","sydney","systems","sz","taipei","tatamotors","tatar","tattoo","tax","taxi","tc","td","team","tech","technology","tel","tennis","teva","tf","tg","th","theater","tickets","tienda","tips","tirol","tj","tk","tl","tm","tn","to","today","tokyo","tools","top","toshiba","total","tours","town","toyota","toys","tr","trade","trading","training","travel","tt","tube","tui","tv","tw","tz","ua","ug","uk","university","uno","uol","us","uy","uz","va","vacations","vanguard","vc","ve","vegas","ventures","vet","vg","vi","video","vin","vip","vision","vivo","vlaanderen","vn","vodka","vote","voto","voyage","vu","wales","wang","watch","webcam","weber","website","wedding","weir","wf","wien","wiki","williamhill","win","wine","woodside","work","works","world","ws","wtf","xin","xyz","yachts","yandex","ye","yoga","yokohama","youtube","yt","za","zappos","zara","zip","zm","zone","zw","\u0431\u0435\u043b","\u0434\u0435\u0442\u0438","\u043c\u043e\u0441\u043a\u0432\u0430","\u043e\u043d\u043b\u0430\u0439\u043d","\u0440\u0443\u0441","\u0440\u0444","\u0443\u043a\u0440","\u092d\u093e\u0930\u0924","\u09ad\u09be\u09f0\u09a4","\u0aad\u0abe\u0ab0\u0aa4","\u0b2d\u0b3e\u0b30\u0b24","\u30bb\u30fc\u30eb","\u4e2d\u56fd","\u516c\u53f8","\u6211\u7231\u4f60","\u79fb\u52a8","\u7f51\u5740","\u7f51\u7ad9","\u7f51\u7edc","\ub2f7\ub137","\ub2f7\ucef4","\ud55c\uad6d"]);f.TLD=a}),66);
/**
 * License: https://www.facebook.com/legal/license/NKF0mBOyBt2/
 */
__d("punycode-2.1.1",[],(function(a,b,c,d,e,f){"use strict";b={};var g={exports:b};function h(){var a=2147483647,b=36,c=1,d=26,e=38,f=700,h=72,i=128,j="-",k=/^xn--/,l=/[^\0-\x7E]/,m=/[\x2E\u3002\uFF0E\uFF61]/g,n={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},o=b-c,p=Math.floor,q=String.fromCharCode;function r(a){throw new RangeError(n[a])}function s(a,b){var c=[],d=a.length;while(d--)c[d]=b(a[d]);return c}function t(a,b){var c=a.split("@"),d="";c.length>1&&(d=c[0]+"@",a=c[1]);a=a.replace(m,".");c=a.split(".");a=s(c,b).join(".");return d+a}function u(a){var b=[],c=0,d=a.length;while(c<d){var e=a.charCodeAt(c++);if(e>=55296&&e<=56319&&c<d){var f=a.charCodeAt(c++);(f&64512)==56320?b.push(((e&1023)<<10)+(f&1023)+65536):(b.push(e),c--)}else b.push(e)}return b}var v=function(a){return String.fromCodePoint.apply(String,a)},w=function(a){if(a-48<10)return a-22;if(a-65<26)return a-65;return a-97<26?a-97:b},x=function(a,b){return a+22+75*(a<26)-((b!=0)<<5)},y=function(a,c,g){var h=0;a=g?p(a/f):a>>1;a+=p(a/c);for(;a>o*d>>1;h+=b)a=p(a/o);return p(h+(o+1)*a/(a+e))},z=function(e){var f=[],g=e.length,k=0,l=i,m=h,n=e.lastIndexOf(j);n<0&&(n=0);for(var o=0;o<n;++o)e.charCodeAt(o)>=128&&r("not-basic"),f.push(e.charCodeAt(o));for(o=n>0?n+1:0;o<g;){n=k;for(var q=1,s=b;;s+=b){o>=g&&r("invalid-input");var t=w(e.charCodeAt(o++));(t>=b||t>p((a-k)/q))&&r("overflow");k+=t*q;var u=s<=m?c:s>=m+d?d:s-m;if(t<u)break;t=b-u;q>p(a/t)&&r("overflow");q*=t}u=f.length+1;m=y(k-n,u,n==0);p(k/u)>a-l&&r("overflow");l+=p(k/u);k%=u;f.splice(k++,0,l)}return String.fromCodePoint.apply(String,f)},A=function(e){var f=[];e=u(e);var g=e.length,k=i,l=0,m=h;for(var n=e,o=Array.isArray(n),s=0,n=o?n:n[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var t;if(o){if(s>=n.length)break;t=n[s++]}else{s=n.next();if(s.done)break;t=s.value}t=t;t<128&&f.push(q(t))}t=f.length;s=t;t&&f.push(j);while(s<g){o=a;for(var n=e,v=Array.isArray(n),w=0,n=v?n:n[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var z;if(v){if(w>=n.length)break;z=n[w++]}else{w=n.next();if(w.done)break;z=w.value}z=z;z>=k&&z<o&&(o=z)}z=s+1;o-k>p((a-l)/z)&&r("overflow");l+=(o-k)*z;k=o;for(w=e,v=Array.isArray(w),n=0,w=v?w:w[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(v){if(n>=w.length)break;o=w[n++]}else{n=w.next();if(n.done)break;o=n.value}o=o;o<k&&++l>a&&r("overflow");if(o==k){o=l;for(var A=b;;A+=b){var B=A<=m?c:A>=m+d?d:A-m;if(o<B)break;var C=o-B,D=b-B;f.push(q(x(B+C%D,0)));o=p(C/D)}f.push(q(x(o,0)));m=y(l,z,s==t);l=0;++s}}++l;++k}return f.join("")},B=function(a){return t(a,function(a){return k.test(a)?z(a.slice(4).toLowerCase()):a})},C=function(a){return t(a,function(a){return l.test(a)?"xn--"+A(a):a})};v={version:"2.1.0",ucs2:{decode:u,encode:v},decode:z,encode:A,toASCII:C,toUnicode:B};g.exports=v}var i=!1;function j(){i||(i=!0,h());return g.exports}function a(a){switch(a){case void 0:return j()}}e.exports=a}),null);
__d("punycode",["punycode-2.1.1"],(function(a,b,c,d,e,f){e.exports=b("punycode-2.1.1")()}),null);
__d("WALinkify",["WALogger","WATopLevelDomains","punycode"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["text size: ",", error: ",""]);h=function(){return a};return a}e=Array.from(d("WATopLevelDomains").TLD).join("|");f="(?:http|https)://|mailto:";var i=/^https?:\/\/$/gi,j="\\w|[^\\s\0-\x7f\xab\xbb\u2018\u2019\u201c\u201d]|%[0-9a-f][0-9a-f]";e=e+"|xn--(?:"+j+")+";var k="(?:"+j+")|(?:"+j+")(?:"+j+"|-)*(?:"+j+")",l="(?!_)(?:(?:"+k+")\\.)+("+e+")(?!\\."+k+")",m=":\\d{1,5}",n="@!.?,(\\[{<\xab\u2018\u201c:";j="(?:"+j+"|[^\\s%])";var o="/"+j+"*?";n="["+n+"]*(?!"+j+"|#)";var p="\\?(?!"+n+")"+j+"*?";j="#"+j+"*?";var q="0-9a-z!#$%&'*+/=?^_`{|}~\\-";q="\\b\\w["+q+"]*(?:\\.["+q+"]+)*";var r="^|\\W\\.|[^/\\w.]|_";r="("+r+")("+f+")?("+q+"@)?("+l+")(?:(?!"+k+")|(?=_))(?:(?=[^:/?#])|("+m+")?("+o+")?("+p+")?("+j+")?(?="+n+"))";var s=1,t=2,u=3,v=4,w=5,x=6,y=7,z=8,A=9,B=new Map([[34,34],[41,40],[62,60],[93,91],[125,123],[187,171],[8217,8216],[8221,8220]]),C=new Map([[34,34],[40,41],[60,62],[91,93],[123,125],[171,187],[8216,8217],[8220,8221]]),D=new RegExp(""+r,"ig"),E=new RegExp("\\.(?:"+e+")","i");function F(a){try{return D.exec(a)}catch(b){d("WALogger").ERROR(h(),a.length,String(b)).devConsole(b).sendLogs("linkify-regex-error");return null}}function a(a,b){b===void 0&&(b=!1);if(!E.test(a))return[];D.lastIndex=0;var c=[],d;while(d=F(a)){d=H(d,b);d&&c.push(d)}return c}function G(a,b){b===void 0&&(b=!1);if(!E.test(a))return null;D.lastIndex=0;return H(F(a),b)}function H(a,b){b===void 0&&(b=!1);if(!a)return null;var e=a[s].length,f=a[0],g=a.index+e,h=a.index,j=a[s]==="_";if(j&&h-1&&/\S/.test(a.input[h-1]))return null;j=a[w];if(j&&j.startsWith("xn--")&&!d("WATopLevelDomains").TLD.has(c("punycode").toUnicode(j)))return null;if(a[x]){h=parseInt(a[x].slice(1),10);if(a[x][1]==="0"||!(0<h&&h<1<<16))return null}j=[A,z,y].find(function(b){return a&&a[b]})||0;if(j){h=[];var k=a[j];k.slice(-1)==="_"&&f[g-1]==="_"&&(f=f.slice(0,-1),a[j]=k=k.slice(0,-1));var l=0,m=0;for(var n=0;n<k.length;n++){var o=k.charCodeAt(n);o===m?(m=h.pop()||0,m===0&&(l=n)):C.has(o)?(m!==0&&h.push(m),m=C.get(o)):B.has(o)||m===0&&(l=n)}if(l!==k.length-1){o=a.slice(t,j);o.splice(w-t,1);f=o.filter(function(a){return a}).join("")+k.slice(0,l+1);D.lastIndex=g+f.length}else f=f.slice(e)}else f=f.slice(e);n=f;h=a[t];m=Boolean(h&&h.match(i));if(b&&!m)return null;h?h=h.toLowerCase():(n.toLowerCase().indexOf("irc.")===0?h="irc://":n.toLowerCase().indexOf("ftp.")===0?h="ftp://":a[u]?h="mailto:":h="http://",n=h+n);j=a[v];return{href:n,url:f,index:g,input:a.input,scheme:h,username:a[u],domain:j,port:a[x],path:a[y],params:a[z],anchor:a[A],isHttp:m}}function b(a){var b=G(a);return b&&b.url===a&&b.scheme==="mailto:"&&b.username!=null&&b.username!==""&&(b.params==null||b.params==="")&&(b.anchor==null||b.anchor==="")?b:null}g.findLinks=a;g.findLink=G;g.validateEmail=b}),98);
__d("WALanguagesAndRegions",[],(function(a,b,c,d,e,f){"use strict";a={fub:["237","235","234"],af:["237","27"],agq:["237"],yay:["234"],bss:["237"],agg:["675"],ast:["34"],avu:["243","211"],az:["994"],bkc:["237","241"],ksf:["237"],bfd:["237"],bjt:["221"],bcn:["234"],bas:["237"],bsq:["231"],bkv:["234"],bom:["234"],btt:["234"],bin:["234"],bmq:["226","223"],bs:["387","385","383","382","381"],fue:["229","228"],br:["33"],bys:["234"],bwr:["234"],cky:["234"],ca:["376","33","39","34"],tzm:["212"],fuq:["234"],ckl:["234"],asg:["234"],co:["33","39"],crh:["7"],hr:["387","385","383","382","381"],mfn:["234"],cs:["420","421"],dbq:["237","234"],dnj:["225","231"],dzg:["235","227"],ddn:["229"],dgh:["234"],dow:["237"],dua:["229"],nl:["297","32","599","31","1","597"],igb:["234"],etr:["675"],enn:["234"],kgy:["675"],et:["372"],ich:["234"],ee:["229","233","228"],ewo:["237"],fo:["298"],fmp:["237"],fi:["358","46"],fr:["32","229","226","257","237","1","236","242","243","235","269","253","240","33","241","509","225","352","261","223","377","227","250","221","248","41","228","678"],fur:["39"],ff:["237","224","222","221"],gaj:["675"],gl:["34"],gby:["234"],gba:["236"],gmm:["237"],de:["43","32","49","423","352","41"],tof:["675"],god:["225"],ank:["234"],gkn:["234"],gux:["229","226","227","228"],gde:["237","234"],gkp:["224"],kl:["299"],jgk:["234"],ha:["229","237","235","233","225","227","234","249","228"],haw:["1"],hbb:["234"],hu:["36"],dud:["234"],jab:["234"],iby:["234"],is:["354"],idu:["234"],ig:["240"],ige:["234"],ikx:["256"],ikk:["234"],ikq:["234"],smn:["358"],ga:["353","44"],atg:["234"],izi:["234"],dyo:["220","221"],jbu:["237","234"],kab:["213"],kea:["238"],tbd:["675"],hig:["234"],kai:["234"],kkj:["237","236","242"],kzr:["237","235"],naq:["264"],geb:["675"],okr:["234"],ksh:["49"],ses:["223"],khq:["223"],kun:["291","251"],kup:["675"],kub:["237","234"],kpe:["224","231"],nmg:["237","240"],ku:["963","90"],lkt:["1"],hia:["234"],lag:["255"],lv:["371"],lmp:["237"],ln:["242","243"],liv:[],lt:["370"],yaz:["234"],nds:["55","49","31"],dsb:["49"],lu:["243"],lb:["32","33","49","352"],mda:["234"],mb:["261"],mt:["356"],mi:["64"],arn:["56"],mas:["254","255"],ffm:["223"],mql:["229","228"],mbo:["237"],mbu:["234"],mif:["237"],mzm:["234"],mua:["237","235"],sur:["234"],nv:["1"],anc:["234"],nnh:["237"],jgo:["237"],fuv:["237","234"],nin:["234"],dgi:["226"],se:["358","46","47"],nso:["27"],ann:["234"],oc:["33","39","377","34"],pbi:["237"],pip:["234"],pl:["48"],pt:["244","55","238","240","245","853","258","351","239","670"],prg:[],fuf:["224","223","221","232"],qu:["54","591","57","593","51"],ro:["373","40"],cla:["234"],sav:["221"],sg:["236","235","243"],gd:["44"],seh:["258"],sr:["387","385","383","382","381"],sh:["387","385","383","382","381"],srr:["220","221"],sch:["39"],sld:["226"],sms:["358"],sk:["420","421"],sl:["386"],sok:["235"],es:["54","501","591","56","57","506","53","593","503","240","502","504","52","505","507","595","51","34","1","598","58"],srn:["597"],gsw:["43","33","49","423","41"],shi:["212"],tal:["234"],tmh:["223"],taq:["226","223"],tan:["234"],twq:["227"],blt:["856","84"],yer:["234"],tuq:["235","218","227","234"],ttr:["234"],tik:["237"],to:["676"],dts:["223"],kdl:["234"],tsw:["234"],tr:["90"],tk:["993"],hsb:["49"],vai:["231","232"],vi:["855","84"],vo:[],vut:["237","234"],wja:["234"],wa:["32"],wae:["43","39","423","41"],wji:["234"],cy:["44"],fy:["31"],fuh:["229","226","227"],yba:["234"],yav:["237"],yle:["675"],yll:["675"],yo:["229","234"],dje:["227"],gnd:["237"]};f.LANGUAGE_TO_REGIONS=a}),66);
__d("WAIdn",["WALanguagesAndRegions","WAStringz"],(function(a,b,c,d,e,f,g){"use strict";var h={í:["ast","ksf","bas","ca","cs","dua","nl","ee","ewo","fo","fr","gl","kl","hu","is","ga","dyo","kea","kkj","nmg","lkt","lag","ln","lu","mas","nnh","jgo","pt","qu","seh","sk","es","to","vai","vi","wae","cy","fy","yav","yo"],î:["af","agq","bss","bfd","bas","bkv","btt","nl","igb","ewo","fr","fur","gaj","gby","kl","jab","atg","jbu","kkj","naq","ksh","ku","nmb","lmp","ln","mda","mg","mas","mzm","jgo","nin","ann","ro","sg","scn","srn","yer","tr","wa","cy","yav","yle"],ü:["agg","ast","az","br","ca","co","cs","nl","etr","et","fr","gl","de","tof","god","hu","tbd","geb","ksh","kup","nds","lb","arn","oc","sg","sk","es","gsw","dts","tr","tk","vo","wa","wae","fy","yll"],ċ:["mt"],ī:["agq","bss","bfd","bas","bkv","btt","ddn","igb","kjy","ich","gux","haw","jab","iby","idu","jbu","kub","nmg","lv","mda","mi","mas","mql","nin","prg","gd","to","yba","yav"],ı:["az","crh","tr"],ļ:["lv"],ł:["dsb","nv","pl","hsb"],š:["bs","hr","cs","dzg","et","fi","smn","geb","khq","ses","kun","lkt","lv","lt","dsb","se","nso","prg","sr","sh","sms","sk","sl","taq","twq","tuq","hsb","wqe","dje"],ƙ:["ckl","ank","ha","ikx","kai","hia","mbu","anc","nin","pip","tal","tan","wja","wji"],ǀ:["naq"],ǁ:["naq"],ȯ:["liv"],ɑ:["fmp","dud","tmh"],ɓ:["fub","yay","bkc","bjt","bcn","bas","bsq","bmq","fue","bys","bwr","cky","fuq","ckl","asg","dbq","dnj","dgh","dow","dua","enn","ff","gby","gba","gmm","ank","gde","gkp","jgk","ha","hbb","ikx","kkj","hig","kzr","kai","kpe","nmg","hia","ffm","mbo","mbu","mif","mzm","mua","sur","anc","fuv","nin","dgi","pbi","pip","fuf","cla","sav","srr","sld","sok","tal","tan","yer","ttr","tik","kdl","tsw","vai","vut","wja","wji","fuh","gnd"],ḍ:["tzm","kab","okr","shi","tmh","taq"],ṛ:["tzm","kab","shi"],ṭ:["tzm","kab","shi","tmh","taq"],ẉ:[],ạ:["izi","yaz","blt","vi"],ẹ:["yay","bom","bin","mfn","dzg","igb","enn","gkn","iby","ikk","ikw","izi","okr","yaz","blt","tan","tuq","vi","yo"],ị:["avu","mfn","igb","enn","iby","ig","ige","ikk","ikw","izi","okr","blt","tan","vi"]},i=new Set(["abq","ab","ady","av","az","ba","be","bs","bg","bua","ce","ckt","cu","cv","crh","dar","dng","myv","evn","gag","inh","kbd","xal","krc","kaa","kk","kjh","kca","ky","kv","koi","kpy","kum","lbe","lez","mk","mns","chm","mdf","mn","ttt","gld","yrk","nog","os","ru","rue","sr","sh","cjs","alt","tab","tg","tt","tkr","tk","tyv","ude","udm","uk","uz","mrj","sah"]),j=new Set(["374","994","375","387","359","995","7","383","996","389","373","976","382","381","992","993","380","998"]),k="\u0430\u0432\u0433\u0435\u043a\u043c\u043d\u043e\u0440\u0441\u0442\u0443\u0445\u0448\u0449\u044c\u0455\u0456\u0458\u0461\u0475\u04af\u04bb\u04cf\u0501\u051b\u051d\u0527\ua699";function l(a){return i.has(a)}function m(a){return j.has(a)}function n(a){return k.includes(a)}var o=new RegExp("^[a-z0-9-]+$"),p=2;function a(a,b,c,e){a=a.split(".");var f,g=!1;a.forEach(function(a){g=!a.match(o);if(g)if(!f)f=a;else return null});if(f==null||g)return null;a=[];var i=!0,j=d("WAStringz").toArray(f);for(var k=0;k<j.length;k++){var q=j[k];i=i&&n(q);if(i)continue;if(h[q])if(a.length>=p)return null;else a.push(q)}if(i){if(m(c)||m(b))return null;return e.some(function(a){return l(a)})?null:new Set(j)}if(!a.length)return null;q=a.filter(function(a){var f=h[a];if(f==null)return!1;if(e.some(function(a){return f.includes(a)}))return!1;a=new Set();for(var g=0;g<f.length;g++){var i=d("WALanguagesAndRegions").LANGUAGE_TO_REGIONS[f[g]];if(i==null)continue;for(var j=0;j<i.length;j++)a.add(i[j])}return a.has(c)||a.has(b)?!1:!0});return q.length?new Set(q):null}g.findSuspiciousCharacters=a}),98);
__d("WAPhoneFindCC",[],(function(a,b,c,d,e,f){"use strict";var g=/^(1|2[07]|3[0-469]|4[013-9]|5[1-8]|6[0-6]|7|8[1246]|9[0-58])/;function a(a){return h(a)}function h(a){var b=a.match(g);if(b)return b[0];else return a.length>=3?a.substring(0,3):a}function b(a){a=a.match(/\d+/g);return a!=null?a.join(""):""}f.phoneCC=a;f.findCC=h;f.extractDigits=b}),66);
__d("WASuspiciousLinks",["WAIdn","WAJids","WAPhoneFindCC"],(function(a,b,c,d,e,f,g){"use strict";var h=/^(?:https?:\/\/)?([^/?#]+)(?:[/?#]|$)/i,i="ZZ";function a(a,b,c,e){a=a.match(h);a=a&&a[1];if(a==null)return null;c=d("WAPhoneFindCC").phoneCC(c);var f;if(b==="whatsapp")f="";else{var g=d("WAJids").interpretAndValidateJid(b.toString());f=g.jidType!=="lidUser"?d("WAPhoneFindCC").phoneCC(d("WAJids").toPhoneUserJid(b)):i}g=e.map(function(a){return a.toLowerCase()});return d("WAIdn").findSuspiciousCharacters(a,f,c,g)}g.findSuspiciousCharacters=a}),98);
__d("WAWebLinkify",["WAJids","WALinkify","WASuspiciousLinks","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g){function a(a,b,c){b===void 0&&(b=!1);a=d("WALinkify").findLinks(a,b);return a.map(function(a){return i(a,c)})}function h(a,b,c){b===void 0&&(b=!1);a=d("WALinkify").findLink(a,b);if(a==null)return;return i(a,c)}function b(a){return a.body!=null&&h(a.body,!0)!=null}function i(a,b){var c=d("WAWebUserPrefsMeUser").getMaybeMeUser(),e=null;if(b&&c){b=b.isLid()?d("WAJids").toLidUserJid(b.user):d("WAJids").toPhoneUserJid(b.user);e=d("WASuspiciousLinks").findSuspiciousCharacters(a.domain,b,d("WAJids").toPhoneUserJid(c.user),[])}return babelHelpers["extends"]({},a,{suspiciousCharacters:(b=e)!=null?b:void 0})}g.findLinks=a;g.findLink=h;g.hasHttpLink=b}),98);
__d("WAWebDBEncryptMultipleMsgs",["Promise","WAAsyncSleep","WALogger","WAWebBrokerGlobalAppState","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebDbEncryptionKey","WAWebLinkify","WAWebSchemaMessage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["processAndEncryptSingleMsgRow without throttle failed with error: ",", message: ",", stack: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["processAndEncryptSingleMsgRow failed for msg: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["processAndEncryptSingleMsgRow with throttle failed with error: ",", message: ",", stack: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["processAndEncryptSingleMsgRow failed for msg: ",""]);l=function(){return a};return a}var m=function(b){babelHelpers.inheritsLoose(a,b);function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(a=c=b.call.apply(b,[this].concat(e))||this,c.name="DroppingMsgRowDueToLogout",a)||babelHelpers.assertThisInitialized(c)}return a}(babelHelpers.wrapNativeSuper(Error));function a(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){c===void 0&&(c=!1);yield d("WAWebDbEncryptionKey").DbEncKeyStore.waitForFinalDbMsgEncKey();yield new(h||(h=b("Promise")))(function(a){return self.setTimeout(a,0)});if(c){c=[];for(var e=0;e<a.length;e++)try{var f=a[e];f=(yield o(f,e));c.push(f)}catch(b){if(b instanceof m)throw b;d("WALogger").DEV(l(),a[e].id.remote).tags("message-store");d("WALogger").ERROR(k(),b.name,b.message,b.stack).tags("message-store").devConsole(b)}}else{f=(yield (h||(h=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield o(a)["catch"](function(b){if(b instanceof m)throw b;d("WALogger").DEV(j(),a.id.remote).tags("message-store");d("WALogger").ERROR(i(),b.name,b.message,b.stack).tags("message-store").devConsole(b)})["finally"](function(){return void 0}));return b});return function(b){return a.apply(this,arguments)}}())));c=f.filter(Boolean)}return c});return n.apply(this,arguments)}function o(a,b){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){if(c("WAWebBrokerGlobalAppState").isLogoutInProgress)return(h||(h=b("Promise"))).reject(new m());e!=null&&(yield d("WAAsyncSleep").asyncSleepAfterGivenLoopIteration(e,35,100));e=d("WAWebSchemaMessage").getMessageTable();var f=d("WAWebDBMessageUtils").getVcardWids(a),g=d("WAWebDBMessageSerialization").dbRowFromMessage(a);e=(yield e.preflightEncryptSingleRecord(babelHelpers["extends"]({},g)));return[babelHelpers["extends"]({},g,e,{vcardWAids:f}),d("WAWebLinkify").hasHttpLink(a)]});return p.apply(this,arguments)}g.DroppingMsgRowDueToLogout=m;g.encryptMultipleDBMsgs=a;g.processAndEncryptSingleMsgRow=o}),98);
__d("WAWebDBMessageBulkHelper",["Promise","WAJids","WALogger","WANullthrows","WAWebApiContact","WAWebDBEncryptMultipleMsgs","WAWebDBStoreEncryptedMsgs","WAWebDBStoreNewsletterEncryptedMsgs","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebModelStorageUtils","WAWebMsgGetters","WAWebPnhGatingUtils","WAWebSchemaChat","WAWebUpdateDuplicatedLidThread","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][msg-cache]: storing chat updates: ",""]);i=function(){return a};return a}function a(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{yield k(a,b)}catch(c){if(d("WAWebDBStoreEncryptedMsgs").isEligibleForFallback(a.length,c))yield k(a,b,!0);else throw c}});return j.apply(this,arguments)}function k(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){e===void 0&&(e=!1);a=(yield (h||(h=b("Promise"))).all([n(a),d("WAWebDBEncryptMultipleMsgs").encryptMultipleDBMsgs(a,!1)]));var f=a[0],g=a[1];yield d("WAWebModelStorageUtils").getStorage().lock(["chat","fts-indexing-queue","message","message-association"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a[0];a[1];a[2];a[3];yield b.bulkCreateOrMerge(f);yield d("WAWebDBStoreEncryptedMsgs").storeEncryptedDBMessages(g,c,!1,e)});return function(b){return a.apply(this,arguments)}}())});return l.apply(this,arguments)}function e(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield (h||(h=b("Promise"))).all([n(a),d("WAWebDBEncryptMultipleMsgs").encryptMultipleDBMsgs(a,!1)]));var c=a[0],e=a[1];return d("WAWebModelStorageUtils").getStorage().lock(["chat","message"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];yield a.bulkCreateOrMerge(c);yield d("WAWebDBStoreNewsletterEncryptedMsgs").storeEncryptedNewsletterMessages(e)});return function(b){return a.apply(this,arguments)}}())});return m.apply(this,arguments)}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Map();a.forEach(function(a){var c=a.id,e=c.remote.toString();if(e!==d("WAJids").STATUS_JID&&d("WAWebMsgGetters").getIsUnreadType(a)){var f=b.get(e)||{unread:0,t:0,unreadMentionsOfMe:[]};if(!c.fromMe){f.unread+=1;if(d("WAWebMsgGetters").getIsImportantMessage(a)){c={id:a.id.toString(),timestamp:a.t};f.unreadMentionsOfMe?f.unreadMentionsOfMe.push(c):f.unreadMentionsOfMe=[c]}}a.t!=null&&a.t>f.t&&(f.t=Math.max(a.t,f.t));b.set(e,f)}});var e=Array.from(b.keys()),f,g;if(d("WAWebPnhGatingUtils").isMatFullyEnabled()){g=d("WAWebApiContact").getAlternateWidBulkForLids_DEPRECATED(e);a=[];for(var h of g.values())a.push.apply(a,h);f=(yield d("WAWebSchemaChat").getChatTable().bulkGet(a))}h=(yield d("WAWebSchemaChat").getChatTable().bulkGet(e));a=h.map(function(a,h){var i,j;h=e[h];var k=b.get(h),l=(k==null?void 0:k.unread)||0,m=Math.max(0,a?a.unreadCount:0),n=(k==null?void 0:k.t)||void 0;a&&a.t!=null&&((n==null||a.t>n)&&(n=a.t));var o=[];i=(i=a==null?void 0:a.archiveAtMentionViewedInDrawer)!=null?i:!1;k=(k=k==null?void 0:k.unreadMentionsOfMe)!=null?k:[];j=(j=a==null?void 0:a.unreadMentionsOfMe)!=null?j:[];k.length>0&&(i=!1);o=k.concat(j);k=a==null?void 0:a.isDeprecated;if(k!==!0&&d("WAWebPnhGatingUtils").isMatFullyEnabled()&&a!=null){j=d("WAWebUpdateDuplicatedLidThread").shouldDeprecateLidThread(a,(j=g.get(a.id.toString()))!=null?j:[],f);j&&(k=!0)}j=void 0;if(d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()){var p=d("WAWebWidFactory").createWid(h);!a&&p.isUser()&&(j=d("WAWebWidFactory").toUserWid(c("WANullthrows")(d("WAWebLidMigrationUtils").toLid(p))).toString())}a={id:h,unreadCount:m+l,t:n,unreadMentionsOfMe:o,archiveAtMentionViewedInDrawer:i,isDeprecated:k};j!=null&&(a.accountLid=j);return a});d("WALogger").LOG(i(),JSON.stringify(a));return a});return o.apply(this,arguments)}g.persistNewMessagesInBulk=a;g.persistNewNewsletterMessagesInBulk=e}),98);
__d("WAWebDBDeleteAssociatedMsgsByMsgKey",["WAWebSchemaMessageAssociation"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebSchemaMessageAssociation").getMessageAssociationTable().bulkRemove(a)}function b(a){return d("WAWebSchemaMessageAssociation").getMessageAssociationTable().bulkRemoveByIndex(["msgKey"],a)}g.bulkDeleteMessagesByMsgKeyAndAssociationType=a;g.bulkDeleteMessagesByMsgKeys=b}),98);
__d("WAWebDBGetAssociatedMsgsByParentMsgKey",["WAWebSchemaMessageAssociation"],(function(a,b,c,d,e,f,g){function a(a){return h([a])}function h(a){return d("WAWebSchemaMessageAssociation").getMessageAssociationTable().anyOf(["parentMsgKey"],a.map(String))}g.getMessagesByParentMsgKey=a;g.bulkGetMessagesByParentMsgKey=h}),98);
__d("WAWebDBQueryAndRemoveLocalLabelAssociation",["WAWebSchemaLabelAssociation","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(a){return d("WAWebSchemaLabelAssociation").getLabelAssociationTable().anyOf(["associationId","type"],a.map(function(a){var b=a.associationId;a=a.type;return[b,a]}))}function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield h(a));yield d("WAWebSchemaLabelAssociation").getLabelAssociationTable().bulkRemove(a.map(function(a){var b=a.labelId,c=a.associationId;a=a.type;return[b,c,a]}))});return i.apply(this,arguments)}g.queryLocalLabelAssociation=h;g.queryAndRemoveLocalLabelAssociation=a}),98);
__d("WAWebWorkerSafeBackendApi",["WAWebBackendApi"],(function(a,b,c,d,e,f,g){function a(a,b){d("WAWebBackendApi").fireAndForgetInternalDoNotUse("workerSafeEvent",a,b)}function b(a,b){return d("WAWebBackendApi").sendAndReceiveInternalDoNotUse("workerSafeEvent",a,b)}g.workerSafeFireAndForget=a;g.workerSafeSendAndReceive=b}),98);
__d("WAWebFtsLightClient",["Promise","WAWebFtsStorage","WAWebRuntimeEnvironmentUtils","WAWebSchemaFtsIndexingQueue","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=null;function j(){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(i!=null)return i;i=(yield d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("getFtsClientInstance"));return i});return k.apply(this,arguments)}function a(a){return d("WAWebSchemaFtsIndexingQueue").getFtsIndexingQueueTable().bulkCreateOrReplace(a.map(function(a){return{id:a}}))}function c(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;if(d("WAWebRuntimeEnvironmentUtils").isWorker())return d("WAWebFtsStorage").getIndexV3Table().bulkRemoveByIndex(["id"],a);b=(b=i)!=null?b:yield j();yield b.purge(a)});return l.apply(this,arguments)}function e(){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a;if(d("WAWebRuntimeEnvironmentUtils").isWorker())return(h||(h=b("Promise"))).resolve();a=(a=i)!=null?a:yield j();yield a.index()});return m.apply(this,arguments)}f={purge:c,index:e,addToIndexingTable:a};g.ftsLightClient=f}),98);
__d("WAWebDBMessageDelete",["Promise","WALogger","WAWebBotGating","WAWebDBDeleteAssociatedMsgsByMsgKey","WAWebDBGetAssociatedMsgsByParentMsgKey","WAWebDBQueryAndRemoveLocalLabelAssociation","WAWebDBReportingTokenUtils","WAWebDBStoreRevokeMsgs","WAWebFtsLightClient","WAWebMessageAssociationGatingUtils","WAWebModelStorageInitialize","WAWebModelStorageUtils","WAWebMsgKey","WAWebNoop","WAWebSchemaLabelAssociation","WAWebSchemaMessage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["removeMessagesFromHistory: error ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["removeMessagesFromHistory: delete "," messages"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[bot] findAndDeleteAssociatedPluginMsg failed with error: ",", stack: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[bot] Removing bot plugin msgs after delete for self"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[association-infra] Removing associations after delete for self"]);m=function(){return a};return a}function a(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){e===void 0&&(e={deleteAssociatedMsgs:!0});e=e;var f=e.deleteAssociatedMsgs;if(a.length===0)return;var g=[];return d("WAWebModelStorageInitialize").initializeWithoutGKs().then(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=new Set(a),e=[],h=[];if(f&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){var i=(yield d("WAWebDBGetAssociatedMsgsByParentMsgKey").bulkGetMessagesByParentMsgKey(Array.from(a).map(function(a){return c("WAWebMsgKey").fromString(a)})));i.forEach(function(a){h.push([a.msgKey,a.associationType]),b.add(a.msgKey)})}i=Array.from(b);yield d("WAWebSchemaMessage").getMessageTable().bulkGet(i,!1).then(function(a){a.forEach(function(a){(a==null?void 0:a.rowId)!=null&&e.push(String(a.rowId));var b=a==null?void 0:a.associationType;b!=null&&a!=null&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&h.push([a.id.toString(),b]);b=a==null?void 0:a.botResponseTargetId;var c=a==null?void 0:a.internalId;(a==null?void 0:a.botPluginSearchProvider)!=null&&(a==null?void 0:a.botPluginSearchUrl)!=null&&b!=null&&c!=null&&g.push({internalId:c,targetId:b})})});return{deleteMsgIdsSet:b,msgRowIds:e,deleteAssociationMappings:h}})).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.deleteMsgIdsSet,e=a.deleteAssociationMappings;yield d("WAWebModelStorageUtils").getStorage().lock(["message","label-association","message-association"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=Array.from(c);var f=[d("WAWebSchemaMessage").getMessageTable().bulkRemove(a)];a=d("WAWebDBQueryAndRemoveLocalLabelAssociation").queryAndRemoveLocalLabelAssociation(a.map(function(a){return{associationId:a,type:d("WAWebSchemaLabelAssociation").LabelAssociationType.Message}}));f.push(a);if(e.length>0&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){d("WALogger").LOG(m());a=d("WAWebDBDeleteAssociatedMsgsByMsgKey").bulkDeleteMessagesByMsgKeyAndAssociationType(e);f.push(a)}try{d("WAWebBotGating").isBotReceiveEnabled()&&(g.length>0&&(d("WALogger").LOG(l()),yield d("WAWebDBStoreRevokeMsgs").findAndDeleteAssociatedPluginMsg(g)))}catch(a){d("WALogger").ERROR(k(),a.name,a.stack).devConsole(a).sendLogs("Plugin carousel delete failed")}return(h||(h=b("Promise"))).all(f)});return function(b){return a.apply(this,arguments)}}());return{deleteMsgIdsSet:c,msgRowIds:a.msgRowIds}});return function(b){return a.apply(this,arguments)}}()).then(function(a){var b=a.deleteMsgIdsSet;a=a.msgRowIds;a.length>0&&d("WAWebFtsLightClient").ftsLightClient.purge(a)["catch"](c("WAWebNoop"));return b}).then(function(a){a=Array.from(a);d("WALogger").DEV(j(),String(a.length));void d("WAWebDBReportingTokenUtils").handleDeleteReportingInfos(a,{removeWholeRow:!0})})["catch"](function(a){d("WALogger").ERROR(i(),a);throw a})});return n.apply(this,arguments)}function e(a){a=a.filter(function(a){return a.includes("status@broadcast")});return a.length>0?d("WAWebSchemaMessage").getMessageTable().bulkRemove(a):(h||(h=b("Promise"))).resolve()}g.removeMessagesFromHistory=a;g.removeStatusMessage=e}),98);
__d("WAWebDBMsgUtils",["$InternalEnum","WANullthrows","WAWebApiChat","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebE2EProtoUtils","WAWebLid1X1MigrationGating","WAWebMsgKey","WAWebSchemaMessage","WAWebWid","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum")({Message:1,MessageEdit:2});function a(a,b){return d("WAWebSchemaMessage").getMessageTable().bulkGet(a).then(function(a){return a.filter(Boolean).map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a,b)})})}function e(a,b){var e=[];a.forEach(function(a){var d=new(c("WAWebMsgKey"))({fromMe:!0,remote:b,id:a});e.push(d.toString());d=new(c("WAWebMsgKey"))({fromMe:!1,remote:b,id:a});e.push(d.toString())});return d("WAWebSchemaMessage").getMessageTable().startsWithAnyOf(["id"],e)}function i(a,b){var e;a instanceof c("WAWebMsgKey")?e=a.toString():e=a;return d("WAWebSchemaMessage").getMessageTable().get(e).then(function(a){return!a?null:d("WAWebDBMessageSerialization").messageFromDbRow(a,b)})}function f(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=(yield i(a,b));if(e)return e;e=a instanceof c("WAWebMsgKey")?a:c("WAWebMsgKey").from(a);if(e.remote.isUser()){a=(yield d("WAWebApiChat").getMatChat_DEPRECATED(e.remote));e=new(c("WAWebMsgKey"))({fromMe:e.fromMe,remote:a,id:e.id});d("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("incrementPnhCtwaDailyCount",{chatId:a});return i(e,b)}});return j.apply(this,arguments)}function k(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(b.length===0)return b;var e=b;d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&c("WAWebWid").isUser(a)&&!c("WAWebWid").isLid(a)&&(e=b.map(function(b){var c=b.timestamp;b=b.key;var d={};c!=null&&(d.timestamp=c);b!=null&&(d.key=babelHelpers["extends"]({},b,{remoteJid:a}));return d}));e=e.map(function(a){return d("WAWebE2EProtoUtils").protobufToMsgKey(c("WANullthrows")(a.key)).toString()});var f=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet(e,!1));return b.filter(function(a,b){return f[b]!=null})});return l.apply(this,arguments)}function m(a){return d("WAWebSchemaMessage").getMessageTable().bulkGet(a,!1).then(function(a){return a.map(Boolean)})}function n(a){return d("WAWebSchemaMessage").getMessageTable().between(["internalId"],d("WAWebDBMessageUtils").beginningOfChat(a),d("WAWebDBMessageUtils").endOfChat(a))}g.PendingReadReceiptType=h;g.getMsgsByMsgKey=a;g.getMsgsByMsgIdsAndChatId=e;g.getMsgByMsgKey=i;g.getMsgByMsgKeyMat=f;g.filterReceivedMessagesInRange=k;g.getMsgsExistByMsgKey=m;g.getMsgsByChatId=n}),98);
__d("WAWebDBMarkFutureproofMessagesReparsed",["WALogger","WAWebMsgType","WAWebSchemaMessage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["markFutureproofMessagesReparsed: error ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["markFutureproofMessagesReparsed: update "," messages"]);i=function(){return a};return a}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{if(a.length===0)return;a=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet(a));a=a.filter(Boolean).filter(function(a){return a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN});if(a.length===0)return;d("WALogger").DEV(i(),String(a.length));a=a.map(function(a){return{id:a.id.toString(),futureproofReparsed:!0}});yield d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(a)}catch(a){d("WALogger").ERROR(h(),a);throw a}});return j.apply(this,arguments)}g.markFutureproofMessagesReparsed=a}),98);
__d("WAWebDBProcessEditProtocolMsgs",["$InternalEnum","Promise","WAAckLevel","WALogger","WANullthrows","WATimeUtils","WAWeb-dexie","WAWebAddonQueryUtils","WAWebApiChat","WAWebBackendApi","WAWebBotGating","WAWebDBMarkFutureproofMessagesReparsed","WAWebDBMessageSerialization","WAWebDBMsgUtils","WAWebDBReportingTokenUtils","WAWebDBStoreMessageOrphans","WAWebFtsLightClient","WAWebLidMigrationUtils","WAWebMessageEditGatingUtils","WAWebMessageEditUtils","WAWebModelStorageUtils","WAWebMsgGetters","WAWebMsgKeyUtils","WAWebMsgType","WAWebNoop","WAWebUserPrefsMeUser","WAWebWid","asyncToGeneratorRuntime","lodash"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] add unread mention."]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] remove unread mention."]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] updating unread chats"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] updating message rows"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] message has been updated by a newer edit. Will skip updating the message row."]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] storing orphan edit protocol messages"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] processing edit protocol messages"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] protocol msg does not have a valid sender timestamp"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] sender is not the parent msg sender"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] protocol msg exceeds edit window, will be dropped"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] original message cannot be a forwarded message"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] original message msgId::"," type is "," which cannot be edited"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] protocol msg is missing original msg key"]);u=function(){return a};return a}var v=b("$InternalEnum").Mirrored(["Added","Removed"]);function a(a,b){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b===void 0&&(b=!1);if(a.length===0)return[];d("WALogger").DEV(o()).devConsole({protocolMsgs:a});var e=(yield d("WAWebAddonQueryUtils").getParentMsgsByMsgKey(a.map(function(a){return a.protocolMessageKey}).filter(Boolean))),f=z(a,e),g=[],h=[];f.sort(function(a,b){return c("WANullthrows")(b.latestEditSenderTimestampMs)-c("WANullthrows")(a.latestEditSenderTimestampMs)});for(f of f){var i=f.protocolMessageKey&&e.get(f.protocolMessageKey.toString());!i||i.type===d("WAWebMsgType").MSG_TYPE.CIPHERTEXT?g.push(f):h.push(I(i,f))}yield A(g);i=h.filter(function(a){return a.isLatest});yield x(h,i);b&&(yield d("WAWebDBMarkFutureproofMessagesReparsed").markFutureproofMessagesReparsed(a.map(function(a){return a.id.toString()})));return i});return w.apply(this,arguments)}function x(a,b){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a.length&&(yield C(a),E(a.filter(function(a){return a.isLatest&&!d("WAWebMsgGetters").getIsNewsletterMsg(a.parentMsg)}).map(function(a){return a.parentMsg})),yield J(a)),b.length&&d("WAWebBackendApi").frontendFireAndForget("updateEditedMessagesAction",{messageEdits:b})});return y.apply(this,arguments)}function z(a,b){return a.filter(function(a){var e=a.protocolMessageKey;if(!e){d("WALogger").ERROR(u()).devConsole(a).sendLogs("message-edit-missing-original-msg-key");return!1}e=b.get(e.toString());if(e){var f=d("WAWebMessageEditUtils").msgTypeSupportsEditing(e.type)||e.type===d("WAWebMsgType").MSG_TYPE.CIPHERTEXT;if(!f){d("WALogger").ERROR(t(),e.id,e.type).devConsole({parentMsg:e,protocolMsg:a}).sendLogs("message-edit-unsupported-msg-type");return!1}if(e.isForwarded===!0){d("WALogger").ERROR(s()).devConsole({parentMsg:e,protocolMsg:a}).sendLogs("message-edit-forwarded-message");return!1}f=c("WANullthrows")(e.t);var g=c("WANullthrows")(a.t);if(!d("WAWebMessageEditUtils").isParentWithinEditProcessingWindow({parentTsInSeconds:f,editTsInSeconds:g,msgKey:e.id})){d("WALogger").WARN(r()).devConsole({protocolMsg:a,parentTsInSeconds:f,editTsInSeconds:g});return!1}f=d("WAWebMsgGetters").getSender(e);g=d("WAWebMsgGetters").getSender(a);if(!d("WAWebMsgGetters").getIsNewsletterMsg(e)&&(!f||!g||!c("WAWebWid").equals.apply(c("WAWebWid"),d("WAWebLidMigrationUtils").toCommonAddressingMode(f,g)))){d("WALogger").ERROR(q()).devConsole({protocolMsg:a,parentMsgSender:f,protocolMsgSender:g}).sendLogs("message-edit-sender-mismatch");return!1}}if(a.latestEditSenderTimestampMs==null){d("WALogger").ERROR(p()).devConsole({protocolMsg:a}).sendLogs("message-edit-missing-timestamp");return!1}return!0})}function A(a){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!a.length)return;d("WALogger").DEV(n()).devConsole({protocolMsgs:a});yield d("WAWebDBStoreMessageOrphans").storeMessageOrphans(a,function(a){return a.protocolMessageKey})});return B.apply(this,arguments)}function C(a){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!a.length)return;var c=[];yield d("WAWebModelStorageUtils").getStorage().lock(["message","chat"],function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var f=e[0];e=e[1];var g=[],i=new Set();a.forEach(function(a){var b=a.parentMsg,e=a.editedMsgData,f=a.isLatest,h=a.protocolMsg;if(!f){d("WALogger").DEV(m()).devConsole({messageEdit:a});return}g.push(babelHelpers["extends"]({},b,e));if(!d("WAWebMsgGetters").getIsSentByMe(h)){f=h.id.remote.toString();i.add(f)}c.push(b.id.toString())});var j=[];g.length&&(d("WALogger").DEV(l()).devConsole({editedMsgs:g}),j.push(f.bulkCreateOrMerge(g.map(d("WAWebDBMessageSerialization").dbRowFromMessage))));if(i.size){f=Array.from(i).map(function(a){return{id:a,unreadEditTimestampMs:d("WATimeUtils").unixTimeMs()}});d("WALogger").DEV(k()).devConsole({unreadChatUpdates:f});j.push(e.bulkCreateOrMerge(f))}yield (h||(h=b("Promise"))).all(j)});return function(a){return e.apply(this,arguments)}}());void d("WAWebDBReportingTokenUtils").handleDeleteReportingInfos(c,{removeWholeRow:!1})});return D.apply(this,arguments)}function E(a){if(!a.length)return;var e=c("lodash").uniq(a.map(function(a){return String(c("WANullthrows")(a.rowId))}));d("WAWebFtsLightClient").ftsLightClient.purge(e)["catch"](c("WAWebNoop"));c("WAWeb-dexie").ignoreTransaction(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebFtsLightClient").ftsLightClient.addToIndexingTable(e),d("WAWebFtsLightClient").ftsLightClient.index()["catch"](c("WAWebNoop"))}))}function F(a,b){return d("WAWebMsgGetters").getIsNewsletterMsg(a)&&!d("WAWebUserPrefsMeUser").isMeAccount(b.from)||a.type===d("WAWebMsgType").MSG_TYPE.EVENT_CREATION}function G(a,b){if(d("WAWebMsgGetters").getIsSentByMe(a)){if(a.local===!0)return F(a,b)?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.CLOCK;return d("WAWebMsgKeyUtils").isNoteToSelf(a.id)?d("WAAckLevel").ACK.READ:d("WAAckLevel").ACK.SENT}return void 0}var H=new Map();function I(a,b){var e=Boolean(b.matchedText)||Boolean(b.description)||Boolean(b.title),f={latestEditMsgKey:b.latestEditMsgKey,latestEditSenderTimestampMs:b.latestEditSenderTimestampMs,errorCode:b.errorCode,ack:G(a,b),pendingReadReceipt:d("WAWebMsgGetters").getIsSentByMe(a)?void 0:d("WAWebDBMsgUtils").PendingReadReceiptType.MessageEdit},g=c("WANullthrows")(d("WAWebMessageEditUtils").getMsgEditType(a.type),"Unsupported message type for edits"),h,i,j;switch(g){case d("WAWebMessageEditUtils").MsgEditType.TextEdit:h=babelHelpers["extends"]({},f,{subtype:e?"url":void 0,body:b.body,mentionedJidList:b.mentionedJidList,groupMentions:b.groupMentions,title:b.title,description:b.description,matchedText:b.matchedText,inviteGrpType:b.inviteGrpType,thumbnail:b.thumbnail,richPreviewType:b.richPreviewType,doNotPlayInline:b.doNotPlayInline,thumbnailDirectPath:(e=b.thumbnailDirectPath)!=null?e:void 0,thumbnailSha256:(e=b.thumbnailSha256)!=null?e:void 0,thumbnailEncSha256:(e=b.thumbnailEncSha256)!=null?e:void 0,thumbnailHeight:(e=b.thumbnailHeight)!=null?e:void 0,thumbnailWidth:(e=b.thumbnailWidth)!=null?e:void 0,mediaKey:b.mediaKey,mediaKeyTimestamp:b.mediaKeyTimestamp,botPluginSearchUrl:b.botPluginSearchUrl,botPluginSearchProvider:b.botPluginSearchProvider,botPluginReferenceIndex:b.botPluginReferenceIndex,botPluginType:b.botPluginType,botPluginMaybeParent:b.botPluginMaybeParent,botReelPluginThumbnailCdnUrl:b.botReelPluginThumbnailCdnUrl,botPluginSearchQuery:b.botPluginSearchQuery});break;case d("WAWebMessageEditUtils").MsgEditType.CaptionEdit:i=babelHelpers["extends"]({},f,{caption:b.caption,mentionedJidList:b.mentionedJidList,groupMentions:b.groupMentions,isCaptionByUser:!0});break;case d("WAWebMessageEditUtils").MsgEditType.EventEdit:j=babelHelpers["extends"]({},f,{eventName:b.eventName,eventDescription:b.eventDescription,eventLocation:b.eventLocation,eventStartTime:b.eventStartTime,eventEndTime:b.eventEndTime,eventJoinLink:b.eventJoinLink,isEventCanceled:b.isEventCanceled});break}e=c("WANullthrows")((f=(e=h)!=null?e:i)!=null?f:j);d("WAWebMsgGetters").getIsSentByMe(a)&&(b.count!=null&&(e.count=b.count));f=(f=(f=H.get(a.id.toString()))!=null?f:a.latestEditSenderTimestampMs)!=null?f:0;var k=c("WANullthrows")(b.latestEditSenderTimestampMs);f=k>=f;if(g===d("WAWebMessageEditUtils").MsgEditType.EventEdit){var l=Boolean(a.isEventCanceled),m=Boolean(b.isEventCanceled);!l&&m?f=!0:l&&!m&&(f=!1)}f&&H.set(a.id.toString(),k);var n;if(g!==d("WAWebMessageEditUtils").MsgEditType.EventEdit&&!d("WAWebMsgGetters").getIsSentByMe(a)){l=d("WAWebMsgGetters").getHasMentionOfMe(a);m=d("WAWebMsgGetters").getHasMentionOfMe(babelHelpers["extends"]({},a,e));l&&!m?n=v.Removed:!l&&m&&(n=v.Added)}d("WAWebBotGating").isBotReceiveEnabled()&&(d("WAWebMsgGetters").getIsMetaBotResponse(a)||a.botEditType!=null)&&(e.botEditType=b.botEditType,e.botEditTargetId=b.botEditTargetId);return{parentMsg:a,protocolMsg:b,editedMsgData:e,isLatest:f,mentionOfMe:n}}function J(a){return K.apply(this,arguments)}function K(){K=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebMessageEditGatingUtils").receiveCaptionEditEnabled())return;var b=new Map(),c=new Map();for(a of a){var e=a.parentMsg,f=a.mentionOfMe,g=e.id.remote.toString();if(!f)continue;switch(f){case v.Removed:f=e.id.toString();var h=b.get(g);h||(h=[],b.set(g,h));h.push(f);break;case v.Added:h=c.get(g);h||(h=[],c.set(g,h));f={id:e.id.toString(),timestamp:e.t};h.push(f)}}b.size&&(d("WALogger").DEV(j()).devConsole(b),yield d("WAWebApiChat").removeUnreadMentionChat(b));c.size&&(d("WALogger").DEV(i()).devConsole(c),yield d("WAWebApiChat").addUnreadMentionChat(c))});return K.apply(this,arguments)}g.EditedMentionOfMe=v;g.processEditProtocolMsgs=a;g.updateMessageEditsLocally=x;g.generateMessageEdit=I}),98);
__d("WAWebAssociationProcessorConstants",[],(function(a,b,c,d,e,f){a=Object.freeze({Regular:"Regular",WithDetachedMessages:"WithDetachedMessages"});f.AssociationProcessorType=a}),66);
__d("WAWebCreateAssociationProcessor",["WAWebAssociationProcessorConstants"],(function(a,b,c,d,e,f,g){function a(a){return babelHelpers["extends"]({},a,{processorType:d("WAWebAssociationProcessorConstants").AssociationProcessorType.WithDetachedMessages})}g.createAssociationMsgProcessorWithDetachedMessages=a}),98);
__d("WAWebMessageAssociation.flow",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["UNKNOWN","MEDIA_ALBUM"]);f.MessageAssociationType=a}),66);
__d("WAWebAlbumAssociationProcessor",["WAWebCreateAssociationProcessor","WAWebMessageAssociation.flow","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){a=d("WAWebCreateAssociationProcessor").createAssociationMsgProcessorWithDetachedMessages({type:d("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_ALBUM,viewMode:d("WAWebViewMode.flow").ViewModeType.MEDIA_ALBUM});b=a;g["default"]=b}),98);
__d("WAWebUnknownAssociationProcessor",["WAWebAssociationProcessorConstants","WAWebMessageAssociation.flow","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){a={type:d("WAWebMessageAssociation.flow").MessageAssociationType.UNKNOWN,viewMode:d("WAWebViewMode.flow").ViewModeType.HIDDEN,processorType:d("WAWebAssociationProcessorConstants").AssociationProcessorType.Regular};b=a;g["default"]=b}),98);
__d("WAWebAssociationProcessor",["WAWebAlbumAssociationProcessor","WAWebUnknownAssociationProcessor"],(function(a,b,c,d,e,f,g){var h=[c("WAWebAlbumAssociationProcessor"),c("WAWebUnknownAssociationProcessor")];function a(a){var b=a.associationType;return(a=h.find(function(a){return a.type===b}))!=null?a:null}function b(a){var b;return(b=h.find(function(b){return b.type===a}))!=null?b:null}g.getAssociationProcessor=a;g.getAssociationProcessorByAssociationType=b}),98);
__d("WAWebCommonMsgUtils",["$InternalEnum","WALogger","WAWebABProps","WAWebMsgType"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["undefined message type msgId::",""]);h=function(){return a};return a}b=b("$InternalEnum")({DEFAULT:"d",SIGNIFICANT:"s",AMBIENT:"a",NOTEWORTHY:"n",IGNORE:"i"});function a(a,b){switch(a){case d("WAWebMsgType").MSG_TYPE.GP2:case d("WAWebMsgType").MSG_TYPE.BROADCAST_NOTIFICATION:case d("WAWebMsgType").MSG_TYPE.NOTIFICATION:case d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE:case d("WAWebMsgType").MSG_TYPE.E2E_NOTIFICATION:case d("WAWebMsgType").MSG_TYPE.PINNED_MESSAGE:case d("WAWebMsgType").MSG_TYPE.NEWSLETTER_NOTIFICATION:return!0;case d("WAWebMsgType").MSG_TYPE.CALL_LOG:return!d("WAWebABProps").getABPropConfigValue("web_missed_call_notifications");case d("WAWebMsgType").MSG_TYPE.PROTOCOL:return b==="ephemeral_setting"||b==="share_phone_number"||b==="event_edit_decrypted";default:return!1}}function c(a){return a===d("WAWebMsgType").MSG_TYPE.CIPHERTEXT||a===d("WAWebMsgType").MSG_TYPE.DEBUG_PLACEHOLDER}function e(a){return a===d("WAWebMsgType").MSG_TYPE.UNKNOWN}function f(a){a.forEach(function(a){a.type===void 0&&d("WALogger").ERROR(h(),a.id).sendLogs("undefined-msg-type",{sampling:.01})})}g.EventType=b;g.isNotificationType=a;g.isPlaceholderMsg=c;g.isFutureproofMsg=e;g.logUndefinedMessage=f}),98);
__d("WAWebDBProcessMessage",["Promise","WALogger","WATimeUtils","WAWeb-dexie","WAWebApiGroupInviteV4Store","WAWebAssociationProcessor","WAWebAssociationProcessorConstants","WAWebCommonMsgUtils","WAWebDBDeleteAssociatedMsgsByMsgKey","WAWebDBMessageSerialization","WAWebDBStoreMessage","WAWebDbEncryptionKey","WAWebFtsLightClient","WAWebHandlePlaceholderWam","WAWebLinkify","WAWebMessageAssociationGatingUtils","WAWebModelStorageUtils","WAWebNoop","WAWebSchemaMessage","WAWebSyncGatingUtils","WAWebViewMode.flow","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["additional information ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error storing messages"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["storeMessages: store ",", for chat ",", isHistorySync: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateMessage: msgId::",", Previous row in message table is not a placeholder or futureproof"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["additional information ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error storing messages"]);n=function(){return a};return a}var o=function(b){babelHelpers.inheritsLoose(a,b);function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(a=c=b.call.apply(b,[this].concat(e))||this,c.name="DuplicateMessageError",a)||babelHelpers.assertThisInitialized(c)}return a}(babelHelpers.wrapNativeSuper(Error)),p=function(b){babelHelpers.inheritsLoose(a,b);function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(a=c=b.call.apply(b,[this].concat(e))||this,c.name="PreviousMsgNotUpdatableError",a)||babelHelpers.assertThisInitialized(c)}return a}(babelHelpers.wrapNativeSuper(Error));function a(a,b,c){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){f===void 0&&(f=!1);d("WALogger").DEV(k(),a.length,e,f);d("WAWebCommonMsgUtils").logUndefinedMessage(a);yield d("WAWebDbEncryptionKey").DbEncKeyStore.waitForFinalDbMsgEncKey();return(h||(h=b("Promise"))).resolve(d("WAWebDBStoreMessage").storeMessageInTransaction(a,e,f)).then(function(){d("WAWebFtsLightClient").ftsLightClient.index()["catch"](c("WAWebNoop"))})["catch"](function(b){if(b instanceof c("WAWeb-dexie").BulkError||b instanceof c("WAWeb-dexie").ConstraintError)throw new o();else{d("WALogger").WARN(j()).devConsole(b);d("WALogger").DEV(i(),a.map(function(a){return a.id.toString()})).devConsole(b);throw b}})});return q.apply(this,arguments)}function e(a,e){var f,g=e==null?(f=a[0])==null?void 0:f.id.remote:e;if(g){f=a.map(function(a){var b=d("WAWebDBMessageSerialization").dbRowFromMessage(a);return d("WAWebDBStoreMessage").addMsgMetadataToMsgRow({msg:b,chatId:g.toString(),hasLink:d("WAWebLinkify").hasHttpLink(a),pendingReadReceipt:!1})});return(h||(h=b("Promise"))).resolve(d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(f)).then(function(){d("WAWebFtsLightClient").ftsLightClient.index()["catch"](c("WAWebNoop"))})["catch"](function(b){d("WALogger").WARN(n()).devConsole(b);d("WALogger").DEV(m(),a.map(function(a){return a.id.toString()})).devConsole(b);throw b})}return(h||(h=b("Promise"))).resolve()}function f(a){return d("WAWebCommonMsgUtils").isPlaceholderMsg(a.type)?(h||(h=b("Promise"))).resolve(a):d("WAWebModelStorageUtils").getStorage().lock(["message"],function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var e=(yield b.get(a.id.toString()));if(!e)throw c("err")("[messaging] updateMessage: msgId::"+a.id.toString()+", Failed to find previous message row in message table");if(!d("WAWebCommonMsgUtils").isPlaceholderMsg(e.type)&&!d("WAWebCommonMsgUtils").isFutureproofMsg(e.type)){d("WALogger").LOG(l(),a.id.toString()).tags("messaging");throw new p()}var f=a.from,g=babelHelpers["extends"]({},a);e.t!=null&&(g.t=e.t);e.ack>a.ack&&(g.ack=e.ack);f=d("WAWebDBStoreMessage").addMsgMetadataToMsgRow({msg:d("WAWebDBMessageSerialization").dbRowFromMessage(g),chatId:f.toString(),hasLink:d("WAWebLinkify").hasHttpLink(g),rowId:void 0,inChatMsgId:void 0,pendingReadReceipt:e.pendingReadReceipt});f.rowId=e.rowId;f.internalId=e.internalId;if(f.rowId==null||f.internalId==null)throw c("err")("[messaging] updateMessage: msgId::"+a.id.toString()+", missing rowId or internalId");yield b.createOrReplace(f);d("WAWebCommonMsgUtils").isPlaceholderMsg(e.type)&&void d("WAWebHandlePlaceholderWam").populatePlaceholderWam([d("WAWebDBMessageSerialization").messageFromDbRow(e)]);d("WAWebFtsLightClient").ftsLightClient.index()["catch"](c("WAWebNoop"));return g});return function(a){return e.apply(this,arguments)}}())}function r(a){return d("WAWebSchemaMessage").getMessageTable().bulkGet(a).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=[];a=a.filter(Boolean).map(function(a){var b={id:a.id,isStarred:d("WAWebSyncGatingUtils").shouldPopulateStarMessageWithTimestamp()?a.t:a.rowId},e=a.associationType;if(e!=null&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){var f=d("WAWebAssociationProcessor").getAssociationProcessorByAssociationType(e);f&&f.processorType===d("WAWebAssociationProcessorConstants").AssociationProcessorType.WithDetachedMessages&&(c.push([a.id,e]),b=babelHelpers["extends"]({},b,{associationType:null,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,parentMsgKey:null}))}return b});a=[d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(a)];c.length&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&a.push(d("WAWebDBDeleteAssociatedMsgsByMsgKey").bulkDeleteMessagesByMsgKeyAndAssociationType(c));yield (h||(h=b("Promise"))).all(a);return});return function(b){return a.apply(this,arguments)}}())}function s(a){return d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(a.map(function(a){return{id:a,isStarred:void 0}}))}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield (h||(h=b("Promise"))).all(a.map(function(a){return d("WAWebApiGroupInviteV4Store").persistGroupInviteV4Msg(a.id.toString(),{id:a.id.toString(),from:a.from.toString(),to:a.to.toString(),groupId:a.inviteGrp,expiration:parseInt(a.inviteCodeExp,10),expired:d("WATimeUtils").unixTime()>=parseInt(a.inviteCodeExp,10)})}));return h.resolve()});return u.apply(this,arguments)}g.DuplicateMessageError=o;g.PreviousMsgNotUpdatableError=p;g.storeMessages=a;g.updateExistingMessages=e;g.updateMessage=f;g.starMessages=r;g.unstarMessages=s;g.processGroupInviteMessages=t}),98);
__d("WAWebLastAddOnDBSerialization",["WANullthrows"],(function(a,b,c,d,e,f,g){function a(a){switch(a.type){case"reaction":return{type:"reaction",msgKey:a.msgKey,parentMsgKey:a.parentMsgKey,reactionText:a.reactionText,sender:a.sender,timestamp:a.timestamp};case"poll_vote":return{type:"poll_vote",msgKey:a.msgKey,parentMsgKey:a.parentMsgKey,sender:a.sender,timestamp:a.timestamp};case"comment":return{type:"comment",msgKey:a.msgKey,parentMsgKey:a.parentMsgKey,sender:a.sender,timestamp:a.timestamp};case"event_response":return{type:"event_response",msgKey:a.msgKey,parentMsgKey:a.parentMsgKey,sender:a.sender,timestamp:a.timestamp,eventResponse:a.eventResponse}}}function b(a){return{msgKey:a.msgKey,parentMsgKey:a.parentMsgKey,sender:a.senderUserJid,reactionText:a.reactionText,timestamp:a.timestamp,isOrphan:a.orphan===1,type:"reaction"}}function d(a,b){return{msgKey:a.msgKey.toString(),isOrphan:b,selectedOptionsCount:a.selectedOptionLocalIds.length,parentMsgKey:a.parentMsgKey.toString(),sender:a.sender.toString(),timestamp:a.senderTimestampMs,type:"poll_vote"}}function e(a){return{msgKey:a.msgKey,parentMsgKey:a.parentMsgKey,sender:a.sender,timestamp:a.t*1e3,isOrphan:!1,type:"comment"}}function f(a){return{msgKey:a.msgKey,parentMsgKey:a.parentMsgKey,sender:a.senderUserJid,timestamp:a.timestamp,reactionText:c("WANullthrows")(a.reactionText),type:"reaction"}}g.lastAddOnPreviewFromCandidate=a;g.lastAddOnPreviewCandidateFromReactionRowType=b;g.lastAddOnPreviewCandidateFromVoteData=d;g.lastAddOnPreviewCandidateFromCommentRowType=e;g.lastAddOnPreviewFromDeprecatedLastReactionPreview=f}),98);
__d("WAWebDBProcessPollUpdateMsgs",["Promise","WAWebBackendApi","WAWebDBMarkFutureproofMessagesReparsed","WAWebDBPollsGetParentMessages","WAWebDBPollsUpsertVotes","WAWebDBStoreMessageOrphans","WAWebDBUpdateLastAddOnPreviewChat","WAWebLastAddOnDBSerialization","WAWebPollsExtractVotes","WAWebShouldUpdateLastAddOnPreview","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return[];a=(yield d("WAWebDBPollsGetParentMessages").getParentMessages(a));var c=a.pollUpdateMsgsToParentMsgs,e=a.orphans;for(a of c.entries()){var f=a[0],g=a[1];g.pollInvalidated&&c["delete"](f)}g=(yield (h||(h=b("Promise"))).all([b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(e.length===0)return;yield d("WAWebDBStoreMessageOrphans").storeMessageOrphans(e,function(a){return a.pollUpdateParentKey});var a=e.map(function(a){return a.id.toString()});yield d("WAWebDBMarkFutureproofMessagesReparsed").markFutureproofMessagesReparsed(a)})(),b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(c.size===0)return;var a=(yield d("WAWebDBPollsUpsertVotes").upsertVotesDb(yield d("WAWebPollsExtractVotes").extractVotes(c)));yield d("WAWebBackendApi").frontendSendAndReceive("upsertVotesModelCollection",{votes:a,votesToRemove:null,restoredFromDb:!1});var b=a.map(function(a){return a.msgKey.toString()});yield d("WAWebDBMarkFutureproofMessagesReparsed").markFutureproofMessagesReparsed(b);b=(yield d("WAWebShouldUpdateLastAddOnPreview").filterChatsWithAddOnPreviewUpdates(a.map(function(a){return d("WAWebLastAddOnDBSerialization").lastAddOnPreviewCandidateFromVoteData(a,!1)})));b.size>0&&(yield d("WAWebDBUpdateLastAddOnPreviewChat").updateDatabaseForLastAddOnPreview(b),d("WAWebBackendApi").frontendFireAndForget("updateChatLastAddOnPreview",{chatMap:b}));return a})()]));f=g[1];return(a=f)!=null?a:[]});return i.apply(this,arguments)}g.processPollUpdateMsgs=a}),98);
__d("WAWebDBProcessReplyMsgs",["WALogger","WANullthrows","WAWebDBMessageSerialization","WAWebDBMsgUtils","WAWebGroupType","WAWebMessageEditGatingUtils","WAWebMessageEditUtils","WAWebModelStorageUtils","WAWebMsgGetters","WAWebMsgKey","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","lodash"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[reply-messages] updating reply messages with inconsistent quoted content"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[reply-messages] validating reply messages with editable quoted messages"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[reply-messages] found inconsistent quoted content"]);j=function(){return a};return a}function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebMessageEditGatingUtils").processReplyMessagesEnabled()||!a.length)return;var e=(yield d("WAWebModelStorageUtils").getStorage().lock(["message"],function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var e=new Set();a.forEach(function(a){e.add(l(a).toString())});var f=(yield d("WAWebDBMsgUtils").getMsgsByMsgKey(Array.from(e.values()))).filter(function(a){a=d("WAWebMessageEditUtils").getMsgEditType(a.type);if(!a)return!1;switch(a){case d("WAWebMessageEditUtils").MsgEditType.TextEdit:return d("WAWebMessageEditGatingUtils").receiveTextEditEnabled();case d("WAWebMessageEditUtils").MsgEditType.CaptionEdit:return d("WAWebMessageEditGatingUtils").receiveCaptionEditEnabled();case d("WAWebMessageEditUtils").MsgEditType.EventEdit:return!0}}),g=new Map(f.map(function(a){return[a.id.toString(),a]}));f=a.filter(function(a){return g.has(l(a).toString())});if(!f.length)return;d("WALogger").DEV(i()).devConsole({replyMsgIds:f.map(function(a){return a.id.id}),quotedMsgIds:f.map(function(a){return a.quotedStanzaID})});var j=[];f.forEach(function(a){var b=c("WANullthrows")(g.get(l(a).toString()));a.quotedMsg==null?j.push(babelHelpers["extends"]({},a,{quotedMsg:b})):n(c("WANullthrows")(a.quotedMsg),b)&&j.push(babelHelpers["extends"]({},a,{quotedMsg:b}))});if(!j.length)return;d("WALogger").DEV(h()).devConsole({replyMsgIds:j.map(function(a){return a.id.id})});yield b.bulkCreateOrMerge(j.map(d("WAWebDBMessageSerialization").dbRowFromMessage));return j});return function(a){return e.apply(this,arguments)}}()));(e==null?void 0:e.length)&&e.forEach(function(b){var d=c("WANullthrows")(a.find(function(a){return a.id.equals(b.id)}));d.quotedMsg=b.quotedMsg})});return k.apply(this,arguments)}function l(a){var b,e;b=(b=a.quotedParticipant)!=null?b:void 0;e=(e=a.quotedRemoteJid)!=null?e:a.id.remote;return new(c("WAWebMsgKey"))({id:c("WANullthrows")(a.quotedStanzaID),fromMe:d("WAWebUserPrefsMeUser").isMeAccount(b),remote:e,participant:d("WAWebMsgGetters").getIsGroupMsg(a)||(b==null?void 0:b.isBot())?b:void 0})}var m={inviteGrpType:d("WAWebGroupType").GroupType.DEFAULT,thumbnail:"",body:"",caption:"",interactiveAnnotations:[],scanLengths:[],staticUrl:"",pageCount:0};function n(a,b){var e,f=(e=c("lodash")).pickBy(a,function(a){return a!=null}),g=e.pickBy(b,function(a,b){return Object.prototype.hasOwnProperty.call(f,b)});e.defaults(f,m);e.defaults(g,m);if(c("lodash").isEqual(f,g))return!1;d("WALogger").DEV(j()).devConsole({expected:g,received:f,quotedMsgContent:a,originalQuotedMsg:b});return!0}g.processReplyMsgs=a;g.createQuotedMsgKey=l}),98);
__d("WAWebHandleMessageTypes.flow",[],(function(a,b,c,d,e,f){a=Object.freeze({ReportingInfo:"reporting_info"});f.MsgAdditionalInfoType=a}),66);
__d("WAWebDBReportingTokenUtils",["Promise","WALogger","WATimeUtils","WAWebGetMessageCache","WAWebHandleMessageTypes.flow","WAWebMessagingGatingUtils","WAWebMsgKey","WAWebSchemaReportingInfo","WAWebSchemaReportingToken","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error deleting reporting infos"]);i=function(){return a};return a}var j=-1;function a(a){var b,e=a.reportingTokenInfo;if(e==null)return null;var f=e.reportingTag;e=e.version;var g=a.t;if(f==null||g==null)return null;b=(b=(b=a.protocolMessageKey)==null?void 0:b.toString())!=null?b:a.id.toString();a={msgKey:b,stanzaId:c("WAWebMsgKey").from(b).id,msgTs:g,receivedTs:d("WATimeUtils").unixTimeMs(),reportingTag:f};e!=null&&(a.version=e);return a}function e(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("WAWebSchemaReportingInfo").getReportingInfoTable().equals(["msgKey","msgTs"],[a,b]))[0];if(b!=null)return{reportingTag:b.reportingTag,reportingToken:b.reportingToken,version:b.version};b=(yield d("WAWebSchemaReportingToken").getReportingTokenTable().get(a));return b!=null?{reportingTag:b.reportingTag,version:b.version}:null});return k.apply(this,arguments)}function f(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebSchemaReportingInfo").getReportingInfoTable().equals(["msgKey"],a)});return l.apply(this,arguments)}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a==null||a<=j)return;if(a===0){yield (h||(h=b("Promise"))).all([d("WAWebSchemaReportingToken").getReportingTokenTable().clear(),d("WAWebSchemaReportingInfo").getReportingInfoTable().clear()]);return}a=d("WATimeUtils").unixTimeMs()-a*d("WATimeUtils").DAY_MILLISECONDS;var c=(yield d("WAWebSchemaReportingToken").getReportingTokenTable().lessThan(["ts"],a));a=(yield d("WAWebSchemaReportingInfo").getReportingInfoTable().lessThan(["receivedTs"],a));yield (h||(h=b("Promise"))).all([d("WAWebSchemaReportingToken").getReportingTokenTable().bulkRemove(c.map(function(a){return a.id})),d("WAWebSchemaReportingInfo").getReportingInfoTable().bulkRemove(a.map(function(a){return a.id}))])});return n.apply(this,arguments)}function o(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a<=j)return;a=d("WATimeUtils").unixTimeMs()-a*d("WATimeUtils").DAY_MILLISECONDS;a=(yield d("WAWebSchemaReportingInfo").getReportingInfoTable().lessThan(["receivedTs"],a));a=a.map(function(a){return babelHelpers["extends"]({},a,{reportingToken:null,reportingTokenContentOpaqueData:null,version:null})});yield d("WAWebSchemaReportingInfo").getReportingInfoTable().bulkCreateOrReplace(a)});return p.apply(this,arguments)}function q(a){var b=a.msgKey,c=a.stanzaId,e=a.msgTs;a=a.incomingMsgReportingTokenInfo;if(!d("WAWebMessagingGatingUtils").isReportingTokenReceivingEnabled())return;if(a==null)return;a=a.reportingTag;if(a==null)return;d("WAWebGetMessageCache").getMessageCache().addAdditionalInfo({type:d("WAWebHandleMessageTypes.flow").MsgAdditionalInfoType.ReportingInfo,data:{msgKey:b.toString(),stanzaId:c,reportingTag:a,msgTs:e,receivedTs:d("WATimeUtils").unixTimeMs()}},!0)}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a.sort(function(a,b){return((a=a.ts)!=null?a:0)-((a=b.ts)!=null?a:0)});var b=a.map(function(a){return a.id}),c=(yield d("WAWebSchemaReportingToken").getReportingTokenTable().bulkGet(b)),e=new Map(),f=new Set();a.forEach(function(a,b){b=c[b];if((b==null||b.reportingTag==null)&&!f.has(a.id))e.set(a.id,a);else{a.reportingTag;b=babelHelpers.objectWithoutPropertiesLoose(a,["reportingTag"]);e.set(a.id,babelHelpers["extends"]({},e.get(a.id),b))}f.add(a.id)});yield d("WAWebSchemaReportingToken").getReportingTokenTable().bulkCreateOrMerge(Array.from(e.values()))});return s.apply(this,arguments)}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebSchemaReportingInfo").getReportingInfoTable().bulkCreate(a)});return u.apply(this,arguments)}function v(a,b){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{if(a.length===0)return;if(b.removeWholeRow)return d("WAWebSchemaReportingInfo").getReportingInfoTable().bulkRemoveByIndex(["msgKey"],a);b=(yield d("WAWebSchemaReportingInfo").getReportingInfoTable().equals(["msgKey"],a));if(b.length===0)return;a=b.map(function(a){return babelHelpers["extends"]({},a,{reportingToken:null,reportingTokenContentOpaqueData:null,version:null})});yield d("WAWebSchemaReportingInfo").getReportingInfoTable().bulkCreateOrReplace(a)}catch(a){d("WALogger").LOG(i()).devConsole(a)}});return w.apply(this,arguments)}g.DEFAULT_RT_CLEANUP_OLDER_THAN_DAYS=j;g.msgToReportingInfoRow=a;g.getReportingInfoFromMsg=e;g.getReportingInfosFromMsg=f;g.cleanupReportingTable=m;g.cleanupReportingTokenAndContent=o;g.maybeStoreReportingTag=q;g.handleAddReportingTokenInfos=r;g.handleAddReportingInfos=t;g.handleDeleteReportingInfos=v}),98);
__d("WAPromiseMap",["Promise"],(function(a,b,c,d,e,f){"use strict";var g;function a(a,c){return(g||(g=b("Promise"))).resolve(a).then(function(a){return(g||(g=b("Promise"))).all(a.map(function(a,b){return c(a,b)}))})}f.promiseMap=a}),66);
__d("WAWebDBStoreMsgsUtils",[],(function(a,b,c,d,e,f){var g=1e9;function a(a,b){b===void 0&&(b=!1);return a.all({reverse:!b,limit:1,index:["rowId"],returnKeyType:"keys"}).then(function(a){return a.length===0?g:a[0]})}f.INLINE_MESSAGE_STARTING_INDEX=g;f.getLastRowId=a}),66);
__d("WAWebDBStoreEncryptedMsgs",["Promise","WALogger","WAPromiseMap","WAWeb-dexie","WAWebABProps","WAWebDBMessageUtils","WAWebDBMsgUtils","WAWebDBStoreMessage","WAWebDBStoreMsgsUtils","WAWebFtsLightClient","WAWebMessageAssociationGatingUtils","WAWebModelStorageUtils","WAWebMsgKey","WAWebNoop","WAWebPostIncomingMessageDropMetric","WAWebWidFactory","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: failed to log bad message properties: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: message prop '","' is a function and cannot be cloned: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: failed to post db error metrics: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: all "," message(s) are already in the DB"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: dropping "," out of "," message(s): ",", due to DB error: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: BulkError in bulkCreate for history sync msgs, retrying with bulk create or replace"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[storeEncryptedMessage][lastChatMsgId] lastInChatMsgIdMap with key "," is null or not a number with value "," before calculation"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: perform fallback for "," out of original "," messages"]);p=function(){return a};return a}var q=function(){};function a(a,e,f,g){f===void 0&&(f=!1);g===void 0&&(g=!1);return d("WAWebModelStorageUtils").getStorage().lock(["message","message-association"],function(){var i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(i){var j=i[0];i=i[1];var k=a;if(g){var l=(yield d("WAWebDBMsgUtils").getMsgsExistByMsgKey(a.map(function(a){a=a[0];return a.id.toString()})));k=a.filter(function(a,b){return!l[b]});d("WALogger").WARN(p(),k.length,a.length);if(k.length===0)return}var m=(yield d("WAWebDBStoreMsgsUtils").getLastRowId(j,f)),q=new Map();yield (h||(h=b("Promise"))).all(e.map(function(a){var b=d("WAWebWidFactory").createWid(a);a=d("WAWebDBMessageUtils").beginningOfChat(b);var c=d("WAWebDBMessageUtils").endOfChat(b);return j.between(["internalId"],a,c,{limit:1,reverse:!f,returnKeyType:"keys"}).then(function(a){a=a.length===0?d("WAWebDBStoreMsgsUtils").INLINE_MESSAGE_STARTING_INDEX:d("WAWebDBMessageUtils").getInChatMsgId(a[0]);q.set(b.toString(),a)})}));var u=f?-1:1;k=(yield d("WAPromiseMap").promiseMap(k,function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=a[0];a=a[1];f&&(e.isMdHistoryMsg=!0);var g=c("WAWebMsgKey").fromString(e.id),h=g.remote.toString();b=m+u*(b+1);var i=q.get(h);if(i==null||Number.isNaN(i)){d("WALogger").DEV(o(),h,i).sendLogs("history-sync-nanerror-check-lastinchatmsgidmap-lastChatMsgId");return}i=i+u*1;q.set(h,i);g=!f&&d("WAWebDBStoreMessage").isPendingUnreadReceipt(g,e);e=d("WAWebDBStoreMessage").addMsgMetadataToMsgRow({msg:e,chatId:h,hasLink:a,rowId:b,inChatMsgId:i,pendingReadReceipt:g});return e});return function(b,c){return a.apply(this,arguments)}}())).filter(Boolean);try{if(d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){var v=k.filter(function(a){return a.associationType!=null}).map(function(a){return{msgKey:a.id.toString(),parentMsgKey:a.parentMsgKey.toString(),associationType:a.associationType,msgKeyInternalId:a.internalId}});v.length&&(yield i.bulkCreate(v))}yield j.bulkCreateWith_ALREADY_ENCRYPTED_RECORDS_ONLY(k)}catch(b){if(f&&b instanceof c("WAWeb-dexie").BulkError)d("WALogger").ERROR(n()),yield j.bulkCreateOrReplace_ALREADY_ENCRYPTED_RECORDS_ONLY(k);else{(g||!r(a.length,b))&&(s(k,b),t(k));throw b}}return k});return function(a){return i.apply(this,arguments)}}()).then(function(a){a&&a.length>0&&c("WAWeb-dexie").ignoreTransaction(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebFtsLightClient").ftsLightClient.addToIndexingTable(a.map(function(a){return a.rowId!=null?String(a.rowId):null}).filter(Boolean));var b=d("WAWebABProps").getABPropConfigValue("web_fts_indexer_mem_leak_fix_enabled")?q:c("WAWebNoop");d("WAWebFtsLightClient").ftsLightClient.index()["catch"](b)}))})}function r(a,b){return a>1&&b instanceof c("WAWeb-dexie").BulkError}function s(a,e){c("WAWeb-dexie").ignoreTransaction(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=a;if(e instanceof c("WAWeb-dexie").BulkError){var f=a.map(function(a){a=a.id;return a.toString()}),g=(yield d("WAWebDBMsgUtils").getMsgsExistByMsgKey(f));b=a.filter(function(a,b){return!g[b]})}b.length>0?(d("WALogger").WARN(m(),b.length,a.length,b.map(function(a){a=a.id;return a}),e),d("WAWebPostIncomingMessageDropMetric").postIncomingMessageDropDBOperationFailedForMsgRows(b)):d("WALogger").WARN(l(),a.length)}))["catch"](function(a){d("WALogger").ERROR(k(),a).sendLogs("failed-to-post-db-error-metrics")})}function t(a){if(c("gkx")("26258"))return;var b=function(a){var b=new Set(),c=function a(c,e){Object.entries(c).forEach(function(c){var f=c[0];c=c[1];if(typeof c==="function"){var g=[].concat(e,[f]).join(".");d("WALogger").WARN(j(),g,c)}else if(c!=null&&typeof c==="object"){if(b.has(c))return;b.add(c);a(c,[].concat(e,[f]))}})};c(a,[])};try{a.forEach(b)}catch(a){d("WALogger").WARN(i(),a)}}g.storeEncryptedDBMessages=a;g.isEligibleForFallback=r}),98);
__d("WAWebDBStoreMessage",["Promise","WAJids","WALogger","WAPromiseMap","WAWeb-dexie","WAWebCommonMsgUtils","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebDBMsgUtils","WAWebLinkify","WAWebModelStorageUtils","WAWebMsgDataUtils","WAWebMsgGetters","WAWebMsgKey","WAWebMsgType","WAWebNewsletterDBUtils","WAWebSchemaFtsIndexingQueue","WAWebSyncGatingUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": completed in ","ms"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": completed in ","ms"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": "," in ","ms"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["",": start"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[process-msg] craftMessageRangeIndex failed with error ",""]);m=function(){return a};return a}var n=1e9;function o(a){return a.some(function(a){return a.type!==d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE})}function a(a,e,f){f===void 0&&(f=!1);var g=e==null?a[0].id.remote:e,i=d("WAWebDBMessageUtils").beginningOfChat(g),j=d("WAWebDBMessageUtils").endOfChat(g),k=s("storeMessageInTransaction: "+a.length+" message(s), chat "+((g==null?void 0:g.toString())||"-"));return d("WAWebModelStorageUtils").getStorage().lock(["chat","message"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(c){var e=c[0];c=c[1];k.addStage("got table lock");var l=(yield e.get(g.toString()));k.addStage("got chat");if(!g.isStatus()&&(l!=null||o(a))){l=q(l,a,g);yield e.createOrMerge(g.toString(),l)}k.addStage("got messages meta");e=c.all({reverse:!f,limit:1,index:["rowId"],returnKeyType:"keys"}).then(function(a){k.addStage("got boundary row id");return a.length===0?n:a[0]});l=c.between(["internalId"],i,j,{limit:1,reverse:!f,returnKeyType:"keys"}).then(function(a){k.addStage("got chat msg boundary id");return a.length===0?n:d("WAWebDBMessageUtils").getInChatMsgId(a[0])});e=(yield (h||(h=b("Promise"))).all([e,l]));l=e[0];e=e[1];k.addStage("got boundaries");var m=f?l-a.length:l+1,s=f?e-a.length:e+1,t=(yield d("WAPromiseMap").promiseMap(a,function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=d("WAWebDBMessageSerialization").dbRowFromMessage(a),e=!f&&p(a.id,a);return r({msg:c,chatId:g.toString(),hasLink:d("WAWebLinkify").hasHttpLink(a),rowId:m+b,inChatMsgId:d("WAWebMsgGetters").getIsNewsletterMsg(a)?(c=a.serverId)!=null?c:yield d("WAWebNewsletterDBUtils").getTemporaryServerId(g):s+b,pendingReadReceipt:e})});return function(b,c){return a.apply(this,arguments)}}()));k.addStage("messages ready for storing in db");return c.bulkCreate(t).then(function(){return t})});return function(a){return c.apply(this,arguments)}}()).then(function(a){k.done(),c("WAWeb-dexie").ignoreTransaction(function(){d("WAWebSchemaFtsIndexingQueue").getFtsIndexingQueueTable().bulkCreateOrReplace(a.map(function(a){return{id:String(a.rowId)}}))})})}function p(a,b){if(a.fromMe||a.remote.isStatus())return!1;a=d("WAWebMsgDataUtils").eventTypeFromMsgType(b);return a===d("WAWebCommonMsgUtils").EventType.AMBIENT||a===d("WAWebCommonMsgUtils").EventType.DEFAULT}function q(a,b,c){var e,f=void 0,g=Math.max(0,(e=a==null?void 0:a.unreadCount)!=null?e:0),h=(e=a==null?void 0:a.unreadMentionsOfMe)!=null?e:[];b.forEach(function(a){var b=d("WAWebMsgDataUtils").eventTypeFromMsgType(a);if(b===d("WAWebCommonMsgUtils").EventType.IGNORE)return;a&&a.t!=null&&((f==null||a.t>f)&&(f=a.t));(b===d("WAWebCommonMsgUtils").EventType.AMBIENT||b===d("WAWebCommonMsgUtils").EventType.DEFAULT)&&!a.id.fromMe&&(g+=1);b=p(a.id,a);if(b&&d("WAWebMsgGetters").getIsImportantMessage(a)){b={id:a.id.toString(),timestamp:a.t};h.push(b)}});a&&a.t!=null&&((f==null||a.t>f)&&(f=a.t));return{id:c.toString(),unreadCount:g,t:f,unreadMentionsOfMe:h}}function r(a){var b=a.msg,e=a.chatId,f=a.hasLink,g=a.rowId,h=a.inChatMsgId;a=a.pendingReadReceipt;var i=[d("WAWebMsgType").MSG_TYPE.IMAGE,d("WAWebMsgType").MSG_TYPE.VIDEO,d("WAWebMsgType").MSG_TYPE.AUDIO].includes(b.type),j=d("WAWebSyncGatingUtils").shouldPopulateStarMessageWithTimestamp()?b.t:g;f=babelHelpers["extends"]({},b,{vcardWAids:b.vcardWAids||d("WAWebDBMessageUtils").getVcardWids(b),id:b.id.toString(),isStarred:b.star?j:void 0,hasLink:b.type==="chat"&&f?g:void 0,isMediaMsg:i?g:void 0,isDocMsg:b.type===d("WAWebMsgType").MSG_TYPE.DOCUMENT?g:void 0,isCarouselMsg:b.carouselCardsParsed!=null?g:void 0,isEventMsg:b.type===d("WAWebMsgType").MSG_TYPE.EVENT_CREATION?g:void 0,expiredTimestamp:(j=d("WAWebMsgGetters").getEphemeralExpirationTimestamp(b))!=null?j:void 0});g!=null&&(f.rowId=g);h!=null&&(f.internalId=d("WAWebDBMessageUtils").craftInternalId(e,h));a&&e!==d("WAJids").STATUS_JID&&(f.pendingReadReceipt=d("WAWebDBMsgUtils").PendingReadReceiptType.Message);i=b.c2sTimestamp;if(b.id.fromMe){i=(j=b.c2sTimestamp)!=null?j:b.t}else i=b.t;try{b.type!==d("WAWebMsgType").MSG_TYPE.REACTION&&(f.messageRangeIndex=d("WAWebDBMessageUtils").craftMessageRangeIndex(e,!c("WAWebMsgKey").fromString(b.id).fromMe,d("WAWebMsgType").SYSTEM_MESSAGE_TYPES.includes(b.type),i))}catch(a){d("WALogger").ERROR(m(),a)}return f}function s(a){d("WALogger").DEV(l(),a);var b=5e3,c=Date.now(),e=[];return{addStage:function(a){e.push([a,Date.now()-c])},done:function(){if(Date.now()-c>b){for(var f of e){var g=f[0],h=f[1];d("WALogger").DEV(k(),a,g,h)}d("WALogger").WARN(j(),a,Date.now()-c)}else d("WALogger").DEV(i(),a,Date.now()-c)}}}g.storeMessageInTransaction=a;g.isPendingUnreadReceipt=p;g.addMsgMetadataToMsgRow=r}),98);
__d("WAWebDBAssociatedMsgsAttachDetachAPI",["$InternalEnum","WALogger","WAWebAssociationProcessor","WAWebAssociationProcessorConstants","WAWebBackendApi","WAWebDBGetAssociatedMsgsByParentMsgKey","WAWebMessageAssociationGatingUtils","WAWebSchemaMessage","WAWebViewMode.flow","asyncToGeneratorRuntime","nullthrows"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateViewModeOfAssociatedMsgsByParentMsgKeys: Found associated messages"]);h=function(){return a};return a}var i=b("$InternalEnum").Mirrored(["Attach","Detach"]);function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield k(a.map(function(a){return a.id})));a=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet(a.map(function(a){return a.msgKey.toString()}),!1));a=m(a.filter(Boolean),i.Attach).filter(Boolean);yield d("WAWebSchemaMessage").getMessageTable().bulkCreateOrReplace_ALREADY_ENCRYPTED_RECORDS_ONLY(a);var b=new Map();a.forEach(function(a){var d=c("nullthrows")(a.viewMode);b.set(a.id,d)});d("WAWebBackendApi").frontendFireAndForget("updateViewModeForMsgs",{msgIdsViewModeMap:b})});return j.apply(this,arguments)}function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled())return[];a=(yield d("WAWebDBGetAssociatedMsgsByParentMsgKey").bulkGetMessagesByParentMsgKey(a));a.length&&d("WALogger").LOG(h()).devConsole({associatedMsgs:a});return a});return l.apply(this,arguments)}function e(a,b){var c=[];a.map(function(a){var e=d("WAWebAssociationProcessor").getAssociationProcessorByAssociationType(a.associationType);if(e){var f=!0;b===i.Detach&&(f=(e==null?void 0:e.processorType)===d("WAWebAssociationProcessorConstants").AssociationProcessorType.WithDetachedMessages);e&&f&&c.push(a)}});return c}function m(a,b){return!d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()?[]:a.map(function(a){if(!a.associationType)return null;var c=d("WAWebAssociationProcessor").getAssociationProcessorByAssociationType(a.associationType);return c==null?null:babelHelpers["extends"]({},a,{viewMode:b===i.Detach?d("WAWebViewMode.flow").ViewModeType.VISIBLE:c.viewMode})})}g.ViewModeUpdateType=i;g.processOrphansFromAssociationsTableForNewMsg=a;g.getAssociatedMsgsByParentMsgKeyFromAssociationTable=k;g.getValidAssociatedMsgs=e;g.getViewModeUpdatedDBRowForAssociatedMsgs=m}),98);
__d("WAWebDBStoreRevokeMsgs",["Promise","WALogger","WAWebAddonProcessRevoke","WAWebApiChat","WAWebApiOrphanRevoke","WAWebBackendApi","WAWebBotGating","WAWebDBAssociatedMsgsAttachDetachAPI","WAWebDBReportingTokenUtils","WAWebFtsLightClient","WAWebLidMigrationUtils","WAWebMessageAssociationGatingUtils","WAWebModelStorageUtils","WAWebMsgGetters","WAWebMsgKey","WAWebMsgType","WAWebNoop","WAWebSchemaMessage","WAWebSchemaMessageAssociation","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["processRevokeMsg: revoke is orphan or an addon ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Store Revoked Msg: delete associated carousel revoke failed with error: ",", stack: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Store Revoked Msg: re-validate bot revoke failed with error: ",", stack: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["processRevokeMsgs: sending invalid revoke for secondary validation as bot invoker revoke"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["processRevokeMsgs: invalid revoke request ",", ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["processRevokeMsgs: admin revoke came for the different group than the original message was in"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["processRevokeMsgs: "," has not been revoked"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["processRevokeMsgs: admin revoke has to be sent to a group or newsletter chat"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["processRevokeMsgs: "," has not been revoked"]);q=function(){return a};return a}var r=20;function a(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=[],f=[],g=[],r=new Map(),s=[],u=[],v=[],w=a.filter(function(a){var b=a.revokeMsgKey,e=a.newMsgKey,f=a.subtype,g=!0;f==="admin_revoke"?!c("WAWebWid").isGroup(b.remote)&&!c("WAWebWid").isNewsletter(b.remote)?(g=!1,d("WALogger").LOG(q(),String(b)),d("WALogger").WARN(p()).sendLogs("process-admin-revoke-message")):c("WAWebWid").equals(b.remote,e.remote)||(g=!1,d("WALogger").LOG(o(),String(b)),d("WALogger").WARN(n()).sendLogs("process-admin-revoke-message")):(g=c("WAWebWid").equals.apply(c("WAWebWid"),d("WAWebLidMigrationUtils").toCommonAddressingMode(b.remote,e.remote))&&c("WAWebWid").equals.apply(c("WAWebWid"),d("WAWebLidMigrationUtils").toCommonAddressingMode(b.participant,e.participant))&&b.fromMe===e.fromMe,g||(d("WALogger").LOG(m(),String(b),String(e)),d("WAWebBotGating").isBotReceiveEnabled()&&(d("WALogger").LOG(l()),s.push(a))));return g});if(d("WAWebBotGating").isBotReceiveEnabled()&&s.length>0)try{a=s.map(function(a){return a.revokeMsgKey.toString()});a=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet(a,!1));a.forEach(function(a,b){var e=!1;b=s[b];var f=b.newMsgKey,g=b.subtype,h=b.sender;if((a==null?void 0:a.id)==null||b==null||g==="admin_revoke")return;g=c("WAWebMsgKey").from(a.id);g=g.remote;var i=a.botTargetSenderJid?d("WAWebWidFactory").createWidFromWidLike(a.botTargetSenderJid):null;if(i==null||g==null)return;var j=a.botPluginSearchUrl!=null&&a.botResponseTargetId!=null,k=!j&&a.botPluginMaybeParent===!0;g.isGroup()?c("WAWebWid").equals(i,f.participant)&&(e=!0):g.isBot()||c("WAWebWid").equals(i,h)&&(e=!0);if(e){u.push(b);f=a.internalId;g=a.botResponseTargetId;d("WAWebBotGating").isBotCarouselEnabled()&&(j||k)&&f!=null&&g!=null&&v.push({internalId:f,targetId:g})}});w.push.apply(w,u)}catch(a){d("WALogger").ERROR(k(),a.name,a.stack).devConsole(a).sendLogs("Re-validate revoke failed")}if(d("WAWebBotGating").isBotCarouselEnabled()&&v.length>0)try{yield t(v)}catch(a){d("WALogger").ERROR(j(),a.name,a.stack).devConsole(a).sendLogs("Plugin carousel delete revoke failed")}var x=[],y=[];a=(yield (h||(h=b("Promise"))).all([d("WAWebModelStorageUtils").getStorage().lock(["message","message-association"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(j){j=j[0];var k=[].concat(w.map(function(a){return a.revokeMsgKey}),w.map(function(a){return d("WAWebLidMigrationUtils").getAlternateMsgKey(a.revokeMsgKey)}),w.map(function(a){return a.newMsgKey})),l=[];if(d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){var m=(yield d("WAWebDBAssociatedMsgsAttachDetachAPI").getAssociatedMsgsByParentMsgKeyFromAssociationTable(k.filter(Boolean)));m=d("WAWebDBAssociatedMsgsAttachDetachAPI").getValidAssociatedMsgs(m,d("WAWebDBAssociatedMsgsAttachDetachAPI").ViewModeUpdateType.Detach);l=m.map(function(a){return a.msgKey})}m=[].concat(k.map(function(a){return a?a.toString():""}),l);k=(yield j.bulkGet(m,!1));var a=[];l=w.length;var n=k.slice(0,l),o=k.slice(l,l*2),p=k.slice(l*2,l*3);m=k.slice(l*3);var q=[];m!=null&&m.length&&d("WAWebDBAssociatedMsgsAttachDetachAPI").getViewModeUpdatedDBRowForAssociatedMsgs(m.filter(Boolean),d("WAWebDBAssociatedMsgsAttachDetachAPI").ViewModeUpdateType.Detach).forEach(function(a){a!=null&&q.push(a)});w.forEach(function(b,h){var j;j=(j=n[h])!=null?j:o[h];h=p[h];if(j==null){d("WALogger").LOG(i(),b.revokeMsgKey);a.push(b);return}e.push(j.id);g.push(String(j.rowId));d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&j.associationType!=null&&y.push([j.id,j.associationType]);f.push({id:b.newMsgKey.toString(),to:j.to,author:j.author,type:d("WAWebMsgType").MSG_TYPE.REVOKED,subtype:b.subtype==="admin_revoke"?"admin":"sender",revokeSender:b.sender,protocolMessageKey:j.id,protocolMessageRowId:h==null?void 0:h.rowId,from:j.from,t:j.t,rowId:j.rowId,internalId:j.internalId,messageRangeIndex:j.messageRangeIndex,revokeTimestamp:b.revokeTimestamp,disappearingModeInitiator:b.disappearingModeInitiator,ephemeralDuration:b.ephemeralDuration,ephemeralSettingTimestamp:b.ephemeralSettingTimestamp,viewMode:(h=b.viewMode)!=null?h:j.viewMode});if(d("WAWebMsgGetters").getIsImportantMessage(j)){b=c("WAWebMsgKey").fromString(j.id);h=b.remote.toString();if(r.has(h)){b=(b=r.get(h))!=null?b:[];r.set(h,[].concat(b,[j.id]))}else r.set(h,[j.id])}});k=[];e.length>0&&k.push(j.bulkRemove(e));y.length>0&&k.push(d("WAWebSchemaMessageAssociation").getMessageAssociationTable().bulkRemove(y));x.length>0&&k.push(d("WAWebSchemaMessageAssociation").getMessageAssociationTable().bulkCreateOrReplace(x));(f.length>0||q.length>0)&&k.push(j.bulkCreateOrReplace_ALREADY_ENCRYPTED_RECORDS_ONLY([].concat(f,q)));yield (h||(h=b("Promise"))).all(k);return a});return function(b){return a.apply(this,arguments)}}()),d("WAWebAddonProcessRevoke").processRevokeMsgs(w)]));var z=a[0],A=a[1];if(z.length>0){a=z.filter(function(a){return A.has(a.revokeMsgKey)}).map(function(a){return{msgKey:a.revokeMsgKey.toString(),sender:a.sender,timestamp:a.timestamp,subtype:(a=a.subtype)!=null?a:"sender_revoke"}});a.length>0&&(yield d("WAWebApiOrphanRevoke").addOrphanRevokes(a))}d("WAWebFtsLightClient").ftsLightClient.purge(g)["catch"](c("WAWebNoop"));void d("WAWebDBReportingTokenUtils").handleDeleteReportingInfos(e,{removeWholeRow:!1});r.size>0&&d("WAWebApiChat").removeUnreadMentionChat(r)});return s.apply(this,arguments)}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=[],f=[];a=a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield v(a));var b=a.pluginLinkMsgIds;a=a.pluginLinkMsgIdsRowIds;e=[].concat(e,b);f=[].concat(f,a);yield d("WAWebSchemaMessage").getMessageTable().bulkRemove(e)});return function(b){return a.apply(this,arguments)}}());yield (h||(h=b("Promise"))).all(a);d("WAWebFtsLightClient").ftsLightClient.purge(f)["catch"](c("WAWebNoop"));d("WAWebBackendApi").frontendFireAndForget("deleteAssociatedBotCarouselMsgs",{msgKeys:e})});return u.apply(this,arguments)}function v(a){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[],c=[],e=a.internalId,f=a.targetId;a=e.split("_")[0];yield d("WAWebSchemaMessage").getMessageTable().between(["internalId"],e,a+"_g",{reverse:!1,limit:r,shouldDecrypt:!1},function(a){if(a.botResponseTargetId===f)b.push(a.id),c.push(String(a.rowId));else return!0;return!1});return{pluginLinkMsgIds:b,pluginLinkMsgIdsRowIds:c}});return w.apply(this,arguments)}g.processRevokeMsgs=a;g.findAndDeleteAssociatedPluginMsg=t;g.findAssociatedPluginMsgs=v}),98);
__d("WAWebGraphQLServerError",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({INVALID_ACCESS_TOKEN:190});c=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this)||this;c.name="GraphQLServerError";c.source=b;return c}return b}(babelHelpers.wrapNativeSuper(Error));f.GraphQLErrorCode=a;f.GraphQLServerError=c}),66);
__d("WAWebRelayClient",["Promise","WAWebGraphQLServerError","WAWebRelayEnvironment","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h;function a(a){throw c("err")("Invariant Violation")}function e(a,b,c){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c=c===void 0?{}:c;var e=c.eventLogger,f=c.environmentType,g=c.accessToken,h=c.getInlineDataReader;c=babelHelpers.objectWithoutPropertiesLoose(c,["eventLogger","environmentType","accessToken","getInlineDataReader"]);var i=(yield d("WAWebRelayEnvironment").requireRelayRuntime()),j=i.fetchQuery;i=i.readInlineData;try{f=(yield d("WAWebRelayEnvironment").getEnvironment({environmentType:f,accessToken:g}));g=(yield j)(f,a,b,c).toPromise();e==null?void 0:e.success();h==null?void 0:h(i);return g}catch(a){a instanceof d("WAWebGraphQLServerError").GraphQLServerError&&(e==null?void 0:e.failure(a.source.errors));throw a}});return i.apply(this,arguments)}function f(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){e=e===void 0?{}:e;var f=e.eventLogger,g=e.environmentType,i=e.accessToken,j=e.getInlineDataReader,k=babelHelpers.objectWithoutPropertiesLoose(e,["eventLogger","environmentType","accessToken","getInlineDataReader"]);e=(yield d("WAWebRelayEnvironment").requireRelayRuntime());var l=e.commitMutation,m=e.readInlineData;try{var n=(yield d("WAWebRelayEnvironment").getEnvironment({environmentType:g,accessToken:i}));return new(h||(h=b("Promise")))(function(b,d){l(n,babelHelpers["extends"]({mutation:a,variables:c},k,{onCompleted:function(a){f==null?void 0:f.success(),j==null?void 0:j(m),b(a)},onError:function(a){d(a)}}))})}catch(a){a instanceof d("WAWebGraphQLServerError").GraphQLServerError&&(f==null?void 0:f.failure(a.source.errors));throw a}});return j.apply(this,arguments)}g.graphql=a;g.fetchQuery=e;g.commitMutation=f}),98);
__d("WAWebGraphQLConstants",[],(function(a,b,c,d,e,f){var g="https://graph.whatsapp.com/graphql/catalog";function a(){return g}b="https://graph.facebook.com/graphql";c="WA|787118555984857|7bb1544a3599aa180ac9a3f7688ba243";f.whatsappGraphqlEndpoint=a;f.FACEBOOK_GRAPHQL_ENDPOINT=b;f.WHATSAPP_GRAPHQL_ACCESS_TOKEN=c}),66);
__d("WAWebGraphQLPersistedQueries",[],(function(a,b,c,d,e,f){a={WAWebQueryCatalogHasCategoriesQuery:"5247905281934978",WAWebQueryCatalogProductQuery:"8810739255643606",WAWebQueryCatalogQuery:"9195358007159674",WAWebQueryProductCollectionsQuery:"8457326344351081",WAWebQueryProductListCatalogJobQuery:"8522454577871481",WAWebQueryProductSingleCollectionQuery:"27620504070881332",WAWebReportProductJobMutation:"8473660082655001",queryProductListCatalogQuery:"5127568407281377",WAWebBizGetCustomUrlUserGraphqlQuery:"7942225995860428",WAWebGraphQLVerifyPostcodeJobQuery:"7573183149457062",WAWebGraphQLProductCatalogGetPublicKeyJobQuery:"24765734146405491",WAWebBizGraphQLRefreshCartJobQuery:"8172715152844790"};f.PersistedQueries=a}),66);
__d("WAWebGraphQLRemapLocale",["WALogger","lodash"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Invalid json locale mapping"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Invalid json locale mapping"]);i=function(){return a};return a}function a(){var b=babelHelpers.taggedTemplateLiteralLoose(["locale format should use underscore instead of hyphen"]);a=function(){return b};return b}b=function(a,b){try{var e=JSON.parse(b);if(!c("lodash").isPlainObject(e)){d("WALogger").WARN(i());return a}return Object.keys(e).find(function(b){b=e[b];return Array.isArray(b)?b.includes(a):!1})||a}catch(b){d("WALogger").WARN(h());return a}};g.graphQLRemapLocale=b}),98);
__d("WAWebRelayEnvironment",["JSResourceForInteraction","WAWebGraphQLConstants","WAWebGraphQLPersistedQueries","WAWebGraphQLRemapLocale","WAWebGraphQLServerError","WAWebL10N","WAWebMiscGatingUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield c("JSResourceForInteraction")("relay-runtime").__setRef("WAWebRelayEnvironment").load());return{Environment:a.Environment,RecordSource:a.RecordSource,Store:a.Store,Network:a.Network,fetchQuery:a.fetchQuery,readInlineData:a.readInlineData,commitMutation:a.commitMutation}});return i.apply(this,arguments)}function j(a){switch(a){case"facebook":return d("WAWebGraphQLConstants").FACEBOOK_GRAPHQL_ENDPOINT;default:a;return d("WAWebGraphQLConstants").whatsappGraphqlEndpoint()}}function k(a){switch(a){case"facebook":return"locale";default:a;return"lang"}}function l(a){var b=a.status;a=a.statusText;throw new(d("WAWebGraphQLServerError").GraphQLServerError)({errors:[{code:b,message:a}]})}var m=new Map();function a(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e;e=(e=a.environmentType)!=null?e:"whatsapp";var f=m.get(e);if(f!=null)return f;f=(yield h());var g=f.Environment,i=f.Network,n=f.RecordSource;f=f.Store;var o={Accept:"application/json","Content-Type":"application/json"},p=function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,e){var f,g,h;f=(f=a.environmentType)!=null?f:"whatsapp";g=(g=d("WAWebGraphQLPersistedQueries").PersistedQueries[b.name])!=null?g:b.id;b=k(f);g=(h={access_token:(h=a==null?void 0:a.accessToken)!=null?h:d("WAWebGraphQLConstants").WHATSAPP_GRAPHQL_ACCESS_TOKEN,doc_id:g,variables:e},h[b]=d("WAWebGraphQLRemapLocale").graphQLRemapLocale(c("WAWebL10N").getFullLocale().replace("-","_"),d("WAWebMiscGatingUtils").getGraphqlLocaleRemapping()),h);e=(yield self.fetch(j(f),{method:"POST",headers:o,body:JSON.stringify(g)}));if(!e.ok){var i;try{i=(yield e.json())}catch(a){l(e)}if(((b=i)==null?void 0:b.error)!=null)throw new(d("WAWebGraphQLServerError").GraphQLServerError)({errors:[i.error]});else l(e)}h=(yield e.json());if((h==null?void 0:h.errors)!=null)throw new(d("WAWebGraphQLServerError").GraphQLServerError)({errors:h.errors});return h});return function(a,b){return e.apply(this,arguments)}}();g=new g({network:i.create(p),store:new f(new n())});m.set(e,g);return g});return n.apply(this,arguments)}g.requireRelayRuntime=h;g.getEnvironment=a}),98);
__d("WAWebMexNativeClient",["WACustomError","WALogger","WAWebBackendErrors","WAWebMexLogging","WAWebMexRelayEnvironment","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[MEX][","] fetch query error"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[mex][native-client] unexpected error: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[mex][native-client] infra error: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[mex][native-client] result:"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[mex][native-client] Mex native client request:"]);l=function(){return a};return a}function a(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){d("WALogger").DEV(l()).tags("mex","native-client").devConsole({operation:a,variables:b});var c=new(d("WAWebMexLogging").MexPerfTracker)(!0);c.start();try{var e=o(a),f=e.params;c.setQueryId(f.id);c.setOperationName(f.name);f={metadata:{mexPerfTracker:c}};e=(yield d("WAWebMexRelayEnvironment").fetchFunc(e.params,b,f));d("WALogger").DEV(k()).tags("mex","native-client").devConsole({result:e});b=n(e,c);c.setHasData(!0);c.stop();c.logEvent();return b.data}catch(b){b instanceof d("WAWebMexRelayEnvironment").MexIqError||b instanceof d("WAWebMexRelayEnvironment").MexPayloadParsingError||b instanceof d("WAWebMexRelayEnvironment").MexFatalExtensionError?b instanceof d("WAWebMexRelayEnvironment").MexFatalExtensionError||d("WALogger").ERROR(j(),b.message).tags("mex","native-client").devConsole({error:b}).sendLogs("mex-native-client-infra-error"):(d("WALogger").ERROR(i(),b.message).tags("mex","native-client").devConsole({error:b}).sendLogs("mex-native-client-unexpected-error"),c.setHasData(!1),c.setErrors([d("WAWebMexLogging").createLoggingClientError(417,b.message)]));c.stop();c.logEvent();b instanceof d("WAWebMexRelayEnvironment").MexFatalExtensionError||d("WALogger").ERROR(h(),a.params.name).tags("GQL","MEX").devConsole({e:b});if(b instanceof d("WAWebMexRelayEnvironment").MexFatalExtensionError){f=b.error.extensions.error_code;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(f),"MexFatalExtensionError: "+b.error.message)}if(b instanceof d("WAWebMexRelayEnvironment").MexIqError)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(b.code,"MexIqError: "+b.message);throw b}});return m.apply(this,arguments)}function n(a,b){if(a.data!=null)return{data:a.data};if(Array.isArray(a)){a="mex response is an array";b.setErrors([d("WAWebMexLogging").createLoggingClientError(472,a)]);throw new(d("WAWebMexRelayEnvironment").MexPayloadParsingError)(c("err")(a))}a="data is missing in mex response";b.setErrors([d("WAWebMexLogging").createLoggingClientError(472,a)]);throw new(d("WAWebMexRelayEnvironment").MexPayloadParsingError)(c("err")(a))}function o(a){if(a.kind==="Request")return a;throw d("WACustomError").customError("operation kind "+((a=JSON.stringify(a.kind))!=null?a:"")+" is not 'Request'",!0,Error)}g.fetchQuery=a}),98);
__d("WAWebMexClient",["WAWebMexNativeClient","WAWebRelayClient","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return d("WAWebMexNativeClient").fetchQuery(a,b)});return h.apply(this,arguments)}g.graphql=d("WAWebRelayClient").graphql;g.fetchQuery=a}),98);
__d("WAWebHandlePlaceholderMsgKeyHashUtils",["WABase64","WACryptoHmac","WAWebABProps","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=null,i=new TextEncoder(),j=function(a){return i.encode(a).buffer};function k(){h||(h=d("WAWebUserPrefsMultiDevice").getChatThreadLoggingSecretB64().then(function(a){return a==null?null:d("WABase64").decodeB64(a)}));return h}function a(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,c=(yield k());if(!c)return null;b=j(String(a.id.id+(a.id.fromMe?"1":"0")+((b=(b=a.id.remote)==null?void 0:b.toString({legacy:!0}))!=null?b:"")+((a=(b=a.id.participant)==null?void 0:b.toString({legacy:!0}))!=null?a:"")));a=(yield d("WACryptoHmac").hmacSha256(c,b));return d("WABase64").encodeB64(a)});return l.apply(this,arguments)}function c(){return d("WAWebABProps").getABPropConfigValue("placeholder_message_key_hash_logging")}g.getMessageKeyHash=a;g.messageKeyHashEnabled=c}),98);
__d("WAWebWamEnumE2eDeviceType",[],(function(a,b,c,d,e,f){a=Object.freeze({MY_PRIMARY:1,OTHER_PRIMARY:2,MY_COMPANION:3,OTHER_COMPANION:4,MY_HOSTED_COMPANION:5,OTHER_HOSTED_COMPANION:6});f.E2E_DEVICE_TYPE=a}),66);
__d("WAWebWamEnumPlaceholderAction",[],(function(a,b,c,d,e,f){a=Object.freeze({OTHER:0,ADD:1,VIEW:2,POPULATE:3});f.PLACEHOLDER_ACTION=a}),66);
__d("WAWebWamEnumPlaceholderChatType",[],(function(a,b,c,d,e,f){a=Object.freeze({OTHER:0,INDIVIDUAL:1,GROUP:2,STATUS:3,BROADCAST:4,CHANNEL:5,INTEROP:6});f.PLACEHOLDER_CHAT_TYPE=a}),66);
__d("WAWebWamEnumPlaceholderPopulationType",[],(function(a,b,c,d,e,f){a=Object.freeze({OTHER:0,RETRY:1,PEER_MESSAGE:2,RESEND:3});f.PLACEHOLDER_POPULATION_TYPE=a}),66);
__d("WAWebWamEnumPlaceholderReasonType",[],(function(a,b,c,d,e,f){a=Object.freeze({OTHER:0,SIGNAL_NO_SESSION:1,DEVICE_VERIFICATION_FAILURE:2,UNKNOWN_SELF_DEVICE:3,SIGNAL_INVALID_KEY:4,SIGNAL_INVALID_KEY_ID:5,SIGNAL_INVALID_MESSAGE:6,DEVICE_VERIFICATION_FAILURE_SELF_PEER:7,UNKNOWN_COMPANION_NO_PREKEY:8,BAD_EPHEMERAL_SETTING:9,SIGNAL_FUTURE_MESSAGE:10,SIGNAL_INVALID_SIGNATURE:11,SIGNAL_BAD_MAC:12,SIGNAL_INVALID_SESSION:13});f.PLACEHOLDER_REASON_TYPE=a}),66);
__d("WAWebWamEnumPlaceholderType",[],(function(a,b,c,d,e,f){a=Object.freeze({OTHER:0,CIPHERTEXT:1,FANOUT:2,DOWNGRADE:3,FIXED_CONTENT:4,TEMPORARY:5,DROP:6});f.PLACEHOLDER_TYPE=a}),66);
__d("WAWebPlaceholderActivityWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumAddressingMode","WAWebWamEnumE2eDeviceType","WAWebWamEnumMediaType","WAWebWamEnumMessageType","WAWebWamEnumPlaceholderAction","WAWebWamEnumPlaceholderChatType","WAWebWamEnumPlaceholderPopulationType","WAWebWamEnumPlaceholderReasonType","WAWebWamEnumPlaceholderType","WAWebWamEnumSizeBucket","WAWebWamEnumTypeOfGroupEnum"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({PlaceholderActivity:[1980,{deviceCount:[9,a.TYPES.INTEGER],deviceSizeBucket:[8,d("WAWebWamEnumSizeBucket").SIZE_BUCKET],e2eSenderType:[16,d("WAWebWamEnumE2eDeviceType").E2E_DEVICE_TYPE],isHostedChat:[19,a.TYPES.BOOLEAN],isLid:[12,a.TYPES.BOOLEAN],localAddressingMode:[20,d("WAWebWamEnumAddressingMode").ADDRESSING_MODE],messageBeforeReg:[15,a.TYPES.BOOLEAN],messageIsRevoke:[7,a.TYPES.BOOLEAN],messageKeyHash:[14,a.TYPES.STRING],messageMediaType:[6,d("WAWebWamEnumMediaType").MEDIA_TYPE],messageType:[5,d("WAWebWamEnumMessageType").MESSAGE_TYPE],participantCount:[10,a.TYPES.INTEGER],placeholderActionInd:[2,d("WAWebWamEnumPlaceholderAction").PLACEHOLDER_ACTION],placeholderAddReason:[11,d("WAWebWamEnumPlaceholderReasonType").PLACEHOLDER_REASON_TYPE],placeholderChatTypeInd:[3,d("WAWebWamEnumPlaceholderChatType").PLACEHOLDER_CHAT_TYPE],placeholderPopulationType:[17,d("WAWebWamEnumPlaceholderPopulationType").PLACEHOLDER_POPULATION_TYPE],placeholderTimePeriod:[4,a.TYPES.INTEGER],placeholderTypeInd:[1,d("WAWebWamEnumPlaceholderType").PLACEHOLDER_TYPE],typeOfGroup:[13,d("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM]},[1,1,1],"regular"]},{PlaceholderActivity:[]});g.PlaceholderActivityWamEvent=b}),98);
__d("WAWebWamGroupMetadataMetricUtils",["WAWebDBGroupsGroupMetadata","WAWebGroupType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a!=null&&a.isGroup()){a=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(a));if(a!=null)return d("WAWebGroupType").groupTypeToWamEnum(d("WAWebGroupType").getGroupTypeFromGroupMetadata(a))}});return h.apply(this,arguments)}function c(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(a));return a==null?null:j(a)});return i.apply(this,arguments)}function j(a){return d("WAWebGroupType").getGroupTypeFromGroupMetadata(a)===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP}g.getGroupTypeFromChatWid=a;g.isCagFromChatWid=c;g.isCagFromGroupMetadata=j}),98);
__d("WAWebHandlePlaceholderWam",["Promise","WATimeUtils","WAWebDBGroupsGroupMetadata","WAWebDBMessageSerialization","WAWebGroupType","WAWebHandlePlaceholderMsgKeyHashUtils","WAWebMsgGetters","WAWebPlaceholderActivityWamEvent","WAWebWamEnumPlaceholderAction","WAWebWamEnumPlaceholderChatType","WAWebWamEnumPlaceholderType","WAWebWamGroupMetadataMetricUtils","WAWebWamGroupMetricCache","WAWebWamMsgUtils","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield n(a));a.forEach(function(a){a.placeholderActionInd=d("WAWebWamEnumPlaceholderAction").PLACEHOLDER_ACTION.ADD,a.commit()})});return i.apply(this,arguments)}function e(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)});a=(yield n(a));a.forEach(function(a){a.placeholderActionInd=d("WAWebWamEnumPlaceholderAction").PLACEHOLDER_ACTION.VIEW,a.commit()})});return j.apply(this,arguments)}function f(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield n(a,!0));a.forEach(function(a){a.placeholderActionInd=d("WAWebWamEnumPlaceholderAction").PLACEHOLDER_ACTION.POPULATE,a.commit()})});return k.apply(this,arguments)}function l(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f,g=a.id.remote;f=new(d("WAWebPlaceholderActivityWamEvent").PlaceholderActivityWamEvent)({placeholderChatTypeInd:t(g),placeholderTimePeriod:Math.max(d("WATimeUtils").unixTime()-((f=a.t)!=null?f:0),0),placeholderTypeInd:a.subtype==="fanout"?d("WAWebWamEnumPlaceholderType").PLACEHOLDER_TYPE.FANOUT:d("WAWebWamEnumPlaceholderType").PLACEHOLDER_TYPE.CIPHERTEXT,messageIsRevoke:d("WAWebMsgGetters").getIsRevoke(a),messageMediaType:d("WAWebWamMsgUtils").getWamMediaType(a),messageType:d("WAWebWamMsgUtils").getWamMessageType(a)});a.placeholderAddReason!=null&&(f.placeholderAddReason=a.placeholderAddReason);e&&a.placeholderPopulationType!=null&&(f.placeholderPopulationType=a.placeholderPopulationType);a.e2eSenderType!=null&&(f.e2eSenderType=a.e2eSenderType);c("WAWebWid").isGroup(g)?yield p(f,a,b):c("WAWebWid").isUser(g)&&(f.isLid=g.isLid());yield r(f,a);return f});return m.apply(this,arguments)}function n(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){c===void 0&&(c=!1);var e=[],f=[];for(a of a)d("WAWebMsgGetters").getIsGroupMsg(a)?f.push(a):e.push(a);a=(yield d("WAWebDBGroupsGroupMetadata").bulkGetGroupMetadata(f.map(function(a){return a.id.remote}))).map(function(a,b){return[f[b],a]});return(h||(h=b("Promise"))).all([].concat(e.map(function(a){return l(a,null,c)}),a.map(function(a){var b=a[0];a=a[1];return l(b,a,c)})))});return o.apply(this,arguments)}function p(a,b,c){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=(yield d("WAWebWamGroupMetricCache").getGroupMetrics(b.id.remote));e!=null&&(e.participantCount!=null&&(a.participantCount=e.participantCount),e.deviceCount!=null&&(a.deviceCount=e.deviceCount),e.deviceSizeBucket!=null&&(a.deviceSizeBucket=e.deviceSizeBucket));if(c){e=d("WAWebWamGroupMetadataMetricUtils").isCagFromGroupMetadata(c);a.isLid=e&&d("WAWebMsgGetters").getIsReaction(b);a.typeOfGroup=d("WAWebGroupType").groupTypeToWamEnum(d("WAWebGroupType").getGroupTypeFromGroupMetadata(c))}});return q.apply(this,arguments)}function r(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(d("WAWebHandlePlaceholderMsgKeyHashUtils").messageKeyHashEnabled()){b=(yield d("WAWebHandlePlaceholderMsgKeyHashUtils").getMessageKeyHash(b));b!=null&&(a.messageKeyHash=b)}});return s.apply(this,arguments)}function t(a){if(c("WAWebWid").isGroup(a))return d("WAWebWamEnumPlaceholderChatType").PLACEHOLDER_CHAT_TYPE.GROUP;else if(c("WAWebWid").isStatus(a))return d("WAWebWamEnumPlaceholderChatType").PLACEHOLDER_CHAT_TYPE.STATUS;else if(c("WAWebWid").isBroadcast(a))return d("WAWebWamEnumPlaceholderChatType").PLACEHOLDER_CHAT_TYPE.BROADCAST;else if(c("WAWebWid").isUser(a))return d("WAWebWamEnumPlaceholderChatType").PLACEHOLDER_CHAT_TYPE.INDIVIDUAL;else if(c("WAWebWid").isNewsletter(a))return d("WAWebWamEnumPlaceholderChatType").PLACEHOLDER_CHAT_TYPE.CHANNEL;return d("WAWebWamEnumPlaceholderChatType").PLACEHOLDER_CHAT_TYPE.OTHER}g.addPlaceholderWam=a;g.viewPlaceholderWam=e;g.populatePlaceholderWam=f}),98);
__d("WABackoffUtils",["WAPromiseDelays"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c,d){d===void 0&&(d=.1);var e;a===0?e=c||0:e=Math.pow(2,a);Number.isFinite(b)&&e>b&&(e=b);typeof c==="number"&&Number.isFinite(c)&&e<c&&(e=c);d&&(e*=1+d*Math.random());return e}function a(a,b,c,e){e===void 0&&(e=.1);return d("WAPromiseDelays").delayMs(Math.floor(1e3*h(a,b,c,e)))}g.expBackoff=h;g.expDelaySec=a}),98);
__d("WAPromiseLoop",["asyncToGeneratorRuntime"],(function(a,b,c,d,e,f){"use strict";function a(a,b){return g.apply(this,arguments)}function g(){g=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=!1,d,e=function(a){c=!0,d=a},f=0;b=b;while(!c)b=(yield a(e,b,f)),f++;return d});return g.apply(this,arguments)}f.promiseLoop=a}),66);
__d("WAGetSyncAction",["WABaseGlobals"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("WABaseGlobals").runInTransaction({SyncActionStore:!0},function(a){a=a.SyncActionStore;return a.count()})}function b(a){return d("WABaseGlobals").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.get(a)})}function c(a){return d("WABaseGlobals").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.getByCollections(a)})}function e(a){return d("WABaseGlobals").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.getByIndexMacs(a)})}function f(a){return d("WABaseGlobals").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.getByActionStates(a)})}function h(a){return d("WABaseGlobals").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.getByModelInfos(a)})}function i(){return d("WABaseGlobals").runInTransaction({SyncActionStore:!0},function(a){a=a.SyncActionStore;return a.getAll()})}function j(a){return d("WABaseGlobals").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.bulkUpdate(a)})}g.countSyncActionsInTransaction=a;g.getSyncActionInTransaction=b;g.getSyncActionsByCollectionsInTransaction=c;g.getSyncActionsByIndexMacsInTransaction=e;g.getSyncActionsByActionStatesInTransaction=f;g.getSyncActionsByModelInfosInTransaction=h;g.getAllSyncActions=i;g.bulkUpdateSyncActionsInTransaction=j}),98);
__d("WACryptoLtHash",["Promise","WACryptoHkdf","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=2,j=128;a=new ArrayBuffer(j);c=function(){function a(a){this.salt=a}var c=a.prototype;c.add=function(a,c){var d=this;return c.reduce(function(a,c){return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.t0=d;e.next=3;return b("regeneratorRuntime").awrap(a);case 3:e.t1=e.sent;e.t2=c;return e.abrupt("return",e.t0.$1.call(e.t0,e.t1,e.t2));case 6:case"end":return e.stop()}},null,this)},(h||(h=b("Promise"))).resolve(a))};c.subtract=function(a,c){var d=this;return c.reduce(function(a,c){return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.t0=d;e.next=3;return b("regeneratorRuntime").awrap(a);case 3:e.t1=e.sent;e.t2=c;return e.abrupt("return",e.t0.$2.call(e.t0,e.t1,e.t2));case 6:case"end":return e.stop()}},null,this)},(h||(h=b("Promise"))).resolve(a))};c.subtractThenAdd=function(a,c,d){var e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return b("regeneratorRuntime").awrap(this.subtract(a,d));case 2:e=g.sent;g.next=5;return b("regeneratorRuntime").awrap(this.add(e,c));case 5:f=g.sent;return g.abrupt("return",{ltHash:f,subtractResult:e});case 7:case"end":return g.stop()}},null,this)};c.$1=function(a,c){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(d("WACryptoHkdf").extractAndExpand(c,this.salt,j));case 2:e=f.sent;return f.abrupt("return",this.performPointwiseWithOverflow(a,e,function(a,b){return a+b}));case 4:case"end":return f.stop()}},null,this)};c.$2=function(a,c){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(d("WACryptoHkdf").extractAndExpand(c,this.salt,j));case 2:e=f.sent;return f.abrupt("return",this.performPointwiseWithOverflow(a,e,function(a,b){return a-b}));case 4:case"end":return f.stop()}},null,this)};c.performPointwiseWithOverflow=function(a,b,c){a=new DataView(a);b=new DataView(b);var d=new ArrayBuffer(a.byteLength),e=new DataView(d);for(var f=0;f<a.byteLength;f+=i)e.setUint16(f,c(a.getUint16(f,!0),b.getUint16(f,!0)),!0);return d};return a}();e=new c("WhatsApp Patch Integrity");g.KEY_LENGTH_BYTES=j;g.EMPTY_LT_HASH=a;g.LtHash16=c;g.LT_HASH_ANTI_TAMPERING=e}),98);
__d("WAGetCollectionVersion",["Promise","WABaseGlobals","WACryptoLtHash","WATimeUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.get(a)})}function i(a,b){a=a.CollectionVersionStore;return a.get(b).then(function(a){return(a=a==null?void 0:a.ltHash)!=null?a:new ArrayBuffer(d("WACryptoLtHash").KEY_LENGTH_BYTES)})}function c(a){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return i({CollectionVersionStore:b},a)})}function e(a){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.bulkGet(a)})}function f(){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(a){a=a.CollectionVersionStore;return a.getAll()})}function j(a,b,c){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(d){d=d.CollectionVersionStore;return d.update(a,{version:b,ltHash:c})})}function k(a){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.bulkUpdate(a)})}function l(a){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.get(a).then(function(a){return a==null?void 0:a.isCollectionInMacMismatchFatal})})}function m(a){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.update(a,{isCollectionInMacMismatchFatal:!0})})}function n(a){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.get(a).then(function(a){return a==null?void 0:a.isCollectionLthashInconsistent})})}function o(a){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.update(a,{isCollectionLthashInconsistent:!0})})}function p(a){var c=function(b){return a.map(function(a){return b.update(a.collection,{lastSyncAttemptStartTimes:a.lastSyncAttemptStartTimes})})};return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(a){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:d=a.CollectionVersionStore;e.next=3;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(c(d)));case 3:case"end":return e.stop()}},null,this)})}function q(a){return d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.update(a,{lastSuccessfulSyncEndTime:d("WATimeUtils").unixTimeMs()})})}g.getCollectionVersionInTransaction=a;g.getCollectionVersionLtHash=i;g.getCollectionVersionLtHashInTransaction=c;g.bulkGetCollectionVersionsInTransaction=e;g.getAllCollectionVersionsInTransaction=f;g.updateCollectionVersionAndLtHashInTransaction=j;g.bulkUpdateCollectionVersionInTransaction=k;g.getIsCollectionInMacMismatchFatalInTransaction=l;g.updateIsCollectionInMacMismatchFatalInTransaction=m;g.getIsCollectionLthashInconsistentInTransaction=n;g.updateIsCollectionLthashInconsistentInTransaction=o;g.bulkSetCollectionSyncAttemptStartTimesInTransaction=p;g.updateLastSuccessfulSyncEndTimeInTransaction=q}),98);
__d("WAGetMissingKey",["WABaseGlobals"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("WABaseGlobals").runInTransaction({MissingKeyStore:!0},function(a){a=a.MissingKeyStore;return a.getAll()})}function b(a){return d("WABaseGlobals").runInTransaction({MissingKeyStore:!0},function(b){b=b.MissingKeyStore;return b.bulkGet(a)})}function c(){return d("WABaseGlobals").runInTransaction({MissingKeyStore:!0},function(a){a=a.MissingKeyStore;return a.count()})}function e(a){return d("WABaseGlobals").runInTransaction({MissingKeyStore:!0},function(b){b=b.MissingKeyStore;return b.bulkUpdate(a)})}g.getAllMissingKeysInTransaction=a;g.bulkGetMissingKeysInTransaction=b;g.getMissingKeyCountTransaction=c;g.bulkUpdateMissingKeysInTransaction=e}),98);
__d("WAGetPendingMutation",["WABaseGlobals"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("WABaseGlobals").runInTransaction({PendingMutationStore:!0},function(b){b=b.PendingMutationStore;return b.getByCollection(a)})}function b(){return d("WABaseGlobals").runInTransaction({PendingMutationStore:!0},function(a){a=a.PendingMutationStore;return a.getAll()})}function c(a){return d("WABaseGlobals").runInTransaction({PendingMutationStore:!0},function(b){b=b.PendingMutationStore;return b.bulkCreate(a)})}g.getSyncPendingMutationsByCollectionInTransaction=a;g.getAllSyncPendingMutationsInTransaction=b;g.bulkCreateSyncPendingMutationsInTransaction=c}),98);
__d("WASyncdCryptoConst",[],(function(a,b,c,d,e,f){"use strict";a="WhatsApp Mutation Keys";b=160;c=32;d=32;e=32;var g=32,h=32,i=c,j=i+d,k=j+e,l=k+g,m=l+h,n="0x01",o="0x02",p=0,q=32,r=8,s=16,t=new ArrayBuffer(q);f.HKDF_INFO=a;f.DERIVED_KEY_LENGTH=b;f.INDEX_KEY_LENGTH=c;f.VALUE_ENCRYPTION_KEY_LENGTH=d;f.VALUE_MAC_KEY_LENGTH=e;f.SNAPSHOT_MAC_KEY_LENGTH=g;f.PATCH_MAC_KEY_LENGTH=h;f.INDEX_KEY_END=i;f.VALUE_ENCRYPTION_KEY_END=j;f.VALUE_MAC_KEY_END=k;f.SNAPSHOT_MAC_KEY_END=l;f.PATCH_MAC_KEY_END=m;f.OPERATION_SET_HEX=n;f.OPERATION_REMOVE_HEX=o;f.MAX_OF_MIN_DATA_LENGTH=p;f.MAC_LENGTH=q;f.OCTET_LENGTH=r;f.IV_LENGTH=s;f.EMPTY_MUTATION_MAC=t}),66);
__d("WASyncdCryptoHelper",["WACryptoHkdf","WASyncdCryptoConst","WASyncdKeyTypes","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(h(a));case 2:c=e.sent;return e.abrupt("return",{indexKey:c.slice(0,d("WASyncdCryptoConst").INDEX_KEY_END),valueEncryptionKey:c.slice(d("WASyncdCryptoConst").INDEX_KEY_END,d("WASyncdCryptoConst").VALUE_ENCRYPTION_KEY_END),valueMacKey:c.slice(d("WASyncdCryptoConst").VALUE_ENCRYPTION_KEY_END,d("WASyncdCryptoConst").VALUE_MAC_KEY_END),snapshotMacKey:c.slice(d("WASyncdCryptoConst").VALUE_MAC_KEY_END,d("WASyncdCryptoConst").SNAPSHOT_MAC_KEY_END),patchMacKey:c.slice(d("WASyncdCryptoConst").SNAPSHOT_MAC_KEY_END,d("WASyncdCryptoConst").PATCH_MAC_KEY_END)});case 4:case"end":return e.stop()}},null,this)}function h(a){return d("WACryptoHkdf").extractAndExpand(d("WASyncdKeyTypes").fromSyncKeyData(a),d("WASyncdCryptoConst").HKDF_INFO,d("WASyncdCryptoConst").DERIVED_KEY_LENGTH)}g.generateEncryptionKeysUnmemoized=a}),98);
__d("WASyncdCryptoUtils",["WACryptoUtils","WASyncdKeyTypes","WATextEncoding","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(a.length===0)throw c("err")("buffers length is zero");if(a.length===1)return a[0];var b=a.map(function(a){return a.byteLength});b=b.reduce(function(a,b){return a+b});b=new Uint8Array(b);var d=0,e;for(e=0;e<a.length;e++)b.set(new Uint8Array(a[e]),d),d+=a[e].byteLength;return b.buffer}function b(a,b,d){if(b<0||d<0)throw c("err")("buffers length is zero");var e=new Array(3);a=new Uint8Array(a);e[0]=a.slice(0,b).buffer;e[1]=a.slice(b,b+d).buffer;e[2]=a.slice(b+d).buffer;return e}function e(a){return Uint8Array.from(a.split(" ").map(function(a){return parseInt(a,16)}))}function f(a){return Array.from(new Uint8Array(d("WASyncdKeyTypes").fromSyncKeyId(a))).map(function(a){return a.toString(16)}).toString().replace(/,/g," ")}function h(a){return Array.from(new Uint8Array(a)).map(function(a){return a.toString(16).padStart(2,"0")}).join("")}function i(a){var b=new ArrayBuffer(8);new DataView(b).setUint32(4,a,!1);return b}var j=d("WATextEncoding").newTextEncoder();function k(a){return j.encode(a)}function l(a,b){return d("WACryptoUtils").arrayBuffersEqual(d("WASyncdKeyTypes").fromSyncKeyId(a),d("WASyncdKeyTypes").fromSyncKeyId(b))}g.combine=a;g.split=b;g.hexToUint8Array=e;g.syncKeyIdToHex=f;g.arrayBufferToHexPadded=h;g.to64BitNetworkOrder=i;g.toUtf8=k;g.syncKeyIdsEqual=l}),98);
__d("WASyncdCrypto",["WABase64","WACryptoAesCbc","WACryptoDependencies","WACryptoHmac","WAMemoizeCache","WAServerSync.pb","WASyncdCryptoConst","WASyncdCryptoHelper","WASyncdCryptoUtils","WASyncdKeyTypes","err"],(function(a,b,c,d,e,f,g){"use strict";var h=d("WAMemoizeCache").memoizeWithArgs(d("WASyncdCryptoHelper").generateEncryptionKeysUnmemoized,function(a){return d("WABase64").encodeB64(d("WASyncdKeyTypes").fromSyncKeyData(a))});function a(a,b){return d("WACryptoHmac").hmacSha256(new Uint8Array(a),new Uint8Array(b))}function b(a,b){b=d("WASyncdKeyTypes").fromSyncKeyId(b);var e;switch(a){case d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET:e=d("WASyncdCryptoConst").OPERATION_SET_HEX;break;case d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE:e=d("WASyncdCryptoConst").OPERATION_REMOVE_HEX;break}if(e){a=new Uint8Array([parseInt(e,16)]).buffer;var f=new Uint8Array(a.byteLength+b.byteLength);f.set(new Uint8Array(a));f.set(new Uint8Array(b),a.byteLength);return f.buffer}else throw c("err")("invalid mutation operation value")}function e(a,b){a=Math.max(0,d("WASyncdCryptoConst").MAX_OF_MIN_DATA_LENGTH-a-b);b=new Uint8Array(a);d("WACryptoDependencies").getCrypto().getRandomValues(b);return b.buffer}function f(a,b,c){return d("WACryptoAesCbc").aesCbcEncrypt(b,c,a)}function i(a,b,c){var e=new Uint8Array(d("WASyncdCryptoConst").OCTET_LENGTH);e.set([a.byteLength],e.byteLength-1);a=d("WASyncdCryptoUtils").combine([a,b,e.buffer]);return d("WACryptoHmac").hmacSha512(c,a,d("WASyncdCryptoConst").MAC_LENGTH)}function j(a,b,c){return d("WACryptoAesCbc").aesCbcDecrypt(b,a,c)}function k(a,b,c,e){return d("WACryptoHmac").hmacSha256(a,d("WASyncdCryptoUtils").combine([b,c,e]))}function l(a,b,c,e,f){return d("WACryptoHmac").hmacSha256(a,d("WASyncdCryptoUtils").combine([b].concat(c,[e,f])))}function m(a){var b=a.byteLength;return new Uint8Array(a).slice(b-d("WASyncdCryptoConst").MAC_LENGTH).buffer}g.generateEncryptionKeys=h;g.generateIndexMac=a;g.generateAssociatedData=b;g.generatePadding=e;g.generateCipherText=f;g.generateMac=i;g.decryptCipherText=j;g.generateSnapshotMac=k;g.generatePatchMac=l;g.valueMacFromIndexAndValueCipherText=m}),98);
__d("WASyncdError",[],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="SyncdMissingKeyError",b)||babelHelpers.assertThisInitialized(c)}return b}(babelHelpers.wrapNativeSuper(Error));b=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){var d;d=a.call(this,b)||this;d.name="SyncdRetryableError";d.backoff=c;d.message=b;return d}return b}(babelHelpers.wrapNativeSuper(Error));c=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this,b)||this;c.name="SyncdFatalError";c.message=b;return c}return b}(babelHelpers.wrapNativeSuper(Error));f.SyncdMissingKeyError=a;f.SyncdRetryableError=b;f.SyncdFatalError=c}),66);
__d("WAGetSyncKey",["WABaseGlobals"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("WABaseGlobals").runInTransaction({SyncKeyStore:!0},function(b){b=b.SyncKeyStore;return b.get(a)})}function b(){return d("WABaseGlobals").runInTransaction({SyncKeyStore:!0},function(a){a=a.SyncKeyStore;return a.getAll()})}function c(a){return d("WABaseGlobals").runInTransaction({SyncKeyStore:!0},function(b){b=b.SyncKeyStore;return b.set(a)})}function e(a){return d("WABaseGlobals").runInTransaction({SyncKeyStore:!0},function(b){b=b.SyncKeyStore;return b.expire(a)})}g.getSyncKeyInTransaction_DO_NOT_USE=a;g.getAllSyncKeysInTransaction=b;g.setSyncKeyInTransaction=c;g.expireSyncKeyInTransaction=e}),98);
__d("WASyncdKeyCache",["WABase64","WAGetSyncKey","WASyncdKeyTypes","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map();function a(a){var c,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:e=d("WABase64").encodeB64(d("WASyncdKeyTypes").fromSyncKeyId(a));f=h.get(e);if(!f){g.next=4;break}return g.abrupt("return",f.keyData);case 4:g.next=6;return b("regeneratorRuntime").awrap(d("WAGetSyncKey").getSyncKeyInTransaction_DO_NOT_USE(a));case 6:f=g.sent;f&&h.set(e,f);return g.abrupt("return",(c=f)==null?void 0:c.keyData);case 9:case"end":return g.stop()}},null,this)}function c(){h=new Map()}g.getKeyData=a;g.clearSyncKeysCache=c}),98);
__d("WASyncdMetricFatalError",["$InternalEnum","WALogger","WAPREList","WAPREMetrics","WASyncdConst"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown error code: "," for syncd fatal error"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing error code for syncd fatal error"]);i=function(){return a};return a}var j=b("$InternalEnum").Mirrored(["PATCH_PROTOBUF_SERIALIZATION_FAILED","MUTATIONS_PROTOBUF_SERIALIZATION_FAILED","ACTION_DATA_PROTOBUF_SERIALIZATION_FAILED","ENCRYPTION_FAILED","MISSING_SNAPSHOT_VERSION","MISSING_SNAPSHOT_MAC","MISSING_SNAPSHOT_KEY_ID","MISSING_PATCH_VERSION","PATCH_WITH_BOTH_INLINE_AND_EXTERNAL_MUTATIONS","MISSING_PATCH_SNAPSHOT_MAC","MISSING_PATCH_MAC","MISSING_PATCH_KEY_ID","MISSING_EXTERNAL_BLOB_REFERENCE_MEDIA_KEY","MISSING_EXTERNAL_BLOB_REFERENCE_DIRECT_PATH","MISSING_EXTERNAL_BLOB_REFERENCE_FILE_SHA256","MISSING_EXTERNAL_BLOB_REFERENCE_FILE_ENC_SHA256","MISSING_MUTATION_OPERATION","MISSING_MUTATION_RECORD","MISSING_MUTATION_INDEX","MISSING_MUTATION_VALUE","MISSING_MUTATION_KEY_ID","EXTERNAL_BLOB_REFERENCE_PROTOBUF_DESERIALIZATION_FAILED","SNAPSHOT_PROTOBUF_DESERIALIZATION_FAILED","PATCH_PROTOBUF_DESERIALIZATION_FAILED","MUTATIONS_PROTOBUF_DESERIALIZATION_FAILED","ACTION_DATA_PROTOBUF_DESERIALIZATION_FAILED","MISSING_ACTION_INDEX","MISSING_ACTION_VERSION","SNAPSHOT_MAC_MISMATCH_IN_SNAPSHOT","SNAPSHOT_MAC_MISMATCH_IN_PATCH","MAC_MISMATCH_PATCH","DECRYPTION_FAILED","DUPLICATE_PATCH_VERSION_IN_COLLECTION","SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_PATCH","SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_SNAPSHOT","MISSING_ACTION_VALUE","MISSING_ACTION_TIMESTAMP","XMPP_BAD_REQUEST_FOR_COLLECTION","XMPP_NOT_FOUND_FOR_COLLECTION","CYCLIC_MUTATION_DEPENDENCY_IN_PATCH","SERVER_DID_NOT_SEND_ALL_PATCHES","TERMINAL_PATCH_MISSING_DATA","TERMINAL_PATCH_DESERIALIZATION_ERROR","TERMINAL_PATCH_UNKNOWN","INVALID_ACTION_INDEX","XMPP_BAD_REQUEST_GLOBAL_ERROR","XMPP_NOT_FOUND_GLOBAL_ERROR","XMPP_BAD_METHOD_GLOBAL_ERROR","XMPP_NOT_ACCEPTABLE_GLOBAL_ERROR","TOO_MANY_INTERNAL_SERVER_ERRORS_IN_7D","TIMEOUT_WHILE_WAITING_FOR_MISSING_KEY","MISSING_KEY_ON_ALL_CLIENTS"]);function a(a,b,c,e,f,g,h,i,j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C){d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_FATAL_ERROR).endFail("syncd fatal error: "+a,k({type:a,collection:b,patchSnapshotMutationCount:c,patchVersion:e,isFatal:f,isLtHashConsistent:g,macFatalCollectionNameMismatch:h,macFatalCurrentLthashMismatch:i,macFatalNewLthashMismatch:j,macFatalPatchVersionMismatch:l,macFatalNewLthashSubtractMismatch:m,macFatalNumberHasOverrideMutation:n,macFatalNumberNumAddMutation:o,macFatalNumberNumRemoveMutation:p,macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch:q,isPatchSenderPrimary:r,macFatalDidUseMacFetchFallback:s,macFatalHasMissingRemove:t,macFatalNumberAddMismatch:u,macFatalNumberRemoveMismatch:v,macFatalDidPreviousPatchFailPostSaveValidation:w,macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash:x,isPreviousPatchAnIncomingPatch:y,isLastPatchSenderAPrimaryDevice:z,isSenderIndexSameAsPreviousSenderIndex:A,didBootstrapFromSnapshot:B,isThereAnotherSyncdCompanion:C}))}function k(a){var b=a.type,c=a.collection,d=a.patchSnapshotMutationCount,e=a.patchVersion,f=a.isFatal,g=a.isLtHashConsistent,h=a.macFatalCollectionNameMismatch,i=a.macFatalCurrentLthashMismatch,j=a.macFatalNewLthashMismatch,k=a.macFatalPatchVersionMismatch,l=a.macFatalNewLthashSubtractMismatch,m=a.macFatalNumberHasOverrideMutation,n=a.macFatalNumberNumAddMutation,o=a.macFatalNumberNumRemoveMutation,p=a.macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch,q=a.isPatchSenderPrimary,r=a.macFatalDidUseMacFetchFallback,s=a.macFatalHasMissingRemove,t=a.macFatalNumberAddMismatch,u=a.macFatalNumberRemoveMismatch,v=a.macFatalDidPreviousPatchFailPostSaveValidation,w=a.macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash,x=a.isPreviousPatchAnIncomingPatch,y=a.isLastPatchSenderAPrimaryDevice,z=a.isSenderIndexSameAsPreviousSenderIndex,A=a.didBootstrapFromSnapshot;a=a.isThereAnotherSyncdCompanion;return{string:{errorCode:b,collection:c==null?null:c},"int":{patchSnapshotMutationCount:d,patchVersion:e,macFatalNumberNumAddMutation:n,macFatalNumberNumRemoveMutation:o},bool:{isFatal:f,isLtHashConsistent:g,macFatalCollectionNameMismatch:h,macFatalCurrentLthashMismatch:i,macFatalNewLthashMismatch:j,macFatalPatchVersionMismatch:k,macFatalNewLthashSubtractMismatch:l,macFatalNumberHasOverrideMutation:m,macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch:p,isPatchSenderPrimary:q,macFatalDidUseMacFetchFallback:r,macFatalHasMissingRemove:s,macFatalNumberAddMismatch:t,macFatalNumberRemoveMismatch:u,macFatalDidPreviousPatchFailPostSaveValidation:v,macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash:w,isPreviousPatchAnIncomingPatch:x,isLastPatchSenderAPrimaryDevice:y,isSenderIndexSameAsPreviousSenderIndex:z,didBootstrapFromSnapshot:A,isThereAnotherSyncdCompanion:a}}}function c(a){var b;b=a==null?void 0:(b=a.string)==null?void 0:b.errorCode;if(b==null){d("WALogger").ERROR(i());return null}var c=j.cast(b);if(c==null){d("WALogger").ERROR(h(),b);return null}return{type:c,collection:d("WASyncdConst").CollectionName.cast(a==null?void 0:(b=a.string)==null?void 0:b.collection),patchSnapshotMutationCount:a==null?void 0:(c=a["int"])==null?void 0:c.patchSnapshotMutationCount,patchVersion:a==null?void 0:(b=a["int"])==null?void 0:b.patchVersion,isFatal:a==null?void 0:(c=a.bool)==null?void 0:c.isFatal,isLtHashConsistent:a==null?void 0:(b=a.bool)==null?void 0:b.isLtHashConsistent,macFatalCollectionNameMismatch:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalCollectionNameMismatch,macFatalCurrentLthashMismatch:a==null?void 0:(b=a.bool)==null?void 0:b.macFatalCurrentLthashMismatch,macFatalNewLthashMismatch:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalNewLthashMismatch,macFatalPatchVersionMismatch:a==null?void 0:(b=a.bool)==null?void 0:b.macFatalPatchVersionMismatch,macFatalNewLthashSubtractMismatch:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalNewLthashSubtractMismatch,macFatalNumberHasOverrideMutation:a==null?void 0:(b=a.bool)==null?void 0:b.macFatalNumberHasOverrideMutation,macFatalNumberNumAddMutation:a==null?void 0:(c=a["int"])==null?void 0:c.macFatalNumberNumAddMutation,macFatalNumberNumRemoveMutation:a==null?void 0:(b=a["int"])==null?void 0:b.macFatalNumberNumRemoveMutation,macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch,isPatchSenderPrimary:a==null?void 0:(b=a.bool)==null?void 0:b.isPatchSenderPrimary,macFatalDidUseMacFetchFallback:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalDidUseMacFetchFallback,macFatalHasMissingRemove:a==null?void 0:(b=a.bool)==null?void 0:b.macFatalHasMissingRemove,macFatalNumberAddMismatch:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalNumberAddMismatch,macFatalNumberRemoveMismatch:a==null?void 0:(b=a.bool)==null?void 0:b.macFatalNumberRemoveMismatch,macFatalDidPreviousPatchFailPostSaveValidation:a==null?void 0:(c=a.bool)==null?void 0:c.macFatalDidPreviousPatchFailPostSaveValidation,macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash:a==null?void 0:(b=a.bool)==null?void 0:b.macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash,isPreviousPatchAnIncomingPatch:a==null?void 0:(c=a.bool)==null?void 0:c.isPreviousPatchAnIncomingPatch,isLastPatchSenderAPrimaryDevice:a==null?void 0:(b=a.bool)==null?void 0:b.isLastPatchSenderAPrimaryDevice,isSenderIndexSameAsPreviousSenderIndex:a==null?void 0:(c=a.bool)==null?void 0:c.isSenderIndexSameAsPreviousSenderIndex,didBootstrapFromSnapshot:a==null?void 0:(b=a.bool)==null?void 0:b.didBootstrapFromSnapshot,isThereAnotherSyncdCompanion:a==null?void 0:(c=a.bool)==null?void 0:c.isThereAnotherSyncdCompanion}}g.SyncdFatalErrorType=j;g.reportSyncdFatalError=a;g.convertSyncdFatalErrorFromAnnotations=c}),98);
__d("WASyncdMetrics",["$InternalEnum","WALogger","WAPREList","WAPREMetrics","WASyncdConst"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown error code: "," for key rotation event"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing error code for key rotation event"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown error code: "," for critical event"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing error code for critical event"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown collection "," for bootstrap data applied event"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing durationMs for bootstrap data applied event"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing snapshotUsed for bootstrap data applied event"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing collection for bootstrap data applied event"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown collection "," for bootstrap app state download metric"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing isSuccess for bootstrap app state download metric"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing downloadStartTs for bootstrap app state download metric"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing collection for bootstrap app state download metric"]);s=function(){return a};return a}var t=b("$InternalEnum").Mirrored(["MISSING_MUTATION_TO_REMOVE"]),u=b("$InternalEnum").Mirrored(["SNAPSHOT_USED","SNAPSHOT_NOT_USED"]),v=b("$InternalEnum").Mirrored(["APP_STATE_SYNC_KEY_EXPIRY","DEVICE_DEREGISTERATION","NO_KEYS"]);function a(a){var b=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_BOOTSTRAP_APP_STATE_DOWNLOAD);a.isSuccess!=="success"?b.endFail("syncd error: Error downloading snapshot or patches",w(a)):b.endSuccess(w(a))}function c(a,b,c){d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_BOOTSTRAP_DATA_APPLIED).endSuccess(x({collection:a,snapshotUsed:b,durationMs:c}))}function e(a,b){d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_CRITICAL_EVENT).endFail("syncd critical event: "+a,y({type:a,collection:b}))}function f(a){d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_KEY_ROTATION).endSuccess(z({type:a}))}function w(a){var b=a.collection,c=a.downloadSize,d=a.downloadStartTs;a=a.isSuccess;return{string:{collection:b},"int":{downloadSize:c,downloadStartTs:d},bool:{isSuccess:a==="success"}}}function x(a){return{string:{collection:a.collection},bool:{snapshot:a.snapshotUsed===u.SNAPSHOT_USED},"int":{durationMs:a.durationMs}}}function y(a){return{string:{criticalEventCode:a.type,collection:a.collection==null?null:a.collection}}}function z(a){return{string:{keyRotationEventCode:a.type}}}function A(a){var b,c,e;b=a==null?void 0:(b=a.string)==null?void 0:b.collection;c=a==null?void 0:(c=a["int"])==null?void 0:c.downloadSize;e=a==null?void 0:(e=a["int"])==null?void 0:e.downloadStartTs;a=a==null?void 0:(a=a.bool)==null?void 0:a.isSuccess;if(b==null){d("WALogger").ERROR(s());return null}if(e==null){d("WALogger").ERROR(r());return null}if(a==null){d("WALogger").ERROR(q());return null}var f=d("WASyncdConst").CollectionName.cast(b);if(f==null){d("WALogger").ERROR(p(),b);return null}b=a?"success":"failure";return{collection:f,downloadStartTs:e,downloadSize:c,isSuccess:b}}function B(a){var b,c;b=a==null?void 0:(b=a.string)==null?void 0:b.collection;c=a==null?void 0:(c=a.bool)==null?void 0:c.snapshot;a=a==null?void 0:(a=a["int"])==null?void 0:a.durationMs;if(b==null){d("WALogger").ERROR(o());return null}if(c==null){d("WALogger").ERROR(n());return null}if(a==null){d("WALogger").ERROR(m());return null}var e=d("WASyncdConst").CollectionName.cast(b);if(e==null){d("WALogger").ERROR(l(),b);return null}b=c?u.SNAPSHOT_USED:u.SNAPSHOT_NOT_USED;return{collection:e,snapshotUsed:b,durationMs:a}}function C(a){var b;b=a==null?void 0:(b=a.string)==null?void 0:b.criticalEventCode;if(b==null){d("WALogger").ERROR(k());return null}var c=t.cast(b);if(c==null){d("WALogger").ERROR(j(),b);return null}return{type:c,collection:d("WASyncdConst").CollectionName.cast(a==null?void 0:(b=a.string)==null?void 0:b.collection)}}function D(a){a=a==null?void 0:(a=a.string)==null?void 0:a.keyRotationEventCode;if(a==null){d("WALogger").ERROR(i());return null}var b=v.cast(a);if(b==null){d("WALogger").ERROR(h(),a);return null}return{type:b}}function E(a){var b={};Object.keys(a).forEach(function(c){typeof a[c]==="number"?(b["int"]==null&&(b["int"]={}),b["int"][c]=a[c]):typeof a[c]==="string"&&(b.string==null&&(b.string={}),b.string[c]=a[c])});return Object.keys(b).length>0?b:void 0}b=function(){function a(){this.event=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD)}var b=a.prototype;b.end=function(a){a===void 0&&(a=!1),a?this.event.endFail("syncd failed"):this.event.endSuccess()};b.mark=function(a,b){this.event.addPoint(a,E(b))};return a}();g.SyncdCriticalEventType=t;g.SyncdBootstrapDataAppliedSnapshotUsed=u;g.SyncdKeyRotationEventType=v;g.reportSyncdBootstrapAppStateDownloadMetric=a;g.reportSyncdBootstrapDataApplied=c;g.reportSyncdCriticalEvent=e;g.reportSyncdKeyRotationEvent=f;g.convertSyncdBootstrapAppStateDownloadFromAnnotations=A;g.convertSyncdBootstrapDataAppliedFromAnnotations=B;g.convertSyncdCriticalEventFromAnnotations=C;g.convertSyncdKeyRotationEventFromAnnotations=D;g.constructAnnotationsFromContext=E;g.SyncdEventFlow=b}),98);
__d("WASyncdAntiTampering",["$InternalEnum","Promise","WABaseGlobals","WACryptoLtHash","WACryptoUtils","WAGetCollectionVersion","WAGetSyncAction","WALogger","WAPromiseEach","WAServerSync.pb","WASyncdConst","WASyncdCrypto","WASyncdCryptoUtils","WASyncdError","WASyncdKeyCache","WASyncdKeyTypes","WASyncdMetricFatalError","WASyncdMetrics","WATextEncoding","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose([""," first time for ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose([""," first time for ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["|",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: current snapshot "," v"," with "," context "," mutations:"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: logMacs: ",": prepare"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: failed LtHash check for ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: had to use fallbackQueryForValueMac in collection "," for platform ",": ","\n        }"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: computing snapshot and patch macs for outgoing patch "," v",":\n  encoded version: ","\n  encoded collection: ","\n  snapshotMAC: ","\n  patchMAC: ",""]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd:\n      expected patchMAC: ","$\n      computed patchMAC: ",""]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: unable to validate patch mac."]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: snapshot_mac_mismatch_in_patch due to cache mismatch"]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: clientDebugData?.currentLthash: ",",\n        scratchLtHash: ",",\n        currentLtHash: ",",\n        macFatalDidPreviousPatchFailPostSaveValidation: ",""]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: skip fatal after snapshot mac mismatch for collection ",""]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);B=function(){return a};return a}function C(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);C=function(){return a};return a}function D(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);D=function(){return a};return a}function E(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: fatal extra details:\n      mdFatalErrorCode: ",",\n      collection: ",",\n      mutationCount: ",",\n      patchVersion: ",",\n      isLtHashConsistent: ",",\n      macFatalCollectionNameMismatch: ",",\n      macFatalCurrentLthashMismatch: ",",\n      macFatalNewLthashMismatch: ",",\n      macFatalPatchVersionMismatch: ",",\n      macFatalNewLthashSubtractMismatch: ",",\n      macFatalNumberHasOverrideMutation: ",",\n      macFatalNumberNumAddMutation: ",",\n      macFatalNumberNumRemoveMutation: ",",\n      macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch: ",",\n      isPatchSenderPrimary: ",",\n      macFatalDidUseMacFetchFallback: ",",\n      macFatalHasMissingRemove: ",",\n      macFatalNumberAddMismatch: ",",\n      macFatalNumberRemoveMismatch: ",",\n      macFatalDidPreviousPatchFailPostSaveValidation: ",",\n      macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash: ",",\n      isPreviousPatchAnIncomingPatch: ",",\n      isLastPatchSenderAPrimaryDevice: ",",\n      isSenderIndexSameAsPreviousSenderIndex: ",",\n      didBootstrapFromSnapshot: ",",\n      isThereAnotherSyncdCompanion: ","\n    "]);E=function(){return a};return a}function F(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd:\n      expected snapshotMAC: ","\n      computed snapshotMAC: ",""]);F=function(){return a};return a}function aa(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: collection "," is already in snapshot mac mismatch so not checking again"]);aa=function(){return a};return a}function G(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: empty local lthash found when processing "," patch v",""]);G=function(){return a};return a}function H(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: "," received patch v"," !== latest local version (v",") + 1"]);H=function(){return a};return a}function I(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: error on incoming records:\n    \t",""],["[","] syncd: error on incoming records:\n    \\t",""]);I=function(){return a};return a}function J(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: validating snapshot and patch mac for "," v",":\n  expected snapshotMAC: ","\n  expected patchMAC: ","\n  encoded version: ","\n  encoded collection: ","\n  key ID: ","\n  "]);J=function(){return a};return a}function K(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: shouldRecalculateLtHash: ",""]);K=function(){return a};return a}function L(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: computeLtHashAndValidatePatch for ",""]);L=function(){return a};return a}function M(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: validating snapshot mac for "," snapshot v",":\n  ltHash: ","\n  encoded version: ","\n  encoded collection: ","\n  expected snapshotMAC: ","\n  "]);M=function(){return a};return a}function N(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd:\n  "," snapshot macsToAdd:\n      ",""]);N=function(){return a};return a}var O=b("$InternalEnum").Mirrored(["Incoming","Outgoing"]),P=[(i=d("WASyncdConst")).Actions.LocaleSetting,i.Actions.SettingPushName,"generated_wui",i.Actions.Sentinel,i.Actions.PrimaryVersion,i.Actions.TimeFormat,i.Actions.Nux,i.Actions.BotWelcomeRequest,i.Actions.DeviceCapabilities,i.Actions.Archive,i.Actions.LockChat,i.Actions.FavoriteSticker,i.Actions.ChatLockSettings,i.Actions.MarkChatAsRead,i.Actions.NoteEdit,i.Actions.Pin,i.Actions.PinDEPRECATED,i.Actions.RemoveRecentSticker,i.Actions.UnarchiveChatsSetting,i.Actions.AndroidUnsupportedActions];function Q(a,b,c){c===void 0&&(c=!0);a=typeof a==="string"?a:d("WASyncdCryptoUtils").arrayBufferToHexPadded(a);b=typeof b==="string"?b:d("WASyncdCryptoUtils").arrayBufferToHexPadded(b);c=c?-16:0;return a.slice(c)+":"+b.slice(c)}var R=d("WATextEncoding").newTextDecoder();function a(a,c,e){var f,g,h,i,j,k,l,m,n,o,p;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:f=c.mac,g=c.version,h=c.keyId,i=c.records;q.next=3;return b("regeneratorRuntime").awrap(d("WASyncdKeyCache").getKeyData(h.id));case 3:j=q.sent;if(j){q.next=6;break}throw new(d("WASyncdError").SyncdMissingKeyError)();case 6:k=new Map(i.map(function(a){return[d("WASyncdCryptoUtils").arrayBufferToHexPadded(a.index.blob),d("WASyncdCrypto").valueMacFromIndexAndValueCipherText(a.value.blob)]}));d("WALogger").LOG(N(),e,a,Array.from(k.entries()).map(function(a){var b=a[0];a=a[1];return Q(b,a)}).join("\n\t"));q.next=10;return b("regeneratorRuntime").awrap(d("WACryptoLtHash").LT_HASH_ANTI_TAMPERING.add(d("WACryptoLtHash").EMPTY_LT_HASH,Array.from(k.values())));case 10:l=q.sent;q.next=13;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateEncryptionKeys(j));case 13:m=q.sent;n=m.snapshotMacKey;o=d("WASyncdCryptoUtils").to64BitNetworkOrder(g.version);p=d("WASyncdCryptoUtils").toUtf8(a).buffer;d("WALogger").LOG(M(),e,a,g.version,d("WASyncdCryptoUtils").arrayBufferToHexPadded(l),d("WASyncdCryptoUtils").arrayBufferToHexPadded(o),d("WASyncdCryptoUtils").arrayBufferToHexPadded(p),d("WASyncdCryptoUtils").arrayBufferToHexPadded(f)).devConsole("\n  --- DEV ONLY ---\n  snapshotMacKey: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(n));q.next=20;return b("regeneratorRuntime").awrap(S(a,f,n,l,o,p,!0,i.length,c.version.version,null,null,null,null,e));case 20:return q.abrupt("return",l);case 21:case"end":return q.stop()}},null,this)}function c(a,c,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;return b("regeneratorRuntime").async(function(z){while(1)switch(z.prev=z.next){case 0:y=function(){var c,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return b("regeneratorRuntime").awrap(Y(a,e,"logErrorDiagnostics",!1));case 2:c=g.sent,f=new Map(c.map(function(a){var b=a.indexMac;a=a.valueMac;return[d("WASyncdCryptoUtils").arrayBufferToHexPadded(b),d("WASyncdCryptoUtils").arrayBufferToHexPadded(a)]})),d("WALogger").LOG(I(),e,q.map(function(a){var b=a.operation,c=a.indexMac;a=a.valueMac;return(b===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET?"set":"remove")+" | "+Q(c,a,!1)+" | "+(f.has(d("WASyncdCryptoUtils").arrayBufferToHexPadded(c))?"found":"did not find")+" indexMAC in the above logged macs"}).join("\n\t"));case 5:case"end":return g.stop()}},null,this)};d("WALogger").LOG(L(),e,a);g=c.version,h=c.mutations,i=c.snapshotMac,j=c.patchMac,k=c.keyId;l=k.id;z.next=6;return b("regeneratorRuntime").awrap(d("WASyncdKeyCache").getKeyData(l));case 6:m=z.sent;if(m){z.next=9;break}throw new(d("WASyncdError").SyncdMissingKeyError)();case 9:z.next=11;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateEncryptionKeys(m));case 11:n=z.sent;o=n.snapshotMacKey;p=n.patchMacKey;q=h.map(function(a){return{operation:a.operation,indexMac:a.record.index.blob,valueMac:d("WASyncdCrypto").valueMacFromIndexAndValueCipherText(a.record.value.blob)}});z.next=17;return b("regeneratorRuntime").awrap(d("WABaseGlobals").runInTransaction({SyncActionStore:!0},function(d){var e,c;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:e=d.SyncActionStore;f.next=3;return b("regeneratorRuntime").awrap(e.getByCollections([a]));case 3:c=f.sent;return f.abrupt("return",c);case 5:case"end":return f.stop()}},null,this)}));case 17:r=z.sent;s=1e3;t=d("WABaseGlobals").getConfig().syncShouldCalculateLtHashFromScratch()&&r&&r.length<s;d("WALogger").LOG(K(),e,t);if(!t){z.next=27;break}z.next=24;return b("regeneratorRuntime").awrap(V(r));case 24:z.t0=z.sent;z.next=30;break;case 27:z.next=29;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getCollectionVersionLtHashInTransaction(a));case 29:z.t0=z.sent;case 30:u=z.t0;z.next=33;return b("regeneratorRuntime").awrap(U(a,q,e,f,c.version.version,O.Incoming,u));case 33:v=z.sent;w=d("WASyncdCryptoUtils").to64BitNetworkOrder(g.version);x=d("WASyncdCryptoUtils").toUtf8(a).buffer;d("WALogger").LOG(J(),e,a,g.version,d("WASyncdCryptoUtils").arrayBufferToHexPadded(i),d("WASyncdCryptoUtils").arrayBufferToHexPadded(j),d("WASyncdCryptoUtils").arrayBufferToHexPadded(w),d("WASyncdCryptoUtils").arrayBufferToHexPadded(x),d("WASyncdCryptoUtils").arrayBufferToHexPadded(d("WASyncdKeyTypes").fromSyncKeyId(l)));z.prev=37;z.next=40;return b("regeneratorRuntime").awrap(T(a,j,p,i,q.map(function(a){return a.valueMac}),w,x,h.length,g.version,e));case 40:z.next=42;return b("regeneratorRuntime").awrap(S(a,i,o,v.ltHash,w,x,!1,h.length,g.version,c.clientDebugData,u,v,c.deviceIndex,e));case 42:z.next=49;break;case 44:z.prev=44;z.t1=z["catch"](37);z.next=48;return b("regeneratorRuntime").awrap(y());case 48:throw z.t1;case 49:return z.abrupt("return",v.ltHash);case 50:case"end":return z.stop()}},null,this,[[37,44]])}function ba(a,c,e){var f,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:i.next=2;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getCollectionVersionInTransaction(a).then(function(a){return(a=a==null?void 0:a.version)!=null?a:0}));case 2:f=i.sent;if(!(f!==c-1)){i.next=9;break}g=f>c-1?"greater-than-expected":"less-than-expected";d("WALogger").WARN(H(),e,a,c,f).sendLogs("syncd-version-check-error-local-version-"+g);i.next=8;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"["+e+"] received patch v"+c+" !== latest local version (v"+f+") + 1"));case 8:throw new(d("WASyncdError").SyncdRetryableError)("syncd-version-check-error-local-version-"+g);case 9:i.next=11;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getCollectionVersionLtHashInTransaction(a));case 11:h=i.sent;if(!(d("WACryptoUtils").arrayBuffersEqual(h,d("WACryptoLtHash").EMPTY_LT_HASH)&&c!==1)){i.next=15;break}d("WALogger").WARN(G(),e,a,c).sendLogs("syncd-empty-lthash-on-mac-mismatch");throw new(d("WASyncdError").SyncdRetryableError)("empty lthash");case 15:case"end":return i.stop()}},null,this)}function S(a,c,e,f,g,h,i,j,k,l,m,n,o,p){var q,r,s,t,u,v,w,x,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,da,ea,fa,ga,Z,ha,ia,ja,ka;return b("regeneratorRuntime").async(function($){while(1)switch($.prev=$.next){case 0:r=d("WABaseGlobals").getConfig().syncdShouldNotFatalOnSnapshotMacMismatchInPatches()&&!i;$.next=3;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getIsCollectionInMacMismatchFatalInTransaction(a));case 3:$.t0=q=$.sent;if(!($.t0!=null)){$.next=8;break}$.t1=q;$.next=9;break;case 8:$.t1=!1;case 9:s=$.t1;if(!(r&&s)){$.next=13;break}d("WALogger").LOG(aa(),p,a);return $.abrupt("return");case 13:$.next=15;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateSnapshotMac(e,f,g,h));case 15:t=$.sent;u=d("WACryptoUtils").arrayBuffersEqual(t,c);if(u){$.next=69;break}d("WALogger").DEV(F(),p,d("WASyncdCryptoUtils").arrayBufferToHexPadded(c),d("WASyncdCryptoUtils").arrayBufferToHexPadded(t));if(i){$.next=22;break}$.next=22;return b("regeneratorRuntime").awrap(ba(a,k,p));case 22:$.next=24;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"["+p+"] failed validate snapshot mac"));case 24:$.next=26;return b("regeneratorRuntime").awrap(ca(p,a));case 26:v=$.sent;w=v.isLtHashConsistent;x=v.scratchLtHash;G=i?d("WASyncdMetricFatalError").SyncdFatalErrorType.SNAPSHOT_MAC_MISMATCH_IN_SNAPSHOT:d("WASyncdMetricFatalError").SyncdFatalErrorType.SNAPSHOT_MAC_MISMATCH_IN_PATCH;H=(l==null?void 0:l.collectionName)&&!d("WACryptoUtils").arrayBuffersEqual(h,l==null?void 0:l.collectionName);I=(l==null?void 0:l.newLthash)&&!d("WACryptoUtils").arrayBuffersEqual(f,l==null?void 0:l.newLthash);J=(l==null?void 0:l.patchVersion)&&!d("WACryptoUtils").arrayBuffersEqual(g,l==null?void 0:l.patchVersion);K=(l==null?void 0:l.currentLthash)&&m&&!d("WACryptoUtils").arrayBuffersEqual(m,l==null?void 0:l.currentLthash);L=(l==null?void 0:l.newLthashSubtract)&&(n==null?void 0:n.subtractResult)&&!d("WACryptoUtils").arrayBuffersEqual(n==null?void 0:n.subtractResult,l==null?void 0:l.newLthashSubtract);M=n==null?void 0:n.hasOverride;N=n==null?void 0:n.numAdd;O=n==null?void 0:n.numRemove;P=(l==null?void 0:l.currentLthash)&&x&&!d("WACryptoUtils").arrayBuffersEqual(x,l==null?void 0:l.currentLthash);Q=o===0;R=(l==null?void 0:l.numberAdd)!=null&&(n==null?void 0:n.numAdd)!=null&&(n==null?void 0:n.numAdd)!==(l==null?void 0:l.numberAdd);S=(l==null?void 0:l.numberRemove)!=null&&(n==null?void 0:n.numRemove)!=null&&(n==null?void 0:n.numRemove)!==(l==null?void 0:l.numberRemove);T=n==null?void 0:n.didUseFallback;U=n==null?void 0:n.hasMissingRemove;$.next=46;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getCollectionVersionInTransaction(a));case 46:V=$.sent;W=V==null?void 0:V.didLastPatchFailPostValidation;X=(l==null?void 0:l.currentLthash)&&(V==null?void 0:V.lastPatchNewLtHashFromPatchDebugData)&&!d("WACryptoUtils").arrayBuffersEqual(V==null?void 0:V.lastPatchNewLtHashFromPatchDebugData,l==null?void 0:l.currentLthash);Y=V==null?void 0:V.isLastPatchAnIncomingPatch;da=V==null?void 0:V.isLastPatchSenderAPrimaryDevice;ea=V==null?void 0:V.didBootstrapFromSnapshot;fa=(V==null?void 0:V.lastPatchSenderDeviceId)!=null&&o!=null&&o===(V==null?void 0:V.lastPatchSenderDeviceId);$.next=55;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getConfig().getAreThereMoreCompanions());case 55:ga=$.sent;d("WASyncdMetricFatalError").reportSyncdFatalError(G,a,j,k,!r,w,H,K,I,J,L,M,N,O,P,Q,T,U,R,S,W,X,Y,da,fa,ea,ga);d("WALogger").LOG(E(),p,G,a,j,k,w,H,K,I,J,L,M,N,O,P,Q,T,U,R,S,W,X,Y,da,fa,ea,ga);if(!r){$.next=68;break}$.next=61;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().printSyncdLog(a));case 61:Z="["+p+"] syncd: unable to validate snapshot mac. collection: "+a;d("WABaseGlobals").getConfig().isEmployee()?d("WALogger").ERROR(D(),Z).sendLogs(Z,{sampling:1}):l!=null?(ha=Z+" (additional info)",d("WALogger").ERROR(C(),ha).sendLogs(ha,{sampling:1})):d("WALogger").ERROR(B(),Z).sendLogs(Z,{sampling:.01});$.next=65;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").updateIsCollectionInMacMismatchFatalInTransaction(a));case 65:d("WALogger").LOG(A(),p,a);P===!1&&K===!0&&(d("WALogger").LOG(z(),p,d("WASyncdCryptoUtils").arrayBufferToHexPadded((ia=l==null?void 0:l.currentLthash)!=null?ia:new ArrayBuffer(0)).slice(-16),d("WASyncdCryptoUtils").arrayBufferToHexPadded((ja=x)!=null?ja:new ArrayBuffer(0)).slice(-16),d("WASyncdCryptoUtils").arrayBufferToHexPadded((ka=m)!=null?ka:new ArrayBuffer(0)).slice(-16),W),d("WALogger").ERROR(y()).sendLogs("syncd: snapshot_mac_mismatch_in_patch due to cache mismatch"));return $.abrupt("return");case 68:throw new(d("WASyncdError").SyncdFatalError)("unable to validate snapshot mac");case 69:case"end":return $.stop()}},null,this)}function T(a,c,e,f,g,h,i,j,k,l){var m,n;return b("regeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:o.next=2;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generatePatchMac(e,f,g,h,i));case 2:m=o.sent;n=d("WACryptoUtils").arrayBuffersEqual(m,c);if(n){o.next=13;break}o.next=7;return b("regeneratorRuntime").awrap(ba(a,k,l));case 7:o.next=9;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"failed validate patch mac"));case 9:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MAC_MISMATCH_PATCH,a,j,k);d("WALogger").WARN(x(),l).sendLogs("syncd: unable to validate patch mac.");d("WALogger").DEV(w(),c,m);throw new(d("WASyncdError").SyncdFatalError)("unable to validate patch mac");case 13:case"end":return o.stop()}},null,this)}function e(a,c,e,f){var g,h,i,j,k,l,m,n;return b("regeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:o.next=2;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getCollectionVersionInTransaction(a).then(function(a){return(a=a==null?void 0:a.version)!=null?a:d("WASyncdConst").DEFAULT_COLLECTION_VERSION}));case 2:o.t0=o.sent;g=o.t0+1;o.next=6;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateEncryptionKeys(f));case 6:h=o.sent;i=h.patchMacKey;j=h.snapshotMacKey;k=d("WASyncdCryptoUtils").to64BitNetworkOrder(g);l=d("WASyncdCryptoUtils").toUtf8(a).buffer;o.next=13;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateSnapshotMac(j,c,k,l));case 13:m=o.sent;o.next=16;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generatePatchMac(i,m,e.map(function(a){return a.valueMac}),k,l));case 16:n=o.sent;d("WALogger").LOG(v(),a,g,d("WASyncdCryptoUtils").arrayBufferToHexPadded(k),d("WASyncdCryptoUtils").arrayBufferToHexPadded(l),d("WASyncdCryptoUtils").arrayBufferToHexPadded(m),d("WASyncdCryptoUtils").arrayBufferToHexPadded(n)).devConsole("\n  --- DEV ONLY ---\n  snapshotMacKey: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(j)+"\n  patchMacKey: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(i));return o.abrupt("return",{snapshotMac:m,patchMac:n});case 19:case"end":return o.stop()}},null,this)}function U(a,c,e,f,g,i,j){var k,l,m,n,o,v,w,x,y,z,A,B,C,D,E;return b("regeneratorRuntime").async(function(F){while(1)switch(F.prev=F.next){case 0:E=function(a){return f==null?(h||(h=b("Promise"))).resolve(null):f(a)};l=d("WABaseGlobals").getConfig().syncdShouldParsePatchDebugData()||a===d("WASyncdConst").CollectionName.CriticalBlock||i===O.Outgoing;if(!((k=j)!=null)){F.next=6;break}F.t0=k;F.next=9;break;case 6:F.next=8;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getCollectionVersionLtHashInTransaction(a));case 8:F.t0=F.sent;case 9:m=F.t0;F.next=12;return b("regeneratorRuntime").awrap(W(c.map(function(a){return a.indexMac})));case 12:n=F.sent;o=new Map();v=new Map();w=new Map();x=!1;y=!1;F.next=20;return b("regeneratorRuntime").awrap(d("WAPromiseEach").promiseEach(c,function(h){var j,k,l,m,p,q,z,A,B,C,f,D;return b("regeneratorRuntime").async(function(F){while(1)switch(F.prev=F.next){case 0:j=h.indexMac,k=h.valueMac,l=h.operation;m=R.decode(j);p=n.get(m);if(!p){F.next=7;break}l===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE?v.set(d("WASyncdCryptoUtils").arrayBufferToHexPadded(j),p.valueMac):w.set(d("WASyncdCryptoUtils").arrayBufferToHexPadded(j),p.valueMac);F.next=35;break;case 7:if(!(l===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE)){F.next=35;break}F.next=10;return b("regeneratorRuntime").awrap(E(j));case 10:q=F.sent;if(!(q!=null)){F.next=17;break}v.set(d("WASyncdCryptoUtils").arrayBufferToHexPadded(j),q);y=!0;d("WALogger").WARN(u(),e,a,(z=d("WABaseGlobals").getConfig().primaryPlatform())!=null?z:"[empty]",d("WASyncdCryptoUtils").arrayBufferToHexPadded(j).slice(-16)).tags("non-sad").sendLogs("syncd: fallback query");F.next=35;break;case 17:x=!0;F.next=20;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"["+e+"] incoming REMOVE mutation missing in local snapshot for collection "+a+" version "+((A=g==null?void 0:g.toString())!=null?A:"n/a")+": "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(j)));case 20:F.next=22;return b("regeneratorRuntime").awrap(Y(a,e,"REMOVE missing",!1));case 22:f="\n          input mutations mac:\n          "+c.map(function(a){return(a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET?"SET ":"REMOVE ")+Q(a.indexMac,a.valueMac)}).join("\n\t")+"\n          currentMacs: "+Array.from(n.values()).map(function(a){return Q(a.indexMac,a.valueMac)}).join(", ")+"\n        ";d("WALogger").LOG(t(),f);F.next=26;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"missing remove additional info: "+f));case 26:d("WASyncdMetrics").reportSyncdCriticalEvent(d("WASyncdMetrics").SyncdCriticalEventType.MISSING_MUTATION_TO_REMOVE,a);D="["+e+"] syncd: missing indexMAC in sync-actions table for REMOVE mutation in collection "+a+" version "+((B=g==null?void 0:g.toString())!=null?B:"n/a")+" direction "+(i?i:"n/a")+" for platform "+((C=d("WABaseGlobals").getConfig().primaryPlatform())!=null?C:"[empty]")+": "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(j).slice(-16);if(!(a===d("WASyncdConst").CollectionName.CriticalBlock)){F.next=34;break}F.next=31;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().printSyncdLog(a));case 31:d("WALogger").ERROR(s(),D).sendLogs("syncd: missing indexMAC from REMOVE in collection "+a);F.next=35;break;case 34:d("WALogger").ERROR(r(),D).sendLogs("syncd: missing indexMAC from REMOVE in collection "+a,{sampling:.01});case 35:l===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET&&o.set(d("WASyncdCryptoUtils").arrayBufferToHexPadded(j),k);case 36:case"end":return F.stop()}},null,this)}));case 20:F.next=22;return b("regeneratorRuntime").awrap(d("WACryptoLtHash").LT_HASH_ANTI_TAMPERING.subtractThenAdd(m,Array.from(o.values()),Array.from(v.values()).concat(Array.from(w.values()))));case 22:z=F.sent;A=z.ltHash;B=z.subtractResult;C="["+e+"] syncd: computing ltHash for "+a+":\n  mutations length: "+c.length+"\n  currentLtHash: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(m).slice(-16)+"\n  subtractResult: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(B).slice(-16)+"\n  currentMacs length: "+n.size+"\n  macsToAdd:\n      "+Array.from(o.entries()).map(function(a){var b=a[0];a=a[1];return Q(b,a)}).join("\n\t")+"\n  macsToRemove:\n      "+Array.from(v.entries()).map(function(a){var b=a[0];a=a[1];return Q(b,a)}).join("\n\t")+"\n  macsToOverwrite (also remove):\n      "+Array.from(w.entries()).map(function(a){var b=a[0];a=a[1];return Q(b,a)}).join("\n\t")+"\n  newLtHash: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(A).slice(-16)+"\n  hasMissingRemove: "+x.toString()+"\n  didUseFallback: "+y.toString();d("WALogger").LOG(q(),C);F.next=29;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"generate lthash details 1: "+C));case 29:if(!l){F.next=34;break}D="\n      input mutations mac:\n      "+c.map(function(a){return(a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET?"SET ":"REMOVE ")+Q(a.indexMac,a.valueMac)}).join("\n\t")+"\n      currentMacs: "+Array.from(n.values()).map(function(a){return Q(a.indexMac,a.valueMac)}).join(", ")+"\n    ";d("WALogger").LOG(p(),D);F.next=34;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"generate lthash details 2: "+D));case 34:return F.abrupt("return",{ltHash:A,numAdd:o.size,numRemove:v.size,hasOverride:w.size>0,subtractResult:B,hasMissingRemove:x,didUseFallback:y});case 35:case"end":return F.stop()}},null,this)}function ca(a,c,e){var f,g,i,j,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:f=d("WABaseGlobals").getConfig().isEmployee()?900:e;m.next=3;return b("regeneratorRuntime").awrap(d("WABaseGlobals").runInTransaction({SyncActionStore:!0,CollectionVersionStore:!0},function(a){var d,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:d=a.SyncActionStore,e=a.CollectionVersionStore;if(!(c==null)){g.next=7;break}g.next=4;return b("regeneratorRuntime").awrap(e.getAll());case 4:g.t0=g.sent;g.next=11;break;case 7:g.next=9;return b("regeneratorRuntime").awrap(e.get(c));case 9:g.t1=g.sent,g.t0=[g.t1];case 11:f=g.t0;return g.abrupt("return",(h||(h=b("Promise"))).all(f.filter(Boolean).map(function(a){var c,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:c=a.collection,e=a.ltHash;g.next=3;return b("regeneratorRuntime").awrap(d.getByCollections([c]));case 3:f=g.sent;return g.abrupt("return",{collection:c,ltHash:e,mutations:f});case 5:case"end":return g.stop()}},null,this)})));case 13:case"end":return g.stop()}},null,this)}));case 3:g=m.sent;i=0;g.map(function(a){a.collection;a.ltHash;a=a.mutations;i+=a.length});if(!(f!==void 0&&i>f)){m.next=8;break}return m.abrupt("return",{isLtHashConsistent:void 0,scratchLtHash:void 0,cachedLtHash:void 0});case 8:j=null;k=null;l=!0;m.next=13;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(g.map(function(c){var e,f,g,h;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:e=c.collection,f=c.ltHash,g=c.mutations;m.next=3;return b("regeneratorRuntime").awrap(V(g));case 3:h=m.sent,j==null&&(j=h),k==null&&(k=f),d("WACryptoUtils").arrayBuffersEqual(f,h)||i>0&&(l=!1,d("WALogger").ERROR(o(),a,e).verbose());case 7:case"end":return m.stop()}},null,this)})));case 13:return m.abrupt("return",{isLtHashConsistent:l,scratchLtHash:j,cachedLtHash:k});case 14:case"end":return m.stop()}},null,this)}function V(a){a=new Map(a.map(function(a){return[d("WASyncdCryptoUtils").arrayBufferToHexPadded(a.indexMac),a.valueMac]}));return d("WACryptoLtHash").LT_HASH_ANTI_TAMPERING.add(d("WACryptoLtHash").EMPTY_LT_HASH,Array.from(a.values()))}function W(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionsByIndexMacsInTransaction(a));case 2:c=e.sent;return e.abrupt("return",new Map(c.map(function(a){return[R.decode(a.indexMac),{indexMac:a.indexMac,valueMac:a.valueMac}]})));case 4:case"end":return e.stop()}},null,this)}function X(a,b){var c=!1;d("WABaseGlobals").getConfig().isEmployee()&&(c=!0);(a===d("WASyncdConst").CollectionName.RegularLow||a===d("WASyncdConst").CollectionName.CriticalBlock)&&(c=!0);P.includes(b.action)&&(c=!0);if(b.action&&c){if(b.action===d("WASyncdConst").Actions.DeviceCapabilities){if(d("WABaseGlobals").getConfig().isEmployee())return b.index;a=b.index.indexOf(":");return"device_capabilities:"+b.index.slice(a-4)}return b.action}}function Y(a,c,e,f){var g,i,j,k,o,p,q;return b("regeneratorRuntime").async(function(r){while(1)switch(r.prev=r.next){case 0:f===void 0&&(f=!0);g=f?20:1;d("WALogger").LOG(n(),a);r.next=5;return b("regeneratorRuntime").awrap(d("WABaseGlobals").runInTransaction({SyncActionStore:!0,CollectionVersionStore:!0},function(c){var d=c.SyncActionStore;c=c.CollectionVersionStore;return(h||(h=b("Promise"))).all([c.get(a).then(function(a){return a==null?void 0:a.version}),d.getByCollections([a])])}));case 5:i=r.sent;j=i[0];k=i[1];d("WALogger").LOG(m(),c,a,j,k.length,e);o=d("WABaseGlobals").getConfig().isEmployee()?200:120;if(!(f&&k.length>o)){r.next=12;break}return r.abrupt("return",k);case 12:p=k.reduce(function(b,c,d){d%g===0&&b.push("");b[b.length-1]+=Q(c.indexMac,c.valueMac,f)+(" "+((d=X(a,c))!=null?d:"n/a")+" | ");return b},[]);p.forEach(function(a){return d("WALogger").LOG(l(),a)});if(!(a===d("WASyncdConst").CollectionName.CriticalBlock||a===d("WASyncdConst").CollectionName.RegularLow||d("WABaseGlobals").getConfig().isEmployee())){r.next=17;break}r.next=17;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"current local snapshot for "+a+" v"+((q=j)!=null?q:"n/a")+" mutation length "+k.length+" context "+e+": "+p.join("\n")));case 17:return r.abrupt("return",k);case 18:case"end":return r.stop()}},null,this)}function f(a,c,e,f){var g,h,i,l,m,n,o,p;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:f===void 0&&(f=400);q.next=3;return b("regeneratorRuntime").awrap(ca(e,a,f));case 3:g=q.sent;h=g.isLtHashConsistent;i=g.scratchLtHash;l=g.cachedLtHash;m=i==null?"":d("WASyncdCryptoUtils").arrayBufferToHexPadded(i).slice(-16);n=l==null?"":d("WASyncdCryptoUtils").arrayBufferToHexPadded(l).slice(-16);q.next=11;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getIsCollectionLthashInconsistentInTransaction(a));case 11:o=q.sent;if(!(o===!0)){q.next=16;break}q.next=15;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"lthash already inconsistent. scratchLtHash: "+m+", cachedLtHash: "+n+", context: "+c));case 15:return q.abrupt("return",!0);case 16:if(!(h===!1)){q.next=28;break}q.next=19;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"["+e+"] lthash first time inconsistent. scratchLtHash: "+m+", cachedLtHash: "+n+", context: "+c));case 19:q.next=21;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().printSyncdLog(a));case 21:q.next=23;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").updateIsCollectionLthashInconsistentInTransaction(a));case 23:p="syncd: lthash inconsistent";a===d("WASyncdConst").CollectionName.CriticalBlock||d("WABaseGlobals").getConfig().isEmployee()?d("WALogger").ERROR(k(),p,a).verbose().sendLogs(p):d("WALogger").ERROR(j(),p,a).verbose().sendLogs(p,{sampling:.01});return q.abrupt("return",!0);case 28:if(!(h===!0)){q.next=32;break}q.next=31;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"lthash consistent. scratchLtHash: "+m+", cachedLtHash: "+n+", context: "+c));case 31:return q.abrupt("return",!1);case 32:q.next=34;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"lthash unknown if consistent. scratchLtHash: "+m+", cachedLtHash: "+n+", context: "+c));case 34:return q.abrupt("return",void 0);case 35:case"end":return q.stop()}},null,this)}g.SyncdPatchDirection=O;g.actionsToLog=P;g.indexAndValueMacToString=Q;g.computeLtHashAndValidateSnapshot=a;g.computeLtHashAndValidatePatch=c;g.computeOutgoingSnapshotAndPatchMacs=e;g.computeLtHash=U;g.checkLtHash=ca;g.computeLtHashFromScratch=V;g.getMutationNameIfAllowed=X;g.logMacsInSnapshot=Y;g.reportCollectionInconsistency=f}),98);
__d("WASyncdCollectionUtils",["WASyncdConst"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a==null}function b(a){switch(a){case d("WASyncdConst").CollectionName.CriticalBlock:return!0;case d("WASyncdConst").CollectionName.CriticalUnblockLow:return!0;case d("WASyncdConst").CollectionName.Regular:return!1;case d("WASyncdConst").CollectionName.RegularHigh:return!1;case d("WASyncdConst").CollectionName.RegularLow:return!1}}g.isBootstrap=a;g.isCriticalCollection=b}),98);
__d("WASyncdDecode",["WAServerSync.pb","WASyncAction.pb","WASyncdError","WASyncdMetricFatalError","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){try{return d("decodeProtobuf").decodeProtobuf(d("WAServerSync.pb").ExternalBlobReferenceSpec,b)}catch(b){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.EXTERNAL_BLOB_REFERENCE_PROTOBUF_DESERIALIZATION_FAILED,a);throw new(d("WASyncdError").SyncdFatalError)("external blob reference protobuf deserialization failed")}}function b(a,b){try{return d("decodeProtobuf").decodeProtobuf(d("WAServerSync.pb").SyncdSnapshotSpec,b)}catch(b){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.SNAPSHOT_PROTOBUF_DESERIALIZATION_FAILED,a);throw new(d("WASyncdError").SyncdFatalError)("snapshot protobuf deserialization failed")}}function c(a,b){try{return d("decodeProtobuf").decodeProtobuf(d("WAServerSync.pb").SyncdPatchSpec,b)}catch(b){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.PATCH_PROTOBUF_DESERIALIZATION_FAILED,a);throw new(d("WASyncdError").SyncdFatalError)("patch protobuf deserialization failed")}}function e(a,b){try{return d("decodeProtobuf").decodeProtobuf(d("WAServerSync.pb").SyncdMutationsSpec,b)}catch(b){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MUTATIONS_PROTOBUF_DESERIALIZATION_FAILED,a);throw new(d("WASyncdError").SyncdFatalError)("mutations protobuf deserialization failed")}}function f(a,b){try{return d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,b)}catch(b){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.ACTION_DATA_PROTOBUF_DESERIALIZATION_FAILED,a);throw new(d("WASyncdError").SyncdFatalError)("action data protobuf deserialization failed")}}g.decodeExternalBlobReference=a;g.decodeSyncdSnapshot=b;g.decodeSyncdPatch=c;g.decodeSyncdMutations=e;g.decodeSyncActionData=f}),98);
__d("WASyncdValidateSyncActionProtobuf",["WASyncdError","WASyncdMetricFatalError"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){}a.validateSyncActionDataProtobuf=function(a,b){var c=b.index,e=b.value,f=b.padding;b=b.version;if(!c){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_ACTION_INDEX,a);throw new(d("WASyncdError").SyncdFatalError)("missing action index")}if(b==null){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_ACTION_VERSION,a);throw new(d("WASyncdError").SyncdFatalError)("missing action version")}return{index:c,value:e,padding:f,version:b}};return a}();g["default"]=a}),98);
__d("WASyncdDecryptMutations",["Promise","WABaseGlobals","WACryptoUtils","WAServerSync.pb","WASyncdCrypto","WASyncdCryptoConst","WASyncdCryptoUtils","WASyncdDecode","WASyncdError","WASyncdKeyCache","WASyncdMetricFatalError","WASyncdValidateSyncActionProtobuf","WATextEncoding","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("WATextEncoding").newTextDecoder();function a(a,c){return(h||(h=b("Promise"))).all(c.records.map(function(b){return j(a,d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET,b)}))}function e(a,c){return(h||(h=b("Promise"))).all(c.mutations.map(function(b){return j(a,b.operation,b.record)}))}function j(a,c,e){var f,g,h,j,l,m,n,o,p;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:f=e.keyId.id;q.next=3;return b("regeneratorRuntime").awrap(d("WASyncdKeyCache").getKeyData(f));case 3:g=q.sent;if(g){q.next=10;break}if(!(c===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE)){q.next=9;break}q.next=8;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"exception: no key data for remove mutations"));case 8:throw new(d("WASyncdError").SyncdFatalError)("no key data for remove mutations");case 9:throw new(d("WASyncdError").SyncdMissingKeyError)();case 10:q.next=12;return b("regeneratorRuntime").awrap(k(a,f,g,c,e));case 12:h=q.sent;j=h.syncAction;l=h.indexMac;m=h.valueMac;n=h.indexValueBinary;o=j.index,p=j.version;return q.abrupt("return",{index:i.decode(o),action:null,version:p,keyId:f,operation:c,indexMac:l,valueMac:m,collection:a,binarySyncData:n});case 19:case"end":return q.stop()}},null,this)}function k(a,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;return b("regeneratorRuntime").async(function(A){while(1)switch(A.prev=A.next){case 0:i=h.index.blob;j=h.value.blob;k=d("WASyncdCrypto").valueMacFromIndexAndValueCipherText(j);l=d("WASyncdCryptoUtils").split(j,d("WASyncdCryptoConst").IV_LENGTH,j.byteLength-d("WASyncdCryptoConst").MAC_LENGTH-d("WASyncdCryptoConst").IV_LENGTH);m=l[0];n=l[1];o=l[2];A.next=9;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateEncryptionKeys(f));case 9:p=A.sent;q=p.indexKey,r=p.valueEncryptionKey,s=p.valueMacKey;t=d("WASyncdCryptoUtils").combine([m,n]);u=d("WASyncdCrypto").generateAssociatedData(g,e);A.next=15;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateMac(u,t,s));case 15:v=A.sent;if(d("WACryptoUtils").arrayBuffersEqual(o,v)){A.next=19;break}d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.DECRYPTION_FAILED,a);throw new(d("WASyncdError").SyncdFatalError)("decryption failure: valueMAC mismatch");case 19:A.next=21;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").decryptCipherText(new Uint8Array(m),r,n));case 21:w=A.sent;x=d("WASyncdDecode").decodeSyncActionData(a,w);y=c("WASyncdValidateSyncActionProtobuf").validateSyncActionDataProtobuf(a,x);A.next=26;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateIndexMac(q,y.index));case 26:z=A.sent;if(d("WACryptoUtils").arrayBuffersEqual(i,z)){A.next=30;break}d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.DECRYPTION_FAILED,a);throw new(d("WASyncdError").SyncdFatalError)("decryption failure: indexMAC mismatch");case 30:return A.abrupt("return",{syncAction:y,indexMac:i,valueMac:k,indexValueBinary:w});case 31:case"end":return A.stop()}},null,this)}g.tryDecryptSnapshot=a;g.tryDecryptPatch=e}),98);
__d("WASyncdGetActionHandler",["WABaseGlobals"],(function(a,b,c,d,e,f,g){"use strict";var h=null,i=null;function a(a){h==null&&(h=new Map(d("WABaseGlobals").getConfig().syncdActionHandlers().map(function(a){return[a.getAction(),a]})));return h.get(a)}function b(){i==null&&(i=Math.max.apply(Math,d("WABaseGlobals").getConfig().syncdActionHandlers().map(function(a){return a.getVersion()})));return i}g.getActionHandler=a;g.maxSupportedVersion=b}),98);
__d("WASyncdStoreMissingKeys",["Promise","WAAsyncSleep","WABaseGlobals","WAGetMissingKey","WAGetSyncKey","WALogger","WASyncdCryptoUtils","WASyncdMetricFatalError","WATimeUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: missing key on all clients"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: expired keys: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: actually missing keys: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing keys: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: all keys: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: check if has expired keys"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: timeout while waiting for missing key"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: _timeoutWhileWaitingForMissingKey: no expired keys"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: _timeoutWhileWaitingForMissingKey"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: earliest missing key: ",", timestamp=",", timeoutMs=",""]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: _setMissingKeyTimeout: missing keys: ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: updateMissingKeys: finish updating missing keys from device ",""]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: updateMissingKeys: begin updating missing keys from device ","\n      \tmissingKeys: [","]"],["syncd: updateMissingKeys: begin updating missing keys from device ","\n      \\tmissingKeys: [","]"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: updateMissingKeys from device ","\n    \tkeys with keyData: ","\n    \tkeys without keyData: ",""],["syncd: updateMissingKeys from device ","\n    \\tkeys with keyData: ","\n    \\tkeys without keyData: ",""]);v=function(){return a};return a}var w;function a(){var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().getDeviceFingerprint());case 2:a=c.sent.deviceIndexes;return c.abrupt("return",d("WABaseGlobals").runInTransaction({MissingKeyStore:!0},function(c){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:d=c.MissingKeyStore;f.next=3;return b("regeneratorRuntime").awrap(d.getAll());case 3:e=f.sent;if(!(e.length===0)){f.next=6;break}return f.abrupt("return",(h||(h=b("Promise"))).resolve());case 6:e.forEach(function(b){var c=b.deviceResponses;c.forEach(function(c,d){a.includes(d)||b.deviceResponses["delete"](d)})});f.next=9;return b("regeneratorRuntime").awrap(d.bulkUpdate(e));case 9:f.next=11;return b("regeneratorRuntime").awrap(B({MissingKeyStore:d}));case 11:case"end":return f.stop()}},null,this)}));case 4:case"end":return c.stop()}},null,this)}function c(a,c){var e=[],f=[];a.forEach(function(a){var b=a.keyData;a=d("WASyncdCryptoUtils").syncKeyIdToHex(a.keyId);b?e.push(a):f.push(a)});d("WALogger").LOG(v(),c,e,f);return d("WABaseGlobals").runInTransaction({MissingKeyStore:!0},function(a){var g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:g=a.MissingKeyStore;if(!(e.length>0)){i.next=6;break}i.next=4;return b("regeneratorRuntime").awrap(g.bulkRemove(e));case 4:i.next=6;return b("regeneratorRuntime").awrap(y({MissingKeyStore:g}));case 6:if(!(f.length>0)){i.next=18;break}i.next=9;return b("regeneratorRuntime").awrap(g.bulkGet(f));case 9:i.t0=Boolean;h=i.sent.filter(i.t0);h.forEach(function(a){return a.deviceResponses.set(c,!1)});d("WALogger").LOG(u(),c,f);i.next=15;return b("regeneratorRuntime").awrap(g.bulkUpdate(h));case 15:d("WALogger").LOG(t(),c);i.next=18;return b("regeneratorRuntime").awrap(B({MissingKeyStore:g}));case 18:case"end":return i.stop()}},null,this)})}function x(){return d("WABaseGlobals").runInTransaction({MissingKeyStore:!0},function(a){a=a.MissingKeyStore;return y({MissingKeyStore:a})})}function y(a){var c,e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:c=a.MissingKeyStore;clearTimeout(w);w=null;h.next=5;return b("regeneratorRuntime").awrap(c.getAll());case 5:e=h.sent;if(!(e.length===0)){h.next=8;break}return h.abrupt("return");case 8:d("WALogger").LOG(s(),e.map(function(a){return d("WASyncdCryptoUtils").syncKeyIdToHex(a.keyId)})),f=e.reduce(function(a,b){return a.timestamp<b.timestamp?a:b}),g=d("WABaseGlobals").getConfig().syncdWaitForKeyTimeoutDays()*d("WATimeUtils").DAY_MILLISECONDS-(-f.timestamp+d("WATimeUtils").unixTimeMs()),d("WALogger").LOG(r(),d("WASyncdCryptoUtils").syncKeyIdToHex(f.keyId),f.timestamp,g),w=setTimeout(z,g);case 13:case"end":return h.stop()}},null,this)}function z(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:d("WALogger").LOG(q());a.next=3;return b("regeneratorRuntime").awrap(A());case 3:if(a.sent){a.next=6;break}d("WALogger").LOG(p());return a.abrupt("return");case 6:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.TIMEOUT_WHILE_WAITING_FOR_MISSING_KEY),d("WALogger").ERROR(o()).sendLogs("syncd fatal error: timeout while waiting for missing key"),d("WABaseGlobals").getDbImpls().handleSyncdFatal();case 9:case"end":return a.stop()}},null,this)}function A(){var a,c,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:d("WALogger").LOG(n());g.next=3;return b("regeneratorRuntime").awrap(d("WAGetSyncKey").getAllSyncKeysInTransaction());case 3:g.t0=function(a){return d("WASyncdCryptoUtils").syncKeyIdToHex(a.keyId)};a=g.sent.map(g.t0);d("WALogger").LOG(m(),a);g.next=8;return b("regeneratorRuntime").awrap(d("WAGetMissingKey").getAllMissingKeysInTransaction());case 8:c=g.sent;d("WALogger").LOG(l(),c.map(function(a){return d("WASyncdCryptoUtils").syncKeyIdToHex(a.keyId)}));e=c.filter(function(b){return!a.includes(b.keyHex)});d("WALogger").LOG(k(),c.map(function(a){return d("WASyncdCryptoUtils").syncKeyIdToHex(a.keyId)}));f=e.filter(function(a){return d("WABaseGlobals").getConfig().syncdWaitForKeyTimeoutDays()*d("WATimeUtils").DAY_MILLISECONDS<d("WATimeUtils").unixTimeMs()-a.timestamp});d("WALogger").LOG(j(),f.map(function(a){return d("WASyncdCryptoUtils").syncKeyIdToHex(a.keyId)}));return g.abrupt("return",f.length>0);case 15:case"end":return g.stop()}},null,this)}function B(a){var c,e,f,g,h,j,k,l,m,n,o,p,q;return b("regeneratorRuntime").async(function(r){while(1)switch(r.prev=r.next){case 0:c=a.MissingKeyStore;r.next=3;return b("regeneratorRuntime").awrap(c.getAll());case 3:e=r.sent,(f=e,g=Array.isArray(f),h=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 5:if(!g){r.next=11;break}if(!(h>=f.length)){r.next=8;break}return r.abrupt("break",43);case 8:j=f[h++];r.next=15;break;case 11:h=f.next();if(!h.done){r.next=14;break}return r.abrupt("break",43);case 14:j=h.value;case 15:k=j,l=!0,(m=k.deviceResponses.values(),n=Array.isArray(m),o=0,m=n?m:m[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 18:if(!n){r.next=24;break}if(!(o>=m.length)){r.next=21;break}return r.abrupt("break",34);case 21:p=m[o++];r.next=28;break;case 24:o=m.next();if(!o.done){r.next=27;break}return r.abrupt("break",34);case 27:p=o.value;case 28:q=p;if(!(q==null)){r.next=32;break}l=!1;return r.abrupt("break",34);case 32:r.next=18;break;case 34:if(!l){r.next=41;break}d("WALogger").ERROR(i()).sendLogs("syncd: fatal error: missing key on all clients");d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_KEY_ON_ALL_CLIENTS);r.next=39;return b("regeneratorRuntime").awrap(d("WAAsyncSleep").asyncSleep(5e3));case 39:d("WABaseGlobals").getDbImpls().handleSyncdFatal();return r.abrupt("return");case 41:r.next=5;break;case 43:case"end":return r.stop()}},null,this)}function e(a,c){var e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:e=function(){var a=new Map();c.forEach(function(b){return a.set(b,null)});return a};f=a.map(function(a){return{keyHex:d("WASyncdCryptoUtils").syncKeyIdToHex(a),keyId:a,timestamp:d("WATimeUtils").unixTimeMs(),deviceResponses:e()}});g.next=4;return b("regeneratorRuntime").awrap(d("WAGetMissingKey").bulkUpdateMissingKeysInTransaction(f));case 4:g.next=6;return b("regeneratorRuntime").awrap(x());case 6:case"end":return g.stop()}},null,this)}g.updateMissingKeyDevices=a;g.updateMissingKeys=c;g.setMissingKeyTimeoutInTransaction=x;g.hasExpiredKeys=A;g.addMissingKeys=e}),98);
__d("WASyncdHandleMissingKeys",["Promise","WABaseGlobals","WAGetMissingKey","WAGetSyncKey","WALogger","WASyncdCryptoUtils","WASyncdError","WASyncdKeyTypes","WASyncdStoreMissingKeys","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: requestAllMissingKeys: missing keys: [","]"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: _handleMissingKeys: missing keys after filter: [","]"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: _handleMissingKeys: missing keys [","]"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: _handleMissingKeys: skipping due to resume from restart in progress"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection ","'s patches has missing keys ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: handleMissingKeysInPatches: missing key: keyId: ",", patch version: ",", patch device id: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection ","'s snapshot has missing keys ",""]);o=function(){return a};return a}var p=d("WASyncdKeyTypes").toSyncKeyId(new ArrayBuffer(0));function a(a,c){var e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:e=new Set();g.next=3;return b("regeneratorRuntime").awrap(d("WAGetSyncKey").getAllSyncKeysInTransaction());case 3:g.t0=function(a){return d("WASyncdCryptoUtils").syncKeyIdToHex(a.keyId)};f=g.sent.map(g.t0);c.records.forEach(function(a){a=a.keyId.id;if(d("WASyncdCryptoUtils").syncKeyIdsEqual(a,p))throw new(d("WASyncdError").SyncdFatalError)("snapshot has empty key");a=d("WASyncdCryptoUtils").syncKeyIdToHex(a);f.includes(a)||e.add(a)});d("WALogger").LOG(o(),a,Array.from(e));g.next=9;return b("regeneratorRuntime").awrap(q(e));case 9:case"end":return g.stop()}},null,this)}function c(a,c){var e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:e=new Set();g.next=3;return b("regeneratorRuntime").awrap(d("WAGetSyncKey").getAllSyncKeysInTransaction());case 3:g.t0=function(a){return d("WASyncdCryptoUtils").syncKeyIdToHex(a.keyId)};f=g.sent.map(g.t0);c.forEach(function(a){var b=a.keyId.id;if(d("WASyncdCryptoUtils").syncKeyIdsEqual(b,p))throw new(d("WASyncdError").SyncdFatalError)("syncd: patch has empty key. patch device id: ${p.deviceIndex}");b=d("WASyncdCryptoUtils").syncKeyIdToHex(b);f.includes(b)||(d("WALogger").LOG(n(),b,a.version.version,a.deviceIndex),e.add(b))});d("WALogger").LOG(m(),a,Array.from(e));g.next=9;return b("regeneratorRuntime").awrap(q(e));case 9:case"end":return g.stop()}},null,this)}function q(a){var c,e,f,g,i;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:if(!(d("WABaseGlobals").getConfig().offlineProcessingState()!=="idle")){m.next=3;break}d("WALogger").LOG(l());return m.abrupt("return");case 3:c=Array.from(a);d("WALogger").LOG(k(),c);m.t0=Set;m.next=8;return b("regeneratorRuntime").awrap(d("WAGetMissingKey").bulkGetMissingKeysInTransaction(c));case 8:m.t1=Boolean;m.t2=function(a){return a.keyHex};m.t3=m.sent.filter(m.t1).map(m.t2);e=new m.t0(m.t3);f=c.filter(function(a){return!e.has(a)});d("WALogger").LOG(j(),f);if(!(f.length===0)){m.next=16;break}return m.abrupt("return",(h||(h=b("Promise"))).resolve());case 16:g=f.map(function(a){return d("WASyncdKeyTypes").toSyncKeyId(d("WASyncdCryptoUtils").hexToUint8Array(a).buffer)});m.next=19;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().sendSyncdKeyRequest(g));case 19:i=m.sent;m.next=22;return b("regeneratorRuntime").awrap(d("WASyncdStoreMissingKeys").addMissingKeys(g,i));case 22:case"end":return m.stop()}},null,this)}function e(){var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(d("WAGetMissingKey").getAllMissingKeysInTransaction());case 2:a=c.sent;d("WALogger").LOG(i(),a.map(function(a){return a.keyHex}));if(!(a.length===0)){c.next=6;break}return c.abrupt("return");case 6:c.next=8;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().sendSyncdKeyRequest(a.map(function(a){return a.keyId})));case 8:case"end":return c.stop()}},null,this)}g.handleMissingKeysInSnapshot=a;g.handleMissingKeysInPatches=c;g.requestAllMissingKeys=e}),98);
__d("WASyncdValidateServerSyncProtobuf",["WALongInt","WASyncAction.pb","WASyncdError","WASyncdKeyTypes","WASyncdMetricFatalError","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){}a.validateSnapshotProtobuf=function(b,c){var e=c.version,f=c.records,g=c.mac;c=c.keyId;var h=e==null?void 0:e.version;if(!e||h==null){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_SNAPSHOT_VERSION,b);throw new(d("WASyncdError").SyncdFatalError)("missing snapshot version")}e=f.map(function(c){return a.validateRecordProtobuf(b,c)});if(!g){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_SNAPSHOT_MAC,b);throw new(d("WASyncdError").SyncdFatalError)("missing snapshot mac")}f=a.validateKeyIdProtobuf(b,c,d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_SNAPSHOT_KEY_ID);return{version:{version:d("WALongInt").numberOrThrowIfTooLarge(h)},records:e,mac:g,keyId:f}};a.validatePatchProtobuf=function(b,c){var e=c.version,f=c.mutations,g=c.externalMutations,h=c.snapshotMac,i=c.patchMac,j=c.keyId,k=c.exitCode,l=c.deviceIndex;c=c.clientDebugData;var m=e==null?void 0:e.version;if(!e||m==null){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_PATCH_VERSION,b);throw new(d("WASyncdError").SyncdFatalError)("missing patch version")}if(f&&f.length>0&&g){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.PATCH_WITH_BOTH_INLINE_AND_EXTERNAL_MUTATIONS,b);throw new(d("WASyncdError").SyncdFatalError)("patch with both inline and external mutations")}if(!h){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_PATCH_SNAPSHOT_MAC,b);throw new(d("WASyncdError").SyncdFatalError)("missing patch snapshot mac")}if(!i){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_PATCH_MAC,b);throw new(d("WASyncdError").SyncdFatalError)("missing patch mac")}e=a.validateKeyIdProtobuf(b,j,d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_PATCH_KEY_ID);j=void 0;c!=null&&(j=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").PatchDebugDataSpec,c));if(g){c=a.validateExternalBlobReference(b,g);return{version:{version:d("WALongInt").numberOrThrowIfTooLarge(m)},mutations:void 0,externalMutations:c,snapshotMac:h,patchMac:i,keyId:e,deviceIndex:l,clientDebugData:j}}g=f.map(function(c){return a.validateMutationProtobuf(b,c)});return{version:{version:d("WALongInt").numberOrThrowIfTooLarge(m)},mutations:g,externalMutations:void 0,exitCode:k,snapshotMac:h,patchMac:i,keyId:e,deviceIndex:l,clientDebugData:j}};a.validateExternalBlobReference=function(a,b){var c=b.mediaKey,e=b.directPath,f=b.handle,g=b.fileSizeBytes,h=b.fileSha256;b=b.fileEncSha256;if(!c){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_EXTERNAL_BLOB_REFERENCE_MEDIA_KEY,a);throw new(d("WASyncdError").SyncdFatalError)("missing external blob reference media key")}if(e==null){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_EXTERNAL_BLOB_REFERENCE_DIRECT_PATH,a);throw new(d("WASyncdError").SyncdFatalError)("missing external blob reference direct path")}if(!h){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_EXTERNAL_BLOB_REFERENCE_FILE_SHA256,a);throw new(d("WASyncdError").SyncdFatalError)("missing external blob reference file SHA256")}if(!b){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_EXTERNAL_BLOB_REFERENCE_FILE_ENC_SHA256,a);throw new(d("WASyncdError").SyncdFatalError)("missing external blob reference file enc SHA256")}return{mediaKey:c,directPath:e,handle:f,fileSizeBytes:g,fileSha256:h,fileEncSha256:b}};a.validateMutationProtobuf=function(b,c){var e=c.operation;c=c.record;if(e==null){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_MUTATION_OPERATION,b);throw new(d("WASyncdError").SyncdFatalError)("missing mutation operation")}if(!c){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_MUTATION_RECORD,b);throw new(d("WASyncdError").SyncdFatalError)("missing mutation record")}b=a.validateRecordProtobuf(b,c);return{operation:e,record:b}};a.validateRecordProtobuf=function(b,c){var e=c.index,f=c.value;c=c.keyId;var g=e==null?void 0:e.blob,h=f==null?void 0:f.blob;if(!e||!g){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_MUTATION_INDEX,b);throw new(d("WASyncdError").SyncdFatalError)("missing mutation index")}if(!f||!h){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_MUTATION_VALUE,b);throw new(d("WASyncdError").SyncdFatalError)("missing mutation value")}e=a.validateKeyIdProtobuf(b,c,d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_MUTATION_KEY_ID);return{index:{blob:g},value:{blob:h},keyId:e}};a.validateKeyIdProtobuf=function(a,b,c){var e=b==null?void 0:b.id;if(!b||!e){d("WASyncdMetricFatalError").reportSyncdFatalError(c,a);throw new(d("WASyncdError").SyncdFatalError)("missing mutation key id")}return{id:d("WASyncdKeyTypes").toSyncKeyId(e)}};return a}();g["default"]=a}),98);
__d("WASyncdMMSDownload",["WABaseGlobals","WASyncdDecode","WASyncdValidateServerSyncProtobuf","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){var f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:h.next=2;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().downloadSyncBlob(e,"snapshot",a));case 2:f=h.sent;g=d("WASyncdDecode").decodeSyncdSnapshot(a,f);return h.abrupt("return",c("WASyncdValidateServerSyncProtobuf").validateSnapshotProtobuf(a,g));case 5:case"end":return h.stop()}},null,this)}function e(a,e){var f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:h.next=2;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().downloadSyncBlob(e,"patch",a));case 2:f=h.sent;g=d("WASyncdDecode").decodeSyncdMutations(a,f).mutations;return h.abrupt("return",g.map(function(b){return c("WASyncdValidateServerSyncProtobuf").validateMutationProtobuf(a,b)}));case 5:case"end":return h.stop()}},null,this)}g.downloadSnapshot=a;g.downloadExternalPatch=e}),98);
__d("WASyncdMetricCriticalBootstrapStage",["$InternalEnum","WALogger","WAPREList","WAPREMetrics","WASyncAction.pb","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown SyncdDecryptMutationsType for DecryptMutations"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing decryptedMutationMessageRangeCountArray for DecryptMutations"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing totalAdditionalMessagesCount for DecryptMutations"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing count for DecryptMutations"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing type for DecryptMutations"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown bootstrap stage: "," for critical bootstrap stage"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing bootstrap stage for critical bootstrap stage"]);n=function(){return a};return a}var o=b("$InternalEnum").Mirrored(["ABOUT_TO_APPLY_MUTATIONS","APPLIED_MUTATIONS","MUTATIONS_DECRYPTED","REQUEST_BUILT","RESPONSE_RECEIVED","RESPONSE_PARSED_VALID","ENTERED_RETRY_MODE","MISSING_KEYS_RECEIVED"]),p=b("$InternalEnum").Mirrored(["PATCH_MUTATIONS","SNAPSHOT_MUTATIONS"]);function q(a){d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_CRITICAL_BOOTSTRAP_STAGE).endSuccess(r({type:a}))}function a(a,b){q(o.MUTATIONS_DECRYPTED),d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_DECRYPT_MUTATIONS).endSuccess(s({type:a,mutations:b}))}function r(a){return{string:{criticalBootstrapStage:a.type}}}function s(a){var b=a.type;a=a.mutations;var c,e=0,f=[];a.forEach(function(a){a=a.binarySyncData;a=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,a);a=a.value;if(a==null)return;a.archiveChatAction?c=a.archiveChatAction.messageRange:a.markChatAsReadAction?c=a.markChatAsReadAction.messageRange:a.clearChatAction?c=a.clearChatAction.messageRange:a.deleteChatAction&&(c=a.deleteChatAction.messageRange);c!=null&&(e+=c.messages.length,f.push(c.messages.length))});return{string:{mutationType:b},"int":{count:a.length,totalAdditionalMessagesCount:e},int_array:{messageRangeLengths:f}}}function c(a){a=a==null?void 0:(a=a.string)==null?void 0:a.criticalBootstrapStage;if(a==null){d("WALogger").ERROR(n());return null}var b=o.cast(a);if(b==null){d("WALogger").ERROR(m(),a);return null}return{type:b}}function e(a){var b,c,e;b=a==null?void 0:(b=a.string)==null?void 0:b.mutationType;c=a==null?void 0:(c=a["int"])==null?void 0:c.count;e=a==null?void 0:(e=a["int"])==null?void 0:e.totalAdditionalMessagesCount;a=a==null?void 0:(a=a.int_array)==null?void 0:a.messageRangeLengths;if(b==null){d("WALogger").ERROR(l());return null}if(c==null){d("WALogger").ERROR(k());return null}if(e==null){d("WALogger").ERROR(j());return null}if(a==null){d("WALogger").ERROR(i());return null}b=p.cast(b);if(b==null){d("WALogger").ERROR(h());return null}return{type:b,count:c,totalAdditionalMessagesCount:e,decryptedMutationMessageRangeCountArray:a}}g.SyncdCriticalBootstrapStageType=o;g.SyncdDecryptMutationsType=p;g.reportSyncdCriticalBootstrapStage=q;g.reportSyncdDecryptedMutations=a;g.convertSyncdCriticalBootstrapStageFromAnnotations=c;g.convertSyncdDecryptMutationsMetricsFromAnnotations=e}),98);
__d("WASyncdResolveConflict",["Promise","WAGetPendingMutation","WASyncdConst","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,c){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(a.map(function(a){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:d=c.get(a.index);if(!d){f.next=8;break}e=a.actionHandler;f.t0=a.index;f.next=6;return b("regeneratorRuntime").awrap(e.resolveConflicts(d,a));case 6:f.t1=f.sent;return f.abrupt("return",{remoteMutationIndex:f.t0,conflictResolutionState:f.t1});case 8:case"end":return f.stop()}},null,this)})));case 2:d=f.sent;e=new Map();d.forEach(function(a){a&&e.set(a.remoteMutationIndex,a.conflictResolutionState)});return f.abrupt("return",e);case 6:case"end":return f.stop()}},null,this)}function a(a,c){var e,f,g,h,j,k,l,m,n,o;return b("regeneratorRuntime").async(function(p){while(1)switch(p.prev=p.next){case 0:e=[];f=[];p.next=4;return b("regeneratorRuntime").awrap(d("WAGetPendingMutation").getSyncPendingMutationsByCollectionInTransaction(a));case 4:g=p.sent;h=new Map(g.map(function(a){return[a.index,a]}));p.next=8;return b("regeneratorRuntime").awrap(i(c,h));case 8:j=p.sent,c.forEach(function(a){var b=j.get(a.index);if(b)switch(b){case d("WASyncdConst").ConflictResolutionState.SkipRemote:break;case d("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal:e.push(a);f=f.concat(g.filter(function(b){return b.index===a.index}));break;case d("WASyncdConst").ConflictResolutionState.SkipRemoteAndDropLocal:f=f.concat(g.filter(function(b){return b.index===a.index}));break}else e.push(a)}),k=[],l=0;case 12:if(!(l<e.length)){p.next=21;break}m=e[l].actionHandler;p.next=16;return b("regeneratorRuntime").awrap(m.dropMutationDueToCrossIndexConflict(e[l],h));case 16:n=p.sent,n||k.push(e[l]);case 18:l++;p.next=12;break;case 21:o=f.map(function(a){return a.id}).filter(Boolean);return p.abrupt("return",{remoteMutationsToApply:k,pendingSetMutationsToDrop:o});case 23:case"end":return p.stop()}},null,this)}g.resolveConflict=a}),98);
__d("WASyncdValidateMutations",["Promise","WABaseGlobals","WACryptoUtils","WAGetSyncAction","WALogger","WALongInt","WAServerSync.pb","WASyncAction.pb","WASyncdConst","WASyncdError","WASyncdMetricFatalError","decodeProtobuf","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: is using same timestamp? ","\n          is same key? ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: all duplicated actions:"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["validation not required for local mutations"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: duplicate "," mutation: ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: duplicate "," mutation: [not specified]"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: duplicate "," mutation: ",""]);q=function(){return a};return a}function a(a,b){var c=new Set();b.forEach(function(b){b=b.version.version;if(c.has(b)){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.DUPLICATE_PATCH_VERSION_IN_COLLECTION,a);throw new(d("WASyncdError").SyncdFatalError)("duplicate patch version in collection")}c.add(b)})}function r(a){return a==null?!0:[d("WASyncdConst").Actions.Agent,d("WASyncdConst").Actions.AndroidUnsupportedActions,d("WASyncdConst").Actions.Archive,d("WASyncdConst").Actions.BotWelcomeRequest,d("WASyncdConst").Actions.ChatAssignment,d("WASyncdConst").Actions.ChatAssignmentOpenedStatus,d("WASyncdConst").Actions.ChatLockSettings,d("WASyncdConst").Actions.ClearChat,d("WASyncdConst").Actions.Contact,d("WASyncdConst").Actions.CustomPaymentMethods,d("WASyncdConst").Actions.DeleteChat,d("WASyncdConst").Actions.DeleteMessageForMe,d("WASyncdConst").Actions.DeviceCapabilities,d("WASyncdConst").Actions.DisableLinkPreviews,d("WASyncdConst").Actions.ExternalWebBeta,d("WASyncdConst").Actions.FavoriteSticker,d("WASyncdConst").Actions.LabelEdit,d("WASyncdConst").Actions.LabelJid,d("WASyncdConst").Actions.LabelMessage,d("WASyncdConst").Actions.LabelReordering,d("WASyncdConst").Actions.LocaleSetting,d("WASyncdConst").Actions.LockChat,d("WASyncdConst").Actions.MarkChatAsRead,d("WASyncdConst").Actions.MarketingMessage,d("WASyncdConst").Actions.MarketingMessageBroadcast,d("WASyncdConst").Actions.Mute,d("WASyncdConst").Actions.Nux,d("WASyncdConst").Actions.PaymentInfo,d("WASyncdConst").Actions.Pin,d("WASyncdConst").Actions.PinDEPRECATED,d("WASyncdConst").Actions.PnForLidChat,d("WASyncdConst").Actions.PrimaryFeature,d("WASyncdConst").Actions.PrimaryVersion,d("WASyncdConst").Actions.QuickReply,d("WASyncdConst").Actions.RemoveRecentSticker,d("WASyncdConst").Actions.Sentinel,d("WASyncdConst").Actions.SettingPushName,d("WASyncdConst").Actions.ShareOwnPn,d("WASyncdConst").Actions.Star,d("WASyncdConst").Actions.StatusPrivacy,d("WASyncdConst").Actions.Subscription,d("WASyncdConst").Actions.TimeFormat,d("WASyncdConst").Actions.UnarchiveChatsSetting,d("WASyncdConst").Actions.UserStatusMute,d("WASyncdConst").Actions.Favorites,d("WASyncdConst").Actions.NoteEdit].includes(a)}function s(a){var b=d("WASyncdConst").Actions.cast(JSON.parse(a.index)[0]),c=a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET?"SET":"REMOVE";r(b)?d("WALogger").LOG(q(),c,b):d("WALogger").LOG(p(),c);d("WALogger").DEV(o(),c,a.index)}function c(a,b,c){var e=new Set(),f=new Set();b.forEach(function(g){var h=!1;g.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET&&(e.has(g.index)?(s(g),h=!0):e.add(g.index));g.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE&&(f.has(g.index)?(s(g),h=!0):f.add(g.index));if(h)switch(c){case d("WASyncdConst").SyncDataType.Patch:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_PATCH,a);throw new(d("WASyncdError").SyncdFatalError)("same index for multiple mutations in patch");case d("WASyncdConst").SyncDataType.Snapshot:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_SNAPSHOT,a,void 0,void 0,!1);u(b);break;case d("WASyncdConst").SyncDataType.Local:d("WALogger").WARN(n())}})}function e(a,c){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:d=Array.from(new Set(a.filter(function(a){return a.index.indexOf('"lock_chat"')!==-1}).map(function(a){return a.index})));if(!(d.length>10||d.length===0)){f.next=3;break}return f.abrupt("return");case 3:e=d.map(function(b){return t(b,a,c)});f.next=6;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(e));case 6:case"end":return f.stop()}},null,this)}function t(a,c,e){var f,g,h,i,j,n,o;return b("regeneratorRuntime").async(function(p){while(1)switch(p.prev=p.next){case 0:f=c.filter(function(b){return b.index===a});g=f.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET}).at(0);h=f.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE}).at(0);p.next=5;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionInTransaction(a));case 5:i=p.sent;if(!(g!=null&&i!=null&&!d("WACryptoUtils").arrayBuffersEqual(g.indexMac,i.indexMac))){p.next=21;break}if(!(h==null)){p.next=14;break}j="syncd: lock_chat incoming set without remove for existing mutation in version "+e;d("WALogger").ERROR(m(),j).sendLogs("syncd: lock_chat incoming set without remove existing mutation");p.next=12;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(d("WASyncdConst").CollectionName.RegularLow,j));case 12:p.next=19;break;case 14:if(d("WACryptoUtils").arrayBuffersEqual(h.indexMac,i.indexMac)){p.next=19;break}n="syncd: lock_chat incoming remove has a different mac than existing mutation in version "+e;d("WALogger").ERROR(l(),n).sendLogs("syncd: lock_chat incoming remove has different mac than existing");p.next=19;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(d("WASyncdConst").CollectionName.RegularLow,n));case 19:p.next=26;break;case 21:if(!(i==null&&h!=null)){p.next=26;break}o="syncd: lock_chat incoming remove but there is no existing mutation in version "+e;d("WALogger").ERROR(k(),o).sendLogs("syncd: lock_chat remove without existing mutation");p.next=26;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(d("WASyncdConst").CollectionName.RegularLow,o));case 26:case"end":return p.stop()}},null,this)}function u(a){d("WALogger").LOG(j());var b=new Map();a.forEach(function(a){if(b.has(a.index)){s(a);var c=b.get(a.index);if(c==null)return;var e=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,a.binarySyncData).value,f=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,c.binarySyncData).value;d("WALogger").LOG(i(),(e==null?void 0:e.timestamp)===(f==null?void 0:f.timestamp),d("WACryptoUtils").arrayBuffersEqual(a.keyId,c==null?void 0:c.keyId))}b.set(a.index,a)})}function f(a,b){return b.map(function(b){var c=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,b.binarySyncData);c=c.value;if(!c){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_ACTION_VALUE,a);throw new(d("WASyncdError").SyncdFatalError)("missing action value")}c=d("WALongInt").maybeNumberOrThrowIfTooLarge(c.timestamp);if(c==null){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MISSING_ACTION_TIMESTAMP,a);throw new(d("WASyncdError").SyncdFatalError)("missing action timestamp")}return{index:b.index,version:b.version,keyId:b.keyId,indexMac:b.indexMac,valueMac:b.valueMac,collection:b.collection,binarySyncData:b.binarySyncData,timestamp:c}})}g.validateNoDuplicatePatchVersionInCollection=a;g.validateNoSameIndexForMultipleMutations=c;g.validateLockChat=e;g.validateSingleLockChat=t;g.validateAndTypeSetMutations=f}),98);
__d("WASyncdWamAppState",["WAPREList","WAPREMetrics","WAShiftTimer"],(function(a,b,c,d,e,f,g){"use strict";var h=k(),i=new(d("WAShiftTimer").ShiftTimer)(c),j=1e3*60*5;function a(){i.isScheduled()&&i.forceRunNow()}function k(){return{mutationCount:0,invalidActionCount:0,unsupportedActionCount:0,keyRotationRemoveCount:0,storedMutationCount:0,uploadConflictCount:0,unsetActionCount:0,missingKeyCount:0}}function l(){h=k()}function m(a){return{"int":babelHelpers["extends"]({},a)}}function b(a){var b;return{mutationCount:(a==null?void 0:(b=a["int"])==null?void 0:b.mutationCount)||0,invalidActionCount:(a==null?void 0:(b=a["int"])==null?void 0:b.invalidActionCount)||0,unsupportedActionCount:(a==null?void 0:(b=a["int"])==null?void 0:b.unsupportedActionCount)||0,keyRotationRemoveCount:(a==null?void 0:(b=a["int"])==null?void 0:b.keyRotationRemoveCount)||0,storedMutationCount:(a==null?void 0:(b=a["int"])==null?void 0:b.storedMutationCount)||0,uploadConflictCount:(a==null?void 0:(b=a["int"])==null?void 0:b.uploadConflictCount)||0,unsetActionCount:(a==null?void 0:(b=a["int"])==null?void 0:b.unsetActionCount)||0,missingKeyCount:(a==null?void 0:(b=a["int"])==null?void 0:b.missingKeyCount)||0}}function c(){var a=m(h);l();d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.APP_STATE_SYNC_DAILY).endSuccess(a)}function n(){i.onOrBefore(j)}function e(a){if(a===0)return;h.mutationCount+=a;n()}function f(a){h.invalidActionCount=a,n()}function o(a){h.unsupportedActionCount=a,n()}function p(a){if(a===0)return;h.keyRotationRemoveCount+=a;n()}function q(a){h.storedMutationCount=a,n()}function r(){h.uploadConflictCount++,n()}function s(a){if(a===0)return;h.unsetActionCount+=a;n()}function t(a){h.missingKeyCount=a,n()}g.forceCommitAppState=a;g.clear=l;g.convertAppStateSyncDailyFromAnnotations=b;g.addMutationCount=e;g.setInvalidActionCount=f;g.setUnsupportedActionCount=o;g.addKeyRotationRemoveCount=p;g.setStoredMutationCount=q;g.incConflict=r;g.addUnsetActionCount=s;g.setMissingKeyCount=t}),98);
__d("WASyncdCollectionHandler",["Promise","WAArrayBufferUtils","WABaseGlobals","WACryptoUtils","WAGetCollectionVersion","WAGetMissingKey","WAGetPendingMutation","WAGetSyncAction","WALogger","WALongInt","WANullthrows","WAServerSync.pb","WASyncAction.pb","WASyncdAntiTampering","WASyncdCollectionHandlerTypesConverter","WASyncdCollectionUtils","WASyncdConst","WASyncdCrypto","WASyncdCryptoUtils","WASyncdDecryptMutations","WASyncdError","WASyncdGetActionHandler","WASyncdHandleMissingKeys","WASyncdKeyCache","WASyncdKeyTypes","WASyncdMMSDownload","WASyncdMetricCriticalBootstrapStage","WASyncdMetricFatalError","WASyncdMetrics","WASyncdResolveConflict","WASyncdValidateMutations","WASyncdValidateServerSyncProtobuf","WASyncdWamAppState","WATimeUtils","decodeProtobuf","err","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: no handler for action ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: invalid action ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: no handler for action ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: invalid action ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose([""," syncd: after apply remove mutations for ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose([""," syncd: before apply remove mutations for ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose([""," syncd: completed apply set mutations for ","  ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: max timestamp from recent patch: "," days agp"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose([""," syncd: after apply mutation batch for ","  ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: actionStates after apply ",": ",""]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["synd: catching error during _applySetMutations: ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose([""," syncd: after applying mutations for handler "," ",""]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: before apply mutation batch for "," v",". mutations count: ","  ",""]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: applying mutations "," for handler "," ",""]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: completed final transaction in _applyPatch for "," v",""]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: [","] skip applying syncd old version ",""]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: processed "," mutations in patch version "," of collection ",""]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: completed _applyRemoveMutations for "," v",""]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: completed computeLtHashAndValidatePatch for "," v",""]);B=function(){return a};return a}function C(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: ",": empty patch found"]);C=function(){return a};return a}function D(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: applying patch "," v"," from device ","\n    SET count: ","\n    REMOVE count: ",""]);D=function(){return a};return a}function E(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: failed to validate missing remove mutations: ",""]);E=function(){return a};return a}function F(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: ",""]);F=function(){return a};return a}function G(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: ",""]);G=function(){return a};return a}function H(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: no patches for collection ",""]);H=function(){return a};return a}function I(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: UI is unblocked, waited for ","ms"]);I=function(){return a};return a}function J(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: patches have "," mutations, wait for UI unblock"]);J=function(){return a};return a}function K(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: completed applying snapshot for ",""]);K=function(){return a};return a}function L(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);L=function(){return a};return a}function M(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: [","] skip applying syncd old version ",""]);M=function(){return a};return a}function N(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: collection ","'s snapshot v"," applied"]);N=function(){return a};return a}function O(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: processed "," mutations in snapshot of collection "," v",""]);O=function(){return a};return a}function P(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: collection ","'s snapshot decrypted"]);P=function(){return a};return a}function Q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: collection ","'s snapshot validated"]);Q=function(){return a};return a}function R(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: start validate ","'s snapshot"]);R=function(){return a};return a}function S(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: ","'s external patch downloaded"]);S=function(){return a};return a}function T(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: download patch for ",""]);T=function(){return a};return a}function U(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: download snapshot for ",""]);U=function(){return a};return a}function V(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: uploaded inconsistent index mac"]);V=function(){return a};return a}function aa(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);aa=function(){return a};return a}function ba(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: failed to debug upload: ",""]);ba=function(){return a};return a}function ca(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: "," "]);ca=function(){return a};return a}function da(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: "," "]);da=function(){return a};return a}function ea(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: "," "]);ea=function(){return a};return a}function fa(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: end _uploadSuccessful for ",""]);fa=function(){return a};return a}function ga(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);ga=function(){return a};return a}function ha(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: [","] skip applying syncd old version ",""]);ha=function(){return a};return a}function ia(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: _uploadSuccessful: write to db for ",""]);ia=function(){return a};return a}function ja(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: _uploadSuccessful: unexpected server version (",") after patch upload, expected ",""]);ja=function(){return a};return a}function ka(){var a=babelHelpers.taggedTemplateLiteralLoose(["",":\n      lastSuccessfulSyncEndTime = "," ("," days ago))\n      lastSyncAttemptStartTimes = ","\n      lastSyncAttemptStartTimes by days ago: ","\n    "]);ka=function(){return a};return a}function la(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing patch info:"]);la=function(){return a};return a}function ma(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: could not log max timestamp: ",""]);ma=function(){return a};return a}function na(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: retryable error: "," throws ",""]);na=function(){return a};return a}function oa(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: "," throws ",""]);oa=function(){return a};return a}function pa(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: key error: "," missing keys"]);pa=function(){return a};return a}function qa(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: applyAppStateSyncResponse: finished applying "," in ","ms"]);qa=function(){return a};return a}function ra(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: sync "," but there are no updates"]);ra=function(){return a};return a}function sa(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: "," v"," uploaded successfully"]);sa=function(){return a};return a}function ta(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: "," patches applied successfully"]);ta=function(){return a};return a}function ua(){var a=babelHelpers.taggedTemplateLiteralLoose([""," syncd: has missing patches. collection: ",""]);ua=function(){return a};return a}function va(){var a=babelHelpers.taggedTemplateLiteralLoose([""," syncd: has missing patches. collection: ",", localVersion: ",",\n           minPatch: ",""]);va=function(){return a};return a}function wa(){var a=babelHelpers.taggedTemplateLiteralLoose([""," syncd: missing keys: [","]"]);wa=function(){return a};return a}function xa(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: "," snapshot and patches applied successfully"]);xa=function(){return a};return a}function ya(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: start applying collection ",""]);ya=function(){return a};return a}function za(){var a=babelHelpers.taggedTemplateLiteralLoose([""," syncd: end applyIndividualMutations"]);za=function(){return a};return a}function Aa(){var a=babelHelpers.taggedTemplateLiteralLoose([""," syncd: end update db after apply individual mutations for collection ",""]);Aa=function(){return a};return a}function Ba(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: end apply individual mutations for collection ",""]);Ba=function(){return a};return a}function Ca(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: could not find original individual mutation"]);Ca=function(){return a};return a}function Da(){var a=babelHelpers.taggedTemplateLiteralLoose([""," syncd: apply individual mutations for collection ",""]);Da=function(){return a};return a}function Ea(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: start applyIndividualMutations"]);Ea=function(){return a};return a}var Fa=0,Ga=new ArrayBuffer(128);function a(a){var c,e,f,g,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:if(!(a.length===0)){j.next=2;break}return j.abrupt("return",(h||(h=b("Promise"))).resolve());case 2:c=Math.random().toString(36).substr(2,5);e=a.sort(function(a,b){return a.timestamp-b.timestamp});d("WALogger").LOG(Ea());f=d("WASyncdCollectionHandlerTypesConverter").syncActionsToDecryptedMutation(e);g=f.reduce(function(a,b){var c;c=(c=a.get(b.collection))!=null?c:[];c.push(b);a.set(b.collection,c);return a},new Map());i=Array.from(g.keys()).map(function(e){var f,h,i,j,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:d("WALogger").LOG(Da(),c,e);f=g.get(e);if(!(f===void 0)){m.next=4;break}return m.abrupt("return");case 4:m.next=6;return b("regeneratorRuntime").awrap(Y(e,f,d("WASyncdConst").SyncDataType.Local,c,null,null));case 6:h=m.sent;i=h.setMutationsToPersist;j=h.pendingSetMutationsToDrop;k=i.map(function(a){return{actionState:a.actionState,index:a.index,modelId:a.modelId,modelType:a.modelType,isIndividualMutation:!0}});l=k;d("WABaseGlobals").getConfig().syncShouldPersistOnlyUpdatedIndividualMutation()&&(l=k.filter(function(b){var c=a.find(function(a){return a.index===b.index});if(c==null){d("WALogger").ERROR(Ca()).sendLogs("syncd: could not find original individual mutation");return!0}return b.actionState!==c.actionState||b.modelId!==c.modelId||b.modelType!==c.modelType}));d("WALogger").LOG(Ba(),c,e);m.next=15;return b("regeneratorRuntime").awrap(d("WABaseGlobals").runInTransaction({SyncActionStore:!0,PendingMutationStore:!0},function(a){var c,d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:c=a.SyncActionStore,d=a.PendingMutationStore;if(!(l.length>0)){e.next=4;break}e.next=4;return b("regeneratorRuntime").awrap(c.bulkUpdate(l));case 4:if(!(j.length>0)){e.next=7;break}e.next=7;return b("regeneratorRuntime").awrap(d.bulkRemove(j));case 7:case"end":return e.stop()}},null,this)}));case 15:d("WALogger").LOG(Aa(),c,e);case 16:case"end":return m.stop()}},null,this)});j.next=10;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(i));case 10:d("WALogger").LOG(za(),c);case 11:case"end":return j.stop()}},null,this)}function e(a,c,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C;return b("regeneratorRuntime").async(function(D){while(1)switch(D.prev=D.next){case 0:g=a.name,h=a.version,i=a.patches,j=a.snapshot,k=a.syncedPendingMutationsId,l=a.syncedEncryptedMutations;d("WALogger").LOG(ya(),c,g);D.prev=2;f==null?void 0:f.mark("external_mutations_download_start",{patchCount:(m=a.patches)==null?void 0:m.length,snapshotSizeBytes:(n=a.snapshot)==null?void 0:n.fileSizeBytes});D.next=6;return b("regeneratorRuntime").awrap(Ma(g,i,j,e));case 6:o=D.sent;p=o[0];q=o[1];f==null?void 0:f.mark("external_mutations_download_end",{patchesWithMutationsCount:q==null?void 0:q.length,snapshotRecordsCount:p==null?void 0:p.records.length});r=performance.now();if(!(p!=null)){D.next=17;break}D.next=14;return b("regeneratorRuntime").awrap(Pa(g,p,q,f,c));case 14:d("WALogger").LOG(xa(),c,g);D.next=64;break;case 17:if(!(q!=null)){D.next=43;break}s=Math.min.apply(Math,q.map(function(a){return a.version.version}));t=e!=null&&s>e+1&&q.length>0;if(!t){D.next=38;break}D.next=23;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(g,c+" has missing patches"));case 23:D.next=25;return b("regeneratorRuntime").awrap(d("WAGetMissingKey").getAllMissingKeysInTransaction());case 25:u=D.sent;d("WALogger").LOG(wa(),c,u.map(function(a){return a.keyHex+":"+a.timestamp}));d("WALogger").LOG(va(),c,g,e,s);D.next=30;return b("regeneratorRuntime").awrap(Ha(g,q[0]));case 30:D.next=32;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().printSyncdLog(g));case 32:D.next=34;return b("regeneratorRuntime").awrap(Ia());case 34:d("WALogger").ERROR(ua(),c,g).sendLogs("syncd: has missing patches");if(!d("WABaseGlobals").getConfig().syncdShouldFatalOnMissingPatch()){D.next=38;break}d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.SERVER_DID_NOT_SEND_ALL_PATCHES,g,void 0,(v=e)!=null?v:0);throw new(d("WASyncdError").SyncdFatalError)("syncd: has missing patches");case 38:D.next=40;return b("regeneratorRuntime").awrap(Ra(g,q,f,c));case 40:d("WALogger").LOG(ta(),c,g);D.next=64;break;case 43:if(!(h!=null)){D.next=60;break}w=l.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET}).length;x=l.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE}).length;y=Array.from(new Set(l.map(function(a){return a.index}))).length;D.next=49;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(g,c+" start upload patch. version: "+h+". mutation count: "+l.length+",\n        numSet: "+w+", numRemove: "+x+", numUniqueIndex: "+y));case 49:D.next=51;return b("regeneratorRuntime").awrap(Ja(g,h,k,l,c));case 51:D.next=53;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getConfig().getShortMdSessionId());case 53:z=D.sent;l.forEach(function(a){var b=JSON.parse(a.index)[0];d("WABaseGlobals").getConfig().syncReportMutationToWam(g,h,!1,d("WASyncdCryptoUtils").arrayBufferToHexPadded(a.indexMac).slice(-16),b,a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE,!0,z)});D.next=57;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(g,c+" end upload patches"));case 57:d("WALogger").LOG(sa(),c,g,h);D.next=64;break;case 60:if(!d("WASyncdCollectionUtils").isBootstrap(e)){D.next=63;break}D.next=63;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").updateCollectionVersionAndLtHashInTransaction(g,Fa,Ga));case 63:d("WALogger").LOG(ra(),g);case 64:A=Math.floor(performance.now()-r);d("WALogger").LOG(qa(),g,A);(q||p)&&(d("WASyncdCollectionUtils").isBootstrap(e)&&!d("WASyncdCollectionUtils").isCriticalCollection(g)&&(B=p!=null,d("WASyncdMetrics").reportSyncdBootstrapDataApplied(g,B?d("WASyncdMetrics").SyncdBootstrapDataAppliedSnapshotUsed.SNAPSHOT_USED:d("WASyncdMetrics").SyncdBootstrapDataAppliedSnapshotUsed.SNAPSHOT_NOT_USED,A)));return D.abrupt("return",a);case 70:D.prev=70;D.t0=D["catch"](2);C=D.t0.message;D.next=75;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(g,"error (maybe retryable): "+D.t0));case 75:if(!(D.t0 instanceof d("WASyncdError").SyncdMissingKeyError)){D.next=78;break}d("WALogger").WARN(pa(),g);return D.abrupt("return",{name:g,state:d("WASyncdConst").CollectionState.Blocked});case 78:if(!(D.t0 instanceof d("WASyncdError").SyncdFatalError)){D.next=81;break}d("WALogger").ERROR(oa(),g,C).sendLogs("syncd: fatal error: "+String(g)+" throws "+C);return D.abrupt("return",{name:g,state:d("WASyncdConst").CollectionState.ErrorFatal});case 81:d("WALogger").WARN(na(),g,C).sendLogs("syncd: retryable error: "+String(g)+" throws "+C);return D.abrupt("return",{name:g,state:d("WASyncdConst").CollectionState.ErrorRetry});case 83:case"end":return D.stop()}},null,this,[[2,70]])}function Ha(a,c){var e,f,g,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:k.prev=0;k.next=3;return b("regeneratorRuntime").awrap(d("WASyncdDecryptMutations").tryDecryptPatch(a,c));case 3:f=k.sent;g=f.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET});h=d("WASyncdValidateMutations").validateAndTypeSetMutations(a,g);i=h.length>0?h[0].timestamp:null;j=i==null?null:d("WATimeUtils").daysDiff(d("WATimeUtils").unixTimeMs(),i);k.next=10;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"max timestamp in first patch: "+((e=j)!=null?e:"n/a")+" days ago"));case 10:k.next=15;break;case 12:k.prev=12,k.t0=k["catch"](0),d("WALogger").WARN(ma(),k.t0);case 15:case"end":return k.stop()}},null,this,[[0,12]])}function Ia(){var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:d("WALogger").LOG(la());c.next=3;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getAllCollectionVersionsInTransaction());case 3:a=c.sent,a.forEach(function(a){var b;b=((b=a.lastSyncAttemptStartTimes)!=null?b:[]).map(function(a){return d("WATimeUtils").daysDiff(d("WATimeUtils").unixTimeMs(),a)});var c=a.lastSuccessfulSyncEndTime;c=c==null?null:d("WATimeUtils").daysDiff(d("WATimeUtils").unixTimeMs(),c);d("WALogger").LOG(ka(),a.collection,a.lastSuccessfulSyncEndTime,c,a.lastSyncAttemptStartTimes,b)});case 5:case"end":return c.stop()}},null,this)}function Ja(a,c,e,f,g){var h,i,j,k,l,m,n,o,p,q,r;return b("regeneratorRuntime").async(function(s){while(1)switch(s.prev=s.next){case 0:i=f.map(function(a){return{indexMac:a.indexMac,valueMac:a.valueMac,operation:a.operation}});s.next=3;return b("regeneratorRuntime").awrap(Ka(g,a,f,i));case 3:s.next=5;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").computeLtHash(a,i,g,null,c,d("WASyncdAntiTampering").SyncdPatchDirection.Outgoing));case 5:j=s.sent;k=j.ltHash;l=d("WASyncdCollectionHandlerTypesConverter").encryptedUploadMutationsToSyncActions(f.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET}),d("WASyncdConst").SyncActionState.Success);s.next=10;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"["+g+"] set mutation during upload: "+l.map(function(a){return d("WASyncdAntiTampering").indexAndValueMacToString(a.indexMac,a.valueMac)}).join("\n\t")));case 10:m=new Set(l.map(function(a){return a.index}));n=f.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE&&!m.has(a.index)}).map(function(a){return a.index});s.next=14;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"["+g+"] count removed during upload: "+n.length));case 14:s.next=16;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getCollectionVersionInTransaction(a).then(function(a){return a==null?void 0:a.version}));case 16:s.t0=h=s.sent;if(!(s.t0!=null)){s.next=21;break}s.t1=h;s.next=22;break;case 21:s.t1=0;case 22:o=s.t1;c!==o+1&&d("WALogger").ERROR(ja(),c,o+1).sendLogs("syncd: unexpected server version after patch upload");d("WALogger").LOG(ia(),g,a);s.next=27;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").logMacsInSnapshot(a,g,"pre-processing outgoing patch v"+c));case 27:s.next=29;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").reportCollectionInconsistency(a,"pre-processing outgoing patch "+c+".",g));case 29:s.next=31;return b("regeneratorRuntime").awrap(La(a,l));case 31:s.next=33;return b("regeneratorRuntime").awrap(X(a,c,f,g));case 33:p=null;s.next=36;return b("regeneratorRuntime").awrap(d("WABaseGlobals").runInTransaction({SyncActionStore:!0,PendingMutationStore:!0,CollectionVersionStore:!0},function(f){var h,i,j;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:h=f.SyncActionStore,i=f.PendingMutationStore,j=f.CollectionVersionStore;m.next=3;return b("regeneratorRuntime").awrap($(a,c,"outgoing patch",j,g));case 3:p=m.sent;if(!(p==null||d("WABaseGlobals").getConfig().syncDoNotAllowWriteOldPatch()===!1)){m.next=15;break}m.next=7;return b("regeneratorRuntime").awrap(h.bulkRemove(n));case 7:m.next=9;return b("regeneratorRuntime").awrap(h.bulkSet(l));case 9:m.next=11;return b("regeneratorRuntime").awrap(i.bulkRemove(e));case 11:m.next=13;return b("regeneratorRuntime").awrap(j.update(a,{version:c,ltHash:k,isLastPatchAnIncomingPatch:!1,lastPatchNewLtHashFromPatchDebugData:void 0,isLastPatchSenderAPrimaryDevice:void 0,didLastPatchFailPostValidation:void 0,lastPatchSenderDeviceId:void 0}));case 13:m.next=16;break;case 15:d("WALogger").LOG(ha(),g,c);case 16:case"end":return m.stop()}},null,this)}));case 36:if(!(p!=null)){s.next=43;break}q=p;s.next=40;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,q));case 40:s.next=42;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().printSyncdLog(a));case 42:d("WALogger").ERROR(ga(),q).sendLogs("syncd: processing old version for "+a);case 43:d("WALogger").LOG(fa(),g,a);s.next=46;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").reportCollectionInconsistency(a,"post-processing outgoing patch "+c,g));case 46:r=s.sent;s.next=49;return b("regeneratorRuntime").awrap(Ua(a,r));case 49:case"end":return s.stop()}},null,this)}function Ka(a,c,e,f){var g,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;return b("regeneratorRuntime").async(function(I){while(1)switch(I.prev=I.next){case 0:I.prev=0;I.next=3;return b("regeneratorRuntime").awrap(Sa(c,a,e));case 3:I.t0=b("regeneratorRuntime");I.t1=h||(h=b("Promise"));I.next=7;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(e.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE}).map(function(a){return d("WAGetSyncAction").getSyncActionInTransaction(a.index)})));case 7:I.t2=Boolean;I.t3=I.sent.filter(I.t2);I.next=11;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(e.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET}).map(function(a){return d("WAGetSyncAction").getSyncActionInTransaction(a.index)})));case 11:I.t4=Boolean;I.t5=I.sent.filter(I.t4);I.next=15;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(e.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET}).map(function(a){return d("WAGetSyncAction").getSyncActionsByIndexMacsInTransaction([a.indexMac])})));case 15:I.t6=Boolean;I.t7=I.sent.filter(I.t6);I.t8=[I.t3,I.t5,I.t7];I.t9=I.t1.all.call(I.t1,I.t8);I.next=21;return I.t0.awrap.call(I.t0,I.t9);case 21:g=I.sent;i=g[0];j=g[1];k=g[2];l=null;j.length===1&&k.length===1&&k[0].length===1&&(l=j[0].index===k[0][0].index);m="["+a+"] patch uploaded with mutations mac for "+c+":\n\n      SET: "+f.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET}).map(function(a){return d("WASyncdAntiTampering").indexAndValueMacToString(a.indexMac,a.valueMac)}).join("\n\t")+"\n      REMOVE: "+f.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE}).map(function(a){return d("WASyncdAntiTampering").indexAndValueMacToString(a.indexMac,a.valueMac)}).join("\n\t")+"\n\n      REMOVE fetch by index: "+i.map(function(a){return a.collection+":"+d("WASyncdAntiTampering").indexAndValueMacToString(a.indexMac,a.valueMac)+":"+W(a.index)}).join("\n\t")+"\n      SET fetch by index: "+j.map(function(a){return a.collection+":"+d("WASyncdAntiTampering").indexAndValueMacToString(a.indexMac,a.valueMac)+":"+W(a.index)}).join("\n\t")+"\n      SET fetch by mac: "+k.map(function(a){return a.map(function(a){return a.collection+":"+d("WASyncdAntiTampering").indexAndValueMacToString(a.indexMac,a.valueMac)+":"+W(a.index)})}).join("\n\t")+"\n      isSameIndex: "+(l==null?"n/a":l.toString())+"\n      ";d("WALogger").LOG(ea(),m);I.next=31;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(c,m));case 31:if(!(c===d("WASyncdConst").CollectionName.RegularLow&&f.length===1&&f[0].operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET&&e.length===1&&j.length===1&&k.length===1&&k[0].length===1)){I.next=53;break}I.next=34;return b("regeneratorRuntime").awrap(d("WABaseGlobals").runInTransaction({SyncActionStore:!0},function(a){a=a.SyncActionStore;return a.getByCollections([c])}));case 34:n=I.sent;I.next=37;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").computeLtHashFromScratch(n));case 37:o=I.sent;p=n.filter(function(a){return!d("WACryptoUtils").arrayBuffersEqual(a.indexMac,k[0][0].indexMac)});q=p.concat(e[0]);r=n.filter(function(a){return a.index!==j[0].index});s=p.concat(e[0]);I.next=44;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all([d("WASyncdAntiTampering").computeLtHashFromScratch(p),d("WASyncdAntiTampering").computeLtHashFromScratch(r),d("WASyncdAntiTampering").computeLtHashFromScratch(q),d("WASyncdAntiTampering").computeLtHashFromScratch(s)]));case 44:t=I.sent;u=t[0];v=t[1];w=t[2];x=t[3];y="["+a+"] lthash scenarios for outgoing "+c+":\n      scratchLtHash: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(o).slice(-16)+"\n      allMutations.length: "+n.length+"\n      mutationsAfterRemoveMac.length "+p.length+"\n      mutationsAfterRemoveMacWithNewIndex.length "+q.length+"\n      mutationsAfterRemoveIndex.length "+r.length+"\n      mutationsAfterRemoveIndexWithNewIndex.length "+s.length+"\n      ltHashRemoveMacScenario: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(u).slice(-16)+"\n      ltHashRemoveIndexScenario: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(v).slice(-16)+"\n      ltHashAddMacScenario: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(w).slice(-16)+"\n      ltHashAddIndexScenario: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(x).slice(-16);d("WALogger").LOG(da(),y);I.next=53;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(c,y));case 53:I.next=55;return b("regeneratorRuntime").awrap(d("WABaseGlobals").runInTransaction({SyncActionStore:!0},function(a){a=a.SyncActionStore;return a.getByCollections([c])}));case 55:z=I.sent;A=z.map(function(a){return{indexMac:a.indexMac,valueMac:a.valueMac}});I.next=59;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").computeLtHashFromScratch(z));case 59:B=I.sent;C=e.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE});D=[];A.forEach(function(a){C.find(function(b){return d("WACryptoUtils").arrayBuffersEqual(a.indexMac,b.indexMac)})||D.push(a)});I.next=65;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").computeLtHashFromScratch(D));case 65:E=I.sent;F=D.concat(e.map(function(a){if(a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET)return{indexMac:a.indexMac,valueMac:a.valueMac}}).filter(Boolean));I.next=69;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").computeLtHashFromScratch(F));case 69:G=I.sent;H="recalculate outgoing lthash. original mac length: "+A.length+", length after remove: "+D.length+",\n              length after add: "+F.length+", scratchLtHash: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(B).slice(-16)+",\n              ltHashAfterRemove: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(E).slice(-16)+", ltHashAfterAdd: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(G).slice(-16);d("WALogger").LOG(ca(),H);I.next=74;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(c,H));case 74:I.next=79;break;case 76:I.prev=76,I.t10=I["catch"](0),d("WALogger").LOG(ba(),I.t10);case 79:case"end":return I.stop()}},null,this,[[0,76]])}function La(a,c){var e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:e=d("WABaseGlobals").getConfig().syncdShouldParsePatchDebugData()||a===d("WASyncdConst").CollectionName.CriticalBlock;if(!e){g.next=5;break}f=c.map(function(c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=d("WAArrayBufferUtils").stringToArrayBuffer(c.index);j.next=3;return b("regeneratorRuntime").awrap(d("WASyncdKeyCache").getKeyData(c.keyId));case 3:f=j.sent;if(!(f!=null)){j.next=17;break}j.next=7;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateEncryptionKeys(f));case 7:g=j.sent;j.next=10;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateIndexMac(g.indexKey,e));case 10:h=j.sent;if(d("WACryptoUtils").arrayBuffersEqual(h,c.indexMac)){j.next=17;break}i="uploaded inconsistent index mac for "+a+": "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(h).slice(-16)+" "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(c.indexMac).slice(-16);j.next=15;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,i));case 15:d("WALogger").LOG(aa(),i),d("WALogger").ERROR(V()).sendLogs("syncd: uploaded inconsistent index mac");case 17:case"end":return j.stop()}},null,this)});g.next=5;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(f));case 5:case"end":return g.stop()}},null,this)}function Ma(a,e,f,g){var i,j,k,l,m,n,o,p,q,r;return b("regeneratorRuntime").async(function(s){while(1)switch(s.prev=s.next){case 0:i=(h||(h=b("Promise"))).resolve();j=0;k=d("WATimeUtils").unixTimeMs();f!=null&&(m=c("WASyncdValidateServerSyncProtobuf").validateExternalBlobReference(a,f),j+=d("WALongInt").numberOrThrowIfTooLarge((l=m.fileSizeBytes)!=null?l:0),d("WALogger").LOG(U(),a),i=d("WASyncdMMSDownload").downloadSnapshot(a,m));n=(h||(h=b("Promise"))).resolve();e!=null&&e.length>0&&(o=e.map(function(b){return c("WASyncdValidateServerSyncProtobuf").validatePatchProtobuf(a,b)}),n=(h||(h=b("Promise"))).all(o.map(function(c){var e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:e=c.mutations||[];f=c.externalMutations;if(!f){h.next=9;break}d("WALogger").LOG(T(),a);h.next=6;return b("regeneratorRuntime").awrap(d("WASyncdMMSDownload").downloadExternalPatch(a,f));case 6:e=h.sent,d("WALogger").LOG(S(),a),j+=d("WALongInt").numberOrThrowIfTooLarge((g=f.fileSizeBytes)!=null?g:0);case 9:return h.abrupt("return",{mutations:e,version:c.version,snapshotMac:c.snapshotMac,patchMac:c.patchMac,keyId:c.keyId,exitCode:c.exitCode,deviceIndex:c.deviceIndex,clientDebugData:c.clientDebugData});case 10:case"end":return h.stop()}},null,this)})));s.prev=6;s.next=9;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all([i,n]));case 9:r=s.sent;p=r[0];q=r[1];d("WASyncdCollectionUtils").isBootstrap(g)&&d("WASyncdMetrics").reportSyncdBootstrapAppStateDownloadMetric({collection:a,downloadStartTs:k,downloadSize:j,isSuccess:"success"});s.next=19;break;case 15:s.prev=15;s.t0=s["catch"](6);d("WASyncdCollectionUtils").isBootstrap(g)&&d("WASyncdMetrics").reportSyncdBootstrapAppStateDownloadMetric({collection:a,downloadStartTs:k,downloadSize:j,isSuccess:"failure"});throw s.t0;case 19:return s.abrupt("return",[p,q]);case 20:case"end":return s.stop()}},null,this,[[6,15]])}function Na(a,c){var e=function(e,f){var g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:a==null?void 0:a.mark("anti_tampering_start",{source:d("WASyncdConst").SyncDataType.Snapshot});h.next=3;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").computeLtHashAndValidateSnapshot(e,f,c));case 3:g=h.sent;a==null?void 0:a.mark("anti_tampering_end",{source:d("WASyncdConst").SyncDataType.Snapshot});return h.abrupt("return",g);case 6:case"end":return h.stop()}},null,this)},f=function(c,e){var f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:a==null?void 0:a.mark("decryption_start",{source:d("WASyncdConst").SyncDataType.Snapshot});g.next=3;return b("regeneratorRuntime").awrap(d("WASyncdDecryptMutations").tryDecryptSnapshot(c,e));case 3:f=g.sent;a==null?void 0:a.mark("decryption_end",{source:d("WASyncdConst").SyncDataType.Snapshot});return g.abrupt("return",f);case 6:case"end":return g.stop()}},null,this)};return{measuredComputeLtHashAndValidateSnapshot:e,measuredTryDecryptSnapshot:f}}function Oa(a){var c=function(c,e,f){var g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:a==null?void 0:a.mark("anti_tampering_start",{source:d("WASyncdConst").SyncDataType.Patch});h.next=3;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").computeLtHashAndValidatePatch(c,e,f));case 3:g=h.sent;a==null?void 0:a.mark("anti_tampering_end",{source:d("WASyncdConst").SyncDataType.Patch});return h.abrupt("return",g);case 6:case"end":return h.stop()}},null,this)},e=function(c,e){var f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:a==null?void 0:a.mark("decryption_start",{source:d("WASyncdConst").SyncDataType.Patch});g.next=3;return b("regeneratorRuntime").awrap(d("WASyncdDecryptMutations").tryDecryptPatch(c,e));case 3:f=g.sent;a==null?void 0:a.mark("decryption_end",{source:d("WASyncdConst").SyncDataType.Patch});return g.abrupt("return",f);case 6:case"end":return g.stop()}},null,this)};return{measuredComputeLtHashAndValidatePatch:c,measuredTryDecryptPatch:e}}function Pa(a,c,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s;return b("regeneratorRuntime").async(function(t){while(1)switch(t.prev=t.next){case 0:t.next=2;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"["+g+"] start _applySnapshotAndPatches. mutation count: "+c.records.length+", version: "+c.version.version));case 2:t.prev=2;h=Na(f,g),i=h.measuredComputeLtHashAndValidateSnapshot,j=h.measuredTryDecryptSnapshot;f==null?void 0:f.mark("apply_start",{source:d("WASyncdConst").SyncDataType.Snapshot,snapshotRecordsCount:c.records.length});d("WALogger").LOG(R(),g,a);t.next=8;return b("regeneratorRuntime").awrap(i(a,c));case 8:k=t.sent;d("WALogger").LOG(Q(),g,a);t.next=12;return b("regeneratorRuntime").awrap(j(a,c));case 12:l=t.sent;d("WALogger").LOG(P(),g,a);t.next=16;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getConfig().getShortMdSessionId());case 16:m=t.sent;l.forEach(function(b){var e=JSON.parse(b.index)[0];d("WABaseGlobals").getConfig().syncReportMutationToWam(a,c.version.version,!0,d("WASyncdCryptoUtils").arrayBufferToHexPadded(b.indexMac).slice(-16),e,b.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE,!1,m)});t.next=20;return b("regeneratorRuntime").awrap(X(a,c.version.version,l,g));case 20:d("WASyncdWamAppState").addMutationCount(c.records.length);d("WASyncdMetricCriticalBootstrapStage").reportSyncdDecryptedMutations(d("WASyncdMetricCriticalBootstrapStage").SyncdDecryptMutationsType.SNAPSHOT_MUTATIONS,l);d("WASyncdValidateMutations").validateNoSameIndexForMultipleMutations(a,l,d("WASyncdConst").SyncDataType.Snapshot);n=c.version.version;t.next=26;return b("regeneratorRuntime").awrap(Y(a,l,d("WASyncdConst").SyncDataType.Snapshot,g,f,c.version.version));case 26:o=t.sent;p=o.setMutationsToPersist;q=o.pendingSetMutationsToDrop;d("WALogger").LOG(O(),g,l.length,a,n);d("WALogger").LOG(N(),g,a,n);r=null;f==null?void 0:f.mark("update_DB_start",{source:d("WASyncdConst").SyncDataType.Snapshot,setMutationsToPersistCount:p.length,pendingMutationsToDropCount:q.length});t.next=35;return b("regeneratorRuntime").awrap(d("WABaseGlobals").runInTransaction({SyncActionStore:!0,PendingMutationStore:!0,CollectionVersionStore:!0},function(c){var e,f,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:e=c.SyncActionStore,f=c.PendingMutationStore,h=c.CollectionVersionStore;i.next=3;return b("regeneratorRuntime").awrap($(a,n,"snapshot",h,g));case 3:r=i.sent;if(!(r==null||d("WABaseGlobals").getConfig().syncDoNotAllowWriteOldPatch()===!1)){i.next=13;break}i.next=7;return b("regeneratorRuntime").awrap(e.bulkSet(p));case 7:i.next=9;return b("regeneratorRuntime").awrap(f.bulkRemove(q));case 9:i.next=11;return b("regeneratorRuntime").awrap(h.update(a,{version:n,ltHash:k,isLastPatchAnIncomingPatch:!0,lastPatchNewLtHashFromPatchDebugData:void 0,isLastPatchSenderAPrimaryDevice:void 0,didLastPatchFailPostValidation:void 0,lastPatchSenderDeviceId:void 0,didBootstrapFromSnapshot:!0}));case 11:i.next=14;break;case 13:d("WALogger").LOG(M(),g,n);case 14:case"end":return i.stop()}},null,this)}));case 35:f==null?void 0:f.mark("update_DB_end",{source:d("WASyncdConst").SyncDataType.Snapshot});if(!(r!=null)){t.next=43;break}s=r;t.next=40;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,s));case 40:t.next=42;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().printSyncdLog(a));case 42:d("WALogger").ERROR(L(),s).sendLogs("syncd: processing old version for "+a);case 43:d("WALogger").LOG(K(),g,a);f==null?void 0:f.mark("apply_end",{source:d("WASyncdConst").SyncDataType.Snapshot,decryptedMutationsCount:l.length});t.next=55;break;case 47:t.prev=47;t.t0=t["catch"](2);t.next=51;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"exception "+t.t0.message));case 51:if(!(t.t0 instanceof d("WASyncdError").SyncdMissingKeyError)){t.next=54;break}t.next=54;return b("regeneratorRuntime").awrap(d("WASyncdHandleMissingKeys").handleMissingKeysInSnapshot(a,c));case 54:throw t.t0;case 55:t.next=57;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"["+g+"] done applying snapshot"));case 57:if(!e){t.next=62;break}f==null?void 0:f.mark("apply_start",{source:d("WASyncdConst").SyncDataType.Patch,patchCount:e.length});t.next=61;return b("regeneratorRuntime").awrap(Ra(a,e,f,g));case 61:f==null?void 0:f.mark("apply_end",{source:d("WASyncdConst").SyncDataType.Patch,patchCount:e.length});case 62:case"end":return t.stop()}},null,this,[[2,47]])}function Qa(a){var c,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:c=d("WABaseGlobals").getConfig().syncdMaxMutationsToProcessDuringResume();if(!(a>c)){f.next=7;break}e=Date.now();d("WALogger").LOG(J(),a);f.next=6;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().handleSyncDelayApplyingPatchUntilUIUnblocks());case 6:d("WALogger").LOG(I(),Date.now()-e);case 7:case"end":return f.stop()}},null,this)}function Ra(a,c,e,f){var g,i,j,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:g=c.length===0?"n/a":c[c.length-1].version.version;l.next=3;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"["+f+"] start apply patches. count: "+c.length+", last patch version: "+g));case 3:if(!(c.length===0)){l.next=6;break}d("WALogger").LOG(H(),f,a);return l.abrupt("return",(h||(h=b("Promise"))).resolve());case 6:d("WASyncdValidateMutations").validateNoDuplicatePatchVersionInCollection(a,c);c.sort(function(a,b){return a.version.version>b.version.version?1:-1});l.prev=8;i=c.reduce(function(a,b){return a+b.mutations.length},0);l.next=12;return b("regeneratorRuntime").awrap(Qa(i));case 12:j=0;case 13:if(!(j<c.length)){l.next=25;break}if(!(j<=4||j%10===0)){l.next=17;break}l.next=17;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"["+f+"] start applying "+a+" patch "+c[j].version.version+" with "+c[j].mutations.length+" mutations from device "+((k=c[j].deviceIndex)!=null?k:"n/a")));case 17:l.next=19;return b("regeneratorRuntime").awrap(Ta(a,c[j],e,j<=1,f));case 19:if(!(j<=4||j%10===0)){l.next=22;break}l.next=22;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"["+f+"] finished applying patch "+c[j].version.version+" with "+c[j].mutations.length+" mutations"));case 22:j++;l.next=13;break;case 25:l.next=27;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"["+f+"] after apply patches for "+a+" (last patch: v"+g+" total mutations: "+i+")"));case 27:l.next=37;break;case 29:l.prev=29;l.t0=l["catch"](8);l.next=33;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"exception"+l.t0.message));case 33:if(!(l.t0 instanceof d("WASyncdError").SyncdMissingKeyError)){l.next=36;break}l.next=36;return b("regeneratorRuntime").awrap(d("WASyncdHandleMissingKeys").handleMissingKeysInPatches(a,c));case 36:throw l.t0;case 37:case"end":return l.stop()}},null,this,[[8,29]])}function W(a){return JSON.parse(a)[0]}function X(a,c,e,f){var g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:if(!(a===d("WASyncdConst").CollectionName.CriticalBlock||a===d("WASyncdConst").CollectionName.RegularLow)){i.next=6;break}g=e.map(function(a){var b=a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET?"SET":"REMOVE",c=W(a.index);return b+" "+c+" index mac: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(a.indexMac).slice(-16)+", key id: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(d("WASyncdKeyTypes").fromSyncKeyId(a.keyId))}).join("  || ");h="mutations in patch for collection "+a+" version "+c+": "+g;d("WALogger").LOG(G(),f,h);i.next=6;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,h));case 6:case"end":return i.stop()}},null,this)}function Sa(a,c,e){var f,g,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:k.prev=0;f=e.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE});k.next=4;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionsByIndexMacsInTransaction(f.map(function(a){return a.indexMac})));case 4:g=k.sent;i=f.filter(function(a){var b=g.find(function(b){return d("WACryptoUtils").arrayBuffersEqual(b.indexMac,a.indexMac)});return b==null});j=i.map(function(e){var h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:k.next=2;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionInTransaction(e.index));case 2:h=k.sent;if(!(h!=null)){k.next=11;break}k.next=6;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionsByIndexMacsInTransaction([h.indexMac]));case 6:i=k.sent;j=c+" "+a+" found removed mutation in local snapshot by index but not by indexMac.\n                     fetch rows by mac: "+g.map(function(a){return d("WASyncdCryptoUtils").arrayBufferToHexPadded(a.indexMac)}).join(",")+"\n                     input remove: "+f.map(function(a){return d("WASyncdCryptoUtils").arrayBufferToHexPadded(a.indexMac)}).join(",")+"\n                     remove mutation missing: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(e.indexMac)+" "+W(e.index)+"\n                     mutation by index: "+W(h.index)+" "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(h.indexMac)+"\n                     mutations by index mac: "+i.map(function(a){return d("WASyncdCryptoUtils").arrayBufferToHexPadded(a.indexMac)}).join(",")+"\n                     fetched mutation by mac equals to any of the input remove by mac? "+f.map(function(a){return d("WACryptoUtils").arrayBuffersEqual(a.indexMac,h.indexMac)}).join(",")+"\n                     fetched mutation by mac equals to any of the input remove by index? "+f.map(function(a){return a.index===h.index}).join(",")+"\n        ";d("WALogger").LOG(F(),j);k.next=11;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,j));case 11:case"end":return k.stop()}},null,this)});k.next=9;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(j));case 9:k.next=14;break;case 11:k.prev=11,k.t0=k["catch"](0),d("WALogger").WARN(E(),k.t0);case 14:case"end":return k.stop()}},null,this,[[0,11]])}function Ta(a,c,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S;return b("regeneratorRuntime").async(function(T){while(1)switch(T.prev=T.next){case 0:S=function(c){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionsByCollectionsInTransaction([a]));case 2:f.t0=function(a){return d("WACryptoUtils").arrayBuffersEqual(c,a.indexMac)};f.t1=e=f.sent.filter(f.t0).pop();if(!(f.t1==null)){f.next=8;break}f.t2=void 0;f.next=9;break;case 8:f.t2=e.valueMac;case 9:return f.abrupt("return",f.t2);case 10:case"end":return f.stop()}},null,this)};f===void 0&&(f=!1);h=d("WABaseGlobals").getConfig().syncdShouldParsePatchDebugData()||a===d("WASyncdConst").CollectionName.CriticalBlock||a===d("WASyncdConst").CollectionName.RegularLow||d("WABaseGlobals").getConfig().isEmployee();if(!h){T.next=8;break}T.next=6;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").logMacsInSnapshot(a,g,"pre-processing incoming patch "+c.version.version+"."));case 6:T.next=8;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").reportCollectionInconsistency(a,"["+g+"] pre-processing incoming patch "+c.version.version+".\n      incoming current lthash: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded((i=c==null?void 0:(j=c.clientDebugData)==null?void 0:j.currentLthash)!=null?i:new ArrayBuffer(0)).slice(-16)+",\n      incoming new lthash: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded((k=c==null?void 0:(l=c.clientDebugData)==null?void 0:l.newLthash)!=null?k:new ArrayBuffer(0)).slice(-16),g,250));case 8:if(!c.exitCode){T.next=21;break}o=c.exitCode.code;T.next=12;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"patch exit code "+((m=o)!=null?m:"")));case 12:T.t0=o;T.next=T.t0===100?15:T.t0===101?17:19;break;case 15:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.TERMINAL_PATCH_MISSING_DATA,a);return T.abrupt("break",20);case 17:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.TERMINAL_PATCH_DESERIALIZATION_ERROR,a);return T.abrupt("break",20);case 19:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.TERMINAL_PATCH_UNKNOWN,a);case 20:throw new(d("WASyncdError").SyncdFatalError)("received terminal patch with exit code:  "+String(o)+" text: "+String((n=c.exitCode)==null?void 0:n.text)+"  ");case 21:T.next=23;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().handleSyncBeforeApplyPatch(c));case 23:p=c.mutations.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET}).length;q=c.mutations.length-p;d("WALogger").LOG(D(),g,a,c.version.version,c.deviceIndex,p,q);p===0&&q===0&&d("WALogger").WARN(C(),a).sendLogs("syncd: "+a+": empty patch found");r=Oa(e),s=r.measuredComputeLtHashAndValidatePatch,t=r.measuredTryDecryptPatch;T.next=30;return b("regeneratorRuntime").awrap(t(a,c));case 30:u=T.sent;d("WASyncdMetricCriticalBootstrapStage").reportSyncdDecryptedMutations(d("WASyncdMetricCriticalBootstrapStage").SyncdDecryptMutationsType.PATCH_MUTATIONS,u);T.next=34;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getConfig().getShortMdSessionId());case 34:v=T.sent;u.forEach(function(b){var e=JSON.parse(b.index)[0];d("WABaseGlobals").getConfig().syncReportMutationToWam(a,c.version.version,!0,d("WASyncdCryptoUtils").arrayBufferToHexPadded(b.indexMac).slice(-16),e,b.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE,!0,v)});T.next=38;return b("regeneratorRuntime").awrap(X(a,c.version.version,u,g));case 38:if(!f){T.next=41;break}T.next=41;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"["+g+"] after decrypt patch "+c.version.version));case 41:T.next=43;return b("regeneratorRuntime").awrap(Sa(a,g,u));case 43:T.next=45;return b("regeneratorRuntime").awrap(s(a,c,g,S));case 45:E=T.sent;d("WALogger").LOG(B(),g,a,c.version.version);d("WASyncdWamAppState").addMutationCount(u.length);d("WASyncdValidateMutations").validateNoSameIndexForMultipleMutations(a,u,d("WASyncdConst").SyncDataType.Patch);if(!(a===d("WASyncdConst").CollectionName.RegularLow&&d("WABaseGlobals").getConfig().syncShouldDebugLockChat())){T.next=52;break}T.next=52;return b("regeneratorRuntime").awrap(d("WASyncdValidateMutations").validateLockChat(u,c.version.version));case 52:F=Xa(u);G=F.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE});T.next=56;return b("regeneratorRuntime").awrap(Va(a,G,g));case 56:H=T.sent;I=H.pendingRemoveMutationsToDrop;d("WALogger").LOG(A(),g,a,c.version.version);J=F.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET});T.next=62;return b("regeneratorRuntime").awrap(Y(a,J,d("WASyncdConst").SyncDataType.Patch,g,e,c.version.version,f));case 62:K=T.sent;L=K.setMutationsToPersist;M=K.pendingSetMutationsToDrop;d("WALogger").LOG(z(),g,u.length,c.version.version,a);N=I.concat(M);e==null?void 0:e.mark("update_DB_start",{source:d("WASyncdConst").SyncDataType.Patch,setMutationsToPersistCount:L.length,pendingMutationsToDropCount:N.length});O=c.version.version;P=null;T.next=72;return b("regeneratorRuntime").awrap(d("WABaseGlobals").runInTransaction({SyncActionStore:!0,PendingMutationStore:!0,CollectionVersionStore:!0},function(e){var f,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:f=e.SyncActionStore,h=e.PendingMutationStore,i=e.CollectionVersionStore;k.next=3;return b("regeneratorRuntime").awrap($(a,O,"incoming patch",i,g));case 3:P=k.sent;if(!(P==null||d("WABaseGlobals").getConfig().syncDoNotAllowWriteOldPatch()===!1)){k.next=15;break}k.next=7;return b("regeneratorRuntime").awrap(f.bulkRemove(G.map(function(a){return a.index})));case 7:k.next=9;return b("regeneratorRuntime").awrap(f.bulkSet(L));case 9:k.next=11;return b("regeneratorRuntime").awrap(h.bulkRemove(N));case 11:k.next=13;return b("regeneratorRuntime").awrap(i.update(a,{version:O,ltHash:E,lastPatchNewLtHashFromPatchDebugData:(j=c.clientDebugData)==null?void 0:j.newLthash,isLastPatchAnIncomingPatch:!0,isLastPatchSenderAPrimaryDevice:c.deviceIndex===0,didLastPatchFailPostValidation:void 0,lastPatchSenderDeviceId:c.deviceIndex}));case 13:k.next=16;break;case 15:d("WALogger").LOG(y(),g,O);case 16:case"end":return k.stop()}},null,this)}));case 72:if(!(P!=null)){T.next=79;break}Q=P;T.next=76;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,Q));case 76:T.next=78;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().printSyncdLog(a));case 78:d("WALogger").ERROR(x(),Q).sendLogs("syncd: processing old version for "+a);case 79:if(!(h||a===d("WASyncdConst").CollectionName.RegularLow||d("WABaseGlobals").getConfig().isEmployee())){T.next=87;break}T.next=82;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").logMacsInSnapshot(a,g,"post-processing incoming patch "+c.version.version+"."));case 82:T.next=84;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").reportCollectionInconsistency(a,"["+g+"] post-processing incoming patch "+c.version.version+". has remove: "+(q>0).toString(),g,120));case 84:R=T.sent;T.next=87;return b("regeneratorRuntime").awrap(Ua(a,R));case 87:e==null?void 0:e.mark("update_DB_end",{source:d("WASyncdConst").SyncDataType.Patch});d("WALogger").LOG(w(),g,a,c.version.version);if(!f){T.next=92;break}T.next=92;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,"["+g+"] after final transaction for patch "+c.version.version+". new lthash: "+d("WASyncdCryptoUtils").arrayBufferToHexPadded(E).slice(-16)));case 92:case"end":return T.stop()}},null,this)}function Ua(a,c){return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(d("WABaseGlobals").runInTransaction({CollectionVersionStore:!0},function(d){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:e=d.CollectionVersionStore;f.next=3;return b("regeneratorRuntime").awrap(e.update(a,{didLastPatchFailPostValidation:c}));case 3:case"end":return f.stop()}},null,this)}));case 2:case"end":return e.stop()}},null,this)}function Y(a,e,f,g,h,i,j){var k,l,m,n,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U;return b("regeneratorRuntime").async(function(V){while(1)switch(V.prev=V.next){case 0:j===void 0&&(j=!1);d("WASyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(d("WASyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.ABOUT_TO_APPLY_MUTATIONS);l=f===d("WASyncdConst").SyncDataType.Local?" (individual mutations)":"";m=[];n=d("WASyncdValidateMutations").validateAndTypeSetMutations(a,e);w=Ya(a,n),x=w.supportedMutations,y=w.unsupportedMutations;y.forEach(function(a){return m.push(d("WASyncdCollectionHandlerTypesConverter").setMutationToSyncAction(a,d("WASyncdConst").SyncActionState.Unsupported))});h==null?void 0:h.mark("conflict_resolution_start",{source:f,collectionName:a,count:x.length});V.next=10;return b("regeneratorRuntime").awrap(d("WASyncdResolveConflict").resolveConflict(a,x));case 10:z=V.sent,A=z.remoteMutationsToApply,B=z.pendingSetMutationsToDrop,C=x.filter(function(a){return!A.includes(a)}),h==null?void 0:h.mark("conflict_resolution_end",{source:f,collectionName:a,apply:A.length,drop:C.length}),C.forEach(function(a){return m.push(d("WASyncdCollectionHandlerTypesConverter").setMutationToSyncAction(a,d("WASyncdConst").SyncActionState.Skipped,a.actionName))}),h==null?void 0:h.mark("apply_set_mutations_start",{source:f,collectionName:a,count:A.length}),D=Za(A),E=null,F=0;case 20:if(!(F<D.length)){V.next=53;break}G=j&&F<=1;H=D[F][0].actionHandler;I=D[F].map(function(a){var b;a.binarySyncData?b=c("WANullthrows")(d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,a.binarySyncData).value):b=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,a.binarySyncAction);(E==null||E<a.timestamp)&&(E=a.timestamp);return{operation:"set",indexParts:a.indexArr,value:b,timestamp:a.timestamp}});if(!G){V.next=27;break}V.next=27;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,g+" after deserialize. mutationsToApply length: "+I.length));case 27:J=[];K=!1;V.prev=29;d("WABaseGlobals").getConfig().isEmployee()&&d("WALogger").LOG(v(),JSON.stringify(I.slice(0,3),null,2),H.getAction(),l);d("WALogger").LOG(u(),g,a,i,I.length,l);V.next=34;return b("regeneratorRuntime").awrap(H.applyMutations(I,{setMutationsPendingToPersist:m,allSupportedSetMutations:A},G));case 34:J=V.sent;d("WABaseGlobals").getConfig().isEmployee()&&d("WALogger").LOG(t(),g,H.getAction(),l);if(!G){V.next=39;break}V.next=39;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,g+" after apply group "+F+"/"+D.length+" for "+a+" "+((L=i)!=null?L:"")+". result length: "+J.length));case 39:V.next=47;break;case 41:V.prev=41;V.t0=V["catch"](29);if(!(V.t0 instanceof d("WASyncdError").SyncdFatalError||a===d("WASyncdConst").CollectionName.CriticalBlock)){V.next=45;break}throw V.t0;case 45:K=!0,d("WALogger").WARN(s(),V.t0);case 47:d("WALogger").DEV(r(),l,J.slice(0,100).map(function(a){return a.actionState}));d("WALogger").LOG(q(),g,a,l);for(M=0;M<D[F].length;M++)P=K?d("WASyncdConst").SyncActionState.Failed:J[M].actionState,m.push(d("WASyncdCollectionHandlerTypesConverter").setMutationToSyncAction(D[F][M],P,D[F][M].actionName,K?void 0:(N=J[M].orphanModel)==null?void 0:N.modelId,K?void 0:(O=J[M].orphanModel)==null?void 0:O.modelType));case 50:F++;V.next=20;break;case 53:Q=E;R=Q==null?null:d("WATimeUtils").daysDiff(d("WATimeUtils").unixTimeMs(),Q);d("WALogger").LOG(p(),(k=R)!=null?k:"n/a");if(!j){V.next=59;break}V.next=59;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,g+" max timestamp from recent patch: "+((S=R)!=null?S:"n/a")+" days ago"));case 59:T=m.reduce(function(a,b){b=b.actionState;a[b]==null&&(a[b]=0);a[b]++;return a},{});h==null?void 0:h.mark("apply_set_mutations_end",babelHelpers["extends"]({source:f,collectionName:a,count:A.length},T));d("WASyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(d("WASyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.APPLIED_MUTATIONS);if(!(a===d("WASyncdConst").CollectionName.CriticalBlock)){V.next=65;break}V.next=65;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,g+" apply states for "+a+" v"+((U=i)!=null?U:"n/a")+": "+m.map(function(a){return a.actionState}).join(", ")));case 65:d("WALogger").LOG(o(),g,a,l);return V.abrupt("return",{setMutationsToPersist:m,pendingSetMutationsToDrop:B});case 67:case"end":return V.stop()}},null,this,[[29,41]])}function Va(a,c,e){var f,g,h,i,j,k,l;return b("regeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:f=Wa(c),g=f.supportedMutations;h=Za(g);i=new Set(c.map(function(a){return a.index}));o.next=5;return b("regeneratorRuntime").awrap(d("WAGetPendingMutation").getSyncPendingMutationsByCollectionInTransaction(a));case 5:o.t0=function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE&&i.has(a.index)},o.t1=function(a){return a.id},o.t2=Boolean,j=o.sent.filter(o.t0).map(o.t1).filter(o.t2),d("WALogger").LOG(n(),e,a),k=0;case 11:if(!(k<h.length)){o.next=18;break}l=h[k][0].actionHandler;o.next=15;return b("regeneratorRuntime").awrap(l.applyMutations(h[k].map(function(b){return{operation:"remove",indexParts:Z(a,b.index)}}),{setMutationsPendingToPersist:[],allSupportedSetMutations:[]}));case 15:k++;o.next=11;break;case 18:d("WALogger").LOG(m(),e,a);o.next=21;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(a,e+" after apply remove mutations for "+a+". mutation count: "+c.length));case 21:return o.abrupt("return",{pendingRemoveMutationsToDrop:j});case 22:case"end":return o.stop()}},null,this)}function Wa(a){a=a.map(function(a){if(a.version>d("WASyncdGetActionHandler").maxSupportedVersion())return{unsupported:a};var b=Z(a.collection,a.index),c=d("WASyncdConst").Actions.cast(b[0]);if(!c){d("WALogger").WARN(l(),b[0]);return{unsupported:a}}var e=d("WASyncdGetActionHandler").getActionHandler(c);if(!e){d("WALogger").WARN(k(),c);return{unsupported:a}}a={collection:a.collection,index:a.index,indexMac:a.indexMac,keyId:a.keyId,binarySyncData:a.binarySyncData,valueMac:a.valueMac,version:a.version,indexArr:b,actionName:c,actionHandler:e};return{supported:a}});var b=[],c=[];a.map(function(a){var d=a.supported;a=a.unsupported;d!=null?b.push(d):a!=null&&c.push(a)});return{supportedMutations:b,unsupportedMutations:c}}function Xa(a){var b=a.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET}),c=new Set(b.map(function(a){return a.index}));a=a.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE});a.forEach(function(a){c.has(a.index)||b.push(a)});return b}function Ya(a,b){b=b.map(function(b){if(b.version>d("WASyncdGetActionHandler").maxSupportedVersion())return{unsupported:b};var c=Z(a,b.index),e=d("WASyncdConst").Actions.cast(c[0]);if(!e){d("WALogger").WARN(j(),c[0]);return{unsupported:b}}var f=d("WASyncdGetActionHandler").getActionHandler(e);if(!f){d("WALogger").WARN(i(),e);return{unsupported:b}}return{supported:{collection:b.collection,index:b.index,indexMac:b.indexMac,keyId:b.keyId,timestamp:b.timestamp,binarySyncData:b.binarySyncData,valueMac:b.valueMac,version:b.version,indexArr:c,actionName:e,actionHandler:f}}});var c=[],e=[];b.map(function(a){var b=a.supported;a=a.unsupported;b!=null?c.push(b):a!=null&&e.push(a)});return{supportedMutations:c,unsupportedMutations:e}}function Za(a){return a.reduce(function(a,b){a.length!==0&&b.actionName===a[a.length-1][0].actionName?a[a.length-1].push(b):a.push([b]);return a},[])}function Z(a,b){try{b=JSON.parse(b);if(b.length<1)throw c("err")("");return b}catch(b){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.INVALID_ACTION_INDEX,a);throw new(d("WASyncdError").SyncdFatalError)("invalid action index")}}function $(a,c,d,e,f){var g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:h.next=2;return b("regeneratorRuntime").awrap(e.get(a));case 2:g=h.sent;if(!(g!=null&&g.version>=c)){h.next=5;break}return h.abrupt("return","["+f+"] syncd: processing old version for "+a+". processing: "+c+" already persisted: "+g.version+". context: "+d);case 5:case"end":return h.stop()}},null,this)}g.applyIndividualMutations=a;g.applyAppStateSyncResponse=e}),98);
__d("WASyncdDisabled",["WABaseGlobals"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("WABaseGlobals").getConfig().syncdDisabled()}g.isSyncdDisabled=a}),98);
__d("WASyncdOrphan",["Promise","WABaseGlobals","WAGetSyncAction","WALogger","WASyncdCollectionHandler","WASyncdConst","WASyncdDisabled","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: end applyAllOrphansAndUnsupported"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: start applyAllOrphansAndUnsupported"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: finished applying orphans of type "," with ids=",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: applying orphans of type "," with ids=",""]);l=function(){return a};return a}function a(a,c){return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:if(!d("WASyncdDisabled").isSyncdDisabled()){e.next=2;break}return e.abrupt("return",(h||(h=b("Promise"))).resolve());case 2:e.next=4;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all([m(a),n(c),d("WABaseGlobals").getDbImpls().bulkGetAccountLid(c).then(function(a){return o(a.filter(Boolean))})]));case 4:case"end":return e.stop()}},null,this)}function m(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().getAdditionalLidMsgKeys(a));case 2:c=e.sent;e.next=5;return b("regeneratorRuntime").awrap(p(a.concat(c),d("WASyncdConst").SyncModelType.Msg));case 5:case"end":return e.stop()}},null,this)}function n(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(p(a,d("WASyncdConst").SyncModelType.Chat));case 2:case"end":return c.stop()}},null,this)}function o(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(p(a,d("WASyncdConst").SyncModelType.Account));case 2:case"end":return c.stop()}},null,this)}function p(a,c){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:d("WALogger").DEV(l(),c,a);if(!d("WASyncdDisabled").isSyncdDisabled()){f.next=3;break}return f.abrupt("return",(h||(h=b("Promise"))).resolve());case 3:f.next=5;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionsByModelInfosInTransaction(a.map(function(a){return[a,c,d("WASyncdConst").SyncActionState.Orphan]})));case 5:e=f.sent;f.next=8;return b("regeneratorRuntime").awrap(d("WASyncdCollectionHandler").applyIndividualMutations(e));case 8:d("WALogger").DEV(k(),c,a);case 9:case"end":return f.stop()}},null,this)}function c(){var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:if(!d("WASyncdDisabled").isSyncdDisabled()){c.next=2;break}return c.abrupt("return",(h||(h=b("Promise"))).resolve());case 2:d("WALogger").LOG(j());c.next=5;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionsByActionStatesInTransaction([d("WASyncdConst").SyncActionState.Orphan,d("WASyncdConst").SyncActionState.Unsupported]));case 5:a=c.sent;c.next=8;return b("regeneratorRuntime").awrap(d("WASyncdCollectionHandler").applyIndividualMutations(a));case 8:d("WALogger").LOG(i());case 9:case"end":return c.stop()}},null,this)}function e(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(p(a,d("WASyncdConst").SyncModelType.Agent));case 2:case"end":return c.stop()}},null,this)}function f(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(p(a,d("WASyncdConst").SyncModelType.ChatAssignment));case 2:case"end":return c.stop()}},null,this)}function q(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(p(a,d("WASyncdConst").SyncModelType.UserStatusMute));case 2:case"end":return c.stop()}},null,this)}g.checkOrphanMutations=a;g.checkOrphanMessages=m;g.checkOrphanChats=n;g.checkOrphanAccountLids=o;g.applyAllOrphansAndUnsupported=c;g.checkOrphanAgents=e;g.checkOrphanChatAssignments=f;g.checkOrphanUserStatusMutes=q}),98);
__d("WAWebHandleForMessageRangeEnums",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["DropMessage","SkipUI"]);c=b("$InternalEnum").Mirrored(["DOES_NOT_CONTAIN","CONTAINS_BY_TIMESTAMP","CONTAINS_BY_ADDITIONAL"]);f.ActiveRangeHandlerAction=a;f.RangeContain=c}),66);
__d("WAWebHandleMsgTypes.flow",["$InternalEnum"],(function(a,b,c,d,e,f){c=(a=b("$InternalEnum"))({Self:1,Bsp:2,Capi:3});d=a({OnPremise:1,Facebook:2});e=a.Mirrored(["SUCCESS","RETRY","HSM_MISMATCH","BACKFILL","PARSE_ERROR","PARSE_VALIDATION_ERROR","SIGNAL_OLD_COUNTER_ERROR"]);b=a.Mirrored(["E2E","FANOUT","BOT_UNAVAILABLE_FANOUT","HOSTED_UNAVAILABLE_FANOUT"]);a=a({NO_OVERWRITE:0,RETRY:1,FUTURE_PROOF:2,PEER_RETRY:3});var g=Object.freeze({CHAT:"chat",GROUP:"group",PEER_BROADCAST:"peer_broadcast",OTHER_BROADCAST:"other_broadcast",DIRECT_PEER_STATUS:"direct_peer_status",OTHER_STATUS:"other_status"});f.ActualActorsEnumType=c;f.HostStorageEnumType=d;f.E2EProcessResult=e;f.PlaceholderType=b;f.MessageOverwriteOption=a;f.MESSAGE_TYPE=g}),66);
__d("WAWebHandleSingleMsg",["Promise","WABackoffUtils","WALogger","WAPromiseDelays","WAPromiseLoop","WASyncdOrphan","WATimeUtils","WAWebApiFilterAndReplaceMessages","WAWebApiGroupInviteV4Store","WAWebBackendApi","WAWebBackendErrors","WAWebCheckUpdateOrphanReactions","WAWebDBProcessMessage","WAWebDBStoreRevokeMsgs","WAWebHandleForMessageRange","WAWebHandleForMessageRangeEnums","WAWebHandleMsgTypes.flow","WAWebHandlePlaceholderWam","WAWebMsgType","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebWid","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Msg: "," chat: "," Error: ",", message: ",", stack: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Msg: "," chat: "," Error: ",", message: ",", stack: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Msg: "," chat: "," Error: PreviousMsgNotUpdatableError"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleSingleMsg: checkOrphanMutations failed during handleSingleMsg for: "," chat: "," Error: ",", message: ",", stack: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleSingleMsg: msgId::",", checkOrphanMutations done"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleSingleMsg: msgId::",", write message to db done, overwrite: ",", skipUI: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["storeMessages loop: Gave up after "," tries"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["storeMessages loop: failed with error ","."]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["storeMessages loop"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["storeMessages loop: detect resend message"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["processPlaceholderMsg: skip creating duplicate placeholder"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["placeholder populate successful"]);t=function(){return a};return a}function a(a,b,c,d,e){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,u){g===void 0&&(g=d("WAWebHandleMsgTypes.flow").MessageOverwriteOption.NO_OVERWRITE);u===void 0&&(u=!0);var v=g!==d("WAWebHandleMsgTypes.flow").MessageOverwriteOption.NO_OVERWRITE,w={add:"after",update:v,isHistory:!1},x=e.type===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&["sender_revoke","admin_revoke"].includes(e.subtype),y=e;if(!x){g=(yield d("WAWebApiFilterAndReplaceMessages").filterAndReplaceMessages([y]));e=g.newMsgs;if(e.length===0)return;y=e[0]}g=(yield d("WAWebHandleForMessageRange").handleForActiveMessageRange(a,y));if(g.has(d("WAWebHandleForMessageRangeEnums").ActiveRangeHandlerAction.DropMessage))return;e=g.has(d("WAWebHandleForMessageRangeEnums").ActiveRangeHandlerAction.SkipUI);try{c("WAWebWid").isStatus(a)&&(yield d("WAWebBackendApi").frontendSendAndReceive("handleStatusUpdate",{rawMsg:y,checksum:null,isMsgUpdate:!1}));yield d("WAPromiseLoop").promiseLoop(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(c,e,f){e=d("WAPromiseDelays").delayMs(d("WABackoffUtils").expBackoff(f,12e4,1e3,.1));try{if(v)y=(yield d("WAWebDBProcessMessage").updateMessage(y)),d("WALogger").LOG(t()).tags("handleSingleMsg");else if(x)yield d("WAWebDBStoreRevokeMsgs").processRevokeMsgs([{revokeMsgKey:y.protocolMessageKey,newMsgKey:y.id,timestamp:y.t,subtype:y.subtype,sender:y.author,revokeTimestamp:y.t}]),d("WAWebBackendApi").frontendFireAndForget("deleteModelsForLastAddOnPreview",{messagesIds:[y.protocolMessageKey.toString()]}),yield d("WAWebPersistedJobManager").getJobManager().waitUntilPersisted(d("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(a.toString(),[y.protocolMessageKey.toString()]));else try{yield d("WAWebDBProcessMessage").storeMessages([y],a),y.type===d("WAWebMsgType").MSG_TYPE.CIPHERTEXT&&void d("WAWebHandlePlaceholderWam").addPlaceholderWam([y])}catch(a){if(a instanceof d("WAWebDBProcessMessage").DuplicateMessageError)y.type===d("WAWebMsgType").MSG_TYPE.CIPHERTEXT?d("WALogger").LOG(s()):(d("WALogger").LOG(r()),y=(yield d("WAWebDBProcessMessage").updateMessage(y)),w.update=!0);else throw a}if(y.type===d("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE){var g=y.id.toString();yield d("WAWebApiGroupInviteV4Store").persistGroupInviteV4Msg(g,{id:g,from:y.from.toString(),to:y.to.toString(),groupId:y.inviteGrp,expiration:parseInt(y.inviteCodeExp,10),expired:d("WATimeUtils").unixTime()>=parseInt(y.inviteCodeExp,10)})}d("WALogger").LOG(q()).tags("handleSingleMsg");c()}catch(a){d("WALogger").LOG(p(),a).tags("handleSingleMsg");if(f>3){d("WALogger").WARN(o(),f);return(h||(h=b("Promise"))).reject(a)}return e}});return function(a,b,d){return c.apply(this,arguments)}}());d("WALogger").LOG(n(),y.id.id,v,e).tags("messaging");try{yield d("WASyncdOrphan").checkOrphanMutations([y.id.toString()],[a.toString()]),d("WALogger").DEV(m(),y.id.id).tags("messaging"),yield d("WAWebCheckUpdateOrphanReactions").checkUpdateForOrphanReactions([y.id.toString()])}catch(b){d("WALogger").ERROR(l(),String(y.id),String(a),b.name,b.message,b.stack).devConsole(b)}e||(yield d("WAWebBackendApi").frontendSendAndReceive("processMultipleMessages",{chatId:a,msgObjs:[babelHelpers["extends"]({},y,{recvFresh:!0,isNewMsg:!0})],meta:w,processMessagesOrigin:f,chatMsgsCollection:null,preserveOrder:u}))}catch(b){if(b instanceof d("WAWebBackendErrors").LogoutDrop)return;if(b instanceof d("WAWebDBProcessMessage").PreviousMsgNotUpdatableError){d("WALogger").WARN(k(),String(y.id),String(a));return}!c("gkx")("26258")?d("WALogger").WARN(j(),String(y.id),String(a),b.name,b.message,b.stack).tags("messaging").devConsole(b).sendLogs("msg_handler: error storing/processing single message"):d("WALogger").WARN(i(),String(y.id),String(a),b.name,b.message,b.stack).tags("messaging").devConsole(b)}});return u.apply(this,arguments)}g.handleSingleMsg=a}),98);
__d("WAWebShouldUpdateLastAddOnPreview",["WAWebBackendApi","WAWebDBUpdateLastAddOnPreviewChat","WAWebLastAddOnDBSerialization","WAWebMsgKey","WAWebReactionsBEUtils","WAWebSchemaChat","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(a){var b=c("WAWebMsgKey").fromString(a.parentMsgKey);return a.type==="comment"?!0:(d("WAWebUserPrefsMeUser").isSerializedWidMe(a.sender)||b.fromMe)&&!a.isOrphan}function i(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Map();a=(yield d("WAWebSchemaChat").getChatTable().bulkGet(a));a.forEach(function(a){var c;a!=null&&b.set(a.id.toString(),(c=a.chatlistPreview)!=null?c:a.lastReactionPreview)});return b});return j.apply(this,arguments)}function k(a){a=c("WAWebMsgKey").fromString(a.parentMsgKey);return a.remote.toString()}function l(a,b){return!p(a)?!1:a.sender===b.sender&&a.parentMsgKey===b.parentMsgKey&&a.timestamp>=b.timestamp}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.filter(function(a){return h(a)});var b=new Map();if(!a.length)return b;var e=new Set(a.map(function(a){a=c("WAWebMsgKey").fromString(a.parentMsgKey);return a.remote.toString()})),f=(yield i(Array.from(e)));a.forEach(function(a){var c=k(a),e=f.get(c),g=b.get(c);g=(g=g)!=null?g:e;p(a)?g&&l(a,g)&&a.timestamp>=g.timestamp&&b.set(c,void 0):g?a.timestamp>=g.timestamp&&b.set(c,d("WAWebLastAddOnDBSerialization").lastAddOnPreviewFromCandidate(a)):b.set(c,d("WAWebLastAddOnDBSerialization").lastAddOnPreviewFromCandidate(a))});return b});return n.apply(this,arguments)}function a(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield m(a));a.size>0&&(yield d("WAWebDBUpdateLastAddOnPreviewChat").updateDatabaseForLastAddOnPreview(a),d("WAWebBackendApi").frontendFireAndForget("updateChatLastAddOnPreview",{chatMap:a}))});return o.apply(this,arguments)}function p(a){switch(a.type){case"poll_vote":return a.selectedOptionsCount===0;case"reaction":default:return a.reactionText===d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT}}g.isAddOnPreviewUpdateCandidate=h;g.bulkGetChatLastAddOnPreviewMap=i;g.filterChatsWithAddOnPreviewUpdates=m;g.filterAndUpdateChatPreviews=a}),98);
__d("WAWebApiOrphanReceipt",["WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebModelStorageUtils","WAWebSchemaOrphanReceipt","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebSchemaOrphanReceipt").getOrphanReceiptTable().remove(a)}function c(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[a];if(a.remote.isUser()&&(d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()||d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.shouldApplyNonMigratedMessagingRules())){a=d("WAWebLidMigrationUtils").getAlternateMsgKey(a);a!=null&&b.push(a)}a=(yield d("WAWebSchemaOrphanReceipt").getOrphanReceiptTable().bulkGet(b.map(String)));return a.find(function(a){return a!=null})});return h.apply(this,arguments)}function e(a,b,c){return d("WAWebModelStorageUtils").getStorage().lock(["orphan-receipt"],function(d){var e=d[0];return e.bulkGet(c).then(function(d){var f=c.reduce(function(c,e,f){f=d[f];f==null&&(f={msgKey:e});e=f[a];(e==null||e>b)&&(f[a]=b,c.push(f));return c},[]);return e.bulkCreateOrReplace(f)})})}g.removeOrphanReceipt=a;g.getOrphanReceipt=c;g.createOrUpdateOrphanReceipt=e}),98);
__d("WAWebHandleMsgReceiptCommon",["WALogger","WATimeUtils","WAWebAck","WAWebActiveMessageRanges","WAWebApiActiveMessageRanges","WAWebApiChat","WAWebApiOrphanReceipt","WAWebBackendApi","WAWebChatThreadLogging","WAWebDBBulkGetRootMsgs","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebMarkAddOnsAsReadJob","WAWebMsgKey","WAWebNewsletterDBUtils","WAWebNewsletterGatingUtils","WAWebPromiseQueue","WAWebSchemaMessage","asyncToGeneratorRuntime","lodash"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateChatPeerRead: storing "," orphan acks"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateChatPeerRead: maybeOrphans ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["shouldMarkChatRead: messageExistsOutsideRange=",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["shouldMarkChatRead: found an active mark as unread range"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["processOrphanPeerReceipt: orphan read ack found for incoming ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["processOrphanPeerReceipt: orphan played ack found for incoming ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["processOrphanPeerReceipt: no orphan ack found for incoming ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateMsgAcks: store "," orphan acks"]);o=function(){return a};return a}var p=new(d("WAWebPromiseQueue").PromiseQueue)();function q(a,b){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("WAWebApiActiveMessageRanges").getActiveMessageRanges(a));a=a.filter(function(a){return a.action==="markChatAsRead"&&a.actionValue.read===!1&&a.actionValue.messageRange!=null});if(a.length===0)return!0;d("WALogger").DEV(k());var e=a[0];a=b.some(function(a){return!d("WAWebActiveMessageRanges").rangeContainsMessage(e.actionValue.messageRange,{id:c("WAWebMsgKey").fromString(a.id),t:a.t})});d("WALogger").DEV(j(),a);return a});return r.apply(this,arguments)}function s(a,b){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=b.map(String),f=null;b=(yield d("WAWebDBBulkGetRootMsgs").bulkGetRootMsgs(b.map(String),!1));var g=b.find(Boolean);g=g?c("WAWebMsgKey").fromString(g.id).remote:a;var j=[];b.forEach(function(a,b){if(!a)j.push(e[b]);else if(a.pendingReadReceipt==null)return;else a.rowId!=null&&(f==null||a.rowId>f)&&(f=a.rowId)});j.length>0&&d("WALogger").LOG(i(),j.length);var k;if(j.length===0)k=new Set();else{a=(yield d("WAWebMarkAddOnsAsReadJob").markUnclassifiedAddOnsAsReadJob(j.map(function(a){return c("WAWebMsgKey").from(a)})));var l=a.updatedAddOns;a=a.updatedOrphans;k=new Set([].concat(a,c("lodash").flatten(Array.from(l.values()))).map(String))}var m=j.filter(function(a){return!k.has(a)});p.enqueue(function(){d("WALogger").LOG(h(),m.length);return d("WAWebApiOrphanReceipt").createOrUpdateOrphanReceipt(d("WAWebAck").ACK_STRING.READ,0,m)});yield d("WAWebApiChat").markMessageAndChatAsRead(f,String(g),!(yield q(g.toString(),b.filter(Boolean))));if(g.isNewsletter()){d("WAWebNewsletterGatingUtils").isNewsletterEnabled()&&(yield d("WAWebBackendApi").frontendSendAndReceive("updateNewsletterUnreadMsgCount",{id:g}));return}yield d("WAWebBackendApi").frontendSendAndReceive("updateChatUnreadMsgCountAndClearMentions",{remote:g})});return t.apply(this,arguments)}function a(a,b){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=a.map(function(a){return d("WAWebDBMessageUtils").craftInternalId(b.toJid(),a)});a=(yield d("WAWebSchemaMessage").getMessageTable().anyOf(["internalId"],a));a=a.map(function(a){return c("WAWebMsgKey").fromString(a.id)});yield d("WAWebNewsletterDBUtils").updateMsgViewReceipt(a);return d("WAWebBackendApi").frontendFireAndForget("updateMsgsViewed",{ids:a})});return u.apply(this,arguments)}function e(a,b,c){p.enqueue(function(){d("WALogger").LOG(o(),a.length);var e=null;b===d("WAWebAck").ACK.PLAYED?e=d("WAWebAck").ACK_STRING.PLAYED:b===d("WAWebAck").ACK.READ&&(e=d("WAWebAck").ACK_STRING.READ);if(e)return d("WAWebApiOrphanReceipt").createOrUpdateOrphanReceipt(e,c,a.map(String))})}function f(a){return p.enqueue(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield d("WAWebApiOrphanReceipt").getOrphanReceipt(a));if(b==null){d("WALogger").LOG(n(),a);return}b[d("WAWebAck").ACK_STRING.PLAYED]!=null&&(d("WALogger").LOG(m(),a),yield d("WAWebBackendApi").frontendSendAndReceive("updateMsgPeerAcks",{msgKeys:[a],ack:d("WAWebAck").ACK.PLAYED,t:b[d("WAWebAck").ACK_STRING.PLAYED]}));b[d("WAWebAck").ACK_STRING.READ]!=null&&(d("WALogger").LOG(l(),a),s(a.remote,[a]));yield d("WAWebApiOrphanReceipt").removeOrphanReceipt(b.msgKey)}))}function v(a){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(String);a=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet(a,!1));d("WAWebChatThreadLogging").handleActivitiesForChatThreadLogging(a.filter(Boolean).map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)}).filter(function(a){return a.isViewOnce}).map(function(a){var b;return{activityType:"viewOnceOpen",ts:(b=a.t)!=null?b:d("WATimeUtils").unixTime(),chatId:a.id.remote}}))});return w.apply(this,arguments)}g.updateChatPeerRead=s;g.updateMsgViewed=a;g.updateOrphanPeerReceipt=e;g.processOrphanPeerReceipt=f;g.handleViewOnceOpenedIfNecessary=v}),98);
__d("WAWebCommsSendPing",["WAComms","WATimeUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAComms").sendPing()});return h.apply(this,arguments)}function c(a){d("WATimeUtils").setClockSkew(a)}g.blockSendPing=a;g.updateClockSkew=c}),98);
__d("WAWebCommsWapMd",["WALogger","WAWapJid","WAWebBizCoexGatingUtils","WAWebWid","WAWebWidValidator","err"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["USER_JID: invalid PSA jid"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["DEVICE_JID: invalid PSA jid"]);i=function(){return a};return a}function j(a){if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled())if(a.server==="hosted")return d("WAWapJid").DomainType.HOSTED;else if(a.server==="hosted.lid")return d("WAWapJid").DomainType.HOSTED_LID;return a.server==="lid"?d("WAWapJid").DomainType.LID:d("WAWapJid").DomainType.WHATSAPP}function a(a){if(!(a instanceof c("WAWebWid"))||!a.isUser())throw c("err")("DEVICE_JID: invalid jid type: "+(a instanceof c("WAWebWid")?a.toString():"Not an instance of WID"));if(a.isPSA()){d("WALogger").ERROR(i()).sendLogs("invalid-psa-user-jid");throw c("err")("USER_JID: invalid PSA jid")}return a.isFbidBot()?d("WAWapJid").WapJid.create(a.user,a.getJidServer()):d("WAWapJid").WapJid.createJidU(a.user,j(a),a.device)}function b(a){if(!(a instanceof c("WAWebWid"))||!a.isUser())throw c("err")("USER_JID: invalid jid type: "+(a instanceof c("WAWebWid")?a.toString():"Not an instance of WID"));if(a.isPSA()){d("WALogger").ERROR(h()).sendLogs("invalid-psa-user-jid");throw c("err")("USER_JID: invalid PSA jid")}return d("WAWapJid").WapJid.create(a.user,a.getJidServer())}function e(a){if(!(a instanceof c("WAWebWid"))||!a.isUser()&&!a.isGroup()&&!a.isBroadcast()&&!a.isNewsletter())throw c("err")("CHAT_JID: invalid jid type: "+(a instanceof c("WAWebWid")?a.toString():"Not an instance of WID"));return d("WAWapJid").WapJid.create(a.user,a.getJidServer())}function f(a){if(!(a instanceof c("WAWebWid"))||!a.isGroup())throw c("err")("GROUP_JID: invalid jid type: "+(a instanceof c("WAWebWid")?a.toString():"Not an instance of WID"));return d("WAWapJid").WapJid.create(a.user,d("WAWebWidValidator").Domains.G_US)}function k(a){if(!(a instanceof c("WAWebWid"))||!a.isGroupCall())throw c("err")("GROUP_CALL_JID: invalid jid type: "+(a instanceof c("WAWebWid")?a.toString():"Not an instance of WID"));return d("WAWapJid").WapJid.create(a.user,d("WAWebWidValidator").Domains.CALL)}function l(a){if(!(a instanceof c("WAWebWid")))throw c("err")("JID: invalid jid type: "+(a instanceof c("WAWebWid")?a.toString():"Not an instance of WID"));var b=a.device==null||a.device===0;return!b?d("WAWapJid").WapJid.createJidU(a.user,j(a),a.device):d("WAWapJid").WapJid.create(a.user,a.getJidServer())}var m=function(a){function b(a){var c=[];c.push(a.tag);c.push(a.attrs||{});Array.isArray(a.content)&&a.content.filter(function(a){return!Array.isArray(a)})===0?c.push(a.content):Array.isArray(a.content)?c.push(a.content.map(function(a){return b(a)})):a.content!=null?a.content instanceof Uint8Array?c.push(Array.from(a.content)):c.push(a.content):c.push(null);return c}return b(a)};g.DEVICE_JID=a;g.USER_JID=b;g.CHAT_JID=e;g.GROUP_JID=f;g.GROUP_CALL_JID=k;g.JID=l;g.wapNodeToVoipXml=m}),98);
__d("WAWebOffdStorageUtils",["invariant","Promise","WAWebIdb","WAWebStorage","err"],(function(a,b,c,d,e,f,g,h){var i,j="offd-storage",k=null;function a(){var a=new(c("WAWebIdb"))(j);k=new(d("WAWebStorage").Storage)(a)}function e(){k!=null||h(0,56317);return k}function f(){return k==null?(i||(i=b("Promise"))).reject(c("err")("[offd-storage] Storage should be created first before being destroyed")):k.purge().then(function(){k=null})["catch"](function(a){k=null;throw a})}g.DATABASE_NAME=j;g.createStorage=a;g.getStorage=e;g.destroyStorage=f}),98);
__d("WAWebSchemaDanglingReceipt",["WAWebOffdStorageUtils","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addAutoIncrementingPrimaryKey;function a(){d("WAWebOffdStorageUtils").getStorage().add("dangling-receipt").version(d("WAWebOffdStorageUtils").getStorage().versions.version(1),[i("id"),h("receipts"),h("acks")]).view(function(a){return a})}function b(){return d("WAWebOffdStorageUtils").getStorage().table("dangling-receipt")}g.addTable=a;g.getTable=b}),98);
__d("WAWebOfflineResumePreAckHandler",["WABatcher","WADeprecatedSendIq","WALogger","WAWap","WAWebCommsWapMd","WAWebSchemaDanglingReceipt","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to send offline pre-ack for envelope: "," with error: ",""]);h=function(){return a};return a}var i=d("WAWap").S_WHATSAPP_NET.toString(),j=d("WAWap").G_US.toString();function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,c,d,e=a.attrs["class"].toString();if(e!=="notification"&&e!=="receipt")return;var f=a.attrs.id.toString(),g=a.tag,h=a.attrs.to.toString();b=(b=a.attrs.participant)==null?void 0:b.toString();c=(c=a.attrs.type)==null?void 0:c.toString();a=((d=a.attrs)==null?void 0:d.error)?parseInt((d=a.attrs)==null?void 0:d.error.toString(),10):void 0;void n({ackClass:e,ackId:f,to:h,tag:g,participant:b,type:c,error:a})});return k.apply(this,arguments)}function l(a){switch(a){case j:return d("WAWap").G_US;case i:return d("WAWap").S_WHATSAPP_NET;default:return d("WAWebCommsWapMd").JID(d("WAWebWidFactory").createWidFromWidLike(a))}}function c(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{var b;b=d("WAWap").wap("ack",{id:d("WAWap").CUSTOM_STRING(a.ackId),"class":a.ackClass,to:l(a.to),type:(b=a.type)!=null?b:d("WAWap").DROP_ATTR,participant:a.participant!=null?d("WAWebCommsWapMd").DEVICE_JID(d("WAWebWidFactory").createWid(a.participant)):d("WAWap").DROP_ATTR,error:a.error!=null?d("WAWap").INT(a.error):d("WAWap").DROP_ATTR});return d("WADeprecatedSendIq").deprecatedCastStanza(b,{preAck:!0})}catch(b){d("WALogger").ERROR(h(),a.ackClass,b).sendLogs("offline-pre-ack")}});return m.apply(this,arguments)}var n=function(){return d("WABatcher").batch({delayMs:3e3,maxSize:400},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebSchemaDanglingReceipt").getTable().create({receipts:[],acks:a});return[]});return function(b){return a.apply(this,arguments)}}())}();g.parseAndSerializeOfflinePreAck=a;g.sendOfflinePreAck=c}),98);
__d("WAWebCommsAckParser",["WAJids","WAWebWidToJid"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WAJids").extractJidFromJidWithType(d("WAWebWidToJid").widToJidWithType(a.from)),c=a.participant==null?void 0:d("WAWebWidToJid").widToDeviceJid(a.participant),e=a.recipient==null?void 0:d("WAWebWidToJid").widToUserJid(a.recipient);return babelHelpers["extends"]({},a,{from:b,participant:c,recipient:e})}g.toCoreAckTemplate=a}),98);
__d("WAWebSendReceiptJobCommon",["Promise","WAAbortError","WADeprecatedSendIq","WADeprecatedWapParser","WALogger","WAWap","WAWebABProps","WAWebCommsAckParser","WAWebCommsWapMd","WAWebPrivacySettings","WAWebSchemaChat","WAWebUserPrefsGeneral","asyncToGeneratorRuntime","lodash"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[messaging] sendAggregateReceipts: Invalid ack from server"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendReceiptAndHandleAck: Aborting due to signal abort"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendAggregateReceipts: Aborting due to signal abort"]);k=function(){return a};return a}var l=new Set(),m=Object.freeze({INACTIVE:"inactive",SENDER:"sender",DELIVERY:"delivery",READ:"read",READ_SELF:"read-self",PLAYED:"played",PLAYED_SELF:"played-self",HISTORY_SYNC_COMPLETION:"hist_sync",SERVER_ERROR:"server-error",PEER_MSG:"peer_msg"}),n=256,o=new(c("WADeprecatedWapParser"))("readReceiptAckParser",function(a){a.assertTag("ack");return{readReceipts:a.hasAttr("readreceipts")?a.attrEnum("readreceipts",d("WAWebPrivacySettings").ALL_NONE):null}});function p(a,b){b=c("lodash").flatten(Array.from(b.values()));var e=b[0];b=b.slice(1);b=b.length>0?d("WAWap").wap("list",null,b.map(function(a){return d("WAWap").wap("item",{id:d("WAWap").CUSTOM_STRING(a)})})):null;e=d("WAWap").wap("ack",{id:d("WAWap").CUSTOM_STRING(e),to:d("WAWebCommsWapMd").JID(a),"class":d("WAWap").CUSTOM_STRING("message"),type:d("WAWap").CUSTOM_STRING("text")},b);return d("WADeprecatedSendIq").deprecatedCastStanza(e)}function q(a,b,c,e){var f=a[0];a=a.slice(1);a=a.length>0?d("WAWap").wap("list",null,a.map(function(a){return d("WAWap").wap("item",{id:d("WAWap").CUSTOM_STRING(a)})})):null;f=d("WAWap").wap("ack",{id:d("WAWap").CUSTOM_STRING(f),to:d("WAWebCommsWapMd").JID(b),recipient:c!=null?d("WAWebCommsWapMd").USER_JID(c):d("WAWap").DROP_ATTR,participant:e!=null?d("WAWebCommsWapMd").USER_JID(e):d("WAWap").DROP_ATTR,"class":d("WAWap").CUSTOM_STRING("message"),type:d("WAWap").CUSTOM_STRING("text")},a);return d("WADeprecatedSendIq").deprecatedCastStanza(f)}function a(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.to,e=a.type,f=a.groupedReceipt,g=a.t,l=a.recipient,r=a.signal;if(c.isNewsletter()&&e===m.DELIVERY)return p(c,f);var t=e===m.READ||e===m.PLAYED||e===m.READ_SELF||e===m.PLAYED_SELF||e===m.HISTORY_SYNC_COMPLETION,u=(yield s(c,e,m.DELIVERY));if((r==null?void 0:r.aborted)&&d("WAWebABProps").getABPropConfigValue("web_abort_preacks_on_disconnect_enabled")){d("WALogger").LOG(k()).tags("messaging");throw new(d("WAAbortError").AbortError)()}yield (h||(h=b("Promise"))).all(Array.from(f.keys()).map(function(a){var k=f.get(a);if(!k||k.length===0)return;var p=!c.isBot()&&a.isBot();if(e===m.DELIVERY&&p){var s,v;c.isUser()?(p=a,s=c):(p=c,v=a);q(k,p,s,v);return}var w=c.isUser()||c.isNewsletter()?null:a,x=c,y=l;y==null&&c.isUser()&&!c.isBot()&&a.isBot()&&(x=a,y=c);var z=[];p=function(){var a=k.splice(0,n),c=null;a.length>1&&(c=d("WAWap").wap("list",null,a.slice(1).map(function(a){return d("WAWap").wap("item",{id:d("WAWap").CUSTOM_STRING(a)})})));var f=void 0;w!=null&&(w.isPSA()?f=d("WAWebCommsWapMd").JID(w):f=d("WAWebCommsWapMd").DEVICE_JID(w));var h=d("WAWap").wap("receipt",{to:d("WAWebCommsWapMd").JID(x),type:e===m.DELIVERY?d("WAWap").DROP_ATTR:d("WAWap").CUSTOM_STRING(e),id:d("WAWap").CUSTOM_STRING(a[0]),t:g!=null?d("WAWap").CUSTOM_STRING(g):d("WAWap").DROP_ATTR,participant:(f=f)!=null?f:d("WAWap").DROP_ATTR,recipient:y?d("WAWebCommsWapMd").USER_JID(y):d("WAWap").DROP_ATTR,privacy_token:u?d("WAWap").CUSTOM_STRING("false"):d("WAWap").DROP_ATTR},c);if(t){f=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if((r==null?void 0:r.aborted)&&d("WAWebABProps").getABPropConfigValue("web_abort_preacks_on_disconnect_enabled")){d("WALogger").LOG(j()).tags("messaging");throw new(d("WAAbortError").AbortError)()}var b={id:a[0],from:x,"class":"receipt",type:e,participant:w,recipient:y};if(e===m.READ||e===m.READ_SELF){var c=(yield d("WADeprecatedSendIq").deprecatedSendStanzaAndReturnAck(h,d("WAWebCommsAckParser").toCoreAckTemplate(b)));c=o.parse(c);if(c.error)d("WALogger").ERROR(i()).sendLogs("Invalid-Receipt-Ack");else{c=c.success.readReceipts;c!=null&&d("WAWebUserPrefsGeneral").setUserPrivacySettings(babelHelpers["extends"]({},d("WAWebUserPrefsGeneral").getUserPrivacySettings(),{readReceipts:c}))}}else return d("WADeprecatedSendIq").deprecatedSendStanzaAndWaitForAck(h,d("WAWebCommsAckParser").toCoreAckTemplate(b))});return function(){return c.apply(this,arguments)}}();z.push(f())}else z.push(d("WADeprecatedSendIq").deprecatedCastStanza(h))};while(k.length>0)p();return(h||(h=b("Promise"))).all(z)}))});return r.apply(this,arguments)}function s(a,b,c){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e;if(!d("WAWebABProps").getABPropConfigValue("include_privacy_token_flag_in_delivery_receipt"))return!1;e=(e=(yield d("WAWebSchemaChat").getChatTable().get(a.toString())))==null?void 0:e.tcToken;b=a.isUser()&&b===c&&e==null&&!l.has(a);b&&l.add(a);e!=null&&l.has(a)&&l["delete"](a);return b});return t.apply(this,arguments)}function e(){l.clear()}g.RECEIPT_TYPE=m;g.sendBotInvokeResponseAcks=q;g.sendAggregateReceipts=a;g.shouldRequestTcToken=s;g.resetRequestedTcTokens=e}),98);
__d("WAWebGetAllModelStorageTableNames",[],(function(a,b,c,d,e,f){a=["abpropConfigs","abprop-event-sampling-configs","active-message-ranges","agent","blocklist","bot-profile","business-profile","cart","chat","chat-assignment","chat-thread-logging-pending-events","collection-version","comments","contact","ctwa-suggestion","device-list","direct-connection-keys","encrypted-mutations","favorite-stickers","fts-indexing-queue","group-invite-v4","group-metadata","history-sync-notification","in-app-banner","inactive-receipt","label","label-association","lid-chat-state","lid-display-name-mapping","lid-pn-mapping","message","message-history","message-info","message-orphans","missing-keys","newsletter-metadata","newsletter-my-votes","newsletter-polls-votes","newsletter-reactions","non-message-data-request","orphan-payment-notification","orphan-receipt","orphan-revoke","orphan-tc-token","participant","payment-backgrounds","peer-message","pending-membership-approval-request","pending-mutations","pinned-messages","poll-votes","premium-message","privacy-disallowed-list","profile-pic-thumb","quick-promotions","quick-reply","reactions","recent-stickers","reporting-token","self-addon-message-type","sticker-download","subgroup-suggestion","subgroup-suggestion-v2","subscription","sync-actions","sync-keys","syncd-logs","tasks-scheduled-time","unjoined-subgroup-metadata","user-prefs","verified-business-name"];f.allModelStorageTableNames=a}),66);
__d("WAWebWamEnumOfflineResumeModes",[],(function(a,b,c,d,e,f){a=Object.freeze({RESUME_FROM_RESTART:1,RESUME_FROM_OPEN_TAB:2,UNKNOWN:3,CONNECT_REASON_USER:4,CONNECT_REASON_PUSH:5,CONNECT_REASON_BACKOFF:6});f.OFFLINE_RESUME_MODES=a}),66);
__d("WAWebWamEnumOfflineResumeStages",[],(function(a,b,c,d,e,f){a=Object.freeze({PAGE_LOAD:1,SOCKET_CONNECT:2,PROCESS_COMPLETE:3,SCREEN_LOAD:4,OFFLINE_PREVIEW:5,OFFLINE_COMPLETE_RECEIVED:6,PREACKS_SENT:7});f.OFFLINE_RESUME_STAGES=a}),66);
__d("WAWebOfflineResumeStageWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumOfflineResumeModes","WAWebWamEnumOfflineResumeStages"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({OfflineResumeStage:[3536,{attemptId:[13,a.TYPES.INTEGER],chatThreadCount:[4,a.TYPES.INTEGER],currentOfflineStage:[1,d("WAWebWamEnumOfflineResumeStages").OFFLINE_RESUME_STAGES],isResumeInForeground:[5,a.TYPES.BOOLEAN],isResumeStartedInForeground:[14,a.TYPES.BOOLEAN],lastPushTimestampMs:[12,a.TYPES.INTEGER],mailboxAge:[6,a.TYPES.INTEGER],offlineCallCount:[15,a.TYPES.INTEGER],offlineDecryptErrorCount:[7,a.TYPES.INTEGER],offlineMessageCount:[8,a.TYPES.INTEGER],offlineNotificationCount:[9,a.TYPES.INTEGER],offlineReceiptCount:[10,a.TYPES.INTEGER],offlineResumeMode:[11,d("WAWebWamEnumOfflineResumeModes").OFFLINE_RESUME_MODES],offlineSessionId:[2,a.TYPES.STRING],offlineSizeBytes:[16,a.TYPES.INTEGER],offlineStageTimestampMs:[3,a.TYPES.INTEGER],passiveModeT:[17,a.TYPES.TIMER]},[1,1,1],"regular"]},{OfflineResumeStage:[]});g.OfflineResumeStageWamEvent=b}),98);
__d("WAWebWamEnumOfflineResumeResultType",[],(function(a,b,c,d,e,f){a=Object.freeze({COMPLETE:1,INCOMPLETE_UNKNOWN_ERROR:2,INCOMPLETE_DISCONNECT:3,INCOMPLETE_APP_RESTART:4});f.OFFLINE_RESUME_RESULT_TYPE=a}),66);
__d("WAWebOfflineResumeWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumOfflineResumeResultType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({OfflineResume:[3112,{affectedBySleepMode:[35,a.TYPES.BOOLEAN],attemptNumber:[36,a.TYPES.INTEGER],chatThreadCount:[1,a.TYPES.INTEGER],dbDurationT:[39,a.TYPES.TIMER],dbMainThreadDurationT:[40,a.TYPES.TIMER],dbMainThreadReadsCount:[41,a.TYPES.INTEGER],dbMainThreadWritesCount:[42,a.TYPES.INTEGER],dbReadsCount:[43,a.TYPES.INTEGER],dbWritesCount:[44,a.TYPES.INTEGER],disconnected:[45,a.TYPES.BOOLEAN],expectedOfflineCallCount:[23,a.TYPES.INTEGER],expectedOfflineMessageCount:[17,a.TYPES.INTEGER],expectedOfflineNotificationCount:[18,a.TYPES.INTEGER],expectedOfflineReceiptCount:[19,a.TYPES.INTEGER],isOfflineCompleteMissed:[2,a.TYPES.BOOLEAN],isResumeInForeground:[13,a.TYPES.BOOLEAN],isResumeStartedInForeground:[37,a.TYPES.BOOLEAN],isRunningFromServiceExtension:[22,a.TYPES.BOOLEAN],lastStanzaT:[3,a.TYPES.TIMER],logoutSessionId:[38,a.TYPES.INTEGER],mailboxAge:[14,a.TYPES.INTEGER],mainScreenLoadT:[4,a.TYPES.TIMER],offlineCallCount:[24,a.TYPES.INTEGER],offlineDecryptErrorCount:[5,a.TYPES.INTEGER],offlineMessageCount:[6,a.TYPES.INTEGER],offlineNotificationCount:[7,a.TYPES.INTEGER],offlinePreviewT:[8,a.TYPES.TIMER],offlineProcessingT:[20,a.TYPES.TIMER],offlineReceiptCount:[9,a.TYPES.INTEGER],offlineResumeResult:[21,d("WAWebWamEnumOfflineResumeResultType").OFFLINE_RESUME_RESULT_TYPE],offlineSessionT:[46,a.TYPES.TIMER],offlineSizeBytes:[10,a.TYPES.INTEGER],onTrickleMode:[15,a.TYPES.BOOLEAN],pageLoadT:[11,a.TYPES.TIMER],passiveModeT:[25,a.TYPES.TIMER],preackCallCount:[26,a.TYPES.INTEGER],preackMessageCount:[27,a.TYPES.INTEGER],preackNotificationCount:[28,a.TYPES.INTEGER],preackReceiptCount:[29,a.TYPES.INTEGER],preacksCount:[47,a.TYPES.INTEGER],processedCallCount:[30,a.TYPES.INTEGER],processedMessageCount:[31,a.TYPES.INTEGER],processedNotificationCount:[32,a.TYPES.INTEGER],processedReceiptCount:[33,a.TYPES.INTEGER],runningTasks:[48,a.TYPES.STRING],socketConnectT:[12,a.TYPES.TIMER],transientOfflineSessionId:[34,a.TYPES.STRING]},[1,1,1],"regular"]},{OfflineResume:[]});g.OfflineResumeWamEvent=b}),98);
__d("WAWebWamOfflineResumeReporter",["$InternalEnum","WAHex","WALogger","WAQplTypes","WATimeUtils","WAWebABProps","WAWebDBTableUsage","WAWebGetAllModelStorageTableNames","WAWebOfflineResumeStageWamEvent","WAWebOfflineResumeWamEvent","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","WAWebUserPrefsGeneral","WAWebUserPrefsMultiDevice","WAWebWamEnumOfflineResumeModes","WAWebWamEnumOfflineResumeStages","WAWebWamEnumWebScenarioCode","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] decryption error count exceeding product requirement, count ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] loading time exceeding product requirement, time ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] offline resume completes\n        ============== offline resume perf ================\n        messageCount: ","\n        receiptCount: ","\n        notificationCount: ","\n        chatThreadCount: ","\n        sizeBytes: ","\n        decryptErrorCount: ","\n        preackMessageCount: ","\n        preackReceiptCount: ","\n        lastStanzaT: ","\n        pageLoadT: ","\n        socketConnectT: ","\n        passiveModeT: ","\n        offlinePreviewT: ","\n        mainScreenLoadT: ","\n        isResumeInForeground: ","\n        isBlockingOfflineResume: ","\n        mailboxAge: ","\n        ===================================================\n        "]);j=function(){return a};return a}var k=b("$InternalEnum").Mirrored(["ResumeFromRestart","ResumeFromOpentab"]),l=function(){function a(a){this._mode=a}var b=a.prototype;b.start=function(){if(!d("WAWebABProps").getABPropConfigValue("web_offline_resume_qpl_enabled"))return;this.drop();this._qplEvent=d("WAWebQplQuickPerformanceLoggerModule").QPL.markerStart(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.OFFLINE_RESUME,{annotations:{string:{mode:k.getName(this._mode)}}})};b.end=function(){var a;(a=this._qplEvent)==null?void 0:a.end(d("WAQplTypes").QuickLogActionType.SUCCESS)};b.drop=function(){var a;(a=this._qplEvent)==null?void 0:a.drop();this._qplEvent=void 0};b._addPoint=function(a,b){var c;b=b!=null?{data:b}:{};(c=this._qplEvent)==null?void 0:c.addPoint(a,b)};b.markOfflinePreviewReceived=function(){this._addPoint("offlinePreviewReceived")};b.markMainScreenLoad=function(){this._addPoint("mainScreenLoad")};b.setAnnotations=function(a){var b;(b=this._qplEvent)==null?void 0:b.annotate(a)};return a}(),m=function(){function a(a,b){this._sessionId=b,this._offlineStartT=self.performance.now(),this._resumeMode=a}var b=a.prototype;b._commitOfflineStage=function(a){a=new(d("WAWebOfflineResumeStageWamEvent").OfflineResumeStageWamEvent)({offlineSessionId:this._sessionId,offlineResumeMode:this._resumeMode===k.ResumeFromOpentab?d("WAWebWamEnumOfflineResumeModes").OFFLINE_RESUME_MODES.RESUME_FROM_OPEN_TAB:d("WAWebWamEnumOfflineResumeModes").OFFLINE_RESUME_MODES.RESUME_FROM_RESTART,offlineStageTimestampMs:Math.floor(self.performance.now()-this._offlineStartT),currentOfflineStage:a});this._addOfflineMetadata(a);a.commit()};b.logOfflineStart=function(){this._offlineStartT=self.performance.now()};b.logSocketConnect=function(){this._commitOfflineStage(d("WAWebWamEnumOfflineResumeStages").OFFLINE_RESUME_STAGES.SOCKET_CONNECT)};b.logProcessComplete=function(){this._commitOfflineStage(d("WAWebWamEnumOfflineResumeStages").OFFLINE_RESUME_STAGES.PROCESS_COMPLETE)};b.logScreenLoad=function(){this._commitOfflineStage(d("WAWebWamEnumOfflineResumeStages").OFFLINE_RESUME_STAGES.SCREEN_LOAD)};b.logOfflinePreview=function(){this._commitOfflineStage(d("WAWebWamEnumOfflineResumeStages").OFFLINE_RESUME_STAGES.OFFLINE_PREVIEW)};b.logOfflineCount=function(a){var b;((b=this._offlineMessageCount)!=null?b:0)===0&&(this._offlineMessageCount=a.message);((b=this._offlineReceiptCount)!=null?b:0)===0&&(this._offlineReceiptCount=a.receipt);((b=this._offlineNotificationCount)!=null?b:0)===0&&(this._offlineNotificationCount=a.notification)};b.logOfflineDecryptionErrorCount=function(a){this._offlineDecryptErrorCount=a};b.logOfflineChatThreadCount=function(a){this._chatThreadCount=a};b.logOldestStanzaTime=function(a){(this._oldestStanzaTs==null||this._oldestStanzaTs>a)&&(this._oldestStanzaTs=a)};b.setLastPushCompleteTimestamp=function(){this._lastPushCompleteTimestampMs=d("WAWebUserPrefsGeneral").getLastPushCompleteTimestamp()};b._addOfflineMetadata=function(a){this._offlineMessageCount!=null&&(a.offlineMessageCount=n(this._offlineMessageCount,10)),this._offlineReceiptCount!=null&&(a.offlineReceiptCount=n(this._offlineReceiptCount,10)),this._offlineNotificationCount!=null&&(a.offlineNotificationCount=n(this._offlineNotificationCount,10)),this._oldestStanzaTs!=null&&(a.mailboxAge=o(this._oldestStanzaTs)),this._offlineDecryptErrorCount!=null&&(a.offlineDecryptErrorCount=this._offlineDecryptErrorCount),this._chatThreadCount!=null&&(a.chatThreadCount=n(this._chatThreadCount,10)),this._lastPushCompleteTimestampMs!=null&&a.currentOfflineStage===d("WAWebWamEnumOfflineResumeStages").OFFLINE_RESUME_STAGES.SOCKET_CONNECT&&(a.lastPushTimestampMs=this._lastPushCompleteTimestampMs,void d("WAWebUserPrefsGeneral").clearLastPushCompleteTimestamp(),this._lastPushCompleteTimestampMs=null)};return a}();a=function(){function a(){this._initEvents(k.ResumeFromRestart)}var e=a.prototype;e._initEvents=function(a){this.isInitialSync=!1;this.oldestStanzaTs=0;this.offlineResume=new(d("WAWebOfflineResumeWamEvent").OfflineResumeWamEvent)();this.offlineResume.offlineMessageCount=0;this.offlineResume.offlineReceiptCount=0;this.offlineResume.offlineNotificationCount=0;this.offlineResume.offlineDecryptErrorCount=0;this.offlineResume.offlineSizeBytes=0;this.offlineResume.chatThreadCount=0;this.offlineResume.preackMessageCount=0;this.offlineResume.preackReceiptCount=0;this.offlineResume.isOfflineCompleteMissed=!1;this.qpl=new l(a);var b=this._generateOfflineSessionId();this.offlineStage=new m(a,b);this.endTableUsageMetric=d("WAWebDBTableUsage").beginDBTableUsage(d("WAWebWamEnumWebScenarioCode").WEB_SCENARIO_CODE.OFFLINE_RESUME,new Set(d("WAWebGetAllModelStorageTableNames").allModelStorageTableNames),b)};e.logOldestStanzaTime=function(a){this.offlineStage.logOldestStanzaTime(a);if(this.offlineResume==null)return;(this.oldestStanzaTs===0||this.oldestStanzaTs>a)&&(this.oldestStanzaTs=a)};e.logOfflineCount=function(a){var b;this.offlineStage.logOfflineCount(a);this.offlineStage.logOfflinePreview();if(!this.offlineResume)return;((b=this.offlineResume.offlineMessageCount)!=null?b:0)===0&&(this.offlineResume.offlineMessageCount=a.message);((b=this.offlineResume.offlineReceiptCount)!=null?b:0)===0&&(this.offlineResume.offlineReceiptCount=a.receipt);((b=this.offlineResume.offlineNotificationCount)!=null?b:0)===0&&(this.offlineResume.offlineNotificationCount=a.notification)};e.logOfflineDecryptionErrorCount=function(a){this.offlineStage.logOfflineDecryptionErrorCount(a);if(!this.offlineResume)return;this.offlineResume.offlineDecryptErrorCount=a};e.logAddOfflineSizeBytes=function(a){if(!this.offlineResume)return;this.offlineResume.offlineSizeBytes+=a};e.logOfflineChatThreadCount=function(a){this.offlineStage.logOfflineChatThreadCount(a);a=n(a,10);if(!this.offlineResume)return;this.offlineResume.chatThreadCount=a};e.logOfflinePreackCount=function(a,b){b===void 0&&(b=!1),this.offlineResume&&(b===!0?this.offlineResume.preackMessageCount+=a:this.offlineResume.preackReceiptCount+=a)};e.logOfflinePassiveT=function(){var a;if(((a=this.offlineResume)==null?void 0:a.passiveModeT)!=null)return;this._logPerformanceT("passiveModeT")};e._logPerformanceT=function(a){var b=Math.floor(self.performance.now());if(this.offlineResume==null)return;this.offlineResume[a]=b};e.logLastStanzaT=function(){var a;if(((a=this.offlineResume)==null?void 0:a.lastStanzaT)!=null)return;this._logPerformanceT("lastStanzaT");this.isInitialSync||this.offlineStage.logProcessComplete()};e.logMainScreenLoadT=function(){this._logPerformanceT("mainScreenLoadT"),this.qpl.markMainScreenLoad(),this.isInitialSync||this.offlineStage.logScreenLoad()};e.logOfflinePreviewT=function(){this._logPerformanceT("offlinePreviewT"),this.qpl.markOfflinePreviewReceived()};e.logOfflineStartT=function(){this._logPerformanceT("pageLoadT"),this.offlineStage.logOfflineStart(),window.document&&this.offlineResume&&(this.offlineResume.isResumeInForeground=!document.hidden,document.addEventListener("visibilitychange",this.logResumeInBackground))};e.logSocketConnectT=function(){this.qpl.start(),this._logPerformanceT("socketConnectT"),this.isInitialSync||this.offlineStage.logSocketConnect()};e.logMissedOfflineComplete=function(){if(!this.offlineResume)return;this.offlineResume.isOfflineCompleteMissed=!0};e.setIsInitialSync=function(){this.isInitialSync=!0};e.logResumeInBackground=function(){if(!this.offlineResume)return;document.hidden&&(this.offlineResume.isResumeInForeground=!1)};e.setLastPushCompleteTimestamp=function(){return this.offlineStage.setLastPushCompleteTimestamp()};e.isBlockingOfflineResume=function(a){if(a.lastStanzaT!=null&&a.mainScreenLoadT!=null)return a.lastStanzaT<a.mainScreenLoadT;else if(a.socketConnectT!=null&&a.lastStanzaT!=null&&a.mainScreenLoadT==null)return!0;else if(a.socketConnectT!=null&&a.lastStanzaT==null&&a.mainScreenLoadT!=null)return!1;return null};e.commit=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this.offlineResume;if(!a)return;a.offlineSizeBytes=n(a.offlineSizeBytes,1e3);a.offlineMessageCount=n(a.offlineMessageCount,10);a.offlineReceiptCount=n(a.offlineReceiptCount,10);a.offlineNotificationCount=n(a.offlineNotificationCount,10);a.mailboxAge=o(this.oldestStanzaTs);yield d("WAWebUserPrefsMultiDevice").setRecentMailboxAgeDays(a.mailboxAge);var b=this.isBlockingOfflineResume(a);d("WALogger").LOG(j(),a.offlineMessageCount,a.offlineReceiptCount,a.offlineNotificationCount,a.chatThreadCount,a.offlineSizeBytes,a.offlineDecryptErrorCount,a.preackMessageCount,a.preackReceiptCount,a.lastStanzaT,a.pageLoadT,a.socketConnectT,a.passiveModeT,a.offlinePreviewT,a.mainScreenLoadT,a.isResumeInForeground,b,a.mailboxAge);if(!this.isInitialSync){a.commit();this.qpl.setAnnotations({"int":{messageCount:a.offlineMessageCount,receiptCount:a.offlineReceiptCount,notificationCount:a.offlineNotificationCount,chatThreadCount:a.chatThreadCount,sizeBytes:a.offlineSizeBytes,decryptErrorCount:a.offlineDecryptErrorCount,preackMessageCount:a.preackMessageCount,preackReceiptCount:a.preackReceiptCount},bool:{isResumeInForeground:a.isResumeInForeground,isBlockingOfflineResume:b}});this.qpl.end();this.endTableUsageMetric();if(!c("gkx")("26258")){b=3*60*1e3;var e=10,f=Math.max(a.mainScreenLoadT,a.lastStanzaT);f-a.socketConnectT>b&&d("WALogger").ERROR(i(),a.mainScreenLoadT).sendLogs("slow-offline-resume");a.offlineDecryptErrorCount>e&&d("WALogger").ERROR(h(),a.offlineDecryptErrorCount).sendLogs("slow-offline-resume")}}else this.qpl.drop();this.offlineResume=null;window.document&&document.removeEventListener("visibilitychange",this.logResumeInBackground)});function e(){return a.apply(this,arguments)}return e}();e.resetEvent=function(){this.offlineResume==null&&(this._initEvents(k.ResumeFromOpentab),this.logOfflineStartT())};e._generateOfflineSessionId=function(){return""+d("WAHex").randomHex(4)+d("WATimeUtils").unixTimeWithoutClockSkewCorrection()};return a}();function n(a,b){return c("gkx")("26258")?Math.round(a/b)*b:a}function o(a){if(a===0)return 0;a=d("WATimeUtils").unixTime()-a;return Math.round(a/d("WATimeUtils").DAY_SECONDS)}e=new a();g.roundUp=n;g.countDays=o;g.OfflineResumeReporter=e}),98);
__d("WAWebClearDanglingReceipts",["Promise","WAAbortError","WALogger","WATimeUtils","WAWebABProps","WAWebCommsSendPing","WAWebNetworkStatus","WAWebOfflineResumePreAckHandler","WAWebSchemaDanglingReceipt","WAWebSendReceiptJobCommon","WAWebWamOfflineResumeReporter","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["clearDanglingReceipts: starting clean receipts"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["clearDanglingReceipts: starting sending ping"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][utils] clearDanglingReceipts: skip due to offline."]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendAndClearDanglingReceipts: complete"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendAndClearDanglingReceipts: complete sending  "," preAcks"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendAndClearDanglingReceipts: complete sending "," receipts"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendAndClearDanglingReceipts: starting sending "," receipts,  "," preAcks"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendAndClearDanglingReceipts: aborting receipts to signal.aborted"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendAndClearDanglingReceipts: get "," danglingRecords"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendAndClearDanglingReceipts: aborting due to signal.aborted"]);r=function(){return a};return a}function a(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.aborted&&d("WAWebABProps").getABPropConfigValue("web_abort_preacks_on_disconnect_enabled")){d("WALogger").LOG(r());throw new(d("WAAbortError").AbortError)()}var c=(yield d("WAWebSchemaDanglingReceipt").getTable().all());d("WALogger").LOG(q(),c.length);if(a.aborted){d("WALogger").LOG(p());throw new(d("WAAbortError").AbortError)()}var e=new Map(),f=[],g=0;c.forEach(function(a){g+=a.receipts.length;var b=a.receipts;a=a.acks;b.forEach(function(a){var b=d("WAWebWidFactory").createWid(a.from),c=d("WAWebWidFactory").createWid(a.author),f=e.get(b);f||(f=new Map(),e.set(b,f));b=f.get(c);b||(b=[],f.set(c,b));b.push(a.externalId)});f=f.concat(a)});var i=String(d("WATimeUtils").unixTime());c=Array.from(e.keys()).map(function(b){var c=e.get(b);if(!c)return;return d("WAWebSendReceiptJobCommon").sendAggregateReceipts({to:b,type:d("WAWebSendReceiptJobCommon").RECEIPT_TYPE.DELIVERY,t:i,groupedReceipt:c,signal:a})});var j=f.map(function(a){return d("WAWebOfflineResumePreAckHandler").sendOfflinePreAck(a)});d("WALogger").LOG(o(),c.length,j.length);yield (h||(h=b("Promise"))).all(c);d("WALogger").LOG(n(),c.length);yield h.all(j);d("WALogger").LOG(m(),j.length);yield t();d("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logOfflinePreackCount(g);d("WALogger").LOG(l())});return s.apply(this,arguments)}function t(){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!c("WAWebNetworkStatus").online){d("WALogger").LOG(k());return(h||(h=b("Promise"))).resolve()}d("WALogger").LOG(j());yield d("WAWebCommsSendPing").blockSendPing();d("WALogger").LOG(i());yield d("WAWebSchemaDanglingReceipt").getTable().clear()});return u.apply(this,arguments)}g.sendAndClearDanglingReceipts=a;g.clearDanglingReceipts=t}),98);
__d("WAWebHandleOfflineAbProps",["WAWebABProps","WAWebOfflineHandler","WAWebRuntimeEnvironmentUtils"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("web_non_blocking_offline_resume_max_message_count")}function b(){return d("WAWebABProps").getABPropConfigValue("web_offline_stage_manager_singleton_enabled")}function c(){return!d("WAWebRuntimeEnvironmentUtils").isServiceWorker()&&d("WAWebABProps").getABPropConfigValue("web_offline_dynamic_batch_size_enabled")}function e(){var a=JSON.parse(d("WAWebABProps").getABPropConfigValue("web_offline_dynamic_batch_config")),b=parseFloat(a.multiplier);a=a.version||"default";return{multiplier:Number.isNaN(b)?.2:b,version:a}}function f(){return d("WAWebABProps").getABPropConfigValue("web_offline_resume_max_batch_size_enabled")}function h(){var a=parseInt(d("WAWebABProps").getABPropConfigValue("web_offline_resume_max_batch_size"),10);return!Number.isNaN(a)&&a>0?a:d("WAWebOfflineHandler").DEFAULT_MAX_BATCH_SIZE}g.getNonBlockingOfflineResumeMaxMessageCount=a;g.isNonBlockingOfflineResumeExpEnabled=b;g.isOfflineDynamicBatchSizeEnabled=c;g.getOfflineDynamicBatchConfig=e;g.isOfflineResumeMaxBatchSizeEnabled=f;g.getOfflineResumeMaxBatchSize=h}),98);
__d("WAWebOfflineDeviceCache",["WAComms","WADeprecatedSendIq","WALogger","WAShiftTimer","WAWebApiPendingDeviceSync","WAWebPromiseQueue","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][device-cache]: creating snapshot for pending devices ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][device-cache]: creating snapshot: schedule in "," ms"]);i=function(){return a};return a}var j=3e3;a=function(){function a(){var a=this;this.pendingDeviceCache=new Set();this.pendingAcks=[];this.snapshotTimer=new(d("WAShiftTimer").ShiftTimer)(function(){a.createSnapshot()});this.checkpointQueue=new(d("WAWebPromiseQueue").PromiseQueue)()}var c=a.prototype;c.addOfflinePendingDevice=function(a,b){this.pendingDeviceCache.add(a),b&&this.pendingAcks.push(b),this.snapshotTimer.isScheduled()||(d("WALogger").LOG(i(),j),this.snapshotTimer.onOrAfter(j))};c.createSnapshot=function(){this.snapshotTimer.isScheduled()&&this.snapshotTimer.cancel();var a=Array.from(this.pendingDeviceCache),c=this.pendingAcks;d("WALogger").LOG(h(),a.join(","));this.checkpointQueue.enqueue(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebApiPendingDeviceSync").addUserToPendingDeviceSync(a),c.forEach(function(a){return d("WADeprecatedSendIq").deprecatedCastStanza(a)}),d("WAComms").cancelDeadSocketTimer()}));this.pendingDeviceCache=new Set();this.pendingAcks=[]};return a}();c=new a();g.OfflinePendingDeviceCache=c}),98);
__d("WASmaxOutOfflineBatchRequest",["WASmaxJsx","WAWap"],(function(a,b,c,d,e,f,g){function a(a){a=a.offlineBatchCount;a=d("WASmaxJsx").smax("ib",null,d("WASmaxJsx").smax("offline_batch",{count:d("WAWap").INT(a)}));return a}g.makeBatchRequest=a}),98);
__d("WASmaxOfflineBatchRPC",["WAComms","WASmaxOutOfflineBatchRequest","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:c=d("WASmaxOutOfflineBatchRequest").makeBatchRequest(a);e.next=3;return b("regeneratorRuntime").awrap(d("WAComms").castSmaxStanza(c));case 3:case"end":return e.stop()}},null,this)}g.sendBatchRPC=a}),98);
__d("WAWebLid1x1MigrationPrimaryCache",["WAWebUserPrefsIndexedDBStorage","WAWebWidFactory"],(function(a,b,c,d,e,f,g){a=function(){function a(){this.$1=0;this.$2=new Map();var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WALidThreadAccountMigrationStatus");if(a==null||a.lidMappingsFromPrimaryMigration==null)return;this.$3(a.lidMappingsFromPrimaryMigration)}var b=a.prototype;b.getLidForPn=function(a){return this.$2.get(a)};b.updateCacheIfEmpty=function(a){if(this.$2.size!==0)return;this.clear();this.$3(a)};b.updateCacheInTest=function(a,b){var c=this;this.$1=b;a.forEach(function(a,b){c.$2.set(d("WAWebWidFactory").createUserWid(b),d("WAWebWidFactory").createUserWid(a+"@lid"))})};b.$3=function(a){};b.clear=function(){this.$1=0,this.$2.clear()};return a}();b=new a();g.lidPnMigrationPrimaryCache=b}),98);
__d("WAWebLogoutReasonConstants",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({UserInitiated:"user_initiated",SyncdFailure:"syncd_failure",InvalidAdvStatus:"invalid_adv_status",CriticalSyncTimeout:"critical_sync_timeout",SyncdTimeout:"syncd_timeout",HistorySyncTimeout:"history_sync_timeout",AccountSyncTimeout:"account_sync_timeout",MDOptOut:"md_opt_out",UnknownCompanion:"unknown_companion",ClientVersionOutdated:"client_version_outdated",SyncdErrorDuringBootstrap:"syncd_error_during_bootstrap",AccountSyncError:"account_sync_error",ClientFatalError:"client_fatal_error",StorageQuotaExceeded:"storage_quota_exceeded",PrimaryIdentityKeyChange:"primary_identity_key_change",MissingEncSalt:"missing_enc_salt",MissingScreenLockSalt:"missing_screen_lock_salt",AccountLocked:"account_locked",LidMigrationSplitThreadMismatch:"lid_migration_split_thread_mismatch",LidMigrationNoLidAvailiable:"lid_migration_no_lid_available",LidMigrationPrimaryMappingsObsolete:"lid_migration_primary_mappings_obsolete",LidMigrationPeerMappingsNotReceived:"lid_migration_peer_mapping_not_received"});c={CLIENT_FATAL:"0",SYNC_FAIL:"1",INITIAL_HISTORY_SYNC_TIMEOUT:"2",ACCOUNT_LOCKED:"3"};f.LogoutReason=a;f.LOGOUT_REASON_CODE=c}),66);
__d("WAWebSocketLogoutJob",["Promise","WALogger","WAWebBackendApi","WAWebRuntimeEnvironmentUtils","WAWebUserPrefsGeneral","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Socket logout failed, err: ",""]);i=function(){return a};return a}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(d("WAWebRuntimeEnvironmentUtils").isServiceWorker())try{yield (h||(h=b("Promise"))).all([d("WAWebUserPrefsGeneral").setOfflinePushDisabled(!0),d("WAWebUserPrefsGeneral").setLogoutReason({reason:a})])}catch(a){d("WALogger").ERROR(i(),a).sendLogs("sw-socket-logout-failed");return}d("WAWebBackendApi").frontendFireAndForget("socketLogout",{reason:a})});return j.apply(this,arguments)}g.socketLogout=a}),98);
__d("WAWebLid1X1ThreadAccountMigrations",["$InternalEnum","WALogger","WANullthrows","WATimeUtils","WAWebABProps","WAWebApiContact","WAWebLid1X1MigrationGating","WAWebLid1x1MigrationPrimaryCache","WAWebLogoutReasonConstants","WAWebSchemaChat","WAWebSocketLogoutJob","WAWebUserPrefsIndexedDBStorage","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[LID] Failed to migrate 1x1 chats: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[LID] Failed to migrate 1x1 chats with reason: ",". Logging out"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[LID] migrate1x1Chats: migration is not ready"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[LID] getResolvedThreadAccountLid: latestLocalLid is null"]);k=function(){return a};return a}var l=b("$InternalEnum")({WAITING_PROP:1,WAITING_MAPPINGS:2,READY:3,IN_PROGRESS:4,COMPLETE:5});function a(){var a=d("WAWebABProps").getABPropConfigValue("lid_one_on_one_migration_enabled"),b=r().state;if(!a&&b!==l.WAITING_PROP&&b!==l.COMPLETE)return q(l.WAITING_PROP);if(a&&b===l.WAITING_PROP)return q(l.WAITING_MAPPINGS)}function m(){var a=r().state;return a===l.READY||a===l.IN_PROGRESS}function e(){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{if(!m()){d("WALogger").ERROR(j()).sendLogs("lid-migration-not-ready");return}q(l.IN_PROGRESS);var a=r(),b=c("WANullthrows")(a==null?void 0:a.lidMappingsFromPrimaryMigration,"got empty mappings while in lid thread migration"),e=c("WANullthrows")(a==null?void 0:a.ts,"received empty sync timestamp while in lid thread migration");d("WAWebLid1x1MigrationPrimaryCache").lidPnMigrationPrimaryCache.updateCacheIfEmpty(b);a=(yield d("WAWebSchemaChat").getChatTable().all()).filter(function(a){a=a.id;a=d("WAWebWidFactory").createWid(a);return a.isUser()&&!a.isBot()});var f=new Set(a.map(function(a){a=a.id;return d("WAWebWidFactory").toUserWid(d("WAWebWidFactory").createWid(a))})),g=null,k=[];a.map(function(a){var b;if(g!=null)return;var c=d("WAWebWidFactory").createWid(a.id);if(c.isLid()){k.push({id:a.id,accountLid:c.toString()});return}var h=d("WAWebApiContact").getCurrentLid(d("WAWebWidFactory").toUserWid(c)),i=h!=null?f.has(h):!1;c=d("WAWebLid1x1MigrationPrimaryCache").lidPnMigrationPrimaryCache.getLidForPn(c);b=o({mostRecentMsgTs:(b=a.t)!=null?b:0,isThreadExistsWithChatJid:i,primarySyncTs:e,primaryProvidedLid:c,latestLocalLid:h});if(b.logoutReason!=null){g=b.logoutReason;return}k.push({id:a.id,accountLid:b.threadLid.toString()})});if(g!=null){d("WALogger").ERROR(i(),g);return d("WAWebSocketLogoutJob").socketLogout(g)}yield d("WAWebSchemaChat").getChatTable().bulkCreateOrMerge(k);q(l.COMPLETE);void d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.setIsLidMigrated(!0)}catch(a){d("WALogger").ERROR(h(),a).sendLogs("lid-thread-migration")}});return n.apply(this,arguments)}function o(a){var b=a.mostRecentMsgTs,c=a.isThreadExistsWithChatJid,e=a.primarySyncTs,f=a.primaryProvidedLid;a=a.latestLocalLid;if(f==null){if(a==null)return{logoutReason:d("WAWebLogoutReasonConstants").LogoutReason.LidMigrationNoLidAvailiable};return c?{logoutReason:d("WAWebLogoutReasonConstants").LogoutReason.LidMigrationSplitThreadMismatch}:{threadLid:a}}c=d("WAWebABProps").getABPropConfigValue("lid_one_on_one_migration_log_out_on_mismatch");if(!c)return{threadLid:f};if(a==null||a===f){a==null&&d("WALogger").ERROR(k()).sendLogs("lid-migration-missing-local-lid");return{threadLid:f}}return b>=e?{logoutReason:d("WAWebLogoutReasonConstants").LogoutReason.LidMigrationPrimaryMappingsObsolete}:{threadLid:f}}function p(){var a;return(a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WALidThreadAccountMigrationStatus"))==null?void 0:a.ts}function f(){var a;if(!d("WAWebABProps").getABPropConfigValue("lid_one_on_one_migration_enabled"))return!1;var b=r().state;a=(a=p())!=null?a:d("WATimeUtils").unixTime();return b===l.WAITING_MAPPINGS&&d("WATimeUtils").unixTime()-a>=d("WATimeUtils").DAY_SECONDS*16}function q(a){var b=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WALidThreadAccountMigrationStatus");b=babelHelpers["extends"]({},b,{state:a,ts:d("WATimeUtils").unixTime()});void d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set("WALidThreadAccountMigrationStatus",b)}function r(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WALidThreadAccountMigrationStatus");if(a==null){var b={state:l.WAITING_PROP,ts:d("WATimeUtils").unixTime()};void d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set("WALidThreadAccountMigrationStatus",b);return b}return a}g.LidThreadMigrationStatus=l;g.checkIfMigrationEnabled=a;g.migrate1x1Chats=e;g.getResolvedThreadAccountLid=o;g.isLidThreadMigrationExpired=f}),98);
__d("WAWebOfflineHandler",["invariant","WALogger","WASmaxOfflineBatchRPC","WAWebABProps","WAWebCmd","WAWebEventsWaitForReadyForOffline","WAWebHandleOfflineAbProps","WAWebLid1X1ThreadAccountMigrations","WAWebLogoutReasonConstants","WAWebOfflineResumeUtils","WAWebPageLoadLogging","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","WAWebSocketLogoutJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][adaptive] _maybeRequestMoreStanza: request next batch, pending message ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][adaptive] _maybeRequestMoreStanza: start request next batch"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][adaptive] _maybeRequestMoreStanza: skip, prevPending: ",", currentPending: ",", complete: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][adaptive][debounced] _maybeRequestMoreStanzaDebounced: start request next batch"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][adaptive][debounced] _maybeRequestMoreStanzaDebounced: skipDebouncing: ",", prevPending: ",", currentPending: ",", complete: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][adaptive][debounced] _maybeRequestMoreStanza: request next batch, pending message ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][lid-migration] waiting for mappings exceeded timeout. Logout user"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][adaptive] _endBatchCheck: done"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[resume-from-open-tab] restart client due to exceed the LIMIT, message: ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[resume-from-open-tab][non-blocking] resume from current state of app"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] initState called more than once"]);s=function(){return a};return a}var t=200,u=10,v=200,w=100,x=new Map([[0,200],[1,100],[2,50],[3,10]]),y=a();c=function(){function a(){this._offlineManagerInitialized=!1,this._pendingMessageCount=0,this._isPendingPrevBatch=!1,this._isPendingCurrentBatch=!1,this._currentBatchSize=t,this._runningMaxOfflineRetry=0,this._isOfflineDynamicBatchSizeEnabled=!1,this._lastBatchRequestTimestamp=0}var c=a.prototype;c.initState=function(a){this._offlineResumeManager!=null&&d("WALogger").ERROR(s()),this._offlineResumeManager=a.getBlockingStageManager(),d("WAWebPageLoadLogging").addPageLoadQplAnnotation({blocking_resume:!0}),this._createNonblockingStageManager=a.getNonblockingStageManager};c.processOfflinePreviewIb=function(a){d("WAWebPageLoadLogging").addPageLoadQplPoint("offline_preview_received");d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.OFFLINE_RESUME,"OfflinePreviewReceived");this._resetBatchState();this._isOfflineDynamicBatchSizeEnabled=d("WAWebHandleOfflineAbProps").isOfflineDynamicBatchSizeEnabled();if(this._createNonblockingStageManager!=null){var b=this._createNonblockingStageManager;d("WAWebCmd").Cmd.isMainStreamReadyMd&&this.isResumeFromRestartComplete()?A(a.message)?(d("WALogger").LOG(r()),this._offlineResumeManager=b({mainScreenLoaded:!0})):(d("WALogger").LOG(q(),a.message),d("WAWebOfflineResumeUtils").refreshWindow()):!this._offlineManagerInitialized&&!this.isResumeFromRestartComplete()&&A(a.message)&&(d("WAWebPageLoadLogging").addPageLoadQplAnnotation({blocking_resume:!1}),this._offlineResumeManager=b())}this._offlineManagerInitialized=!0;this._offlineResumeManager.processOfflinePreview(a)};c.processMessageDecryptResult=function(a){this._offlineResumeManager.processDecryptResult(a),this._pendingMessageCount-=1,void this._maybeRequestMoreStanza()};c.addOfflinePendingMessage=function(){this.isResumeFromRestartComplete()||(this._pendingMessageCount+=1)};c.newOfflineStanza=function(a,b,c){var e=this;this._isPendingPrevBatch=!1;this._runningMaxOfflineRetry=Math.max(this._runningMaxOfflineRetry,c);this._endBatchCheck==null&&(this._endBatchCheck=self.setTimeout(function(){e._maybeRequestMoreStanza(),e._endBatchCheck=null,d("WALogger").LOG(p())},0));return this._offlineResumeManager.newOfflineStanza(a,b,c)};c.offlineStanzaReceivedAfterComplete=function(){return this._offlineResumeManager.offlineStanzaReceivedAfterComplete()};c.getOfflineDeliveryProgress=function(){return this._offlineResumeManager.getOfflineDeliveryProgress()};c.getOfflineMessageCount=function(){return Math.max(this._offlineResumeManager.offlineMessagePreviewCounter,0)};c.isResumeOnSocketDisconnectInProgress=function(){return this._offlineResumeManager.isResumeOnSocketDisconnectInProgress()};c.isResumeFromRestartComplete=function(){return this._offlineResumeManager.isResumeFromRestartComplete()};c.isResumeComplete=function(){return this._offlineResumeManager.isResumeComplete()};c.getHasMessagesToDownload=function(){return this._offlineResumeManager.getHasMessagesToDownload()};c.getFinishedDownloading=function(){return this.getOfflineDeliveryProgress()===100};c.processOfflineIb=function(a){d("WAWebPageLoadLogging").addPageLoadQplPoint("offline_received");d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.OFFLINE_RESUME,"OfflineIbReceived");if(d("WAWebLid1X1ThreadAccountMigrations").isLidThreadMigrationExpired()){d("WALogger").LOG(o());return d("WAWebSocketLogoutJob").socketLogout(d("WAWebLogoutReasonConstants").LogoutReason.LidMigrationPeerMappingsNotReceived)}return this._offlineResumeManager.processOfflineSessionComplete(a)};c.shouldUseOfflineResumeScreen=function(){return this._offlineResumeManager.shouldUseOfflineResumeScreen()};c.getResumeUIProgressBarType=function(){return this._offlineResumeManager.getResumeUIProgressBarType()};c.hasInitOfflineResumeManager=function(){return this._offlineResumeManager!=null};c.getResumeType=function(){return this._offlineResumeManager.resumeType};c._resetBatchState=function(){this._isPendingPrevBatch=!1,this._isPendingCurrentBatch=!1,this._lastBatchRequestTimestamp=0};c._sendBatchRequestIBDebounced=function(a,b){var c=this;b===void 0&&(b=!1);b=b===!0||this._lastBatchRequestTimestamp===0;this._batchIBCheckTimer!=null&&self.clearTimeout(this._batchIBCheckTimer);b?(d("WALogger").LOG(n(),this._pendingMessageCount),void d("WASmaxOfflineBatchRPC").sendBatchRPC({offlineBatchCount:a}),this._lastBatchRequestTimestamp=Date.now(),this._runningMaxOfflineRetry=0,this._isPendingPrevBatch=!0,this._isPendingCurrentBatch=!1):this._batchIBCheckTimer=self.setTimeout(function(){void c._maybeRequestMoreStanzaDebounced()},w)};c._maybeRequestMoreStanzaDebounced=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a===void 0&&(a=!1);var b=Date.now()-this._lastBatchRequestTimestamp;a=a||!this.isResumeComplete()&&this._pendingMessageCount<=t&&b>=w&&this._isPendingPrevBatch===!1&&this._isPendingCurrentBatch===!0;if(this.isResumeComplete()||this._isPendingPrevBatch||this._isPendingCurrentBatch){this.isResumeComplete()||d("WALogger").LOG(m(),a,this._isPendingPrevBatch,this._isPendingCurrentBatch,this.isResumeComplete());if(a===!1)return}if(this._pendingMessageCount<=t){d("WALogger").LOG(l());this._isPendingCurrentBatch=!0;yield d("WAWebEventsWaitForReadyForOffline").waitForOfflineProcessReady();t;b=y(this._runningMaxOfflineRetry,this._currentBatchSize);this._currentBatchSize=b;this._sendBatchRequestIBDebounced(b,a)}});function a(b){return a.apply(this,arguments)}return a}();c._maybeRequestMoreStanza=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a===void 0&&(a=!1);if(this._isOfflineDynamicBatchSizeEnabled)return this._maybeRequestMoreStanzaDebounced(a);if(this.isResumeComplete()||this._isPendingPrevBatch||this._isPendingCurrentBatch){this.isResumeComplete()||d("WALogger").LOG(k(),this._isPendingPrevBatch,this._isPendingCurrentBatch,this.isResumeComplete());return}this._pendingMessageCount<=t&&(d("WALogger").LOG(j()),this._isPendingCurrentBatch=!0,yield d("WAWebEventsWaitForReadyForOffline").waitForOfflineProcessReady(),void d("WASmaxOfflineBatchRPC").sendBatchRPC({offlineBatchCount:t}),this._isPendingCurrentBatch=!1,this._isPendingPrevBatch=!0,d("WALogger").LOG(i(),this._pendingMessageCount))});function a(b){return a.apply(this,arguments)}return a}();return a}();function z(a,b,c,e){var f;e===void 0&&(e=.2);if(a===0){if(d("WAWebHandleOfflineAbProps").isOfflineResumeMaxBatchSizeEnabled()){if(b==null||b>0)return v;var g=d("WAWebHandleOfflineAbProps").getOfflineResumeMaxBatchSize();return Math.min(g,Math.floor(c*.45)+c)}return v}if(a>3)return u;g=null;f=a-((f=b)!=null?f:0);if(f===0){g=Math.floor(c*e)+c;((f=x.get(a-1))!=null?f:v)<=g&&(g=c)}else g=x.get(a);g!=null||h(0,75725,a,(e=b)!=null?e:"N/A",c);return(f=g)!=null?f:v}function a(){var a=null;return function(b,c){var e=d("WAWebHandleOfflineAbProps").getOfflineDynamicBatchConfig(),f=e.version;e=e.multiplier;var g=a;a=b;switch(f){case"progressive":return z(b,g,c,e);default:return v}}}function A(a){if(a<=200&&d("WAWebABProps").getABPropConfigValue("web_msg_sync_update_tunnel"))return!0;return a>=d("WAWebHandleOfflineAbProps").getNonBlockingOfflineResumeMaxMessageCount()?!1:!0}e=new c();g.DEFAULT_MAX_BATCH_SIZE=v;g.OfflineMessageHandlerImpl=c;g.OfflineMessageHandler=e}),98);
__d("WAWebWebcMessageProcessingPerfWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({WebcMessageProcessingPerf:[5790,{dbStoringT:[7,a.TYPES.INTEGER],decryptionT:[1,a.TYPES.INTEGER],isOffline:[2,a.TYPES.BOOLEAN],lidProcessingT:[8,a.TYPES.INTEGER],parsingT:[3,a.TYPES.INTEGER],postProcessingT:[4,a.TYPES.INTEGER],preProcessingT:[5,a.TYPES.INTEGER],processingT:[6,a.TYPES.INTEGER],reportTokenValidationT:[9,a.TYPES.INTEGER]},[1,1,100],"regular"]},{WebcMessageProcessingPerf:[]});g.WebcMessageProcessingPerfWamEvent=b}),98);
__d("WAWebOfflineResumeMsgProcessReporter",["$InternalEnum","WALogger","WAWebEventsWaitForOfflineDeliveryEnd","WAWebRuntimeEnvironmentUtils","WAWebWebcMessageProcessingPerfWamEvent"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Reporter is already triggered"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Reporter must be active to commit"]);i=function(){return a};return a}var j=b("$InternalEnum")({Decryption:0,Parsing:1,PreProcessing:2,Processing:3,PostProcessing:4,ProcessReportingTokenInfo:5,DBStoring:6}),k={ACTIVE:!1,CACHE:[]};function l(){var a={dbStoringT:0,decryptionT:0,lidProcessingT:0,parsingT:0,postProcessingT:0,preProcessingT:0,processingT:0};k.CACHE.forEach(function(b){var c=b[0];b=b[1];switch(c){case j.DBStoring:a.dbStoringT+=b;break;case j.Decryption:a.decryptionT+=b;break;case j.ProcessReportingTokenInfo:a.lidProcessingT+=b;break;case j.Parsing:a.parsingT+=b;break;case j.PostProcessing:a.postProcessingT+=b;break;case j.PreProcessing:a.preProcessingT+=b;break;case j.Processing:a.processingT+=b;break}});Object.entries(a).forEach(function(b){var c=b[0];b=b[1];typeof b==="number"&&(a[c]=Math.round(b))});return a}function c(b){if(!k.ACTIVE)return;var c=a.performance.now();return function(){var d=a.performance.now();k.CACHE.push([b,d-c])}}function m(){k.ACTIVE=!0;var a=!1;void d("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd().then(function(){if(!a){if(!k.ACTIVE){d("WALogger").ERROR(i()).sendLogs("msg_process_reporter_not_active");return}a=!0;new(d("WAWebWebcMessageProcessingPerfWamEvent").WebcMessageProcessingPerfWamEvent)(babelHelpers["extends"]({},l(),{isOffline:!0})).commit();k={ACTIVE:!1,CACHE:[]}}else d("WALogger").ERROR(h()).sendLogs("msg_process_reporter_already_triggered")})}e={stage:j,startMarker:c,activate:function(a){if(d("WAWebRuntimeEnvironmentUtils").isWorker())return;a.message>5;if(a.message<=100)return;m()}};g.msgProcessReporter=e}),98);
__d("WAWebDBProcessGroupInviteMsgs",["WATimeUtils","WAWebApiGroupInviteV4Store","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebApiGroupInviteV4Store").persistGroupInviteV4Msgs(a.map(function(a){return{id:a.id.toString(),from:a.from.toString(),to:a.to.toString(),groupId:a.inviteGrp,expiration:parseInt(a.inviteCodeExp,10),expired:d("WATimeUtils").unixTime()>=parseInt(a.inviteCodeExp,10)}}))});return h.apply(this,arguments)}g.processGroupInviteMessages=a}),98);
__d("WAWebDBReplaceUnknownAssociations",["WAWebMessageAssociation.flow","WAWebSchemaMessageAssociation"],(function(a,b,c,d,e,f,g){function a(a){var b=[];if(a.length){var c=a.map(function(a){return[a.msgKey,d("WAWebMessageAssociation.flow").MessageAssociationType.UNKNOWN]});b.push(d("WAWebSchemaMessageAssociation").getMessageAssociationTable().bulkRemove(c));b.push(d("WAWebSchemaMessageAssociation").getMessageAssociationTable().bulkCreateOrReplace(a))}return b}g.replaceUnknownAssociations=a}),98);
__d("WAWebMessageAssociationUIUpdateFromStorage",["WAWebBackendApi","WAWebHandleMsgTypes.flow"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a.forEach(function(a){void d("WAWebBackendApi").frontendFireAndForget("updateMessageUI",{chatId:a.id.remote,msg:a,messageOverwriteOption:d("WAWebHandleMsgTypes.flow").MessageOverwriteOption.NO_OVERWRITE,preserveOrder:!0})})}g.updateAssociatedMsgsUIFromStorage=a}),98);
__d("WAWebStoreMsgs",["Promise","WALogger","WASyncdOrphan","WAWebAddonGatingUtils","WAWebAddonProcessMsgs","WAWebAddonProcessMsgsUtils","WAWebApiFilterAndReplaceMessages","WAWebApiOrphanRevoke","WAWebBackendApi","WAWebBizCoexGatingUtils","WAWebBotGating","WAWebCastToReactionMsg","WAWebCheckUpdateOrphanReactions","WAWebCmd","WAWebCommonMsgUtils","WAWebDBAddOnProviders","WAWebDBMessageBulkHelper","WAWebDBMessageSerialization","WAWebDBProcessEditProtocolMsgs","WAWebDBProcessGroupInviteMsgs","WAWebDBProcessPaymentMessages","WAWebDBProcessPollUpdateMsgs","WAWebDBProcessReactionsMsgs","WAWebDBProcessReplyMsgs","WAWebDBReplaceUnknownAssociations","WAWebDBStoreMessage","WAWebDBStoreRevokeMsgs","WAWebHandleForMessageRange","WAWebHandlePlaceholderWam","WAWebLinkify","WAWebMessageAssociationGatingUtils","WAWebMessageAssociationUIUpdateFromStorage","WAWebMsgGetters","WAWebMsgType","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebProcessMessageAssociationMessages","WAWebSchemaMessage","WAWebStoreOrphans","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[store-msgs] [classify-msgs]: skip for "," duplicate messages, with id ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["storeMsgs: receive a protocol message with a type ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[store-msgs]: classifyMsgs got "," existing message(s)"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[store-msgs]: classifyMsgs got "," message(s)"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[store-msgs] Error: ",", message: ",", stack: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[store-msgs] Error: ",", message: ",", stack: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[store-msgs] done: ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["storeMsgs: checkOrphanMutations failed during handleSingleMsg for: "," chat: "," Error: ",", message: ",", stack: ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[store-msgs] start: ",""]);q=function(){return a};return a}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebSchemaMessage").getMessageTable().bulkRemove(a.map(function(a){return a.id.toString()}))});return s.apply(this,arguments)}function a(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return;try{var e=(yield w(a)),f=Object.entries(e).map(function(a){var b=a[0];a=a[1];return Array.isArray(a)&&a.length>0&&b+": "+a.length}).filter(Boolean).join(", ");d("WALogger").LOG(q(),f);var g=[],i=e.newMsgsMap,j=e.newAssociatedMsgs,k=e.replaceMsgs,l=e.revokeMsgs,s=e.paymentMsgs,t=e.reactionMsgs,x=e.groupInviteMsgs,y=e.chatsWithNewOfflineMsg,z=e.pollUpdateMsgs,A=e.removedPlaceholders,B=e.keepInChatMessages,C=e.editProtocolMsgs,D=e.replyMsgs,E=e.newsletterMsgs,F=e.unifiedAddons,G=e.botInvokeSystemMsgs;e=e.replaceCommentMsgs;j=(yield d("WAWebProcessMessageAssociationMessages").classifyAssociatedMsgsUsingExistingParentsCache(j,i));i=Array.from(i.values());if(Boolean(j==null?void 0:j.orphanAssociatedMsgs.length)&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){var H;g=g.concat((H=j==null?void 0:j.orphanAssociatedMsgs)!=null?H:[])}var I;j&&(I=d("WAWebApiFilterAndReplaceMessages").validateMsgFn(j==null?void 0:j.validAssociatedMsgs));H=(yield d("WAWebApiFilterAndReplaceMessages").filterAndReplaceMessages(i,I));H=H.newMsgs;yield d("WAWebDBMessageBulkHelper").persistNewMessagesInBulk(H,y);yield d("WAWebDBMessageBulkHelper").persistNewNewsletterMessagesInBulk(E);H=[d("WAWebSchemaMessage").getMessageTable().bulkCreateOrReplace(k)];var J=[];k.forEach(function(a){a.associationType!=null&&a.parentMsgKey!=null&&a.internalId!=null&&J.push({msgKey:a.id,parentMsgKey:a.parentMsgKey,associationType:a.associationType,msgKeyInternalId:a.internalId})});J.length>0&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&H.push.apply(H,d("WAWebDBReplaceUnknownAssociations").replaceUnknownAssociations(J));yield (h||(h=b("Promise"))).all(H);yield r(e);E=(yield d("WAWebAddonProcessMsgs").processMsgsAndGetOrphans(F));k=E.orphans;Boolean(k.length)&&(g=g.concat(k));g.length!==0&&(yield d("WAWebStoreOrphans").storeOrphans(g));H=(yield d("WAWebApiOrphanRevoke").applyAddonRevokes(F));if(H.length>0)for(e of H)l.push(e);yield v(l);yield d("WAWebDBProcessPaymentMessages").processPaymentMessages(s);yield d("WAWebDBProcessReactionsMsgs").processReactionMsgs(t);yield d("WAWebDBProcessGroupInviteMsgs").processGroupInviteMessages(x);d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&(j==null?void 0:j.detachedAssociatedMsgs.length)&&d("WAWebMessageAssociationUIUpdateFromStorage").updateAssociatedMsgsUIFromStorage(j==null?void 0:j.detachedAssociatedMsgs);yield d("WAWebBackendApi").frontendSendAndReceive("processKeepInChatMessages",{keepInChatMessages:B,allowNotification:!1});yield d("WAWebDBProcessEditProtocolMsgs").processEditProtocolMsgs(C);yield d("WAWebDBProcessReplyMsgs").processReplyMsgs(D);yield d("WAWebDBProcessPollUpdateMsgs").processPollUpdateMsgs(z);yield d("WAWebHandleForMessageRange").handleOfflineForMessageRange(a);if(d("WAWebBotGating").isBotReceiveEnabled()&&G.length>0){var K=new Set();G.forEach(function(a){if(K.has(a.id.remote.toString()))return;K.add(a.id.remote.toString());void d("WAWebBackendApi").frontendFireAndForget("updateBotInvokeSystemMsgCreated",{chatId:a.id.remote})})}E=a.map(function(a){return a.id.toString()});try{yield d("WASyncdOrphan").checkOrphanMutations(E,y),yield d("WAWebCheckUpdateOrphanReactions").checkUpdateForOrphanReactions(E)}catch(b){d("WALogger").ERROR(p(),String(E.join(" ")),String(a[0].id.remote),b.name,b.message,b.stack).devConsole(b)}u(i,A);d("WALogger").LOG(o(),f)}catch(a){c("gkx")("26258")?d("WALogger").ERROR(n(),a.name,a.message,a.stack).sendLogs("storeMsgs-error",{sampling:.01}):d("WALogger").ERROR(m(),a.name,a.message,a.stack).devConsole(a).sendLogs("storeMsgs-error: "+a.message)}});return t.apply(this,arguments)}function u(a,b){a=a.filter(function(a){return d("WAWebCommonMsgUtils").isPlaceholderMsg(a.type)});a.length>0&&void d("WAWebHandlePlaceholderWam").addPlaceholderWam(a);b.length>0&&void d("WAWebHandlePlaceholderWam").populatePlaceholderWam(b)}function v(a){var c=[];a.forEach(function(a){a.protocolMessageKey&&c.push({revokeMsgKey:a.protocolMessageKey,newMsgKey:a.id,timestamp:a.t,subtype:a.subtype,sender:d("WAWebMsgGetters").getSender(a),revokeTimestamp:a.t,disappearingModeInitiator:a.disappearingModeInitiator,ephemeralDuration:a.ephemeralDuration,ephemeralSettingTimestamp:a.ephemeralSettingTimestamp,viewMode:a.viewMode})});return d("WAWebDBStoreRevokeMsgs").processRevokeMsgs(c).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(c.length>0){var b=[],e=new Set();c.forEach(function(a){b.push(a.revokeMsgKey.toString());a=a.revokeMsgKey.remote.toString();e.add(a)});yield d("WAWebPersistedJobManager").getJobManager().waitUntilPersisted(d("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(Array.from(e.values()).join(","),b))}return a});return function(b){return a.apply(this,arguments)}}())}function w(a){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").DEV(l(),a.length);var b=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet(a.map(function(a){return String(a.id)}),!1));d("WALogger").DEV(k(),b.filter(function(a){return a!=null}).length);var c=[],e=[],f=[],g=[],h=[],m=[],n=[],o=[],p=[],q=[],r=[],s=[],t=new Set(),u=new Map(),v=new Map(),w=[],x=[],A=[];a.forEach(function(a,i){var k=a,l=String(a.id);i=b[i];if(i!=null&&z(a,i)){if(a.type===d("WAWebMsgType").MSG_TYPE.COMMENT){var B=d("WAWebAddonProcessMsgsUtils").castToAddonMsgData(k);d("WAWebAddonGatingUtils").isUnifiedInfraEnabled(a)&&B!=null&&s.push(B);x.push(a)}else{var C;B=d("WAWebDBMessageSerialization").dbRowFromMessage(k);B.t=i.t;B.internalId=i.internalId;B.rowId=i.rowId;B.pendingReadReceipt=i.pendingReadReceipt;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&i.placeholderCreatedWhenAccountIsHosted===!1&&B.senderOrRecipientAccountTypeHosted===!0&&((C=a.id)==null?void 0:(C=C.remote)==null?void 0:C.isUser())&&(B.hostedBizEncStateMismatch=!0,d("WAWebCmd").Cmd.isMainStreamReadyMd&&d("WAWebBackendApi").frontendFireAndForget("updateMsgModelHostedBizEncStateMismatchFlagToTrue",{msgId:a.id}));C=d("WAWebDBStoreMessage").isPendingUnreadReceipt(k.id,k);B=d("WAWebDBStoreMessage").addMsgMetadataToMsgRow({msg:B,chatId:k.id.remote.toString(),hasLink:d("WAWebLinkify").hasHttpLink(k),pendingReadReceipt:C});e.push(B)}d("WAWebCommonMsgUtils").isPlaceholderMsg(i.type)&&v.set(l,k)}else if(i&&!(d("WAWebCommonMsgUtils").isFutureproofMsg(i.type)&&y(a)))c.push(a.id.id);else{C=u.get(l);B=C&&!d("WAWebCommonMsgUtils").isPlaceholderMsg(C.type);if(B)c.push(a.id.id);else{a.type===d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&a.subtype==="bot_invoke_disclaimer"&&w.push(k);if(d("WAWebMsgGetters").getIsNewsletterMsg(a)&&a.type!==d("WAWebMsgType").MSG_TYPE.PROTOCOL&&a.subtype!=="admin_revoke")r.push(k);else if(d("WAWebAddonGatingUtils").isUnifiedInfraEnabled(a)&&d("WAWebAddonProcessMsgsUtils").castToAddonMsgData(k)!=null){i=d("WAWebAddonProcessMsgsUtils").castToAddonMsgData(k);i!=null&&s.push(i)}else a.type===d("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT?n.push(k):d("WAWebCastToReactionMsg").castToReactionMsgData(k)!=null?g.push(d("WAWebCastToReactionMsg").assertReactionMsgData(k)):a.kind===d("WAWebMsgType").MsgKind.PollVoteEncrypted?m.push(a):a.kind===d("WAWebMsgType").MsgKind.ProtocolRevoke?f.push(a):["sender_revoke","admin_revoke"].includes(a.subtype)?(f.push(a),d("WALogger").ERROR(j(),a.type).tags("messaging").sendLogs("storeMsgs-protocol",{sampling:.01})):a.type===d("WAWebMsgType").MSG_TYPE.PAYMENT&&a.subtype==="send"||a.subtype==="payment_action_request_declined"||a.subtype==="payment_transaction_request_cancelled"?(h.push(k),u.set(l,k),t.add(String(a.id.remote))):a.type===d("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE?(o.push(k),u.set(l,k),t.add(String(a.id.remote))):a.type===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&a.subtype==="message_edit"?p.push(k):a.quotedMsg||a.quotedStanzaID!=null?(q.push(k),u.set(l,k),t.add(String(a.id.remote))):a.associationType!=null?(u.set(l,k),A.push(a),t.add(String(a.id.remote))):a.type!==d("WAWebMsgType").MSG_TYPE.PROTOCOL&&(u.set(l,k),t.add(String(a.id.remote)))}}});c.length>0&&d("WALogger").LOG(i(),c.length,c);return{newMsgsMap:u,newAssociatedMsgs:A,chatsWithNewOfflineMsg:Array.from(t),removedPlaceholders:Array.from(v.values()),replaceMsgs:e,revokeMsgs:f,paymentMsgs:h,reactionMsgs:g,pollUpdateMsgs:m,keepInChatMessages:n,groupInviteMsgs:o,editProtocolMsgs:p,replyMsgs:q,newsletterMsgs:r,unifiedAddons:s,botInvokeSystemMsgs:w,replaceCommentMsgs:x}});return x.apply(this,arguments)}function y(a){return d("WAWebAddonGatingUtils").isUnifiedInfraEnabled(a)?!0:Boolean(d("WAWebDBAddOnProviders").getAddOnProviderForMsg(a))}function z(a,b){return d("WAWebCommonMsgUtils").isPlaceholderMsg(b.type)&&!d("WAWebCommonMsgUtils").isPlaceholderMsg(a.type)||d("WAWebCommonMsgUtils").isFutureproofMsg(b.type)&&!d("WAWebCommonMsgUtils").isFutureproofMsg(a.type)&&!y(a)}g.storeMsgs=a;g.classifyMsgs=w}),98);
__d("WAWebStoreOrphans",["WALogger","WAWebAddonProcessMsgsUtils","WAWebDBStoreMessageOrphans","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[orphans-infra]: processed "," orphan(s)"]);h=function(){return a};return a}function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return;yield d("WAWebDBStoreMessageOrphans").storeMessageOrphans(a,function(a){return d("WAWebAddonProcessMsgsUtils").getParentMsgKey(a)});d("WALogger").DEV(h(),a.length)});return i.apply(this,arguments)}g.storeOrphans=a}),98);
__d("WAWebCommonParsersParseBusinessProfile",["WAWebBizGatingUtils","WAWebBotTypes","WAWebBusinessProfileTypes","cr:5664","gkx","lodash"],(function(a,b,c,d,e,f,g){function a(a){var e=a.maybeChild("address");e=e?e.contentString():void 0;var f,g=a.maybeChild("description");g&&(f=g.contentString());g=a.maybeChild("email");g=g?g.contentString():void 0;var j=a.maybeChild("latitude");j=j?parseFloat(j.contentString()):void 0;var k=a.maybeChild("longitude");k=k?parseFloat(k.contentString()):void 0;var l=[];a.forEachChildWithTag("website",function(a){l.push({url:a.contentString()})});var m=[],n=a.maybeChild("categories");n&&n.forEachChildWithTag("category",function(a){var b=a.attrString("id");m.push({id:b,localized_display_name:a.contentString()})});var o;n=a.maybeChild("business_hours");if(n){var p=n.maybeAttrString("timezone"),q=[];n.forEachChildWithTag("business_hours_config",function(a){q.push({day_of_week:a.attrString("day_of_week"),mode:a.attrString("mode"),open_time:a.hasAttr("open_time")?parseInt(a.attrString("open_time"),10):0,close_time:a.hasAttr("close_time")?parseInt(a.attrString("close_time"),10):0})});o={config:q};p!=null&&(o.timezone=p)}var r;n=a.maybeChild("profile_options");if(n){r={};p=n.maybeChild("commerce_experience");if(p){r.commerce_experience=(p=d("WAWebBusinessProfileTypes").CommerceExperienceTypes.cast(p.contentString()))!=null?p:d("WAWebBusinessProfileTypes").CommerceExperienceTypes.NONE}p=n.maybeChild("cart_enabled");p&&(r.cart_enabled=p.contentString()==="true");p=n.maybeChild("shop_url");p&&(r.shop_url=p.contentString());p=n.maybeChild("commerce_manager_url");p&&(r.commerce_manager_url=p.contentString());p=n.maybeChild("is_banned");p&&(r.is_banned=p.contentString()==="true");p=n.maybeChild("direct_connection");p&&(r.direct_connection=p.contentString()==="true");p=n.maybeChild("is_profile_edit_disabled");p&&(r.is_profile_edit_disabled=p.contentString()==="true")}n=a.maybeChild("direct_connection");var s;if(n){p=n.maybeChild("default_postcode");s={enabled:n.maybeAttrString("enabled")==="true",defaultPostcode:p?{code:p.attrString("code"),locationName:p.attrString("location_name")}:void 0}}n=a.maybeChild("catalog_status");p=n?n.attrString("status"):void 0;n={};var t={},u=!1,v,w=a.maybeChild("linked_accounts");if(w){u=!0;var x=w.maybeChild("fb_page");if(x){var y=x.maybeChild("display_name"),z=x.maybeChild("likes");n.display_name=y==null?void 0:y.contentString();n.likes=z==null?void 0:z.contentInt();y=x.maybeAttrString("id");y!=null&&(n.id=y)}z=w.maybeChild("ig_professional");if(z){x=z.maybeChild("ig_handle");y=z.maybeChild("followers");t={ig_handle:x==null?void 0:x.contentString(),followers:y==null?void 0:y.contentInt()}}}w=a.maybeChild("cover_photo");z=w?{id:w.attrString("id"),url:new URL(w.contentString())}:void 0;if(d("WAWebBizGatingUtils").isCustomURLViaBizProfileEnabled()){x=a.maybeChild("custom_url");x&&(v=x==null?void 0:x.contentString())}w=d("WAWebBotTypes").BizBotAutomatedType.cast((y=a.maybeChild("automated_type"))==null?void 0:y.contentString());y=d("WAWebBotTypes").BotWelcomeMsgProtocolModeType.cast((x=a.maybeChild("welcome_message_protocol_mode"))==null?void 0:x.contentString());var A;x=a.maybeChild("prompts");x&&(A=h(x));x=(x=a.maybeChild("commands"))==null?void 0:(x=x.maybeChild("description"))==null?void 0:x.contentString();var B;a=a.maybeChild("commands");a&&(B=i(a));!c("gkx")("26258")&&b("cr:5664")&&(b("cr:5664").debugBotConfigs.injectBizBotFields===!0&&(y=d("WAWebBotTypes").BotWelcomeMsgProtocolModeType.BASIC,f="Hello! I'm Midjourney, your personal assistant. I'm here to assist you with anything you might need, from travel information to workout plans, and even caring for your plants. I can even sketch your imagination!",A=[{emoji:"\u2728",text:"Create an alien world!"},{emoji:"\ud83d\udd25",text:"Show a future city!"},{emoji:"\u2728",text:"Fantasy landscape? Generate now!"},{emoji:"\ud83d\udd25",text:"Describe a mythical world filled with magical creatures and let the bot generate an image that brings it to life!"},{emoji:"\u2728",text:"Picture an enchanted forest with towering trees, sparkling fairies, and vibrant flora, and let the bot create an image that captures its magic!"},{emoji:"\ud83d\udd25",text:"Imagine yourself as a time traveler who has just stepped into an ancient civilization. You find yourself surrounded by towering structures and exotic landscapes that are unfamiliar to you. Take a moment to observe the surroundings, notice the intricate details on the buildings and the unique attire worn by the people. Now, let the bot generate an image that captures the essence of this unexplored world, bringing forth a visual representation that transcends time and space!"}],x="Try these commands to get started",B=[{description:"Create images with Midjourney",name:"imagine"},{description:"View and adjust your personal settings",name:"settings"},{description:"Blend images together seamlessly",name:"blend"},{description:"View information about your profile",name:"info"},{description:"Subscribe to the profile for updates",name:"subscribe"}],l.length===0&&(l=[{url:"https://meta.com"}])));a={address:e,description:f,email:g,latitude:j,longitude:k,website:l,categories:m,business_hours:o,catalog_status:p,profile_options:r,fb_page:n,ig_professional:t,profile_is_linked:u,directConnection:s,cover_photo:z,custom_url:v,prompts:A,commands:B,commands_description:x,automated_type:w,welcome_message_protocol_mode:y};return c("lodash").omitBy(a,function(a){return a==null})}function h(a){var b=[];a.forEachChildWithTag("prompt",function(a){var c=a.maybeChild("emoji");c=(c=c==null?void 0:c.contentString())!=null?c:"";a=a.maybeChild("text");a=(a=a==null?void 0:a.contentString())!=null?a:"";b.push({emoji:c,text:a})});return b}function i(a){var b=[];a.forEachChildWithTag("command",function(a){var c=a.maybeChild("name");c=(c=c==null?void 0:c.contentString())!=null?c:"";a=a.maybeChild("description");a=(a=a==null?void 0:a.contentString())!=null?a:"";b.push({name:c,description:a})});return b}g["default"]=a}),98);
__d("WAWebBizCartConstants",[],(function(a,b,c,d,e,f){a=99;f.CART_ITEM_MAX_QUANTITY=a}),66);
__d("WAWebBizParseProductGraphql_product.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:{mask:!1},name:"WAWebBizParseProductGraphql_product",selections:[a,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},b,{alias:null,args:null,concreteType:"XWAProductCatalogProductStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[b,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null}],storageKey:null}],storageKey:null}],type:"XWACatalogProduct",abstractKey:null}}();a.hash="6d40766cd9196cc9d34ad61e5e7d5c2a";e.exports=a}),null);
__d("WAWebProductTypes.flow",["$InternalEnum"],(function(a,b,c,d,e,f){var g=b("$InternalEnum")({IN_STOCK:"in stock",OUT_OF_STOCK:"out of stock",AVAILABLE_FOR_ANOTHER_POSTCODE:"available for another postcode",UNKNOWN:"unknown"}),h=[g.OUT_OF_STOCK,g.AVAILABLE_FOR_ANOTHER_POSTCODE],i=6;b=b("$InternalEnum")({Default:"DEFAULT",CountryOriginExempt:"COUNTRY_ORIGIN_EXEMPT"});function a(a){if(a==="APPROVED"||a==="PENDING"||a==="REJECTED")return a}function c(a){if(a==null)return;switch(a){case"TRUE":return"ISHIDDEN_TRUE";case"FALSE":return"ISHIDDEN_FALSE";default:a;return a}}function d(a){if(a==null)return;switch(a){case"COUNTRY_ORIGIN_EXEMPT":return"COMPLIANCECATEGORY_COUNTRYORIGINEXEMPT";case"DEFAULT":return"COMPLIANCECATEGORY_DEFAULT";default:a;return a}}function e(a){if(a==null)return;switch(a){case"STATUS_APPROVED":return"APPROVED";case"STATUS_PENDING":return"PENDING";case"STATUS_REJECTED":return"REJECTED";default:a}}f.ProductAvailability=g;f.PRODUCT_AVAILABILITY_UNAVAILABLE_VALUES=h;f.PRODUCT_PAGE_SIZE=i;f.ProductComplianceCategory=b;f.asProductReviewType=a;f.mapIsHiddenToWASchema=c;f.mapComplianceCategoryToWASchema=d;f.mapCollectionReviewStatusToWASchema=e}),66);
__d("WAWebSignedShimmedUrl",[],(function(a,b,c,d,e,f){function a(a){return a}f.asSignedShimmedUrl=a}),66);
__d("WAWebSyntheticCountryCode",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({NotApplicable:"NOT_APPLICABLE"});f.SyntheticCountryCode=a}),66);
__d("WAWebBizParseProductGraphql",["WANullthrows","WAWebBizCartConstants","WAWebBizParseProductGraphql_product.graphql","WAWebProductTypes.flow","WAWebSignedShimmedUrl","WAWebSyntheticCountryCode"],(function(a,b,c,d,e,f,g){var h,i={AVAILABLE_FOR_ANOTHER_POSTCODE:d("WAWebProductTypes.flow").ProductAvailability.AVAILABLE_FOR_ANOTHER_POSTCODE,IN_STOCK:d("WAWebProductTypes.flow").ProductAvailability.IN_STOCK,OUT_OF_STOCK:d("WAWebProductTypes.flow").ProductAvailability.OUT_OF_STOCK};function a(a){var b,e,f=a.status_info,g=a.sale_price,h=a.product_availability,j=a.compliance_info;a=babelHelpers.objectWithoutPropertiesLoose(a,["status_info","sale_price","product_availability","compliance_info"]);b=(b=(b=a.media)==null?void 0:b.images)!=null?b:[];var k=b[0];b=b.slice(1);k=babelHelpers["extends"]({id:c("WANullthrows")(a.id),retailer_id:(e=a.retailer_id)!=null?e:"",name:c("WANullthrows")(a.name),description:(e=a.description)!=null?e:"",url:(e=a.url)!=null?e:"",currency:a.currency,price:a.price,is_hidden:a.is_hidden==="ISHIDDEN_TRUE",max_available:(e=a.max_available)!=null?e:d("WAWebBizCartConstants").CART_ITEM_MAX_QUANTITY,availability:h&&h in i?i[h]:d("WAWebProductTypes.flow").ProductAvailability.UNKNOWN},(g==null?void 0:g.price)!=null?babelHelpers["extends"]({sale_price:g.price},g.start_date!=null&&g.end_date!=null?{sale_start_date:g.start_date,sale_end_date:g.end_date}:null):null,{checkmark:a.belongs_to==="true",image_hashes_for_whatsapp:((h=(e=a.media)==null?void 0:e.images)!=null?h:[]).map(function(a){return c("WANullthrows")(a.id)}),image_cdn_urls:k?[{key:"requested",value:c("WANullthrows")(k.request_image_url)},{key:"full",value:c("WANullthrows")(k.original_image_url)}]:[],additional_image_cdn_urls:b.map(function(a){return[{key:"requested",value:c("WANullthrows")(a.request_image_url)},{key:"full",value:c("WANullthrows")(a.original_image_url)}]}),whatsapp_product_can_appeal:(f==null?void 0:f.can_appeal)==="true",capability_to_review_status:[{key:"WHATSAPP",value:(g=f==null?void 0:f.status)!=null?g:"APPROVED"}],videos:(e=a.media)==null?void 0:(h=e.videos)==null?void 0:h.map(function(a){return{id:c("WANullthrows")(a.id),original_video_url:c("WANullthrows")(a.original_video_url),thumbnail_url:c("WANullthrows")(a.thumbnail_url)}})});if(j!=null){b=j.importer_address;k.compliance_info=a.compliance_category==="COMPLIANCECATEGORY_COUNTRYORIGINEXEMPT"?{country_code_origin:d("WAWebSyntheticCountryCode").SyntheticCountryCode.NotApplicable}:{country_code_origin:(f=j.country_code_origin)!=null?f:void 0,importer_name:(g=j.importer_name)!=null?g:void 0,importer_address:{street1:c("WANullthrows")(b==null?void 0:b.street1),street2:(e=b==null?void 0:b.street2)!=null?e:void 0,postal_code:(h=b==null?void 0:b.postal_code)!=null?h:void 0,city:c("WANullthrows")(b==null?void 0:b.city),region:(f=b==null?void 0:b.region)!=null?f:void 0,country_code:c("WANullthrows")(b==null?void 0:b.country_code)}}}a.shimmed_url!=null&&(k.signedShimmedUrl=d("WAWebSignedShimmedUrl").asSignedShimmedUrl(a.shimmed_url));return k}g.parseProductGraphQL=a}),98);
__d("WAWebDirectConnectionUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a}function b(a){return a}f.stringToCertificateString=a;f.certificateStringToString=b}),66);
__d("WAWebGraphQLProductCatalogGetPublicKeyJobQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"request"}],b=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"request"}],concreteType:"XWAProductCatalogGetPublicKeyResponseSuccess",kind:"LinkedField",name:"xwa_product_catalog_get_public_key",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"public_key_certificate_pem",storageKey:null},{alias:null,args:null,concreteType:"XWAPublicKeyWithSignature",kind:"LinkedField",name:"public_key_with_signature",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"public_key_pem",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"public_key_signature",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebGraphQLProductCatalogGetPublicKeyJobQuery",selections:b,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebGraphQLProductCatalogGetPublicKeyJobQuery",selections:b},params:{id:"WAWebGraphQLProductCatalogGetPublicKeyJobQuery",metadata:{},name:"WAWebGraphQLProductCatalogGetPublicKeyJobQuery",operationKind:"query",text:null}}}();a.hash="e072c0e33a10dd8a876a1c37c2ec40a5";e.exports=a}),null);
__d("WAWebGraphQLProductCatalogGetPublicKeyJob",["WAWebDirectConnectionUtils","WAWebGraphQLProductCatalogGetPublicKeyJobQuery.graphql","WAWebRelayClient"],(function(a,b,c,d,e,f,g){var h,i=h!==void 0?h:h=b("WAWebGraphQLProductCatalogGetPublicKeyJobQuery.graphql");function a(a){return d("WAWebRelayClient").fetchQuery(i,{request:{public_key:{biz_jid:a.toJid()}}}).then(function(a){a=a==null?void 0:(a=a.xwa_product_catalog_get_public_key)==null?void 0:a.public_key_certificate_pem;return{certificate:a!=null?d("WAWebDirectConnectionUtils").stringToCertificateString(a):null}})}g.getPublicKey=a}),98);
__d("WAWebGraphQLVerifyPostcodeJobQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"request"}],b=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"request"}],concreteType:"XWAProductCatalogGetVerifyPostcodeResponseSuccess",kind:"LinkedField",name:"xwa_product_catalog_get_verify_postcode",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAProductCatalogGetVerifyPostcodeResponseSuccessPostcodeVerificationResult",kind:"LinkedField",name:"postcode_verification_result",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"result_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"encrypted_location_name",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebGraphQLVerifyPostcodeJobQuery",selections:b,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebGraphQLVerifyPostcodeJobQuery",selections:b},params:{id:"WAWebGraphQLVerifyPostcodeJobQuery",metadata:{},name:"WAWebGraphQLVerifyPostcodeJobQuery",operationKind:"query",text:null}}}();a.hash="7154b35b1d03a7c8ff2e0600cc3ac8c0";e.exports=a}),null);
__d("WAWebMaybeThrowCatalogErrors",["errorCode","WAWebBackendErrors"],(function(a,b,c,d,e,f,g,h){function a(a){var b=a.source.errors||[];b=b[0];switch(b==null?void 0:b.code){case 2498052:case 2498049:case 2498050:case 2498051:case 2498053:case 2498056:throw new(d("WAWebBackendErrors").ServerStatusCodeError)(400,a.message);case 2498048:throw new(d("WAWebBackendErrors").E451)();case 2498054:throw new(d("WAWebBackendErrors").ServerStatusCodeError)(421);case 2498103:case 2498102:throw new(d("WAWebBackendErrors").CollectionReorderError)()}}g["default"]=a}),98);
__d("WAWebGraphQLVerifyPostcodeJob",["WAWebGraphQLServerError","WAWebGraphQLVerifyPostcodeJobQuery.graphql","WAWebMaybeThrowCatalogErrors","WAWebRelayClient"],(function(a,b,c,d,e,f,g){var h,i=h!==void 0?h:h=b("WAWebGraphQLVerifyPostcodeJobQuery.graphql");function a(a,b){return d("WAWebRelayClient").fetchQuery(i,{request:{verify_postcode:{biz_jid:a.toJid(),direct_connection_encrypted_info:b}}}).then(function(a){a=(a=a==null?void 0:(a=a.xwa_product_catalog_get_verify_postcode)==null?void 0:a.postcode_verification_result)!=null?a:{};var b=a.result_code;a=a.encrypted_location_name;return{encryptedLocationName:a,resultCode:j(b)}})["catch"](function(a){a instanceof d("WAWebGraphQLServerError").GraphQLServerError&&c("WAWebMaybeThrowCatalogErrors")(a);throw a})}function j(a){switch(a){case"RESULT_CODE_SUCCESS":return"success";case"RESULT_CODE_UNSERVICEABLE_LOCATION":return"unserviceable_location";default:a;return"invalid_postcode"}}g.verifyPostcode=a;g.mapResultCodeToStrong=j}),98);
__d("WAWapDeprecatedSmaxID",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({SupportContactForm:3,CtwaGetContext:4,QueryOrder:5,CreateOrder:10,RefreshCart:11,CatalogGetProductList:21,SetCatalogVisibility:23,CommerceSettingsSet:25,CatalogGetSingleCollection:30,CatalogGetCollections:35,CatalogCreateCollection:36,CatalogUpdateCollection:40,CatalogDeleteCollections:43,CatalogAppealCollection:48,BizGetPublicKey:52,MerchantGetComplianceInfo:53,MerchantSetComplianceInfo:54,CatalogVerifyPostcode:70,BtmCustomUrlGet:78,BtmCustomUrlGetUser:79,QuerySubscription:90,UpdateCollectionList:92});c=a;f["default"]=c}),66);
__d("WAWebDefinePersistedJob",["WAJobBuilder"],(function(a,b,c,d,e,f,g){function a(){return d("WAJobBuilder").definePersistedJob()}g.defineWebPersistedJob=a}),98);
__d("WAWebQueryGetPublicKeyJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWapDeprecatedSmaxID","WAWebBackendErrors","WAWebBizGatingUtils","WAWebCommsWapMd","WAWebDefinePersistedJob","WAWebDirectConnectionUtils","WAWebGraphQLProductCatalogGetPublicKeyJob","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("getPublicKeyResponse",function(a){a.assertTag("iq");a.assertFromServer();a=(a=a.maybeChild("public_key"))==null?void 0:(a=a.maybeChild("pem"))==null?void 0:a.contentString();a=a!=null?d("WAWebDirectConnectionUtils").stringToCertificateString(a):null;return{certificate:a}});a=d("WAWebDefinePersistedJob").defineWebPersistedJob().finalStep("sendStanza",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.businessJid;a=d("WAWebWidFactory").createWid(a);if(d("WAWebBizGatingUtils").isGraphQLForGetPublicKeyEnabled())return d("WAWebGraphQLProductCatalogGetPublicKeyJob").getPublicKey(a);a=d("WAWap").wap("iq",{to:d("WAWap").S_WHATSAPP_NET,type:"get",smax_id:d("WAWap").SMAX_ID(c("WAWapDeprecatedSmaxID").BizGetPublicKey),xmlns:"w:biz:catalog",id:d("WAWap").generateId()},d("WAWap").wap("public_key",{jid:d("WAWebCommsWapMd").USER_JID(a)}));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(a,h));if(!a.success)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode);else return a.result});return function(b){return a.apply(this,arguments)}}()).end();g.QueryGetPublicKey=a}),98);
__d("WAWebBizCatalogParseProduct",["WAWap","WAWebBizCartConstants","WAWebProductTypes.flow","WAWebSignedShimmedUrl","WAWebSyntheticCountryCode"],(function(a,b,c,d,e,f,g){b=function(a){var b,c,e=a.child("id").contentString(),f=a.maybeChild("url"),g="";f&&f.hasContent()&&(g=f.contentString());f=a.child("name").contentString();b=(b=a.maybeAttrString("availability"))!=null?b:d("WAWebProductTypes.flow").ProductAvailability.UNKNOWN;var h=d("WAWebBizCartConstants").CART_ITEM_MAX_QUANTITY,j=a.maybeAttrString("max_available");j!=null&&(h=Number(j));j=a.maybeChild("max_available");j=j==null?void 0:j.contentString();j!=null&&(h=Number(j));j=a.maybeChild("description");j=j?j.contentString():"";var l=a.maybeChild("belongs_to");l=(l==null?void 0:l.contentString())==="true"||!1;var m=[],n=[],o=[],p=a.child("media"),q=!0;p.forEachChildWithTag("image",function(a){if(q)q=!1,m.push({key:"requested",value:a.child("request_image_url").contentString()}),m.push({key:"full",value:a.child("original_image_url").contentString()}),o.push(a.child("id").contentString());else{var b=[];b.push({key:"requested",value:a.child("request_image_url").contentString()});b.push({key:"full",value:a.child("original_image_url").contentString()});n.push(b);o.push(a.child("id").contentString())}});var r=[];p.forEachChildWithTag("video",function(a){var b=a.maybeChild("id"),c=a.child("original_video_url").contentString();a=a.maybeChild("thumbnail_url");b=(b==null?void 0:b.contentString())||"";a=(a==null?void 0:a.contentString())||"";r.push({id:b,original_video_url:c,thumbnail_url:a})});p=a.maybeChild("status_info");var s=(p==null?void 0:p.child("status").contentString())||"APPROVED";p=p==null?void 0:(p=p.maybeChild("can_appeal"))==null?void 0:p.contentString();s=[{key:"WHATSAPP",value:s}];var t=a.maybeChild("currency");t=t?t.contentString():void 0;var u=a.maybeChild("price");u=u==null?void 0:u.contentString();var v=a.maybeChild("retailer_id");v=v?v.contentString():"";var w=a.hasAttr("is_hidden")?a.attrString("is_hidden")==="true":!1,x=a.hasAttr("compliance_category")?d("WAWebProductTypes.flow").ProductComplianceCategory.cast(a.attrString("compliance_category")):d("WAWebProductTypes.flow").ProductComplianceCategory.Default,y=a.maybeChild("sale_price");c=y?babelHelpers["extends"]({sale_price:(c=y.maybeChild("price"))==null?void 0:c.contentString()},y.hasChild("start_date")&&y.hasChild("end_date")?{sale_start_date:y.child("start_date").contentString(),sale_end_date:y.child("end_date").contentString()}:null):null;y=babelHelpers["extends"]({id:e,is_hidden:w,url:g,name:f,description:j,availability:b,max_available:h,additional_image_cdn_urls:n,image_cdn_urls:m,capability_to_review_status:s,whatsapp_product_can_appeal:p==="true",image_hashes_for_whatsapp:o,currency:t,price:u,retailer_id:v,checkmark:l,videos:r},c);e=a.maybeChild("compliance_info");x===d("WAWebProductTypes.flow").ProductComplianceCategory.CountryOriginExempt?y.compliance_info=k():e&&(y.compliance_info=i(e));w=a.maybeChild("shimmed_url");if(w!=null){g=w.contentString();g!==""&&(y.signedShimmedUrl=d("WAWebSignedShimmedUrl").asSignedShimmedUrl(g))}return y};function a(a){var b,c,e,f=a.id?d("WAWap").wap("id",null,a.id.toString()):void 0,g=a.description?d("WAWap").wap("description",null,a.description):void 0,i=a.url?d("WAWap").wap("url",null,a.url):void 0,j=a.retailerId?d("WAWap").wap("retailer_id",null,a.retailerId):void 0,k=a.priceAmount1000!=null?d("WAWap").wap("currency",null,a.currency):void 0,l=a.priceAmount1000!=null?d("WAWap").wap("price",null,a.priceAmount1000.toString()):void 0,m=a.salePriceAmount1000!=null?d("WAWap").wap("sale_price",null,a.salePriceAmount1000.toString()):void 0;b=[d("WAWap").wap("image",null,d("WAWap").wap("url",null,a.imageCdnUrl))].concat((b=a.additionalImageCdnUrl)==null?void 0:b.map(function(a){return d("WAWap").wap("image",null,d("WAWap").wap("url",null,a))}));c=(c=a.videos)==null?void 0:c.map(function(a){return d("WAWap").wap("video",null,d("WAWap").wap("url",null,a.original_video_url))});var n=h(a.complianceInfo);e=babelHelpers["extends"]({is_hidden:a.isHidden?"true":"false"},((e=a.complianceInfo)==null?void 0:e.countryCodeOrigin)===String(d("WAWebSyntheticCountryCode").SyntheticCountryCode.NotApplicable)?{compliance_category:d("WAWebProductTypes.flow").ProductComplianceCategory.CountryOriginExempt}:void 0);return d("WAWap").wap("product",e,f,d("WAWap").wap("name",null,a.name),g,i,j,d("WAWap").wap("media",null,b.concat(c)),l,m,k,n)}function h(a){var b=j(a),c=b.isExempt,e=b.hasCountryCodeOrigin,f=b.hasImporterName;b=b.hasImporterAddress;return!c&&(e||f||b)?d("WAWap").wap("compliance_info",null,e?d("WAWap").wap("country_code_origin",null,a==null?void 0:a.countryCodeOrigin):void 0,f?d("WAWap").wap("importer_name",null,a==null?void 0:a.importerName):void 0,b?d("WAWap").wap("importer_address",null,(a==null?void 0:(c=a.importerAddress)==null?void 0:c.street1)?d("WAWap").wap("street1",null,a.importerAddress.street1):void 0,(a==null?void 0:(e=a.importerAddress)==null?void 0:e.street2)?d("WAWap").wap("street2",null,a.importerAddress.street2):void 0,(a==null?void 0:(f=a.importerAddress)==null?void 0:f.city)?d("WAWap").wap("city",null,a.importerAddress.city):void 0,(a==null?void 0:(b=a.importerAddress)==null?void 0:b.region)?d("WAWap").wap("region",null,a.importerAddress.region):void 0,(a==null?void 0:(c=a.importerAddress)==null?void 0:c.postalCode)?d("WAWap").wap("postal_code",null,a.importerAddress.postalCode):void 0,(a==null?void 0:(e=a.importerAddress)==null?void 0:e.countryCode)?d("WAWap").wap("country_code",null,a.importerAddress.countryCode):void 0):void 0):void 0}function i(a){var b,c=a.child("country_code_origin").contentString();b=(b=a.maybeChild("importer_name"))==null?void 0:b.contentString();a=a.maybeChild("importer_address");c={country_code_origin:c,importer_name:b};if(a){c.importer_address={street1:a.child("street1").contentString(),street2:(b=a.maybeChild("street2"))==null?void 0:b.contentString(),postal_code:(b=a.maybeChild("postal_code"))==null?void 0:b.contentString(),city:a.child("city").contentString(),region:(b=a.maybeChild("region"))==null?void 0:b.contentString(),country_code:a.child("country_code").contentString()}}return c}function j(a){var b=(a==null?void 0:a.countryCodeOrigin)===String(d("WAWebSyntheticCountryCode").SyntheticCountryCode.NotApplicable),c=!b&&(a==null?void 0:a.countryCodeOrigin)!==void 0,e=!b&&(a==null?void 0:a.importerName)!==void 0;a=!b&&(a==null?void 0:a.importerAddress)!==void 0&&[a.importerAddress.street1,a.importerAddress.street2,a.importerAddress.city,a.importerAddress.region,a.importerAddress.postalCode,a.importerAddress.countryCode].some(function(a){return a});return{isExempt:b,hasImporterAddress:a,hasImporterName:e,hasCountryCodeOrigin:c}}function k(){return{country_code_origin:String(d("WAWebSyntheticCountryCode").SyntheticCountryCode.NotApplicable)}}g.parseProductNode=b;g.productModelToNode=a;g.scanComplianceInfoForMissingData=j}),98);
__d("WAWebWamEnumBusinessType",[],(function(a,b,c,d,e,f){a=Object.freeze({SMB:1,API_DC:2,API:3});f.BUSINESS_TYPE=a}),66);
__d("WAWebWamEnumGraphqlCatalogEndpoint",[],(function(a,b,c,d,e,f){a=Object.freeze({GET_CATALOG:1,GET_PRODUCT:2,GET_PRODUCT_LIST:3,GET_COLLECTIONS:4,GET_SINGLE_COLLECTION:5,GET_CATEGORIES:6,GET_VARIANTS:7,GET_PROMOTIONS:8,CREATE_COLLECTION:9,GET_PUBLIC_KEY:10,VERIFY_POSTCODE:11});f.GRAPHQL_CATALOG_ENDPOINT=a}),66);
__d("WAWebWamEnumGraphqlRequestResult",[],(function(a,b,c,d,e,f){a=Object.freeze({SUCCESS:1,FAILURE:2});f.GRAPHQL_REQUEST_RESULT=a}),66);
__d("WAWebGraphqlCatalogRequestWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumBusinessType","WAWebWamEnumGraphqlCatalogEndpoint","WAWebWamEnumGraphqlRequestResult"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({GraphqlCatalogRequest:[3206,{businessJid:[4,d("WAWebWamCodegenUtils").TYPES.STRING],businessType:[5,d("WAWebWamEnumBusinessType").BUSINESS_TYPE],graphqlCatalogEndpoint:[1,d("WAWebWamEnumGraphqlCatalogEndpoint").GRAPHQL_CATALOG_ENDPOINT],graphqlErrorCode:[3,d("WAWebWamCodegenUtils").TYPES.INTEGER],graphqlRequestResult:[2,d("WAWebWamEnumGraphqlRequestResult").GRAPHQL_REQUEST_RESULT]},[1,1,1],"private",0]},{GraphqlCatalogRequest:[]});g.GraphqlCatalogRequestWamEvent=a}),98);
__d("WAWebCatalogEventLogger",["WAWebGraphqlCatalogRequestWamEvent","WAWebWamEnumGraphqlCatalogEndpoint","WAWebWamEnumGraphqlRequestResult"],(function(a,b,c,d,e,f,g){a=function(a){var b=new(d("WAWebGraphqlCatalogRequestWamEvent").GraphqlCatalogRequestWamEvent)({graphqlCatalogEndpoint:a});return{success:function(){b.set({graphqlErrorCode:-1,graphqlRequestResult:d("WAWebWamEnumGraphqlRequestResult").GRAPHQL_REQUEST_RESULT.SUCCESS}),b.commit()},failure:function(a){a=a[0];b.set({graphqlErrorCode:a.code,graphqlRequestResult:d("WAWebWamEnumGraphqlRequestResult").GRAPHQL_REQUEST_RESULT.FAILURE});b.commit()}}};g.GRAPHQL_CATALOG_ENDPOINT=d("WAWebWamEnumGraphqlCatalogEndpoint").GRAPHQL_CATALOG_ENDPOINT;g.createCatalogEventLogger=a}),98);
__d("WAWebProductMessageListConstant",[],(function(a,b,c,d,e,f){a="DELETED";f.INVALID_PRODUCT_TOKEN=a}),66);
__d("WAWebQueryProductListCatalogJobQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"request"}],b={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null};c=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"request"}],concreteType:"XWAProductCatalogGetProductListResponseSuccess",kind:"LinkedField",name:"xwa_product_catalog_get_product_list",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogGetProductListResponseSuccessProductList",kind:"LinkedField",name:"product_list",plural:!1,selections:[{alias:null,args:null,concreteType:"XWACatalogProduct",kind:"LinkedField",name:"products",plural:!0,selections:[b,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},c,{alias:null,args:null,concreteType:"XWAProductCatalogProductStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[c,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[b,{alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebQueryProductListCatalogJobQuery",selections:c,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebQueryProductListCatalogJobQuery",selections:c},params:{id:"WAWebQueryProductListCatalogJobQuery",metadata:{},name:"WAWebQueryProductListCatalogJobQuery",operationKind:"query",text:null}}}();a.hash="5d3b936da25c831ffeb17f59668da9c4";e.exports=a}),null);
__d("WAWebQueryProductListCatalogJob",["WADeprecatedSendIq","WADeprecatedWapParser","WALogger","WANullthrows","WAWap","WAWapDeprecatedSmaxID","WAWebBackendErrors","WAWebBizCatalogManagementFetchProductList","WAWebBizCatalogParseProduct","WAWebBizGatingUtils","WAWebBizParseProductGraphql","WAWebCatalogEventLogger","WAWebCommsWapMd","WAWebDefinePersistedJob","WAWebGraphQLServerError","WAWebMaybeThrowCatalogErrors","WAWebProductMessageListConstant","WAWebQueryProductListCatalogJobQuery.graphql","WAWebRelayClient","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime","err","filterNulls"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["GraphQL: Failed fetching xwa_product_catalog_get_product_list query. Falling back to IQ."]);i=function(){return a};return a}var j=new(c("WADeprecatedWapParser"))("productListResponse",function(a){a.assertTag("iq");a.assertFromServer();a=a.child("product_list");var b=[];a.forEachChildWithTag("product",function(a){var c=a.maybeChild("id");if(!c)return;var e=a.maybeChild("status");(e==null?void 0:e.contentString())===d("WAWebProductMessageListConstant").INVALID_PRODUCT_TOKEN?b.push({id:c.contentString(),status:d("WAWebProductMessageListConstant").INVALID_PRODUCT_TOKEN}):b.push(d("WAWebBizCatalogParseProduct").parseProductNode(a))});return b}),k=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,e=a.catalogWid,f=a.productIds,g=a.width,h=a.height;a=a.directConnectionEncryptedInfo;e=(b=d("WAWap")).wap("iq",{to:b.S_WHATSAPP_NET,type:"get",smax_id:b.SMAX_ID(c("WAWapDeprecatedSmaxID").CatalogGetProductList),xmlns:"w:biz:catalog",id:b.generateId()},b.wap("product_list",{jid:d("WAWebCommsWapMd").USER_JID(d("WAWebWidFactory").createWid(e))},f.map(function(a){return d("WAWap").wap("product",null,d("WAWap").wap("id",null,a))}).concat(c("filterNulls")([b.wap("width",null,g.toString()),b.wap("height",null,h.toString()),a!=null?d("WAWap").wap("direct_connection_encrypted_info",null,a):null]))));f=(yield d("WADeprecatedSendIq").deprecatedSendIq(e,j));if(!f.success)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(f.errorCode);else return f.result});return function(b){return a.apply(this,arguments)}}(),l=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{var e=a.catalogWid,f=a.productIds,g=a.width,j=a.height,l=a.directConnectionEncryptedInfo;e=(yield d("WAWebRelayClient").fetchQuery(h!==void 0?h:h=b("WAWebQueryProductListCatalogJobQuery.graphql"),{request:{product_list:{jid:e.toString(),products:f.map(function(a){return{id:a}}),width:String(g),height:String(j),direct_connection_encrypted_info:l}}},{eventLogger:d("WAWebCatalogEventLogger").createCatalogEventLogger(d("WAWebCatalogEventLogger").GRAPHQL_CATALOG_ENDPOINT.GET_PRODUCT_LIST)}));return c("WANullthrows")(e==null?void 0:(f=e.xwa_product_catalog_get_product_list)==null?void 0:(g=f.product_list)==null?void 0:g.products.map(d("WAWebBizParseProductGraphql").parseProductGraphQL))}catch(b){b instanceof d("WAWebGraphQLServerError").GraphQLServerError&&c("WAWebMaybeThrowCatalogErrors")(b);d("WALogger").WARN(i());return k(a)}});return function(b){return a.apply(this,arguments)}}(),m=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.catalogWid,e=a.productIds,f=a.width,g=a.height;a=a.directConnectionEncryptedInfo;b=(yield d("WAWebBizCatalogManagementFetchProductList").fetchProductList({product_list:{jid:b.toString(),products:e.map(function(a){return{id:a}}),width:String(f),height:String(g),direct_connection_encrypted_info:a}}));if(b.type==="success")return b.productsResult;else b.type==="graphql-error"?c("WAWebMaybeThrowCatalogErrors")(b.error):b.type;throw c("err")("queryProductListGraphQLByOwner: error handling flow not implemented for "+JSON.stringify(b))});return function(b){return a.apply(this,arguments)}}();a=function(a){var b=d("WAWebUserPrefsMeUser").getMaybeMeUser();return b!=null&&b.equals(d("WAWebWidFactory").createWid(a.catalogWid))?d("WAWebBizGatingUtils").graphQLForGetProductListEnabled()?m(a):k(a):d("WAWebBizGatingUtils").graphQLForCatalogM1Enabled()?l(a):k(a)};e=d("WAWebDefinePersistedJob").defineWebPersistedJob().finalStep("sendStanza",a).end();g.QueryProductListCatalog=e}),98);
__d("WAWebVerifyPostcodeJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWapDeprecatedSmaxID","WAWebBackendErrors","WAWebBizGatingUtils","WAWebCommsWapMd","WAWebDefinePersistedJob","WAWebGraphQLVerifyPostcodeJob","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("productResponse",function(a){a.assertTag("iq");a.assertFromServer();var b=a.child("result_code");a=a.maybeChild("encrypted_location_name");a=a==null?void 0:a.contentString();b=b.contentString();if(b!=="invalid_postcode"&&b!=="unserviceable_location"&&b!=="success")throw new(d("WAWebBackendErrors").ServerStatusCodeError)(500);return{resultCode:b,encryptedLocationName:a}});a=d("WAWebDefinePersistedJob").defineWebPersistedJob().finalStep("sendStanza",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.businessJid;a=a.directConnectionEncryptedInfo;b=d("WAWebWidFactory").createWid(b);if(d("WAWebBizGatingUtils").isGraphQLForVerifyPostcodeEnabled())return d("WAWebGraphQLVerifyPostcodeJob").verifyPostcode(b,a);b=d("WAWap").wap("iq",{id:d("WAWap").generateId(),xmlns:"w:biz:catalog",type:"get",to:d("WAWap").S_WHATSAPP_NET,smax_id:d("WAWap").SMAX_ID(c("WAWapDeprecatedSmaxID").CatalogVerifyPostcode)},d("WAWap").wap("verify_postcode",{biz_jid:d("WAWebCommsWapMd").USER_JID(b)},d("WAWap").wap("direct_connection_encrypted_info",null,a)));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(b,h));if(!a.success)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode);else return a.result});return function(b){return a.apply(this,arguments)}}()).end();g.VerifyPostcode=a}),98);
__d("WAWebMerchantComplianceJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWapDeprecatedSmaxID","WAWebBackendErrors","WAWebCommsWapMd","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=function(a){var b;return{email:(a==null?void 0:(b=a.maybeChild("email"))==null?void 0:b.contentString())||"",landline_number:(a==null?void 0:(b=a.maybeChild("landline_number"))==null?void 0:b.contentString())||"",mobile_number:(a==null?void 0:(b=a.maybeChild("mobile_number"))==null?void 0:b.contentString())||""}},i=new(c("WADeprecatedWapParser"))("merchantComplianceResponse",function(a){a.assertTag("iq");a.assertFromServer();var b=[];a.forEachChildWithTag("merchant_info",function(a){var c,d,e,f;c=((c=a.maybeChild("entity_name"))==null?void 0:c.contentString())||"";d=((d=a.maybeChild("entity_type"))==null?void 0:d.contentString())||"";e=(e=a.maybeChild("entity_type_custom"))==null?void 0:e.contentString();var g=a.attrString("is_registered")==="true",i=a.maybeChild("customer_care_details");a=a.maybeChild("grievance_officer_details");i=babelHelpers["extends"]({},h(i));f=babelHelpers["extends"]({name:(a==null?void 0:(f=a.maybeChild("name"))==null?void 0:f.contentString())||""},h(a));b.push({entity_name:c,entity_type:d,is_registered:g,entity_type_custom:e,customer_care_details:i,grievance_officer_details:f})});return b});function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(b=d("WAWap")).wap("iq",{to:b.S_WHATSAPP_NET,xmlns:"w:biz:merchant_info",id:b.generateId(),type:"get",smax_id:b.SMAX_ID(c("WAWapDeprecatedSmaxID").MerchantGetComplianceInfo)},a.map(function(a){return d("WAWap").wap("merchant_info",{jid:d("WAWebCommsWapMd").USER_JID(a.wid)})}));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(b,i));if(!a.success)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode);else return a.result});return j.apply(this,arguments)}function e(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a===void 0?{}:a;var b=a.entityName,e=a.entityType,f=a.isRegistered;f=f===void 0?!1:f;var g=a.entityTypeCustom,h=a.customerCareDetails;a=a.grievanceOfficerDetails;f=d("WAWap").wap("iq",{to:d("WAWap").S_WHATSAPP_NET,xmlns:"w:biz:merchant_info",id:d("WAWap").generateId(),type:"set",smax_id:d("WAWap").SMAX_ID(c("WAWapDeprecatedSmaxID").MerchantSetComplianceInfo)},d("WAWap").wap("merchant_info",{is_registered:f?"true":"false"},b!==void 0?d("WAWap").wap("entity_name",null,b):null,e!==void 0?d("WAWap").wap("entity_type",null,e):null,g!==void 0?d("WAWap").wap("entity_type_custom",null,g):null,h?d("WAWap").wap("customer_care_details",null,h.email!==void 0?d("WAWap").wap("email",null,h.email):null,h.landlineNumber!==void 0?d("WAWap").wap("landline_number",null,h.landlineNumber):null,h.mobileNumber!==void 0?d("WAWap").wap("mobile_number",null,h.mobileNumber):null):null,a?d("WAWap").wap("grievance_officer_details",null,a.name!==void 0?d("WAWap").wap("name",null,a.name):null,a.email!==void 0?d("WAWap").wap("email",null,a.email):null,a.landlineNumber!==void 0?d("WAWap").wap("landline_number",null,a.landlineNumber):null,a.mobileNumber!==void 0?d("WAWap").wap("mobile_number",null,a.mobileNumber):null):null));b=(yield d("WADeprecatedSendIq").deprecatedSendIq(f,i));if(!b.success)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(b.errorCode);else return b.result});return k.apply(this,arguments)}g.getMerchantCompliance=a;g.setMerchantCompliance=e}),98);
__d("WAWebQueryBusinessProfile",["Promise","WAWebBackendErrors","WAWebBusinessProfileVersioningBridge","WAWebMerchantComplianceJob","WAWebQueryBusinessProfileJob"],(function(a,b,c,d,e,f,g){var h;function a(a,e){var f=d("WAWebBusinessProfileVersioningBridge").getBusinessProfileQueryVersion();e?e=(h||(h=b("Promise"))).all([c("WAWebQueryBusinessProfileJob")(a,f),d("WAWebMerchantComplianceJob").getMerchantCompliance(a)]).then(i):e=c("WAWebQueryBusinessProfileJob")(a,f);return d("WAWebBackendErrors").attachErrorLogger(e,"Query business profile failed")}function i(a){var b=a[0],c=a[1];return b.map(function(a,b){return babelHelpers["extends"]({},a,{profile:babelHelpers["extends"]({},a.profile,{legal_entity_details:c[b]})})})}g.queryBusinessProfile=a}),98);
__d("WAWebJidToWid",["WAJids","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebWidFactory").createUserWid(a)}function b(a){return d("WAWebWidFactory").toUserWid(d("WAWebWidFactory").createWid(a))}function c(a){return d("WAWebWidFactory").createDeviceWid(a)}function e(a){return d("WAWebWidFactory").toChatWid(d("WAWebWidFactory").createWid(a))}function f(a){return d("WAWebWidFactory").createWid(a)}function h(a){a=d("WAJids").extractJidFromJidWithType(a);return d("WAWebWidFactory").createWid(a)}function i(a){return d("WAWebWidFactory").createWid(a)}g.userJidToUserWid=a;g.deviceJidToUserWid=b;g.deviceJidToDeviceWid=c;g.chatJidToChatWid=e;g.groupJidToWid=f;g.jidWithTypeToWid=h;g.newsletterJidToWid=i}),98);
__d("WAWebQueryBusinessProfileJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","WAWebCommonParsersParseBusinessProfile","WAWebCommsWapMd","WAWebJidToWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("businessProfileResponse",function(a){a.assertTag("iq");a.assertFromServer();a=a.child("business_profile");var b=[];a.forEachChildWithTag("profile",function(a){var e=d("WAWebJidToWid").jidWithTypeToWid(a.attrJidWithType("jid")),f=a.attrString("tag");a=c("WAWebCommonParsersParseBusinessProfile")(a);Object.keys(a).length?b.push({wid:e,tag:f,profile:a}):b.push({wid:e,tag:f})});return b});function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c;c=(c=d("WAWap")).wap("iq",{to:c.S_WHATSAPP_NET,xmlns:"w:biz",id:c.generateId(),type:"get"},c.wap("business_profile",{v:c.INT(b)},a.map(function(a){return d("WAWap").wap("profile",{jid:d("WAWebCommsWapMd").USER_JID(a.wid),tag:a.tag!=null?d("WAWap").INT(a.tag):d("WAWap").DROP_ATTR})})));b=(yield d("WADeprecatedSendIq").deprecatedSendIq(c,h));if(!b.success)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(b.errorCode);else return b.result});return i.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebGroupConstants",[],(function(a,b,c,d,e,f){a={ANNOUNCEMENT:"announcement",RESTRICT:"restrict",NO_FREQUENTLY_FORWARDED:"no_frequently_forwarded",EPHEMERAL:"ephemeral",MEMBERSHIP_APPROVAL_MODE:"membership_approval_mode",REPORT_TO_ADMIN_MODE:"report_to_admin_mode",ALLOW_NON_ADMIN_SUB_GROUP_CREATION:"allow_non_admin_sub_group_creation",MEMBER_ADD_MODE:"member_add_mode"};b=60;f.GROUP_SETTING_TYPE=a;f.PAST_PARTICIPANT_EXPIRATION_DAYS=b}),66);
__d("WAWebApiParticipantStore",["WALogger","WATimeUtils","WAWebBackendApi","WAWebGroupConstants","WAWebModelStorageUtils","WAWebSchemaParticipant","WAWebUserPrefsMeUser","WAWebWamGroupMetricCache","WAWebWidFactory","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["getGroupSenderKeyList: missed "," sender key(s) for primary devices"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["getGroupSenderKeyList: include "," because its primary doesn't have sender key"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["pruneExpiredPastParticipants: Pruning expired past participants from participant DB"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["markForgetSenderKey: group participant info missing for group ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["markHasSenderKey: group participant info missing for group ",""]);l=function(){return a};return a}var m=function(b){babelHelpers.inheritsLoose(a,b);function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(a=c=b.call.apply(b,[this].concat(e))||this,c.name="GroupUnSyncedError",a)||babelHelpers.assertThisInitialized(c)}return a}(babelHelpers.wrapNativeSuper(Error));function a(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.toString();b=(yield d("WAWebSchemaParticipant").getParticipantTable().get(b));return o(a,b)});return n.apply(this,arguments)}function o(a,b){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=[],f=[];if(!b)return{skDistribList:e,skList:f,rotateKey:!1};var g=b.senderKey,j=b.rotateKey,k=0;g.forEach(function(a,b){if(b.includes("hosted"))return;var c=d("WAWebWidFactory").createWid(b),h=d("WAWebWidFactory").toUserWid(c);h=(h=g.get(h.toString()))!=null?h:!1;a&&h?f.push(c):(e.push(c),c.isCompanion()&&a&&!h&&(d("WALogger").WARN(i(),b),k++))});c("gkx")("26258")||k>0&&d("WALogger").WARN(h(),k).sendLogs("missing-sender-key-on-primary");yield r(a,g.size);d("WAWebWamGroupMetricCache").cacheGroupMetrics(b);return j?{skDistribList:[].concat(e,f),skList:[],rotateKey:j}:{skDistribList:e,skList:f,rotateKey:j}});return p.apply(this,arguments)}function e(a,c){var e=a.toString();return d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.get(e));if(!b){d("WALogger").LOG(l(),e);return}yield a.createOrReplace(q(b,c,!0))});return function(b){return a.apply(this,arguments)}}())}function f(a,c){var e=a.toString();return d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.get(e));if(!b){d("WALogger").LOG(k(),e);return}yield a.createOrReplace(q(b,c,!1))});return function(b){return a.apply(this,arguments)}}())}function q(a,b,c){var e=new Map(a.senderKey),f=!1;b.forEach(function(a){if(d("WAWebUserPrefsMeUser").isMeDevice(a))return;var b=String(a);e.has(b)?e.set(b,c):a.isLid()||(f=!0)});return{groupId:a.groupId,senderKey:e,participants:a.participants,pastParticipants:a.pastParticipants,admins:a.admins,superAdmins:a.superAdmins,rotateKey:f,deviceSyncComplete:a.deviceSyncComplete}}function r(a,b){return d("WAWebBackendApi").frontendSendAndReceive("updateCachedDeviceCount",{groupWid:a,deviceCount:b})}function s(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.map(function(a){return a.id.toString()}),c=(yield d("WAWebSchemaParticipant").getParticipantTable().bulkGet(b));b=a.map(function(a,b){return babelHelpers["extends"]({},a,{pastParticipants:(a=c[b])==null?void 0:(b=a.pastParticipants)==null?void 0:b.map(function(a){var b=a.jid,c=a.leaveTs;a=a.leaveReason;return{id:d("WAWebWidFactory").createWid(b),leaveTs:c,leaveReason:a}})})});return b});return t.apply(this,arguments)}function u(){return d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield d("WAWebSchemaParticipant").getParticipantTable().all()),c=[],e=d("WATimeUtils").DAY_SECONDS*d("WAWebGroupConstants").PAST_PARTICIPANT_EXPIRATION_DAYS;b.forEach(function(a){var b=a.pastParticipants.filter(function(a){a=d("WATimeUtils").castToUnixTime(a.leaveTs);a=d("WATimeUtils").happenedWithin(a,e);return a});if(b.length!==a.pastParticipants.length){a=babelHelpers["extends"]({},a,{pastParticipants:b});c.push(a)}});c.length>0&&d("WALogger").DEV(j());return a.bulkCreateOrReplace(c)});return function(b){return a.apply(this,arguments)}}())}var v=new Map();function w(a,b){v.set(a,b)}function x(a){a!=null?v["delete"](a):v.clear()}function y(a){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=v.get(a);if(b==null){var c=(yield d("WAWebSchemaParticipant").getParticipantTable().get(a));c=!!c&&c.admins.includes((c=d("WAWebUserPrefsMeUser").getMaybeMeUser())==null?void 0:c.toString());v.set(a,c);return c}return b});return z.apply(this,arguments)}g.GroupUnSyncedError=m;g.getGroupSenderKeyList=a;g.getGroupSenderKeyListFromParticipantRecord=o;g.markHasSenderKey=e;g.markForgetSenderKey=f;g.injectPastParticipantsFromDB=s;g.pruneExpiredPastParticipants=u;g.setAdminshipCache=w;g.clearAdminshipCache=x;g.isCurrentUserGroupAdmin=y}),98);
__d("WAWebChatConstants",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY:0,COMPLETE_AND_NO_MORE_MESSAGE_REMAIN_ON_PRIMARY:1,INCOMPLETE:2,NOT_INCLUDED_IN_HIST_SYNC:3,COMPLETE_ON_DEMAND_SYNC_BUT_MORE_MSG_REMAIN_ON_PRIMARY:4});c=60*5*1e3;f.ConversationEndOfHistoryTransferModelPropType=a;f.FTS_TTL=c}),66);
__d("WAWebGroupDatabaseJob",["WAJobOrchestratorTypes","WAWebDBGroupParticipant","WAWebDBGroupsGroupMetadata","WAWebOrchestratorNonPersistedJob"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("updateGroupMetadataTable",function(a){return d("WAWebDBGroupsGroupMetadata").updateGroupMetadataTable(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted({groupInfos:a})}function b(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("updateGroupParticipantTableWithoutDeviceSync",function(a){return d("WAWebDBGroupParticipant").updateGroupParticipantTableWithoutDeviceSync(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted({groupInfos:a})}function c(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("markGroupParticipantStale",function(a){return d("WAWebDBGroupParticipant").markGroupParticipantStale(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted({group:a})}function e(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("bulkMarkGroupParticipantStale",function(a){return d("WAWebDBGroupParticipant").bulkMarkGroupParticipantStale(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted({groupIds:a})}function f(a,b,c){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("modifyGroupParticipant",function(a){return d("WAWebDBGroupParticipant").modifyGroupParticipant(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted({group:a,oldId:b,newId:c})}function h(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getGroupMetadata",function(a){return d("WAWebDBGroupsGroupMetadata").getGroupMetadataUNSAFE(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted({groupWid:a})}function i(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getGroupParticipant",function(a){return d("WAWebDBGroupParticipant").getGroupParticipant(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted({groupWid:a})}g.updateGroupMetadataTableJob=a;g.updateGroupParticipantTableWithoutDeviceSyncJob=b;g.markGroupParticipantStaleJob=c;g.bulkMarkGroupParticipantStaleJob=e;g.modifyGroupParticipantJob=f;g.getGroupMetadataJob=h;g.getGroupParticipantJob=i}),98);
__d("WAWebPhashUtils",["WABase64","WACryptoSha256","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(function(a){return d("WAWebWidFactory").toUserWid(a).toString({legacy:!0})}).sort().join("");var b=[];for(var c=0;c<a.length;c++)b.push(a.charCodeAt(c));c=new Uint8Array(b);a=(yield self.crypto.subtle.digest({name:"SHA-1"},c));return"1:"+d("WABase64").encodeB64(a.slice(0,6))});return h.apply(this,arguments)}function c(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(function(a){return a.toString({legacy:!0,formatFull:!0})}).sort().join("");var b=[];for(var c=0;c<a.length;c++)b.push(a.charCodeAt(c));c=new Uint8Array(b);a=(yield d("WACryptoSha256").sha256(c));return"2:"+d("WABase64").encodeB64(a.slice(0,6))});return i.apply(this,arguments)}g.phashV1=a;g.phashV2=c}),98);
__d("WAWebUserPrefsModelStorage",["WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(a,b,c,d,e,f,g){function a(a){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.INITIAL_GROUP_PHASH,JSON.stringify(a))}function b(a){var b=c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.INITIAL_GROUP_PHASH);try{return JSON.parse(b)[a]}catch(a){return null}}function e(){var a=c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.INITIAL_GROUP_PHASH);try{return JSON.parse(a)}catch(a){return null}}g.setInitialGroupPhash=a;g.getInitialGroupPhash=b;g.getInitialGroupPhashMap=e}),98);
__d("WAWebQueryAndUpdateGroupMetadataJob",["Promise","WALogger","WATimeUtils","WAWebApiChat","WAWebApiParticipantStore","WAWebBackendApi","WAWebChatConstants","WAWebCreateOrReplaceDisplayNamesAndLidPnMappingsJob","WAWebGroupDatabaseJob","WAWebGroupQueryJob","WAWebGroupSystemMsg","WAWebHandleSingleMsg","WAWebPhashUtils","WAWebQueryAndUpdateSubgroupSuggestionsJob","WAWebSchemaChat","WAWebUserPrefsModelStorage","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Completed updateGroupEndOfHistorySyncFlag"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["One ore more chat create failed for group not synced in initial sync with error: "," "]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Start updateGroupEndOfHistorySyncFlag"]);k=function(){return a};return a}function a(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){a===void 0&&(a=!1);if(c!=null){c=(yield d("WAWebGroupQueryJob").queryGroupsById(c,"per_group_dirty_recovery"));if(c==null||c.length===0)return}else{c=(yield d("WAWebGroupQueryJob").queryAllGroups());if(c.length===0)return}c=(yield d("WAWebApiParticipantStore").injectPastParticipantsFromDB(c));c=(yield d("WAWebApiChat").injectAdditionalEphemeralInfoFromDB(c));var e=[],f=[];c.forEach(function(b){d("WAWebBackendApi").frontendFireAndForget("createOrUpdateGroupMetadataFromQuery",{groupInfo:b}),a&&void o(b),e.push(d("WAWebGroupQueryJob").maybeQueryAndUpdateMembershipApprovalRequests(b))});var g=[];c.forEach(function(a){a.participants.forEach(function(a){var b=a.id,c=a.lid,e=a.phoneNumber;a=a.displayName;g.push({id:d("WAWebWidFactory").toUserWid(b),lid:c?d("WAWebWidFactory").toUserWid(c):null,phoneNumber:e?d("WAWebWidFactory").toUserWid(e):null,displayName:a})})});yield d("WAWebCreateOrReplaceDisplayNamesAndLidPnMappingsJob").createOrReplaceDisplayNamesAndLidPnMappings(g,!0);yield d("WAWebGroupDatabaseJob").updateGroupMetadataTableJob(c);yield d("WAWebGroupDatabaseJob").updateGroupParticipantTableWithoutDeviceSyncJob(c);a&&(yield m(c));c.forEach(function(a){f.push(d("WAWebQueryAndUpdateSubgroupSuggestionsJob").maybeQueryAndUpdateSubgroupSuggestions(a))});yield (h||(h=b("Promise"))).all(e)});return l.apply(this,arguments)}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(k()).tags("history-sync","groups");var b=d("WAWebUserPrefsModelStorage").getInitialGroupPhashMap(),c=[];for(a of a){var e=(yield d("WAWebApiChat").getChatRecord(a.id));if(e)continue;e=b==null?void 0:b[a.id.toString()];if(e!=null)continue;c.push({unreadCount:0,muteExpiration:0,isAutoMuted:!1,id:a.id,endOfHistoryTransferType:d("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.NOT_INCLUDED_IN_HIST_SYNC})}yield d("WAWebBackendApi").frontendSendAndReceive("chatCollectionAdd",{things:c,options:{merge:!0}});yield d("WAWebSchemaChat").getChatTable().bulkCreate(c.map(function(a){var b=a.endOfHistoryTransferType;a=a.id;b={endOfHistoryTransferType:b,id:a.toString(),unreadCount:0,muteExpiration:0,isAutoMuted:!1};return b}))["catch"](function(a){d("WALogger").LOG(j(),a.message).tags("history-sync","groups")});d("WALogger").LOG(i()).tags("history-sync","groups")});return n.apply(this,arguments)}function o(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebUserPrefsModelStorage").getInitialGroupPhash(a.id.toString());if(b==null)return;var c=(yield d("WAWebPhashUtils").phashV1(a.participants.map(function(a){return a.id}))),e=c.substring(2);b!=null&&b!==c&&b!==e&&a.defaultSubgroup!==!0&&d("WAWebHandleSingleMsg").handleSingleMsg(a.id,d("WAWebGroupSystemMsg").genInitialPhashMismatchMsg(a.id,d("WATimeUtils").unixTime()),"pHashMismatchMsg")});return p.apply(this,arguments)}g.queryAndUpdateAllGroupMetadata=a}),98);
__d("WAWebQueryAndUpdateGroupsMetadataByJidsJob",["WALogger","WAWebDefinePersistedJob","WAWebQueryAndUpdateGroupMetadataJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["queryAndUpdateGroupsMetadataByJidsJob: started persisted job"]);h=function(){return a};return a}a=d("WAWebDefinePersistedJob").defineWebPersistedJob().finalStep("queryAndUpdateGroupsMetadataByJids",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(h()),yield d("WAWebQueryAndUpdateGroupMetadataJob").queryAndUpdateAllGroupMetadata(!1,a)});return function(b){return a.apply(this,arguments)}}()).end();g.queryAndUpdateGroupsMetadataByJidsJob=a}),98);
__d("WAWebApiSubgroupSuggestionStore",["Promise","WABatcher","WALogger","WAWebSchemaSubgroupSuggestionV2","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["removeSubgroupSuggestionsBatched: aggregating "," changes"]);i=function(){return a};return a}c=3e3;e=function(a){return d("WAWebSchemaSubgroupSuggestionV2").getSubgroupSuggestionTable().equals(["parentGroupId"],a.toString()).then(function(a){return a.map(function(a){var b=a.id,c=a.parentGroupId,e=a.subject,f=a.desc,g=a.owner,h=a.t,i=a.isExistingGroup,j=a.participantCount;a=a.hiddenSubgroup;return{id:d("WAWebWidFactory").createWid(b),parentGroupId:d("WAWebWidFactory").createWid(c),subject:e,desc:f,owner:d("WAWebWidFactory").createWid(g),t:h,isExistingGroup:i,participantCount:j,hiddenSubgroup:a}})})};var j=function(a,b){b=b.map(function(b){var c=b.id,d=b.subject,e=b.desc,f=b.owner,g=b.t,h=b.isExistingGroup,i=b.participantCount;b=b.hiddenSubgroup;return{id:c.toString(),parentGroupId:a.toString(),subject:d,desc:e,owner:f.toString(),t:g,isExistingGroup:h,participantCount:i,hiddenSubgroup:b}});return d("WAWebSchemaSubgroupSuggestionV2").getSubgroupSuggestionTable().bulkCreateOrReplace(b)};f=function(a,c,e,f){var g=function(){var g=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var g=(yield (h||(h=b("Promise"))).all(c.map(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=(yield d("WAWebSchemaSubgroupSuggestionV2").getSubgroupSuggestionTable().get([a.toString(),b.toString(),e.toString()]));return b});return function(a){return c.apply(this,arguments)}}())));g=g.filter(Boolean);var i=g.map(function(a){return babelHelpers["extends"]({},a,{owner:f,parentGroupId:d("WAWebWidFactory").createWid(a.parentGroupId),id:d("WAWebWidFactory").createWid(a.id)})});yield k(g.map(function(b){b=b.id;return{parentGroupId:a,id:d("WAWebWidFactory").createWid(b),owner:e}}));yield j(a,i)});return function(){return g.apply(this,arguments)}}();return g()};var k=function(a){return d("WAWebSchemaSubgroupSuggestionV2").getSubgroupSuggestionTable().bulkRemove(a.map(function(a){var b=a.parentGroupId,c=a.id;a=a.owner;return[b.toString(),c.toString(),a.toString()]}))},l=function(a){return d("WAWebSchemaSubgroupSuggestionV2").getSubgroupSuggestionTable().bulkRemoveByIndex(["parentGroupId"],[a.toString()])},m=d("WABatcher").batch({delayMs:c},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").DEV(i(),a.length).devConsole(a);a=a.reduce(function(a,b){a.push.apply(a,b.suggestionsRowKeys);return a},[]);yield k(a);return[]});return function(b){return a.apply(this,arguments)}}());function a(a){var b=a.subgroupSuggestions;a=a.isOffline;return a===!0?m({suggestionsRowKeys:b}):k(b)}g.getSubgroupSuggestions=e;g.addSubgroupSuggestions=j;g.updateOwnerInSubgroupSuggestions=f;g.removeSubgroupSuggestions=k;g.removeAllSubgroupSuggestions=l;g.removeSubgroupSuggestionsWithOfflineOption=a}),98);
__d("WAWebCommunityGatingUtils",["WAWebABProps","WAWebGroupType","WAWebMobilePlatforms"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebMobilePlatforms").isSMB()?d("WAWebABProps").getABPropConfigValue("parent_group_create_enabled_for_smb_on_web"):!0}function b(){return d("WAWebABProps").getABPropConfigValue("parent_group_link_limit")+1}function c(){return d("WAWebABProps").getABPropConfigValue("parent_group_link_limit_community_creation")+1}function e(){return d("WAWebABProps").getABPropConfigValue("community_admin_promotion_one_time_prompt")}function f(){return d("WAWebABProps").getABPropConfigValue("parent_group_create_privacy")}function h(){return d("WAWebABProps").getABPropConfigValue("parent_group_subgroup_filter")}function i(){return d("WAWebABProps").getABPropConfigValue("community_reporting_ui_upsell_exit")}function j(){return d("WAWebABProps").getABPropConfigValue("group_mentions_in_subgroups")}function k(){return d("WAWebABProps").getABPropConfigValue("parent_group_allow_member_added_groups_m1")}function l(){return d("WAWebABProps").getABPropConfigValue("parent_group_allow_member_added_groups_m2")}function m(a){return a==null?!1:(a.groupType===d("WAWebGroupType").GroupType.LINKED_SUBGROUP||a.groupType===d("WAWebGroupType").GroupType.LINKED_GENERAL_GROUP)&&a.getParentGroupChat()!=null}function n(){return d("WAWebABProps").getABPropConfigValue("community_shorter_group_creation_enabled")}function o(){return d("WAWebABProps").getABPropConfigValue("community_general_chat_UI_enabled")}function p(){return d("WAWebABProps").getABPropConfigValue("community_general_chat_create_enabled")}function q(){return d("WAWebABProps").getABPropConfigValue("parent_group_allow_member_suggest_existing_m3_receiver")}function r(){return d("WAWebABProps").getABPropConfigValue("parent_group_allow_member_suggest_existing_m3_sender")}function s(){return d("WAWebABProps").getABPropConfigValue("web_communities_general_chat_v_2")}function t(){return d("WAWebABProps").getABPropConfigValue("enable_community_suspend_and_appeals")}function u(){return d("WAWebABProps").getABPropConfigValue("replies_in_cag_m2_album")}function v(){return d("WAWebABProps").getABPropConfigValue("community_hidden_groups_receiver_enabled")}function w(){return d("WAWebABProps").getABPropConfigValue("community_transfer_ownership_sender")}function x(){return d("WAWebABProps").getABPropConfigValue("parent_group_improve_subgroup_activation_variant")===1}function y(){return d("WAWebABProps").getABPropConfigValue("improve_subgroup_activation_subgroup_poll_interval")}function z(){return d("WAWebABProps").getABPropConfigValue("improve_subgroup_activation_link_to_existing_community")}g.communitiesCreationEnabled=a;g.getParentGroupLinkLimit=b;g.getParentGroupLinkLimitCommunityCreation=c;g.communityAdminPromotionOneTimePromptEnabled=e;g.communityCreatePrivacyEnabled=f;g.subgroupFilterEnabled=h;g.reportCommunityExitUpsellEnabled=i;g.groupMentionsInSubgroupsEnabled=j;g.memberAddedGroupsM1Enabled=k;g.memberSuggestedGroupsEnabled=l;g.shouldShowNewSubgroupIdentity=m;g.communityShortGroupCreationEnabled=n;g.communityGeneralChatUIEnabled=o;g.communityGeneralChatCreateEnabled=p;g.memberSuggestedGroupsM3ReceiverEnabled=q;g.memberSuggestedGroupsM3SenderEnabled=r;g.communityGeneralChatV2Enabled=s;g.isCommunitySuspendAppealEnabled=t;g.repliesInCAGForAlbumsEnabled=u;g.communityHiddenGroupsReceiverEnabled=v;g.communityTransferOwnershipSenderEnabled=w;g.subgroupActivationEnabled=x;g.communityPollIntervalTimeInSeconds=y;g.isLinkToExistingCommunityFromGroupInfoEnabled=z}),98);
__d("WAWebQueryAndUpdateSubgroupSuggestionsJob",["WAWebApiSubgroupSuggestionStore","WAWebBackendApi","WAWebCommunityGatingUtils","WAWebDBCommunity","WAWebMexFetchSubgroupSuggestionsJob","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield d("WAWebMexFetchSubgroupSuggestionsJob").mexFetchSubgroupSuggestions(a,b,"INTERACTIVE"));b=(yield d("WAWebApiSubgroupSuggestionStore").getSubgroupSuggestions(a));b=b.filter(function(a){return!c.some(function(b){return b.id.equals(a.id)&&b.owner.equals(a.owner)})});yield d("WAWebApiSubgroupSuggestionStore").removeSubgroupSuggestions(b.map(function(b){var c=b.id;b=b.owner;return{parentGroupId:a,id:c,owner:b}}));yield d("WAWebApiSubgroupSuggestionStore").addSubgroupSuggestions(a,c);d("WAWebBackendApi").frontendFireAndForget("createOrUpdateSubgroupSuggestions",{parentGroupId:a,subgroupSuggestions:c})});return i.apply(this,arguments)}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.isParentGroup===!0&&a.allowNonAdminSubGroupCreation===!1&&a.participants.some(function(a){return d("WAWebUserPrefsMeUser").isMeAccount(a.id)&&a.isAdmin})&&d("WAWebCommunityGatingUtils").memberSuggestedGroupsEnabled()){var b=(yield d("WAWebDBCommunity").getJoinedSubgroups(a.id));if(b.length)return h(a.id,b[0])}});return j.apply(this,arguments)}g.queryAndUpdateSubgroupSuggestions=h;g.maybeQueryAndUpdateSubgroupSuggestions=a}),98);
__d("WASmaxInInAppCommsIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","internal-server-error");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",500);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorInternalServerErrorMixin=a}),98);
__d("WASmaxInInAppCommsIQErrorRequestTimeoutMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","request-timeout");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",408);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorRequestTimeoutMixin=a}),98);
__d("WASmaxInInAppCommsIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","service-unavailable");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",503);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorServiceUnavailableMixin=a}),98);
__d("WASmaxInInAppCommsIQErrorInternalServerErrorOrRequestTimeoutOrServiceUnavailableMixinGroup",["WAResultOrError","WASmaxInInAppCommsIQErrorInternalServerErrorMixin","WASmaxInInAppCommsIQErrorRequestTimeoutMixin","WASmaxInInAppCommsIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInInAppCommsIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:b.value});var c=d("WASmaxInInAppCommsIQErrorRequestTimeoutMixin").parseIQErrorRequestTimeoutMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorRequestTimeout",value:c.value});var e=d("WASmaxInInAppCommsIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(a);return e.success?d("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorInternalServerError","IQErrorRequestTimeout","IQErrorServiceUnavailable"],[b,c,e])}g.parseIQErrorInternalServerErrorOrRequestTimeoutOrServiceUnavailableMixinGroup=a}),98);
__d("WASmaxInInAppCommsIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);
__d("WASmaxInInAppCommsEventResponseError",["WAResultOrError","WASmaxInInAppCommsIQErrorInternalServerErrorOrRequestTimeoutOrServiceUnavailableMixinGroup","WASmaxInInAppCommsIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInInAppCommsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInInAppCommsIQErrorInternalServerErrorOrRequestTimeoutOrServiceUnavailableMixinGroup").parseIQErrorInternalServerErrorOrRequestTimeoutOrServiceUnavailableMixinGroup(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorIQErrorInternalServerErrorOrRequestTimeoutOrServiceUnavailableMixinGroup:b.value}))}g.parseEventResponseError=a}),98);
__d("WASmaxInInAppCommsIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);
__d("WASmaxInInAppCommsEventResponseSuccess",["WASmaxInInAppCommsIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInInAppCommsIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!c.success?c:c}g.parseEventResponseSuccess=a}),98);
__d("WASmaxOutInAppCommsBaseIQSetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"set"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQSetRequestMixin=a}),98);
__d("WASmaxOutInAppCommsEventRequest",["WASmaxJsx","WASmaxOutInAppCommsBaseIQSetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b,c=a.eventPromotionId,e=a.eventType,f=a.eventTimestampSec;a=a.eventLogdata;c=d("WASmaxOutInAppCommsBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin(d("WASmaxJsx").smax("iq",{xmlns:"w:comms",to:(b=d("WAWap")).S_WHATSAPP_NET},d("WASmaxJsx").smax("event",{promotion_id:b.CUSTOM_STRING(c),type:b.CUSTOM_STRING(e),timestamp_sec:b.INT(f),logdata:b.CUSTOM_STRING(a)})));return c}g.makeEventRequest=a}),98);
__d("WASmaxInAppCommsEventRPC",["WAComms","WASmaxInInAppCommsEventResponseError","WASmaxInInAppCommsEventResponseSuccess","WASmaxOutInAppCommsEventRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:e=d("WASmaxOutInAppCommsEventRequest").makeEventRequest(a);i.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=i.sent;g=d("WASmaxInInAppCommsEventResponseSuccess").parseEventResponseSuccess(f,e);if(!g.success){i.next=7;break}return i.abrupt("return",{name:"EventResponseSuccess",value:g.value});case 7:h=d("WASmaxInInAppCommsEventResponseError").parseEventResponseError(f,e);if(!h.success){i.next=10;break}return i.abrupt("return",{name:"EventResponseError",value:h.value});case 10:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Event",{Success:g,Error:h}));case 11:case"end":return i.stop()}},null,this)}g.sendEventRPC=a}),98);
__d("WAWebJobUserExposureToQuickPromotion",["WALogger","WASmaxInAppCommsEventRPC","WAWebDefinePersistedJob","WAWebModelStorageUtils","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["userExposureToQuickPromotion: unable to log"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["userExposureToQuickPromotion: skipping comms step: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["userExposureToQuickPromotion: missing experiment key"]);j=function(){return a};return a}function a(a){var c=a.id,e=a.experimentKey,f=a.exposureHoldout;if(e.length===0){d("WALogger").ERROR(j()).sendLogs("user-exposure-quick-promotion-missing-exp-key");return"missing-key"}return d("WAWebModelStorageUtils").getStorage().lock(["quick-promotions"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.get(c));if(b==null)return"not-found";if(f==null)return"old-job";b=b.tracking;var d=b.lastLoggedExposure;if(d!=null&&(d.experimentKey===e&&d.exposureHoldout===f))return"deduped";d=babelHelpers["extends"]({},b,{lastLoggedExposure:{experimentKey:e,exposureHoldout:f}});yield a.merge(c,{tracking:d});return"updated"});return function(b){return a.apply(this,arguments)}}()).then(function(a){return a==="updated"?d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("loadQuickPromotions",{trigger:"user-action"}).then(function(){return a}):a})}function c(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=b.id,e=b.ts;b=b.experimentKey;if(a!=="updated"&&a!=="old-job"){d("WALogger").WARN(i(),a);return}a=(yield d("WASmaxInAppCommsEventRPC").sendEventRPC({eventType:"exposure",eventPromotionId:c,eventTimestampSec:e,eventLogdata:b}));a.name!=="EventResponseSuccess"&&(a.name,d("WALogger").ERROR(h()).devConsole(a.value))});return k.apply(this,arguments)}e=d("WAWebDefinePersistedJob").defineWebPersistedJob().step("saveToDb",a).finalStep("reportToComms",c).end();g.userExposureToQuickPromotion=e}),98);
__d("WAWebQueryGetSignedUserInfoJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","WAWebCommsWapMd","WAWebDefinePersistedJob","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(a,b){return a==null?void 0:(a=a.maybeChild(b))==null?void 0:a.contentString()}var i=new(c("WADeprecatedWapParser"))("getSignedUserInfoResponse",function(a){a.assertTag("iq");a.assertFromServer();a=a.maybeChild("signed_user_info");return{phoneNumber:h(a,"phone_number"),phoneNumberSignatureExpiration:h(a,"ttl_timestamp"),phoneNumberSignature:h(a,"phone_number_signature"),businessDomain:h(a,"business_domain")}});a=d("WAWebDefinePersistedJob").defineWebPersistedJob().finalStep("sendStanza",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;a=a.businessJid;b=(b=d("WAWap")).wap("iq",{to:b.S_WHATSAPP_NET,type:"get",xmlns:"w:biz:catalog",id:b.generateId()},b.wap("signed_user_info",{biz_jid:d("WAWebCommsWapMd").USER_JID(d("WAWebWidFactory").createWid(a))}));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(b,i));if(!a.success)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode);return a.result});return function(b){return a.apply(this,arguments)}}()).end();g.QueryGetSignedUserInfo=a}),98);
__d("WAWebResendGroupMsgJob",["WALogger","WAWebDefinePersistedJob","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsgJob: failed to resend message: ",""]);h=function(){return a};return a}a=d("WAWebDefinePersistedJob").defineWebPersistedJob().finalStep("resendUserGroupMsg",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.msgId,c=a.msgType,e=a.msgRecordType,f=a.groupId,g=a.isDirect,i=a.oldList,j=a.phash,k=a.ackTime;a=a.serverAddressingMode;try{b=(yield d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("resendGroupMsg",{msgId:b,msgType:c,msgRecordType:e,groupId:f,isDirect:g,oldList:i,phash:j,ackTime:k,serverAddressingMode:a}));return b}catch(a){d("WALogger").ERROR(h(),a).tags("messaging").sendLogs("persisted-group-message-resend-failed")}});return function(b){return a.apply(this,arguments)}}()).end();g.resendGroupMsgJob=a}),98);
__d("WAWebResendUserMsgJob",["WALogger","WAWebDefinePersistedJob","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["resendUserMsgJob: failed to resend message: ",""]);h=function(){return a};return a}a=d("WAWebDefinePersistedJob").defineWebPersistedJob().finalStep("resendUserMsg",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.msgId,c=a.msgType,e=a.msgRecordType,f=a.excludeList;a=a.ackTime;try{b=(yield d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("resendUserMsg",{msgId:b,msgType:c,msgRecordType:e,excludeList:f,ackTime:a}));return b}catch(a){d("WALogger").ERROR(h(),a).tags("messaging").sendLogs("persisted-message-resend-failed")}});return function(b){return a.apply(this,arguments)}}()).end();g.resendUserMsgJob=a}),98);
__d("WAWebSendRequestedKeyShareJob",["WALogger","WAWebDefinePersistedJob","WAWebWidFactory","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: end sendRequestedKeyShare job"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: starting sendRequestedKeyShare job"]);i=function(){return a};return a}a=d("WAWebDefinePersistedJob").defineWebPersistedJob().finalStep("sendRequestedKeyShare",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.keys,c=a.orphanKeys;a=a.peerDeviceId;d("WALogger").DEV(i());b={type:"missing_key",keys:b,orphanKeys:c,peerDeviceId:d("WAWebWidFactory").createWid(a)};yield d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("sendAppStateSyncKeyShare",{keyShare:b});d("WALogger").DEV(h())});return function(b){return a.apply(this,arguments)}}()).end();g.sendRequestedKeyShare=a}),98);
__d("WAWebSetAboutJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebDefinePersistedJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("aboutResponse",function(a){a.assertAttr("type","result");return{id:a.attrInt("id")}});a=d("WAWebDefinePersistedJob").defineWebPersistedJob().finalStep("sendStanza",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;a=a.content;b=(b=d("WAWap")).wap("iq",{to:b.S_WHATSAPP_NET,type:"set",xmlns:"status",id:b.generateId()},b.wap("status",null,a));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(b,h));return!a.success?{status:a.errorCode}:{status:200}});return function(b){return a.apply(this,arguments)}}()).end();g.setAbout=a}),98);
__d("WAWebPersistedJob",["Promise","WAWebDeleteAddonsJob","WAWebDeleteReactionsJob","WAWebJobDismissQuickPromotion","WAWebJobImpressionOnQuickPromotion","WAWebJobPrimaryActionClickInQuickPromotion","WAWebJobUserExposureToQuickPromotion","WAWebQueryAndUpdateGroupsMetadataByJidsJob","WAWebQueryGetPublicKeyJob","WAWebQueryGetSignedUserInfoJob","WAWebQueryProductListCatalogJob","WAWebResendGroupMsgJob","WAWebResendUserMsgJob","WAWebRotateKeyJob","WAWebSendRequestedKeyShareJob","WAWebSetAboutJob","WAWebSetTextStatusJob","WAWebVerifyPostcodeJob"],(function(a,b,c,d,e,f,g){var h;function a(a){i(a,{rotateKey:function(){return(h||(h=b("Promise"))).resolve(d("WAWebRotateKeyJob").rotateKey)},setAbout:function(){return(h||(h=b("Promise"))).resolve(d("WAWebSetAboutJob").setAbout)},setTextStatus:function(){return(h||(h=b("Promise"))).resolve(d("WAWebSetTextStatusJob").setTextStatus)},queryProductList:function(){return(h||(h=b("Promise"))).resolve(d("WAWebQueryProductListCatalogJob").QueryProductListCatalog)},getPublicKey:function(){return(h||(h=b("Promise"))).resolve(d("WAWebQueryGetPublicKeyJob").QueryGetPublicKey)},getSignedUserInfo:function(){return(h||(h=b("Promise"))).resolve(d("WAWebQueryGetSignedUserInfoJob").QueryGetSignedUserInfo)},verifyPostcode:function(){return(h||(h=b("Promise"))).resolve(d("WAWebVerifyPostcodeJob").VerifyPostcode)},deleteReactions:function(){return(h||(h=b("Promise"))).resolve(d("WAWebDeleteReactionsJob").deleteReactions)},deleteReactionsV2:function(){return(h||(h=b("Promise"))).resolve(d("WAWebDeleteAddonsJob").deleteReactionsV2)},deleteAddOns:function(){return(h||(h=b("Promise"))).resolve(d("WAWebDeleteAddonsJob").deleteAddOns)},sendRequestedKeyShare:function(){return(h||(h=b("Promise"))).resolve(d("WAWebSendRequestedKeyShareJob").sendRequestedKeyShare)},dismissQuickPromotion:function(){return(h||(h=b("Promise"))).resolve(d("WAWebJobDismissQuickPromotion").dismissQuickPromotion)},primaryActionClickInQuickPromotion:function(){return(h||(h=b("Promise"))).resolve(d("WAWebJobPrimaryActionClickInQuickPromotion").primaryActionClickInQuickPromotion)},impressionOnQuickPromotion:function(){return(h||(h=b("Promise"))).resolve(d("WAWebJobImpressionOnQuickPromotion").impressionOnQuickPromotion)},userExposureToQuickPromotion:function(){return(h||(h=b("Promise"))).resolve(d("WAWebJobUserExposureToQuickPromotion").userExposureToQuickPromotion)},queryAndUpdateGroupsMetadataByJids:function(){return(h||(h=b("Promise"))).resolve(d("WAWebQueryAndUpdateGroupsMetadataByJidsJob").queryAndUpdateGroupsMetadataByJidsJob)},resendUserMsg:function(){return(h||(h=b("Promise"))).resolve(d("WAWebResendUserMsgJob").resendUserMsgJob)},resendGroupMsg:function(){return(h||(h=b("Promise"))).resolve(d("WAWebResendGroupMsgJob").resendGroupMsgJob)}})}function i(a,b){Object.keys(b).forEach(function(c){Object.prototype.hasOwnProperty.call(b,c)&&a.addPersistedJobImplementation(c,b[c])})}g["default"]=a}),98);
__d("WAWebSendMsgTypes",[],(function(a,b,c,d,e,f){a=Object.freeze({Message:"message",Addon:"addon"});f.SendMessageRecordType=a}),66);
__d("WAWebPersistedJobDefinitions",["WATimeUtils","WAWebBackendErrors","WAWebBizGatingUtils"],(function(a,b,c,d,e,f,g){a={rotateKey:function(){return{type:"rotateKey",args:{},uniqKey:"rotateKey"}},setAbout:function(a){return{type:"setAbout",args:{content:a},uniqKey:"setAbout"}},queryProductList:function(a,b,c,e,f){c===void 0&&(c=null);if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(d("WAWebBackendErrors").E451)();return{type:"queryProductList",args:{catalogWid:a.toString(),productIds:b,width:e,height:f,directConnectionEncryptedInfo:c},uniqKey:"queryProductList:"+b.slice().sort().join(",")+":"+e+":"+f}},getPublicKey:function(a){return{type:"getPublicKey",args:{businessJid:a.toString()},uniqKey:"getPublicKey:"+a.toString()}},getSignedUserInfo:function(a){return{type:"getSignedUserInfo",args:{businessJid:a.toString()},uniqKey:"getSignedUserInfo:"+a.toString()}},verifyPostcode:function(a,b){return{type:"verifyPostcode",args:{businessJid:a.toString(),directConnectionEncryptedInfo:b},uniqKey:"verifyPostcode:"+a.toString()+":"+b}},deleteReactions:function(a,b){return{type:"deleteReactions",args:{chatId:a,parentMsgKeys:b},uniqKey:"deleteReactions:"+a}},deleteReactionsV2:function(a,b){return{type:"deleteReactionsV2",args:{chatId:a,parentMsgKeys:b}}},deleteAddOns:function(a,b){return{type:"deleteAddOns",args:{chatId:a,parentMsgKeys:b}}},sendRequestedKeyShare:function(a,b,c){return{type:"sendRequestedKeyShare",args:{keys:a,orphanKeys:b,peerDeviceId:c.toString()}}},dismissQuickPromotion:function(a){var b=d("WATimeUtils").unixTime();return{type:"dismissQuickPromotion",args:{id:a,ts:b},uniqKey:"dismissQuickPromotion-"+a+"-"+b}},primaryActionClickInQuickPromotion:function(a){var b=d("WATimeUtils").unixTime();return{type:"primaryActionClickInQuickPromotion",args:{id:a,ts:b},uniqKey:"primaryActionClickInQuickPromotion-"+a+"-"+b}},impressionOnQuickPromotion:function(a){var b=d("WATimeUtils").unixTime();return{type:"impressionOnQuickPromotion",args:{id:a,ts:b},uniqKey:"impressionOnQuickPromotion-"+a+"-"+b}},userExposureToQuickPromotion:function(a,b,c){var e=d("WATimeUtils").unixTime();return{type:"userExposureToQuickPromotion",args:{id:a,ts:e,experimentKey:b,exposureHoldout:c},uniqKey:"userExposureToQuickPromotion-"+a+"-"+e}},setTextStatus:function(a,b,c,d){return{type:"setTextStatus",args:{id:a,text:b,emoji:c,ephemeralDurationSeconds:d},uniqKey:"setTextStatus"}},queryAndUpdateGroupsMetadataByJids:function(a){var b=d("WATimeUtils").unixTime();return{type:"queryAndUpdateGroupsMetadataByJids",args:a,uniqKey:"handleGroupsDirtyNotification-"+b}},resendUserMsg:function(a,b,c){var d=a.data.id.toString();return{type:"resendUserMsg",args:{msgId:d,msgType:a.data.type,msgRecordType:a.type,excludeList:b.map(function(a){return a.toString()}),ackTime:c},uniqKey:"resendUserMsg-"+d}},resendGroupMsg:function(a,b,c,d,e,f,g){var h=a.data.id.toString();b=b.groupId;return{type:"resendGroupMsg",args:{msgId:h,msgType:a.data.type,msgRecordType:a.type,groupId:b,isDirect:c,oldList:d.map(function(a){return a.toString()}),phash:e,ackTime:f,serverAddressingMode:g},uniqKey:"resendGroupMsg-"+h}}};g.jobSerializers=a}),98);
__d("WAWebJobsStorageUtils",["invariant","Promise","WAWebIdb","WAWebStorage","err"],(function(a,b,c,d,e,f,g,h){var i,j="jobs-storage",k=null;function a(){var a=new(c("WAWebIdb"))(j);k=new(d("WAWebStorage").Storage)(a)}function e(){k!=null||h(0,56369);return k}function f(){return k==null?(i||(i=b("Promise"))).reject(c("err")("[jobs-storage] Storage should be created first before being destroyed")):k.purge().then(function(){k=null})["catch"](function(a){k=null;throw a})}g.DATABASE_NAME=j;g.createStorage=a;g.getStorage=e;g.destroyStorage=f}),98);
__d("WAWebJobsStorageVersions",["WAWebJobsStorageUtils"],(function(a,b,c,d,e,f,g){c=1;function a(){return d("WAWebJobsStorageUtils").getStorage().versions.version(0)}function b(){return d("WAWebJobsStorageUtils").getStorage().versions.version(1)}g.versionToRollout=c;g.jobsCreateV1Table=a;g.jobsCreateV2Table=b}),98);
__d("WAWebSchemaJobs",["WAWebJobsStorageUtils","WAWebJobsStorageVersions","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addAutoIncrementingPrimaryKey,j=c.addIndex,k=c.removeColumn;function a(){d("WAWebJobsStorageUtils").getStorage().add("jobs-store").version(d("WAWebJobsStorageVersions").jobsCreateV1Table(),[i("jobId"),h("type"),h("uniqKey"),j("uniqKey"),h("original"),h("current"),h("step"),h("startTime"),h("endTime"),h("stepHardStartCountAfterTimeout"),h("stepFirstStartTime"),h("waitUntil"),h("backedOffCount"),h("version")]).version(d("WAWebJobsStorageVersions").jobsCreateV2Table(),[h("stepUnexpectedErrorCount"),k("endTime")]).view(function(a){return{jobId:a.jobId,type:a.type,uniqKey:a.uniqKey,original:a.original,current:a.current,step:a.step,startTime:a.startTime,stepHardStartCountAfterTimeout:a.stepHardStartCountAfterTimeout,stepFirstStartTime:a.stepFirstStartTime,waitUntil:a.waitUntil,backedOffCount:a.backedOffCount,version:a.version,stepUnexpectedErrorCount:a.stepUnexpectedErrorCount}})}function b(){return d("WAWebJobsStorageUtils").getStorage().table("jobs-store")}g.addTable=a;g.getTable=b}),98);
__d("WAWebJobsStorage",["WALogger","WAWeb-dexie","WAWebDbRolloutUtil","WAWebDexieCastTypes","WAWebJobsStorageUtils","WAWebSchemaJobs","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]);h=function(){return a};return a}var i;function a(){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){i==null&&(yield d("WAWebDbRolloutUtil").loadSchemaVersions(),d("WAWebJobsStorageUtils").createStorage(),d("WAWebSchemaJobs").addTable(),i=d("WAWebJobsStorageUtils").getStorage().initialize()["catch"](function(a){d("WALogger").ERROR(h()).verbose().devConsole(a).sendLogs("Failed to initialize jobs storage",{sendLogsType:d("WALogger").SendLogsType.CRASH_OR_UNRECOVERABLE_ERROR_SAD});throw a}));return i});return j.apply(this,arguments)}function e(){return d("WAWebJobsStorageUtils").destroyStorage()["catch"](function(){return d("WAWebDexieCastTypes").dexieCastToPromise(new(c("WAWeb-dexie"))(d("WAWebJobsStorageUtils").DATABASE_NAME)["delete"]())})["finally"](function(){i=null})}g.initialize=a;g.destroy=e}),98);
__d("WAWebPersistedJobManager",["Promise","WAHex","WAPersistedJobManager","WATimeUtils","WAWebJobsStorage","WAWebNoop","WAWebPersistedJob","WAWebSchemaJobs","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i=null;function a(){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebJobsStorage").initialize();var a=d("WAWebSchemaJobs").getTable();i=new(d("WAPersistedJobManager").PersistedJobManager)({accessors:k(),unfinishedJobEntries:a.all(),isRestartAfterCrash:!1,listeners:{onJobStarted:c("WAWebNoop"),onJobFinished:function(){return null}},deprecatedJobs:{}});c("WAWebPersistedJob")(i)});return j.apply(this,arguments)}function k(){return{deletePersistedJob:function(a){var b=d("WAWebSchemaJobs").getTable();return b.remove(a)},updatePersistedJob:function(a){var b=d("WAWebSchemaJobs").getTable();return b.createOrReplace(a)},readPersistedJob:function(a){var b=d("WAWebSchemaJobs").getTable();return b.get(a)},loadAllJobs:function(){var a=d("WAWebSchemaJobs").getTable();return a.all()},maybeCreateJob:l}}function l(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c,e=d("WAWebSchemaJobs").getTable();c=JSON.stringify([a.type,(c=a.uniqKey)!=null?c:d("WAHex").randomHex(32)]);c={type:a.type,uniqKey:c,startTime:d("WATimeUtils").unixTime(),version:(c=a.version)!=null?c:1,original:a.args,current:a.args,step:d("WAPersistedJobManager").UNSTARTED_JOB,waitUntil:null,stepFirstStartTime:null,stepHardStartCountAfterTimeout:0,stepUnexpectedErrorCount:0,backedOffCount:0};if(a.uniqKey==null)return e.createOrReplace(c).then(function(a){return{id:a,newlyCreated:!0}});a=(yield e.equals(["uniqKey"],[a.uniqKey]));if(a.length===0)return e.createOrReplace(c).then(function(a){return{id:a,newlyCreated:!0}});var f=[],g=null;for(a of a)a.step!==d("WAPersistedJobManager").FINISHED_JOB?g=a:f.push(e.remove(a.jobId));yield (h||(h=b("Promise"))).all(f);return g!=null?{id:g.jobId,newlyCreated:!1}:e.createOrReplace(c).then(function(a){return{id:a,newlyCreated:!0}})});return m.apply(this,arguments)}function e(){if(i==null)throw c("err")("jobs manager has not been initialized");return i}g.startWebPersistedJobManager=a;g.maybeCreateJob=l;g.getJobManager=e}),98);
__d("WAWebDBDeleteReactions",["WAWebModelStorageUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){var c=[];return d("WAWebModelStorageUtils").getStorage().lock(["reactions"],function(){var d=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var d=(yield b.equals(["parentMsgKey"],a));d.forEach(function(a){return c.push([a.parentMsgKey,a.senderUserJid])});return b.bulkRemove(c)});return function(a){return d.apply(this,arguments)}}())}function c(a){var c=[];return d("WAWebModelStorageUtils").getStorage().lock(["reactions"],function(){var d=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var d=(yield b.anyOf(["parentMsgKey"],a));d.forEach(function(a){return c.push([a.parentMsgKey,a.senderUserJid])});yield b.bulkRemove(c);return d.map(function(a){return a.msgKey})});return function(a){return d.apply(this,arguments)}}())}function e(a){return d("WAWebModelStorageUtils").getStorage().lock(["reactions"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];yield b.bulkRemove(a)});return function(a){return c.apply(this,arguments)}}())}g.deleteReactionsByParentMessageKey=a;g.deleteReactionsByParentMessageKeys=c;g.deleteReactionsByRecords=e}),98);
__d("WAWebDeleteAddonsJob",["Promise","WALogger","WAWebAddonDeleteMsgs","WAWebAddonGatingUtils","WAWebDBDeleteReactions","WAWebDBGetReactions","WAWebDBMessageDelete","WAWebDBPollsDeleteVotes","WAWebDefinePersistedJob","WAWebDeleteLastAddOnsPreview","WAWebMsgKey","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Persisted: deletePollVotes job finished for ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Persisted: deletePollVotes job started for ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Persisted: deleteReactionsV2 finished"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Persisted: Deleting reactions from Reactions table"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Persisted: Deleting reactions from Msg table"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Persisted: deleteReactionsV2 finished, no reactionsMsgKeys"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Persisted: deleteReactionsV2 persisted job started for ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["deleteAddons job finished for ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["deleteAddons job started for ",""]);q=function(){return a};return a}a=d("WAWebDefinePersistedJob").defineWebPersistedJob().finalStep("deleteAddOns",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.chatId;a=a.parentMsgKeys;d("WALogger").LOG(q(),c);var e=[d("WAWebAddonDeleteMsgs").deleteAddonMsgsByParentKeys({parentMsgKeys:a})];d("WAWebAddonGatingUtils").isUnifiedInfraEnabledForType(d("WAWebMsgType").MSG_TYPE.REACTION)||e.push(r({chatId:c,parentMsgKeys:a}));d("WAWebAddonGatingUtils").isUnifiedInfraEnabledForType(d("WAWebMsgType").MSG_TYPE.POLL_UPDATE)||e.push(t({chatId:c,parentMsgKeys:a}));a=(yield (h||(h=b("Promise"))).allSettled(e));d("WALogger").LOG(p(),c);for(e of a)if(e.status==="rejected")throw e.reason});return function(b){return a.apply(this,arguments)}}()).end();e=d("WAWebDefinePersistedJob").defineWebPersistedJob().finalStep("deleteReactionsV2",function(a){var b=a.chatId;a=a.parentMsgKeys;return r({chatId:b,parentMsgKeys:a})}).end();function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.chatId;a=a.parentMsgKeys;d("WALogger").LOG(o(),b);b=(yield d("WAWebDBGetReactions").getAllReactionsFromParentMsgs(a));var e=b.map(function(a){return a.msgKey});if(e.length===0){d("WALogger").LOG(n());return}var f=[];e.forEach(function(a){c("WAWebMsgKey").fromString(a).fromMe&&f.push(a)});f.length>0&&(d("WALogger").DEV(m()),yield d("WAWebDBMessageDelete").removeMessagesFromHistory(f,{deleteAssociatedMsgs:!1}));e=b.map(function(a){return[a.parentMsgKey,a.senderUserJid]});d("WALogger").DEV(l());yield d("WAWebDBDeleteReactions").deleteReactionsByRecords(e);yield d("WAWebDeleteLastAddOnsPreview").deleteLastAddOnsPreview(a);d("WALogger").LOG(k())});return s.apply(this,arguments)}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.chatId;a=a.parentMsgKeys;d("WALogger").LOG(j(),b);yield d("WAWebDBPollsDeleteVotes").deleteVotesByParentMsgKeys(a);d("WALogger").LOG(i(),b)});return u.apply(this,arguments)}g.deleteAddOns=a;g.deleteReactionsV2=e}),98);
__d("WAWebMarkAddOnsAsReadJob",["Promise","WAJobOrchestratorTypes","WAWebAddOnsMarkAddOnsAsReadDb","WAWebAddonMarkAsReadUtils","WAWebBackendApi","WAWebOrchestratorNonPersistedJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("markAddOnsAsRead",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebAddOnsMarkAddOnsAsReadDb").markAddOnsAsReadDb(a.updates),d("WAWebBackendApi").frontendFireAndForget("markAddOnsAsReadUi",{updatedMsgKeys:a.updates})});return function(b){return a.apply(this,arguments)}}(),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW}).waitUntilCompleted({updates:a})});return i.apply(this,arguments)}function c(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("markAddOnsAsReadUsingAddonInfra",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebAddonMarkAsReadUtils").processMarkAsRead(a.addons)});return function(b){return a.apply(this,arguments)}}(),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW}).waitUntilCompleted({addons:a})});return j.apply(this,arguments)}function e(a){return a.length===0?(h||(h=b("Promise"))).resolve({updatedAddOns:new Map(),updatedOrphans:[]}):d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("markUnclassifiedAddOnsAsRead",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebAddOnsMarkAddOnsAsReadDb").markUnclassifiedAddOnsAsReadDb(a.msgKeys));d("WAWebBackendApi").frontendFireAndForget("markAddOnsAsReadUi",{updatedMsgKeys:a.updatedAddOns});return a});return function(b){return a.apply(this,arguments)}}(),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted({msgKeys:a})}g.markAddOnsAsReadJob=a;g.markAddOnsAsReadUsingAddonInfraJob=c;g.markUnclassifiedAddOnsAsReadJob=e}),98);
__d("WAWebGroupParticipantsJob",["WAJobOrchestratorTypes","WAWebGroupsParticipantsApi","WAWebOrchestratorNonPersistedJob"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("updateParticipants",function(a){return d("WAWebGroupsParticipantsApi").updateParticipants(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(a)}function b(a,b,c,e){a={group:a,participants:b,isOffline:c,reason:e};return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("addParticipants",function(a){return d("WAWebGroupsParticipantsApi").addParticipants(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(a)}function c(a,b,c,e,f,g,h){a={group:a,participants:b,timestamp:c,author:e,reason:f,groupMetadata:g,isOffline:h};return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("removeParticipants",function(a){return d("WAWebGroupsParticipantsApi").removeParticipants(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(a)}function e(a,b,c,e){a={group:a,participants:b,groupMetadata:c,isOffline:e};return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("demoteParticipants",function(a){return d("WAWebGroupsParticipantsApi").demoteParticipants(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(a)}function f(a,b,c,e){a={group:a,participants:b,groupMetadata:c,isOffline:e};return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("promoteParticipants",function(a){return d("WAWebGroupsParticipantsApi").promoteParticipants(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(a)}function h(a,b){a={group:a,newSuperAdmin:b};return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("setGroupSuperAdmin",function(a){return d("WAWebGroupsParticipantsApi").setGroupSuperAdmin(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(a)}function i(a,b,c){a={group:a,participants:b,isOffline:c};return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("promoteCommunityParticipants",function(a){return d("WAWebGroupsParticipantsApi").promoteCommmunityParticipants(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(a)}function j(a,b,c){a={group:a,participants:b,isOffline:c};return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("demoteCommunityParticipants",function(a){return d("WAWebGroupsParticipantsApi").demoteCommmunityParticipants(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(a)}g.updateParticipantsJob=a;g.addParticipantsJob=b;g.removeParticipantsJob=c;g.demoteParticipantsJob=e;g.promoteParticipantsJob=f;g.setGroupSuperAdminJob=h;g.promoteCommunityParticipantsJob=i;g.demoteCommunityParticipantsJob=j}),98);
__d("WAWebGroupApiConst",[],(function(a,b,c,d,e,f){a={superadmin:"superadmin",admin:"admin",participant:"participant"};f.GROUP_PARTICIPANT_TYPES=a}),66);
__d("WAWebGroupsQueryApi",["WADeprecatedSendIq","WADeprecatedWapParser","WALogger","WATimeUtils","WAWap","WAWebBackendErrors","WAWebCommsWapMd","WAWebGroupApiConst","WAWebJidToWid","WAWebSchemaGroupMetadata","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["queryGroup failed: ",":",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseBatchGroupInfoSmax: unexpected truncated group info received from server when querying dirty groups metadata"]);i=function(){return a};return a}function j(a){if(!a)return null;var b=a.bodyElementValue,c=a.id,e=a.participant;a=a.t;return{desc:b,descId:c,descOwner:e!=null?d("WAWebJidToWid").userJidToUserWid(e):void 0,descTime:d("WATimeUtils").castToUnixTime(a)}}function k(a){if(!a)return null;a=a.expiration;return{ephemeralDuration:a}}function l(a){if(a==null)return null;var b=a.expiration;a=a.type;return{growthLockExpiration:b,growthLockType:a}}function m(a){return a==null?null:{parentGroup:d("WAWebJidToWid").groupJidToWid(a.jid),parentGroupSubject:a.subject}}function n(a){return a.map(function(a){if(a.groupInfoParticipantMixins.name==="GroupInfoParticipantAdmin"){var b=a.groupInfoParticipantMixins.value,c=b.type;b=b.groupInfoParticipantAdminMixins;var e=c==="admin"||c==="superadmin";c=c==="superadmin";if(b.name==="ParticipantWithJid")return{isAdmin:e,isSuperAdmin:c,id:d("WAWebJidToWid").userJidToUserWid(b.value.jid),displayName:null,lid:null,phoneNumber:null};else if(b.name==="ParticipantWithJidAndPn")return{isAdmin:e,isSuperAdmin:c,id:d("WAWebJidToWid").userJidToUserWid(b.value.jid),displayName:null,lid:null,phoneNumber:d("WAWebJidToWid").userJidToUserWid(b.value.phoneNumber)};else if(b.name==="ParticipantWithJidAndLid")return{isAdmin:e,isSuperAdmin:c,id:d("WAWebJidToWid").userJidToUserWid(b.value.jid),lid:d("WAWebJidToWid").userJidToUserWid(b.value.lid),displayName:null};b.name;return{isAdmin:e,isSuperAdmin:c,id:d("WAWebJidToWid").userJidToUserWid(b.value.jid),lid:d("WAWebJidToWid").userJidToUserWid(b.value.lid),displayName:b.value.displayName}}a.groupInfoParticipantMixins.name;e=a.groupInfoParticipantMixins.value.participantMixins;if(e.name==="ParticipantWithJid")return{isAdmin:!1,isSuperAdmin:!1,id:d("WAWebJidToWid").userJidToUserWid(e.value.jid),displayName:null,lid:null};else if(e.name==="ParticipantWithJidAndPn")return{isAdmin:!1,isSuperAdmin:!1,id:d("WAWebJidToWid").userJidToUserWid(e.value.jid),displayName:null,lid:null,phoneNumber:d("WAWebJidToWid").userJidToUserWid(e.value.phoneNumber)};else if(e.name==="ParticipantWithJidAndLid")return{isAdmin:!1,isSuperAdmin:!1,id:d("WAWebJidToWid").userJidToUserWid(e.value.jid),lid:d("WAWebJidToWid").userJidToUserWid(e.value.lid),displayName:null};else if(e.name==="ParticipantWithJidContainingLidAndDisplayName")return{isAdmin:!1,isSuperAdmin:!1,id:d("WAWebJidToWid").userJidToUserWid(e.value.jid),displayName:e.value.displayName,lid:null,phoneNumber:null};e.name;return{isAdmin:!1,isSuperAdmin:!1,id:d("WAWebJidToWid").userJidToUserWid(e.value.jid),lid:d("WAWebJidToWid").userJidToUserWid(e.value.lid),displayName:e.value.displayName,phoneNumber:null}})}function a(a,b){var c=[];b.forEach(function(b){b=b.groupInfoOrTruncatedGroupInfoOrGroupForbiddenOrGroupNotExistMixinGroup;a==="per_group_dirty_recovery"&&b.name==="TruncatedGroupInfo"&&d("WALogger").WARN(i()).sendLogs("unexpected-truncated-group-info-for-dirty-group-request");(b.name==="GroupInfo"||b.name==="TruncatedGroupInfo")&&c.push(o(b.value))});return c}function o(a){var b,e=a.groupAddressingModeMixin,f=a.creator,g=a.creation,h=a.id,i=a.hasLocked,o=a.hasAnnouncement,p=a.hasNoFrequentlyForwarded,q=a.hasSupport,r=a.hasSuspended,s=a.parent,t=a.hasCapi,u=a.hasDefaultSubGroup,v=a.hasGeneralChat,w=a.hasIncognito,x=a.membershipApprovalMode,y=a.membershipApprovalRequest,z=a.hasAllowAdminReports,A=a.ephemeral,B=a.growthLocked,C=a.linkedParent,D=a.description,E=a.descriptionGroupInfoDescriptionMixin,F=a.namedSubjectOrUnnamedSubjectFallbackMixinGroup,G=a.participant,H=a.sT,I=a.size,J=a.groupMemberAddModeMixin,K=a.hasAllowNonAdminSubGroupCreation;a=a.hasAutoAddDisabled;if(h==null)throw c("err")("parseGroupSmax: invalid group id");F=F==null?void 0:F.value.subject;if(F==null)throw c("err")("parseGroupSmax: invalid group subject");G=G!=null?n(G):[];b=(b=x==null?void 0:(b=x.membershipApprovalGroupJoinModeEnabledMixin)==null?void 0:b.state)!=null?b:x==null?void 0:x.state;J=d("WAWebSchemaGroupMetadata").MemberAddMode.cast(J==null?void 0:(x=J.memberAddModeAdminOrAllMembersOrUnknownAddModeMixinGroup)==null?void 0:x.value.elementValue);D=(x=D==null?void 0:D.groupInfoDescriptionMixin)!=null?x:E;E=babelHelpers["extends"]({id:d("WAWebWidFactory").createWid(h+"@g.us"),owner:f!=null?d("WAWebJidToWid").userJidToUserWid(f):void 0,creation:g,restrict:Boolean(i),announce:Boolean(o),noFrequentlyForwarded:Boolean(p),support:q,suspended:r,isParentGroup:s!=null,numSubgroups:s==null?void 0:s.numSubGroups,participants:G,isParentGroupClosed:(s==null?void 0:(x=s.parentGroupDefaultMembershipApprovalModeMixin)==null?void 0:x.defaultMembershipApprovalMode)==="request_required",defaultSubgroup:u,generalSubgroup:v,incognito:w,membershipApprovalMode:b==="on",reportToAdminMode:z,membershipApprovalRequest:y,isLidAddressingMode:(e==null?void 0:e.addressingMode)==="lid",memberAddMode:J,allowNonAdminSubGroupCreation:K},D&&j(D),A&&k(A),l(B),m(C),{subject:F,subjectTime:H,size:I,generalChatAutoAddDisabled:Boolean(a),hasCapi:t});return E}function p(a){if(a.hasChild("description")){a=a.child("description");if(a.hasChild("body")){var b=a.child("body");if(b.hasContent()){b={desc:b.contentString(),descId:a.attrString("id")};a.hasAttr("participant")&&(b.descOwner=d("WAWebJidToWid").userJidToUserWid(a.attrUserJid("participant")));a.hasAttr("t")&&(b.descTime=a.attrTime("t"));return b}}}return null}function q(a){var b=a.attrString("subject");b={subject:b};a.hasAttr("s_o")&&(b.subjectOwner=d("WAWebJidToWid").userJidToUserWid(a.attrUserJid("s_o")));a.hasAttr("s_o_pn")&&(b.subjectOwnerPn=d("WAWebJidToWid").userJidToUserWid(a.attrPhoneUserJid("s_o_pn")));a.hasAttr("s_t")&&(b.subjectTime=a.attrTime("s_t"));return b}function r(a){if(a.hasChild("ephemeral")){a=a.child("ephemeral");if(a.hasAttr("expiration"))return{ephemeralDuration:a.attrInt("expiration")}}return null}function s(a){a=a.maybeChild("growth_locked");var b=a==null?void 0:a.maybeAttrInt("expiration");a=a==null?void 0:a.maybeAttrString("type");return b==null||a==null?null:{growthLockExpiration:b,growthLockType:a}}function t(a){a=a.maybeChild("linked_parent");var b=a==null?void 0:a.maybeAttrGroupJid("jid");return b==null?null:{parentGroup:d("WAWebJidToWid").groupJidToWid(b),parentGroupSubject:a==null?void 0:a.maybeAttrString("subject")}}function u(a){var b=p(a),e=q(a),f=r(a),g=s(a),h=t(a),i,j;try{i=d("WAWebWidFactory").createWid(a.attrString("id")+"@g.us")}catch(a){}if(i==null)throw c("err")("createGroupReplyParser: invalid group id");a.hasChild("member_add_mode")&&(j=d("WAWebSchemaGroupMetadata").MemberAddMode.cast(a.child("member_add_mode").contentString()));var k=a.mapChildrenWithTag("participant",function(a){var b=a.attrEnumOrDefault("type",d("WAWebGroupApiConst").GROUP_PARTICIPANT_TYPES,d("WAWebGroupApiConst").GROUP_PARTICIPANT_TYPES.participant),c=a.maybeAttrLidUserJid("lid"),e=a.maybeAttrPhoneUserJid("phone_number");return{displayName:a.maybeAttrString("display_name"),id:d("WAWebJidToWid").userJidToUserWid(a.attrUserJid("jid")),isSuperAdmin:b===d("WAWebGroupApiConst").GROUP_PARTICIPANT_TYPES.superadmin,isAdmin:b===d("WAWebGroupApiConst").GROUP_PARTICIPANT_TYPES.admin||b===d("WAWebGroupApiConst").GROUP_PARTICIPANT_TYPES.superadmin,lid:c!=null?d("WAWebJidToWid").userJidToUserWid(c):null,phoneNumber:e!=null?d("WAWebJidToWid").userJidToUserWid(e):null}});k=babelHelpers["extends"]({id:i,owner:a.hasAttr("creator")?d("WAWebJidToWid").userJidToUserWid(a.attrUserJid("creator")):void 0,creatorPn:a.hasAttr("creator_pn")?d("WAWebJidToWid").userJidToUserWid(a.attrPhoneUserJid("creator_pn")):void 0,creation:a.attrTime("creation"),restrict:a.hasChild("locked"),announce:a.hasChild("announcement"),noFrequentlyForwarded:a.hasChild("no_frequently_forwarded"),participants:k,support:a.hasChild("support"),size:a.hasAttr("size")?a.attrInt("size"):void 0,suspended:a.hasChild("suspended"),isParentGroup:(k=a.hasChild("parent"))!=null?k:void 0,isParentGroupClosed:((k=a.maybeChild("parent"))==null?void 0:k.maybeAttrString("default_membership_approval_mode"))==="request_required",numSubgroups:(k=(k=a.maybeChild("parent"))==null?void 0:k.maybeAttrInt("num_sub_groups"))!=null?k:0,defaultSubgroup:(k=a.hasChild("default_sub_group"))!=null?k:void 0,generalSubgroup:(k=a.hasChild("general_chat"))!=null?k:void 0,generalChatAutoAddDisabled:a.hasChild("auto_add_disabled"),incognito:a.hasChild("incognito"),isLidAddressingMode:a.maybeAttrString("addressing_mode")?a.attrString("addressing_mode")==="lid":!1,membershipApprovalMode:(a==null?void 0:(k=a.maybeChild("membership_approval_mode"))==null?void 0:(k=k.maybeChild("group_join"))==null?void 0:k.maybeAttrString("state"))==="on",memberAddMode:j,membershipApprovalRequest:a.hasChild("membership_approval_request"),reportToAdminMode:a.hasChild("allow_admin_reports"),allowNonAdminSubGroupCreation:a.hasChild("allow_non_admin_sub_group_creation"),hasCapi:a.hasChild("capi"),hiddenSubgroup:a.hasChild("hidden_group")},b,f,g,e,h);a=k.defaultSubgroup&&k.incognito;b=k.isLidAddressingMode;a===!1&&b===!1&&(k.participants=k.participants.filter(function(a){a=a.id;return!a.isLid()}));return k}var v=new(c("WADeprecatedWapParser"))("queryGroupParser",function(a){return!a.hasChild("group")?{phashMatch:!0}:u(a.child("group"))});function e(a){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.groupWid,c=a.request;a=a.phash;b=d("WAWap").wap("iq",{to:d("WAWebCommsWapMd").GROUP_JID(b),type:"get",xmlns:"w:g2",id:d("WAWap").generateId()},d("WAWap").wap("query",{request:c||d("WAWap").DROP_ATTR,phash:d("WAWap").MAYBE_CUSTOM_STRING(a)}));c=(yield d("WADeprecatedSendIq").deprecatedSendIq(b,v));if(!c.success){d("WALogger").LOG(h(),c.errorCode,c.errorType);throw new(d("WAWebBackendErrors").ServerStatusCodeError)(c.errorCode,c.errorText)}return c.result});return w.apply(this,arguments)}g.parseBatchGroupInfoSmax=a;g.parseGroupSmax=o;g.extractDescription=p;g.extractLinkedParent=t;g.queryGroup=e}),98);
__d("WAWebMexGroupGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("mex_group_get_group_info_mode")===1}function b(){return d("WAWebABProps").getABPropConfigValue("mex_group_get_group_info_mode")===2}function c(){return d("WAWebABProps").getABPropConfigValue("mex_group_get_group_info_mode")===0}g.mexGetGroupInfoEnabled=a;g.groupInfoShadowTestingEnabled=b;g.xmlGroupInfoEnabled=c}),98);
__d("WAWebMexGetTypename",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a==null?void 0:a.__typename}f.getTypename=a}),66);
__d("WAWebMexGroupParseUtils",["WALogger","WAWebBackendErrors","WAWebMexGetTypename","WAWebSchemaGroupMetadata","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["groupQueryGroupJob: XML and MEX shadow participant mismatch: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["groupQueryGroupJob: XML and MEX shadow participant size mismatch, XML:"," MEX:",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["groupQueryGroupJob: MEX shadow mode participants is null while XML is non-null- ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["groupQueryGroupJob: XML shadow mode participants is null while MEX is non-null- ",""]);k=function(){return a};return a}var l="XWA2CommunityGroup",m="XWA2CommunityDefaultSubGroup",n="XWA2CommunitySubGroup",o="LID";function a(a){var b,c,e,f,g,h,i,j,k,s,t,u,v,w,x,y,z,A,B,C;a=a.xwa2_group_query_by_id;if(a==null)return null;var D=a.id,E=a.creation_time,F=a.creator;b=(b=a.creator)==null?void 0:b.pn;var G=a.description;c=(c=a.participants)==null?void 0:c.edges;e=(e=a.properties)==null?void 0:e.allow_admin_reports;f=(f=a.properties)==null?void 0:f.allow_non_admin_sub_group_creation;g=(g=a.properties)==null?void 0:g.announcement;h=(h=a.properties)==null?void 0:(h=h.ephemeral)==null?void 0:h.expiration_time_in_sec;i=((i=a.properties)==null?void 0:(i=i.lid_migration_state)==null?void 0:i.addressing_mode)===o;j=(j=a.properties)==null?void 0:j.locked;k=(k=a.properties)==null?void 0:k.member_add_mode;s=(s=a.properties)==null?void 0:s.membership_approval_mode_enabled;t=(t=a.properties)==null?void 0:t.support;var H=a.state,I=a.subject;u=(u=a.subject)==null?void 0:(u=u.creator)==null?void 0:u.pn;var J=a.total_participants_count;v=(v=a.participants)==null?void 0:v.participants_phash_match;w=(w=a.properties)==null?void 0:w.closed_by_membership_approval_mode;x=(x=a.properties)==null?void 0:x.general_chat;y=a==null?void 0:(y=a.properties)==null?void 0:(y=y.growth_locked2)==null?void 0:y.locked;z=a==null?void 0:(z=a.properties)==null?void 0:z.auto_add_disabled;A=a==null?void 0:(A=a.properties)==null?void 0:A.parent_group_jid;B=a==null?void 0:(B=a.properties)==null?void 0:B.capi;C=a==null?void 0:(C=a.properties)==null?void 0:C.hidden_group;if(D!=null&&E!=null&&(I==null?void 0:I.value)!=null){var K=d("WAWebMexGetTypename").getTypename(a);z=babelHelpers["extends"]({id:d("WAWebWidFactory").createWid(D),owner:(F==null?void 0:F.id)!=null?d("WAWebWidFactory").createWid(F==null?void 0:F.id):void 0,creatorPn:b!=null?d("WAWebWidFactory").createWid(b):void 0,subject:I.value,creation:Number(E),participants:r(v,c),subjectTime:Number(I==null?void 0:I.creation_time),subjectOwner:(I==null?void 0:(D=I.creator)==null?void 0:D.id)!=null?d("WAWebWidFactory").createWid(I==null?void 0:(F=I.creator)==null?void 0:F.id):void 0,subjectOwnerPn:u!=null?d("WAWebWidFactory").createWid(u):void 0,allowNonAdminSubGroupCreation:(b=f)!=null?b:!1,generalChatAutoAddDisabled:K===n&&z!=null?z:!1,restrict:j===!0,announce:K===m||g===!0,support:(E=t)!=null?E:!1,desc:(c=G==null?void 0:G.value)!=null?c:void 0,descId:(D=G==null?void 0:G.id)!=null?D:void 0,descOwner:(G==null?void 0:(I=G.creator)==null?void 0:I.id)!=null?d("WAWebWidFactory").createWid(G==null?void 0:(F=G.creator)==null?void 0:F.id):void 0,descTime:(G==null?void 0:G.creation_time)!=null?Number(G==null?void 0:G.creation_time):void 0,size:J,noFrequentlyForwarded:!1,incognito:K===m,ephemeralDuration:(u=h)!=null?u:void 0,membershipApprovalMode:(f=s)!=null?f:!1,memberAddMode:q(k),suspended:H===p.SUSPENDED,terminated:H===p.TERMINATED?!0:void 0,isLidAddressingMode:i,reportToAdminMode:(b=e)!=null?b:!1,isParentGroupClosed:w===!0,isParentGroup:K===l,parentGroup:A!=null?d("WAWebWidFactory").createWid(A):void 0,generalSubgroup:x===!0,defaultSubgroup:K===m},(K===n||K===m)&&{parentGroupSubject:null},{numSubgroups:0,membershipApprovalRequest:a.membership_approval_request===!0,growthLockType:y===!0?"invite":void 0,hasCapi:B===!0,hiddenSubgroup:C!=null?C:void 0});return{groupInfo:z,participantPhashMatch:v}}}var p={ACTIVE:"ACTIVE",TERMINATED:"NON_EXISTENT",SUSPENDED:"SUSPENDED"};function b(a){switch(a){case"interactive":return"INTERACTIVE";case"phash":return"PHASH";case"prefetch":return"PRE_FETCH";default:return"UNKNOWN"}}function q(a){switch(a){case"ADMIN_ADD":return d("WAWebSchemaGroupMetadata").MemberAddMode.ADMIN_ADD;case"ALL_MEMBER_ADD":return d("WAWebSchemaGroupMetadata").MemberAddMode.ALL_MEMBER_ADD;default:return d("WAWebSchemaGroupMetadata").MemberAddMode.ADMIN_ADD}}function r(a,b){if(a===!0)return[];if(b==null)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(500,"missing participants in group info participant response");a=b.map(function(a){var b=a.node;a=a.role;var c,e,f;if(b.id==null)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(500,"missing id in group info participant response");else c=d("WAWebWidFactory").createWid(b.id);b.lid!=null&&(e=d("WAWebWidFactory").createWid(b.lid));b.pn!=null&&(f=d("WAWebWidFactory").createWid(b.pn));return{id:c,lid:e,phoneNumber:(c=f)!=null?c:null,displayName:(c=b.display_name)!=null?c:null,isAdmin:a==="ADMIN_MEMBER"||a==="SUPERADMIN_MEMBER",isSuperAdmin:a==="SUPERADMIN_MEMBER"}});return a}function c(a,b){var c=[];a.id!==b.id&&c.push("id");a.owner!==b.owner&&c.push("owner");a.creatorPn!==b.creatorPn&&c.push("creatorPn");a.subject!==b.subject&&c.push("subject");a.creation!==b.creation&&c.push("creation");a.subjectTime!==b.subjectTime&&c.push("subjectTime");s(a.participants,b.participants)||c.push("participants");a.pastParticipants!==b.pastParticipants&&c.push("pastParticipants");a.subjectTime!==b.subjectTime&&c.push("subjectTime");a.subjectOwner!==b.subjectOwner&&c.push("subjectOwner");a.subjectOwnerPn!==b.subjectOwnerPn&&c.push("subjectOwnerPn");a.restrict!==b.restrict&&c.push("restrict");a.announce!==b.announce&&c.push("announce");a.noFrequentlyForwarded!==b.noFrequentlyForwarded&&c.push("noFrequentlyForwarded");a.ephemeralDuration!==b.ephemeralDuration&&c.push("ephemeralDuration");a.membershipApprovalMode!==b.membershipApprovalMode&&c.push("membershipApprovalMode");a.memberAddMode!==b.memberAddMode&&c.push("memberAddMode");a.membershipApprovalRequest!==b.membershipApprovalRequest&&c.push("membershipApprovalRequest");a.growthLockExpiration!==b.growthLockExpiration&&c.push("growthLockExpiration");a.growthLockType!==b.growthLockType&&c.push("growthLockType");a.desc!==b.desc&&c.push("desc");a.descId!==b.descId&&c.push("descId");a.descTime!==b.descTime&&c.push("descTime");a.descOwner!==b.descOwner&&c.push("descOwner");a.support!==b.support&&c.push("support");a.a_v_id!==b.a_v_id&&c.push("a_v_id");a.size!==b.size&&c.push("size");a.suspended!==b.suspended&&c.push("suspended");a.terminated!==b.terminated&&c.push("terminated");a.isParentGroup!==b.isParentGroup&&c.push("isParentGroup");a.isParentGroupClosed!==b.isParentGroupClosed&&c.push("isParentGroupClosed");a.defaultSubgroup!==b.defaultSubgroup&&c.push("defaultSubgroup");a.generalSubgroup!==b.generalSubgroup&&c.push("generalSubgroup");a.unjoinedSubgroups!==b.unjoinedSubgroups&&c.push("unjoinedSubgroups");a.numSubgroups!==b.numSubgroups&&c.push("numSubGroups");a.parentGroupSubject!==b.parentGroupSubject&&c.push("parentGroupSubject");a.lastActivityTimestamp!==b.lastActivityTimestamp&&c.push("lastActivityTimestamp");a.lastSeenActivityTimestamp!==b.lastSeenActivityTimestamp&&c.push("lastSeenActivityTimestamp");a.incognito!==b.incognito&&c.push("incognito");a.isLidAddressingMode!==b.isLidAddressingMode&&c.push("isLidAddressingMode");a.adminRequestRequired!==b.adminRequestRequired&&c.push("adminRequestRequired");a.reportToAdminMode!==b.reportToAdminMode&&c.push("reportToAdminMode");a.lastReportToAdminTimestamp!==b.lastReportToAdminTimestamp&&c.push("lastReportToAdminTimestamp");a.allowNonAdminSubGroupCreation!==b.allowNonAdminSubGroupCreation&&c.push("allowNonAdminSubGroupCreation");a.generalChatAutoAddDisabled!==b.generalChatAutoAddDisabled&&c.push("generalChatAutoAddDisabled");a.hiddenSubgroup!==b.hiddenSubgroup&&c.push("hiddenSubgroup");return c}function s(a,b){if(a==null&&b==null)return!0;if(a==null||b==null){a==null?d("WALogger").LOG(k(),JSON.stringify(b)):d("WALogger").LOG(j(),JSON.stringify(a));return!1}if((a==null?void 0:a.length)!==(b==null?void 0:b.length)){d("WALogger").LOG(i(),a==null?void 0:a.length,b==null?void 0:b.length);return!1}var c=[],e=function(){if(g){if(l>=f.length)return"break";m=f[l++]}else{l=f.next();if(l.done)return"break";m=l.value}var a=m,d=b.find(function(b){return b.id.equals(a.id)});if(d==null){c.push([a,null]);return"continue"}(a.displayName!==d.displayName||a.isAdmin!==d.isAdmin||a.isSuperAdmin!==d.isSuperAdmin)&&c.push([a,d])};_loop:for(var f=a,g=Array.isArray(f),l=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var m;a=e();switch(a){case"break":break _loop;case"continue":continue}}if(c.length>0){d("WALogger").LOG(h(),JSON.stringify(c));return!1}return!0}g.parseMexGroupResponse=a;g.toMexQueryContext=b;g.compareMexAndXmlGroupInfoResults=c}),98);
__d("WAWebGroupQueryGroupJob",["Promise","WALogger","WAWebApiChat","WAWebApiParticipantStore","WAWebCreateOrReplaceDisplayNamesAndLidPnMappingsJob","WAWebDBGroupsGroupMetadata","WAWebGroupsParticipantsApi","WAWebGroupsQueryApi","WAWebMexFetchGroupInfoJob","WAWebMexGroupGatingUtils","WAWebMexGroupParseUtils","WAWebOrchestratorNonPersistedJob","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["groupQueryGroupJob: error codes not equal between xml and mex queries for ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["groupQueryGroupJob: mex query succeeded but xml query failed for ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["groupQueryGroupJob: xml query succeeded but mex query failed for ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["groupQueryGroupJob: group info not equal between xml and mex queries for ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["groupQueryGroupJob: phash match not equal between xml and mex queries for ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["groupQueryGroupJob: MEX shadow group info results for ","- ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["groupQueryGroupJob: MEX shadow group info without participants for ","- ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["groupQueryGroupJob: XML shadow group info for ","- ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["groupQueryGroupJob: XML shadow group info without participants for ","- ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["groupQueryJob: group "," does not exist"]);r=function(){return a};return a}function a(a,c,e){e={groupWid:a,request:c,phash:e};return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("queryGroup",function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var f=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(a));if(f!=null&&f.terminated){d("WALogger").DEV(r(),a);return}var g,i;if(d("WAWebMexGroupGatingUtils").xmlGroupInfoEnabled())g=(yield d("WAWebGroupsQueryApi").queryGroup(e));else if(d("WAWebMexGroupGatingUtils").groupInfoShadowTestingEnabled()){f=(yield s(e,a,c));e=(f==null?void 0:(e=f.xmlGroupInfo)==null?void 0:(e=e.groupInfo)==null?void 0:e.isLidAddressingMode)===!0;e||u(a,f);g=f.xmlGroupInfo.groupInfo}else if(d("WAWebMexGroupGatingUtils").mexGetGroupInfoEnabled()){e=(yield d("WAWebMexFetchGroupInfoJob").mexGetGroupInfo(a.toString(),c));g=e==null?void 0:e.groupInfo;i=e==null?void 0:e.participantPhashMatch}if((f=g)==null?void 0:f.id){e=g.participants.map(function(a){return{id:d("WAWebWidFactory").toUserWid(a.id),lid:a.lid?d("WAWebWidFactory").toUserWid(a.lid):null,displayName:a.displayName,phoneNumber:a.phoneNumber?d("WAWebWidFactory").toUserWid(a.phoneNumber):null}});f=g;var j=f.owner,k=f.creatorPn,l=f.subjectOwner;f=f.subjectOwnerPn;j&&k&&e.push({id:d("WAWebWidFactory").toUserWid(j),lid:d("WAWebWidFactory").toUserWid(j),phoneNumber:d("WAWebWidFactory").toUserWid(k)});l&&f&&e.push({id:d("WAWebWidFactory").toUserWid(l),lid:d("WAWebWidFactory").toUserWid(l),phoneNumber:d("WAWebWidFactory").toUserWid(f)});j=(yield d("WAWebApiChat").injectAdditionalEphemeralInfoFromDB([g]));k=j[0];yield (h||(h=b("Promise"))).all([d("WAWebDBGroupsGroupMetadata").updateGroupMetadataTable({groupInfos:[k]}),i!==!0&&d("WAWebGroupsParticipantsApi").updateParticipants({group:g.id,participants:g.participants,groupInfo:g}),d("WAWebCreateOrReplaceDisplayNamesAndLidPnMappingsJob").createOrReplaceDisplayNamesAndLidPnMappings(e,!0)]);d("WAWebApiParticipantStore").clearAdminshipCache(g.id.toString())}return g});return function(a){return e.apply(this,arguments)}}()).waitUntilCompleted(e)}function s(a,b,c){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e,f,g;a=(yield d("WAWebGroupsQueryApi").queryGroup(a).then(function(a){f=!0;g=a==null;return a})["catch"](function(a){e=a}));var h,i,j;b=(yield d("WAWebMexFetchGroupInfoJob").mexGetGroupInfo(b.toString(),c).then(function(a){i=!0;j=a==null;return a})["catch"](function(a){h=a}));return{xmlGroupInfo:{groupInfo:a,isSuccess:f===!0,error:e,phashMatch:g},mexGroupInfo:{groupInfo:b==null?void 0:b.groupInfo,isSuccess:i===!0,error:h,phashMatch:j}}});return t.apply(this,arguments)}function u(a,b){var c,e=b.xmlGroupInfo;b=b.mexGroupInfo;if((e==null?void 0:(c=e.groupInfo)==null?void 0:c.participants)!=null){c=e.groupInfo;c.participants;c=babelHelpers.objectWithoutPropertiesLoose(c,["participants"]);d("WALogger").LOG(q(),a.toLogString(),JSON.stringify(c))}else d("WALogger").LOG(p(),a.toLogString(),JSON.stringify(e));if((b==null?void 0:(c=b.groupInfo)==null?void 0:c.participants)!=null){c=b.groupInfo;c.participants;c=babelHelpers.objectWithoutPropertiesLoose(c,["participants"]);d("WALogger").LOG(o(),a,JSON.stringify(c))}else d("WALogger").LOG(n(),a,JSON.stringify(b));if(e.isSuccess&&b.isSuccess){e.phashMatch!==b.phashMatch&&d("WALogger").ERROR(m(),a).sendLogs("groupQueryGroupJob-phashMatch-notEqual");if(e.groupInfo!=null&&b.groupInfo!=null){c=d("WAWebMexGroupParseUtils").compareMexAndXmlGroupInfoResults(e.groupInfo,b.groupInfo);c.length>0&&d("WALogger").ERROR(l(),a).sendLogs("groupQueryGroupJob-xml-mex-groupInfo-notEqual mismatched fields: "+JSON.stringify(c))}}if(e.isSuccess&&!b.isSuccess){var f;c=(c=b==null?void 0:(c=b.error)==null?void 0:c.statusCode)!=null?c:"";f=(f=e==null?void 0:(f=e.error)==null?void 0:f.statusCode)!=null?f:"";d("WALogger").ERROR(k(),a).sendLogs("groupQueryGroupJob-xml-succeeded-mex-failed MEX ERROR:"+JSON.stringify(c)+" XML ERROR: "+JSON.stringify(f))}!e.isSuccess&&b.isSuccess&&d("WALogger").ERROR(j(),a).sendLogs("groupQueryGroupJob-mex-succeeded-xml-failed");if(!e.isSuccess&&!b.isSuccess){((c=e.error)==null?void 0:c.statusCode)!==((f=b.error)==null?void 0:f.statusCode)&&d("WALogger").ERROR(i(),a).sendLogs("groupQueryGroupJob-error-codes-notEqual")}if(!e.isSuccess)throw e.error}g.queryGroupJob=a}),98);
__d("WASmaxInGroupsBatchGetGroupInfoClientErrors",["WAResultOrError","WASmaxInGroupsIQErrorBadRequestMixin","WASmaxInGroupsIQErrorRateOverlimitMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:b.value});var c=d("WASmaxInGroupsIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(a);return c.success?d("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorBadRequest","IQErrorRateOverlimit"],[b,c])}g.parseBatchGetGroupInfoClientErrors=a}),98);
__d("WASmaxInGroupsBatchGetGroupInfoResponseClientError",["WAResultOrError","WASmaxInGroupsBatchGetGroupInfoClientErrors","WASmaxInGroupsIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInGroupsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInGroupsBatchGetGroupInfoClientErrors").parseBatchGetGroupInfoClientErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorBatchGetGroupInfoClientErrors:b.value}))}g.parseBatchGetGroupInfoResponseClientError=a}),98);
__d("WASmaxInGroupsBatchGetGroupInfoResponseServerError",["WASmaxInGroupsBaseServerErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInGroupsBaseServerErrorMixin").parseBaseServerErrorMixin(a,b);return!c.success?c:c}g.parseBatchGetGroupInfoResponseServerError=a}),98);
__d("WASmaxInGroupsGroupForbiddenMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"group");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"id");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","403");return!a.success?a:d("WAResultOrError").makeResult({id:b.value,error:a.value})}g.parseGroupForbiddenMixin=a}),98);
__d("WASmaxInGroupsGroupNotExistMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"group");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"id");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"error","404");return!a.success?a:d("WAResultOrError").makeResult({id:b.value,error:a.value})}g.parseGroupNotExistMixin=a}),98);
__d("WASmaxInGroupsTruncatedGroupInfoMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"group");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"id");if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"truncated","true");if(!c.success)return c;a=d("WASmaxParseUtils").attrIntRange(a,"size",0,19999);return!a.success?a:d("WAResultOrError").makeResult({id:b.value,truncated:c.value,size:a.value})}g.parseTruncatedGroupInfoMixin=a}),98);
__d("WASmaxInGroupsGroupInfoOrTruncatedGroupInfoOrGroupForbiddenOrGroupNotExistMixinGroup",["WAResultOrError","WASmaxInGroupsGroupForbiddenMixin","WASmaxInGroupsGroupInfoMixin","WASmaxInGroupsGroupNotExistMixin","WASmaxInGroupsTruncatedGroupInfoMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsGroupInfoMixin").parseGroupInfoMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"GroupInfo",value:b.value});var c=d("WASmaxInGroupsTruncatedGroupInfoMixin").parseTruncatedGroupInfoMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"TruncatedGroupInfo",value:c.value});var e=d("WASmaxInGroupsGroupForbiddenMixin").parseGroupForbiddenMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"GroupForbidden",value:e.value});var f=d("WASmaxInGroupsGroupNotExistMixin").parseGroupNotExistMixin(a);return f.success?d("WAResultOrError").makeResult({name:"GroupNotExist",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["GroupInfo","TruncatedGroupInfo","GroupForbidden","GroupNotExist"],[b,c,e,f])}g.parseGroupInfoOrTruncatedGroupInfoOrGroupForbiddenOrGroupNotExistMixinGroup=a}),98);
__d("WASmaxInGroupsBatchGetGroupInfoResponseSuccess",["WAResultOrError","WASmaxInGroupsDedupAttrsMixin","WASmaxInGroupsGroupInfoOrTruncatedGroupInfoOrGroupForbiddenOrGroupNotExistMixinGroup","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"group");if(!b.success)return b;b=d("WASmaxInGroupsDedupAttrsMixin").parseDedupAttrsMixin(a);a=d("WASmaxInGroupsGroupInfoOrTruncatedGroupInfoOrGroupForbiddenOrGroupNotExistMixinGroup").parseGroupInfoOrTruncatedGroupInfoOrGroupForbiddenOrGroupNotExistMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({dedupAttrsMixin:b.success?b.value:null,groupInfoOrTruncatedGroupInfoOrGroupForbiddenOrGroupNotExistMixinGroup:a.value})}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"groups");if(!c.success)return c;var e=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",e.value);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!e.success)return e;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);if(!a.success)return a;b=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"group",1,1e4,h);return!b.success?b:d("WAResultOrError").makeResult({type:e.value,groupsGroup:b.value})}g.parseBatchGetGroupInfoResponseSuccessGroupsGroup=h;g.parseBatchGetGroupInfoResponseSuccess=a}),98);
__d("WASmaxOutGroupsBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"get"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQGetRequestMixin=a}),98);
__d("WASmaxOutGroupsBaseGetServerMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutGroupsBaseIQGetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxOutGroupsBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(d("WASmaxJsx").smax("iq",{to:d("WAWap").G_US,xmlns:"w:g2"}));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseGetServerMixin=a}),98);
__d("WASmaxOutGroupsBatchGetGroupInfoRequest",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxOutGroupsBaseGetServerMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.groupJid;a=d("WASmaxJsx").smax("group",{jid:d("WAWap").GROUP_JID(a)});return a}function a(a){var b=a.groupArgs;a=a.queryContext;a=d("WASmaxOutGroupsBaseGetServerMixin").mergeBaseGetServerMixin(d("WASmaxJsx").smax("iq",null,d("WASmaxJsx").smax("query",{context:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)},d("WASmaxChildren").REPEATED_CHILD(h,b,1,1e4))));return a}g.makeBatchGetGroupInfoRequestQueryGroup=h;g.makeBatchGetGroupInfoRequest=a}),98);
__d("WASmaxGroupsBatchGetGroupInfoRPC",["WAComms","WASmaxInGroupsBatchGetGroupInfoResponseClientError","WASmaxInGroupsBatchGetGroupInfoResponseServerError","WASmaxInGroupsBatchGetGroupInfoResponseSuccess","WASmaxOutGroupsBatchGetGroupInfoRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=d("WASmaxOutGroupsBatchGetGroupInfoRequest").makeBatchGetGroupInfoRequest(a);j.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=j.sent;g=d("WASmaxInGroupsBatchGetGroupInfoResponseSuccess").parseBatchGetGroupInfoResponseSuccess(f,e);if(!g.success){j.next=7;break}return j.abrupt("return",{name:"BatchGetGroupInfoResponseSuccess",value:g.value});case 7:h=d("WASmaxInGroupsBatchGetGroupInfoResponseClientError").parseBatchGetGroupInfoResponseClientError(f,e);if(!h.success){j.next=10;break}return j.abrupt("return",{name:"BatchGetGroupInfoResponseClientError",value:h.value});case 10:i=d("WASmaxInGroupsBatchGetGroupInfoResponseServerError").parseBatchGetGroupInfoResponseServerError(f,e);if(!i.success){j.next=13;break}return j.abrupt("return",{name:"BatchGetGroupInfoResponseServerError",value:i.value});case 13:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("BatchGetGroupInfo",{Success:g,ClientError:h,ServerError:i}));case 14:case"end":return j.stop()}},null,this)}g.sendBatchGetGroupInfoRPC=a}),98);
__d("WASmaxInGroupsIQErrorGoneMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","gone");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",410);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorGoneMixin=a}),98);
__d("WASmaxInGroupsIQErrorGrowthLockedMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"growth_locked");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","invite");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"expiration",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({type:b.value,expiration:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"growth_locked",h);if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","growth-locked");if(!c.success)return c;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",436);return!a.success?a:d("WAResultOrError").makeResult({text:c.value,code:a.value,growthLocked:b.value})}g.parseIQErrorGrowthLockedGrowthLocked=h;g.parseIQErrorGrowthLockedMixin=a}),98);
__d("WASmaxInGroupsGetInviteGroupInfoClientErrors",["WAResultOrError","WASmaxInGroupsIQErrorBadRequestMixin","WASmaxInGroupsIQErrorFallbackClientMixin","WASmaxInGroupsIQErrorGoneMixin","WASmaxInGroupsIQErrorGrowthLockedMixin","WASmaxInGroupsIQErrorItemNotFoundMixin","WASmaxInGroupsIQErrorLockedMixin","WASmaxInGroupsIQErrorNotAcceptableMixin","WASmaxInGroupsIQErrorNotAuthorizedMixin","WASmaxInGroupsIQErrorParentGroupSuspendedMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:b.value});var c=d("WASmaxInGroupsIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:c.value});var e=d("WASmaxInGroupsIQErrorGoneMixin").parseIQErrorGoneMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IQErrorGone",value:e.value});var f=d("WASmaxInGroupsIQErrorNotAuthorizedMixin").parseIQErrorNotAuthorizedMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"IQErrorNotAuthorized",value:f.value});var g=d("WASmaxInGroupsIQErrorNotAcceptableMixin").parseIQErrorNotAcceptableMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"IQErrorNotAcceptable",value:g.value});var h=d("WASmaxInGroupsIQErrorLockedMixin").parseIQErrorLockedMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"IQErrorLocked",value:h.value});var i=d("WASmaxInGroupsIQErrorGrowthLockedMixin").parseIQErrorGrowthLockedMixin(a);if(i.success)return d("WAResultOrError").makeResult({name:"IQErrorGrowthLocked",value:i.value});var j=d("WASmaxInGroupsIQErrorParentGroupSuspendedMixin").parseIQErrorParentGroupSuspendedMixin(a);if(j.success)return d("WAResultOrError").makeResult({name:"IQErrorParentGroupSuspended",value:j.value});var k=d("WASmaxInGroupsIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(a);return k.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:k.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorBadRequest","IQErrorItemNotFound","IQErrorGone","IQErrorNotAuthorized","IQErrorNotAcceptable","IQErrorLocked","IQErrorGrowthLocked","IQErrorParentGroupSuspended","IQErrorFallbackClient"],[b,c,e,f,g,h,i,j,k])}g.parseGetInviteGroupInfoClientErrors=a}),98);
__d("WASmaxInGroupsGetInviteGroupInfoResponseClientError",["WAResultOrError","WASmaxInGroupsGetInviteGroupInfoClientErrors","WASmaxInGroupsIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInGroupsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInGroupsGetInviteGroupInfoClientErrors").parseGetInviteGroupInfoClientErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorGetInviteGroupInfoClientErrors:b.value}))}g.parseGetInviteGroupInfoResponseClientError=a}),98);
__d("WASmaxInGroupsGetInviteGroupInfoResponseServerError",["WASmaxInGroupsBaseServerErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInGroupsBaseServerErrorMixin").parseBaseServerErrorMixin(a,b);return!c.success?c:c}g.parseGetInviteGroupInfoResponseServerError=a}),98);
__d("WASmaxInGroupsInviteLinkGroupInfoMixin",["WAResultOrError","WASmaxInGroupsGroupInfoAttributesMixin","WASmaxInGroupsGroupInfoDescriptionMixin","WASmaxInGroupsGroupInfoParticipantMixin","WASmaxInGroupsMembershipApprovalGroupJoinModeEnabledMixin","WASmaxInGroupsNamedSubjectMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"participant");if(!b.success)return b;b=d("WASmaxInGroupsGroupInfoParticipantMixin").parseGroupInfoParticipantMixin(a);return!b.success?b:b}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"parent");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"num_sub_groups",1,1e3);return!b.success?b:d("WAResultOrError").makeResult({numSubGroups:b.value})}function j(a){var b=d("WASmaxParseUtils").assertTag(a,"linked_parent");if(!b.success)return b;b=d("WASmaxParseJid").attrGroupJid(a,"jid");if(!b.success)return b;a=d("WASmaxInGroupsNamedSubjectMixin").parseNamedSubjectMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({jid:b.value},a.value))}function k(a){var b=d("WASmaxParseUtils").assertTag(a,"membership_approval_mode");if(!b.success)return b;b=d("WASmaxInGroupsMembershipApprovalGroupJoinModeEnabledMixin").parseMembershipApprovalGroupJoinModeEnabledMixin(a);return!b.success?b:b}function l(a){var b=d("WASmaxParseUtils").assertTag(a,"membership_approval_request");if(!b.success)return b;b=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,a,"error","304");return!b.success?b:d("WAResultOrError").makeResult({error:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"group");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"description");if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChildWithTag(a,"parent",i);if(!c.success)return c;var e=d("WASmaxParseUtils").optionalChildWithTag(a,"linked_parent",j);if(!e.success)return e;var f=d("WASmaxParseUtils").optionalChild(a,"hidden_group");if(!f.success)return f;var g=d("WASmaxParseUtils").optionalChild(a,"default_sub_group");if(!g.success)return g;var m=d("WASmaxParseUtils").optionalChild(a,"general_chat");if(!m.success)return m;var n=d("WASmaxParseUtils").optionalChildWithTag(a,"membership_approval_mode",k);if(!n.success)return n;var o=d("WASmaxParseUtils").optionalChildWithTag(a,"membership_approval_request",l);if(!o.success)return o;var p=d("WASmaxParseUtils").attrIntRange(a,"size",0,19999);if(!p.success)return p;b=d("WASmaxInGroupsGroupInfoDescriptionMixin").parseGroupInfoDescriptionMixin(b.value);var q=d("WASmaxInGroupsGroupInfoAttributesMixin").parseGroupInfoAttributesMixin(a);if(!q.success)return q;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"participant",0,19999,h);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({size:p.value,descriptionGroupInfoDescriptionMixin:b.success?b.value:null},q.value,{parent:c.value,linkedParent:e.value,hasHiddenGroup:f.value!=null,hasDefaultSubGroup:g.value!=null,hasGeneralChat:m.value!=null,membershipApprovalMode:n.value,membershipApprovalRequest:o.value,participant:a.value}))}g.parseInviteLinkGroupInfoParticipant=h;g.parseInviteLinkGroupInfoParent=i;g.parseInviteLinkGroupInfoLinkedParent=j;g.parseInviteLinkGroupInfoMembershipApprovalMode=k;g.parseInviteLinkGroupInfoMembershipApprovalRequest=l;g.parseInviteLinkGroupInfoMixin=a}),98);
__d("WASmaxInGroupsGetInviteGroupInfoResponseSuccess",["WAResultOrError","WASmaxInGroupsInviteLinkGroupInfoMixin","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"group");if(!c.success)return c;var e=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",e.value);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!e.success)return e;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);if(!a.success)return a;b=d("WASmaxParseUtils").attrIntRange(c.value,"size",0,19999);if(!b.success)return b;a=d("WASmaxInGroupsInviteLinkGroupInfoMixin").parseInviteLinkGroupInfoMixin(c.value);return!a.success?a:d("WAResultOrError").makeResult({type:e.value,groupSize:b.value,groupInviteLinkGroupInfoMixin:a.value})}g.parseGetInviteGroupInfoResponseSuccess=a}),98);
__d("WASmaxOutGroupsGetInviteGroupInfoRequest",["WASmaxJsx","WASmaxOutGroupsBaseGetServerMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(a){a=a.inviteCode;a=d("WASmaxOutGroupsBaseGetServerMixin").mergeBaseGetServerMixin(d("WASmaxJsx").smax("iq",null,d("WASmaxJsx").smax("invite",{code:d("WAWap").CUSTOM_STRING(a)})));return a}g.makeGetInviteGroupInfoRequest=a}),98);
__d("WASmaxGroupsGetInviteGroupInfoRPC",["WAComms","WASmaxInGroupsGetInviteGroupInfoResponseClientError","WASmaxInGroupsGetInviteGroupInfoResponseServerError","WASmaxInGroupsGetInviteGroupInfoResponseSuccess","WASmaxOutGroupsGetInviteGroupInfoRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=d("WASmaxOutGroupsGetInviteGroupInfoRequest").makeGetInviteGroupInfoRequest(a);j.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=j.sent;g=d("WASmaxInGroupsGetInviteGroupInfoResponseSuccess").parseGetInviteGroupInfoResponseSuccess(f,e);if(!g.success){j.next=7;break}return j.abrupt("return",{name:"GetInviteGroupInfoResponseSuccess",value:g.value});case 7:h=d("WASmaxInGroupsGetInviteGroupInfoResponseClientError").parseGetInviteGroupInfoResponseClientError(f,e);if(!h.success){j.next=10;break}return j.abrupt("return",{name:"GetInviteGroupInfoResponseClientError",value:h.value});case 10:i=d("WASmaxInGroupsGetInviteGroupInfoResponseServerError").parseGetInviteGroupInfoResponseServerError(f,e);if(!i.success){j.next=13;break}return j.abrupt("return",{name:"GetInviteGroupInfoResponseServerError",value:i.value});case 13:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("GetInviteGroupInfo",{Success:g,ClientError:h,ServerError:i}));case 14:case"end":return j.stop()}},null,this)}g.sendGetInviteGroupInfoRPC=a}),98);
__d("WASmaxInGroupsIQErrorBadRequestOrRateOverlimitOrFallbackClientMixinGroup",["WAResultOrError","WASmaxInGroupsIQErrorBadRequestMixin","WASmaxInGroupsIQErrorFallbackClientMixin","WASmaxInGroupsIQErrorRateOverlimitMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:b.value});var c=d("WASmaxInGroupsIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:c.value});var e=d("WASmaxInGroupsIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(a);return e.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorBadRequest","IQErrorRateOverlimit","IQErrorFallbackClient"],[b,c,e])}g.parseIQErrorBadRequestOrRateOverlimitOrFallbackClientMixinGroup=a}),98);
__d("WASmaxInGroupsGetParticipatingGroupsResponseClientError",["WAResultOrError","WASmaxInGroupsIQErrorBadRequestOrRateOverlimitOrFallbackClientMixinGroup","WASmaxInGroupsIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInGroupsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInGroupsIQErrorBadRequestOrRateOverlimitOrFallbackClientMixinGroup").parseIQErrorBadRequestOrRateOverlimitOrFallbackClientMixinGroup(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorIQErrorBadRequestOrRateOverlimitOrFallbackClientMixinGroup:b.value}))}g.parseGetParticipatingGroupsResponseClientError=a}),98);
__d("WASmaxInGroupsGetParticipatingGroupsResponseServerError",["WASmaxInGroupsBaseServerErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInGroupsBaseServerErrorMixin").parseBaseServerErrorMixin(a,b);return!c.success?c:c}g.parseGetParticipatingGroupsResponseServerError=a}),98);
__d("WASmaxInGroupsGroupInfoOrTruncatedGroupInfoGroupInfoMixinGroup",["WAResultOrError","WASmaxInGroupsGroupInfoMixin","WASmaxInGroupsTruncatedGroupInfoMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsGroupInfoMixin").parseGroupInfoMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"GroupInfo",value:b.value});var c=d("WASmaxInGroupsTruncatedGroupInfoMixin").parseTruncatedGroupInfoMixin(a);return c.success?d("WAResultOrError").makeResult({name:"TruncatedGroupInfo",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["GroupInfo","TruncatedGroupInfo"],[b,c])}g.parseGroupInfoOrTruncatedGroupInfoGroupInfoMixinGroup=a}),98);
__d("WASmaxInGroupsGetParticipatingGroupsResponseSuccess",["WAResultOrError","WASmaxInGroupsDedupAttrsMixin","WASmaxInGroupsGroupInfoOrTruncatedGroupInfoGroupInfoMixinGroup","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"group");if(!b.success)return b;b=d("WASmaxInGroupsDedupAttrsMixin").parseDedupAttrsMixin(a);a=d("WASmaxInGroupsGroupInfoOrTruncatedGroupInfoGroupInfoMixinGroup").parseGroupInfoOrTruncatedGroupInfoGroupInfoMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({dedupAttrsMixin:b.success?b.value:null,groupInfoOrTruncatedGroupInfoGroupInfoMixinGroup:a.value})}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"groups");if(!c.success)return c;var e=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",e.value);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!e.success)return e;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);if(!a.success)return a;b=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"group",0,1e4,h);return!b.success?b:d("WAResultOrError").makeResult({type:e.value,groupsGroup:b.value})}g.parseGetParticipatingGroupsResponseSuccessGroupsGroup=h;g.parseGetParticipatingGroupsResponseSuccess=a}),98);
__d("WASmaxOutGroupsGetParticipatingGroupsRequest",["WASmaxChildren","WASmaxJsx","WASmaxOutGroupsBaseGetServerMixin"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("participants",null);return a}function i(){var a=d("WASmaxJsx").smax("description",null);return a}function a(a){var b=a.hasParticipants;a=a.hasDescription;b=d("WASmaxOutGroupsBaseGetServerMixin").mergeBaseGetServerMixin(d("WASmaxJsx").smax("iq",null,d("WASmaxJsx").smax("participating",null,d("WASmaxChildren").HAS_OPTIONAL_CHILD(h,b),d("WASmaxChildren").HAS_OPTIONAL_CHILD(i,a))));return b}g.makeGetParticipatingGroupsRequestParticipatingParticipants=h;g.makeGetParticipatingGroupsRequestParticipatingDescription=i;g.makeGetParticipatingGroupsRequest=a}),98);
__d("WASmaxGroupsGetParticipatingGroupsRPC",["WAComms","WASmaxInGroupsGetParticipatingGroupsResponseClientError","WASmaxInGroupsGetParticipatingGroupsResponseServerError","WASmaxInGroupsGetParticipatingGroupsResponseSuccess","WASmaxOutGroupsGetParticipatingGroupsRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=d("WASmaxOutGroupsGetParticipatingGroupsRequest").makeGetParticipatingGroupsRequest(a);j.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=j.sent;g=d("WASmaxInGroupsGetParticipatingGroupsResponseSuccess").parseGetParticipatingGroupsResponseSuccess(f,e);if(!g.success){j.next=7;break}return j.abrupt("return",{name:"GetParticipatingGroupsResponseSuccess",value:g.value});case 7:h=d("WASmaxInGroupsGetParticipatingGroupsResponseClientError").parseGetParticipatingGroupsResponseClientError(f,e);if(!h.success){j.next=10;break}return j.abrupt("return",{name:"GetParticipatingGroupsResponseClientError",value:h.value});case 10:i=d("WASmaxInGroupsGetParticipatingGroupsResponseServerError").parseGetParticipatingGroupsResponseServerError(f,e);if(!i.success){j.next=13;break}return j.abrupt("return",{name:"GetParticipatingGroupsResponseServerError",value:i.value});case 13:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("GetParticipatingGroups",{Success:g,ClientError:h,ServerError:i}));case 14:case"end":return j.stop()}},null,this)}g.sendGetParticipatingGroupsRPC=a}),98);
__d("WASmaxInGroupsGetMembershipApprovalRequestsClientErrors",["WAResultOrError","WASmaxInGroupsIQErrorBadRequestMixin","WASmaxInGroupsIQErrorFallbackClientMixin","WASmaxInGroupsIQErrorForbiddenMixin","WASmaxInGroupsIQErrorItemNotFoundMixin","WASmaxInGroupsIQErrorLockedMixin","WASmaxInGroupsIQErrorNotAuthorizedMixin","WASmaxInGroupsIQErrorRateOverlimitMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:b.value});var c=d("WASmaxInGroupsIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:c.value});var e=d("WASmaxInGroupsIQErrorNotAuthorizedMixin").parseIQErrorNotAuthorizedMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IQErrorNotAuthorized",value:e.value});var f=d("WASmaxInGroupsIQErrorForbiddenMixin").parseIQErrorForbiddenMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"IQErrorForbidden",value:f.value});var g=d("WASmaxInGroupsIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:g.value});var h=d("WASmaxInGroupsIQErrorLockedMixin").parseIQErrorLockedMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"IQErrorLocked",value:h.value});var i=d("WASmaxInGroupsIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(a);return i.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:i.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorBadRequest","IQErrorItemNotFound","IQErrorNotAuthorized","IQErrorForbidden","IQErrorRateOverlimit","IQErrorLocked","IQErrorFallbackClient"],[b,c,e,f,g,h,i])}g.parseGetMembershipApprovalRequestsClientErrors=a}),98);
__d("WASmaxInGroupsGetMembershipApprovalRequestsResponseClientError",["WAResultOrError","WASmaxInGroupsGetMembershipApprovalRequestsClientErrors","WASmaxInGroupsIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInGroupsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInGroupsGetMembershipApprovalRequestsClientErrors").parseGetMembershipApprovalRequestsClientErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorGetMembershipApprovalRequestsClientErrors:b.value}))}g.parseGetMembershipApprovalRequestsResponseClientError=a}),98);
__d("WASmaxInGroupsGetMembershipApprovalRequestsResponseServerError",["WASmaxInGroupsBaseServerErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInGroupsBaseServerErrorMixin").parseBaseServerErrorMixin(a,b);return!c.success?c:c}g.parseGetMembershipApprovalRequestsResponseServerError=a}),98);
__d("WASmaxInGroupsMembershipRequestMethodAttributeMixin",["WAResultOrError","WASmaxInGroupsEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrStringEnum(a,"request_method",d("WASmaxInGroupsEnums").ENUM_INVITELINK_LINKEDGROUPJOIN_NONADMINADD);return!a.success?a:d("WAResultOrError").makeResult({requestMethod:a.value})}g.parseMembershipRequestMethodAttributeMixin=a}),98);
__d("WASmaxInGroupsGetMembershipApprovalRequestsMembershipApprovalRequestMixin",["WAResultOrError","WASmaxInGroupsMembershipRequestMethodAttributeMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"membership_approval_request");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"jid");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"requestor");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"requestor_pn");if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrGroupJid,a,"parent_group_jid");if(!f.success)return f;var g=d("WASmaxParseUtils").attrIntRange(a,"request_time",0,void 0);if(!g.success)return g;a=d("WASmaxInGroupsMembershipRequestMethodAttributeMixin").parseMembershipRequestMethodAttributeMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({jid:b.value,requestor:c.value,requestorPn:e.value,parentGroupJid:f.value,requestTime:g.value},a.value))}g.parseGetMembershipApprovalRequestsMembershipApprovalRequestMixin=a}),98);
__d("WASmaxInGroupsGetMembershipApprovalRequestsRequestorFetchMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"requestor_fetch","true");return!a.success?a:d("WAResultOrError").makeResult({requestorFetch:a.value})}g.parseGetMembershipApprovalRequestsRequestorFetchMixin=a}),98);
__d("WASmaxInGroupsGetMembershipApprovalRequestsResponseSuccess",["WAResultOrError","WASmaxInGroupsGetMembershipApprovalRequestsMembershipApprovalRequestMixin","WASmaxInGroupsGetMembershipApprovalRequestsRequestorFetchMixin","WASmaxInGroupsGroupAddressingModeMixin","WASmaxInGroupsIQResultResponseMixin","WASmaxInGroupsPhoneNumberMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"membership_approval_request");if(!b.success)return b;b=d("WASmaxInGroupsGetMembershipApprovalRequestsMembershipApprovalRequestMixin").parseGetMembershipApprovalRequestsMembershipApprovalRequestMixin(a);if(!b.success)return b;a=d("WASmaxInGroupsPhoneNumberMixin").parsePhoneNumberMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{phoneNumberMixin:a.success?a.value:null}))}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"membership_approval_requests");if(!c.success)return c;var e=d("WASmaxInGroupsGetMembershipApprovalRequestsRequestorFetchMixin").parseGetMembershipApprovalRequestsRequestorFetchMixin(c.value);b=d("WASmaxInGroupsIQResultResponseMixin").parseIQResultResponseMixin(a,b);if(!b.success)return b;a=d("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(a);c=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"membership_approval_request",0,19999,h);return!c.success?c:d("WAResultOrError").makeResult(babelHelpers["extends"]({membershipApprovalRequestsGetMembershipApprovalRequestsRequestorFetchMixin:e.success?e.value:null},b.value,{groupAddressingModeMixin:a.success?a.value:null,membershipApprovalRequestsMembershipApprovalRequest:c.value}))}g.parseGetMembershipApprovalRequestsResponseSuccessMembershipApprovalRequestsMembershipApprovalRequest=h;g.parseGetMembershipApprovalRequestsResponseSuccess=a}),98);
__d("WASmaxOutGroupsBaseGetGroupMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutGroupsBaseIQGetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.iqTo;a=d("WASmaxOutGroupsBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(d("WASmaxJsx").smax("iq",{to:d("WAWap").GROUP_JID(a),xmlns:"w:g2"}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseGetGroupMixin=a}),98);
__d("WASmaxOutGroupsGetMembershipApprovalRequestsRequestorFetchMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("smax$any",{requestor_fetch:"true"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeGetMembershipApprovalRequestsRequestorFetchMixin=a}),98);
__d("WASmaxOutGroupsGetMembershipApprovalRequestsRequest",["WASmaxJsx","WASmaxMixins","WASmaxOutGroupsBaseGetGroupMixin","WASmaxOutGroupsGetMembershipApprovalRequestsRequestorFetchMixin"],(function(a,b,c,d,e,f,g){function a(a){var b=a.hasGetMembershipApprovalRequestsRequestorFetch;b=d("WASmaxOutGroupsBaseGetGroupMixin").mergeBaseGetGroupMixin(d("WASmaxJsx").smax("iq",null,d("WASmaxMixins").optionalMerge(d("WASmaxOutGroupsGetMembershipApprovalRequestsRequestorFetchMixin").mergeGetMembershipApprovalRequestsRequestorFetchMixin,d("WASmaxJsx").smax("membership_approval_requests",null),b)),a);return b}g.makeGetMembershipApprovalRequestsRequest=a}),98);
__d("WASmaxGroupsGetMembershipApprovalRequestsRPC",["WAComms","WASmaxInGroupsGetMembershipApprovalRequestsResponseClientError","WASmaxInGroupsGetMembershipApprovalRequestsResponseServerError","WASmaxInGroupsGetMembershipApprovalRequestsResponseSuccess","WASmaxOutGroupsGetMembershipApprovalRequestsRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=d("WASmaxOutGroupsGetMembershipApprovalRequestsRequest").makeGetMembershipApprovalRequestsRequest(a);j.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=j.sent;g=d("WASmaxInGroupsGetMembershipApprovalRequestsResponseSuccess").parseGetMembershipApprovalRequestsResponseSuccess(f,e);if(!g.success){j.next=7;break}return j.abrupt("return",{name:"GetMembershipApprovalRequestsResponseSuccess",value:g.value});case 7:h=d("WASmaxInGroupsGetMembershipApprovalRequestsResponseClientError").parseGetMembershipApprovalRequestsResponseClientError(f,e);if(!h.success){j.next=10;break}return j.abrupt("return",{name:"GetMembershipApprovalRequestsResponseClientError",value:h.value});case 10:i=d("WASmaxInGroupsGetMembershipApprovalRequestsResponseServerError").parseGetMembershipApprovalRequestsResponseServerError(f,e);if(!i.success){j.next=13;break}return j.abrupt("return",{name:"GetMembershipApprovalRequestsResponseServerError",value:i.value});case 13:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("GetMembershipApprovalRequests",{Success:g,ClientError:h,ServerError:i}));case 14:case"end":return j.stop()}},null,this)}g.sendGetMembershipApprovalRequestsRPC=a}),98);
__d("WAWebRequestMethodType",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["NonAdminAdd","InviteLink","LinkedGroupJoin"]);f.RequestMethod=a}),66);
__d("WAWebGroupGetMembershipApprovalRequestsJob",["Promise","WALogger","WASmaxGroupsGetMembershipApprovalRequestsRPC","WAWebApiMembershipApprovalRequestStore","WAWebBackendApi","WAWebBackendErrors","WAWebJidToWid","WAWebRequestMethodType","WAWebWidToJid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["queryMembershipApprovalRequests failed: ",":",""]);i=function(){return a};return a}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WASmaxGroupsGetMembershipApprovalRequestsRPC").sendGetMembershipApprovalRequestsRPC({iqTo:d("WAWebWidToJid").widToGroupJid(a)}));switch(a.name){case"GetMembershipApprovalRequestsResponseSuccess":return a.value.membershipApprovalRequestsMembershipApprovalRequest.map(function(a){var b=d("WAWebJidToWid").userJidToUserWid(a.jid);return{id:b,t:a.requestTime,addedBy:a.requestor!=null?d("WAWebJidToWid").userJidToUserWid(a.requestor):b,requestMethod:l(a.requestMethod),parentGroupId:a.parentGroupJid!=null?d("WAWebJidToWid").groupJidToWid(a.parentGroupJid):void 0}});case"GetMembershipApprovalRequestsResponseClientError":var b=a.value.errorGetMembershipApprovalRequestsClientErrors;return m(b.value);default:a.name;return m(a.value.errorServerErrors.value)}});return k.apply(this,arguments)}function l(a){switch(a){case"invite_link":return d("WAWebRequestMethodType").RequestMethod.InviteLink;case"linked_group_join":return d("WAWebRequestMethodType").RequestMethod.LinkedGroupJoin;case"non_admin_add":return d("WAWebRequestMethodType").RequestMethod.NonAdminAdd}}function m(a){var c=a.code;a=a.text;d("WALogger").LOG(i(),c,a);return(h||(h=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(c),a))}function a(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield j(a)),c=(yield d("WAWebApiMembershipApprovalRequestStore").getMembershipApprovalRequests(a));c=c.filter(function(a){return!b.some(function(b){return b.id.equals(a.id)})});yield d("WAWebApiMembershipApprovalRequestStore").removeMembershipApprovalRequests(a,c.map(function(a){return a.id}));yield d("WAWebApiMembershipApprovalRequestStore").addMembershipApprovalRequests(a,b);d("WAWebBackendApi").frontendFireAndForget("removeMembershipApprovalRequests",{groupId:a,requestIds:c.map(function(a){return a.id})});d("WAWebBackendApi").frontendFireAndForget("addMembershipApprovalRequests",{groupId:a,requests:b})});return n.apply(this,arguments)}g.queryAndUpdateGroupMembershipApprovalRequests=a}),98);
__d("WAWebGroupQueryJob",["Promise","WALogger","WASmaxGroupsBatchGetGroupInfoRPC","WASmaxGroupsGetInviteGroupInfoRPC","WASmaxGroupsGetParticipatingGroupsRPC","WAWebABProps","WAWebApiChat","WAWebApiParticipantStore","WAWebBackendApi","WAWebBackendErrors","WAWebGroupDatabaseJob","WAWebGroupGetMembershipApprovalRequestsJob","WAWebGroupQueryGroupJob","WAWebGroupsQueryApi","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["queryGroupsById failed: ",":",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["queryGroupsById failed: ",":",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["queryGroupsById: successfully received batch group info for ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["queryAndUpdateGroupMetadataById: skip update due to phash match"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["queryAndUpdateGroupMetadataById: unable to query group ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["queryGroupInvite failed: ",":",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["queryGroupInvite failed: ",":",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["queryAllGroups failed: ",":",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["queryAllGroups failed: ",":",""]);q=function(){return a};return a}function a(){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WAWebApiParticipantStore").clearAdminshipCache();var a=(yield d("WASmaxGroupsGetParticipatingGroupsRPC").sendGetParticipatingGroupsRPC({hasParticipants:!0,hasDescription:!0}));switch(a.name){case"GetParticipatingGroupsResponseSuccess":return a.value.groupsGroup.map(function(a){a=a.groupInfoOrTruncatedGroupInfoGroupInfoMixinGroup;return d("WAWebGroupsQueryApi").parseGroupSmax(a.value)});case"GetParticipatingGroupsResponseClientError":var c=a.value.errorIQErrorBadRequestOrRateOverlimitOrFallbackClientMixinGroup.value,e=c.code;c=c.text;d("WALogger").LOG(q(),e,c);return(h||(h=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(e),c));case"GetParticipatingGroupsResponseServerError":e=a.value.errorServerErrors.value;c=e.code;a=e.text;d("WALogger").LOG(p(),c,a);return(h||(h=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(c),a))}});return r.apply(this,arguments)}function c(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WASmaxGroupsGetInviteGroupInfoRPC").sendGetInviteGroupInfoRPC({inviteCode:a}));switch(a.name){case"GetInviteGroupInfoResponseSuccess":return d("WAWebGroupsQueryApi").parseGroupSmax(a.value.groupInviteLinkGroupInfoMixin);case"GetInviteGroupInfoResponseClientError":var c=a.value.errorGetInviteGroupInfoClientErrors.value,e=c.code;c=c.text;d("WALogger").LOG(o(),e,c);return(h||(h=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(e),c));case"GetInviteGroupInfoResponseServerError":e=a.value.errorServerErrors.value;c=e.code;a=e.text;d("WALogger").LOG(n(),c,a);return(h||(h=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(c),a))}});return s.apply(this,arguments)}function e(a,b){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("WAWebGroupQueryGroupJob").queryGroupJob(a,b));if(b==null){d("WALogger").DEV(m(),a);return}if(b.phashMatch){d("WALogger").LOG(l());return}a=(yield d("WAWebApiParticipantStore").injectPastParticipantsFromDB([b]));b=a[0];a=(yield d("WAWebApiChat").injectAdditionalEphemeralInfoFromDB([b]));b=a[0];yield d("WAWebGroupDatabaseJob").updateGroupParticipantTableWithoutDeviceSyncJob([b]);d("WAWebBackendApi").frontendFireAndForget("createOrUpdateGroupMetadataFromQuery",{groupInfo:b});yield u(b)});return t.apply(this,arguments)}function u(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.membershipApprovalMode&&a.participants.some(function(a){return d("WAWebUserPrefsMeUser").isMeAccount(a.id)&&a.isAdmin})&&d("WAWebABProps").getABPropConfigValue("group_join_request_m2")){var b=(yield d("WAWebApiChat").getChatRecord(a.id));if(!b)return;return d("WAWebGroupGetMembershipApprovalRequestsJob").queryAndUpdateGroupMembershipApprovalRequests(a.id)}});return v.apply(this,arguments)}function f(a,b){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=(yield d("WASmaxGroupsBatchGetGroupInfoRPC").sendBatchGetGroupInfoRPC({queryContext:c,groupArgs:a.map(function(a){return{groupJid:a}})}));switch(e.name){case"BatchGetGroupInfoResponseSuccess":d("WALogger").LOG(k(),a.length);return d("WAWebGroupsQueryApi").parseBatchGroupInfoSmax(c,e.value.groupsGroup);case"BatchGetGroupInfoResponseClientError":a=e.value.errorBatchGetGroupInfoClientErrors.value;c=a.code;a=a.text;d("WALogger").LOG(j(),c,a);return(h||(h=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(c),a));case"BatchGetGroupInfoResponseServerError":c=e.value.errorServerErrors.value;a=c.code;e=c.text;d("WALogger").LOG(i(),a,e);return(h||(h=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(a),e))}});return w.apply(this,arguments)}g.queryAllGroups=a;g.queryGroupInvite=c;g.queryAndUpdateGroupMetadataById=e;g.maybeQueryAndUpdateMembershipApprovalRequests=u;g.queryGroupsById=f}),98);
__d("WAWebSignalConst",[],(function(a,b,c,d,e,f){a={REG_ID:"signal_reg_id",STATIC_PUBKEY:"signal_static_pubkey",STATIC_PRIVKEY:"signal_static_privkey",NEXT_PK_ID:"signal_next_pk_id",LAST_SPK_ID:"signal_last_spk_id",FIRST_UNUPLOAD_PK_ID:"signal_first_unupload_pk_id",SERVER_HAS_KEY:"signal_sever_has_pre_keys",ADV_SIGNED_IDENTITY:"adv_signed_identity"};f.META_KEYS=a}),66);
__d("WAWebSignalStorageUtils",["invariant","Promise","WAWebIdb","WAWebStorage","err"],(function(a,b,c,d,e,f,g,h){var i,j="signal-storage",k=null;function a(){var a=new(c("WAWebIdb"))(j);k=new(d("WAWebStorage").Storage)(a)}function e(){k!=null||h(0,56356);return k}function f(){return k==null?(i||(i=b("Promise"))).reject(c("err")("[signal-storage] Storage should be created first before being destroyed")):k.purge().then(function(){k=null})["catch"](function(a){k=null;throw a})}g.DATABASE_NAME=j;g.createStorage=a;g.getStorage=e;g.destroyStorage=f}),98);
__d("WAWebSignalStorageVersions",["WAWebSignalStorageUtils"],(function(a,b,c,d,e,f,g){var h=6;function a(){return d("WAWebSignalStorageUtils").getStorage().versions.version(0)}function b(){return d("WAWebSignalStorageUtils").getStorage().versions.version(1)}function c(){return d("WAWebSignalStorageUtils").getStorage().versions.version(2)}function e(){return d("WAWebSignalStorageUtils").getStorage().versions.version(3)}function f(){return d("WAWebSignalStorageUtils").getStorage().versions.version(4)}function i(){return d("WAWebSignalStorageUtils").getStorage().versions.version(5)}function j(){return d("WAWebSignalStorageUtils").getStorage().versions.version(6)}g.versionToRollout=h;g.identityCreateTable=a;g.metaCreateTable=b;g.preKeyCreateTable=c;g.sessionCreateTable=e;g.signedPreKeyCreateTable=f;g.baseKeyCreateTable=i;g.senderKeyCreateTable=j}),98);
__d("WAWebSchemaBasekey",["WAWebSignalStorageUtils","WAWebSignalStorageVersions","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addAutoIncrementingPrimaryKey,j=c.addCompositeIndex;function a(){d("WAWebSignalStorageUtils").getStorage().add("baseKey-store").version(d("WAWebSignalStorageVersions").baseKeyCreateTable(),[i("id"),h("address"),h("originalMsgId"),h("baseKey"),j(["address","originalMsgId"])]).view(function(a){return{id:a.id,address:a.address,originalMsgId:a.originalMsgId,baseKey:a.baseKey}})}function b(){return d("WAWebSignalStorageUtils").getStorage().table("baseKey-store")}g.addTable=a;g.getTable=b}),98);
__d("WAWebSchemaIdentity",["WAWebSignalStorageUtils","WAWebSignalStorageVersions","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addUserDefinedPrimaryKey;function a(){d("WAWebSignalStorageUtils").getStorage().add("identity-store").version(d("WAWebSignalStorageVersions").identityCreateTable(),[i("identifier"),h("identityKey"),h("rowId"),h("sentAddonRowId")]).view(function(a){return{identifier:a.identifier,identityKey:a.identityKey,rowId:a.rowId,sentAddonRowId:a.sentAddonRowId}})}function b(){return d("WAWebSignalStorageUtils").getStorage().table("identity-store")}g.addTable=a;g.getTable=b}),98);
__d("WAWebSchemaMeta",["WAWebSignalStorageUtils","WAWebSignalStorageVersions","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addUserDefinedPrimaryKey;function a(){d("WAWebSignalStorageUtils").getStorage().add("signal-meta-store").version(d("WAWebSignalStorageVersions").metaCreateTable(),[i("key"),h("value")]).view(function(a){return{key:a.key,value:a.value}})}function b(){return d("WAWebSignalStorageUtils").getStorage().table("signal-meta-store")}g.addTable=a;g.getTable=b}),98);
__d("WAWebSchemaPrekey",["WAWebSignalStorageUtils","WAWebSignalStorageVersions","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addAutoIncrementingPrimaryKey;function a(){d("WAWebSignalStorageUtils").getStorage().add("prekey-store").version(d("WAWebSignalStorageVersions").preKeyCreateTable(),[i("keyId"),h("keyPair"),h("isDirectDistribution")]).view(function(a){return{keyId:a.keyId,keyPair:a.keyPair,isDirectDistribution:a.isDirectDistribution}})}function b(){return d("WAWebSignalStorageUtils").getStorage().table("prekey-store")}g.addTable=a;g.getTable=b}),98);
__d("WAWebSchemaSenderkey",["WAWebSignalStorageUtils","WAWebSignalStorageVersions","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addUserDefinedPrimaryKey,j=c.addIndex;function a(){d("WAWebSignalStorageUtils").getStorage().add("senderkey-store").version(d("WAWebSignalStorageVersions").senderKeyCreateTable(),[i("senderKeyName"),h("senderKey"),h("senderId"),j("senderId")]).view(function(a){return{senderKeyName:a.senderKeyName,senderKey:a.senderKey,senderId:a.senderId}})}function b(){return d("WAWebSignalStorageUtils").getStorage().table("senderkey-store")}g.addTable=a;g.getTable=b}),98);
__d("WAWebSchemaSession",["WAWebSignalStorageUtils","WAWebSignalStorageVersions","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addUserDefinedPrimaryKey;function a(){d("WAWebSignalStorageUtils").getStorage().add("session-store").version(d("WAWebSignalStorageVersions").sessionCreateTable(),[i("address"),h("session")]).view(function(a){return{address:a.address,session:a.session}})}function b(){return d("WAWebSignalStorageUtils").getStorage().table("session-store")}g.addTable=a;g.getTable=b}),98);
__d("WAWebSchemaSignedPrekey",["WAWebSignalStorageUtils","WAWebSignalStorageVersions","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addAutoIncrementingPrimaryKey;function a(){d("WAWebSignalStorageUtils").getStorage().add("signed-prekey-store").version(d("WAWebSignalStorageVersions").signedPreKeyCreateTable(),[i("keyId"),h("keyPair"),h("signature")]).view(function(a){return{keyId:a.keyId,keyPair:a.keyPair,signature:a.signature}})}function b(){return d("WAWebSignalStorageUtils").getStorage().table("signed-prekey-store")}g.addTable=a;g.getTable=b}),98);
__d("WAWebSignalStorage",["WALogger","WAWeb-dexie","WAWebDbRolloutUtil","WAWebDexieCastTypes","WAWebSchemaBasekey","WAWebSchemaIdentity","WAWebSchemaMeta","WAWebSchemaPrekey","WAWebSchemaSenderkey","WAWebSchemaSession","WAWebSchemaSignedPrekey","WAWebSignalStorageUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]);h=function(){return a};return a}var i;function a(){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){i==null&&(yield d("WAWebDbRolloutUtil").loadSchemaVersions(),d("WAWebSignalStorageUtils").createStorage(),d("WAWebSchemaBasekey").addTable(),d("WAWebSchemaIdentity").addTable(),d("WAWebSchemaMeta").addTable(),d("WAWebSchemaPrekey").addTable(),d("WAWebSchemaSenderkey").addTable(),d("WAWebSchemaSession").addTable(),d("WAWebSchemaSignedPrekey").addTable(),i=d("WAWebSignalStorageUtils").getStorage().initialize()["catch"](function(a){d("WALogger").ERROR(h()).verbose().devConsole(a).sendLogs("Failed to initialize signal storage",{sendLogsType:d("WALogger").SendLogsType.CRASH_OR_UNRECOVERABLE_ERROR_SAD});throw a}));return i});return j.apply(this,arguments)}function e(){return d("WAWebSignalStorageUtils").destroyStorage()["catch"](function(){return d("WAWebDexieCastTypes").dexieCastToPromise(new(c("WAWeb-dexie"))(d("WAWebSignalStorageUtils").DATABASE_NAME)["delete"]())})["finally"](function(){i=null})}g.getBaseKeyTable=d("WAWebSchemaBasekey").getTable;g.getIdentityTable=d("WAWebSchemaIdentity").getTable;g.getMetaTable=d("WAWebSchemaMeta").getTable;g.getPreKeyTable=d("WAWebSchemaPrekey").getTable;g.getSenderKeyTable=d("WAWebSchemaSenderkey").getTable;g.getSessionTable=d("WAWebSchemaSession").getTable;g.getSignedPreKeyTable=d("WAWebSchemaSignedPrekey").getTable;g.initialize=a;g.destroy=e}),98);
__d("WAWebSignalStoreApi",["Promise","WALogger","WAWebNoop","WAWebSignalCommonUtils","WAWebSignalConst","WAWebSignalStorage","WAWebSignalStorageUtils","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["getPreKeys: no prekey needs to be generated, available: ",", need: ",""]);i=function(){return a};return a}var j=1;a=function(){function a(){this.idToSignedPreKey=new Map()}var e=a.prototype;e.getMeta=function(a){var b=d("WAWebSignalStorage").getMetaTable();return b.get(a).then(function(a){return a?a.value:null})};e.putMeta=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=d("WAWebSignalStorage").getMetaTable();a=a.map(function(a){return c.createOrReplace(a)});yield (h||(h=b("Promise"))).all(a)});function c(b){return a.apply(this,arguments)}return c}();e.setServerHasPreKeys=function(a){this.putMeta([{key:d("WAWebSignalConst").META_KEYS.SERVER_HAS_KEY,value:a}])};e.getServerHasPreKeys=function(){return this.getMeta(d("WAWebSignalConst").META_KEYS.SERVER_HAS_KEY)};e.putADVSignedIdentity=function(a){return this.putMeta([{key:d("WAWebSignalConst").META_KEYS.ADV_SIGNED_IDENTITY,value:a}])};e.getADVSignedIdentity=function(){return this.getMeta(d("WAWebSignalConst").META_KEYS.ADV_SIGNED_IDENTITY)};e.getPreKeysByRange=function(a,b){var c=d("WAWebSignalStorage").getPreKeyTable();return c.greaterThan(["keyId"],a-1,{limit:b})};e.getPreKeyById=function(a){var b=d("WAWebSignalStorage").getPreKeyTable();return b.get(a)};e.removePreKeyById=function(a){var b=d("WAWebSignalStorage").getPreKeyTable();return b.remove(a)};e.bulkRemovePreKey=function(a){var b=d("WAWebSignalStorage").getPreKeyTable();return b.bulkRemove(a)};e.putPreKeys=function(a){var b=d("WAWebSignalStorage").getPreKeyTable();return b.bulkCreateOrReplace(a)};e.markPreKeyAsDirectDistribution=function(a){var b=d("WAWebSignalStorage").getPreKeyTable();return b.merge(a,{isDirectDistribution:1})};e.getSignedPreKey=function(){var a=this;return this.getMeta(d("WAWebSignalConst").META_KEYS.LAST_SPK_ID).then(function(b){return a.getSignedPreKeyById(b)})};e.getSignedPreKeyById=function(a){var c=this;if(this.idToSignedPreKey.has(a))return(h||(h=b("Promise"))).resolve(this.idToSignedPreKey.get(a));var e=d("WAWebSignalStorage").getSignedPreKeyTable();return e.get(a).then(function(b){c.idToSignedPreKey.set(a,b);return b})};e.putSignedPreKeys=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=d("WAWebSignalStorage").getSignedPreKeyTable();a=a.map(function(a){var b=a.keyId,d=a.keyPair,f=a.signature;return e.get(b).then(function(a){if(a)throw c("err")("signed preKey id "+b+" already exists");else{a={keyId:b,keyPair:d,signature:f};return e.create(a)}})});yield (h||(h=b("Promise"))).all(a)});function e(b){return a.apply(this,arguments)}return e}();e.putSession=function(a,b){var c=d("WAWebSignalStorage").getSessionTable();return c.createOrReplace({address:a,session:b})};e.bulkPutSession=function(a){var b=d("WAWebSignalStorage").getSessionTable();return b.bulkCreateOrReplace(a)};e.removeSession=function(a){var b=d("WAWebSignalStorage").getSessionTable();return b.remove(a)};e.bulkRemoveSession=function(a){var b=d("WAWebSignalStorage").getSessionTable();return b.bulkRemove(a)};e.getSession=function(a){var b=d("WAWebSignalStorage").getSessionTable();return b.get(a).then(function(a){return a?a.session:null})};e.bulkGetSession=function(a){var b=d("WAWebSignalStorage").getSessionTable();return b.bulkGet(a).then(function(a){return a.map(function(a){return a?a.session:null})})};e.putIdentity=function(a,b){var c=d("WAWebSignalStorage").getIdentityTable();return c.createOrReplace({identifier:a,identityKey:b})};e.bulkPutIdentity=function(a){var b=d("WAWebSignalStorage").getIdentityTable();return b.bulkCreateOrReplace(a)};e.bulkGetIdentity=function(a){var b=d("WAWebSignalStorage").getIdentityTable();return b.bulkGet(a).then(function(a){return a.map(function(a){return a?a.identityKey:null})})};e.getIdentity=function(a){var b=d("WAWebSignalStorage").getIdentityTable();return b.get(a).then(function(a){return a?a.identityKey:null})};e.removeIdentity=function(a){var b=d("WAWebSignalStorage").getIdentityTable();return b.remove(a)};e.bulkRemoveIdentity=function(a){var b=d("WAWebSignalStorage").getIdentityTable();return b.bulkRemove(a)};e.getIdentityKeyWithRowId=function(a){var b=d("WAWebSignalStorage").getIdentityTable();return b.get(a).then(function(a){return a?{identityKey:a.identityKey,rowId:a.rowId,sentAddonRowId:a.sentAddonRowId}:null})};e.bulkGetIdentityKeyWithRowId=function(a){var b=d("WAWebSignalStorage").getIdentityTable();return b.bulkGet(a).then(function(a){return a.map(function(a){return a?{identityKey:a.identityKey,rowId:a.rowId}:null})})};e.bulkPutIdentityKeyWithRowId=function(a){var b=d("WAWebSignalStorage").getIdentityTable();return b.bulkCreateOrReplace(a)};e.saveBaseKey=function(a,b,c){var e=d("WAWebSignalStorage").getBaseKeyTable();return e.createOrReplace({address:a,originalMsgId:b,baseKey:c})};e.loadBaseKey=function(a,b){var c=d("WAWebSignalStorage").getBaseKeyTable();return c.equals(["address","originalMsgId"],[a,b]).then(function(a){return a&&a.length!==0?a[0].baseKey:null})};e.deleteBaseKey=function(a,b){var c=d("WAWebSignalStorage").getBaseKeyTable();return c.equals(["address","originalMsgId"],[a,b]).then(function(a){if(a&&a.length!==0)return c.remove(a[0].id)})};e.putSenderKey=function(a,b,c){var e=d("WAWebSignalStorage").getSenderKeyTable();return e.createOrReplace({senderKeyName:a,senderId:b,senderKey:c})};e.bulkPutSenderKey=function(a){var b=d("WAWebSignalStorage").getSenderKeyTable();return b.bulkCreateOrReplace(a)};e.removeSenderKey=function(a){var b=d("WAWebSignalStorage").getSenderKeyTable();return b.remove(a)};e.getSenderKey=function(a){var b=d("WAWebSignalStorage").getSenderKeyTable();return b.get(a).then(function(a){return a?a.senderKey:null})};e.removeSenderKeyBySenderId=function(a){var b=d("WAWebSignalStorage").getSenderKeyTable();return b.equals(["senderId"],a).then(function(a){return b.bulkRemove(a.map(function(a){return a.senderKeyName}))})};e.clearCredential=function(){var a;a=[(a=d("WAWebSignalStorage")).getIdentityTable(),a.getMetaTable(),a.getPreKeyTable(),a.getSessionTable(),a.getSignedPreKeyTable()];return(h||(h=b("Promise"))).all(a.map(function(a){return a.clear()})).then(c("WAWebNoop"))};e.getRegistrationInfo=function(){var a=this;return this.registrationInfo!=null?(h||(h=b("Promise"))).resolve(this.registrationInfo):(h||(h=b("Promise"))).all([this.getMeta(d("WAWebSignalConst").META_KEYS.REG_ID),this.getMeta(d("WAWebSignalConst").META_KEYS.STATIC_PUBKEY),this.getMeta(d("WAWebSignalConst").META_KEYS.STATIC_PRIVKEY)]).then(function(c){var e=c[0],f=c[1];c=c[2];if(!e||!f||!c)return;return(h||(h=b("Promise"))).all([d("WAWebSignalCommonUtils").decryptRegistrationMaterial(f),d("WAWebSignalCommonUtils").decryptRegistrationMaterial(c)]).then(function(b){var c=b[0];b=b[1];a.registrationInfo={registrationId:e,identityKeyPair:{pubKey:c,privKey:b}};return a.registrationInfo})})};e.setRegistrationInfo=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=this;yield (h||(h=b("Promise"))).all([d("WAWebSignalCommonUtils").encryptRegistrationMaterial(a.identityKeyPair.pubKey),d("WAWebSignalCommonUtils").encryptRegistrationMaterial(a.identityKeyPair.privKey)]).then(function(e){var f=e[0];e=e[1];return(h||(h=b("Promise"))).all([c.putMeta([{key:d("WAWebSignalConst").META_KEYS.REG_ID,value:a.registrationId},{key:d("WAWebSignalConst").META_KEYS.STATIC_PUBKEY,value:f},{key:d("WAWebSignalConst").META_KEYS.STATIC_PRIVKEY,value:e}])])})});function c(b){return a.apply(this,arguments)}return c}();e.getOrGenPreKeys=function(a,c){var e=this;return d("WAWebSignalStorageUtils").getStorage().lock(["signal-meta-store","prekey-store"],function(){return(h||(h=b("Promise"))).all([e.getMeta(d("WAWebSignalConst").META_KEYS.FIRST_UNUPLOAD_PK_ID),e.getMeta(d("WAWebSignalConst").META_KEYS.NEXT_PK_ID)]).then(function(f){var g=f[0];f=f[1];var l=g?g:j;g=f?f:j;f=g-l;var m=a-f;if(m<=0){d("WALogger").LOG(i(),f,a);return e.getPreKeysByRange(l,a)}f=k(g,g+m).map(function(a){return c(a)});return(h||(h=b("Promise"))).all(f).then(function(a){return e.savePreKeys(a)}).then(function(){return e.getPreKeysByRange(l,a)})})})};e.getOrGenSinglePreKey=function(a){return this.getOrGenPreKeys(1,a).then(function(a){if(a.length!==1)throw c("err")("Expected to get exactly one key but got "+a.length);return a[0]})};e.savePreKeys=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return;var c=a[a.length-1];yield (h||(h=b("Promise"))).all([this.putMeta([{key:d("WAWebSignalConst").META_KEYS.NEXT_PK_ID,value:c.keyId+1}]),this.putPreKeys(a)])});function c(b){return a.apply(this,arguments)}return c}();e.markKeyAsUploaded=function(a){var e=this;return(h||(h=b("Promise"))).all([this.getMeta(d("WAWebSignalConst").META_KEYS.FIRST_UNUPLOAD_PK_ID),this.getMeta(d("WAWebSignalConst").META_KEYS.NEXT_PK_ID)]).then(function(b){var f=b[0];b=b[1];if(a<0||!b||a>=b)throw c("err")("markKeyAsUploaded: key "+a+" is out of boundary.");b=f?Math.max(f,a+1):a+1;return e.putMeta([{key:d("WAWebSignalConst").META_KEYS.FIRST_UNUPLOAD_PK_ID,value:b}])})};e.rotateSignedPreKey=function(a,b){var c=this;return d("WAWebSignalStorageUtils").getStorage().lock(["signal-meta-store","signed-prekey-store"],function(){return c.getMeta(d("WAWebSignalConst").META_KEYS.LAST_SPK_ID).then(function(e){var f=e==null?j:e+1;return b(a,f).then(function(a){c.putSignedPreKeys([a]);c.putMeta([{key:d("WAWebSignalConst").META_KEYS.LAST_SPK_ID,value:f}]);return a})})})};return a}();function k(a,b){var c=[];for(a=a;a<b;a++)c.push(a);return c}e=new a();g.waSignalStore=e}),98);
__d("WAWebDigestKeyJob",["Promise","WABase64","WADeprecatedSendIq","WADeprecatedWapParser","WALogger","WAWap","WAWebSignalStoreApi","WAWebUploadPreKeysJob","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["validateLocalKeyBundle: success"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["digestKey: validate key bundle failed, upload prekeys again"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["digestKey: server error ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["digestKey: service unavailable"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["digestKey: malformed request"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["digestKey: no record found for current user"]);n=function(){return a};return a}var o=32,p=new(c("WADeprecatedWapParser"))("digestResponseParser",function(a){a=a.child("digest");var b=a.child("skey");return{regId:a.child("registration").contentUint(4),type:a.child("type").contentUint(1),identity:a.child("identity").contentBytes(32),skey:{id:b.child("id").contentUint(3),pubkey:b.child("value").contentBytes(32),signature:b.child("signature").contentBytes(64)},keys:a.child("list").mapChildren(function(a){return a.contentUint(3)}),hash:a.child("hash").contentBytes(20)}});function a(){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a;a=(a=d("WAWap")).wap("iq",{xmlns:"encrypt",type:"get",to:a.S_WHATSAPP_NET,id:a.generateId()},a.wap("digest",null));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(a,p));var b;if(a.success)try{yield r(a.result),b=!1}catch(a){b=!1}else{a=a.errorCode;a===404?(d("WALogger").WARN(n()),b=!0):a===406?(d("WALogger").WARN(m()),b=!1):a===503?(d("WALogger").WARN(l()),b=!1):(d("WALogger").WARN(k(),a),b=!1)}if(b!=null&&b){d("WALogger").LOG(j());return d("WAWebUploadPreKeysJob").uploadPreKeys()}});return q.apply(this,arguments)}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=(yield (h||(h=b("Promise"))).all([d("WAWebSignalStoreApi").waSignalStore.getRegistrationInfo(),d("WAWebSignalStoreApi").waSignalStore.getSignedPreKey()])),f=e[0];e=e[1];if(!f||!e)throw c("err")("validateLocalKeyBundle: No registration info is available");if(a.regId!==f.registrationId)throw c("err")("validateLocalKeyBundle: registation id mismatch");f=f.identityKeyPair.pubKey;var g=e.keyPair.pubKey,j=f.byteLength+g.byteLength+e.signature.byteLength+a.keys.length*o,k=new Uint8Array(j),l=0;[f,g,e.signature].forEach(function(a){k.set(new Uint8Array(a),l),l+=a.byteLength});j=a.keys.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebSignalStoreApi").waSignalStore.getPreKeyById(a));if(!b)throw c("err")("validateLocalKeyBundle: missing prekey record for id "+a);return b.keyPair.pubKey});return function(b){return a.apply(this,arguments)}}());f=(yield h.all(j));f.forEach(function(a){k.set(new Uint8Array(a),l),l+=a.byteLength});g=(yield self.crypto.subtle.digest("SHA-1",k));e=d("WABase64").encodeB64(g);j=d("WABase64").encodeB64(a.hash);if(e!==j)throw c("err")("validateLocalKeyBundle: hash mismatch remote:"+j+" local:"+e);d("WALogger").LOG(i())});return s.apply(this,arguments)}g.digestKey=a}),98);
__d("WAWebGetIdentityKeysJob",["WADeprecatedSendIq","WADeprecatedWapParser","WALogger","WAWap","WAWebCommsWapMd","WAWebCryptoCurve25519","WAWebJidToWid","WAWebSignalCommonUtils","WAWebSignalProtocolStore","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["getAndStoreIdentityKeys: query "," missing keys for "," contacts"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["getAndStoreIdentityKeys: got 0 missing keys"]);i=function(){return a};return a}var j=new(c("WADeprecatedWapParser"))("identityKeysParser",function(a){return a.child("list").mapChildren(function(a){if(a.hasChild("error")){var b=a.child("error"),e=b.attrInt("code");b=b.attrString("text");throw c("err")("identityKeysParser bad response: "+e+" "+b)}else return{type:a.child("type").contentBytes(1),identity:a.child("identity").contentBytes(32),user:d("WAWebJidToWid").deviceJidToDeviceWid(a.attrDeviceJid("jid"))}})});function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebSignalProtocolStore").getPersistSignalProtocolStore().bulkLoadIdentityKey(a.map(function(a){return String(d("WAWebSignalCommonUtils").createSignalAddressForIdentityTable(a))}))),c=a.filter(function(a,c){return b[c]==null});if(c.length===0){d("WALogger").LOG(i());return}d("WALogger").LOG(h(),c.length,a.length);a=(yield l(c));c=a.map(function(a){var b=a.identity;b=d("WAWebCryptoCurve25519").toSignalCurvePubKey(b.buffer.slice(b.byteOffset,b.byteLength+b.byteOffset));b=d("WAWebSignalCommonUtils").bufferToStr(b);a=d("WAWebSignalCommonUtils").createSignalAddressForIdentityTable(a.user);return{identityKey:b,identifier:a.toString()}});return d("WAWebSignalProtocolStore").getPersistSignalProtocolStore().bulkCreateIdentity(c)});return k.apply(this,arguments)}function l(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;a=a.map(function(a){return d("WAWap").wap("user",{jid:d("WAWebCommsWapMd").DEVICE_JID(a)})});b=(b=d("WAWap")).wap("iq",{xmlns:"encrypt",type:"get",to:b.S_WHATSAPP_NET,id:b.generateId()},b.wap("identity",null,a));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(b,j));if(!a.success)throw c("err")("getIdentityKeys bad response "+String(a));return a.result});return m.apply(this,arguments)}g.getAndStoreIdentityKeys=a}),98);
__d("WAWebRotateKeyJob",["WADeprecatedSendIq","WADeprecatedWapParser","WALogger","WAWap","WAWebCryptoCurve25519","WAWebDefinePersistedJob","WAWebDigestKeyJob","WAWebSignalKeyApi","WAWebSignalStoreApi","WAWebSignalUtilsApi","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["rotateKey unrecognized error ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["rotateKey server error ",", wait a day"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["skey does not pass server validation"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["rotateKey generated bad key"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["rotateKey: signedPreKey uploading"]);l=function(){return a};return a}var m=new(c("WADeprecatedWapParser"))("rotateKeyResponseParser",function(a){a.assertFromServer()});a=d("WAWebDefinePersistedJob").defineWebPersistedJob().step("uploadKeys",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a,b=(yield d("WAWebSignalStoreApi").waSignalStore.getRegistrationInfo().then(function(a){if(!a)throw c("err")("No registration info is available");return d("WAWebSignalStoreApi").waSignalStore.rotateSignedPreKey(d("WAWebCryptoCurve25519").toSignalCurveKeyPair(a.identityKeyPair),d("WAWebSignalKeyApi").generateSignedKeyPair)}));d("WALogger").LOG(l());a=(a=d("WAWap")).wap("iq",{xmlns:"encrypt",type:"set",to:a.S_WHATSAPP_NET,id:a.generateId()},a.wap("rotate",null,d("WAWebSignalUtilsApi").xmppSignedPreKey(b)));b=(yield d("WADeprecatedSendIq").deprecatedSendIq(a,m));if(b.success)return{shouldDigestKey:!1};a=!1;b=b.errorCode;b===406?d("WALogger").WARN(k()):b===409?(d("WALogger").WARN(j()),a=!0):b>=500?d("WALogger").LOG(i(),b):(d("WALogger").LOG(h(),b),a=!0);return{shouldDigestKey:a}})).finalStep("maybeDigestKey",function(a){a=a.shouldDigestKey;if(a)return d("WAWebDigestKeyJob").digestKey()}).end();g.rotateKey=a}),98);
__d("WAWebUploadPreKeysJob",["Promise","WAComms","WADeprecatedSendIq","WADeprecatedWapParser","WALogger","WAPromiseRetryLoop","WAWap","WAWebConstantsDeprecated","WAWebServerPropsModel","WAWebSignalKeyApi","WAWebSignalStoreApi","WAWebSignalUtilsApi","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["_uploadPreKeys: disconnected, unclear if on server: "," (count: ",", size: ","b)"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["_uploadPreKeys: unrecognized error "," (count: ",", size: ","b)"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["_uploadPreKeys: uploaded invalid keys (count: ",", size: ","b)"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["_uploadPreKeys: server requested backoff "," (count: ",", size: ","b)"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["_uploadPreKeys: "," keys uploaded, raw stanza size: ","b"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["uploadPreKeys: retrying (after delay)"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["uploadPreKeys: done"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["uploadPreKeys: running"]);p=function(){return a};return a}var q={error:!1,result:!0},r=new(c("WADeprecatedWapParser"))("uploadPreKeyResParser",function(a){a.assertTag("iq");a.assertFromServer();var b=a.attrEnum("type",q);if(b)return{success:!0};b=a.child("error");return{errorCode:b.attrInt("code"),errorText:b.hasAttr("text")?b.attrString("text"):""}});function s(){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=d("WAWebServerPropsModel").ServerProps.maxKeys,e=(yield (h||(h=b("Promise"))).all([d("WAWebSignalStoreApi").waSignalStore.getRegistrationInfo(),d("WAWebSignalStoreApi").waSignalStore.getSignedPreKey()])),f=e[0],g=e[1];if(!f||!g)throw c("err")("No signal info is available");var n=f.registrationId,o=f.identityKeyPair;e=(yield d("WAWebSignalStoreApi").waSignalStore.getOrGenPreKeys(a,d("WAWebSignalKeyApi").generatePreKeyPair).then(function(a){if(a.length===0)throw c("err")("No preKey is available");return[d("WAWap").wap("iq",{id:d("WAWap").generateId(),xmlns:"encrypt",type:"set",to:d("WAWap").S_WHATSAPP_NET},d("WAWap").wap("registration",null,d("WAWap").BIG_ENDIAN_CONTENT(n)),d("WAWap").wap("type",null,c("WAWebConstantsDeprecated").KEY_BUNDLE_TYPE),d("WAWap").wap("identity",null,o.pubKey),d("WAWap").wap("list",null,a.map(d("WAWebSignalUtilsApi").xmppPreKey)),d("WAWebSignalUtilsApi").xmppSignedPreKey(g)),a[a.length-1].keyId]}));var p=e[0],q=e[1];try{f=(yield d("WAComms").waitForConnection().then(function(){return d("WAWebSignalStoreApi").waSignalStore.markKeyAsUploaded(q)}).then(function(){return d("WADeprecatedSendIq").deprecatedSendIqWithoutRetry(p,r)}));if(f.success){d("WAWebSignalStoreApi").waSignalStore.setServerHasPreKeys(!0);d("WALogger").LOG(m(),a,p.toString().length);return{success:!0}}e=f.errorCode;e>=500?d("WALogger").WARN(l(),e,a,p.toString().length):e===406?d("WALogger").WARN(k(),a,p.toString().length):d("WALogger").WARN(j(),e,a,p.toString().length);return{errorCode:f.errorCode,errorText:f.errorText}}catch(b){d("WALogger").WARN(i(),b,a,p.toString().length);return}});return t.apply(this,arguments)}var u={algo:{type:"fibonacci",first:1e3,second:2e3},max:61e4};function a(){var a=new(d("WAPromiseRetryLoop").PromiseRetryLoop)({name:"uploadPreKeys",timer:u,code:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(p());var b=(yield s());(b==null?void 0:b.success)===!0?(d("WALogger").LOG(o()),a()):d("WALogger").LOG(n())});function c(b){return a.apply(this,arguments)}return c}()});a.start();return a.promise()}g.uploadPreKeyResParser=r;g.uploadPreKeys=a}),98);
__d("WAWebHandleMsgMetaUtils",["WAWebHandleMsgCommon","WAWebMsgType"],(function(a,b,c,d,e,f,g){b=function(a){return(a==null?void 0:a.type)===d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.reaction};c=function(a){return(a==null?void 0:a.type)===d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.poll&&(a==null?void 0:a.pollType)===d("WAWebHandleMsgCommon").POLL_TYPES.vote};var h=function(a){return(a==null?void 0:a.type)===d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.text&&(a==null?void 0:a.threadMsgId)!=null&&(a==null?void 0:a.threadMsgSenderJid)!=null};e=function(a){return(a==null?void 0:a.type)===d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.event&&(a==null?void 0:a.eventType)===d("WAWebHandleMsgCommon").EVENT_TYPES.response};f=function(a){return(a==null?void 0:a.type)===d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.event&&(a==null?void 0:a.eventType)===d("WAWebHandleMsgCommon").EVENT_TYPES.edit};function a(a){if(a==null)return;if(h(a))return d("WAWebMsgType").MSG_TYPE.COMMENT}g.isReactionMsgMeta=b;g.isPollVoteMsgMeta=c;g.isCommentMsgMeta=h;g.isEventResponseMsgMeta=e;g.isEventEditMsgMeta=f;g.getMsgTypeFromMsgMeta=a}),98);
__d("WAWebSendAggregateDeliveryReceipts",["$InternalEnum","Promise","WAWebBackendApi","WAWebCmd","WAWebDBMsgUtils","WAWebHandleMsgMetaUtils","WAWebMsgProcessingApiUtils","WAWebPollsVotesSchema","WAWebSchemaReactions","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=b("$InternalEnum").Mirrored(["Message","Reaction","PollVote","NotSupportedAddon"]),j=function(a){if(a.hasHideFailEnc){if(d("WAWebHandleMsgMetaUtils").isPollVoteMsgMeta(a.msgMeta))return i.PollVote;return d("WAWebHandleMsgMetaUtils").isReactionMsgMeta(a.msgMeta)?i.Reaction:i.NotSupportedAddon}return i.Message};function k(a){var b=new Map();a.forEach(function(a){var c,d=j(a);c=(c=b.get(d))!=null?c:b.set(d,[]).get(d);c==null?void 0:c.push(a)});return b}function l(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=a.map(function(a){a=a.msgInfo;return d("WAWebMsgProcessingApiUtils").messageInfoToKey(a)});b=d("WAWebCmd").Cmd.isMainStreamReadyMd?yield b(a):a.map(function(){return!1});var e=new Set(),f=[];for(b of b.entries()){var g=b[0],h=b[1];h?e.add(a[g].toString()):f.push(a[g].toString())}if(f.length===0)return e;h=(yield c(f));return new Set([].concat(Array.from(e),Array.from(h)))});return m.apply(this,arguments)}function n(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){switch(a){case i.Message:return l(c,function(a){return d("WAWebBackendApi").frontendSendAndReceive("hasMsgsInCollection",{msgKeys:a})},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Set();return d("WAWebDBMsgUtils").getMsgsExistByMsgKey(a).then(function(c){for(c of c.entries()){var d=c[0],e=c[1];e&&b.add(a[d])}return b})});return function(b){return a.apply(this,arguments)}}());case i.Reaction:return l(c,function(a){return d("WAWebBackendApi").frontendSendAndReceive("hasReactionsInCollection",{msgKeys:a})},function(a){var b=new Set();return d("WAWebSchemaReactions").getReactionsTable().anyOf(["msgKey"],a).then(function(a){for(a of a)b.add(a.msgKey);return b})});case i.PollVote:return l(c,function(a){return d("WAWebBackendApi").frontendSendAndReceive("hasPollVotesInCollection",{msgKeys:a})},function(a){return d("WAWebPollsVotesSchema").getTable().anyOf(["msgKey"],a,{shouldDecrypt:!1}).then(function(a){var b=new Set();for(a of a)b.add(a.msgKey);return b})});case i.NotSupportedAddon:a=new Set();for(c of c){var e=c.msgInfo;a.add(d("WAWebMsgProcessingApiUtils").messageInfoToKey(e).toString())}return a}});return o.apply(this,arguments)}function p(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a[0];a=a[1];var c=[],e=[];for(a of a)a.msgReceivedTimes>1?c.push({isInDB:!0,receipt:a}):e.push(a);if(e.length>0){var f=(yield n(b,e));c=c.concat(e.map(function(a){return{isInDB:f.has(d("WAWebMsgProcessingApiUtils").messageInfoToKey(a.msgInfo).toString()),receipt:a}}))}return c});return q.apply(this,arguments)}function a(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c;a=k(a);a=(yield (h||(h=b("Promise"))).all(Array.from(a.entries()).map(p)));return(c=[]).concat.apply(c,a)});return r.apply(this,arguments)}g.aggregateDeliveryReceipts=a}),98);
__d("WAWebUnknownStanzaWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({UnknownStanza:[3448,{unknownStanzaTag:[1,d("WAWebWamCodegenUtils").TYPES.STRING],unknownStanzaType:[2,d("WAWebWamCodegenUtils").TYPES.STRING]},[1,1,1],"regular"]},{UnknownStanza:[]});g.UnknownStanzaWamEvent=a}),98);
__d("WAWebPostUnknownStanzaMetric",["WAWebUnknownStanzaWamEvent"],(function(a,b,c,d,e,f,g){function a(a){new(d("WAWebUnknownStanzaWamEvent").UnknownStanzaWamEvent)({unknownStanzaTag:a.tag,unknownStanzaType:(a=a.attrs.type)==null?void 0:a.toString()}).commit()}g.postUnknownStanzaMetric=a}),98);
__d("WAWebCreateNackFromStanza",["$InternalEnum","WALogger","WAWap","WAWebPostUnknownStanzaMetric"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendNack called with unsupported stanza tag: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["createNackFromStanza: failed with unhandled reason: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["createNackFromStanza: failed for class: '","' type: '","' id: '","' reason: '","'"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["createNackFromStanza: failed: 'id' or 'form' is null for class: '","' type: '","' reason: '","'"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["createNackFromStanza: class: '","' type: '","' id: '","' reason: '","'"]);l=function(){return a};return a}var m=b("$InternalEnum")({ParsingError:487,UnrecognizedStanza:488,UnrecognizedStanzaClass:489,UnrecognizedStanzaType:490,InvalidProtobuf:491,InvalidHostedCompanionStanza:493,MissingMessageSecret:495,SignalErrorOldCounter:496,MessageDeletedOnPeer:499,UnhandledError:500,UnsupportedAdminRevoke:550,UnsupportedLIDGroup:551,DBOperationFailed:552});function a(a,b){var c,e,f=a==null?void 0:a.tag;c=a==null?void 0:(c=a.attrs)==null?void 0:c.id;e=a==null?void 0:(e=a.attrs)==null?void 0:(e=e.type)==null?void 0:e.toString();var g=m.getName(b);try{var h;d("WALogger").LOG(l(),f,e,c,g);if(c!=null&&(a==null?void 0:(h=a.attrs)==null?void 0:h.from)!=null)return n(a,b);d("WALogger").ERROR(k(),f,e,g);d("WAWebPostUnknownStanzaMetric").postUnknownStanzaMetric(a)}catch(a){d("WALogger").ERROR(j(),f,e,c,g);d("WALogger").ERROR(i(),(h=a.message)!=null?h:a).sendLogs("send-nack-exception")}return"NO_ACK"}function n(a,b){var c=a.attrs;if(b===m.UnrecognizedStanza)return d("WAWap").wap("ack",{"class":a.tag,id:c.id,to:c.from,type:c.type||d("WAWap").DROP_ATTR,participant:c.participant||d("WAWap").DROP_ATTR,error:d("WAWap").INT(b)});switch(a.tag){case"notification":return d("WAWap").wap("ack",{"class":"notification",id:c.id,to:c.from,type:c.type||d("WAWap").DROP_ATTR,participant:c.participant||d("WAWap").DROP_ATTR,error:d("WAWap").INT(b)});case"message":return d("WAWap").wap("ack",{"class":"message",id:c.id,to:c.from,type:c.type||d("WAWap").DROP_ATTR,participant:c.participant||d("WAWap").DROP_ATTR,error:d("WAWap").INT(b)});case"receipt":return d("WAWap").wap("ack",{"class":"receipt",id:c.id,to:c.from,type:c.type||d("WAWap").DROP_ATTR,participant:c.participant||d("WAWap").DROP_ATTR,error:d("WAWap").INT(b)});default:d("WALogger").WARN(h(),a.tag).sendLogs("unsupported-nack");d("WAWebPostUnknownStanzaMetric").postUnknownStanzaMetric(a);return"NO_ACK"}}g.NackReason=m;g.createNackFromStanza=a}),98);
__d("WAWebHandleMsgSendAck",["WADeprecatedSendIq","WALogger","WAWap","WAWebABProps","WAWebCommsWapMd","WAWebCreateNackFromStanza","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendNack: InvalidProtobuf error is missing e2eFailureReason"]);h=function(){return a};return a}function a(a,b,c,e){d("WADeprecatedSendIq").deprecatedCastStanza(d("WAWap").wap("ack",{id:d("WAWap").CUSTOM_STRING(a),"class":"message",from:d("WAWebCommsWapMd").DEVICE_JID(d("WAWebUserPrefsMeUser").assertGetMe()),to:b?d("WAWebCommsWapMd").JID(b):d("WAWap").DROP_ATTR,participant:e?d("WAWebCommsWapMd").DEVICE_JID(e):d("WAWap").DROP_ATTR,type:(a=c)!=null?a:d("WAWap").DROP_ATTR}))}function b(a,b,c,e,f,g){var i=null;d("WAWebABProps").getABPropConfigValue("send_invalid_protobuf_nack_failure_reason")&&f===d("WAWebCreateNackFromStanza").NackReason.InvalidProtobuf&&(g!=null?i=d("WAWap").wap("meta",{failure_reason:d("WAWap").INT(g)}):d("WALogger").ERROR(h()).sendLogs("invalid-protobuf-nack-missing-failure-reason"));d("WADeprecatedSendIq").deprecatedCastStanza(d("WAWap").wap("ack",{id:d("WAWap").CUSTOM_STRING(a),"class":"message",from:d("WAWebCommsWapMd").DEVICE_JID(d("WAWebUserPrefsMeUser").assertGetMe()),to:b?d("WAWebCommsWapMd").JID(b):d("WAWap").DROP_ATTR,participant:e?d("WAWebCommsWapMd").DEVICE_JID(e):d("WAWap").DROP_ATTR,type:(g=c)!=null?g:d("WAWap").DROP_ATTR,error:d("WAWap").INT(f)},i))}g.sendAck=a;g.sendNack=b}),98);
__d("WAWebPendingMessageKey",[],(function(a,b,c,d,e,f){function a(a,b,c){c=c.map(function(a){return String(a.e2eType)+":"+a.retryCount}).join(",");return a.toString()+"_"+b.toString()+"_"+c}f.createPendingMessageKey=a}),66);
__d("WAWebMessageDedupUtils",["WALogger","WAWebABProps","WAWebPendingMessageKey"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[message-dedup] message cache cleared, total: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[message-dedup] message "," is pending, total: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[message-dedup] add message: ",", total: ",""]);j=function(){return a};return a}var k=new Map();function a(){return d("WAWebABProps").getABPropConfigValue("web_pending_message_cache_enabled")}function b(){return d("WAWebABProps").getABPropConfigValue("web_message_dedup_enabled")}function c(a,b,c){a=d("WAWebPendingMessageKey").createPendingMessageKey(a,b,c);c=((b=k.get(a))!=null?b:0)+1;k.set(a,c);d("WALogger").LOG(j(),a,c);return c}function e(a,b,c){a=d("WAWebPendingMessageKey").createPendingMessageKey(a,b,c);b=k.get(a);if(b==null)return!1;d("WALogger").LOG(i(),a,b);return!0}function f(a){a===0&&(k.size>0&&d("WALogger").LOG(h(),k.size),k.clear())}g.isPengingMessageCacheEnabled=a;g.isMessageDedupEnabled=b;g.addPendingMessage=c;g.hasPendingMessage=e;g.maybeClearPendingMessages=f}),98);
__d("WAWebSendOfflineDeliveryReceiptJob",["Promise","WAComms","WALogger","WATimeUtils","WAWebCreateNackFromStanza","WAWebHandleMsgSendAck","WAWebMessageDedupUtils","WAWebPostIncomingMessageDropMetric","WAWebSchemaDanglingReceipt","WAWebSendAggregateDeliveryReceipts","WAWebSendReceiptJobCommon","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendAggregateOfflineReceipts: duplicate message does not exist in the db: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendAggregateOfflineReceipts: duplicate message exists in the db: ",""]);j=function(){return a};return a}function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[];if(a.length===0)return b;a=(yield d("WAWebSendAggregateDeliveryReceipts").aggregateDeliveryReceipts(a));for(a of a){var c=a.receipt,e=a.isInDB,f=c.externalId,g=c.from,h=c.author,k=c.msgMeta,l=c.msgInfo;c=c.enc;var m=g.isUser()||g.isNewsletter()?null:h;e?(d("WALogger").LOG(j(),f),void d("WAWebPostIncomingMessageDropMetric").postIncomingMessageDropDuplicateMessage({msgMeta:k,msgInfo:l,enc:c}),d("WAWebMessageDedupUtils").isPengingMessageCacheEnabled()?d("WAWebHandleMsgSendAck").sendAck(f,g,k.type,m):b.push({externalId:f,from:g,author:h})):(d("WALogger").LOG(i(),f),void d("WAWebPostIncomingMessageDropMetric").postIncomingMessageDropOldCounter({msgMeta:k,msgInfo:l,enc:c}),d("WAWebHandleMsgSendAck").sendNack(f,g,k.type,m,d("WAWebCreateNackFromStanza").NackReason.SignalErrorOldCounter))}return b});return l.apply(this,arguments)}function a(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=[],e=[];for(a of a){var f=a.receiptInfo,g=a.duplicateMsgReceiptInfo;g!=null&&e.push(g);f!=null&&c.push(f)}c=c.concat(yield k(e));var i=new Map(),j=[];c.forEach(function(a){var b=a.from,c=a.author;a=a.externalId;var d=i.get(b);d||(d=new Map(),i.set(b,d));var e=d.get(c);e||(e=[],d.set(c,e));e.push(a);j.push({from:String(b),author:String(c),externalId:a})});var l=d("WAWebUserPrefsMeUser").getMeUser(),m=String(d("WATimeUtils").unixTime());void (h||(h=b("Promise"))).all(Array.from(i.keys()).map(function(a){var b=i.get(a);if(!b)return;var c=a.isUser()&&l.equals(d("WAWebWidFactory").toUserWid(a));return d("WAWebSendReceiptJobCommon").sendAggregateReceipts({to:a,type:c?d("WAWebSendReceiptJobCommon").RECEIPT_TYPE.SENDER:d("WAWebSendReceiptJobCommon").RECEIPT_TYPE.DELIVERY,t:m,groupedReceipt:b,recipient:c?l:null})}));d("WAComms").cancelDeadSocketTimer();j.length>0&&(yield d("WAWebSchemaDanglingReceipt").getTable().create({receipts:j,acks:[]}))});return m.apply(this,arguments)}g.handleDuplicateMsgReceipts=k;g.sendAggregateOfflineReceipts=a}),98);
__d("WAUseCaseSecret",["$InternalEnum","WABinary","WACryptoHkdf"],(function(a,b,c,d,e,f,g){"use strict";c=b("$InternalEnum")({POLL_VOTE:"Poll Vote",ENC_REACTION:"Enc Reaction",ENC_COMMENT:"Enc Comment",REPORT_TOKEN:"Report Token",EVENT_RESPONSE:"Event Response",EVENT_EDIT_ENCRYPTED:"Event Edit"});var h=32;function a(a){var b=a.messageSecret,c=a.stanzaId,e=a.parentMsgOriginalSender,f=a.modificationSender;a=a.modificationType;c=d("WABinary").Binary.build(c,e,f,a).readBuffer();return d("WACryptoHkdf").extractAndExpand(b instanceof ArrayBuffer?new Uint8Array(b):b,c,h)}g.UseCaseSecretModificationType=c;g.createUseCaseSecret=a}),98);
__d("WAWebWamEnumMessageSecretAllowedType",[],(function(a,b,c,d,e,f){a=Object.freeze({MESSAGE_POLL:0,MESSAGE_EDIT:1,REACTION:2,COMMENT:3,EVENT_RESPONSE:4,MESSAGE_EVENT_EDIT:5,MESSAGE_REPORTING_TOKEN:6});f.MESSAGE_SECRET_ALLOWED_TYPE=a}),66);
__d("WAWebWamEnumMessageSecretErrorType",[],(function(a,b,c,d,e,f){a=Object.freeze({MISSING_MESSAGE_SECRET:0,WRONG_LENGTH:1,ENCRYPTION_ERROR:2,DECRYPTION_ERROR:3});f.MESSAGE_SECRET_ERROR_TYPE=a}),66);
__d("WAWebMessageSecretErrorsWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMediaType","WAWebWamEnumMessageSecretAllowedType","WAWebWamEnumMessageSecretErrorType"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({MessageSecretErrors:[3686,{messageMediaType:[3,d("WAWebWamEnumMediaType").MEDIA_TYPE],messageSecretAllowedList:[1,d("WAWebWamEnumMessageSecretAllowedType").MESSAGE_SECRET_ALLOWED_TYPE],messageSecretError:[2,d("WAWebWamEnumMessageSecretErrorType").MESSAGE_SECRET_ERROR_TYPE]},[1,1,1],"regular"]},{MessageSecretErrors:[]});g.MessageSecretErrorsWamEvent=a}),98);
__d("WAWebProtobufsReporting.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};a.internalDefaults={minVersion:1};a.internalSpec={minVersion:[1,(e=d("WAProtoConst")).TYPES.UINT32],maxVersion:[2,e.TYPES.UINT32],notReportableMinVersion:[3,e.TYPES.UINT32],never:[4,e.TYPES.BOOL]};b.internalSpec={field:[1,e.TYPES.MAP,[e.TYPES.UINT32,c]],version:[2,e.TYPES.UINT32]};c.internalDefaults={minVersion:1};c.internalSpec={minVersion:[1,e.TYPES.UINT32],maxVersion:[2,e.TYPES.UINT32],notReportableMinVersion:[3,e.TYPES.UINT32],isMessage:[4,e.TYPES.BOOL],subfield:[5,e.TYPES.MAP,[e.TYPES.UINT32,c]]};g.ReportableSpec=a;g.ConfigSpec=b;g.FieldSpec=c}),98);
__d("WAWebReportingTokenConfig",["WAWebProtobufsReporting.pb","decodeProtobuf"],(function(a,b,c,d,e,f,g){function h(a){a=atob(a);var b=a.length,c=new Uint8Array(new ArrayBuffer(b));for(var d=0;d<b;d++)c[d]=a.charCodeAt(d);return c}var i="CgQIARIACjQIAxIwKgQIAhIAKgQIAxIAKgQICBIAKgQICxIAKhAIERIMKgQIFRIAKgQIFhIAKgQIGRIACiIIBhIeKgQIARIAKhAIERIMKgQIFRIAKgQIFhIAKgQIHhIACi4IBxIqKgQIAhIAKgQIBxIAKgQIChIAKhAIERIMKgQIFRIAKgQIFhIAKgQIFBIACi4ICBIqKgQIAhIAKgQIBxIAKgQICRIAKhAIERIMKgQIFRIAKgQIFhIAKgQIFRIACjQICRIwKgQIAhIAKgQIBhIAKgQIBxIAKgQIDRIAKhAIERIMKgQIFRIAKgQIFhIAKgQIFBIACi4IGhIqKgQIBBIAKgQIBRIAKgQICBIAKgQIDRIAKhAIERIMKgQIFRIAKgQIFhIACgwIJRIIKgYIARICIAEKDAg1EggqBggBEgIgAQ==",j=function(){function a(a){var b=a.fieldNumber,c=a.isMessage;c=c===void 0?!1:c;a=a.subfields;this.fieldNumber=b;this.isMessage=c;this.subfields=a}var b=a.prototype;b.isExtractWholeField=function(){return this.subfields==null||this.subfields.fieldsToFrank.size===0};return a}(),k=function(){function a(a){var b=this;this.fieldsToFrank=new Map();a==null?void 0:a.forEach(function(a){b.fieldsToFrank.set(a.fieldNumber,a)})}var b=a.prototype;b.getConfigForField=function(a){return this.fieldsToFrank.get(a)||null};return a}();function l(a,b,c){var d=c.minVersion,e=c.maxVersion;e=e===void 0?Infinity:e;var f=c.subfield;c=c.isMessage;if(a<d||a>e)return null;if(f==null)return new j({fieldNumber:b,isMessage:c});var g=[];f.forEach(function(b,c){c=l(a,c,b);c!=null&&g.push(c)});return new j({fieldNumber:b,isMessage:c,subfields:new k(g)})}var m=new Map();function a(a){var b=m.get(a);if(b!=null)return b;b=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsReporting.pb").ConfigSpec,h(i));var c=[];(b=b.field)==null?void 0:b.forEach(function(b,d){d=l(a,d,b);d!=null&&c.push(d)});b=new k(c);m.set(a,b);return b}g.getBytesFromBase64=h;g.REPORTING_TOKEN_CONFIG_BASE64=i;g.FieldToExtract=j;g.ReportingTokenConfig=k;g.getReportingTokenConfig=a}),98);
__d("WAWebReportingTokenProtobufUtils",["WABinary"],(function(a,b,c,d,e,f,g){function a(a){return a&7}function b(a){return a>>>3}function c(a){var b=new(d("WABinary").Binary)();b.writeVarInt(a);return b.readByteArray()}g.getWireTypeFromTag=a;g.getFieldNumberFromTag=b;g.convertToVarInt=c}),98);
__d("WAWebReportingTokenContent",["WABinary","WAProtoConst","WAWebReportingTokenProtobufUtils","err"],(function(a,b,c,d,e,f,g){var h=function(a){this.value=a;a=d("WAWebReportingTokenProtobufUtils").convertToVarInt(a);this.size=a.length},i=function(){function a(a,b){this.valLengthSize=0;a=new(d("WABinary").Binary)(a);a.advance(b);var e=a.readVarInt(d("WABinary").parseInt64OrThrow);if(e<0||e>=4294967296)throw c("err")("Invalid tag value, out of bound: "+e);var f=d("WAWebReportingTokenProtobufUtils").getWireTypeFromTag(e);this.tag=new h(e);var g=0,i=new(d("WABinary").Binary)();i.writeVarInt(e);switch(f){case d("WAProtoConst").ENC.VARINT:e=a.readVarInt(d("WABinary").parseUint64OrThrow);i.writeVarInt(e);break;case d("WAProtoConst").ENC.BINARY:e=a.readVarInt(d("WABinary").parseUint64OrThrow);var j=a.readByteArray(e);g+=d("WAWebReportingTokenProtobufUtils").convertToVarInt(e).length;i.writeVarInt(e);i.writeByteArray(j);this.valLengthSize=g;break;case d("WAProtoConst").ENC.BIT64:e=a.readByteArray(8);i.writeByteArray(e);break;case d("WAProtoConst").ENC.BIT32:j=a.readByteArray(4);i.writeByteArray(j);break;default:throw c("err")("Unsupported wire type "+f)}this.bytes=i.readByteArray();this.start=b;this.end=b+this.bytes.length}var b=a.prototype;b.getFieldNumber=function(){return d("WAWebReportingTokenProtobufUtils").getFieldNumberFromTag(this.tag.value)};b.getWireType=function(){return d("WAWebReportingTokenProtobufUtils").getWireTypeFromTag(this.tag.value)};b.getTotalSize=function(){return this.bytes.length};b.getValueStartIdx=function(){return this.start+this.tag.size+this.valLengthSize};b.getValueEndIdx=function(){return this.end};b.getBytes=function(){return this.bytes};return a}(),j=function(){function a(a,b,c){this.tag=a,this.partsLength=b,this.parts=c,this.partsLengthInBytes=d("WAWebReportingTokenProtobufUtils").convertToVarInt(this.partsLength)}var b=a.prototype;b.getFieldNumber=function(){return d("WAWebReportingTokenProtobufUtils").getFieldNumberFromTag(this.tag.value)};b.getTotalSize=function(){return this.tag.size+this.partsLengthInBytes.length+this.parts.getTotalSize()};b.getBytes=function(){var a=new(d("WABinary").Binary)();a.writeVarInt(this.tag.value);a.writeVarInt(this.partsLength);for(var b=this.parts.fields,c=Array.isArray(b),e=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(c){if(e>=b.length)break;f=b[e++]}else{e=b.next();if(e.done)break;f=e.value}f=f;a.writeByteArray(f.getBytes())}return a.readByteArray()};return a}(),k=function(){function a(){this.fields=[],this.totalSize=0}var b=a.prototype;b.add=function(a){this.fields.push(a),this.totalSize+=a.getTotalSize()};b.getTotalSize=function(){return this.totalSize};return a}();a=function(){function a(a,b){this.protobufMessage=a,this.messageConfig=b}var b=a.prototype;b.extractProtobufParts=function(a,b,c,e){var f=new k();if(e==null)return f;b=b;while(b<c){var g=new i(a,b),h=e.getConfigForField(g.getFieldNumber());b+=g.getTotalSize();if(h==null)continue;if(h.isMessage===!0||!h.isExtractWholeField()){if(g.getWireType()===d("WAProtoConst").ENC.BINARY){h=this.extractProtobufParts(a,g.getValueStartIdx(),g.getValueEndIdx(),h.isMessage===!0?this.messageConfig:h.subfields);h.fields.length>0&&f.add(new j(g.tag,h.getTotalSize(),h))}}else f.add(g)}f.fields.sort(function(a,b){return a.getFieldNumber()-b.getFieldNumber()});return f};b.getReportingTokenContent=function(){var a=this.extractProtobufParts(this.protobufMessage,0,this.protobufMessage.length,this.messageConfig);a=a.fields;var b=new(d("WABinary").Binary)();for(var a=a,c=Array.isArray(a),e=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(c){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;b.writeByteArray(f.getBytes())}return b.readByteArray()};return a}();g.ReportingTokenContentCalculator=a}),98);
__d("WAWebWamEnumReportingTokenValidationFailureReason",[],(function(a,b,c,d,e,f){a=Object.freeze({MISSING_MESSAGE_SECRET:0,EMPTY_REPORTING_TOKEN_CONTENT:1,MISMATCH_REPORTING_TOKEN:2,UNSUPPORTED_VERSION:3});f.REPORTING_TOKEN_VALIDATION_FAILURE_REASON=a}),66);
__d("WAWebReportingTokenUtils",["WABase64","WABinary","WACryptoHkdf","WACryptoHmac","WACryptoUtils","WAJids","WALogger","WAUseCaseSecret","WAWap","WAWebCreateNackFromStanza","WAWebMessageInsertDebugPlaceholder","WAWebMessagePluginGenerateReportingTokenContent","WAWebMessageSecretErrorsWamEvent","WAWebMessagingGatingUtils","WAWebMsgGetters","WAWebProtobufsE2E.pb","WAWebReportingTokenConfig","WAWebReportingTokenContent","WAWebUserPrefsMeUser","WAWebWamEnumMessageSecretAllowedType","WAWebWamEnumMessageSecretErrorType","WAWebWamEnumReportingTokenValidationFailureReason","WAWebWamMsgUtils","WAWebWamReportingTokenMismatchReporter","WAWebWid","WAWebWidToJid","asyncToGeneratorRuntime","encodeProtobuf"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["unexpected exception in validating reporting token info: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Franking tag doesn't match for message ","-",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["reporting token content cannot be empty for validating reporting token info. Message: ","-",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["remoteJid cannot be null for validating reporting token info"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["senderWid cannot be null for validating reporting token info"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["message secret cannot be null for validating reporting token info"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["unexpected exception in generating reporting token body: ",""]);n=function(){return a};return a}var o=16,p=32,q=6,r=7,s={DEFAULT:1,HISTORY_SYNC:-1},t={sampling:.01},u={sampling:1};function v(a){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.messageSecret,c=a.stanzaId,e=a.senderJid;a=a.remoteJid;c=d("WABinary").Binary.build(c,e,a,d("WAUseCaseSecret").UseCaseSecretModificationType.REPORT_TOKEN).readBuffer();return d("WACryptoHkdf").extractAndExpand(b instanceof ArrayBuffer?new Uint8Array(b):b,c,p)});return w.apply(this,arguments)}function x(a){return d("WAJids").extractFromJid(d("WAWebWidToJid").widToJidWithType(A(a)))}function y(a){a=d("WAWebWidToJid").widToJidWithType(a.id.remote);return{jidType:a.jidType,remoteJid:d("WAJids").extractFromJid(a)}}function a(a){var b;if(a.encFilehash==null&&a.caption==null)return null;b=new Uint8Array(d("WABase64").decodeB64((b=a.encFilehash)!=null?b:""));a=new TextEncoder().encode((a=a.caption)!=null?a:"");var c=new Uint8Array(b.length+a.length);c.set(b);c.set(a,b.length);return self.crypto.getRandomValues(new Uint8Array(c.length))}function e(a,b){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{var c;if(!(d("WAWebMessagingGatingUtils").isReportingTokenSendingEnabled()&&d("WAWebMessagePluginGenerateReportingTokenContent").isMsgTypeReportingTokenCompatible(a.type,a.subtype)))return null;c=(c=b.messageContextInfo)==null?void 0:c.messageSecret;var e=d("WAWebMsgGetters").getSender(a),f=y(a),g=f.jidType;f=f.remoteJid;if(g==="interopUser")return null;if(c==null){new(d("WAWebMessageSecretErrorsWamEvent").MessageSecretErrorsWamEvent)({messageSecretAllowedList:d("WAWebWamEnumMessageSecretAllowedType").MESSAGE_SECRET_ALLOWED_TYPE.MESSAGE_REPORTING_TOKEN,messageMediaType:d("WAWebWamMsgUtils").getWamMediaType(a),messageSecretError:d("WAWebWamEnumMessageSecretErrorType").MESSAGE_SECRET_ERROR_TYPE.MISSING_MESSAGE_SECRET}).commit();return null}if(e==null||f==null)return null;g=d("WAWebMessagingGatingUtils").getSenderReportingTokenVersion();c=(yield v({messageSecret:c,stanzaId:a.id.id,senderJid:d("WAWebWidToJid").widToUserJid(e),remoteJid:f}));a=d("encodeProtobuf").encodeProtobuf(d("WAWebProtobufsE2E.pb").MessageSpec,b);e=new(d("WAWebReportingTokenContent").ReportingTokenContentCalculator)(a.readByteArray(),d("WAWebReportingTokenConfig").getReportingTokenConfig(g)).getReportingTokenContent();if(e.length===0)return null;b=(yield d("WACryptoHmac").hmacSha256(new Uint8Array(c),(f=e)!=null?f:new Uint8Array(0),o));return d("WAWap").wap("reporting",null,d("WAWap").wap("reporting_token",{v:d("WAWap").CUSTOM_STRING(String(g))},new Uint8Array(b)))}catch(a){d("WALogger").WARN(n(),a).tags("messaging","wa-ice","report-token").sendLogs("report-token-unexpected-exception",t);return null}});return z.apply(this,arguments)}function A(a){var b=d("WAWebMsgGetters").getBroadcastId(a);if(b!=null)return b;b=a.id.remote;if(!c("WAWebWid").isUser(b))return b;return c("WAWebWid").isLid(b)?d("WAWebUserPrefsMeUser").getMeLidUser():d("WAWebUserPrefsMeUser").getMeUser()}function f(a,b,c,d,e){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f){try{if(!d("WAWebMessagingGatingUtils").isReportingTokenReceivingEnabled())return{res:!0,reportingTokenContent:null};if(e==null||Object.keys(e).length===0)return{res:!0,reportingTokenContent:null};if(e.reportingTag==null)return{res:!0,reportingTokenContent:null};b=e.reportingToken;e=(e=e.version)!=null?e:s.DEFAULT;if(b==null)return{res:!0,reportingTokenContent:null};if(!d("WAWebMessagePluginGenerateReportingTokenContent").isMsgTypeReportingTokenCompatible(a.type,a.subtype))return{res:!0,reportingTokenContent:null};var g=d("WAWebMsgGetters").getSender(a),n=x(a),p=a.messageSecret;if(p==null){d("WALogger").ERROR(m()).tags("messaging","wa-ice","report-token").sendLogs("report-token-null-message-secret",u);d("WAWebWamReportingTokenMismatchReporter").logReportingTokenValidationEvent({msg:a,reason:d("WAWebWamEnumReportingTokenValidationFailureReason").REPORTING_TOKEN_VALIDATION_FAILURE_REASON.MISSING_MESSAGE_SECRET,isMessageRetry:f});return{res:!1,reportingTokenContent:null}}if(g==null){d("WALogger").ERROR(l()).tags("messaging","wa-ice","report-token").sendLogs("report-token-null-sender",u);d("WAWebWamReportingTokenMismatchReporter").logReportingTokenValidationEvent({msg:a,reason:d("WAWebWamEnumReportingTokenValidationFailureReason").REPORTING_TOKEN_VALIDATION_FAILURE_REASON.MISSING_MESSAGE_SECRET,isMessageRetry:f});return{res:!1,reportingTokenContent:null}}if(n==null){d("WALogger").ERROR(k()).tags("messaging","wa-ice","report-token").sendLogs("report-token-null-remote",u);d("WAWebWamReportingTokenMismatchReporter").logReportingTokenValidationEvent({msg:a,reason:d("WAWebWamEnumReportingTokenValidationFailureReason").REPORTING_TOKEN_VALIDATION_FAILURE_REASON.MISSING_MESSAGE_SECRET,isMessageRetry:f});return{res:!1,reportingTokenContent:null}}p=(yield v({messageSecret:p,stanzaId:a.id.id,senderJid:d("WAWebWidToJid").widToUserJid(g),remoteJid:n}));g=new(d("WAWebReportingTokenContent").ReportingTokenContentCalculator)(c,d("WAWebReportingTokenConfig").getReportingTokenConfig(e)).getReportingTokenContent();if(g.length===0){d("WALogger").ERROR(j(),a.type,a.subtype).tags("messaging","wa-ice","report-token").sendLogs("report-token-empty-reporting-token-content",u);d("WAWebWamReportingTokenMismatchReporter").logReportingTokenValidationEvent({msg:a,reason:d("WAWebWamEnumReportingTokenValidationFailureReason").REPORTING_TOKEN_VALIDATION_FAILURE_REASON.EMPTY_REPORTING_TOKEN_CONTENT,isMessageRetry:f});return{res:!1,reportingTokenContent:null}}c=new Uint8Array(yield d("WACryptoHmac").hmacSha256(new Uint8Array(p),(n=g)!=null?n:new Uint8Array(0),o));n=d("WACryptoUtils").uint8ArraysEqual(c,(p=b.subarray(0,32))!=null?p:new Uint8Array(0));n||(d("WALogger").ERROR(i(),a.type,a.subtype).tags("messaging","wa-ice","report-token").sendLogs("report-token-mismatch",u),e>d("WAWebMessagingGatingUtils").getSenderReportingTokenVersion()?d("WAWebWamReportingTokenMismatchReporter").logReportingTokenValidationEvent({msg:a,reason:d("WAWebWamEnumReportingTokenValidationFailureReason").REPORTING_TOKEN_VALIDATION_FAILURE_REASON.UNSUPPORTED_VERSION,isMessageRetry:f}):d("WAWebWamReportingTokenMismatchReporter").logReportingTokenValidationEvent({msg:a,reason:d("WAWebWamEnumReportingTokenValidationFailureReason").REPORTING_TOKEN_VALIDATION_FAILURE_REASON.MISMATCH_REPORTING_TOKEN,isMessageRetry:f}));return{res:n,reportingTokenContent:g}}catch(a){d("WALogger").ERROR(h(),a).tags("messaging","wa-ice","report-token").sendLogs("report-token-unexpected-exception",t);return{res:!1,reportingTokenContent:null}}});return B.apply(this,arguments)}g.REPORTING_TOKEN_STORAGE_SIZE=q;g.REPORTING_TOKEN_INVALID_STORAGE_SIZE=r;g.REPORTING_TOKEN_VERSION=s;g.genReportingTokenKeyFromMessageSecret=v;g.getRemoteJidOnReceiverSide=x;g.getRemoteJidOnSenderSide=y;g.getMediaReportingTokenContent=a;g.genReportingTokenBody=e;g.getReportingTokenRemoteWid=A;g.validateReportingTokenInfo=f}),98);
__d("WAWebMexUpdateTextStatusJobMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{alias:null,args:[{kind:"Variable",name:"text_status_input",variableName:"input"}],concreteType:"XWA2TextStatusMutationResponse",kind:"LinkedField",name:"xwa2_update_text_status",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebMexUpdateTextStatusJobMutation",selections:b,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebMexUpdateTextStatusJobMutation",selections:b},params:{id:"6995196977195668",metadata:{},name:"WAWebMexUpdateTextStatusJobMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("WAWebTextStatusParseUtils",["WAWebWidFactory"],(function(a,b,c,d,e,f,g){var h=0;function a(a){var b;return{id:d("WAWebWidFactory").createWid(a.jid),textStatusString:a.text,textStatusEmoji:(b=a.emoji)==null?void 0:b.content,textStatusEphemeralDuration:a.ephemeral_duration_sec,textStatusLastUpdateTime:a.last_update_time!=null?Number(a.last_update_time):void 0}}function b(a){return{jid:a.id.toJid(),last_update_time:(a=a.textStatusLastUpdateTime)==null?void 0:a.toString()}}function c(a){var b=a.textStatusString;a.textStatusString===""&&(b=null);var c=a.textStatusEphemeralDuration;c==null&&(c=h);b==null&&a.textStatusEmoji==null&&c!==h&&(c=h);var d;a.textStatusEmoji!=null&&(d={content:a.textStatusEmoji});return{text:b,emoji:d,ephemeral_duration_sec:c}}g.parseTextStatusServerResponse=a;g.createTextStatusObjectForGetRequest=b;g.createTextStatusObjectForUpdateRequest=c}),98);
__d("WAWebMexUpdateTextStatusJob",["WALogger","WAWebMexClient","WAWebMexUpdateTextStatusJobMutation.graphql","WAWebTextStatusParseUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[MEX][TEXTSTATUS] Updated text status via mex"]);i=function(){return a};return a}function a(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){var f=h!==void 0?h:h=b("WAWebMexUpdateTextStatusJobMutation.graphql");a=d("WAWebTextStatusParseUtils").createTextStatusObjectForUpdateRequest({textStatusString:a,textStatusEmoji:c,textStatusEphemeralDuration:e});c={input:a};e=(yield d("WAWebMexClient").fetchQuery(f,c));d("WALogger").DEV(i()).tags("GQL","MEX").devConsole({response:e});return e});return j.apply(this,arguments)}g.mexUpdateTextStatus=a}),98);
__d("WAWebMexUsyncQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={defaultValue:null,kind:"LocalArgument",name:"include_about_status"},b={defaultValue:null,kind:"LocalArgument",name:"include_username"},c={defaultValue:null,kind:"LocalArgument",name:"input"},d=[{kind:"Variable",name:"input",variableName:"input"}],e={alias:null,args:null,kind:"ScalarField",name:"jid",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},h={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null}],type:"XWA2ResponseStatus",abstractKey:null},i={condition:"include_username",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"username_info",plural:!1,selections:[f,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null},g,{alias:null,args:null,kind:"ScalarField",name:"pin",storageKey:null}],type:"XWA2Username",abstractKey:null},h],storageKey:null}]};g={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},g],type:"XWA2AboutStatus",abstractKey:null};return{fragment:{argumentDefinitions:[a,b,c],kind:"Fragment",metadata:null,name:"WAWebMexUsyncQuery",selections:[{alias:null,args:d,concreteType:null,kind:"LinkedField",name:"xwa2_fetch_wa_users",plural:!0,selections:[e,i,{condition:"include_about_status",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"about_status_info",plural:!1,selections:[g,h],storageKey:null}]}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[c,b,a],kind:"Operation",name:"WAWebMexUsyncQuery",selections:[{alias:null,args:d,concreteType:null,kind:"LinkedField",name:"xwa2_fetch_wa_users",plural:!0,selections:[f,e,i,{condition:"include_about_status",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"about_status_info",plural:!1,selections:[f,g,h],storageKey:null}]},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"XWA2User",abstractKey:null}],storageKey:null}]},params:{id:"8278324862279817",metadata:{},name:"WAWebMexUsyncQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebMexUsync",["WAWebMexClient","WAWebMexRelayEnvironment","WAWebMexUsyncQuery.graphql","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i=h!==void 0?h:h=b("WAWebMexUsyncQuery.graphql");function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{var b=a.users.filter(function(a){a=a.jid;return d("WAWebWidFactory").createWid(a).isUser()});if(b.length){b=(yield d("WAWebMexClient").fetchQuery(i,{input:{query_input:b,telemetry:a.telemetry},include_username:a.fetch.username===!0,include_about_status:a.fetch.about_status===!0}));if(b.xwa2_fetch_wa_users!=null)return{response:b.xwa2_fetch_wa_users,error:null}}throw c("err")("[MEX][USYNC] xwa2_fetch_wa_users null")}catch(a){if(a instanceof d("WAWebMexRelayEnvironment").MexIqError)return{response:null,error:{code:a.code,text:"MexIqError:"+a.message}};if(a instanceof d("WAWebMexRelayEnvironment").MexFatalExtensionError)return{response:null,error:{code:a.error.extensions.error_code,text:"MexFatalExtensionError:"+a.error.message}};throw a}});return j.apply(this,arguments)}g.mexUsyncQuery=a}),98);
__d("WAWebMexFetchGroupInfoJobQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"query_context"}],b=[{fields:[{kind:"Variable",name:"group_id",variableName:"id"},{kind:"Variable",name:"query_context",variableName:"query_context"}],kind:"ObjectValue",name:"group_input"}],c={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"announcement_version",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"lid",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"pn",storageKey:null},h={alias:null,args:null,concreteType:"XWA2User",kind:"LinkedField",name:"creator",plural:!1,selections:[c,f,g],storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},k={alias:null,args:null,concreteType:"XWA2GroupSubject",kind:"LinkedField",name:"subject",plural:!1,selections:[h,e,j],storageKey:null};j={alias:null,args:null,concreteType:"XWA2GroupDescription",kind:"LinkedField",name:"description",plural:!1,selections:[c,e,h,j],storageKey:null};f={alias:null,args:null,concreteType:"XWA2GroupParticipantsConnection",kind:"LinkedField",name:"participants",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2GroupParticipantEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XWA2User",kind:"LinkedField",name:"node",plural:!1,selections:[c,f,g,{alias:null,args:null,kind:"ScalarField",name:"display_name",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"participants_phash_match",storageKey:null}],storageKey:null};g={alias:null,args:null,kind:"ScalarField",name:"total_participants_count",storageKey:null};var l={alias:null,args:null,kind:"ScalarField",name:"ack",storageKey:null},m={alias:null,args:null,concreteType:"XWA2GroupEphemeralSetting",kind:"LinkedField",name:"ephemeral",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"expiration_time_in_sec",storageKey:null}],storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"locked",storageKey:null},o={alias:null,args:null,concreteType:"XWA2GroupGrowthLocked",kind:"LinkedField",name:"growth_locked2",plural:!1,selections:[n],storageKey:null},p={alias:null,args:null,concreteType:"XWA2GroupLIDMigrationState",kind:"LinkedField",name:"lid_migration_state",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"addressing_mode",storageKey:null}],storageKey:null},q={alias:null,args:null,kind:"ScalarField",name:"member_add_mode",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"parent_group_jid",storageKey:null},s={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"XWA2CommunityDefaultSubGroupProperties",kind:"LinkedField",name:"properties",plural:!1,selections:[l,m,o,p,q,r],storageKey:null}],type:"XWA2CommunityDefaultSubGroup",abstractKey:null},t={alias:null,args:null,kind:"ScalarField",name:"allow_admin_reports",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"announcement",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"membership_approval_mode_enabled",storageKey:null};r={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"membership_approval_request",storageKey:null},{alias:null,args:null,concreteType:"XWA2CommunitySubGroupProperties",kind:"LinkedField",name:"properties",plural:!1,selections:[l,t,u,m,o,p,n,q,v,r,{alias:null,args:null,kind:"ScalarField",name:"general_chat",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"auto_add_disabled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hidden_group",storageKey:null}],storageKey:null}],type:"XWA2CommunitySubGroup",abstractKey:null};var w={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"num_sub_groups",storageKey:null},{alias:null,args:null,concreteType:"XWA2CommunityProperties",kind:"LinkedField",name:"properties",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"allow_non_admin_sub_group_creation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closed_by_membership_approval_mode",storageKey:null}],storageKey:null}],type:"XWA2CommunityGroup",abstractKey:null};l={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"XWA2GroupRegularGroupProperties",kind:"LinkedField",name:"properties",plural:!1,selections:[l,t,u,{alias:null,args:null,kind:"ScalarField",name:"capi",storageKey:null},m,o,p,{alias:null,args:null,kind:"ScalarField",name:"internal",storageKey:null},n,q,v,{alias:null,args:null,kind:"ScalarField",name:"support",storageKey:null}],storageKey:null}],type:"XWA2GroupRegularGroup",abstractKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebMexFetchGroupInfoJobQuery",selections:[{alias:null,args:b,concreteType:null,kind:"LinkedField",name:"xwa2_group_query_by_id",plural:!1,selections:[c,d,e,h,i,k,j,f,g,s,r,w,l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebMexFetchGroupInfoJobQuery",selections:[{alias:null,args:b,concreteType:null,kind:"LinkedField",name:"xwa2_group_query_by_id",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},c,d,e,h,i,k,j,f,g,s,r,w,l],storageKey:null}]},params:{id:"6519737481484009",metadata:{},name:"WAWebMexFetchGroupInfoJobQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebNewsletterRpcUtils",["WAExponentialBackoff","WAWebBackendErrors","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h={minTimeout:1e3,retries:3},i=new Set([429,500]);function a(a,c){c=c===void 0?{retryableErrorCodes:i}:c;var e=c.retryableErrorCodes;c=new AbortController();c=c.signal;return d("WAExponentialBackoff").exponentialBackoff(babelHelpers["extends"]({},h,{signal:c}),function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,c){try{return yield a()}catch(a){if(!(a instanceof d("WAWebBackendErrors").ServerStatusCodeError))throw a;var f=e.has(a.statusCode);if(f&&c<h.retries)return b(a);throw a}});return function(a,b){return c.apply(this,arguments)}}())}g.runWithBackoff=a}),98);
__d("WAWebMexFetchGroupInfoJob",["WALogger","WAWebMexClient","WAWebMexFetchGroupInfoJobQuery.graphql","WAWebMexGroupParseUtils","WAWebNewsletterRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[MEX][GROUP] fetched get group info for ",""]);i=function(){return a};return a}var j=h!==void 0?h:h=b("WAWebMexFetchGroupInfoJobQuery.graphql");function k(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){return d("WAWebNewsletterRpcUtils").runWithBackoff(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield d("WAWebMexClient").fetchQuery(j,{id:a,query_context:c}));d("WALogger").LOG(i(),a).tags("GQL","MEX").devConsole({response:b});return b}))});return l.apply(this,arguments)}function a(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=d("WAWebMexGroupParseUtils").toMexQueryContext(b);a=(yield k(a,b));if(a==null)return;return d("WAWebMexGroupParseUtils").parseMexGroupResponse(a)});return m.apply(this,arguments)}g.mexGetGroupInfo=a}),98);
__d("WAWebMexFetchSubgroupSuggestionsJobQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={defaultValue:null,kind:"LocalArgument",name:"group_id"},b={defaultValue:null,kind:"LocalArgument",name:"query_context"},c={defaultValue:null,kind:"LocalArgument",name:"sub_group_hint_id"},d=[{fields:[{kind:"Variable",name:"group_id",variableName:"group_id"},{kind:"Variable",name:"query_context",variableName:"query_context"},{kind:"Variable",name:"sub_group_hint",variableName:"sub_group_hint_id"}],kind:"ObjectValue",name:"group_input"}],e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},g=[f],h={alias:null,args:null,concreteType:"XWA2GroupSubject",kind:"LinkedField",name:"subject",plural:!1,selections:g,storageKey:null},i={alias:null,args:null,concreteType:"XWA2User",kind:"LinkedField",name:"creator",plural:!1,selections:[e],storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"total_participants_count",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"is_existing_group",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"hidden_group",storageKey:null};return{fragment:{argumentDefinitions:[a,b,c],kind:"Fragment",metadata:null,name:"WAWebMexFetchSubgroupSuggestionsJobQuery",selections:[{alias:null,args:d,concreteType:null,kind:"LinkedField",name:"xwa2_group_query_by_id",plural:!1,selections:[e,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"XWA2CommunitySubGroupSuggestionConnection",kind:"LinkedField",name:"sub_group_suggestions",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2CommunitySubGroupSuggestionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XWA2CommunitySubGroupSuggestion",kind:"LinkedField",name:"node",plural:!1,selections:[e,h,{alias:null,args:null,concreteType:"XWA2GroupDescription",kind:"LinkedField",name:"description",plural:!1,selections:g,storageKey:null},i,j,k,l,m],storageKey:null}],storageKey:null}],storageKey:null}],type:"XWA2CommunityGroup",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,c,b],kind:"Operation",name:"WAWebMexFetchSubgroupSuggestionsJobQuery",selections:[{alias:null,args:d,concreteType:null,kind:"LinkedField",name:"xwa2_group_query_by_id",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},e,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"XWA2CommunitySubGroupSuggestionConnection",kind:"LinkedField",name:"sub_group_suggestions",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2CommunitySubGroupSuggestionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XWA2CommunitySubGroupSuggestion",kind:"LinkedField",name:"node",plural:!1,selections:[e,h,{alias:null,args:null,concreteType:"XWA2GroupDescription",kind:"LinkedField",name:"description",plural:!1,selections:[f,e],storageKey:null},i,j,k,l,m],storageKey:null}],storageKey:null}],storageKey:null}],type:"XWA2CommunityGroup",abstractKey:null}],storageKey:null}]},params:{id:"8049169471838505",metadata:{},name:"WAWebMexFetchSubgroupSuggestionsJobQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebMexFetchSubgroupSuggestionsJob",["Promise","WALogger","WAWebBackendErrors","WAWebMexClient","WAWebMexFetchSubgroupSuggestionsJobQuery.graphql","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[MEX][COMMUNITY] Fetched subgroup suggestions for ",""]);j=function(){return a};return a}var k=h!==void 0?h:h=b("WAWebMexFetchSubgroupSuggestionsJobQuery.graphql");function a(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){e={group_id:a.toString(),query_context:e,sub_group_hint_id:c.toString()};try{c=(yield d("WAWebMexClient").fetchQuery(k,e));e=(e=c.xwa2_group_query_by_id)==null?void 0:(e=e.sub_group_suggestions)==null?void 0:e.edges;if(e==null)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(500,"missing edges in response");e=e.map(function(b){b=b.node;if(b!=null)return m(a,b);throw new(d("WAWebBackendErrors").ServerStatusCodeError)(500,"null node in sub_group_suggestions")});d("WALogger").DEV(j(),a.toString()).tags("GQL","MEX").devConsole({result:c});return e}catch(a){return a instanceof d("WAWebBackendErrors").ServerStatusCodeError?(i||(i=b("Promise"))).reject(a):(i||(i=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(a.code),a.message))}});return l.apply(this,arguments)}function m(a,b){var e,f,g;if(b.is_existing_group==null)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(500,"missing is_existing_group in response");else g=b.is_existing_group;if(b.id==null)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(500,"missing id in response");else e=new(c("WAWebWid"))(b.id,{intentionallyUsePrivateConstructor:!0});if(b.creator.id==null)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(500,"missing creator.id in response");else f=new(c("WAWebWid"))(b.creator.id,{intentionallyUsePrivateConstructor:!0});return{id:e,parentGroupId:a,subject:(a=(e=b.subject)==null?void 0:e.value)!=null?a:"",desc:(e=b.description)==null?void 0:e.value,owner:f,t:parseInt(b.creation_time,10),isExistingGroup:g,participantCount:b.total_participants_count,hiddenSubgroup:b.hidden_group}}g.mexFetchSubgroupSuggestions=a}),98);
__d("WAWebMexLogNewsletterExposureJobMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"XWA2NewsletterLogExposureResponse",kind:"LinkedField",name:"xwa2_newsletter_log_exposure",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebMexLogNewsletterExposureJobMutation",selections:b,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebMexLogNewsletterExposureJobMutation",selections:b},params:{id:"7853928111369979",metadata:{},name:"WAWebMexLogNewsletterExposureJobMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("WAWebCommonNewsletterEnums",["$InternalEnum"],(function(a,b,c,d,e,f){c=(a=b("$InternalEnum"))({Subscriber:"subscriber",Admin:"admin",Guest:"guest",Owner:"owner"});d=a({Public:"public",Private:"private"});e=a({Active:"active",Suspended:"suspended",GeoSuspended:"geosuspended"});b=a({All:0,Basic:1,Blocklist:2,None:3});var g=a.Mirrored(["ALERT_BANNER","INFO_DRAWER"]),h=a.Mirrored(["GEOSUSPEND","SUSPEND","VIOLATING_MSG","PROFILE_PICTURE_DELETION","SUSPEND_INFORM"]),i=a.Mirrored(["SUSPENDED_DETAILED_SCREEN","DELETE_NEWSLETTER","VIOLATING_MESSAGES_SCREEN","PROFILE_PICTURE_DELETION_SCREEN","GEOSUSPENDED_COUNTRY_DETAILED_SCREEN","MULTIPLE_ALERTS_LIST_SCREEN","NO_ALERTS_SCREEN","REQUEST_REVIEW_DESCRIPTION_SCREEN","REQUEST_REVIEW_REASON_SCREEN","APPEAL_OUTCOME_SCREEN","REMEDIATION_OPTIONS_SCREEN","DSB_STEP1_SCREEN","DSB_STEP2_SCREEN","DSB_STEP3_SCREEN","CONTACT_IP_REPORTER_STEP1_SCREEN","CONTACT_IP_REPORTER_STEP2_SCREEN","SUSPEND_INFORM_SCREEN"]),j=a.Mirrored(["IP_SRT_VIOLATION","GENERIC_VIOLATION"]),k=a.Mirrored(["All","Unread","MyChannels"]);a=a({Insights:0});f.NewsletterMembershipType=c;f.NewsletterPrivacy=d;f.NewsletterState=e;f.NewsletterReactionCodesSetting=b;f.AlertEntryPoint=g;f.EnforcementType=h;f.AlertScreen=i;f.NewsletterDSADecisionModalCategory=j;f.NewsletterInboxFilterTypes=k;f.NewsletterCapability=a}),66);
__d("WAWebNewsletterQueryUtils",["WAJids","WAWebCommonNewsletterEnums","WAWebWid"],(function(a,b,c,d,e,f,g){function h(a){if(a==null)return"guest";switch(a){case d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin:return"admin";case d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner:return"owner";case d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Subscriber:return"subscriber";default:return"guest"}}function a(a,b,e){e=j(e);if(c("WAWebWid").isNewsletter(a))return{jidQueryOrDeprecatedInviteQueryOrInviteQueryIQPayloadMixinGroupArgs:{jidQueryIQPayload:{anyJid:d("WAJids").toNewsletterJid(a),anyViewRole:h(b),allNewsletterMetadataIQRequestPayloadMixinArgs:e}}};e.hasNewsletterMembershipField;e.hasNewsletterMutedField;e.newsletterPictureFieldMixinArgs;e=babelHelpers.objectWithoutPropertiesLoose(e,["hasNewsletterMembershipField","hasNewsletterMutedField","newsletterPictureFieldMixinArgs"]);return{jidQueryOrDeprecatedInviteQueryOrInviteQueryIQPayloadMixinGroupArgs:{inviteQueryIQPayload:babelHelpers["extends"]({anyKey:a,anyViewRole:h(b)},e,{newsletterPreviewTypePictureFieldMixinArgs:{baseNewsletterPictureFieldMixinArgs:{}}})}}}function i(){return{pictureArgs:[{pictureType:"image"},{pictureType:"preview"}]}}function j(a){return a==null?{hasNewsletterCreationTimeField:!0,hasNewsletterNameField:!0,newsletterPictureFieldMixinArgs:i(),hasNewsletterDescriptionField:!0,hasNewsletterInviteLinkField:!0,hasNewsletterHandleField:!0,hasNewsletterSubscribersField:!0,hasNewsletterPrivacyField:!0,hasNewsletterVerificationField:!0,hasNewsletterLinkedAccountsField:!0,hasNewsletterMembershipField:!0,hasNewsletterMutedField:!0,hasNewsletterStateField:!0}:{hasNewsletterCreationTimeField:a.creationTime,hasNewsletterNameField:a.name,newsletterPictureFieldMixinArgs:a.picture===!0?i():void 0,hasNewsletterDescriptionField:a.description,hasNewsletterInviteLinkField:a.inviteLink,hasNewsletterHandleField:a.handle,hasNewsletterSubscribersField:a.subscribers,hasNewsletterPrivacyField:a.privacy,hasNewsletterVerificationField:a.verification,hasNewsletterLinkedAccountsField:a.linkedAccounts,hasNewsletterMembershipField:a.membership,hasNewsletterMutedField:a.membership,hasNewsletterStateField:a.state}}function b(a){return c("WAWebWid").isNewsletter(a)?{queryNewsletterJIDParams:{anyJid:d("WAJids").toNewsletterJid(a)}}:{queryNewsletterInviteParams:{anyKey:a}}}function e(a){switch(a){case d("WAWebCommonNewsletterEnums").NewsletterCapability.Insights:return"INSIGHTS"}}g.getNewsletterMetadataQueryParamArgs=a;g.getNewsletterMetadataArgs=j;g.getNewsletterMessagesQueryParams=b;g.getNewsletterCapabilityFromEnum=e}),98);
__d("WAWebMexLogNewsletterExposureJob",["WALogger","WAWebMexClient","WAWebMexLogNewsletterExposureJobMutation.graphql","WAWebNewsletterQueryUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER] logged newsletter capability exposure"]);i=function(){return a};return a}var j=h!==void 0?h:h=b("WAWebMexLogNewsletterExposureJobMutation.graphql");function a(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c={input:{newsletter_id:a,capability:d("WAWebNewsletterQueryUtils").getNewsletterCapabilityFromEnum(b)}};c=(yield d("WAWebMexClient").fetchQuery(j,c));d("WALogger").DEV(i()).tags("GQL","MEX").devConsole({newsletterJid:a,capability:b,response:c})});return k.apply(this,arguments)}g.mexLogNewsletterExposure=a}),98);
__d("WAWebMexSetUsernameJobMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{alias:null,args:[{kind:"Variable",name:"username",variableName:"input"}],concreteType:"XWA2UsernameSetMutationResponse",kind:"LinkedField",name:"xwa2_username_set",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebMexSetUsernameJobMutation",selections:b,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebMexSetUsernameJobMutation",selections:b},params:{id:"7107616276002412",metadata:{},name:"WAWebMexSetUsernameJobMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("WAWebMexSetUsernameJob",["WALogger","WAWebMexClient","WAWebMexSetUsernameJobMutation.graphql","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[MEX][USERNAME] Successfully fetched set username mutation via mex"]);i=function(){return a};return a}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c={input:a},e=h!==void 0?h:h=b("WAWebMexSetUsernameJobMutation.graphql");e=(yield d("WAWebMexClient").fetchQuery(e,a!=null?c:{}));d("WALogger").DEV(i()).tags("GQL","MEX").devConsole({response:e});return((a=e.xwa2_username_set)==null?void 0:a.result)==="SUCCESS"});return j.apply(this,arguments)}g.mexSetUsernameQueryJob=a}),98);
__d("WAWebMexUsersGetUsername",["WAWebMexUsync","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebMexUsync").mexUsyncQuery({users:a.map(function(a){return{jid:a.toJid()}}),telemetry:{context:"INTERACTIVE"},fetch:{username:!0}}));a=a.response;if(a!=null)return a.map(function(a){return a.username_info==null?{error:!0,username:null}:{username:(a=a.username_info)==null?void 0:a.username}})});return i.apply(this,arguments)}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield h([a]));return a==null?void 0:a[0].username});return j.apply(this,arguments)}g.getMexUserUsername=a}),98);
__d("WAWebUpdateLidMetadataApi",["WAWebApiContact","WAWebBackendApi","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.updates;var b=a.map(function(a){var b=a.lid;a=a.data;return{lid:d("WAWebWidFactory").toUserWid(b),shareOwnPn:(b=a.shareOwnPn)!=null?b:null,displayNameLID:(b=a.displayNameLID)!=null?b:null,requestedPnTimestamp:(b=a.requestedPnTimestamp)!=null?b:null,username:(b=a.username)!=null?b:null}});yield d("WAWebBackendApi").frontendSendAndReceive("bulkUpdateLidContactState",{lidContactDataMappings:b});yield d("WAWebApiContact").updateLidMetadata(a)});return h.apply(this,arguments)}g.updateLidMetadata=a}),98);
__d("WAWebCreateOrReplaceDisplayNamesAndLidPnMappingsJob",["Promise","WAWebDBCreateLidPnMappings","WAWebUpdateLidMetadataApi","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=[],f=[];for(a of a){if(a==null)continue;var g=a.id;if(g.isLid()){var i=a.displayName,j=a.phoneNumber;i!=null&&e.push({lid:d("WAWebWidFactory").toUserWid(g),data:{displayNameLID:i}});j!=null&&f.push({lid:d("WAWebWidFactory").toUserWid(g),pn:d("WAWebWidFactory").toUserWid(j)})}else{i=a.lid;i!=null&&f.push({lid:d("WAWebWidFactory").toUserWid(i),pn:d("WAWebWidFactory").toUserWid(g)})}}yield (h||(h=b("Promise"))).all([e.length>0?d("WAWebUpdateLidMetadataApi").updateLidMetadata({updates:e}):null,f.length>0?d("WAWebDBCreateLidPnMappings").createLidPnMappings({mappings:f,flushImmediately:c}):null].filter(Boolean))});return i.apply(this,arguments)}g.createOrReplaceDisplayNamesAndLidPnMappings=a}),98);
__d("WAWebSetPrivacyTokensJob",["$InternalEnum","WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","WAWebCommsWapMd","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("setPrivacyTokensParser",function(a){a={stanzaId:a.attrString("id")};return a});e=b("$InternalEnum")({TrustedContact:"trusted_contact"});function a(a,b,c){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e;b=b.map(function(b){return d("WAWap").wap("token",{jid:d("WAWebCommsWapMd").USER_JID(a),t:d("WAWap").CUSTOM_STRING(String(c)),type:d("WAWap").CUSTOM_STRING(b)})});e=(yield d("WADeprecatedSendIq").deprecatedSendIq((e=d("WAWap")).wap("iq",{to:e.S_WHATSAPP_NET,type:"set",xmlns:"privacy",id:e.generateId()},e.wap("tokens",null,b)),h));if(!e.success)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(e.errorCode,e.errorText)});return i.apply(this,arguments)}g.TokenType=e;g.setPrivacyTokens=a}),98);
__d("WAWebTrustedContactsUtils",["$InternalEnum","WATimeUtils","WAWebABProps"],(function(a,b,c,d,e,f,g){var h=6*30*24*60*60,i=b("$InternalEnum")({Sender:"sender",Receiver:"receiver"});function j(a){a=a===i.Receiver?"tctoken_duration":"tctoken_duration_sender";return Math.min(d("WAWebABProps").getABPropConfigValue(a),h)}function a(a,b){return a<k(b)}function k(a){var b=a===i.Receiver?"tctoken_num_buckets":"tctoken_num_buckets_sender";b=d("WAWebABProps").getABPropConfigValue(b);a=j(a);var c=Math.floor(d("WATimeUtils").unixTime()/a);c=c-(b-1);return d("WATimeUtils").castToUnixTime(c*a)}function c(a){if(a==null)return!0;var b=d("WAWebABProps").getABPropConfigValue("tctoken_duration_sender"),c=Math.floor(d("WATimeUtils").unixTime()/b);a=Math.floor(a/b);return c>a}g.TcTokenMode=i;g.getTcTokenDuration=j;g.isTokenExpired=a;g.tokenExpirationCutoff=k;g.shouldSendNewToken=c}),98);
__d("WAWebSendTcTokenWhenDeviceIdentityChange",["WALogger","WATimeUtils","WAWebABProps","WAWebApiChat","WAWebBackendApi","WAWebRuntimeEnvironmentUtils","WAWebSetPrivacyTokensJob","WAWebTrustedContactsUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendTcTokenWhenDeviceIdentityChange failed - ",""]);h=function(){return a};return a}function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;d("WAWebRuntimeEnvironmentUtils").isWorker()||d("WAWebABProps").getABPropConfigValue("web_tc_token_db_read_enabled")?b=(yield d("WAWebApiChat").getChatRecord(a)):b=(yield d("WAWebBackendApi").frontendSendAndReceive("getChat",{chatId:a}));if(b==null)return;b=b.tcTokenSenderTimestamp;if(b==null)return;if(d("WAWebTrustedContactsUtils").isTokenExpired(b,d("WAWebTrustedContactsUtils").TcTokenMode.Sender))return;try{yield d("WAWebSetPrivacyTokensJob").setPrivacyTokens(a,[d("WAWebSetPrivacyTokensJob").TokenType.TrustedContact],d("WATimeUtils").castToUnixTime(b))}catch(a){d("WALogger").WARN(h(),a).verbose().devConsole(a).sendLogs("send-tc-token-device-identity-change-failed")}});return i.apply(this,arguments)}g.sendTcTokenWhenDeviceIdentityChange=a}),98);
__d("WAWebPrimaryFeatures",["WALogger","WAWebBackendApi","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsKeys","WAWebUserPrefsStore","asyncToGeneratorRuntime","gkx","lodash"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["primary features loaded"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["primaryFeatureEnabled: primary features have not been initialized!"]);i=function(){return a};return a}var j=null;function a(a){if(j==null){d("WALogger").ERROR(i());return!1}return j.has(a)}function e(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.PRIMARY_FEATURES,a),yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").KEYS.PRIMARY_FEATURES,a),j=new Set(m(a)),d("WAWebBackendApi").frontendFireAndForget("setPrimaryFeatures",{primaryFeatures:Array.from(j)})});return k.apply(this,arguments)}function f(){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a;a=(a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").KEYS.PRIMARY_FEATURES))!=null?a:[];a=m(a);j=new Set(a);d("WAWebBackendApi").frontendFireAndForget("setPrimaryFeatures",{primaryFeatures:a});d("WALogger").LOG(h())});return l.apply(this,arguments)}function m(a){var b,d;a=a;if(c("gkx")("26258"))return a;b=new URLSearchParams((b=window.location.search)!=null?b:"");d=((d=b.get("primary_features_enabled"))!=null?d:"").split(",").map(function(a){return c("lodash").snakeCase(a)});a=Array.from(new Set([].concat(a,d)));var e=new Set(((d=b.get("primary_features_disabled"))!=null?d:"").split(",").map(function(a){return c("lodash").snakeCase(a)}));a=a.filter(function(a){return!e.has(a)});return a}g.primaryFeatureEnabled=a;g.setPrimaryFeatures=e;g.loadPrimaryFeatures=f}),98);
__d("WAWebUsernameGatingUtils",["WAWebABProps","WAWebPrimaryFeatures"],(function(a,b,c,d,e,f,g){function a(){return Boolean(d("WAWebABProps").getABPropConfigValue("username_change"))}function b(){return Boolean(d("WAWebABProps").getABPropConfigValue("username_contact_display"))}function c(){return Boolean(d("WAWebABProps").getABPropConfigValue("username_usync"))}function e(){return Boolean(d("WAWebABProps").getABPropConfigValue("username_1on1_chat"))}function f(){return Boolean(d("WAWebABProps").getABPropConfigValue("username_creation"))}function h(){return Boolean(d("WAWebABProps").getABPropConfigValue("username_contact_display"))&&Boolean(d("WAWebABProps").getABPropConfigValue("username_1on1_chat"))&&Boolean(d("WAWebABProps").getABPropConfigValue("username_usync"))}function i(){return d("WAWebABProps").getABPropConfigValue("username_creation")&&d("WAWebPrimaryFeatures").primaryFeatureEnabled("username_supported")}function j(){return Boolean(d("WAWebABProps").getABPropConfigValue("username_security_code_generation"))}function k(){return Boolean(d("WAWebABProps").getABPropConfigValue("username_security_code_verification"))}function l(){return!1}function m(){return Boolean(d("WAWebABProps").getABPropConfigValue("mex_usync_username_query"))}g.usernameChangeEnabled=a;g.usernameDisplayedEnabled=b;g.usernameUsyncEnabled=c;g.username1on1ChatCreationEnabled=e;g.usernameCreationEnabled=f;g.usernameContactlessChatEnabled=h;g.usernameSupported=i;g.usernameSecurityCodeGenerationEnabled=j;g.usernameSecurityCodeVerificationEnabled=k;g.shouldLogUnknownNumberError=l;g.mexUsyncUsernameQueryEnabled=m}),98);
__d("WAWebUsyncBackoff",["Promise","WALogger"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["usync: "," protocol: ","ms backoff ended"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["usync: "," protocol: ","ms backoff started"]);j=function(){return a};return a}var k=new Map();function a(a,c){d("WALogger").LOG(j(),a,c),k.set(a,new(h||(h=b("Promise")))(function(a){return self.setTimeout(a,c)}).then(function(){d("WALogger").LOG(i(),a,c)}))}function c(a){return!l(a)?(h||(h=b("Promise"))).resolve():(h||(h=b("Promise"))).all(a.protocols.map(function(a){return k.get(a.getName())}))}function l(a){if(a.context==="interactive")return!1;var b=a.protocols.map(function(a){return a.getName()});return b.includes("devices")&&(a.context==="message"||a.context==="voip")?!1:!0}g.setProtocolBackoffMs=a;g.waitForBackoff=c}),98);
__d("WAWebUsyncBotProfile",["WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b;a.assertTag("bot");var c=a.maybeChild("error");if(c)return{errorCode:c.attrInt("code"),errorText:c.attrString("text")};c=a.child("profile");a=c.child("name");a=a.contentString();var d=c.child("attributes");d=d.contentString();var e=c.child("description");e=e.contentString();var f=c.child("category");f=f.contentString();var g=c.maybeChild("default");g=(g==null?void 0:g.contentString())==="true";var j=c.maybeChild("prompts");j=h(j);b=(b=c.maybeAttrString("persona_id"))!=null?b:"";var k=c.maybeChild("commands");k=i(k);var l=k.commands;k=k.commandsDescription;var m,n=c.maybeChild("is_meta_created");n&&(m=(n==null?void 0:n.contentString())==="true");var o,p;n=c.maybeChild("creator");if(n){o=(c=n.maybeChild("name"))==null?void 0:c.contentString();p=(c=n.maybeChild("profile_url"))==null?void 0:c.contentString()}return{name:a,attributes:d,description:e,category:f,isDefault:g,prompts:j,personaId:b,commands:l,commandsDescription:k,isMetaCreated:m,creatorName:o,creatorProfileUrl:p}}function h(a){if(a==null)return[];var b=[];a.forEachChildWithTag("prompt",function(a){var c=a.maybeChild("emoji");c=(c=c==null?void 0:c.contentString())!=null?c:"";a=a.maybeChild("text");a=(a=a==null?void 0:a.contentString())!=null?a:"";b.push({emoji:c,text:a})});return b}function i(a){if(a==null)return{commands:[],commandsDescription:""};var b=[],c=a.maybeChild("description");c=(c=c==null?void 0:c.contentString())!=null?c:"";a.forEachChildWithTag("command",function(a){var c=a.maybeChild("name");c=(c=c==null?void 0:c.contentString())!=null?c:"";a=a.maybeChild("description");a=(a=a==null?void 0:a.contentString())!=null?a:"";b.push({name:c,description:a})});return{commands:b,commandsDescription:c}}b=function(){function a(){}var b=a.prototype;b.getName=function(){return"bot"};b.getQueryElement=function(){return d("WAWap").wap("bot",null,d("WAWap").wap("profile",{v:"1"}))};b.getUserElement=function(a){a=a.getPersonaId();return d("WAWap").wap("bot",null,d("WAWap").wap("profile",{persona_id:a!=null?d("WAWap").CUSTOM_STRING(a):d("WAWap").DROP_ATTR}))};return a}();g.botProfileParser=a;g.USyncBotProfileProtocol=b}),98);
__d("WAWebNonEmptyString",["err"],(function(a,b,c,d,e,f,g){function a(a){if(a!=="")return a}function b(a){if(a==="")throw c("err")("Cannot convert empty string to NonEmptyString");return a}function d(a){return a!=null&&a!==""}g.asMaybeNonEmptyString=a;g.asNonEmptyString=b;g.isNonEmptyString=d}),98);
__d("WAWebProtobufsVnameCert.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){c=(a=b("$InternalEnum"))({ENTERPRISE:0});e=a({ON_PREMISE:0,FACEBOOK:1});f=a({SELF:0,BSP:1});b=a({ON_PREMISE:0,FACEBOOK:1});a=a({UNKNOWN:0,LOW:1,HIGH:2});var h={},i={},j={},k={},l={},m={};h.internalSpec={lg:[1,(d=d("WAProtoConst")).TYPES.STRING],lc:[2,d.TYPES.STRING],verifiedName:[3,d.TYPES.STRING]};i.internalSpec={details:[1,d.TYPES.BYTES],signature:[2,d.TYPES.BYTES],serverSignature:[3,d.TYPES.BYTES]};j.internalSpec={serial:[1,d.TYPES.UINT64],issuer:[2,d.TYPES.STRING],verifiedName:[4,d.TYPES.STRING],localizedNames:[8,d.FLAGS.REPEATED|d.TYPES.MESSAGE,h],issueTime:[10,d.TYPES.UINT64]};k.internalSpec={vnameCert:[1,d.TYPES.MESSAGE,i],bizAcctLinkInfo:[2,d.TYPES.BYTES]};l.internalSpec={whatsappBizAcctFbid:[1,d.TYPES.UINT64],whatsappAcctNumber:[2,d.TYPES.STRING],issueTime:[3,d.TYPES.UINT64],hostStorage:[4,d.TYPES.ENUM,e],accountType:[5,d.TYPES.ENUM,c]};m.internalSpec={vlevel:[1,d.TYPES.ENUM,a],vnameCert:[2,d.TYPES.MESSAGE,i],signed:[3,d.TYPES.BOOL],revoked:[4,d.TYPES.BOOL],hostStorage:[5,d.TYPES.ENUM,b],actualActors:[6,d.TYPES.ENUM,f],privacyModeTs:[7,d.TYPES.UINT64],featureControls:[8,d.TYPES.UINT64]};g.BizAccountLinkInfo$AccountType=c;g.BizAccountLinkInfo$HostStorageType=e;g.BizIdentityInfo$ActualActorsType=f;g.BizIdentityInfo$HostStorageType=b;g.BizIdentityInfo$VerifiedLevelValue=a;g.LocalizedNameSpec=h;g.VerifiedNameCertificateSpec=i;g.VerifiedNameCertificate$DetailsSpec=j;g.BizAccountPayloadSpec=k;g.BizAccountLinkInfoSpec=l;g.BizIdentityInfoSpec=m}),98);
__d("WAWebValidateBusinessCertificate",["WAWebProtobufsVnameCert.pb","decodeProtobuf","err"],(function(a,b,c,d,e,f,g){var h="ent:wa",i="smb:wa";function a(a){return{serial:a.serial,name:a.verifiedName,isApi:a.issuer===h,isSmb:a.issuer===i}}function b(a){if(!a)return null;a=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsVnameCert.pb").VerifiedNameCertificateSpec,a);if(!a.details)throw c("err")("verifyCertificate cert missing details");var b=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsVnameCert.pb").VerifiedNameCertificate$DetailsSpec,a.details);return{cert:a,details:b}}g.extractCertificateDetailsParams=a;g.getParsedProtoObjects=b}),98);
__d("WAWebCommonParsersVerifiedName",["WAWebHandleMsgCommon","WAWebHandleMsgTypes.flow","WAWebNonEmptyString","WAWebValidateBusinessCertificate"],(function(a,b,c,d,e,f,g){function h(a){a=d("WAWebValidateBusinessCertificate").getParsedProtoObjects(a);if(a==null?void 0:a.details){a=d("WAWebValidateBusinessCertificate").extractCertificateDetailsParams(a.details);var b=a.name,c=a.serial,e=a.isApi;a=a.isSmb;return{name:b,serial:String(c),isApi:e,isSmb:a}}}function a(a){var b=a.attrEnum("verified_level",d("WAWebHandleMsgCommon").MSG_VERIFIED_LEVEL),c=a.hasContent()?a.contentBytes():null,e=d("WAWebNonEmptyString").asMaybeNonEmptyString(a.maybeAttrString("serial"));c=c&&h(c)||{};var f=c.serial,g=c.name,i=c.isApi;c=c.isSmb;var j=d("WAWebHandleMsgTypes.flow").ActualActorsEnumType.cast(a.maybeAttrInt("actual_actors")),k=d("WAWebHandleMsgTypes.flow").HostStorageEnumType.cast(a.maybeAttrInt("host_storage"));a=a.maybeAttrInt("privacy_mode_ts");j=j!=null&&k!=null&&a!=null?{actualActors:j,hostStorage:k,privacyModeTs:a}:null;return{level:b,serial:e!=null?e:f,name:g,isApi:i===!0,isSmb:c===!0,privacyMode:j}}g["default"]=a}),98);
__d("WAWebUsyncBusiness",["WAWap","WAWebCommonParsersVerifiedName"],(function(a,b,c,d,e,f,g){function a(a){a.assertTag("business");var b=a.maybeChild("error");if(b)return{errorCode:b.attrInt("code"),errorText:b.attrString("text")};b=a.maybeChild("verified_name");a=b?c("WAWebCommonParsersVerifiedName")(b):null;return{verifiedName:a}}b=function(){function a(){}var b=a.prototype;b.getName=function(){return"business"};b.getQueryElement=function(){return d("WAWap").wap("business",null,d("WAWap").wap("verified_name",null))};b.getUserElement=function(a){return null};return a}();g.businessParser=a;g.USyncBusinessProtocol=b}),98);
__d("WAWebUsyncContact",["WAWap"],(function(a,b,c,d,e,f,g){function a(a){a.assertTag("contact");var b=a.maybeChild("error");if(b)return{errorCode:b.attrInt("code"),errorText:b.attrString("text")};b={type:a.attrString("type")};var c=a.hasAttr("username");c&&(b.username=a.attrString("username"));return b}b=function(){function a(){}var b=a.prototype;b.getName=function(){return"contact"};b.getQueryElement=function(){return d("WAWap").wap("contact",null)};b.getUserElement=function(a){var b=a.getPhone(),c=a.getUsername();a=a.getType();if(b!=null)return d("WAWap").wap("contact",null,b);else if(c!=null)return d("WAWap").wap("contact",{username:d("WAWap").CUSTOM_STRING(c)});else if(a!=null)return d("WAWap").wap("contact",{type:d("WAWap").CUSTOM_STRING(a)});return null};return a}();g.contactParser=a;g.USyncContactProtocol=b}),98);
__d("WAWebUsyncDevice",["WAWap","WAWebBizCoexGatingUtils"],(function(a,b,c,d,e,f,g){var h=2;function a(a){a.assertTag("devices");var b=a.maybeChild("error");if(b)return{errorCode:b.attrInt("code"),errorText:b.attrString("text")};b=a.maybeChild("key-index-list");a=a.maybeChild("device-list");b=b==null?null:{ts:b.attrTime("ts"),signedKeyIndexBytes:b.hasContent()?b.contentBytes():null,expectedTs:b.hasAttr("expected_ts")?b.attrTime("expected_ts"):void 0};a=a==null?void 0:a.mapChildrenWithTag("device",function(a){var b={id:a.attrInt("id"),keyIndex:a.hasAttr("key-index")?a.attrInt("key-index"):null};d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(a.hasAttr("is_hosted")&&a.attrString("is_hosted")==="true"&&(b.isHosted=!0));return b});return{deviceList:a,keyIndex:b}}b=function(){function a(){}var b=a.prototype;b.getName=function(){return"devices"};b.getQueryElement=function(){return d("WAWap").wap("devices",{version:d("WAWap").CUSTOM_STRING(String(h))})};b.getUserElement=function(a){var b=a.getDeviceHash(),c=a.getTs();a=a.getExpectedTs();return!b&&c==null&&a==null?null:d("WAWap").wap("devices",{device_hash:b?d("WAWap").CUSTOM_STRING(b):d("WAWap").DROP_ATTR,ts:c!=null?d("WAWap").INT(c):d("WAWap").DROP_ATTR,expected_ts:a!=null?d("WAWap").INT(a):d("WAWap").DROP_ATTR})};return a}();g.deviceParser=a;g.USyncDeviceProtocol=b}),98);
__d("WAWebUsyncDisappearingMode",["WAWap"],(function(a,b,c,d,e,f,g){function a(a){a.assertTag("disappearing_mode");var b=a.maybeChild("error");if(b)return{errorCode:b.attrInt("code"),errorText:b.attrString("text")};b=a.attrInt("duration",0);a=a.attrInt("t");return{duration:b,t:a}}b=function(){function a(){}var b=a.prototype;b.getName=function(){return"disappearing_mode"};b.getQueryElement=function(){return d("WAWap").wap("disappearing_mode",null)};b.getUserElement=function(a){return null};return a}();g.disappearingModeParser=a;g.USyncDisappearingModeProtocol=b}),98);
__d("WAWebUsyncFeature",["WAWap","err"],(function(a,b,c,d,e,f,g){var h={document:(b=d("WAWap")).wap("document",null),encrypt:b.wap("encrypt",null),encrypt_blist:b.wap("encrypt_blist",null),encrypt_contact:b.wap("encrypt_contact",null),encrypt_group_gen2:b.wap("encrypt_group_gen2",null),encrypt_image:b.wap("encrypt_image",null),encrypt_location:b.wap("encrypt_location",null),encrypt_url:b.wap("encrypt_url",null),encrypt_v2:b.wap("encrypt_v2",null),voip:b.wap("voip",null),multi_agent:b.wap("multi_agent",null)};function a(a){a.assertTag("feature");var b=a.maybeChild("error");if(b)return{errorCode:b.attrInt("code"),errorText:b.attrString("text")};var c={};Object.keys(h).forEach(function(b){var d=a.maybeChild(b);d&&(c[b]=d.attrString("value"))});return c}e=function(){var a=b.prototype;a.getName=function(){return"picture"};function b(a){this.queries=a;if(a.length===0)throw c("err")("must specify at least one query")}a.getQueryElement=function(){return d("WAWap").wap("feature",null,this.queries&&this.queries.map(function(a){return h[a]}))};a.getUserElement=function(a){return null};return b}();g.featureParser=a;g.USyncFeaturesProtocol=e}),98);
__d("WAWebUsyncLid",["WAWap","WAWebCommsWapMd"],(function(a,b,c,d,e,f,g){function a(a){a.assertTag("lid");var b=a.maybeChild("error");return b?{errorCode:b.attrInt("code"),errorText:b.attrString("text")}:a.maybeAttrLidUserJid("val")}b=function(){function a(){}var b=a.prototype;b.getName=function(){return"lid"};b.getQueryElement=function(){return d("WAWap").wap("lid",null)};b.getUserElement=function(a){a=a.getLid();return!a?null:d("WAWap").wap("lid",{jid:a?d("WAWebCommsWapMd").USER_JID(a):d("WAWap").DROP_ATTR})};return a}();g.lidParser=a;g.USyncLidProtocol=b}),98);
__d("WAWebUsyncPicture",["WAWap"],(function(a,b,c,d,e,f,g){function a(a){a.assertTag("picture");var b=a.maybeChild("error");return b?{errorCode:b.attrInt("code"),errorText:b.attrString("text")}:{id:a.attrInt("id")}}b=function(){function a(){}var b=a.prototype;b.getName=function(){return"picture"};b.getQueryElement=function(){return d("WAWap").wap("picture",null)};b.getUserElement=function(a){return null};return a}();g.pictureParser=a;g.USyncPictureProtocol=b}),98);
__d("WAWebUsyncStatus",["WAWap"],(function(a,b,c,d,e,f,g){var h=null;function a(a){a.assertTag("status");var b=a.maybeChild("error");if(b)return{errorCode:b.attrInt("code"),errorText:b.attrString("text")};return!a.hasContent()?a.hasAttr("code")&&a.attrInt("code")===401?"":h:a.contentString().length!==0?a.contentString():h}b=function(){function a(){}var b=a.prototype;b.getName=function(){return"status"};b.getQueryElement=function(){return d("WAWap").wap("status",null)};b.getUserElement=function(a){return null};return a}();g.statusParser=a;g.USyncStatusProtocol=b}),98);
__d("WAWebUsyncTextStatus",["WAWap"],(function(a,b,c,d,e,f,g){function a(a){a.assertTag("text_status");var b=a.maybeChild("error");if(b)return{errorCode:b.attrInt("code"),errorText:b.attrString("text")};b=a.hasAttr("text")?a.attrString("text"):void 0;var c=a.hasChild("emoji")?a.child("emoji"):void 0;c=(c==null?void 0:c.hasAttr("content"))?c==null?void 0:c.attrString("content"):void 0;var d=a.hasAttr("ephemeral_duration_sec")?a.attrInt("ephemeral_duration_sec"):void 0;a=a.hasAttr("last_update_time")?a.attrString("last_update_time"):void 0;return{text:b,emoji:c,ephemeralDurationSeconds:d,lastUpdateTime:a}}b=function(){function a(){}var b=a.prototype;b.getName=function(){return"text_status"};b.getQueryElement=function(){return d("WAWap").wap("text_status",null)};b.getUserElement=function(a){return null};return a}();g.textStatusParser=a;g.USyncTextStatusProtocol=b}),98);
__d("WAWebUsyncUsername",["WAWap"],(function(a,b,c,d,e,f,g){function a(a){a.assertTag("username");var b=a.maybeChild("error");if(b)return{errorCode:b.attrInt("code"),errorText:b.attrString("text")};return a.hasContent()?a.contentString():null}b=function(){function a(){}var b=a.prototype;b.getName=function(){return"username"};b.getQueryElement=function(){return d("WAWap").wap("username",null)};b.getUserElement=function(a){return null};return a}();g.usernameParser=a;g.USyncUsernameProtocol=b}),98);
__d("WAWebUsync",["WADeprecatedSendIq","WADeprecatedWapParser","WALogger","WAWap","WAWebCommsWapMd","WAWebJidToWid","WAWebUsyncBackoff","WAWebUsyncBotProfile","WAWebUsyncBusiness","WAWebUsyncContact","WAWebUsyncDevice","WAWebUsyncDisappearingMode","WAWebUsyncFeature","WAWebUsyncLid","WAWebUsyncPicture","WAWebUsyncStatus","WAWebUsyncTextStatus","WAWebUsyncUsername","WAWebWid","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Usync success:"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["usync: ready to query for ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Usync warning: a usync query must have at least one user"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["usync query success!"]);k=function(){return a};return a}var l={FEATURE:"feature",DEVICE:"devices",CONTACT:"contact",PICTURE:"picture",STATUS:"status",BUSINESS:"business",DISAPPEARING_MODE:"disappearing_mode",LID:"lid",BOT:"bot",USERNAME:"username",TEXT_STATUS:"text_status"},m={feature:d("WAWebUsyncFeature").featureParser,devices:d("WAWebUsyncDevice").deviceParser,contact:d("WAWebUsyncContact").contactParser,picture:d("WAWebUsyncPicture").pictureParser,status:d("WAWebUsyncStatus").statusParser,business:d("WAWebUsyncBusiness").businessParser,disappearing_mode:d("WAWebUsyncDisappearingMode").disappearingModeParser,lid:d("WAWebUsyncLid").lidParser,bot:d("WAWebUsyncBotProfile").botProfileParser,username:d("WAWebUsyncUsername").usernameParser,text_status:d("WAWebUsyncTextStatus").textStatusParser};function n(a){var b=[];a.forEachChildWithTag("user",function(a){var c={};if(!a.hasAttr("jid"))return;Object.keys(l).forEach(function(b){b=l[b];var d=a.maybeChild(b);d&&m[b]&&(c[b]=m[b](d))});c.id=d("WAWebJidToWid").deviceJidToUserWid(a.attrDeviceJid("jid"));b.push(c)});return b}var o=new(c("WADeprecatedWapParser"))("usyncParser",function(a){a.assertAttr("type","result");var b={error:{},refresh:{},list:[],sideList:[]};a=a.child("usync");var c=a.child("result"),e=a.child("list");a=a.maybeChild("side_list");Object.keys(l).forEach(function(a){a=l[a];var d=c.maybeChild(a);if(d){var e=d.maybeChild("error");e?b.error[a]={errorCode:e.attrInt("code"),errorText:e.attrString("text"),errorBackoff:e.attrInt("backoff")}:d.hasAttr("refresh")&&(b.refresh[a]=d.attrInt("refresh",0))}});b.list=n(e);a&&(b.sideList=n(a));d("WALogger").LOG(k());return b});a=function(){function a(){this.context="interactive",this.mode="query",this.protocols=[],this.users=[]}var e=a.prototype;e.withMode=function(a){this.mode=a;return this};e.withContext=function(a){this.context=a;return this};e.withContactProtocol=function(){this.protocols.push(new(d("WAWebUsyncContact").USyncContactProtocol)());return this};e.withBusinessProtocol=function(){this.protocols.push(new(d("WAWebUsyncBusiness").USyncBusinessProtocol)());return this};e.withDeviceProtocol=function(){this.protocols.push(new(d("WAWebUsyncDevice").USyncDeviceProtocol)());return this};e.withDisappearingModeProtocol=function(){this.protocols.push(new(d("WAWebUsyncDisappearingMode").USyncDisappearingModeProtocol)());return this};e.withPictureProtocol=function(){this.protocols.push(new(d("WAWebUsyncPicture").USyncPictureProtocol)());return this};e.withStatusProtocol=function(){this.protocols.push(new(d("WAWebUsyncStatus").USyncStatusProtocol)());return this};e.withTextStatusProtocol=function(){this.protocols.push(new(d("WAWebUsyncTextStatus").USyncTextStatusProtocol)());return this};e.withFeaturesProtocol=function(a){this.protocols.push(new(d("WAWebUsyncFeature").USyncFeaturesProtocol)(a));return this};e.withLidProtocol=function(){this.protocols.push(new(d("WAWebUsyncLid").USyncLidProtocol)());return this};e.withBotProfileProtocol=function(){this.protocols.push(new(d("WAWebUsyncBotProfile").USyncBotProfileProtocol)());return this};e.withUser=function(a){this.users.push(a);return this};e.withUsernameProtocol=function(){this.protocols.push(new(d("WAWebUsyncUsername").USyncUsernameProtocol)());return this};e.$1=function(){var a=this;if(this.protocols.length===0)throw c("err")("a usync query must have at least one protocol");var b=this.users.filter(function(a){var b=a.getId();return b&&c("WAWebWid").isServer(b)?!1:a.validate()});b.length===0&&d("WALogger").WARN(j());var e=d("WAWap").wap("query",null,this.protocols.map(function(a){return a.getQueryElement()}));b=b.map(function(b){var c=b.getId();return d("WAWap").wap("user",{jid:c?d("WAWebCommsWapMd").USER_JID(c):d("WAWap").DROP_ATTR},a.protocols.map(function(a){return a.getUserElement(b)}))});b=d("WAWap").wap("list",null,b);return d("WAWap").wap("iq",{to:d("WAWap").S_WHATSAPP_NET,xmlns:"usync",type:"get",id:d("WAWap").generateId()},d("WAWap").wap("usync",{sid:d("WAWap").generateId(),index:"0",last:"true",mode:d("WAWap").CUSTOM_STRING(this.mode),context:d("WAWap").CUSTOM_STRING(this.context)},e,b))};e.execute=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this.$1();d("WALogger").DEV(i(),this.protocols.map(function(a){return a.getName()}));yield d("WAWebUsyncBackoff").waitForBackoff(this);a=(yield d("WADeprecatedSendIq").deprecatedSendIq(a,o));if(a.success){d("WALogger").DEV(h()).devConsole(a.result);p(a.result);return a.result}return{error:{all:{errorCode:a.errorCode,errorText:a.errorText,errorType:a.errorType}},refresh:{},list:[]}});function c(){return a.apply(this,arguments)}return c}();return a}();function p(a){Object.values(l).forEach(function(b){var c=a.error[b];if(c==null)return;c.errorBackoff!=null&&d("WAWebUsyncBackoff").setProtocolBackoffMs(b,c.errorBackoff*1e3)})}g.USyncQuery=a}),98);
__d("WAWebUsyncUser",["WALogger","WAWebBizCoexGatingUtils","WAWebWidValidator","err"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["USync user created with invalid jid: ",""]);h=function(){return a};return a}a=function(){function a(){}var b=a.prototype;b.withId=function(a){this.$1=a;return this};b.withLid=function(a){this.$2=a;return this};b.withDeviceHash=function(a){this.$4=a;return this};b.withTs=function(a){this.$5=a;return this};b.withExpectedTs=function(a){this.$6=a;return this};b.withPhone=function(a){this.$3=a;return this};b.withPersonaId=function(a){this.$7=a;return this};b.withUsername=function(a){this.$8=a;return this};b.withType=function(a){this.$9=a;return this};b.getDeviceHash=function(){return this.$4};b.getPhone=function(){return this.$3};b.getId=function(){return this.$1};b.getLid=function(){return this.$2};b.getTs=function(){return this.$5};b.getExpectedTs=function(){return this.$6};b.getPersonaId=function(){return this.$7};b.getUsername=function(){return this.$8};b.getType=function(){return this.$9};b.validate=function(){var a=this.$1,b=this.$3,e=this.$8;if(a==null&&b==null&&e==null)throw c("err")("user must have an id, phone or a username");else if(a){b=d("WAWebWidValidator").validateWid(a.toString(),d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled());b||d("WALogger").WARN(h(),a.toString());return b}return!0};return a}();g.USyncUser=a}),98);
__d("WAWebQueryExistsJob",["WALogger","WAPhoneFindCC","WAWebABProps","WAWebApiContact","WAWebBackendErrors","WAWebDBCreateLidPnMappings","WAWebMexUsersGetUsername","WAWebSetUsernameJob","WAWebUsernameGatingUtils","WAWebUsync","WAWebUsyncUser","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[usync] username info response"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[usync] querying username: "," for contact info"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[usync] username info response"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[usync] querying contact: "," for username info"]);k=function(){return a};return a}function a(a){var b=a.isLid()?"":"+"+a.toString();return a.isLid()?l({type:"lid",wid:a}):l({type:"phone",phone:b})}function e(a){return l({type:"phone",phone:a})}function l(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.type==="lid"&&!a.wid.isLid())throw c("err")("queryExist is provided with invalid lid");var b=new(d("WAWebUsyncUser").USyncUser)(),e=new(d("WAWebUsync").USyncQuery)();a.type==="phone"?(e.withContactProtocol(),b.withPhone(a.phone)):b.withId(a.wid);e.withLidProtocol();if(a.type==="phone"){var f=d("WAPhoneFindCC").extractDigits(a.phone)+"@c.us";if(c("WAWebWid").isWid(f)){f=d("WAWebApiContact").getCurrentLid(d("WAWebWidFactory").createUserWid(f));f&&b.withLid(f)}}e.withUser(b);e.withBusinessProtocol();e.withDisappearingModeProtocol();d("WAWebUsernameGatingUtils").usernameUsyncEnabled()&&e.withUsernameProtocol();f=(yield e.execute());b=f.error.all||f.error.contact;if(b)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(b.errorCode,b.errorText);e=f.list;if(e.length!==1)return null;b=e[0];f=b.id;e=b.contact;var g=b.business,h=b.disappearing_mode,i=b.lid;b=b.username;if(a.type==="phone"&&(e==null?void 0:e.type)!=="in")return null;a={wid:f,biz:g!=null,bizInfo:g};h&&(a.disappearingMode={duration:h.duration,settingTimestamp:h.t});i!=null&&(yield d("WAWebDBCreateLidPnMappings").createLidPnMappings({mappings:[{pn:f,lid:d("WAWebWidFactory").createUserWid(i,"lid")}],flushImmediately:!0}));d("WAWebUsernameGatingUtils").usernameUsyncEnabled()&&b!=null?yield d("WAWebSetUsernameJob").setUsernamesJob([{userId:f,username:b}]):yield d("WAWebSetUsernameJob").setUsernamesJob([{userId:f,username:void 0}]);return a});return m.apply(this,arguments)}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(k(),a).devConsole({wid:a});var b=new(d("WAWebUsyncUser").USyncUser)(),c=new(d("WAWebUsync").USyncQuery)();b.withId(a);c.withUser(b);c.withUsernameProtocol();a=(yield c.execute());b=a.error.all||a.error.contact;d("WALogger").LOG(j()).devConsole({res:a,error:b});if(b)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(b.errorCode,b.errorText);c=a.list;if(c.length!==1)return null;b=c[0];if(b.id!=null)return{id:b.id,username:b.username,shouldDelete:!Object.prototype.hasOwnProperty.call(b,"username")}});return o.apply(this,arguments)}function f(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!a.isLid())return;var b,c,e;if(d("WAWebABProps").getABPropConfigValue("mex_usync_username_query")){var f=d("WAWebWidFactory").createUserWid(a.toString()),g=(yield d("WAWebMexUsersGetUsername").getMexUserUsername(f));g!=null?(b=g,c=f):e=!0}else{g=(yield n(a));g!=null&&(b=g.username,c=g.id,e=g.shouldDelete)}if(c==null)return;b!=null?yield d("WAWebSetUsernameJob").setUsernamesJob([{userId:c,username:b}]):e===!0&&(yield d("WAWebSetUsernameJob").setUsernamesJob([{userId:c,username:void 0}]));return b});return p.apply(this,arguments)}function q(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(i(),a).devConsole({queryUsername:a});var b=new(d("WAWebUsyncUser").USyncUser)(),c=new(d("WAWebUsync").USyncQuery)();c.withUser(b);c.withContactProtocol();b.withUsername(a);b=(yield c.execute());a=b.error.all||b.error.contact;d("WALogger").LOG(h()).devConsole({res:b,error:a});if(a)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode,a.errorText);c=b.list;if(c.length!==1)return null;a=c[0];b=a.id;c=a.contact;a=c.username;c=c.type;if(c==="out")return null;a!=null?yield d("WAWebSetUsernameJob").setUsernamesJob([{userId:b,username:a}]):yield d("WAWebSetUsernameJob").setUsernamesJob([{userId:b,username:void 0}]);c={wid:b,username:a,biz:!1};return c});return r.apply(this,arguments)}g.queryWidExists=a;g.queryPhoneExists=e;g.queryExist=l;g.queryWidUsernameExists=f;g.queryUsernameExists=q}),98);
__d("WAWebSetTextStatusJob",["WAWebDefinePersistedJob","WAWebUpdateTextStatusJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){a=d("WAWebDefinePersistedJob").defineWebPersistedJob().finalStep("sendMex",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.id,c=a.text,e=a.emoji;a=a.ephemeralDurationSeconds;b=(yield d("WAWebUpdateTextStatusJob").updateTextStatus(b,c,e,a));return b});return function(b){return a.apply(this,arguments)}}()).end();g.setTextStatus=a}),98);
__d("WAWebMexEventWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MexEvent:[3782,{isMex:[1,a.TYPES.BOOLEAN],mexEventData:[2,a.TYPES.STRING],mexEventDurationT:[12,a.TYPES.TIMER],mexEventEndTime:[3,a.TYPES.INTEGER],mexEventEnvelopeResponseStatus:[13,a.TYPES.INTEGER],mexEventOperation:[7,a.TYPES.STRING],mexEventPayloadResponseStatus:[14,a.TYPES.INTEGER],mexEventRequestSize:[8,a.TYPES.INTEGER],mexEventResponseSize:[9,a.TYPES.INTEGER],mexEventRetries:[10,a.TYPES.INTEGER],mexEventStartTime:[11,a.TYPES.INTEGER]},[1,1,1],"regular"]},{MexEvent:[]});g.MexEventWamEvent=b}),98);
__d("WAWebMexExperiment",["WAWebABProps","WAWebMexEventWamEvent"],(function(a,b,c,d,e,f,g){a=function(){function a(b){this.$1=!1,this.$2="not provided",this.$3=-1,this.$4=-1,this.$2=b,this.$1=a.isGraphQLenabled()}var b=a.prototype;b.toUseGraphQL=function(){return this.$1};b.start=function(){this.$3=Date.now()};b.stop=function(){this.$4=Date.now()};b.logEvent=function(b){var c=b.envelopeResponseStatus;b=b.payloadResponseStatus;if(!a.isExperimentEnabled())return;new(d("WAWebMexEventWamEvent").MexEventWamEvent)({isMex:this.$1,mexEventOperation:this.$2,mexEventStartTime:this.$3,mexEventEndTime:this.$4,mexEventPayloadResponseStatus:b,mexEventEnvelopeResponseStatus:c,mexEventRequestSize:1}).commit()};a.isExperimentEnabled=function(){return d("WAWebABProps").getABPropConfigValue("mex_phase3_enabled")};a.isGraphQLenabled=function(){return a.isExperimentEnabled()&&a.isGraphQLFlagSet()};a.isGraphQLFlagSet=function(){return a.isFlagSet(1)};a.isFlagSet=function(a){var b=d("WAWebABProps").getABPropConfigValue("mex_phase3_status_flags");return(b&a)===a};return a}();g.GraphQlPerfTracker=a}),98);
__d("WAWebUpdateTextStatusJob",["WALogger","WAWebMexExperiment","WAWebMexUpdateTextStatusJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateTextStatus:",""]);h=function(){return a};return a}function a(a,b,c,d){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=new(d("WAWebMexExperiment").GraphQlPerfTracker)("update-text-status");f.start();f.toUseGraphQL();b=(yield d("WAWebMexUpdateTextStatusJob").mexUpdateTextStatus(b,c,e));e=(c=b.xwa2_update_text_status)==null?void 0:c.result;f.stop();d("WALogger").LOG(h(),a.toString()).devConsole(b);return{id:a,result:e}});return i.apply(this,arguments)}g.updateTextStatus=a}),98);
__d("WAWebSetUsernameJob",["WAJobOrchestratorTypes","WALogger","WAWebApiContact","WAWebBackendApi","WAWebMexSetUsernameJob","WAWebOrchestratorNonPersistedJob","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[username] ",": deleting username in db + collection"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[username] ",": updating "," username in db + collection"]);i=function(){return a};return a}function a(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("setUsernameQueryJob",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield d("WAWebMexSetUsernameJob").mexSetUsernameQueryJob(a));if(b){b=d("WAWebUserPrefsMeUser").assertGetMeUser();yield j([{userId:b,username:(b=a)!=null?b:void 0}]);return!0}return!1}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(function(a){var b=a.userId;a=a.username;var c=b.toJid();d("WALogger").LOG(i(),b.toLogString(),a==null||a===""?"empty":"non-empty");return{id:c,username:a}});yield d("WAWebApiContact").bulkUpdateUsernamesInDb(a);yield d("WAWebBackendApi").frontendSendAndReceive("bulkUpdateUsernames",{usernameUpdates:a})});return k.apply(this,arguments)}function c(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(function(a){var b=a.userId;a=a.displayNameLID;var c=b.toJid();d("WALogger").LOG(h(),b.toLogString());return{id:c,username:void 0,displayNameLID:a}});yield d("WAWebApiContact").bulkUpdateUsernamesInDb(a);yield d("WAWebBackendApi").frontendSendAndReceive("bulkUpdateUsernames",{usernameUpdates:a})});return l.apply(this,arguments)}g.setUsernameQueryJob=a;g.setUsernamesJob=j;g.deleteUsernamesJob=c}),98);
__d("WAWebSyncDeviceAdvDeviceListJob",["WAJobOrchestratorTypes","WAWebAdvSyncDeviceListApi","WAWebOrchestratorNonPersistedJob"],(function(a,b,c,d,e,f,g){function a(a,b,c){a={wids:a,context:b,phash:c};return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("syncDeviceList",function(a){return d("WAWebAdvSyncDeviceListApi").syncDeviceList(a)}).waitUntilCompleted(a)}function b(){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("syncMyDeviceList",function(a){return d("WAWebAdvSyncDeviceListApi").syncMyDeviceList()},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted()}g.syncDeviceListJob=a;g.syncMyDeviceListJob=b}),98);
__d("WAWebBackendJobs.flow",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({Skmsg:"skmsg",Pkmsg:"pkmsg",Msg:"msg",Msmsg:"msmsg"});c=b("$InternalEnum")({Image:"image",Video:"video",Ptv:"ptv",Audio:"audio",Ptt:"ptt",Location:"location",VCard:"vcard",Document:"document",Url:"url",Call:"call",Gif:"gif",Future:"future",ContactArray:"contact_array",LiveLocation:"livelocation",ProfilePic:"profile_pic",Sticker:"sticker",StickerPack:"sticker_pack",Hsm:"hsm",ProductImage:"product_image",Template:"template",MdAppState:"md_app_state",MdHistorySync:"md_history_sync",List:"list",ListResponse:"list_response",Button:"button",ButtonResponse:"button_response",Order:"order",Product:"product",NativeFlowResponse:"native_flow_response"});d=b("$InternalEnum")({Hide:"hide",Show:"show"});f.CiphertextType=a;f.EncMediaType=c;f.DecryptFailType=d}),66);
__d("WAWebSignalCommonErrors",["WACustomError"],(function(a,b,c,d,e,f,g){a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(d("WACustomError").customError("SignalDecryptionError"));b=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(d("WACustomError").customError("SignalMessageCounterError"));g.SignalDecryptionError=a;g.SignalMessageCounterError=b}),98);
__d("WAWebVerifyProtobufMsgObjectKeys",["$InternalEnum","WAWebHandleMsgError","WAWebMsgType","WAWebProtobufsE2E.pb","err"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum")({Buttons:1,Template:2,SenderKeyDistribution:3,UnknownMessageKey:4});function i(a,b){switch(a){case"$$unknownFieldCount":return b[a]===0?null:d("WAWebMsgType").MSG_TYPE.UNKNOWN;case"messageContextInfo":return null;case"contactMessage":return d("WAWebMsgType").MSG_TYPE.VCARD;case"contactsArrayMessage":return d("WAWebMsgType").MSG_TYPE.MULTI_VCARD;case"conversation":case"extendedTextMessage":return d("WAWebMsgType").MSG_TYPE.CHAT;case"imageMessage":return d("WAWebMsgType").MSG_TYPE.IMAGE;case"locationMessage":case"liveLocationMessage":return d("WAWebMsgType").MSG_TYPE.LOCATION;case"documentMessage":return d("WAWebMsgType").MSG_TYPE.DOCUMENT;case"audioMessage":return d("WAWebMsgType").MSG_TYPE.AUDIO;case"videoMessage":return d("WAWebMsgType").MSG_TYPE.VIDEO;case"protocolMessage":return d("WAWebMsgType").MSG_TYPE.PROTOCOL;case"highlyStructuredMessage":return d("WAWebMsgType").MSG_TYPE.PROTOCOL;case"sendPaymentMessage":case"requestPaymentMessage":case"paymentInviteMessage":return d("WAWebMsgType").MSG_TYPE.PAYMENT;case"declinePaymentRequestMessage":case"cancelPaymentRequestMessage":return d("WAWebMsgType").MSG_TYPE.UNKNOWN;case"stickerMessage":return d("WAWebMsgType").MSG_TYPE.STICKER;case"groupInviteMessage":return d("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE;case"templateButtonReplyMessage":return d("WAWebMsgType").MSG_TYPE.TEMPLATE_BUTTON_REPLY;case"productMessage":return d("WAWebMsgType").MSG_TYPE.PRODUCT;case"listMessage":return d("WAWebMsgType").MSG_TYPE.LIST;case"orderMessage":return d("WAWebMsgType").MSG_TYPE.ORDER;case"listResponseMessage":return d("WAWebMsgType").MSG_TYPE.LIST_RESPONSE;case"buttonsResponseMessage":return d("WAWebMsgType").MSG_TYPE.BUTTONS_RESPONSE;case"interactiveMessage":return d("WAWebMsgType").MSG_TYPE.INTERACTIVE;case"interactiveResponseMessage":return d("WAWebMsgType").MSG_TYPE.INTERACTIVE_RESPONSE;case"reactionMessage":return d("WAWebMsgType").MSG_TYPE.REACTION;case"encReactionMessage":return d("WAWebMsgType").MSG_TYPE.REACTION_ENC;case"encCommentMessage":return d("WAWebMsgType").MSG_TYPE.COMMENT;case"pinInChatMessage":return d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE;case"pollCreationMessage":case"pollCreationMessageV2":case"pollCreationMessageV3":return d("WAWebMsgType").MSG_TYPE.POLL_CREATION;case"pollUpdateMessage":return d("WAWebMsgType").MSG_TYPE.POLL_UPDATE;case"keepInChatMessage":return d("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT;case"requestPhoneNumberMessage":return d("WAWebMsgType").MSG_TYPE.REQUEST_PHONE_NUMBER;case"ptvMessage":return d("WAWebMsgType").MSG_TYPE.PTV;case"callLogMesssage":return d("WAWebMsgType").MSG_TYPE.CALL_LOG;case"buttonsMessage":return h.Buttons;case"templateMessage":return h.Template;case"senderKeyDistributionMessage":case"fastRatchetKeySenderKeyDistributionMessage":return h.SenderKeyDistribution;case"newsletterAdminInviteMessage":return d("WAWebMsgType").MSG_TYPE.NEWSLETTER_ADMIN_INVITE;case"eventMessage":return d("WAWebMsgType").MSG_TYPE.EVENT_CREATION;case"encEventResponseMessage":return d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE;case"secretEncryptedMessage":return((b=b[a])==null?void 0:b.secretEncType)===d("WAWebProtobufsE2E.pb").Message$SecretEncryptedMessage$SecretEncType.EVENT_EDIT?d("WAWebMsgType").MSG_TYPE.EVENT_EDIT_ENCRYPTED:h.UnknownMessageKey;case"albumMessage":return d("WAWebMsgType").MSG_TYPE.ALBUM;case"stickerPackMessage":return d("WAWebMsgType").MSG_TYPE.STICKER_PACK;case"pollResultSnapshotMessage":return d("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT;default:return h.UnknownMessageKey}}function j(a){if(a!=null&&typeof a==="object"&&"message"in a){a=a.message;if(a!=null&&typeof a==="object")return a}return null}function a(a){m(a);var b,c=Object.keys(a);for(var d=0;d<c.length;d++){var e=c[d],f=j(a[e]);if(f!=null){var g=k(f);for(var g=g,h=Array.isArray(g),l=0,g=h?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var n;if(h){if(l>=g.length)break;n=g[l++]}else{l=g.next();if(l.done)break;n=l.value}n=n;var o=n[0];n[1];typeof o!=="number"&&(b=f)}}else{n=i(e,a);n!=null&&(b=a)}if(b!=null)break}return b}function k(a){var b=[],c=Object.keys(a);for(var e=0;e<c.length;e++){var f=c[e],g=j(a[f]);if(g!=null){var h=k(g);h.length===0?b.push([d("WAWebMsgType").MSG_TYPE.UNKNOWN,f]):b.push.apply(b,k(g))}else{h=i(f,a);h!=null&&b.push([h,f])}}return b}function l(a){return Boolean(a.find(function(a){a=a[0];return typeof a==="number"&&a===h.SenderKeyDistribution}))}function m(a){a=k(a);var b=a.length===1||a.length===2&&l(a);if(!b)throw new(d("WAWebHandleMsgError").MessageProtobufInvalidMessageTypes)(a.map(function(a){a[0];a=a[1];return a}))}function n(a){var b=new Set();for(var a=k(a),d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;var g=f[0];f[1];if(typeof g!=="number")b.add(g);else if(h.cast(g)!=null&&(g===h.Buttons||g===h.Template))throw c("err")("Undeclared message types")}return b}function e(a,b){return n(a).has(b)}g.UndeclaredMessageType=h;g.getUnwrappedProtobufMessage=a;g.getProtobufMessageTypesToKeys=k;g.verifyProtobufMessageObjectKeys=m;g.getProtobufMessageTypesSet=n;g.isProtobufHasMessageType=e}),98);
__d("WAWebWamEnumE2eCiphertextType",[],(function(a,b,c,d,e,f){a=Object.freeze({MESSAGE:0,PREKEY_MESSAGE:1,SENDER_KEY_MESSAGE:2,MESSAGE_SECRET_MESSAGE:3});f.E2E_CIPHERTEXT_TYPE=a}),66);
__d("WAWebWamEnumE2eDestination",[],(function(a,b,c,d,e,f){a=Object.freeze({INDIVIDUAL:0,GROUP:1,LIST:2,STATUS:3,CHANNEL:4,INTEROP:5});f.E2E_DESTINATION=a}),66);
__d("WAWebBackendJobsCommon",["WAJobOrchestratorTypes","WALogger","WAWap","WAWebABProps","WAWebAck","WAWebBackendJobs.flow","WAWebHandleMsgCommon","WAWebHandleMsgError","WAWebSendMsgCommonApi","WAWebSignalCommonErrors","WAWebVerifyProtobufMsgObjectKeys","WAWebWamEnumE2eCiphertextType","WAWebWamEnumE2eDestination","WAWebWamEnumEditType","WAWebWamEnumMediaType","WAWebWamEnumPlaceholderReasonType","err","gkx"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["getPlaceholderAddReason Other reason"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["getPlaceholderAddReason SignalBadMac reason"]);i=function(){return a};return a}var j=2;function a(a){switch(a){case d("WAWebBackendJobs.flow").CiphertextType.Skmsg:return d("WAWebWamEnumE2eCiphertextType").E2E_CIPHERTEXT_TYPE.SENDER_KEY_MESSAGE;case d("WAWebBackendJobs.flow").CiphertextType.Pkmsg:return d("WAWebWamEnumE2eCiphertextType").E2E_CIPHERTEXT_TYPE.PREKEY_MESSAGE;case d("WAWebBackendJobs.flow").CiphertextType.Msg:return d("WAWebWamEnumE2eCiphertextType").E2E_CIPHERTEXT_TYPE.MESSAGE;case d("WAWebBackendJobs.flow").CiphertextType.Msmsg:return d("WAWebWamEnumE2eCiphertextType").E2E_CIPHERTEXT_TYPE.MESSAGE_SECRET_MESSAGE}}function b(a){var b=a.encMediaType,c=a.msgType;a=a.msgPollType;if(c===d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.reaction)return d("WAWebWamEnumMediaType").MEDIA_TYPE.REACTION;else if(a===d("WAWebHandleMsgCommon").POLL_TYPES.creation)return d("WAWebWamEnumMediaType").MEDIA_TYPE.POLL_CREATE;else if(a===d("WAWebHandleMsgCommon").POLL_TYPES.vote)return d("WAWebWamEnumMediaType").MEDIA_TYPE.POLL_VOTE;else if(b)switch(b){case d("WAWebBackendJobs.flow").EncMediaType.Image:return d("WAWebWamEnumMediaType").MEDIA_TYPE.PHOTO;case d("WAWebBackendJobs.flow").EncMediaType.Video:return d("WAWebWamEnumMediaType").MEDIA_TYPE.VIDEO;case d("WAWebBackendJobs.flow").EncMediaType.Ptv:return d("WAWebWamEnumMediaType").MEDIA_TYPE.PUSH_TO_VIDEO;case d("WAWebBackendJobs.flow").EncMediaType.Audio:return d("WAWebWamEnumMediaType").MEDIA_TYPE.AUDIO;case d("WAWebBackendJobs.flow").EncMediaType.Ptt:return d("WAWebWamEnumMediaType").MEDIA_TYPE.PTT;case d("WAWebBackendJobs.flow").EncMediaType.Location:return d("WAWebWamEnumMediaType").MEDIA_TYPE.LOCATION;case d("WAWebBackendJobs.flow").EncMediaType.VCard:return d("WAWebWamEnumMediaType").MEDIA_TYPE.CONTACT;case d("WAWebBackendJobs.flow").EncMediaType.Document:return d("WAWebWamEnumMediaType").MEDIA_TYPE.DOCUMENT;case d("WAWebBackendJobs.flow").EncMediaType.Url:return d("WAWebWamEnumMediaType").MEDIA_TYPE.URL;case d("WAWebBackendJobs.flow").EncMediaType.Call:return d("WAWebWamEnumMediaType").MEDIA_TYPE.CALL;case d("WAWebBackendJobs.flow").EncMediaType.Gif:return d("WAWebWamEnumMediaType").MEDIA_TYPE.GIF;case d("WAWebBackendJobs.flow").EncMediaType.Future:return d("WAWebWamEnumMediaType").MEDIA_TYPE.FUTURE;case d("WAWebBackendJobs.flow").EncMediaType.ContactArray:return d("WAWebWamEnumMediaType").MEDIA_TYPE.CONTACT_ARRAY;case d("WAWebBackendJobs.flow").EncMediaType.LiveLocation:return d("WAWebWamEnumMediaType").MEDIA_TYPE.LIVE_LOCATION;case d("WAWebBackendJobs.flow").EncMediaType.ProfilePic:return d("WAWebWamEnumMediaType").MEDIA_TYPE.PROFILE_PIC;case d("WAWebBackendJobs.flow").EncMediaType.Sticker:return d("WAWebWamEnumMediaType").MEDIA_TYPE.STICKER;case d("WAWebBackendJobs.flow").EncMediaType.StickerPack:return d("WAWebWamEnumMediaType").MEDIA_TYPE.STICKER_PACK;case d("WAWebBackendJobs.flow").EncMediaType.Hsm:return d("WAWebWamEnumMediaType").MEDIA_TYPE.HSM;case d("WAWebBackendJobs.flow").EncMediaType.ProductImage:return d("WAWebWamEnumMediaType").MEDIA_TYPE.PRODUCT_IMAGE;case d("WAWebBackendJobs.flow").EncMediaType.Template:return d("WAWebWamEnumMediaType").MEDIA_TYPE.TEMPLATE;case d("WAWebBackendJobs.flow").EncMediaType.MdAppState:return d("WAWebWamEnumMediaType").MEDIA_TYPE.MD_APP_STATE;case d("WAWebBackendJobs.flow").EncMediaType.MdHistorySync:return d("WAWebWamEnumMediaType").MEDIA_TYPE.MD_HISTORY_SYNC;case d("WAWebBackendJobs.flow").EncMediaType.List:return d("WAWebWamEnumMediaType").MEDIA_TYPE.LIST;case d("WAWebBackendJobs.flow").EncMediaType.ListResponse:return d("WAWebWamEnumMediaType").MEDIA_TYPE.LIST_REPLY;case d("WAWebBackendJobs.flow").EncMediaType.Button:return d("WAWebWamEnumMediaType").MEDIA_TYPE.BUTTON_MESSAGE;case d("WAWebBackendJobs.flow").EncMediaType.ButtonResponse:return d("WAWebWamEnumMediaType").MEDIA_TYPE.BUTTON_RESPONSE_MESSAGE;case d("WAWebBackendJobs.flow").EncMediaType.Order:return d("WAWebWamEnumMediaType").MEDIA_TYPE.ORDER;case d("WAWebBackendJobs.flow").EncMediaType.Product:return d("WAWebWamEnumMediaType").MEDIA_TYPE.PRODUCT_IMAGE;case d("WAWebBackendJobs.flow").EncMediaType.NativeFlowResponse:return d("WAWebWamEnumMediaType").MEDIA_TYPE.INTERACTIVE_RESPONSE_NFM}return d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE}function k(a){if(a.deviceSentMessage){var b=a.deviceSentMessage.message;return b?k(b):null}else if(a.ephemeralMessage){b=a.ephemeralMessage.message;return b?k(b):null}else if(a.groupMentionedMessage){b=a.groupMentionedMessage.message;return b?k(b):null}else if(a.viewOnceMessageV2Extension){b=a.viewOnceMessageV2Extension.message;return b?k(b):null}else if(a.viewOnceMessage){b=a.viewOnceMessage.message;return b?k(b):null}else if(a.documentWithCaptionMessage){b=a.documentWithCaptionMessage.message;return b?k(b):null}else if(a.botInvokeMessage){b=a.botInvokeMessage.message;return b?k(b):null}else if(a.imageMessage)return d("WAWebBackendJobs.flow").EncMediaType.Image;else if(a.stickerMessage)return d("WAWebBackendJobs.flow").EncMediaType.Sticker;else if(a.stickerPackMessage)return d("WAWebBackendJobs.flow").EncMediaType.StickerPack;else if(a.lottieStickerMessage)return d("WAWebBackendJobs.flow").EncMediaType.Sticker;else if(a.locationMessage)return a.locationMessage.isLive===!0?d("WAWebBackendJobs.flow").EncMediaType.LiveLocation:d("WAWebBackendJobs.flow").EncMediaType.Location;else if(a.contactMessage)return d("WAWebBackendJobs.flow").EncMediaType.VCard;else if(a.contactsArrayMessage)return d("WAWebBackendJobs.flow").EncMediaType.ContactArray;else if(a.documentMessage)return d("WAWebBackendJobs.flow").EncMediaType.Document;else if(a.audioMessage)return a.audioMessage.ptt?d("WAWebBackendJobs.flow").EncMediaType.Ptt:d("WAWebBackendJobs.flow").EncMediaType.Audio;else if(a.videoMessage)return a.videoMessage.gifPlayback?d("WAWebBackendJobs.flow").EncMediaType.Gif:d("WAWebBackendJobs.flow").EncMediaType.Video;else if(a.ptvMessage)return d("WAWebBackendJobs.flow").EncMediaType.Ptv;else if(a.buttonsMessage)return d("WAWebBackendJobs.flow").EncMediaType.Button;else if(a.buttonsResponseMessage)return d("WAWebBackendJobs.flow").EncMediaType.ButtonResponse;else if(a.listMessage)return d("WAWebBackendJobs.flow").EncMediaType.List;else if(a.listResponseMessage)return d("WAWebBackendJobs.flow").EncMediaType.ListResponse;else if(a.orderMessage)return d("WAWebBackendJobs.flow").EncMediaType.Order;else if(a.productMessage)return d("WAWebBackendJobs.flow").EncMediaType.Product;else if(a.groupInviteMessage)return d("WAWebBackendJobs.flow").EncMediaType.Url;else if(a.interactiveResponseMessage)return d("WAWebBackendJobs.flow").EncMediaType.NativeFlowResponse;else if(((b=a.extendedTextMessage)==null?void 0:b.matchedText)!=null&&a.extendedTextMessage.matchedText.trim()!=="")return d("WAWebBackendJobs.flow").EncMediaType.Url;return null}function e(a){var b=function(){switch(a){case d("WAWebBackendJobs.flow").EncMediaType.Image:return"image";case d("WAWebBackendJobs.flow").EncMediaType.Video:return"video";case d("WAWebBackendJobs.flow").EncMediaType.Ptv:return"ptv";case d("WAWebBackendJobs.flow").EncMediaType.Audio:return"audio";case d("WAWebBackendJobs.flow").EncMediaType.Ptt:return"ptt";case d("WAWebBackendJobs.flow").EncMediaType.VCard:return"vcard";case d("WAWebBackendJobs.flow").EncMediaType.Document:return"document";case d("WAWebBackendJobs.flow").EncMediaType.Gif:return"gif";case d("WAWebBackendJobs.flow").EncMediaType.ContactArray:return"contact_array";case d("WAWebBackendJobs.flow").EncMediaType.Location:return"location";case d("WAWebBackendJobs.flow").EncMediaType.LiveLocation:return"livelocation";case d("WAWebBackendJobs.flow").EncMediaType.Sticker:return"sticker";case d("WAWebBackendJobs.flow").EncMediaType.List:return"list";case d("WAWebBackendJobs.flow").EncMediaType.ListResponse:return"list_response";case d("WAWebBackendJobs.flow").EncMediaType.ButtonResponse:return"buttons_response";case d("WAWebBackendJobs.flow").EncMediaType.Order:return"order";case d("WAWebBackendJobs.flow").EncMediaType.Product:return"product";case d("WAWebBackendJobs.flow").EncMediaType.Url:return"url";case d("WAWebBackendJobs.flow").EncMediaType.NativeFlowResponse:return"native_flow_response";case d("WAWebBackendJobs.flow").EncMediaType.StickerPack:return"sticker_pack";default:return null}};b=b();if(b)return d("WAWap").CUSTOM_STRING(b);throw c("err")("Unsupported type")}function f(a){return function(b){return b==null?d("WAWap").DROP_ATTR:a(b)}}e=f(e);function l(a){switch(a){case d("WAWebBackendJobs.flow").DecryptFailType.Show:return d("WAWap").DROP_ATTR;case d("WAWebBackendJobs.flow").DecryptFailType.Hide:return d("WAWap").CUSTOM_STRING("hide")}}function m(a){if(a.isUser())return d("WAWebWamEnumE2eDestination").E2E_DESTINATION.INDIVIDUAL;else if(a.isGroup())return d("WAWebWamEnumE2eDestination").E2E_DESTINATION.GROUP;else if(a.isStatus())return d("WAWebWamEnumE2eDestination").E2E_DESTINATION.STATUS;else if(a.isBroadcast())return d("WAWebWamEnumE2eDestination").E2E_DESTINATION.LIST;else if(a.isNewsletter())return d("WAWebWamEnumE2eDestination").E2E_DESTINATION.CHANNEL}function n(a){if(a instanceof d("WAWebHandleMsgError").UnknownDeviceMessageError)return d("WAWebWamEnumPlaceholderReasonType").PLACEHOLDER_REASON_TYPE.UNKNOWN_COMPANION_NO_PREKEY;if(a instanceof d("WAWebSignalCommonErrors").SignalDecryptionError){var b=c("gkx")("26258")?.001:.01;switch(a.message){case"errSignalNoSession":case"errLoadSenderKeySession":return d("WAWebWamEnumPlaceholderReasonType").PLACEHOLDER_REASON_TYPE.SIGNAL_NO_SESSION;case"errSignalInvalidMsg":return d("WAWebWamEnumPlaceholderReasonType").PLACEHOLDER_REASON_TYPE.SIGNAL_INVALID_MESSAGE;case"errSignalInvalidKey":case"errSignalInvalidOneTimeKey":case"errSignalInvalidSignedPreKey":return d("WAWebWamEnumPlaceholderReasonType").PLACEHOLDER_REASON_TYPE.SIGNAL_INVALID_KEY;case"errSignalTooManyMessagesInFuture":case"errSignalGrpTooManyMessagesInFuture":return d("WAWebWamEnumPlaceholderReasonType").PLACEHOLDER_REASON_TYPE.SIGNAL_FUTURE_MESSAGE;case"errInvalidMacWithDecryptedPlaintext":case"errInvalidMacInvalidCipherKey":case"errInvalidMacInvalidCipherKeyNewChain":var e="MsgPlaceholderBadMac-"+a.message;d("WALogger").ERROR(i()).sendLogs(e,{sampling:b});return d("WAWebWamEnumPlaceholderReasonType").PLACEHOLDER_REASON_TYPE.SIGNAL_BAD_MAC}e="MsgPlaceholderOther-"+a.message;d("WALogger").ERROR(h()).sendLogs(e,{sampling:b});return d("WAWebWamEnumPlaceholderReasonType").PLACEHOLDER_REASON_TYPE.OTHER}}function o(a){if(a.interactiveResponseMessage){return(a=a.interactiveResponseMessage.nativeFlowResponseMessage)==null?void 0:a.name}return null}f=f(function(a){return d("WAWap").CUSTOM_STRING(a)});function p(a){switch(a){case d("WAWebAck").EDIT_ATTR.SENDER_REVOKE:return d("WAWebWamEnumEditType").EDIT_TYPE.SENDER_REVOKE;case d("WAWebAck").EDIT_ATTR.ADMIN_REVOKE:return d("WAWebWamEnumEditType").EDIT_TYPE.ADMIN_REVOKE;case d("WAWebAck").EDIT_ATTR.MESSAGE_EDIT:return d("WAWebWamEnumEditType").EDIT_TYPE.EDITED;default:return d("WAWebWamEnumEditType").EDIT_TYPE.NOT_EDITED}}function q(a,b){if(d("WAWebABProps").getABPropConfigValue("web_unwrap_message_for_stanza_attributes")){var c;c=(c=d("WAWebVerifyProtobufMsgObjectKeys").getUnwrappedProtobufMessage(a))!=null?c:a}else c=a;return d("WAWebSendMsgCommonApi").isRevokeMsg(c)?b.subtype==="admin_revoke"?d("WAWebWamEnumEditType").EDIT_TYPE.ADMIN_REVOKE:d("WAWebWamEnumEditType").EDIT_TYPE.SENDER_REVOKE:d("WAWebSendMsgCommonApi").isEditMsg(c)?d("WAWebWamEnumEditType").EDIT_TYPE.EDITED:d("WAWebWamEnumEditType").EDIT_TYPE.NOT_EDITED}function r(a){return a?d("WAJobOrchestratorTypes").JOB_PRIORITY.OFFLINE:d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW}g.CIPHERTEXT_VERSION=j;g.getMetricE2eCiphertextType=a;g.getMetricMediaType=b;g.mediaTypeFromProtobuf=k;g.encodeMaybeMediaType=e;g.encodeMaybeDecryptFail=l;g.getMetricE2eDestination=m;g.getPlaceholderAddReason=n;g.nativeFlowNameTypeFromProtobuf=o;g.encodeMaybeNativeFlowName=f;g.getMetricEditType=p;g.getMetricEditTypeFromMsg=q;g.getNonCriticalNotificationPriority=r}),98);
__d("WAWebAddOnsMarkAddOnsAsReadDb",["Promise","WANullthrows","WAWebDBAddOnProviders","WAWebDBMarkAsReadForTable","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield (h||(h=b("Promise"))).allSettled(Array.from(a.entries()).map(function(a){var b=a[0];a=a[1];b=c("WANullthrows")(d("WAWebDBAddOnProviders").getProviderForAddOnType(b));return b.markAsRead==null?void 0:b.markAsRead(a)})));for(a of a)if(a.status==="rejected")throw a.reason});return i.apply(this,arguments)}function e(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=new Map(),e=d("WAWebDBAddOnProviders").addOnProviders.map(function(){var d=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var d=(yield b.markAsRead==null?void 0:b.markAsRead(a));c.set(b.type,(b=d)!=null?b:[])});return function(a){return d.apply(this,arguments)}}()),f=[],g=d("WAWebDBMarkAsReadForTable").markAsReadForTable("message-orphans",a.map(String)).then(function(a){f.push.apply(f,a)});e=(yield (h||(h=b("Promise"))).allSettled([].concat(e,[g])));for(g of e)if(g.status==="rejected")throw g.reason;return{updatedAddOns:c,updatedOrphans:f}});return j.apply(this,arguments)}g.markAddOnsAsReadDb=a;g.markUnclassifiedAddOnsAsReadDb=e}),98);
__d("WAWebDeviceListPk",["err"],(function(a,b,c,d,e,f,g){function a(a){switch(a.server){case"lid":return a.user+"@lid";case"c.us":return a.user;case"hosted":return a.user;case"hosted.lid":return a.user+"@lid";case"bot":return a.user+"@bot"}throw c("err")("Jid "+a.toString({legacy:!0})+' is not fully qualified to create a device list pk, jid.server should be "c.us" or "lid"')}g.createDeviceListPK=a}),98);
__d("WAWebApiDeviceList",["Promise","WAJids","WALruCache","WAWebApiContact","WAWebDeviceListPk","WAWebSchemaDeviceList","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i=new(d("WALruCache").LruCache)({sizeLimit:5e3,getSize:function(){return 1}});function j(a){var c=d("WAWebDeviceListPk").createDeviceListPK(a);if(!i.has(c)){var e=d("WAWebSchemaDeviceList").getDeviceListTable().get(c);i.put(c,e)}i.get(c)!=null&&d("WAWebApiContact").checkPnToLidMapping([a],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_API_DEVICE_LIST_GET_DEVICE_RECORD);return(e=i.get(c))!=null?e:(h||(h=b("Promise"))).resolve(null)}function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=[];a.forEach(function(a){i.has(d("WAWebDeviceListPk").createDeviceListPK(a))||c.push(d("WAWebDeviceListPk").createDeviceListPK(a))});if(c.length>0){var e=(yield d("WAWebSchemaDeviceList").getDeviceListTable().bulkGet(c));e.forEach(function(a,d){i.put(c[d],(h||(h=b("Promise"))).resolve(a))})}e=a.filter(function(a){return i.get(d("WAWebDeviceListPk").createDeviceListPK(a))!=null});e.length>0&&d("WAWebApiContact").checkPnToLidMapping(e,d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_API_DEVICE_LIST_BULK_GET_DEVICE_RECORD);return(h||(h=b("Promise"))).all(a.map(function(a){return i.get(d("WAWebDeviceListPk").createDeviceListPK(a))}))});return l.apply(this,arguments)}function a(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WAWebApiContact").checkPnToLidMapping([d("WAWebWidFactory").createUserWidFromDeviceListPk(a.id)],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_API_DEVICE_LIST_CREATE_OR_REPLACE_DEVICE_RECORD),yield d("WAWebSchemaDeviceList").getDeviceListTable().createOrReplace(a),i.put(a.id,(h||(h=b("Promise"))).resolve(a))});return m.apply(this,arguments)}function e(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WAWebApiContact").checkPnToLidMapping(a.map(function(a){return d("WAWebWidFactory").createUserWidFromDeviceListPk(a.id)}),d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_API_DEVICE_LIST_BULK_CREATE_OR_REPLACE_DEVICE_RECORD),yield d("WAWebSchemaDeviceList").getDeviceListTable().bulkCreateOrReplace(a),a.forEach(function(a){i.put(a.id,(h||(h=b("Promise"))).resolve(a))})});return n.apply(this,arguments)}function o(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield k(a));return a.map(function(a){if(a&&!a.deleted){var b=a.devices.map(function(a){return{id:a.id,isHosted:a.isHosted}});return{id:a.id,devices:b}}return null})});return p.apply(this,arguments)}function f(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(b===d("WAJids").DEFAULT_DEVICE_ID)return!0;a=(yield o([a]));a=a[0];if(!a)return!1;return!a.devices.some(function(a){return a.id===b})?!1:!0});return q.apply(this,arguments)}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield k(a));return a.map(function(a){if(a&&!a.deleted){var b=a.devices.map(function(a){return{id:a.id,isHosted:a.isHosted}});return{id:a.id,devices:b,timestamp:a.timestamp,expectedTs:a.expectedTs}}return null})});return s.apply(this,arguments)}function t(){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=d("WAWebUserPrefsMeUser").assertGetMe();a=(yield j(a));if(!a||a.deleted)throw c("err")("syncd: cannot find my device list");return a});return u.apply(this,arguments)}function v(){return d("WAWebSchemaDeviceList").getDeviceListTable().all()}g.getDeviceRecord=j;g.bulkGetDeviceRecord=k;g.createOrReplaceDeviceRecord=a;g.bulkCreateOrReplaceDeviceRecord=e;g.getDeviceIds=o;g.hasDevice=f;g.getDeviceInfoForSync=r;g.getMyDeviceList=t;g.getAllDeviceLists=v}),98);
__d("WAWebApiTasksScheduledTime",["WAWebModelStorageUtils","WAWebSchemaTasksScheduledTime"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebSchemaTasksScheduledTime").getTasksScheduledTimeTable().get(a).then(function(a){return a==null?void 0:a.time})}function b(a,b){return d("WAWebModelStorageUtils").getStorage().lock(["tasks-scheduled-time"],function(c){c=c[0];var d={taskName:a,time:b};return c.createOrReplace(d)})}g.getTaskScheduledTime=a;g.updateTaskScheduledTime=b}),98);
__d("WAWebLastADVCheckTimeApi",["Promise","WAWebApiTasksScheduledTime"],(function(a,b,c,d,e,f,g){var h,i;function a(){i==null&&(i=d("WAWebApiTasksScheduledTime").getTaskScheduledTime("advDeviceInfoCheck"));return i}function c(a){i=(h||(h=b("Promise"))).resolve(a)}g.getLastADVDeviceInfoCheckTime=a;g.setLastADVDeviceInfoCheckTime=c}),98);
__d("WAWebAdvHandlerApi",["Promise","WALogger","WAWebApiDeviceList","WAWebBizCoexGatingUtils","WAWebBizCoexUtils","WAWebCryptoCurve25519","WAWebDeviceListPk","WAWebHandleAdvForMessageApi","WAWebHandleAdvForUsyncApi","WAWebIdentityUpdateDeviceTableApi","WAWebLastADVCheckTimeApi","WAWebSignalCommonUtils","WAWebSignalProtocolStore","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleADVDeviceSyncResultImpl: start to handling "," updates"]);i=function(){return a};return a}function a(a,b,c,d,e,f,g){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g,h){g===void 0&&(g=!1);var i=(yield d("WAWebLastADVCheckTimeApi").getLastADVDeviceInfoCheckTime());return d("WAWebHandleAdvForMessageApi").handleADVDeviceUpdateForMessage(a,b,c,e,f,g,i,h)});return j.apply(this,arguments)}function e(a){var d=a.wid,e=a.devices;a=a.type;return a==null?(h||(h=b("Promise"))).reject(c("err")("handleADVDeviceNotification: notification without type")):k(d,e,a)}function f(a){return m(a)}function k(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=null;if(c==="add"){var f=(yield d("WAWebSignalProtocolStore").getPersistSignalProtocolStore().loadIdentityKey(d("WAWebSignalCommonUtils").createSignalAddressForIdentityTable(a).toString()));e=f?d("WAWebCryptoCurve25519").toCurveKeyPubKey(d("WAWebSignalCommonUtils").strToBuffer(f)):null;if(!d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&b.deviceList!=null){b.deviceList=(f=b.deviceList)==null?void 0:f.filter(function(a){return a.id!==d("WAWebBizCoexUtils").HOSTED_DEVICE_ID})}}f=(yield d("WAWebApiDeviceList").getDeviceRecord(a));var g=(yield d("WAWebLastADVCheckTimeApi").getLastADVDeviceInfoCheckTime());c=d("WAWebHandleAdvForUsyncApi").handleDeviceNotification(a,c,b,e,f,g);if(c){if(c.clearRecord){yield d("WAWebIdentityUpdateDeviceTableApi").clearDeviceRecord(a,(f==null?void 0:f.devices)||[],!1,f==null?void 0:f.advAccountType,c==null?void 0:(b=c.update)==null?void 0:b.advAccountType)}return d("WAWebIdentityUpdateDeviceTableApi").bulkApplyDeviceUpdate([{wid:a,update:c.update,currentRecord:f}])}});return l.apply(this,arguments)}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()||a.forEach(function(a){var b;if((a==null?void 0:(b=a.devices)==null?void 0:b.deviceList)==null)return;a.devices.deviceList=(b=a.devices.deviceList)==null?void 0:b.filter(function(a){return a.id!==d("WAWebBizCoexUtils").HOSTED_DEVICE_ID})});d("WALogger").LOG(i(),a.length).devConsole(a);var c=a.map(function(a){return a.wid}),e=a.filter(function(a){return(a=a.devices.keyIndex)==null?void 0:a.signedKeyIndexBytes}),f=(yield d("WAWebSignalProtocolStore").getPersistSignalProtocolStore().bulkLoadIdentityKey(e.map(function(a){return d("WAWebSignalCommonUtils").createSignalAddressForIdentityTable(a.wid).toString()}))),g=new Map();e.forEach(function(a,b){g.set(d("WAWebDeviceListPk").createDeviceListPK(a.wid),f[b])});var j=(yield d("WAWebApiDeviceList").bulkGetDeviceRecord(c)),k=[],l=[];a.forEach(function(a,b){var c=g.get(d("WAWebDeviceListPk").createDeviceListPK(a.wid));c=c?d("WAWebCryptoCurve25519").toCurveKeyPubKey(d("WAWebSignalCommonUtils").strToBuffer(c)):null;b=j[b];c=d("WAWebHandleAdvForUsyncApi").handleADVSyncResult(a.wid,a.devices,c,b);if(c==null)return;if(c.clearRecord){var e;k.push({wid:a.wid,currentList:(b==null?void 0:b.devices)||[],currentAdvAccountType:b==null?void 0:b.advAccountType,incomingAdvAccountType:(e=c.update)==null?void 0:e.advAccountType});l.push({wid:a.wid,currentRecord:{id:d("WAWebDeviceListPk").createDeviceListPK(a.wid),deleted:!0},update:c.update})}else l.push({wid:a.wid,currentRecord:b,update:c.update})});yield (h||(h=b("Promise"))).all(k.map(function(a){var b=a.wid,c=a.currentList,e=a.currentAdvAccountType;a=a.incomingAdvAccountType;return d("WAWebIdentityUpdateDeviceTableApi").clearDeviceRecord(b,c,!1,e,a)}));yield d("WAWebIdentityUpdateDeviceTableApi").bulkApplyDeviceUpdate(l)});return n.apply(this,arguments)}g.handleADVDeviceUpdateForMessage=a;g.handleADVDeviceNotification=e;g.handleADVDeviceSyncResult=f}),98);
__d("WAWebAdvSignatureApi",["invariant","Promise","WABase64","WABinary","WAByteArray","WALogger","WAWebAdvHandlerApi","WAWebBackendJobs.flow","WAWebBizCoexGatingUtils","WAWebBizCoexHostedAddVerification","WAWebCryptoCurve25519","WAWebProtobufsAdv.pb","WAWebSignalCommonUtils","WAWebSignalProtocolStore","WAWebSignalStoreApi","WAWebSignalUtilsApi","WAWebUserPrefsMultiDevice","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf","encodeProtobuf","err"],(function(a,b,c,d,e,f,g,h){var i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["validateADVwithEncs: failed ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["validateADVwithEncs: start validate prekey msg "]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["validateADVIdentity: failed"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["validateADVIdentity: successfully verified accountSignature and deviceSignature"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["validateADVIdentity: process adv device identity failed"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["validateADVIdentity: add to coex cache for ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["validateADVIdentity: invalid device signature"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["validateADVIdentity: invalid account signature"]);q=function(){return a};return a}function r(a,b,c,d){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){e===void 0&&(e=!1);var f=!1;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(f=a.isHosted());try{var g=d("WAWebWidFactory").toUserWid(a);c=d("WAByteArray").uint8ArrayToBuffer(c);var i=(yield d("WAWebSignalProtocolStore").getSignalProtocolStore().loadIdentityKey(d("WAWebSignalCommonUtils").createSignalAddressForIdentityTable(a).toString()));if(i){i=d("WAWebCryptoCurve25519").toCurveKeyPubKey(d("WAWebSignalCommonUtils").strToBuffer(i));if(d("WAWebSignalCommonUtils").bufferEqual(i,c))return!0}i=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsAdv.pb").ADVSignedDeviceIdentitySpec,b);i!=null||h(0,56342);b=(yield d("WAWebSignalProtocolStore").getSignalProtocolStore().loadIdentityKey(d("WAWebSignalCommonUtils").createSignalAddressForIdentityTable(g).toString()));g=b?d("WAWebCryptoCurve25519").toCurveKeyPubKey(d("WAWebSignalCommonUtils").strToBuffer(b)):null;if(!E(i,c,g)){d("WALogger").WARN(q());return!1}if(!K(i,c,g,f)){d("WALogger").WARN(p());return!1}b=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsAdv.pb").ADVDeviceIdentitySpec,i.details);b!=null||h(0,56341);f=i.accountSignatureKey;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(b.accountType===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(d("WALogger").LOG(o(),a==null?void 0:a.toLogString()),d("WAWebBizCoexHostedAddVerification").addToCoexHostedVerificationCache(a)),f=f&&f.byteLength>0?f:void 0);try{yield d("WAWebAdvHandlerApi").handleADVDeviceUpdateForMessage(a,b,g,f,c,e,b.accountType)}catch(a){d("WALogger").WARN(n()).devConsole(a);return!1}d("WALogger").LOG(m());return!0}catch(a){d("WALogger").WARN(l()).devConsole(a);return!1}});return s.apply(this,arguments)}function a(a,b,c,d){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){e===void 0&&(e=!1);c=c.find(function(a){return a.e2eType===d("WAWebBackendJobs.flow").CiphertextType.Pkmsg});if(!c)return!0;d("WALogger").LOG(k());try{a!=null||h(0,56346);c=d("WAWebSignalUtilsApi").extractIdentityKey(c.ciphertext);c!=null||h(0,56345);a=(yield r(a,b,new Uint8Array(c),e));yield d("WAWebSignalProtocolStore").getSignalProtocolStore().flushBufferToDiskIfNotMemOnlyMode();return a}catch(a){d("WALogger").WARN(j(),a);return!1}});return t.apply(this,arguments)}var u=new Uint8Array([6,5]),v=new Uint8Array([6,6]),w=new Uint8Array([6,0]),x=new Uint8Array([6,1]),y=new Uint8Array([6,2]);function e(){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=new Uint8Array(32);self.crypto.getRandomValues(a);a=d("WABase64").encodeB64(a);yield d("WAWebUserPrefsMultiDevice").setADVSecretKey(a);return a});return z.apply(this,arguments)}function f(){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebUserPrefsMultiDevice").getADVSecretKey());if(a==null)throw c("err")("secretKey is null or undefined");return a});return A.apply(this,arguments)}function B(a){if(a==null)return(i||(i=b("Promise"))).reject(c("err")("advSignedDeviceIdentity is null or undefined"));return a.deviceSignature==null?(i||(i=b("Promise"))).reject(c("err")("advSignedDeviceIdentity is missing deviceSignature")):d("WAWebSignalStoreApi").waSignalStore.putADVSignedIdentity(a)}function C(){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebSignalStoreApi").waSignalStore.getADVSignedIdentity());if(a==null)throw c("err")("advSignedDeviceIdentity is null or undefined");if(a.deviceSignature==null)throw c("err")("advSignedDeviceIdentity is missing deviceSignature");return d("encodeProtobuf").encodeProtobuf(d("WAWebProtobufsAdv.pb").ADVSignedDeviceIdentitySpec,a).readByteArray()});return D.apply(this,arguments)}function E(a,b,c){a=G(a,c);c=a.accountSignatureKey;var d=a.accountSignature;a=a.advDeviceIdentityDetails;return F(a,d,b,c)}function F(a,b,c,e){var f=w;if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){var g=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsAdv.pb").ADVDeviceIdentitySpec,a);g.deviceType===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(f=u)}e!=null||h(0,56344);b!=null||h(0,56295);g=d("WABinary").Binary.build(f,a,c).readByteArray();return d("WAWebCryptoCurve25519").verifySignature(new Uint8Array(e),g,new Uint8Array(b))}function G(a,b){var c=a.details,e=a.accountSignatureKey||b;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(e=e&&e.byteLength>0?e:b);e!=null||h(0,56344);b=a.accountSignature;b!=null||h(0,56295);c!=null||h(0,70451);return{accountSignatureKey:e,accountSignature:b,advDeviceIdentityDetails:c}}function H(a,b,c){a=a.details;a=d("WABinary").Binary.build(x,a,b.pubKey,c).readByteArray().buffer;return d("WAWebCryptoCurve25519").calculateSignature(b,a)}function I(a,b,c,e,f){var g=x;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(c===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(g=v));c=d("WABinary").Binary.build(g,a,b,f).readByteArray();return d("WAWebCryptoCurve25519").verifySignature(new Uint8Array(b),c,new Uint8Array(e))}function J(a,b){var c=a.details,e=a.deviceSignature;e!=null||h(0,56343);a=a.accountSignatureKey||b;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(a=a&&a.byteLength>0?a:b);a!=null||h(0,56344);c!=null||h(0,70451);return{accountSignatureKey:a,deviceSignature:e,advDeviceIdentityDetails:c}}function K(a,b,c,e){e===void 0&&(e=!1);a=J(a,c);c=a.accountSignatureKey;var f=a.deviceSignature;a=a.advDeviceIdentityDetails;var g=d("WAWebProtobufsAdv.pb").ADVEncryptionType.E2EE;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(e&&(g=d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED));return I(a,b,g,f,c)}function L(){return M.apply(this,arguments)}function M(){M=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebUserPrefsMultiDevice").setADVSecretKey(void 0)});return M.apply(this,arguments)}function N(a,b){var c=a.details;a=a.accountSignature;a!=null||h(0,56295);c=d("WABinary").Binary.build(y,c).readByteArray();return d("WAWebCryptoCurve25519").verifySignature(new Uint8Array(b),c,new Uint8Array(a))}g.validateADVwithIdentityKey=r;g.validateADVwithEncs=a;g.ADV_HOSTED_PREFIX_DEVICE_IDENTITY_ACCOUNT_SIGNATURE=u;g.generateADVSecretKey=e;g.getADVSecretKey=f;g.setADVSignedIdentity=B;g.getADVEncodedIdentity=C;g.verifyDeviceIdentityAccountSignature=E;g.generateDeviceSignature=H;g.clearADVSecretKey=L;g.verifyKeyIndexListAccountSignature=N}),98);
__d("WAWebHandleAdvForMessageApi",["invariant","WAJids","WAWebApiDeviceList","WAWebHandleAdvListResetApi","WAWebHandleAdvNoListResetApi","WAWebSignalCommonUtils","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){function a(a,b,c,d,e,f,g,h){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g,i,j){g===void 0&&(g=!1);var k=b.rawId,l=b.timestamp;b=b.keyIndex;k!=null||h(0,56258);l!=null||h(0,56257);b!=null||h(0,56256);l={rawId:k,timestamp:l,keyIndex:b};b=a.device;b!=null&&b!==d("WAJids").DEFAULT_DEVICE_ID||h(0,56259);b=d("WAWebWidFactory").toUserWid(a);b=(yield d("WAWebApiDeviceList").getDeviceRecord(b));c=c==null||e!=null&&!d("WAWebSignalCommonUtils").bufferEqual(c,e);return!b||b.deleted||b.rawId!==k||c?d("WAWebHandleAdvListResetApi").handleListReset(a,l,c?e:null,f,b,g,i,j):d("WAWebHandleAdvNoListResetApi").handleNoListReset(a,l,f,b,g,i,j)});return i.apply(this,arguments)}g.handleADVDeviceUpdateForMessage=a}),98);
__d("WAWebAdvExpectedTsApi",["WATimeUtils"],(function(a,b,c,d,e,f,g){function a(a,b,c){var d=b==null?void 0:b.timestamp;if(d==null)return{expectedTs:void 0,expectedTsLastDeviceJobTs:void 0,expectedTsUpdateTs:void 0};var e,f,g;b!=null&&!b.deleted&&(e=b.expectedTs,f=b.expectedTsLastDeviceJobTs,g=b.expectedTsUpdateTs);return h(a,d,c,e,f,g)}function h(a,b,c,e,f,g){f={expectedTs:e,expectedTsLastDeviceJobTs:f,expectedTsUpdateTs:g};if(b>=a||e!=null&&e>=a)return f;f.expectedTs=a;f.expectedTsLastDeviceJobTs=(g=c)!=null?g:void 0;(e==null||b>=e)&&(f.expectedTsUpdateTs=d("WATimeUtils").unixTimeWithoutClockSkewCorrection());return f}function b(a,b,c,d){if(c==null||c.deleted)return!1;if(c.expectedTs==null)return!1;if(a>=c.expectedTs)return!0;return a<c.expectedTs&&b===c.expectedTs&&d!=null&&(c.expectedTsLastDeviceJobTs==null||d>c.expectedTsLastDeviceJobTs)?!0:!1}g.computeExpectedTsForDeviceRecord=a;g.computeNewExpectedTs=h;g.shouldClearExpectedTs=b}),98);
__d("WAWebHandleAdvListResetApi",["invariant","WAJids","WALongInt","WATimeUtils","WAWebABProps","WAWebAdvExpectedTsApi","WAWebBizCoexGatingUtils","WAWebCryptoCurve25519","WAWebDeviceListPk","WAWebIdentityUpdateDeviceTableApi","WAWebSignalCommonUtils","WAWebSignalProtocolStore","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g,h){function a(a,b,c,d,e,f,g,h){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,i,j,k){var l;i===void 0&&(i=!1);var m=b.rawId,n=b.timestamp;b=b.keyIndex;n=d("WALongInt").numberOrThrowIfTooLarge(n);var o=a.device;o!=null&&o!==d("WAJids").DEFAULT_DEVICE_ID||h(0,56259);var p=d("WAWebWidFactory").toUserWid(a),q=0;q=(l=g==null?void 0:g.timestamp)!=null?l:d("WATimeUtils").pastUnixTime((d("WAWebABProps").getABPropConfigValue("num_days_key_index_list_expiration")-1)*d("WATimeUtils").DAY_SECONDS);if(g!=null&&!g.deleted){if(g.timestamp>n)throw c("err")("handleADVDeviceIdentity: out-of-order timestamp detected");yield d("WAWebIdentityUpdateDeviceTableApi").clearDeviceRecord(p,g.devices,i)}e&&(yield d("WAWebSignalProtocolStore").getSignalProtocolStore().saveIdentity(d("WAWebSignalCommonUtils").createSignalAddressForIdentityTable(p).toString(),d("WAWebCryptoCurve25519").toSignalCurvePubKey(e)));l={id:d("WAWebDeviceListPk").createDeviceListPK(a),rawId:m,timestamp:q,devices:[{id:o,keyIndex:b},{id:d("WAJids").DEFAULT_DEVICE_ID,keyIndex:0}],validIndexes:null,currentIndex:null,deleted:!1};g=d("WAWebAdvExpectedTsApi").computeExpectedTsForDeviceRecord(n,l,j);l.expectedTs=g.expectedTs;l.expectedTsLastDeviceJobTs=g.expectedTsLastDeviceJobTs;l.expectedTsUpdateTs=g.expectedTsUpdateTs;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(k!=null&&(l.advAccountType=k));yield d("WAWebIdentityUpdateDeviceTableApi").bulkApplyDeviceUpdate([{wid:p,update:l,currentRecord:null}],i);yield d("WAWebSignalProtocolStore").getSignalProtocolStore().saveIdentity(d("WAWebSignalCommonUtils").createSignalAddressForIdentityTable(a).toString(),d("WAWebCryptoCurve25519").toSignalCurvePubKey(f))});return i.apply(this,arguments)}g.handleListReset=a}),98);
__d("WAWebHandleAdvNoListResetApi",["invariant","WAJids","WALongInt","WAWebAdvExpectedTsApi","WAWebBizCoexGatingUtils","WAWebCryptoCurve25519","WAWebIdentityUpdateDeviceTableApi","WAWebSignalCommonUtils","WAWebSignalProtocolStore","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g,h){function a(a,b,c,d,e,f,g){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,i,j){g===void 0&&(g=!1);var k=b.timestamp;b=b.keyIndex;k=d("WALongInt").numberOrThrowIfTooLarge(k);var l=a.device;l!=null&&l!==d("WAJids").DEFAULT_DEVICE_ID||h(0,56259);if(f.timestamp>=k&&f.validIndexes&&!f.validIndexes.includes(b))throw c("err")("handleADVDeviceIdentity: out-of-order timestamp detected");var m=new Map(f.devices.map(function(a){return[a.id,a.keyIndex]}));if(!m.has(l)||m.get(l)!==b){m.set(l,b);l=Array.from(m.entries()).map(function(a){var b=a[0];a=a[1];return{id:b,keyIndex:a}});b=babelHelpers["extends"]({},f,{devices:l,deleted:!1});m=d("WAWebAdvExpectedTsApi").computeExpectedTsForDeviceRecord(k,b,i);b.expectedTs=m.expectedTs;b.expectedTsLastDeviceJobTs=m.expectedTsLastDeviceJobTs;b.expectedTsUpdateTs=m.expectedTsUpdateTs;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(b.advAccountType=j);yield d("WAWebIdentityUpdateDeviceTableApi").bulkApplyDeviceUpdate([{wid:d("WAWebWidFactory").toUserWid(a),update:b,currentRecord:f}],g,!0);yield d("WAWebSignalProtocolStore").getSignalProtocolStore().saveIdentity(d("WAWebSignalCommonUtils").createSignalAddressForIdentityTable(a).toString(),d("WAWebCryptoCurve25519").toSignalCurvePubKey(e))}});return i.apply(this,arguments)}g.handleNoListReset=a}),98);
__d("WAWebHandleAdvDeviceNotificationApi",["WAJids","WALogger","WALongInt","WAWebAdvExpectedTsApi","WAWebBizCoexGatingUtils","WAWebBizCoexHostedAddVerification","WAWebBizCoexUtils","WAWebDeviceListPk","WAWebHandleAdvDeviceNotificationUtils","WAWebProtobufsAdv.pb"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Clear record due to mismatch between local ADV account type and incoming ADV account type of "," for ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleDeviceAddNotification: add to coex cache for ",""]);i=function(){return a};return a}function a(a,b,c,e,f,g,j){if(!g||g.deleted){d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&d("WAWebBizCoexUtils").triggerUsyncForCoexDeviceAdd(b,a);return null}if(c<g.timestamp)return null;if(f==null)return null;f=d("WAWebHandleAdvDeviceNotificationUtils").decodeSignedKeyIndexBytes(f,e);if(!f)return null;e=f.rawId;var k=d("WALongInt").numberOrThrowIfTooLarge(f.timestamp),l=null;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(l=f.accountType,l===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(d("WALogger").LOG(i(),a==null?void 0:a.toLogString()),d("WAWebBizCoexHostedAddVerification").addToCoexHostedVerificationCache(a)));if(k!==c)return null;c=!1;var m=null,n=g.timestamp;g.rawId!==e?c=!0:m=g.devices;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(g.advAccountType!=null&&(g.advAccountType!==l&&(c=!0,d("WALogger").LOG(h(),l,a==null?void 0:a.toLogString()))));var o=new Set(f.validIndexes),p=f.currentIndex||0,q=m==null?[]:m.filter(function(a){return a.id!==d("WAJids").DEFAULT_DEVICE_ID&&(o.has(a.keyIndex)||a.keyIndex>p)});b.forEach(function(a){var b=a.id;a=a.keyIndex;b!==d("WAJids").DEFAULT_DEVICE_ID&&a!=null&&o.has(a)&&q.push({id:b,keyIndex:a})});q.push({id:d("WAJids").DEFAULT_DEVICE_ID,keyIndex:0});g={id:d("WAWebDeviceListPk").createDeviceListPK(a),rawId:e,timestamp:n,validIndexes:Array.from(o),devices:q,currentIndex:f.currentIndex,deleted:!1};m=d("WAWebAdvExpectedTsApi").computeExpectedTsForDeviceRecord(k,g,j);g.expectedTs=m.expectedTs;g.expectedTsLastDeviceJobTs=m.expectedTsLastDeviceJobTs;g.expectedTsUpdateTs=m.expectedTsUpdateTs;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(l!=null&&(g.advAccountType=l));return{update:g,clearRecord:c}}function b(a,b,c){if(c==null||c.deleted)return null;if(b<c.timestamp)return null;var e=new Map(a.map(function(a){return[a.id,a.keyIndex]}));b=c.devices.filter(function(a){if(a.id!==d("WAJids").DEFAULT_DEVICE_ID){var b=e.get(a.id);return b==null||b!==a.keyIndex}return!1});b.push({id:d("WAJids").DEFAULT_DEVICE_ID,keyIndex:0});return{update:babelHelpers["extends"]({},c,{devices:b}),clearRecord:!1}}g.handleDeviceAddNotification=a;g.handleDeviceRemoveNotification=b}),98);
__d("WAWebHandleAdvDeviceNotificationUtils",["WAWebAdvSignatureApi","WAWebProtobufsAdv.pb","decodeProtobuf"],(function(a,b,c,d,e,f,g){function a(a,b){var c;try{c=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsAdv.pb").ADVSignedKeyIndexListSpec,b)}catch(a){return null}if(!d("WAWebAdvSignatureApi").verifyKeyIndexListAccountSignature(c,a))return null;var e;try{e=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsAdv.pb").ADVKeyIndexListSpec,c.details)}catch(a){return null}b=e;a=b.timestamp;var f=b.rawId,g=b.validIndexes,h=b.currentIndex;b=b.accountType;if(a==null)return null;return f==null?null:{timestamp:a,rawId:f,validIndexes:g,currentIndex:h,accountType:b}}g.decodeSignedKeyIndexBytes=a}),98);
__d("WAWebHandleAdvOmittedResultApi",["WAJids","WAWebAdvExpectedTsApi"],(function(a,b,c,d,e,f,g){function a(a,b,c,e){if(!b||b.deleted)return null;if(a!=null&&a<b.timestamp)return null;var f=babelHelpers["extends"]({},b);a!=null&&(f.timestamp=a,d("WAWebAdvExpectedTsApi").shouldClearExpectedTs(a,c,b,e)&&(f.expectedTs=void 0,f.expectedTsLastDeviceJobTs=void 0,f.expectedTsUpdateTs=void 0));f.devices=[{id:d("WAJids").DEFAULT_DEVICE_ID,keyIndex:0}];return{update:f,clearRecord:!1}}g.handleOmittedResult=a}),98);
__d("WAWebHandleAdvForUsyncApi",["invariant","WAJids","WALogger","WAWebHandleAdvDeviceNotificationApi","WAWebHandleAdvKeyIndexResultApi","WAWebHandleAdvOmittedResultApi"],(function(a,b,c,d,e,f,g,h){function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["processADVSyncResult: drop response with companion device but no keyIndexbytes"]);i=function(){return a};return a}function a(a,b,c,e,f){var g=b.deviceList;b=b.keyIndex;if(b==null||b.signedKeyIndexBytes==null){if(g!=null&&g.some(function(a){return a.id!==d("WAJids").DEFAULT_DEVICE_ID})){d("WALogger").LOG(i());return}return d("WAWebHandleAdvOmittedResultApi").handleOmittedResult(b==null?void 0:b.ts,e,b==null?void 0:b.expectedTs,f)}var h=b.ts,j=b.expectedTs;b=b.signedKeyIndexBytes;return d("WAWebHandleAdvKeyIndexResultApi").handleKeyIndexResult(a,g,h,b,c,e,f,j)}function b(a,b,c,e,f,g){var i=c.deviceList;c=c.keyIndex;i!=null||h(0,75739,b);c!=null||h(0,75740,b);var j=c.ts,k=c.signedKeyIndexBytes;if(b==="add"){k!=null||h(0,75741,b);return d("WAWebHandleAdvDeviceNotificationApi").handleDeviceAddNotification(a,i,j,k,e,f,g)}if(b==="remove")return d("WAWebHandleAdvDeviceNotificationApi").handleDeviceRemoveNotification(i,c.ts,f)}g.handleADVSyncResult=a;g.handleDeviceNotification=b}),98);
__d("WAWebHandleAdvKeyIndexResultApi",["invariant","WAJids","WALogger","WALongInt","WAWebAdvExpectedTsApi","WAWebBizCoexGatingUtils","WAWebBizCoexHostedAddVerification","WAWebDeviceListPk","WAWebHandleAdvDeviceNotificationUtils","WAWebProtobufsAdv.pb"],(function(a,b,c,d,e,f,g,h){function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Clear record to force hosted notification update"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Clear record due to mismatch between local ADV account type and incoming ADV account type of "," for ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleKeyIndexResult: add to coex cache for ",""]);k=function(){return a};return a}var l=99;function a(a,b,c,e,f,g,m,n){if((g==null?void 0:g.timestamp)!=null&&c<g.timestamp)return null;if(f==null)return null;f=d("WAWebHandleAdvDeviceNotificationUtils").decodeSignedKeyIndexBytes(f,e);if(!f)return null;e=f.rawId;var o=d("WALongInt").numberOrThrowIfTooLarge(f.timestamp),p=null;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(p=f.accountType,p===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(d("WALogger").LOG(k(),a==null?void 0:a.toLogString()),d("WAWebBizCoexHostedAddVerification").addToCoexHostedVerificationCache(a)));if(o!==c)return null;c=!1;var q=null;b=b;if(g&&!g.deleted){b==null&&(b=g.devices);g.rawId!==e?c=!0:q=g.devices;if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){var r=g.advAccountType!=null&&g.advAccountType!==p||g!=null&&p===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&p!==(g==null?void 0:g.advAccountType);r&&(c=!0,d("WALogger").LOG(j(),p,a==null?void 0:a.toLogString()))}}else if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){r=p===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(g==null?void 0:g.deletedChangedToHost)!==!0;r&&(c=!0,d("WALogger").DEV(i()))}var s=new Map(),t=new Set(f.validIndexes),u=f.currentIndex||0;b&&b.forEach(function(a){a.keyIndex!=null&&t.has(a.keyIndex)&&(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(a.id===l&&(a.isHosted===!0||h(0,76137))),s.set(a.id,a.keyIndex))});q!=null&&q.forEach(function(a){a.keyIndex>u&&s.set(a.id,a.keyIndex)});s.set(d("WAJids").DEFAULT_DEVICE_ID,0);r=Array.from(s.entries()).map(function(a){var b=a[0];a=a[1];return d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&b===l?{id:b,keyIndex:a,isHosted:!0}:{id:b,keyIndex:a}});b=o;q={id:d("WAWebDeviceListPk").createDeviceListPK(a),rawId:e,timestamp:b,validIndexes:Array.from(t),devices:r,currentIndex:f.currentIndex,deleted:!1,advAccountType:p};!c&&!d("WAWebAdvExpectedTsApi").shouldClearExpectedTs(o,n,g,m)&&(g&&!g.deleted&&(q.expectedTs=g.expectedTs,q.expectedTsLastDeviceJobTs=g.expectedTsLastDeviceJobTs,q.expectedTsUpdateTs=g.expectedTsUpdateTs));return{update:q,clearRecord:c}}g.handleKeyIndexResult=a}),98);
__d("WAWebGroupsParticipantsApi",["WAWebAdvSyncDeviceListApi","WAWebDBGroupParticipant","WAWebDBParticipantTypes","WAWebGroupType","WAWebOfflineDeviceCache","WAWebPnhCagIncognito","WAWebSchemaGroupMetadata","WAWebSchemaParticipant","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.group,c=a.participants,e=a.isOffline,f=a.groupInfo;a=a.skipDeviceSync;a=a===void 0?!1:a;var g=[],h=[];c.forEach(function(a){a.isAdmin&&g.push(a.id),a.isSuperAdmin&&h.push(a.id)});var i=d("WAWebUserPrefsMeUser").getMaybeMeUser(),j=g.some(function(a){return i&&i.equals(a)}),k=!1;f!=null&&(k=Boolean(f.incognito)&&Boolean(f.defaultSubgroup));k=k?d("WAWebPnhCagIncognito").augmentedCagGroupParticipantList(j,c):c.map(function(a){a=a.id;return a});a?j=k:j=(yield q(k,e));return d("WAWebDBGroupParticipant").replaceParticipants({group:b,participants:c,admins:g,superAdmins:h,deviceIds:j,groupInfo:f})});return h.apply(this,arguments)}function e(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.group,e=a.participants,f=a.isOffline;a=a.reason;var g=!1,h=b.toString(),i=!1,j=[],k=d("WAWebUserPrefsMeUser").assertGetMeUser(),l=(yield d("WAWebSchemaGroupMetadata").getGroupMetadataTable().get(h));if(l==null)throw c("err")("addParticipants: groupMetadataRecord is null");var m=l.isLidAddressingMode===!0,n=e.some(function(a){return a.id.isLid()});h=(yield d("WAWebSchemaParticipant").getParticipantTable().get(h));h!=null&&(g=Boolean(l.defaultSubgroup),j=h.admins.map(function(a){return d("WAWebWidFactory").createWid(a)}),i=j.some(function(a){return k&&k.equals(a)})||a===d("WAWebGroupType").ADD_REASON.DEFAULT_SUBGROUP_PROMOTE);if(n&&!g&&!m)return;h=e.map(function(a){a=a.id;return a});g&&(h=a===d("WAWebGroupType").ADD_REASON.DEFAULT_SUBGROUP_PROMOTE?[].concat(j,h,[k]):d("WAWebPnhCagIncognito").augmentedCagGroupParticipantList(i,e));n=(yield q(h,f));return d("WAWebDBGroupParticipant").updateDBParticipants(b,{action:d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.ADD,participants:e,deviceIds:n},l,f)});return i.apply(this,arguments)}function f(a){var b=a.group,c=a.participants,e=a.timestamp,f=a.author,g=a.reason,h=a.groupMetadata;a=a.isOffline;return d("WAWebDBGroupParticipant").updateDBParticipants(b,{action:d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.REMOVE,participants:c,timestamp:e,author:f,reason:g},h,a)}function j(a){var b=a.group,c=a.participants,e=a.groupMetadata;a=a.isOffline;return d("WAWebDBGroupParticipant").updateDBParticipants(b,{action:d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.DEMOTE,participants:c},e,a)}function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.group,c=a.participants,e=a.groupMetadata;a=a.isOffline;var f=b.toString(),g=d("WAWebUserPrefsMeUser").assertGetMeUser(),h=c.some(function(a){return g.equals(a.id)}),i;if(h){h=(yield d("WAWebSchemaParticipant").getParticipantTable().get(f));if(h!=null){f=Boolean(e.defaultSubgroup);f&&(f=h.admins.map(function(a){return d("WAWebWidFactory").createWid(a)}),i=(yield q([].concat(f,[g]),a)))}}return d("WAWebDBGroupParticipant").updateDBParticipants(b,{action:d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.PROMOTE,participants:c,deviceIds:i},e,a)});return l.apply(this,arguments)}function m(a){var b=a.group,c=a.participants;a=a.isOffline;return d("WAWebDBGroupParticipant").updateCommunityParticipants(b,{action:d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_PROMOTE,participants:c},a)}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.group;a=a.newSuperAdmin;return d("WAWebDBGroupParticipant").setDBGroupSuperAdmin(b,a)});return o.apply(this,arguments)}function p(a){var b=a.group,c=a.participants;a=a.isOffline;return d("WAWebDBGroupParticipant").updateCommunityParticipants(b,{action:d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_DEMOTE,participants:c},a)}function q(a,b){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b===void 0&&(b=!1);if(b){a.forEach(function(a){d("WAWebOfflineDeviceCache").OfflinePendingDeviceCache.addOfflinePendingDevice(String(a))});return a}b=(yield d("WAWebAdvSyncDeviceListApi").syncAndGetDeviceList(a));var c=[];b.forEach(function(b,e){if(!b)c.push(a[e]);else{var f=b.id;e=b.devices;c=c.concat(e.map(function(a){return d("WAWebWidFactory").createDeviceWidFromDeviceListPk(f,a.id,a.isHosted)}))}});return c});return r.apply(this,arguments)}function s(a){return d("WAWebSchemaParticipant").getParticipantTable().bulkGet(a.map(function(a){return a.toString()}))}function t(a){return d("WAWebSchemaParticipant").getParticipantTable().get(a.toString())}function u(a){a=a==null?void 0:a.participants;if(a==null)return!1;var b=d("WAWebUserPrefsMeUser").getMaybeMeUser();if(b!=null&&a.includes(b.toString()))return!0;b=d("WAWebUserPrefsMeUser").getMaybeMeLidUser();return b!=null&&a.includes(b.toString())?!0:!1}function v(a){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return u(yield t(a))});return w.apply(this,arguments)}function x(a){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return(yield s(a)).map(u)});return y.apply(this,arguments)}g.updateParticipants=a;g.addParticipants=e;g.removeParticipants=f;g.demoteParticipants=j;g.promoteParticipants=k;g.promoteCommmunityParticipants=m;g.setGroupSuperAdmin=n;g.demoteCommmunityParticipants=p;g.bulkGetParticipants=s;g.getParticipants=t;g.checkMyMembership=v;g.bulkCheckMyMembership=x}),98);
__d("WAWebApiUnjoinedSubgroupMetadataStore",["WAWebSchemaUnjoinedSubgroupMetadata","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().remove(a.toString())}function h(a){var b={},c=a.defaultSubgroup,d=a.generalSubgroup,e=a.parentGroupId,f=babelHelpers.objectWithoutPropertiesLoose(a,["defaultSubgroup","generalSubgroup","parentGroupId"]);c!=null&&(b.defaultSubgroup=c);d!=null&&(b.generalSubgroup=d);e!=null&&(b.parentGroup=e.toString());return babelHelpers["extends"]({},f,b,{id:a.id.toString(),hiddenSubgroup:(c=a.hiddenSubgroup)!=null?c:!1,membershipApprovalMode:(d=a.membershipApprovalMode)!=null?d:!1,membershipApprovalRequest:(e=a.membershipApprovalRequest)!=null?e:!1})}function c(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.unjoinedSubgroups,c=a.parentGroupId;a=a.link;if(!a){yield d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().bulkRemove(b.map(function(a){return a.id.toString()}));return}a=[];var e=(yield d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().bulkGet(b.map(function(a){return a.id.toString()})));a=b.map(function(a,b){b=e[b];var d={subject:a.subject,subjectTime:a.subjectTime||0};if(b){var f=b.subjectTime||0;f>d.subjectTime&&(d={subject:b.subject,subjectTime:f})}return h(babelHelpers["extends"]({},a,d,{parentGroupId:c}))});yield d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().bulkCreateOrMerge(a)});return i.apply(this,arguments)}function e(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.unjoinedSubgroupIds;a=a.parentGroupId;a=(yield d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().equals(["parentGroup"],a.toString()));a=a.map(function(a){return a.id});var c=b.map(function(a){return a.toString()});b=a.filter(function(a){return!c.includes(a)});yield d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().bulkRemoveByIndex(["id"],b)});return j.apply(this,arguments)}function f(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().get(a.toString()));if(a!=null){a=babelHelpers["extends"]({},a,{membershipApprovalRequest:b});yield d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().bulkCreateOrMerge([a])}});return k.apply(this,arguments)}function l(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().bulkGet(a.map(function(a){return a.id.toString()}))),c=[];a.forEach(function(a,d){d=b[d];d&&c.push(babelHelpers["extends"]({},d,{size:a.participantCount}))});yield d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().bulkCreateOrMerge(c)});return m.apply(this,arguments)}g.removeUnjoinedSubgroupMetadataFromStorage=a;g.updateUnjoinedSubgroups=c;g.cleanUnjoinedSubgroups=e;g.updateMembershipApprovalRequestinDB=f;g.updateSizeInDB=l}),98);
__d("WAWebGroupUnjoinedSubgroupJob",["WAJobOrchestratorTypes","WAWebApiUnjoinedSubgroupMetadataStore","WAWebOrchestratorNonPersistedJob"],(function(a,b,c,d,e,f,g){function a(a,b,c){c===void 0&&(c=!0);return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("updateUnjoinedSubgroups",function(a){return d("WAWebApiUnjoinedSubgroupMetadataStore").updateUnjoinedSubgroups(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted({unjoinedSubgroups:a,parentGroupId:b,link:c})}function b(a,b){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("cleanUnjoinedSubgroups",function(a){return d("WAWebApiUnjoinedSubgroupMetadataStore").cleanUnjoinedSubgroups(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted({unjoinedSubgroupIds:a,parentGroupId:b})}g.updateUnjoinedSubgroupsJob=a;g.cleanUnjoinedSubgroupsJob=b}),98);
__d("WAWebUpdateDbForCommunityAction",["Promise","WAWebDBCommunity","WAWebDBGroupsGroupMetadata","WAWebGroupUnjoinedSubgroupJob","WAWebGroupsParticipantsApi","WAWebSchemaChat","WAWebSchemaGroupMetadata","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(a,b){return l(a,b,!1)}function j(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){a=(yield (h||(h=b("Promise"))).all([d("WAWebDBCommunity").getJoinedSubgroupsMetadata(d("WAWebWidFactory").createWid(a.id)).then(function(a){return a.filter(function(a){return!d("WAWebWidFactory").createWid(a.id).equals(c)})}),d("WAWebDBCommunity").getUnjoinedSubgroupsMetadata(d("WAWebWidFactory").createWid(a.id))]));var f=a[0];a=a[1];f=f.concat(a).map(function(a){var b=a.id;a=a.subject;return{id:d("WAWebWidFactory").createWid(b),subject:a}});return i(e,f)});return k.apply(this,arguments)}function l(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b.forEach(function(b){b.parentGroupId=c?a:void 0,b.generalSubgroup=c?b.generalSubgroup:void 0,b.hiddenSubgroup=c?b.hiddenSubgroup:void 0});b=p(b,yield n(b.map(function(a){return a.id})));var e=b.joinedSubgroups;b=b.unjoinedSubgroups;e=e.map(function(b){return d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(b.id,{parentGroup:c?a.toString():void 0,generalSubgroup:c?b.generalSubgroup:void 0,hiddenSubgroup:c?b.hiddenSubgroup:void 0})});b=d("WAWebGroupUnjoinedSubgroupJob").updateUnjoinedSubgroupsJob(b,a,c);return[].concat(e,[b])});return m.apply(this,arguments)}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Map((yield d("WAWebGroupsParticipantsApi").bulkGetParticipants(a)).filter(Boolean).map(function(a){return[a.groupId,a.participants]})),c=d("WAWebUserPrefsMeUser").assertGetMeUser().toString();return function(a){return(a=(a=b.get(a.toString()))==null?void 0:a.includes(c))!=null?a:!1}});return o.apply(this,arguments)}function p(a,b){return a.reduce(function(a,c){b(c.id)?a.joinedSubgroups=a.joinedSubgroups.concat(c):a.unjoinedSubgroups=a.unjoinedSubgroups.concat(c);return a},{joinedSubgroups:[],unjoinedSubgroups:[]})}function a(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=[],e=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(a));if((e==null?void 0:e.isParentGroup)!==!0)return c;var f={suspended:!0,terminated:!0};c.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(a,f,b));var g=(yield d("WAWebDBCommunity").getDefaultSubgroup(a));g!=null&&(yield d("WAWebGroupsParticipantsApi").checkMyMembership(g))&&c.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,f,b));f=(yield j(e,g,a));c.push.apply(c,f);return c});return q.apply(this,arguments)}function r(a){var b=[];b.push(d("WAWebSchemaGroupMetadata").getGroupMetadataTable().remove(a.toString()));b.push(d("WAWebSchemaChat").getChatTable().remove(a.toString()));return b}function c(a,b,c){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=[];a=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(a));if(a==null||a.defaultSubgroup!==!0)return e;a=a.parentGroup;a!=null&&e.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(d("WAWebWidFactory").createWid(a),{suspended:b},c));return e});return s.apply(this,arguments)}function e(a,b){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=[],e=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(a));if(e==null||e.isParentGroup!==!0)return c;var f=(yield d("WAWebDBCommunity").getDefaultSubgroup(a));f!=null&&(yield d("WAWebGroupsParticipantsApi").checkMyMembership(f))&&c.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(f,{terminated:!0,parentGroup:void 0},b));b=(yield j(e,f,a));c.push.apply(c,b);c.push.apply(c,r(a));return c});return t.apply(this,arguments)}function f(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[];if(!a)return b;var c=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(a));if(!c||c.isParentGroup!==!0)return b;var e=(yield d("WAWebDBCommunity").getDefaultSubgroup(a));c=e==null?[]:yield j(c,e,a);b.push.apply(b,c);b.push.apply(b,r(a));return b});return u.apply(this,arguments)}g.databaseUpdatesForSubgroupUnlink=i;g.partitionSubgroups=p;g.databaseUpdatesForIntegrityDeactivateCommunity=a;g.maybeUpdateCommunitySuspendedStatus=c;g.databaseUpdatesForDeactivateCommunity=e;g.databaseUpdatesForExitedCommunity=f}),98);
__d("WAWebEphemeralityUtils",["WAWebEphemeralityTypes","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){switch(a){case d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings:return 1;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.BulkChange:return 3;default:return null}}function b(a,b){return b==null?a>0?1:null:a===b?2:1}function c(a){switch(a){case 1:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings;case 2:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings;case 3:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.BulkChange;default:return null}}function e(a){switch(a){case"1":return d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings;case"2":return d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings;case"3":return d("WAWebEphemeralityTypes").DisappearingModeTrigger.BulkChange;default:return null}}function f(a){switch(a){case"chat_settings":return d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings;case"account_settings":return d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings;case"bulk_change":return d("WAWebEphemeralityTypes").DisappearingModeTrigger.BulkChange;case"biz_supports_fb_hosting":return d("WAWebEphemeralityTypes").DisappearingModeTrigger.BizSupportFbHosting;case"unknown_groups":return d("WAWebEphemeralityTypes").DisappearingModeTrigger.UnknownGroups;case"unknown":default:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.Unknown}}function h(a){switch(a){case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.CHAT_SETTING:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings;case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.ACCOUNT_SETTING:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings;case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.BULK_CHANGE:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.BulkChange;case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.BIZ_SUPPORTS_FB_HOSTING:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.BizSupportFbHosting;case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.UNKNOWN_GROUPS:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.UnknownGroups;default:return}}g.getGroupEphemeralTrigger=a;g.getEphemeralTriggerForGroupCreation=b;g.getDisappearingModeTrigger=c;g.getDisappearingModeTriggerString=e;g.getDisappearingModeTriggerFromString=f;g.getDisappearingModeTriggerFromProtobuf=h}),98);
__d("WAWebDBGroupMembeshipApprovalRequest",["WABatcher","WALogger","WAWebModelStorageUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["removeMembershipApprovalRequestsBatched: aggregating "," changes"]);h=function(){return a};return a}var i=3e3,j=function(){return d("WABatcher").batch({delayMs:i},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").DEV(h(),a.length).devConsole(a);var b=a.flatMap(function(a){var b=a.id.toString();return a.requests.map(function(a){return[b,a.toString()]})});yield d("WAWebModelStorageUtils").getStorage().lock(["pending-membership-approval-request"],function(a){a=a[0];return a.bulkRemove(b)});return b.map(function(a){return void 0})});return function(b){return a.apply(this,arguments)}}())}();function a(a,b,c){c===void 0&&(c=!1);if(c)return j({id:a,requests:b});var e=a.toString();return d("WAWebModelStorageUtils").getStorage().lock(["pending-membership-approval-request"],function(a){a=a[0];return a.bulkRemove(b.map(function(a){return[e,a.toString()]}))})}g.removeMembershipApprovalRequests=a}),98);
__d("WAWebGroupsMembershipApprovalRequestsApi",["WAWebDBGroupMembeshipApprovalRequest"],(function(a,b,c,d,e,f,g){function a(a){var b=a.group,c=a.requests;a=a.isOffline;return d("WAWebDBGroupMembeshipApprovalRequest").removeMembershipApprovalRequests(b,c,a)}g.removeMembershipApprovalRequests=a}),98);
__d("WAWebGroupMembershipApprovalRequestsJob",["WAJobOrchestratorTypes","WAWebGroupsMembershipApprovalRequestsApi","WAWebOrchestratorNonPersistedJob"],(function(a,b,c,d,e,f,g){function a(a,b,c){a={group:a,requests:b,isOffline:c};return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("removeMembershipApprovalRequests",function(a){return d("WAWebGroupsMembershipApprovalRequestsApi").removeMembershipApprovalRequests(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(a)}g.removeMembershipApprovalRequestsJob=a}),98);
__d("WAWebDBBulkPersistContact",["WABatcher","WALogger","WAWebLidAwareContactsDB","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["bulkPersistContactChanges: persisting "," records"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["bulkPersistContactChanges: processing "," records"]);i=function(){return a};return a}var j=d("WABatcher").batch({delayMs:3e3},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield k(a);return a.map(function(a){return void 0})});return function(b){return a.apply(this,arguments)}}());function a(a,b){return j(babelHelpers["extends"]({},b,{id:a.toJid()}))}function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").DEV(i(),a.length);b=b();d("WALogger").DEV(h(),a.length);yield c("WAWebLidAwareContactsDB").bulkCreateOrMerge(b);function b(){return Array.from(a.reduce(function(a,b){var c;a.set(b.id,babelHelpers["extends"]({},(c=a.get(b.id))!=null?c:{},b));return a},new Map()).values())}});return l.apply(this,arguments)}g.persistContactUpdateBatched=a}),98);
__d("WAWebHandlePushnameUpdate",["WALogger","WAWebBackendApi","WAWebDBBulkPersistContact","WAWebPromiseQueue","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["updatePushName: set pushname for ",""]);h=function(){return a};return a}var i=new(d("WAWebPromiseQueue").PromiseQueue)();function j(a,b){return d("WAWebBackendApi").frontendSendAndReceive("updatePushname",{contactId:a,pushname:b})}function a(a,c,e){e===void 0&&(e=!1);var f=d("WAWebWidFactory").toUserWid(a);return i.enqueue(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=void 0;e||(a=(yield j(f,c)));(a===!0||a===void 0)&&(d("WALogger").LOG(h(),f.toLogString()),void d("WAWebDBBulkPersistContact").persistContactUpdateBatched(f,{pushname:c}))}))}g.updatePushname=a}),98);
__d("WAWebNux",["$InternalEnum"],(function(a,b,c,d,e,f){var g={SAFARI_LIMITED_SUPPORT:"safari_limited_support",SENDER_REVOKE_LEGAL_DISCLAIMER_NUX:"revoke_legal_disclaimer_nux",SENDER_REVOKE_LEGAL_DISCLAIMER_NUX_NEW:"sender_revoke_legal_disclaimer_nux",ADMIN_REVOKE_LEGAL_DISCLAIMER_NUX:"admin_revoke_legal_disclaimer_nux",EPHEMERAL:"ephemeral",EPHEMERAL_VIEW_ONCE:"ephemeral_view_once",EPHEMERAL_VIEW_ONCE_RECEIVER:"ephemeral_view_once_receiver",COMMUNITY:"community",COMMUNITY_HOME:"community_home",STATUS_QUICK_REPLIES:"status_quick_replies",KEEP_IN_CHAT:"keep_in_chat",CHAT_ASSIGNMENT:"chat_assignment",TOOLTIP_AD_CREATION:"tooltip_ad_creation",DESKTOP_UPSELL:"desktop_upsell",FORWARD_MEDIA_WITH_CAPTION:"forward_media_with_caption",MESSAGE_EDIT:"message_edit",ORDER_REQUEST_EDUCATION:"order_request_education",NEWSLETTER_MULTI_ADMIN:"newsletter_multi_admin",SUPPORT_AI:"support_ai",EVENT_CREATE:"event_create",TOOLTIP_STATUS_ENTRY_POINT:"tooltip_status_entry_point",CAPI_GROUP_ABOUT_MODAL:"capi_group_about_modal",STATUS_PRIVATE_MENTIONS:"status_private_mentions",MESSAGE_LABEL_DEPRECATION_MIGRATED_PERMANENT:"message_label_deprecation_migrated_permanent",CAG_EVENTS_AWARENESS_BANNER:"cag_events_awareness_banner",ADD_TO_LISTS:"add_to_lists"};function h(a){return"community_admin_promote_"+a}function i(a){return"chat_auto_muted_"+a}function a(a){return"membership_approval_requests_banner_"+a}function c(a){return"newsletter_alerts_"+a}function d(a){return"subgroup_suggestions_banner_"+a}var j=b("$InternalEnum")({EPHEMERAL:"ephemeral",EPHEMERAL_VIEW_ONCE:"ephemeral_view_once",EPHEMERAL_VIEW_ONCE_RECEIVER:"ephemeral_view_once_receiver",ARCHIVE:"archive",STATUS_QUICK_REPLIES:"status_quick_replies",COMMUNITY:"community",COMMUNITY_HOME:"community_home",KEEP_IN_CHAT:"keep_in_chat",FORWARD_MEDIA_WITH_CAPTION:"forward_media_with_caption",MESSAGE_EDIT:"message_edit",NEWSLETTER_MULTI_ADMIN:"newsletter_multi_admin",SUPPORT_AI:"support_ai",EVENT_CREATE:"event_create",TOOLTIP_STATUS_ENTRY_POINT:"tooltip_status_entry_point",STATUS_PRIVATE_MENTIONS:"status_private_mentions",MESSAGE_LABEL_DEPRECATION_MIGRATED:"message_label_deprecation_migrated",ADD_TO_LISTS:"add_to_lists"});function e(a){switch(a){case g.EPHEMERAL:return j.EPHEMERAL;case g.EPHEMERAL_VIEW_ONCE:return j.EPHEMERAL_VIEW_ONCE;case g.EPHEMERAL_VIEW_ONCE_RECEIVER:return j.EPHEMERAL_VIEW_ONCE_RECEIVER;case g.STATUS_QUICK_REPLIES:return j.STATUS_QUICK_REPLIES;case g.COMMUNITY:return j.COMMUNITY;case g.COMMUNITY_HOME:return j.COMMUNITY_HOME;case g.KEEP_IN_CHAT:return j.KEEP_IN_CHAT;case g.FORWARD_MEDIA_WITH_CAPTION:return j.FORWARD_MEDIA_WITH_CAPTION;case g.MESSAGE_EDIT:return j.MESSAGE_EDIT;case g.NEWSLETTER_MULTI_ADMIN:return j.NEWSLETTER_MULTI_ADMIN;case g.SUPPORT_AI:return j.SUPPORT_AI;case g.TOOLTIP_STATUS_ENTRY_POINT:return j.TOOLTIP_STATUS_ENTRY_POINT;case g.STATUS_PRIVATE_MENTIONS:return j.STATUS_PRIVATE_MENTIONS;case g.MESSAGE_LABEL_DEPRECATION_MIGRATED_PERMANENT:return j.MESSAGE_LABEL_DEPRECATION_MIGRATED;case g.ADD_TO_LISTS:return j.ADD_TO_LISTS;default:return a.includes(h(""))||a.includes(i(""))?a:null}}b={COOL_OFF_NUX:{INCOMPLETE_BUSINESS_PROFILE_BANNER:"incomplete_business_profile_banner",PRODUCT_CATALOG_BANNER:"product_catalog_banner",COLLECTIONS:"collections_banner",CART_INTERSTITIAL:"cart_interstitial",CTWA_SUGGESTION:"ctwa_suggestion",ORDER_EXPANSION:"order_expansion",MESSAGE_LABEL_DEPRECATION_MIGRATED_CHAT_LIST:"message_label_deprecation_migrated_chat_list"},VIEW_COUNT_NUX:{SAFARI_LIMITED_SUPPORT:"safari_limited_support",SENDER_REVOKE_LEGAL_DISCLAIMER_NUX:"revoke_legal_disclaimer_nux",ADMIN_REVOKE_LEGAL_DISCLAIMER_NUX:"admin_revoke_legal_disclaimer_nux",EPHEMERAL:"ephemeral",EPHEMERAL_VIEW_ONCE:"ephemeral_view_once",EPHEMERAL_VIEW_ONCE_RECEIVER:"ephemeral_view_once_receiver",COMMUNITY:"community",COMMUNITY_HOME:"community_home",KEEP_IN_CHAT:"keep_in_chat",CHAT_ASSIGNMENT:"chat_assignment",TOOLTIP_AD_CREATION:"tooltip_ad_creation",DESKTOP_UPSELL:"desktop_upsell",FORWARD_MEDIA_WITH_CAPTION:"forward_media_with_caption",MESSAGE_EDIT:"message_edit",ORDER_REQUEST_EDUCATION:"order_request_education",NEWSLETTER_MULTI_ADMIN:"newsletter_multi_admin",SUPPORT_AI:"support_ai",TOOLTIP_STATUS_ENTRY_POINT:"tooltip_status_entry_point",CAPI_GROUP_ABOUT_MODAL:"capi_group_about_modal",STATUS_PRIVATE_MENTIONS:"status_private_mentions",MESSAGE_LABEL_DEPRECATION_MIGRATED_PERMANENT:"message_label_deprecation_migrated_permanent",CAG_EVENTS_AWARENESS_BANNER:"cag_events_awareness_banner",ADD_TO_LISTS:"add_to_lists"}};var k={DEFAULT:"default_cool_off_banners_key",CATALOG:"catalog_banners_key",CTWA_SUGGESTION:"ctwa_suggestion_banners_key",ORDER_EXPANSION:"order_expansion_banner_key",MESSAGE_LABEL_DEPRECATION_MIGRATED_CHAT_LIST:"message_label_deprecation_migrated_chat_list_key"};function l(a){return a+"_cool_off"}f.NUX=g;f.getCommunityAdminPromotionNuxKey=h;f.getChatAutoMutedNuxKey=i;f.getMembershipApprovalRequestsBannerNuxKey=a;f.getNewsletterAlertsBannerNuxKey=c;f.getSubgroupSuggestionsBannerNuxKey=d;f.NuxSyncKey=j;f.getNuxSyncKey=e;f.NuxKeyTypes=b;f.CoolOffPeriodKeys=k;f.asCoolOffNuxType=l}),66);
__d("WAWebSubgroupSuggestionsJob",["WAJobOrchestratorTypes","WAWebApiSubgroupSuggestionStore","WAWebOrchestratorNonPersistedJob"],(function(a,b,c,d,e,f,g){function a(a,b){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("removeSubgroupSuggestions",function(a){return d("WAWebApiSubgroupSuggestionStore").removeSubgroupSuggestionsWithOfflineOption(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted({subgroupSuggestions:a,isOffline:b})}g.removeSubgroupSuggestionsJob=a}),98);
__d("WAWebUpdateDbForGroupActionApi",["Promise","WAFilteredCatch","WALogger","WANullthrows","WATimeUtils","WAWebABProps","WAWebApiMembershipApprovalRequestStore","WAWebApiParticipantStore","WAWebApiSubgroupSuggestionStore","WAWebCommunityGatingUtils","WAWebDBCommunity","WAWebDBCommunityTypes","WAWebDBGroupsGroupMetadata","WAWebDBParticipantTypes","WAWebDBRevokeInviteV4","WAWebEphemeralityUtils","WAWebGroupDatabaseJob","WAWebGroupMembershipApprovalRequestsJob","WAWebGroupParticipantsJob","WAWebGroupQueryBridge","WAWebGroupType","WAWebHandlePushnameUpdate","WAWebNux","WAWebNuxAction","WAWebQueryAndUpdateSubgroupSuggestionsJob","WAWebSubgroupSuggestionsJob","WAWebUpdateDbForCommunityAction","WAWebUserPrefsGeneral","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["finished all storageTasks"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["unhandled group notif action in handleGroupActionMD for action ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["communityOwnerUpdate: out-of-sync group notification"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["modifyGroupParticipant: out-of-sync group notification"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["_handleGroupActionMD: participants length should be 1, but is ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received group invite revokation from ",", but user not in participants list"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received revoke without an admin jid ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["getMaybeMeUser returned null, can't process action ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["linkedGroupDemote: out-of-sync group notification"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["linkedGroupPromote: out-of-sync group notification"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["removeParticipants: out-of-sync group notification"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["removeParticipants: out-of-sync group notification"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["removeParticipants: out-of-sync group notification"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["addParticipants: out-of-sync group notification"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["inside _handleGroupActionMD"]);w=function(){return a};return a}function a(a,b,c){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){f===void 0&&(f=!1);d("WALogger").LOG(w()).tags("groups");var g=a.chatId,x=a.author,z=a.pushname,B=a.ts,C=B===void 0?Date.now()/1e3:B;x&&z&&d("WAWebHandlePushnameUpdate").updatePushname(x,z,f);B=[];switch(e.actionType){case d("WAWebGroupType").GROUP_ACTIONS.ADD:B.push(d("WAWebGroupParticipantsJob").addParticipantsJob(g,e.participants,f,e.reason)["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebDBParticipantTypes").GroupUnSyncedError,function(){d("WALogger").WARN(v()),A(g,f)})));d("WAWebABProps").getABPropConfigValue("group_join_request_m2")&&B.push(d("WAWebGroupMembershipApprovalRequestsJob").removeMembershipApprovalRequestsJob(a.chatId,e.participants.map(function(a){return a.id}),f));break;case d("WAWebGroupType").GROUP_ACTIONS.REMOVE:z=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(g));if(z==null)break;var D=e.reason!==d("WAWebGroupType").REMOVE_REASON.DEFAULT_SUBGROUP_DEMOTE&&e.participants.some(function(a){a=a.id;return d("WAWebUserPrefsMeUser").isMeAccount(a)})&&(yield d("WAWebDBCommunity").isLastJoinedSubgroup(z));B.push(d("WAWebGroupParticipantsJob").removeParticipantsJob(g,e.participants,C,a.author,e.reason,z,f)["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebDBParticipantTypes").GroupUnSyncedError,function(){d("WALogger").WARN(u()),A(g,f)})));e.participants.find(function(a){a=a.id;return d("WAWebUserPrefsMeUser").isMeAccount(a)})&&(d("WAWebUserPrefsGeneral").removeUserSentMessageToChat(g),d("WAWebApiParticipantStore").setAdminshipCache(g.toString(),!1));if(D){D=z==null?void 0:z.parentGroup;z=(yield d("WAWebUpdateDbForCommunityAction").databaseUpdatesForExitedCommunity(D!=null?d("WAWebWidFactory").createWid(D):null));B.push.apply(B,z)}break;case d("WAWebGroupType").GROUP_ACTIONS.DEMOTE:D=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(g));if(D==null)break;e.participants.find(function(a){a=a.id;return d("WAWebUserPrefsMeUser").isMeAccount(a)})&&(d("WAWebApiParticipantStore").setAdminshipCache(g.toString(),!1),d("WAWebABProps").getABPropConfigValue("group_join_request_m2")&&B.push(d("WAWebApiMembershipApprovalRequestStore").removeAllMembershipApprovalRequests(g)),yield y(D,g));B.push(d("WAWebGroupParticipantsJob").demoteParticipantsJob(g,e.participants,D,f)["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebDBParticipantTypes").GroupUnSyncedError,function(){d("WALogger").WARN(t()),A(g,f)})));break;case d("WAWebGroupType").GROUP_ACTIONS.PROMOTE:z=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(g));if(z==null)break;var E=d("WAWebUserPrefsMeUser").getMaybeMeUser();if(E&&e.participants.find(function(a){a=a.id;return a.equals(E)})){if(d("WAWebCommunityGatingUtils").communityAdminPromotionOneTimePromptEnabled()&&z!=null&&d("WAWebGroupType").getGroupTypeFromGroupMetadata(z)===d("WAWebGroupType").GroupType.COMMUNITY){D=d("WAWebNux").getCommunityAdminPromotionNuxKey(z.id.toString());d("WAWebNuxAction").resetNux(D)}d("WAWebApiParticipantStore").setAdminshipCache(g.toString(),!0);yield y(z,g)}B.push(d("WAWebGroupParticipantsJob").promoteParticipantsJob(g,e.participants,z,f)["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebDBParticipantTypes").GroupUnSyncedError,function(){d("WALogger").WARN(s()),A(g,f)})));break;case d("WAWebGroupType").GROUP_ACTIONS.LINKED_GROUP_PROMOTE:if(!e.jid)break;var F=e.jid;D=(yield d("WAWebApiParticipantStore").isCurrentUserGroupAdmin(F.toString()));D||B.push(d("WAWebGroupParticipantsJob").promoteCommunityParticipantsJob(F,e.participants,f)["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebDBParticipantTypes").GroupUnSyncedError,function(){d("WALogger").WARN(r()),A(F,f)})));break;case d("WAWebGroupType").GROUP_ACTIONS.LINKED_GROUP_DEMOTE:if(!e.jid)break;var G=e.jid;z=(yield d("WAWebApiParticipantStore").isCurrentUserGroupAdmin(G.toString()));z||B.push(d("WAWebGroupParticipantsJob").demoteCommunityParticipantsJob(G,e.participants,f)["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebDBParticipantTypes").GroupUnSyncedError,function(){d("WALogger").WARN(q()),A(G,f)})));break;case d("WAWebGroupType").GROUP_ACTIONS.REVOKE_INVITE:var H=(D=d("WAWebUserPrefsMeUser").getMaybeMeUser())==null?void 0:D.toString();if(!H){d("WALogger").WARN(p(),e);return}z=x==null?void 0:x.toString();D=[];if(z==null){d("WALogger").WARN(o(),e);return}if(z===H)D=e.participants.map(function(a){return{from:H,to:a.id.toString(),groupId:g.toString(),expiration:a.expiration}});else{var I=e.participants.find(function(a){return a.id.toString()===H});if(!I){d("WALogger").ERROR(n(),z).sendLogs("bad-revoke");return}D=[{from:z,to:H,groupId:g.toString(),expiration:I.expiration}]}yield (h||(h=b("Promise"))).all(D.map(function(a){return d("WAWebDBRevokeInviteV4").revokeGroupInviteV4(a.from,a.to,a.groupId,a.expiration)}));break;case d("WAWebGroupType").GROUP_ACTIONS.MODIFY:if(e.participants.length!==1){d("WALogger").WARN(m(),e.participants.length);break}B.push(d("WAWebGroupDatabaseJob").modifyGroupParticipantJob(g,c("WANullthrows")(x),e.participants[0].id)["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebDBParticipantTypes").GroupUnSyncedError,function(){d("WALogger").WARN(l()),A(g,f)})));break;case d("WAWebGroupType").GROUP_ACTIONS.SUBJECT:B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{subject:e.subject},f));break;case d("WAWebGroupType").GROUP_ACTIONS.DESC_ADD:B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{desc:e.desc,descId:e.descId,descTime:e.descTime,descOwner:x==null?void 0:x.toString()},f));break;case d("WAWebGroupType").GROUP_ACTIONS.DESC_REMOVE:B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{desc:void 0,descId:void 0,descTime:void 0,descOwner:void 0},f));break;case d("WAWebGroupType").GROUP_ACTIONS.RESTRICT:B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{restrict:!!e.value},f));break;case d("WAWebGroupType").GROUP_ACTIONS.SUSPEND:z=!!e.value;B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{suspended:z},f));I=(yield d("WAWebUpdateDbForCommunityAction").maybeUpdateCommunitySuspendedStatus(g,z,f));B.push.apply(B,I);break;case d("WAWebGroupType").GROUP_ACTIONS.ANNOUNCE:B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{announce:!!e.value},f));break;case d("WAWebGroupType").GROUP_ACTIONS.NO_FORWARD:B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{noFrequentlyForwarded:!!e.value},f));break;case d("WAWebGroupType").GROUP_ACTIONS.EPHEMERAL:if(d("WAWebABProps").getABPropConfigValue("dm_initiator_trigger_groups")){D=d("WAWebEphemeralityUtils").getDisappearingModeTrigger(e.trigger);B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{ephemeralDuration:e.duration,disappearingModeTrigger:D!=null?D:void 0,disappearingModeInitiatedByMe:e.initiatedByMe},f))}else B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{ephemeralDuration:e.duration},f));break;case d("WAWebGroupType").GROUP_ACTIONS.INVITE_CODE:break;case d("WAWebGroupType").GROUP_ACTIONS.DELETE_PARENT_GROUP_UNLINK:break;case d("WAWebGroupType").GROUP_ACTIONS.DELETE:if(e.reason===d("WAWebGroupType").DELETE_REASON.INTEGRITY_DELETE_PARENT){z=(yield d("WAWebUpdateDbForCommunityAction").databaseUpdatesForIntegrityDeactivateCommunity(g,f));B.push.apply(B,z)}else if(e.reason===d("WAWebGroupType").DELETE_REASON.DELETE_PARENT){I=(yield d("WAWebUpdateDbForCommunityAction").databaseUpdatesForDeactivateCommunity(g,f));B.push.apply(B,I)}else B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{terminated:!0},f));break;case d("WAWebGroupType").GROUP_ACTIONS.GROWTH_UNLOCKED:B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{growthLockExpiration:void 0,growthLockType:void 0},f));break;case d("WAWebGroupType").GROUP_ACTIONS.GROWTH_LOCKED:e.type==="invite"&&B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{growthLockExpiration:e.expiration,growthLockType:e.type},f));break;case d("WAWebGroupType").GROUP_ACTIONS.PARENT_GROUP_LINK:D=e.groupDatas[0].id;B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{parentGroup:D.toString()},f));break;case d("WAWebGroupType").GROUP_ACTIONS.SUB_GROUP_LINK:B.push(d("WAWebDBCommunity").persistCommunityLink(g,e.groupDatas,d("WAWebDBCommunityTypes").CommunityLinkOperation.SubGroupLink,f),d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{lastActivityTimestamp:d("WATimeUtils").unixTime()},f));break;case d("WAWebGroupType").GROUP_ACTIONS.SIBLING_GROUP_LINK:B.push(d("WAWebDBCommunity").persistCommunityLink(g,e.groupDatas,d("WAWebDBCommunityTypes").CommunityLinkOperation.SiblingGroupLink,f));break;case d("WAWebGroupType").GROUP_ACTIONS.PARENT_GROUP_UNLINK:B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{parentGroup:void 0},f));break;case d("WAWebGroupType").GROUP_ACTIONS.SUB_GROUP_UNLINK:B.push(d("WAWebDBCommunity").persistCommunityLink(g,e.groupDatas,d("WAWebDBCommunityTypes").CommunityLinkOperation.SubGroupUnlink,f));break;case d("WAWebGroupType").GROUP_ACTIONS.SIBLING_GROUP_UNLINK:B.push(d("WAWebDBCommunity").persistCommunityLink(g,e.groupDatas,d("WAWebDBCommunityTypes").CommunityLinkOperation.SiblingGroupUnlink,f));break;case d("WAWebGroupType").GROUP_ACTIONS.MEMBERSHIP_APPROVAL_MODE:d("WAWebABProps").getABPropConfigValue("group_join_request_m2")&&(B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{membershipApprovalMode:e.value},f)),e.value||B.push(d("WAWebApiMembershipApprovalRequestStore").removeAllMembershipApprovalRequests(g)));break;case d("WAWebGroupType").GROUP_ACTIONS.MEMBERSHIP_APPROVAL_REQUEST:if(d("WAWebABProps").getABPropConfigValue("group_join_request_m2")&&!d("WAWebABProps").getABPropConfigValue("group_join_request_m3")){B.push(d("WAWebApiMembershipApprovalRequestStore").addMembershipApprovalRequests(a.chatId,[{id:c("WANullthrows")(x),t:C,addedBy:c("WANullthrows")(x),requestMethod:e.requestMethod,parentGroupId:e.parentGroupId}]));z=d("WAWebNux").getMembershipApprovalRequestsBannerNuxKey(a.chatId.toString());d("WAWebNuxAction").resetNux(z)}break;case d("WAWebGroupType").GROUP_ACTIONS.ALLOW_ADMIN_REPORTS:B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,babelHelpers["extends"]({reportToAdminMode:e.value},!e.value&&{lastReportToAdminTimestamp:null}),f));break;case d("WAWebGroupType").GROUP_ACTIONS.ADMIN_REPORT_RECIEVED:B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{lastReportToAdminTimestamp:e.value},f));break;case d("WAWebGroupType").GROUP_ACTIONS.CREATED_MEMBERSHIP_REQUESTS:if(d("WAWebABProps").getABPropConfigValue("group_join_request_m2")&&d("WAWebABProps").getABPropConfigValue("group_join_request_m3")){B.push(d("WAWebApiMembershipApprovalRequestStore").addMembershipApprovalRequests(a.chatId,e.requests.map(function(a){return{id:a,t:C,addedBy:c("WANullthrows")(x),requestMethod:e.requestMethod,parentGroupId:e.parentGroupId}})));I=d("WAWebNux").getMembershipApprovalRequestsBannerNuxKey(a.chatId.toString());d("WAWebNuxAction").resetNux(I)}break;case d("WAWebGroupType").GROUP_ACTIONS.REVOKED_MEMBERSHIP_REQUESTS:d("WAWebABProps").getABPropConfigValue("group_join_request_m2")&&B.push(d("WAWebGroupMembershipApprovalRequestsJob").removeMembershipApprovalRequestsJob(a.chatId,e.requests,f));break;case d("WAWebGroupType").GROUP_ACTIONS.ALLOW_NON_ADMIN_SUB_GROUP_CREATION:B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{allowNonAdminSubGroupCreation:!!e.value},f));break;case d("WAWebGroupType").GROUP_ACTIONS.CREATED_SUBGROUP_SUGGESTION:B.push(d("WAWebApiSubgroupSuggestionStore").addSubgroupSuggestions(a.chatId,[{id:e.id,parentGroupId:e.parentGroupId,subject:e.subject,desc:e.description,owner:e.owner,t:e.t,isExistingGroup:(D=e.isExistingGroup)!=null?D:!1,participantCount:e.participantCount,hiddenSubgroup:e.hiddenSubgroup}]));z=d("WAWebNux").getSubgroupSuggestionsBannerNuxKey(a.chatId.toString());void d("WAWebNuxAction").resetNux(z);break;case d("WAWebGroupType").GROUP_ACTIONS.REVOKED_SUB_GROUP_SUGGESTIONS:B.push(d("WAWebSubgroupSuggestionsJob").removeSubgroupSuggestionsJob(e.subgroupSuggestions.map(function(a){var b=a.id;a=a.owner;return{parentGroupId:e.parentGroupId,id:b,owner:a}}),f));break;case d("WAWebGroupType").GROUP_ACTIONS.SUBGROUP_SUGGESTIONS_CHANGE_NUMBER:B.push(d("WAWebApiSubgroupSuggestionStore").updateOwnerInSubgroupSuggestions(e.parentGroupId,e.subgroupSuggestions,e.oldOwner,e.newOwner));break;case d("WAWebGroupType").GROUP_ACTIONS.MEMBER_ADD_MODE:d("WAWebABProps").getABPropConfigValue("web_anyone_can_add_group_setting_enabled")&&B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{memberAddMode:e.memberAddMode},f));break;case d("WAWebGroupType").GROUP_ACTIONS.GENERAL_CHAT_AUTO_ADD_DISABLED:B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{generalChatAutoAddDisabled:!0},f));break;case d("WAWebGroupType").GROUP_ACTIONS.COMMUNITY_OWNER_UPDATE:B.push(d("WAWebGroupParticipantsJob").setGroupSuperAdminJob(g,e.newOwner)["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebDBParticipantTypes").GroupUnSyncedError,function(){d("WALogger").WARN(k()),void A(g,f)})));break;case d("WAWebGroupType").GROUP_ACTIONS.HIDDEN_GROUP:B.push(d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(g,{hiddenSubgroup:!!e.value}));break;default:d("WALogger").ERROR(j(),JSON.stringify(e)).tags("groups");break}yield (h||(h=b("Promise"))).all(B);d("WALogger").LOG(i()).tags("groups")});return x.apply(this,arguments)}function y(a,b){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(a.isParentGroup===!0&&a.allowNonAdminSubGroupCreation!==!0&&d("WAWebCommunityGatingUtils").memberSuggestedGroupsEnabled()){a=(yield d("WAWebDBCommunity").getJoinedSubgroups(b));a[0]&&void d("WAWebQueryAndUpdateSubgroupSuggestionsJob").queryAndUpdateSubgroupSuggestions(b,a[0])}});return z.apply(this,arguments)}function A(a,b){return b?d("WAWebGroupDatabaseJob").markGroupParticipantStaleJob(a):d("WAWebGroupQueryBridge").sendQueryGroup(a)}function e(a,b){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(a));e!=null&&(e.disappearingModeTrigger=c,yield d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(a,{disappearingModeTrigger:c}));return(h||(h=b("Promise"))).resolve()});return B.apply(this,arguments)}g.updateDBForGroupAction=a;g.syncDisappearingModeTriggerToDB=e}),98);
__d("WAWebParseWebMessageInfoApi",["WAJids","WALogger","WANullthrows","WATimeUtils","WAWebABProps","WAWebABPropsSaga","WAWebBizCoexGatingUtils","WAWebBotTypes","WAWebCommunityGatingUtils","WAWebE2EProtoParser","WAWebE2EProtoParserApi","WAWebE2EProtoUtils","WAWebEphemeralKeepInChat","WAWebMessagingGatingUtils","WAWebMsgKey","WAWebMsgType","WAWebProcessBaseMsgInfo","WAWebProtobufsWeb.pb","WAWebReportingTokenUtils","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebWid","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["ProtocolParser: admin revoke came without admin JID"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseWebMessageInfo: KIC fields are malformed"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["drop: broadcast"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["drop: cannot create MsgKey: ",""]);k=function(){return a};return a}function l(a,b){var e=d("WAWebE2EProtoUtils").decodeJid(b.remoteJid),f=d("WAWebE2EProtoUtils").decodeJid(b.participant),g=d("WAWebUserPrefsMeUser").getMaybeMeUser(),h=d("WAWebE2EProtoUtils").decodeJid(a.participant);f==null&&e!=null&&c("WAWebWid").isWid(e)&&e===d("WAWebWidFactory").createWid(d("WAJids").PSA_JID)&&(f=d("WAWebWidFactory").createWid(d("WAJids").PSA_JID));(c("WAWebWid").isGroup(e)||c("WAWebWid").isStatus(e))&&(f==null&&(b.fromMe===!0?f=g:a.participant!=null&&(f=d("WAWebE2EProtoUtils").decodeJid(a.participant))),h=h||f);try{g=new(c("WAWebMsgKey"))({fromMe:c("WANullthrows")(b.fromMe),remote:e,id:c("WANullthrows")(b.id),participant:f});return{msgKey:g,author:h}}catch(a){d("WALogger").WARN(k(),a.stack);return}}function a(a){var b=a.key,e=d("WAWebE2EProtoUtils").decodeJid(b.remoteJid),f=d("WAWebUserPrefsMeUser").getMaybeMeUser(),g=b.fromMe?e:f,h=b.fromMe?f:e,k=l(a,b);if(k==null)return;var n=k.msgKey;k=k.author;var o="in";f.equals(e)&&(o=b.fromMe?"out":"in");if(g==="broadcast"){d("WALogger").WARN(j()).devConsole(a);return}f=!1;f=a.reactions.some(function(a){return a.text!=null});b={id:n,from:h,to:g,self:o,participant:n.participant,type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,kind:d("WAWebMsgType").MsgKind.Unknown,t:a.messageTimestamp||0,ack:a.status-1,author:k,invis:!!a.ignore,star:!!a.starred,broadcast:b.fromMe&&a.broadcast,notifyName:a.pushName||"",encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(a.mediaCiphertextSha256),shareDuration:a.duration,labels:a.labels,ephemeralStartTimestamp:a.ephemeralStartTimestamp,ephemeralOutOfSync:a.ephemeralOutOfSync,bizPrivacyStatus:a.bizPrivacyStatus,verifiedBizName:a.verifiedBizName,reactions:a.reactions,hasReaction:f,agentId:a.agentId,revokeTimestamp:a.revokeMessageTimestamp,kicKey:void 0,kicState:void 0,pollInvalidated:((e=a.pollAdditionalMetadata)==null?void 0:e.pollInvalidated)===!0,eventInvalidated:((h=a.eventAdditionalMetadata)==null?void 0:h.isStale)===!0,replyCount:(g=a.commentMetadata)==null?void 0:g.replyCount,originalSelfAuthor:d("WAWebE2EProtoUtils").decodeJid(a.originalSelfAuthorUserJidString),kicTimestampMs:void 0,pinInChat:a.pinInChat,pmCampaignId:(o=a.premiumMessageInfo)==null?void 0:o.serverCampaignId,bizSource:((k=a.premiumMessageInfo)==null?void 0:k.serverCampaignId)!=null?"smb_promo":void 0,bizBotType:a.is1PBizBotMessage===!0?d("WAWebBotTypes").BizBotType.BIZ_1P:null,botTargetSenderJid:a.botMessageInvokerJid!=null?d("WAWebE2EProtoUtils").decodeJid(a.botMessageInvokerJid):null};c("WAWebWid").isCAPISupportAccount(n.remote)&&a.isSupportAiMessage!=null&&d("WAWebABPropsSaga").getIsSagaProtobufAIStardustEnabled()&&(b.isSupportAIMessage=a.isSupportAiMessage);if(d("WAWebMessagingGatingUtils").isReportingTagSyncingEnabled()){b.reportingTokenInfo=a.reportingTokenInfo!=null?{reportingTag:(f=a.reportingTokenInfo)==null?void 0:f.reportingTag,version:d("WAWebReportingTokenUtils").REPORTING_TOKEN_VERSION.HISTORY_SYNC}:null}if(a.keepInChat!=null)try{e=d("WAWebEphemeralKeepInChat").parseKeepInChatHistorySyncMessage(a);e!=null&&Object.assign(b,e)}catch(a){d("WALogger").WARN(i()).devConsole(a)}return a.message?d("WAWebE2EProtoParser").parseMsgProto(a.message,b,"history",a.paymentInfo,a.finalLiveLocation,a.quotedPaymentInfo,null,null,null,b.bizSource):m(a,b)}function m(a,b){if(a.messageStubType==null)return;var c=d("WAWebProtobufsWeb.pb").WebMessageInfo$StubType;switch(a.messageStubType){case c.REVOKE:b.type="revoked";b.subtype="sender";b.kind=d("WAWebMsgType").MsgKind.RevokedMessage;var e=a.messageStubParameters;e=e!=null&&e.length>0?e[0]:null;if(e!=null){b.protocolMessageKey=(e=l(a,babelHelpers["extends"]({},a.key,{id:e})))==null?void 0:e.msgKey}return b;case c.CIPHERTEXT:b.type="ciphertext";b.kind=d("WAWebMsgType").MsgKind.Ciphertext;return b;case c.OVERSIZED:b.type="oversized";b.kind=d("WAWebMsgType").MsgKind.Oversized;return b;case c.FUTUREPROOF:b.kind=d("WAWebMsgType").MsgKind.Unknown;b.subtype="phone";return b;case c.CAPI_GROUP_NE2EE_SYSTEM_MESSAGE:b.type="notification_template";b.subtype="is_capi_hosted_group";return b;default:return n(a,b)}}function n(a,b){if(a.messageStubType==null)return;var e=d("WAWebProtobufsWeb.pb").WebMessageInfo$StubType;b.type="notification_template";b.kind=d("WAWebMsgType").MsgKind.NotificationTemplate;b.templateParams=Array.isArray(a.messageStubParameters)?a.messageStubParameters.map(function(b){return a.messageStubType===e.GROUP_CREATE||a.messageStubType===e.GROUP_CHANGE_SUBJECT?b:d("WAWebE2EProtoUtils").decodeJid(b)}):void 0;if(a.messageStubType==null){b.templateParams=void 0;return b}switch(a.messageStubType){case e.NON_VERIFIED_TRANSITION:b.subtype="non_verified_transition";break;case e.UNVERIFIED_TRANSITION:b.subtype="unverified_transition";break;case e.VERIFIED_TRANSITION:b.subtype="verified_transition";break;case e.VERIFIED_LOW_UNKNOWN:b.subtype="verified_low_unknown";break;case e.VERIFIED_HIGH:b.subtype="verified_high";break;case e.VERIFIED_INITIAL_UNKNOWN:b.subtype="verified_initial_unknown";break;case e.VERIFIED_INITIAL_LOW:b.subtype="verified_initial_low";break;case e.VERIFIED_INITIAL_HIGH:b.subtype="verified_initial_high";break;case e.VERIFIED_TRANSITION_ANY_TO_NONE:b.subtype="verified_transition_any_to_none";break;case e.VERIFIED_TRANSITION_ANY_TO_HIGH:b.subtype="verified_transition_any_to_high";break;case e.VERIFIED_TRANSITION_HIGH_TO_LOW:b.subtype="verified_transition_high_to_low";break;case e.VERIFIED_TRANSITION_HIGH_TO_UNKNOWN:b.subtype="verified_transition_high_to_unknown";break;case e.VERIFIED_TRANSITION_UNKNOWN_TO_LOW:b.subtype="verified_transition_unknown_to_low";break;case e.VERIFIED_TRANSITION_LOW_TO_UNKNOWN:b.subtype="verified_transition_low_to_unknown";break;case e.VERIFIED_TRANSITION_NONE_TO_LOW:b.subtype="verified_transition_none_to_low";break;case e.VERIFIED_TRANSITION_NONE_TO_UNKNOWN:b.subtype="verified_transition_none_to_unknown";break;case e.GROUP_CREATE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="create";b.body=b.templateParams[0];b.templateParams=void 0;break;case e.REPORT_TO_ADMIN_ENABLED_STATUS:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="allow_admin_reports";break;case e.GROUP_DELETE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="delete";b.templateParams=void 0;break;case e.GROUP_CHANGE_SUBJECT:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="subject";b.body=b.templateParams[0];b.templateParams=void 0;break;case e.GROUP_CHANGE_ICON:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="picture";b.body=b.templateParams[0];b.templateParams=void 0;break;case e.GROUP_CHANGE_INVITE_LINK:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="revoke_invite";break;case e.GROUP_CHANGE_DESCRIPTION:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="description";b.body=b.templateParams[0];break;case e.GROUP_CHANGE_RESTRICT:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="restrict";b.body=b.templateParams[0];break;case e.GROUP_CHANGE_ANNOUNCE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="announce";b.body=b.templateParams[0];break;case e.GROUP_CHANGE_NO_FREQUENTLY_FORWARDED:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="no_frequently_forwarded";b.body=b.templateParams[0];break;case e.GROUP_ANNOUNCE_MODE_MESSAGE_BOUNCE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="announce_msg_bounce";b.templateParams=void 0;break;case e.GROUP_PARTICIPANT_ADD:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="add";b.recipients=b.templateParams;b.templateParams=void 0;Array.isArray(b.recipients)&&b.recipients.length===1&&b.author===b.recipients[0]&&(b.author=void 0);break;case e.GROUP_PARTICIPANT_REMOVE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="remove";b.recipients=b.templateParams;b.templateParams=void 0;break;case e.GROUP_PARTICIPANT_PROMOTE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="promote";b.recipients=b.templateParams;b.templateParams=void 0;break;case e.GROUP_PARTICIPANT_DEMOTE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="demote";b.recipients=b.templateParams;b.templateParams=void 0;break;case e.GROUP_PARTICIPANT_INVITE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="invite";b.recipients=b.templateParams;b.templateParams=void 0;break;case e.GROUP_PARTICIPANT_LEAVE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="leave";b.recipients=b.templateParams;b.templateParams=void 0;break;case e.GROUP_PARTICIPANT_CHANGE_NUMBER:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="modify";b.recipients=b.templateParams;b.templateParams=void 0;break;case e.GROUP_V4_ADD_INVITE_SENT:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="v4_add_invite_sent";b.recipients=b.templateParams;b.templateParams=void 0;break;case e.GROUP_PARTICIPANT_ADD_REQUEST_JOIN:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="v4_add_invite_join";b.recipients=b.templateParams;b.templateParams=void 0;break;case e.GROUP_INVITE_LINK_GROWTH_LOCKED:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype=b.templateParams[0]==="true"?"growth_locked":"growth_unlocked";b.body="invite";b.templateParams=void 0;break;case e.GROUP_PARTICIPANT_LINKED_GROUP_JOIN:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="linked_group_join";b.recipients=b.templateParams;b.templateParams=void 0;break;case e.BROADCAST_CREATE:b.type="broadcast_notification";b.kind=d("WAWebMsgType").MsgKind.BroadcastNotification;b.subtype="create";b.body=b.templateParams[0]||"0";b.templateParams=void 0;break;case e.BROADCAST_ADD:b.type="broadcast_notification";b.kind=d("WAWebMsgType").MsgKind.BroadcastNotification;b.subtype="add";b.recipients=b.templateParams;b.templateParams=void 0;break;case e.BROADCAST_REMOVE:b.type="broadcast_notification";b.kind=d("WAWebMsgType").MsgKind.BroadcastNotification;b.subtype="remove";b.recipients=b.templateParams;b.templateParams=void 0;break;case e.GENERIC_NOTIFICATION:b.type="notification";b.kind=d("WAWebMsgType").MsgKind.Notification;b.body=b.templateParams[0];b.templateParams=void 0;break;case e.E2E_IDENTITY_CHANGED:b.type="e2e_notification";b.kind=d("WAWebMsgType").MsgKind.E2eNotification;b.subtype="identity";b.body=b.templateParams[0]instanceof c("WAWebWid")?b.templateParams[0].toString():b.templateParams[0];b.templateParams=void 0;break;case e.E2E_IDENTITY_UNAVAILABLE:b.type="e2e_notification";b.kind=d("WAWebMsgType").MsgKind.E2eNotification;b.subtype="e2e_identity_unavailable";break;case e.CHAT_PSA:b.type="e2e_notification";b.kind=d("WAWebMsgType").MsgKind.E2eNotification;b.subtype="chat_psa";break;case e.E2E_DEVICE_CHANGED:b.type="e2e_notification";b.kind=d("WAWebMsgType").MsgKind.E2eNotification;b.subtype="device";b.body=b.templateParams[0]instanceof c("WAWebWid")?b.templateParams[0].toString():b.templateParams[0];b.devicesAdded=parseInt(b.templateParams[1],10);b.devicesRemoved=parseInt(b.templateParams[2],10);b.templateParams=void 0;break;case e.E2E_ENCRYPTED:b.type="e2e_notification";b.kind=d("WAWebMsgType").MsgKind.E2eNotification;b.subtype="encrypt";break;case e.E2E_ENCRYPTED_NOW:b.type="e2e_notification";b.kind=d("WAWebMsgType").MsgKind.E2eNotification;b.subtype="encrypt_now";break;case e.CALL_MISSED_VOICE:b.type="call_log";b.kind=d("WAWebMsgType").MsgKind.CallLog;b.subtype="miss";break;case e.CALL_MISSED_VIDEO:b.type="call_log";b.kind=d("WAWebMsgType").MsgKind.CallLog;b.subtype="miss_video";break;case e.CALL_MISSED_GROUP_VOICE:b.type="call_log";b.kind=d("WAWebMsgType").MsgKind.CallLog;b.subtype="miss_group";break;case e.CALL_MISSED_GROUP_VIDEO:b.type="call_log";b.kind=d("WAWebMsgType").MsgKind.CallLog;b.subtype="miss_group_video";break;case e.SILENCED_UNKNOWN_CALLER_AUDIO:case e.SILENCED_UNKNOWN_CALLER_VIDEO:b.type="call_log";b.kind=d("WAWebMsgType").MsgKind.CallLog;b.subtype="silence";break;case e.INDIVIDUAL_CHANGE_NUMBER:b.subtype="change_number";break;case e.SENDER_INVITE:b.subtype="sender_invite";break;case e.RECEIVER_INVITE:b.subtype="receiver_invite";break;case e.MASKED_THREAD_CREATED:b.subtype="masked_thread_created";break;case e.CAG_MASKED_THREAD_CREATED:b.subtype="cag_masked_thread_created";break;case e.CHANGE_EPHEMERAL_SETTING:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="ephemeral";b.author=b.templateParams[1];break;case e.PAYMENT_CIPHERTEXT:b.type="payment";b.kind=d("WAWebMsgType").MsgKind.Payment;b.subtype="ciphertext";if(a.paymentInfo!=null){var f=d("WAWebE2EProtoUtils").parseMsgPaymentInfo(a.paymentInfo);b.paymentStatus=f.paymentStatus;b.paymentTxnStatus=f.paymentTxnStatus;b.paymentCurrency=f.paymentCurrency;b.paymentAmount1000=f.paymentAmount1000;b.paymentMessageReceiverJid=f.paymentMessageReceiverJid;b.paymentExpiryTimestamp=f.paymentExpiryTimestamp;b.paymentTransactionTimestamp=f.paymentTransactionTimestamp}break;case e.PAYMENT_FUTUREPROOF:b.type="payment";b.kind=d("WAWebMsgType").MsgKind.Payment;b.subtype="futureproof";if(a.paymentInfo!=null){f=d("WAWebE2EProtoUtils").parseMsgPaymentInfo(a.paymentInfo);b.paymentStatus=f.paymentStatus;b.paymentTxnStatus=f.paymentTxnStatus;b.paymentCurrency=f.paymentCurrency;b.paymentAmount1000=f.paymentAmount1000;b.paymentMessageReceiverJid=f.paymentMessageReceiverJid;b.paymentExpiryTimestamp=f.paymentExpiryTimestamp;b.paymentTransactionTimestamp=f.paymentTransactionTimestamp}break;case e.PAYMENT_ACTION_REQUEST_CANCELLED:b.subtype="payment_transaction_request_cancelled";break;case e.PAYMENT_TRANSACTION_STATUS_UPDATE_FAILED:b.subtype="payment_transaction_status_update_failed";break;case e.PAYMENT_TRANSACTION_STATUS_UPDATE_REFUNDED:b.subtype="payment_transaction_status_update_refunded";break;case e.PAYMENT_TRANSACTION_STATUS_UPDATE_REFUND_FAILED:b.subtype="payment_transaction_status_update_refund_failed";break;case e.PAYMENT_TRANSACTION_STATUS_RECEIVER_PENDING_SETUP:b.subtype="payment_transaction_status_receiver_pending_setup";break;case e.PAYMENT_TRANSACTION_STATUS_RECEIVER_SUCCESS_AFTER_HICCUP:b.subtype="payment_transaction_status_receiver_success_after_hiccup";break;case e.PAYMENT_ACTION_ACCOUNT_SETUP_REMINDER:b.subtype="payment_action_account_setup_reminder";break;case e.PAYMENT_ACTION_SEND_PAYMENT_REMINDER:b.subtype="payment_action_send_payment_reminder";break;case e.PAYMENT_ACTION_SEND_PAYMENT_INVITATION:b.subtype="payment_action_send_payment_invitation";break;case e.PAYMENT_ACTION_REQUEST_DECLINED:b.subtype="payment_action_request_declined";break;case e.PAYMENT_ACTION_REQUEST_EXPIRED:b.subtype="payment_action_request_expired";break;case e.BIZ_VERIFIED_TRANSITION_TOP_TO_BOTTOM:b.subtype="biz_verified_transition_top_to_bottom";break;case e.BIZ_VERIFIED_TRANSITION_BOTTOM_TO_TOP:b.subtype="biz_verified_transition_bottom_to_top";break;case e.BIZ_INTRO_TOP:b.subtype="biz_intro_top";break;case e.BIZ_INTRO_BOTTOM:b.subtype="biz_intro_bottom";break;case e.BIZ_NAME_CHANGE:b.subtype="biz_name_change";break;case e.BIZ_MOVE_TO_CONSUMER_APP:b.subtype="biz_move_to_consumer_app";break;case e.BIZ_TWO_TIER_MIGRATION_TOP:b.subtype="biz_two_tier_migration_top";break;case e.BIZ_TWO_TIER_MIGRATION_BOTTOM:b.subtype="biz_two_tier_migration_bottom";break;case e.BLUE_MSG_BSP_FB_TO_BSP_PREMISE:b.subtype="blue_msg_bsp_fb_to_bsp_premise";break;case e.BLUE_MSG_BSP_FB_TO_SELF_FB:b.subtype="blue_msg_bsp_fb_to_self_fb";break;case e.BLUE_MSG_BSP_FB_TO_SELF_PREMISE:b.subtype="blue_msg_bsp_fb_to_self_premise";break;case e.BLUE_MSG_BSP_FB_UNVERIFIED:b.subtype="blue_msg_bsp_fb_unverified";break;case e.BLUE_MSG_BSP_FB_UNVERIFIED_TO_BSP_PREMISE_VERIFIED:b.subtype="blue_msg_bsp_fb_unverified_to_bsp_premise_verified";break;case e.BLUE_MSG_BSP_FB_UNVERIFIED_TO_SELF_FB_VERIFIED:b.subtype="blue_msg_bsp_fb_unverified_to_self_fb_verified";break;case e.BLUE_MSG_BSP_FB_UNVERIFIED_TO_SELF_PREMISE_VERIFIED:b.subtype="blue_msg_bsp_fb_unverified_to_self_premise_verified";break;case e.BLUE_MSG_BSP_FB_VERIFIED:b.subtype="blue_msg_bsp_fb_verified";break;case e.BLUE_MSG_BSP_FB_VERIFIED_TO_BSP_PREMISE_UNVERIFIED:b.subtype="blue_msg_bsp_fb_verified_to_bsp_premise_unverified";break;case e.BLUE_MSG_BSP_FB_VERIFIED_TO_SELF_FB_UNVERIFIED:b.subtype="blue_msg_bsp_fb_verified_to_self_fb_unverified";break;case e.BLUE_MSG_BSP_FB_VERIFIED_TO_SELF_PREMISE_UNVERIFIED:b.subtype="blue_msg_bsp_fb_verified_to_self_premise_unverified";break;case e.BLUE_MSG_BSP_PREMISE_TO_SELF_PREMISE:b.subtype="blue_msg_bsp_premise_to_self_premise";break;case e.BLUE_MSG_BSP_PREMISE_UNVERIFIED:b.subtype="blue_msg_bsp_premise_unverified";break;case e.BLUE_MSG_BSP_PREMISE_UNVERIFIED_TO_SELF_PREMISE_VERIFIED:b.subtype="blue_msg_bsp_premise_unverified_to_self_premise_verified";break;case e.BLUE_MSG_BSP_PREMISE_VERIFIED:b.subtype="blue_msg_bsp_premise_verified";break;case e.BLUE_MSG_BSP_PREMISE_VERIFIED_TO_SELF_PREMISE_UNVERIFIED:b.subtype="blue_msg_bsp_premise_verified_to_self_premise_unverified";break;case e.BLUE_MSG_CONSUMER_TO_BSP_FB_UNVERIFIED:b.subtype="blue_msg_consumer_to_bsp_fb_unverified";break;case e.BLUE_MSG_CONSUMER_TO_BSP_PREMISE_UNVERIFIED:b.subtype="blue_msg_consumer_to_bsp_premise_unverified";break;case e.BLUE_MSG_CONSUMER_TO_SELF_FB_UNVERIFIED:b.subtype="blue_msg_consumer_to_self_fb_unverified";break;case e.BLUE_MSG_CONSUMER_TO_SELF_PREMISE_UNVERIFIED:b.subtype="blue_msg_consumer_to_self_premise_unverified";break;case e.BLUE_MSG_SELF_FB_TO_BSP_PREMISE:b.subtype="blue_msg_self_fb_to_bsp_premise";break;case e.BLUE_MSG_SELF_FB_TO_SELF_PREMISE:b.subtype="blue_msg_self_fb_to_self_premise";break;case e.BLUE_MSG_SELF_FB_UNVERIFIED:b.subtype="blue_msg_self_fb_unverified";break;case e.BLUE_MSG_SELF_FB_UNVERIFIED_TO_BSP_PREMISE_VERIFIED:b.subtype="blue_msg_self_fb_unverified_to_bsp_premise_verified";break;case e.BLUE_MSG_SELF_FB_UNVERIFIED_TO_SELF_PREMISE_VERIFIED:b.subtype="blue_msg_self_fb_unverified_to_self_premise_verified";break;case e.BLUE_MSG_SELF_FB_VERIFIED:b.subtype="blue_msg_self_fb_verified";break;case e.BLUE_MSG_SELF_FB_VERIFIED_TO_BSP_PREMISE_UNVERIFIED:b.subtype="blue_msg_self_fb_verified_to_bsp_premise_unverified";break;case e.BLUE_MSG_SELF_FB_VERIFIED_TO_SELF_PREMISE_UNVERIFIED:b.subtype="blue_msg_self_fb_verified_to_self_premise_unverified";break;case e.BLUE_MSG_SELF_PREMISE_TO_BSP_PREMISE:b.subtype="blue_msg_self_premise_to_bsp_premise";break;case e.BLUE_MSG_SELF_PREMISE_UNVERIFIED:b.subtype="blue_msg_self_premise_unverified";break;case e.BLUE_MSG_SELF_PREMISE_VERIFIED:b.subtype="blue_msg_self_premise_verified";break;case e.BLUE_MSG_TO_BSP_FB:b.subtype="blue_msg_to_bsp_fb";break;case e.BLUE_MSG_TO_CONSUMER:b.subtype="blue_msg_to_consumer";break;case e.BLUE_MSG_TO_SELF_FB:b.subtype="blue_msg_to_self_fb";break;case e.BLUE_MSG_UNVERIFIED_TO_BSP_FB_VERIFIED:b.subtype="blue_msg_unverified_to_bsp_fb_verified";break;case e.BLUE_MSG_UNVERIFIED_TO_BSP_PREMISE_VERIFIED:b.subtype="blue_msg_unverified_to_bsp_premise_verified";break;case e.BLUE_MSG_UNVERIFIED_TO_SELF_FB_VERIFIED:b.subtype="blue_msg_unverified_to_self_fb_verified";break;case e.BLUE_MSG_UNVERIFIED_TO_VERIFIED:b.subtype="blue_msg_unverified_to_verified";break;case e.BLUE_MSG_VERIFIED_TO_BSP_FB_UNVERIFIED:b.subtype="blue_msg_verified_to_bsp_fb_unverified";break;case e.BLUE_MSG_VERIFIED_TO_BSP_PREMISE_UNVERIFIED:b.subtype="blue_msg_verified_to_bsp_premise_unverified";break;case e.BLUE_MSG_VERIFIED_TO_SELF_FB_UNVERIFIED:b.subtype="blue_msg_verified_to_self_fb_unverified";break;case e.BLUE_MSG_VERIFIED_TO_UNVERIFIED:b.subtype="blue_msg_verified_to_unverified";break;case e.BIZ_PRIVACY_MODE_INIT_FB:b.subtype="biz_privacy_mode_init_fb";((f=b.id)==null?void 0:(f=f.remote)==null?void 0:f.isBot())&&(b.subtype="bot_init");break;case e.BIZ_PRIVACY_MODE_INIT_BSP:b.subtype="biz_privacy_mode_init_bsp";break;case e.BIZ_PRIVACY_MODE_TO_FB:b.subtype="biz_privacy_mode_to_fb";((f=b.id)==null?void 0:(f=f.remote)==null?void 0:f.isBot())&&(b.subtype="bot_init");break;case e.BIZ_PRIVACY_MODE_TO_BSP:b.subtype="biz_privacy_mode_to_bsp";break;case e.DISAPPEARING_MODE:b.subtype="disappearing_mode";break;case e.BLOCK_CONTACT:b.subtype="block_contact";break;case e.ADMIN_REVOKE:b.type="revoked";b.subtype="admin";b.kind=d("WAWebMsgType").MsgKind.RevokedMessage;b.revokeSender=b.templateParams[1]instanceof c("WAWebWid")?b.templateParams[1]:void 0;b.revokeSender||d("WALogger").LOG(h()).devConsole(b.templateParams);f=b.templateParams[0];b.protocolMessageKey=(f=l(a,{remoteJid:a.key.remoteJid,fromMe:d("WAWebUserPrefsMeUser").isMeAccount(b.from),id:f,participant:a.key.participant}))==null?void 0:f.msgKey;b.templateParams=void 0;break;case e.COMMUNITY_LINK_PARENT_GROUP:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="parent_group_link";break;case e.COMMUNITY_LINK_SIBLING_GROUP:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="sibling_group_link";break;case e.COMMUNITY_LINK_SUB_GROUP:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="sub_group_link";break;case e.COMMUNITY_CREATE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="community_create";break;case e.COMMUNITY_UNLINK_PARENT_GROUP:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="parent_group_unlink";break;case e.INTEGRITY_UNLINK_PARENT_GROUP:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="integrity_parent_group_unlink";break;case e.COMMUNITY_UNLINK_SIBLING_GROUP:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="sibling_group_unlink";break;case e.COMMUNITY_UNLINK_SUB_GROUP:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="sub_group_unlink";break;case e.COMMUNITY_PARTICIPANT_PROMOTE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="linked_group_promote";b.recipients=b.templateParams;b.templateParams=void 0;break;case e.COMMUNITY_PARTICIPANT_DEMOTE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="linked_group_demote";b.recipients=b.templateParams;b.templateParams=void 0;break;case e.EPHEMERAL_KEEP_IN_CHAT:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="ephemeral_keep_in_chat";break;case e.GROUP_MEMBERSHIP_JOIN_APPROVAL_MODE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="membership_approval_mode";break;case e.GROUP_MEMBER_ADD_MODE:if(!d("WAWebABProps").getABPropConfigValue("web_anyone_can_add_group_setting_enabled")){b.templateParams=void 0;break}b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="member_add_mode";break;case e.GROUP_MEMBERSHIP_JOIN_APPROVAL_REQUEST_NON_ADMIN_ADD:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.recipients=b.templateParams;b.subtype="created_membership_requests";break;case e.GROUP_MEMBERSHIP_JOIN_APPROVAL_REQUEST:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="membership_approval_request";break;case e.GROUP_PARTICIPANT_JOINED_GROUP_AND_PARENT_GROUP:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="auto_add";break;case e.COMMUNITY_PARENT_GROUP_DELETED:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="delete_parent_group";break;case e.BIZ_CHAT_ASSIGNMENT:b.subtype="chat_assignment";break;case e.BIZ_CHAT_ASSIGNMENT_UNASSIGN:b.subtype="chat_assignment_unassign";break;case e.COMMUNITY_PARENT_GROUP_SUBJECT_CHANGED:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="subject";b.body=b.templateParams[1];break;case e.CAG_INVITE_AUTO_ADD:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="invite_auto_add";b.recipients=[d("WAWebUserPrefsMeUser").getMaybeMeUser()];break;case e.CAG_INVITE_AUTO_JOINED:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="invite_auto_add";b.recipients=b.templateParams;b.templateParams=void 0;break;case e.COMMUNITY_PARTICIPANT_ADD_RICH:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="community_participant_add_rich";break;case e.SUB_GROUP_PARTICIPANT_ADD_RICH:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="sub_group_participant_add_rich";break;case e.SUB_GROUP_INVITE_RICH:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="sub_group_invite_rich";b.author=void 0;break;case e.COMMUNITY_INVITE_AUTO_ADD_RICH:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="community_invite_auto_add_rich";b.author=void 0;break;case e.COMMUNITY_INVITE_RICH:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="community_invite_rich";b.author=void 0;break;case e.COMMUNITY_LINK_PARENT_GROUP_RICH:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="community_link_parent_group_rich";break;case e.COMMUNITY_CHANGE_DESCRIPTION:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="parent_group_description";b.body=b.templateParams[0];break;case e.PINNED_MESSAGE_IN_CHAT:b.type="pinned_message";b.kind=d("WAWebMsgType").MsgKind.PinnedMessage;break;case e.COMMUNITY_ALLOW_MEMBER_ADDED_GROUPS:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="allow_non_admin_sub_group_creation";break;case e.EMPTY_SUBGROUP_CREATE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="empty_subgroup_create";break;case e.SUGGESTED_SUBGROUP_ANNOUNCE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="created_subgroup_suggestion";break;case e.SUBGROUP_ADMIN_TRIGGERED_AUTO_ADD_RICH:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="subgroup_admin_triggered_auto_add";break;case e.GENERAL_CHAT_ADD:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="general_chat_add";break;case e.GENERAL_CHAT_AUTO_ADD_DISABLED:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="general_chat_auto_add_disabled";break;case e.BIZ_BOT_1P_MESSAGING_ENABLED:b.type=d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE;b.kind=d("WAWebMsgType").MsgKind.NotificationTemplate;b.subtype="biz_bot_1p_disclosure";break;case e.BIZ_BOT_3P_MESSAGING_ENABLED:b.type=d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE;b.kind=d("WAWebMsgType").MsgKind.NotificationTemplate;b.subtype="biz_bot_3p_disclosure";break;case e.CHANGE_USERNAME:b.subtype="change_username";break;case e.BIZ_COEX_PRIVACY_INIT_SELF:if(!d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){b.templateParams=void 0;break}b.type=d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE;b.kind=d("WAWebMsgType").MsgKind.NotificationTemplate;b.subtype="biz_me_account_type_is_hosted";break;case e.BIZ_COEX_PRIVACY_TRANSITION_SELF:if(!d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){b.templateParams=void 0;break}b.type=d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE;b.kind=d("WAWebMsgType").MsgKind.NotificationTemplate;b.subtype="biz_me_account_type_is_hosted_transition";break;case e.BIZ_COEX_PRIVACY_INIT:if(!d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){b.templateParams=void 0;break}b.type=d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE;b.kind=d("WAWebMsgType").MsgKind.NotificationTemplate;b.subtype="biz_account_type_is_hosted";break;case e.BIZ_COEX_PRIVACY_TRANSITION:if(!d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){b.templateParams=void 0;break}b.type=d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE;b.kind=d("WAWebMsgType").MsgKind.NotificationTemplate;b.subtype="biz_account_type_changed_to_hosted";break;case e.SUPPORT_AI_EDUCATION:b.type=d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE;b.kind=d("WAWebMsgType").MsgKind.NotificationTemplate;b.subtype="saga_init";break;case e.EVENT_CANCELED:case e.EVENT_UPDATED:f=babelHelpers["extends"]({},d("WAWebProcessBaseMsgInfo").msgDataToBaseMsgInfo(b),{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,subtype:"event_edit_decrypted",kind:d("WAWebMsgType").MsgKind.ProtocolEventEdit,eventName:b.templateParams[0],eventStartTime:d("WATimeUtils").unixTime(),isEventCanceled:a.messageStubType===e.EVENT_CANCELED,protocolMessageKey:c("WANullthrows")((f=l(a,c("WANullthrows")(a.targetMessageId)))==null?void 0:f.msgKey,"Error: buildMsgKey or targetMessageId is null or missing for event edit system message history sync parsing"),editMsgType:d("WAWebMsgType").MSG_TYPE.EVENT_CREATION,latestEditMsgKey:void 0,latestEditSenderTimestampMs:void 0});return f;case e.COMMUNITY_OWNER_UPDATED:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="community_owner_update";break;case e.COMMUNITY_SUB_GROUP_VISIBILITY_HIDDEN:b.templateParams[0]==="on"&&d("WAWebCommunityGatingUtils").communityHiddenGroupsReceiverEnabled()&&(b.type="gp2",b.kind=d("WAWebMsgType").MsgKind.Gp2,b.subtype="community_hidden_group");break;default:b.templateParams=void 0;break}return b}g.buildMsgKey=l;g.parseWebMessageInfo=a;g.parseMsgStubProto=m}),98);
__d("WAWebAdvUpdateParticipantApi",["WAJids","WALogger","WAWebPostSenderKeyExpiredMetric","WAWebSchemaParticipant","WAWebUserPrefsMeUser","WAWebWamEnumExpiryReason","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["bulkUpdateGroupParticipantsInTransaction: error: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateGroupParticipantsInTransaction: error: ",""]);i=function(){return a};return a}function a(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e;try{e=(yield d("WAWebSchemaParticipant").getParticipantTable().equals(["participants"],String(a)))}catch(a){a.toString().includes("Failed to read large IndexedDB value")&&d("WALogger").ERROR(i(),a).sendLogs("indexeddb-participant-read-large-value");throw a}var f=e.map(function(e){var f=e.rotateKey,g=new Map(e.senderKey);c.forEach(function(b){var c;b=String(d("WAWebWidFactory").createDeviceWidFromUserAndDevice(a.user,a.server,b));f=f||((c=g.get(b))!=null?c:!1);g["delete"](b)});f&&g.forEach(function(a,b){return g.set(b,!1)});b.forEach(function(b){g.set(String(d("WAWebWidFactory").createDeviceWidFromUserAndDevice(a.user,a.server,b)),!1)});l(a,f,e,b,c);return babelHelpers["extends"]({},e,{senderKey:g,rotateKey:f})});return d("WAWebSchemaParticipant").getParticipantTable().bulkCreateOrReplace(f)});return j.apply(this,arguments)}function c(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return;var b;try{b=(yield d("WAWebSchemaParticipant").getParticipantTable().anyOf(["participants"],a.map(function(a){return String(a.wid)})))}catch(a){a.toString().includes("Failed to read large IndexedDB value")&&d("WALogger").ERROR(h(),a).sendLogs("indexeddb-participant-bulk-read-large-value");throw a}if(b.length===0)return;var c=new Map();a.forEach(function(a){c.set(String(a.wid),a)});a=b.map(function(a){var b=a.rotateKey,e=new Map(a.senderKey);a.participants.forEach(function(f){var g=c.get(f);if(!g)return;f=g.wid;var h=g.added,i=g.removed;i.forEach(function(a){var c;a=String(d("WAWebWidFactory").createDeviceWidFromUserAndDevice(g.wid.user,g.wid.server,a));b=b||((c=e.get(a))!=null?c:!1);e["delete"](a)});b&&e.forEach(function(a,b){return e.set(b,!1)});h.forEach(function(a){e.set(String(d("WAWebWidFactory").createDeviceWidFromUserAndDevice(g.wid.user,g.wid.server,a)),!1)});l(f,b,a,h,i)});return babelHelpers["extends"]({},a,{senderKey:e,rotateKey:b})});return d("WAWebSchemaParticipant").getParticipantTable().bulkCreateOrReplace(a)});return k.apply(this,arguments)}function l(a,b,c,e,f){if(b&&!c.rotateKey){f.includes(d("WAJids").DEFAULT_DEVICE_ID)&&e.includes(d("WAJids").DEFAULT_DEVICE_ID)?b=d("WAWebWamEnumExpiryReason").EXPIRY_REASON.IDENTITY_CHANGE:((f=d("WAWebUserPrefsMeUser").getMaybeMeUser())==null?void 0:f.equals(a))?b=d("WAWebWamEnumExpiryReason").EXPIRY_REASON.PEER_COMPANION_UNPAIR:b=d("WAWebWamEnumExpiryReason").EXPIRY_REASON.OTHER_DEVICE_UNPAIR;d("WAWebPostSenderKeyExpiredMetric").postSenderKeyExpiredMetric({chatId:c.groupId,deviceCount:c.senderKey.size,expiryReason:b})}}g.updateGroupParticipantsInTransaction=a;g.bulkUpdateGroupParticipantsInTransaction=c}),98);
__d("WAWebFMXUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("fmx_ctwa_kill_switch")}g.fmxCTWAKillSwitchEnabled=a}),98);
__d("WAWebContactSystemMsg",["WATimeUtils","WAWebApiContact","WAWebFMXUtils","WAWebMsgKey","WAWebMsgType","WAWebUserPrefsMeUser","WAWebViewMode.flow","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){function a(a,b){var e=d("WAWebUserPrefsMeUser").getMeUser(),f=new(c("WAWebMsgKey"))({fromMe:b.equals(e),remote:a,id:c("WAWebMsgKey").newId_DEPRECATED()});return{id:f,t:d("WATimeUtils").unixTime(),type:"e2e_notification",kind:d("WAWebMsgType").MsgKind.E2eNotification,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:"identity",from:a,to:e,body:b.toString()}}function e(a,b){b===void 0&&(b="encrypt");return l(a,{type:"e2e_notification",kind:d("WAWebMsgType").MsgKind.E2eNotification,subtype:b,templateParams:[]})}function f(a,b,c){c===void 0&&(c=[]);return l(a,{type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,subtype:b,templateParams:c})}function h(a,b,e){var f=e?d("WAWebUserPrefsMeUser").getMeUser():a;if(f==null)throw c("err")("Cannot set null initiator for DDM system message: "+a.toString()+" / "+String(e));return l(a,{type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"disappearing_mode",templateParams:[],ephemeralDuration:b,ephemeralSettingUser:f})}function i(a,b,c){return l(a,{type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"disappearing_mode_update",templateParams:[],ephemeralDuration:b,ephemeralSettingUser:c})}function j(a,b){return l(a,{type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"change_username",templateParams:b!=null?[b]:[""]})}function k(a){return l(a,{type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"disappearing_mode_unsupported",templateParams:[]})}function l(a,b){var e=d("WAWebUserPrefsMeUser").getMaybeMeLid(),f=d("WAWebUserPrefsMeUser").getMeUser(),g=new(c("WAWebMsgKey"))({fromMe:d("WAWebUserPrefsMeUser").isMeAccount(a),remote:a,id:c("WAWebMsgKey").newId_DEPRECATED()});return babelHelpers["extends"]({id:g,t:d("WATimeUtils").unixTime(),from:a,to:a.isLid()&&e!=null?e:f},b)}function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(b.isEnterprise)return null;if(!a.isUser()||b.isWASupportStartingChat||b.iAmStartingChat||b.isFromCTWA&&d("WAWebFMXUtils").fmxCTWAKillSwitchEnabled())return null;if(a.isBot())return null;b=(yield d("WAWebApiContact").isAddressBookContact(a.toJid()));return b?null:l(a,{type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"contact_info_card",templateParams:[a]})});return n.apply(this,arguments)}g.genSecurityCodeNotificationMsg=a;g.genEncryptNotificationMsg=e;g.genNonE2ENotificationMsg=f;g.genDefaultDisappearingModeSystemMsg=h;g.genDisappearingModeUpdateSystemMsg=i;g.genUsernameChangeSystemMsg=j;g.genDisappearingModeUnsupportedSystemMsg=k;g.genNotificationMsg=l;g.genContactInfoCardMsg=m}),98);
__d("WAWebIdentityChangeApi",["Promise","WAJids","WANullthrows","WAWebAdvUpdateParticipantApi","WAWebApiContact","WAWebApiDeviceList","WAWebBizCoexGatingUtils","WAWebBizCoexUtils","WAWebContactSystemMsg","WAWebDeviceListPk","WAWebHandleMsgTypes.flow","WAWebHandleSingleMsg","WAWebModelStorageUtils","WAWebMsgType","WAWebOfflineDeviceCache","WAWebProtobufsAdv.pb","WAWebSchemaChat","WAWebSecurityCodeApi","WAWebSendTcTokenWhenDeviceIdentityChange","WAWebSignal","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c;b===void 0&&(b=!1);c=(c=a.device)!=null?c:d("WAJids").DEFAULT_DEVICE_ID;a=d("WAWebWidFactory").toUserWid(a);if(c===d("WAJids").DEFAULT_DEVICE_ID){yield j(a);c=(yield d("WAWebSecurityCodeApi").addSecurityCodeChangedNotifications(a,b));void d("WAWebSendTcTokenWhenDeviceIdentityChange").sendTcTokenWhenDeviceIdentityChange(a);return c}});return i.apply(this,arguments)}function j(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){e===void 0&&(e=!1);var f=[d("WAJids").DEFAULT_DEVICE_ID],g=[d("WAJids").DEFAULT_DEVICE_ID],i=!1;if(e)d("WAWebOfflineDeviceCache").OfflinePendingDeviceCache.addOfflinePendingDevice(String(a),null),yield d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){return d("WAWebAdvUpdateParticipantApi").updateGroupParticipantsInTransaction(a,g,f)});else{e=(yield d("WAWebApiDeviceList").getDeviceRecord(a));e&&!e.deleted&&(e.devices.forEach(function(a){a.id!==d("WAJids").DEFAULT_DEVICE_ID&&f.push(a.id)}),d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&e.advAccountType===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(i=!0));(h||(h=b("Promise"))).all(f.map(function(c){return c===d("WAJids").DEFAULT_DEVICE_ID?(h||(h=b("Promise"))).resolve():d("WAWebSignal").Session.deleteRemoteInfo(d("WAWebWidFactory").createDeviceWidFromUserAndDevice(a.user,a.server,c))}));yield h.all([d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){return d("WAWebAdvUpdateParticipantApi").updateGroupParticipantsInTransaction(a,g,f)}),d("WAWebApiDeviceList").createOrReplaceDeviceRecord({id:d("WAWebDeviceListPk").createDeviceListPK(a),deleted:!0})]);if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&i===!0){yield d("WAWebApiContact").updateContactAdvHostedType(a,d("WAWebProtobufsAdv.pb").ADVEncryptionType.E2EE);e=(yield d("WAWebSchemaChat").getChatTable().get(a.toString(),!1));if(e!=null){i=d("WAWebContactSystemMsg").genNotificationMsg(a,{type:"e2e_notification",kind:d("WAWebMsgType").MsgKind.E2eNotification,subtype:"encrypt_now",templateParams:[]});yield d("WAWebHandleSingleMsg").handleSingleMsg(c("WANullthrows")(i.from),i,"bizStateChangeNotification",d("WAWebHandleMsgTypes.flow").MessageOverwriteOption.NO_OVERWRITE)}void d("WAWebBizCoexUtils").triggerUsyncForCoexUpdate(a)}}});return k.apply(this,arguments)}g.handleNewIdentity=a;g.clearDeviceRecordForIdentityChange=j}),98);
__d("WAWebAdvHostedAccountTypeSystemMsg",["WATimeUtils","WAWebBizCoexGatingUtils","WAWebMsgKey","WAWebMsgType","WAWebProtobufsAdv.pb","WAWebUserPrefsMeUser","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){function a(a,b,e){if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){if(!a.isUser())return null;var f=d("WAWebUserPrefsMeUser").getMeUser();b=new(c("WAWebMsgKey"))({fromMe:b.equals(f),remote:a,id:c("WAWebMsgKey").newId_DEPRECATED()});if(e===d("WAWebProtobufsAdv.pb").ADVEncryptionType.E2EE)return{id:b,t:d("WATimeUtils").unixTime(),type:"e2e_notification",kind:d("WAWebMsgType").MsgKind.E2eNotification,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:"encrypt",from:a,to:f};else if(e===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED)return{id:b,t:d("WATimeUtils").unixTime(),type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:"biz_account_type_changed_to_hosted",from:a,to:f}}return null}function b(a,b){if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){if(!a.isUser())return null;var e=d("WAWebUserPrefsMeUser").getMeUser();b=new(c("WAWebMsgKey"))({fromMe:b.equals(e),remote:a,id:c("WAWebMsgKey").newId_DEPRECATED()});return{id:b,t:d("WATimeUtils").unixTime(),type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:"biz_me_account_type_is_hosted",from:a,to:e}}return null}function e(a,b){if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){if(!a.isUser())return null;var e=d("WAWebUserPrefsMeUser").getMeUser();b=new(c("WAWebMsgKey"))({fromMe:b.equals(e),remote:a,id:c("WAWebMsgKey").newId_DEPRECATED()});return{id:b,t:d("WATimeUtils").unixTime(),type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:"biz_account_type_is_hosted",from:a,to:e}}return null}function f(a,b){if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&d("WAWebBizCoexGatingUtils").smbHostedLazySystemMsgInsertInHistorySyncEnabled()&&a.isUser()){var e=d("WAWebUserPrefsMeUser").getMeUser();b=new(c("WAWebMsgKey"))({fromMe:b.equals(e),remote:a,id:c("WAWebMsgKey").newId_DEPRECATED()});return{id:b,t:d("WATimeUtils").unixTime(),type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:"biz_me_account_type_is_hosted_transition",from:a,to:e}}return null}g.genAdvAccountTypeChangeNotificationMsg=a;g.genAdvMeAccountIsHostedNotificationMsg=b;g.genAdvAccountTypeInitialSysMsg=e;g.genAdvAccountTypeSelfTransitionToCoexNotificationMsg=f}),98);
__d("WAWebAdvDeviceNotificationApi",["Promise","WALogger","WAWebAdvHostedAccountTypeSystemMsg","WAWebBizCoexGatingUtils","WAWebBizCoexHostedAddVerification","WAWebProtobufsAdv.pb","WAWebSchemaChat","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["get chats failed during generateAdvAccountTypeChangeNotifications"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["accountTypeChangeNotification: check coex cache for ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["SMB unexpected self adv system msg"]);k=function(){return a};return a}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e={notifications:[],chatIds:[]};if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){var f=[];if(a.equals(d("WAWebUserPrefsMeUser").getMeUser()))d("WALogger").ERROR(k()).tags("generateAdvAccountTypeChangeNotifications");else{b===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(d("WALogger").LOG(j(),a==null?void 0:a.toLogString()),d("WAWebBizCoexHostedAddVerification").assertThrowsWidAdvTypeFromVerificationCache(a));try{var g=(yield d("WAWebSchemaChat").getChatTable().get(String(a),!1));g&&f.push(d("WAWebWidFactory").createWid(g.id))}catch(a){d("WALogger").DEV(i()).verbose().devConsole(a);throw c("err")("get chays failed")}}g=f.map(function(c){return d("WAWebAdvHostedAccountTypeSystemMsg").genAdvAccountTypeChangeNotificationMsg(c,a,b)}).filter(Boolean);e.notifications=g;e.chatIds=f.map(String);return e}return e});return m.apply(this,arguments)}function a(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled())throw c("err")("hosted system msg gen: unexpected env");var e=[],f=new Set();a=(yield (h||(h=b("Promise"))).all(a.map(function(a){var c=a.wid;a=a.newAdvAccountType;return a!=null?l(c,a):(h||(h=b("Promise"))).resolve(null)})));a.forEach(function(a){a&&(e=e.concat(a.notifications),a.chatIds.forEach(function(a){return f.add(a)}))});return e.length>0?{notifications:e,chatIds:Array.from(f)}:{notifications:[],chatIds:[]}});return n.apply(this,arguments)}g.bulkGenerateDeviceAndAdvAccountTypeChangeNotifications=a}),98);
__d("WAWebApiGetDeviceUpdateLock",["WAWebBizCoexGatingUtils","WAWebModelStorageUtils"],(function(a,b,c,d,e,f,g){function a(a,b,c,e){c===void 0&&(c=!1);e===void 0&&(e=!1);var f=["participant","device-list"];b&&(f=[].concat(f,["message","message-association"]));c&&(f=[].concat(f,["missing-keys"]));d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(e&&(f=[].concat(f,["contact"])));return d("WAWebModelStorageUtils").getStorage().lock(f,function(){return a()})}g.getDeviceUpdateLock=a}),98);
__d("WAWebIdentityUpdateDeviceTableApi",["Promise","WAJids","WALogger","WASyncdStoreMissingKeys","WAWebAdvDeviceNotificationApi","WAWebAdvUpdateParticipantApi","WAWebApiContact","WAWebApiDeviceList","WAWebApiGetDeviceUpdateLock","WAWebBackendApi","WAWebBizCoexGatingUtils","WAWebBizCoexHostedAddVerification","WAWebBizCoexUtils","WAWebDBEncryptMultipleMsgs","WAWebDBStoreEncryptedMsgs","WAWebDeviceListPk","WAWebGetMessageCache","WAWebProtobufsAdv.pb","WAWebSignalSessionApi","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDevice","WAWebWidFactory","asyncToGeneratorRuntime","err","lodash"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleDevicesNotification: failed to clean the signal info for ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: updateMissingKeyDevices failed with error:\n        ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["bulkCreateOrReplace into device list table failed"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["bulkApplyDeviceUpdates: check coex cache for ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["remove from device list table failed"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["clearDeviceRecord: check coex cache for ",""]);n=function(){return a};return a}function o(a,b){if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){if(a==null)return b===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED?b:null;switch(a){case d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED:return b===d("WAWebProtobufsAdv.pb").ADVEncryptionType.E2EE?b:null;case d("WAWebProtobufsAdv.pb").ADVEncryptionType.E2EE:return b===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED?b:null}}if(b===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED)throw c("err")("Unexpected account type");return null}function a(a,b,c,d,e){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,i){f===void 0&&(f=!1);yield (h||(h=b("Promise"))).all(e.filter(function(a){return a.id!==d("WAJids").DEFAULT_DEVICE_ID}).map(function(b){return t(d("WAWebWidFactory").createDeviceWidFromUserAndDevice(a.user,a.server,b.id))}));var j=[],k=e.map(function(a){return a.id}).filter(function(a){return a!==d("WAJids").DEFAULT_DEVICE_ID}),l=o(g,i);d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&l===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(d("WALogger").LOG(n(),a==null?void 0:a.toLogString()),d("WAWebBizCoexHostedAddVerification").assertThrowsWidAdvTypeFromVerificationCache(a),yield d("WAWebUserPrefsMultiDevice").setHaveProcessedCoexAdv());e=(yield r([{wid:a,added:j,removed:k,isNewRecord:!1,newAdvAccountType:l}],f,l!=null));var p=e.encryptedNotifications,q=e.chatIds;yield d("WAWebApiGetDeviceUpdateLock").getDeviceUpdateLock(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=p.length>0?d("WAWebDBStoreEncryptedMsgs").storeEncryptedDBMessages(p,[],q,!1):(h||(h=b("Promise"))).resolve(),f=d("WAWebAdvUpdateParticipantApi").updateGroupParticipantsInTransaction(a,j,k),g={id:d("WAWebDeviceListPk").createDeviceListPK(a),deleted:!0};d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&l===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(g.deletedChangedToHost=!0);g=d("WAWebApiDeviceList").createOrReplaceDeviceRecord(g)["catch"](function(a){d("WALogger").ERROR(m()).verbose().devConsole(a).sendLogs("remove from device list table failed when clearing device record");throw c("err")("remove from device list table failed")});var i=(h||(h=b("Promise"))).resolve();d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(l!=null&&(i=d("WAWebApiContact").updateContactAdvHostedType(a,l)));yield h.all([e,f,g,i])}),p.length>0,!1,l!=null);d("WAWebBizCoexUtils").sendWamCoexPrivacySysMsgInsertSuccess(p)});return p.apply(this,arguments)}function e(a,b,c){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){e===void 0&&(e=!1);f===void 0&&(f=!1);var g=[],i=[],m=!1,n=!1,p=!1;a.forEach(function(a){var b=a.wid,e=a.update;a=a.currentRecord;var f=e.devices;f=f.map(function(a){return a.id});var h=a&&!a.deleted?a.devices.map(function(a){return a.id}):[],j=c("lodash").difference(f,h).filter(function(a){return a!==d("WAJids").DEFAULT_DEVICE_ID});h=c("lodash").difference(h,f).filter(function(a){return a!==d("WAJids").DEFAULT_DEVICE_ID});f=a==null;a=d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()?o(a==null?void 0:a.advAccountType,e==null?void 0:e.advAccountType):null;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&a===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(d("WALogger").LOG(l(),b==null?void 0:b.toLogString()),d("WAWebBizCoexHostedAddVerification").assertThrowsWidAdvTypeFromVerificationCache(b));d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(a!=null&&(n=!0),a===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(p=!0));g.push({wid:b,added:j,removed:h,isNewRecord:f,newAdvAccountType:a});h.forEach(function(a){i.push(d("WAWebWidFactory").createDeviceWidFromUserAndDevice(b.user,b.server,a))});d("WAWebDeviceListPk").createDeviceListPK(b)===d("WAWebDeviceListPk").createDeviceListPK(d("WAWebUserPrefsMeUser").getMeUser())&&h.length>0&&(m=!0)});d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&p===!0&&(yield d("WAWebUserPrefsMultiDevice").setHaveProcessedCoexAdv());e=(yield r(g,e,(e||f)&&n));var q=e.encryptedNotifications,s=e.chatIds;(h||(h=b("Promise"))).all(i.map(function(a){return t(a)}));var u=d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(q==null?void 0:q.length)>0;yield d("WAWebApiGetDeviceUpdateLock").getDeviceUpdateLock(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=q.length>0?d("WAWebDBStoreEncryptedMsgs").storeEncryptedDBMessages(q,[],s,!1):(h||(h=b("Promise"))).resolve(),f=d("WAWebAdvUpdateParticipantApi").bulkUpdateGroupParticipantsInTransaction(g),i=d("WAWebApiDeviceList").bulkCreateOrReplaceDeviceRecord(a.map(function(a){return a.update}))["catch"](function(a){d("WALogger").ERROR(k()).verbose().devConsole(a).sendLogs("bulkCreateOrReplace into device list table failed when applying device update");throw c("err")("bulkCreateOrReplace into device list table failed")}),l=m?i.then(function(){return d("WASyncdStoreMissingKeys").updateMissingKeyDevices()["catch"](function(a){d("WALogger").WARN(j(),a)})}):(h||(h=b("Promise"))).resolve(),n=[];d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&u&&g.forEach(function(a){var b=a.wid;a=a.newAdvAccountType;a!=null&&n.push(d("WAWebApiContact").updateContactAdvHostedType(b,a))});yield (h||(h=b("Promise"))).all([e,f,i,l].concat(n))}),q.length>0,m,u);d("WAWebBizCoexUtils").sendWamCoexPrivacySysMsgInsertSuccess(q)});return q.apply(this,arguments)}function r(a,b,c){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c===void 0&&(c=!1);c=d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&c;a=c===!0?yield d("WAWebAdvDeviceNotificationApi").bulkGenerateDeviceAndAdvAccountTypeChangeNotifications(a):{notifications:[],chatIds:[]};var e=a.notifications;a=a.chatIds;c=c&&e.some(function(a){return d("WAWebBizCoexUtils").isCoexSystemMsgType(a.subtype)});if(!b||c){b=(yield d("WAWebDBEncryptMultipleMsgs").encryptMultipleDBMsgs(e));v(e);return{chatIds:a,encryptedNotifications:b}}d("WAWebGetMessageCache").getMessageCache().addMessages(e.map(function(a){return{msg:a}}),!1);return{chatIds:[],encryptedNotifications:[]}});return s.apply(this,arguments)}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{yield (h||(h=b("Promise"))).all([d("WAWebSignalSessionApi").deleteRemoteInfo(a),d("WAWebSignalSessionApi").deleteDeviceSenderKey(a)])}catch(b){d("WALogger").LOG(i(),a.user)}});return u.apply(this,arguments)}function v(a){return(h||(h=b("Promise"))).all(a.map(function(a){return d("WAWebBackendApi").frontendSendAndReceive("processMultipleMessages",{chatId:a.from,msgObjs:[babelHelpers["extends"]({},a,{recvFresh:!0,isNewMsg:!0})],meta:{add:"after",isHistory:!1},processMessagesOrigin:"updateDeviceTableApi"})}))}g.clearDeviceRecord=a;g.bulkApplyDeviceUpdate=e}),98);
__d("WAWebWamEnumPushNotificationInteractions",[],(function(a,b,c,d,e,f){a=Object.freeze({SHOWN:1,CLICKED:2});f.PUSH_NOTIFICATION_INTERACTIONS=a}),66);
__d("WAWebWamEnumWebNotificationSettingType",[],(function(a,b,c,d,e,f){a=Object.freeze({ALLOWED:1,BLOCKED:2,UNKNOWN:3});f.WEB_NOTIFICATION_SETTING_TYPE=a}),66);
__d("WAWebWamEnumOffboardSources",[],(function(a,b,c,d,e,f){a=Object.freeze({IN_APP_SETTING:1,OS_SETTING:2});f.OFFBOARD_SOURCES=a}),66);
__d("WAWebWamEnumOnboardSources",[],(function(a,b,c,d,e,f){a=Object.freeze({DEFAULT:1,BACKGROUND_SYNC_BUTTERBAR:2,WEB_NOTIFICATION_BUTTERBAR:3,IN_APP_SETTING:4,AUTO_ENABLE:5});f.ONBOARD_SOURCES=a}),66);
__d("WAWebWebcBackgroundSyncAdoptionWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumOffboardSources","WAWebWamEnumOnboardSources","WAWebWamEnumPushNotificationInteractions","WAWebWamEnumWebNotificationSettingType"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({WebcBackgroundSyncAdoption:[5302,{offboardSource:[1,d("WAWebWamEnumOffboardSources").OFFBOARD_SOURCES],onboardSource:[2,d("WAWebWamEnumOnboardSources").ONBOARD_SOURCES],pushNotificationInteraction:[3,d("WAWebWamEnumPushNotificationInteractions").PUSH_NOTIFICATION_INTERACTIONS],webOsNotificationSetting:[4,d("WAWebWamEnumWebNotificationSettingType").WEB_NOTIFICATION_SETTING_TYPE]},[1,1,1],"regular"]},{WebcBackgroundSyncAdoption:[]});g.WebcBackgroundSyncAdoptionWamEvent=a}),98);
__d("WAWebBackgroundSyncReporter",["WAWebUserPrefsGeneral","WAWebWamEnumPushNotificationInteractions","WAWebWamEnumWebNotificationSettingType","WAWebWebcBackgroundSyncAdoptionWamEvent","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h=null;function a(){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a,b=(yield d("WAWebUserPrefsGeneral").getOfflineNotificationEngagement());a=((a=b==null?void 0:b.totalNotifShown)!=null?a:0)>0;b=((b=b==null?void 0:b.totalNotifTapToOpen)!=null?b:0)>0;b?h=d("WAWebWamEnumPushNotificationInteractions").PUSH_NOTIFICATION_INTERACTIONS.CLICKED:a&&(h=d("WAWebWamEnumPushNotificationInteractions").PUSH_NOTIFICATION_INTERACTIONS.SHOWN)});return i.apply(this,arguments)}function c(a){var b,c=a.offboardSource;a=a.onboardSource;var e=d("WAWebWamEnumWebNotificationSettingType").WEB_NOTIFICATION_SETTING_TYPE.UNKNOWN;((b=window.Notification)==null?void 0:b.permission)==="granted"?e=d("WAWebWamEnumWebNotificationSettingType").WEB_NOTIFICATION_SETTING_TYPE.ALLOWED:((b=window.Notification)==null?void 0:b.permission)==="denied"&&(e=d("WAWebWamEnumWebNotificationSettingType").WEB_NOTIFICATION_SETTING_TYPE.BLOCKED);b=new(d("WAWebWebcBackgroundSyncAdoptionWamEvent").WebcBackgroundSyncAdoptionWamEvent)();b.set({offboardSource:c,onboardSource:a,pushNotificationInteraction:h,webOsNotificationSetting:e});b.commit()}g.setPushNotificationInteractionStatus=a;g.logBackgroundSyncAdoptionEvent=c}),98);
__d("WAWebNotificationConstants",[],(function(a,b,c,d,e,f){a="granted";b="default";c="denied";f.PERMISSION_ALLOWED=a;f.PERMISSION_DEFAULT=b;f.PERMISSION_DENIED=c}),66);
__d("WAWebUserPrefsNotifications",["WATimeUtils","WAWebBackgroundSyncReporter","WAWebNotificationConstants","WAWebUserPrefsKeys","WAWebUserPrefsStore","WAWebWamEnumOnboardSources","cr:5151"],(function(a,b,c,d,e,f,g){function a(){return c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_MUTE_SOUNDS)!==!0}function e(a){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_MUTE_SOUNDS,!a)}function f(){return c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_MUTE_CALL_RINGTONE)!==!0}function h(a){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_MUTE_CALL_RINGTONE,!a)}function i(){var a=c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_MUTE_NOTIFICATIONS);if(typeof a!=="boolean"){var b;return((b=window.Notification)==null?void 0:b.permission)===d("WAWebNotificationConstants").PERMISSION_ALLOWED}return!a}function j(a){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_MUTE_NOTIFICATIONS,!a)}function k(){var a=c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_OFFLINE_NOTIFICATIONS_ENABLED);if(typeof a!=="boolean"){var b;b=((b=window.Notification)==null?void 0:b.permission)===d("WAWebNotificationConstants").PERMISSION_ALLOWED;b&&d("WAWebBackgroundSyncReporter").logBackgroundSyncAdoptionEvent({offboardSource:null,onboardSource:d("WAWebWamEnumOnboardSources").ONBOARD_SOURCES.DEFAULT});return b}return a}function l(a){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_OFFLINE_NOTIFICATIONS_ENABLED,a)}function m(){return c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.SECURITY_NOTIFICATIONS)!==!0}function n(a){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.SECURITY_NOTIFICATIONS,!a)}var o={isDismissed:!1,firstSeenTime:null};function p(){var a=c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.WEB_NOTIFICATIONS_BB_STATUS);if(a==null)return o;if(typeof a!=="object"||a instanceof Array)return o;a={isDismissed:a.isDismissed===!0,firstSeenTime:typeof a.firstSeenTime==="number"?d("WATimeUtils").castToUnixTime(a.firstSeenTime):null};return a}function q(a){var b,e=p();e=e.firstSeenTime;e=e===void 0?null:e;b=(b=a.firstSeenTime)!=null?b:e;c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.WEB_NOTIFICATIONS_BB_STATUS,{isDismissed:a.isDismissed,firstSeenTime:b})}var r={isDismissed:!1,firstSeenTime:null,isLongResumeTime:!1};function s(){var a=c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.OFFLINE_NOTIFICATIONS_BB_STATUS);if(a==null||typeof a!=="object"||a instanceof Array)return r;a={isDismissed:a.isDismissed===!0,firstSeenTime:typeof a.firstSeenTime==="number"?d("WATimeUtils").castToUnixTime(a.firstSeenTime):null,isLongResumeTime:a.isLongResumeTime===!0};return a}function t(a){var b,e=s(),f=e.isDismissed;f=f===void 0?!1:f;var g=e.firstSeenTime;g=g===void 0?null:g;e=e.isLongResumeTime;e=e===void 0?!1:e;b=(b=a.isDismissed)!=null?b:f;f=(f=a.firstSeenTime)!=null?f:g;a=(g=a.isLongResumeTime)!=null?g:e;c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.OFFLINE_NOTIFICATIONS_BB_STATUS,{isDismissed:b,firstSeenTime:f,isLongResumeTime:a})}function u(){return c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_MUTE_PREVIEWS)!==!0}function v(a){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_MUTE_PREVIEWS,!a)}function w(){return b("cr:5151")?c("WAWebUserPrefsStore").getUser(b("cr:5151").IGNORE_NONDIRECT_GROUP_MSG)===!0:!1}function x(a){b("cr:5151")&&c("WAWebUserPrefsStore").setUser(b("cr:5151").IGNORE_NONDIRECT_GROUP_MSG,a)}function y(){return c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.OUTGOING_MESSAGE_SOUND)===!0}function z(a){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.OUTGOING_MESSAGE_SOUND,a)}function A(){return c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_COLLAPSE_MUTED)===!0}function B(a){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_COLLAPSE_MUTED,a)}function C(){return c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_OFFLINE_NOTIFICATIONS_ENABLED_ONCE)===!0}function D(){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_OFFLINE_NOTIFICATIONS_ENABLED_ONCE,!0)}g.getGlobalSounds=a;g.setGlobalSounds=e;g.getGlobalCallRingtone=f;g.setGlobalCallRingtone=h;g.getGlobalNotifications=i;g.setGlobalNotifications=j;g.getGlobalOfflineNotifications=k;g.setGlobalOfflineNotifications=l;g.getGlobalSecurityNotifications=m;g.setGlobalSecurityNotifications=n;g.DEFAULT_NOTIFICATION_BB_STATUS=o;g.getWebNotificationsBBStatus=p;g.setWebNotificationsBBStatus=q;g.DEFAULT_OFFLINE_NOTIFICATION_BB_STATUS=r;g.getOfflineNotificationsBBStatus=s;g.setOfflineNotificationsBBStatus=t;g.getGlobalPreviews=u;g.setGlobalPreviews=v;g.getIgnoreNondirectGroupMsg=w;g.setIgnoreNondirectGroupMsg=x;g.getOutgoingMessageSound=y;g.setOutgoingMessageSound=z;g.getCollapseMuted=A;g.setCollapseMuted=B;g.getOfflineNotificationsEnabledOnce=C;g.setOfflineNotificationsEnabledOnce=D}),98);
__d("WAWebSecurityCodeApi",["WALogger","WAWebApiContact","WAWebBackendApi","WAWebContactSystemMsg","WAWebDBEncryptMultipleMsgs","WAWebDBStoreEncryptedMsgs","WAWebGetMessageCache","WAWebSchemaChat","WAWebSchemaGroupMetadata","WAWebSchemaParticipant","WAWebSingleSignalSession","WAWebUserPrefsNotifications","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["get chats failed"]);h=function(){return a};return a}function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b===void 0&&(b=!1);if(a.isBot())return;var c=null;a.isLid()&&d("WAWebSingleSignalSession").isUsingAccountIdentifierForSignalStorage()&&(c=d("WAWebApiContact").getPnIfLidIsLatestMapping(d("WAWebWidFactory").toUserWid(a)));a=(yield j(a,c));c=a.notifications;var e=a.chatIds;if(c.length===0)return;if(!b){c=c.map(function(a){return babelHelpers["extends"]({},a,{recvFresh:!0,isNewMsg:!0})});for(b of c)d("WAWebBackendApi").frontendSendAndReceive("processMultipleMessages",{chatId:b.from,msgObjs:[b],meta:{add:"after",isHistory:!1},processMessagesOrigin:"securityCodeApi"});b=(yield d("WAWebDBEncryptMultipleMsgs").encryptMultipleDBMsgs(c));yield d("WAWebDBStoreEncryptedMsgs").storeEncryptedDBMessages(b,e,!1);return a}d("WAWebGetMessageCache").getMessageCache().addMessages(c.map(function(a){return{msg:a}}),!1);return a});return i.apply(this,arguments)}function j(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e={notifications:[],chatIds:[]};b=b==null?[a]:[a,b];if(!d("WAWebUserPrefsNotifications").getGlobalSecurityNotifications())return e;var f=[];try{var g=(yield d("WAWebSchemaChat").getChatTable().bulkGet(b.map(function(a){return a.toString()}),!1)).filter(Boolean);f.push.apply(f,g.map(function(a){return d("WAWebWidFactory").createWid(a.id)}));g=(yield d("WAWebSchemaParticipant").getParticipantTable().anyOf(["participants"],b.map(String)));var i=new Map();if(g.length>0){b=g.map(function(a){return a.groupId});(yield d("WAWebSchemaGroupMetadata").getGroupMetadataTable().bulkGet(b)).forEach(function(a){a!=null&&i.set(a.id,a)})}g.forEach(function(b){var c=i.get(b.groupId);if(Boolean(c==null?void 0:c.defaultSubgroup)===!0&&a.isLid())return;f.push(d("WAWebWidFactory").createWid(b.groupId))})}catch(a){d("WALogger").ERROR(h()).verbose().devConsole(a).sendLogs("get chats failed when creating device notification");throw c("err")("get chats failed")}b=f.map(function(b){return d("WAWebContactSystemMsg").genSecurityCodeNotificationMsg(b,a)});e.notifications=b;e.chatIds=f.map(String);return e});return k.apply(this,arguments)}g.addSecurityCodeChangedNotifications=a;g.generateSecurityCodeChangedNotifications=j}),98);
__d("WAWebDeviceSentMessageProtoUtils",[],(function(a,b,c,d,e,f){function a(a,b){var c={deviceSentMessage:{destinationJid:b.toString({legacy:!0}),message:a}},d=a==null?void 0:a.messageContextInfo;return d==null?c:{messageContextInfo:babelHelpers["extends"]({},d),deviceSentMessage:{destinationJid:b.toString({legacy:!0}),message:babelHelpers["extends"]({},a,{messageContextInfo:void 0})}}}function b(a){var b,c;b=a==null?void 0:(b=a.deviceSentMessage)==null?void 0:b.message;a=a==null?void 0:(a=a.messageContextInfo)==null?void 0:a.messageSecret;return b==null||a==null||((c=b.messageContextInfo)==null?void 0:c.messageSecret)!=null?b:babelHelpers["extends"]({},b,{messageContextInfo:babelHelpers["extends"]({},b.messageContextInfo,{messageSecret:a})})}f.wrapDeviceSentMessage=a;f.unwrapDeviceSentMessage=b}),66);
__d("WAWebProtobufsEphemeral.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={duration:[1,d("WAProtoConst").TYPES.SFIXED32],timestamp:[2,d("WAProtoConst").TYPES.SFIXED64]};g.EphemeralSettingSpec=a}),98);
__d("WAWebEphemeralDecodeBroadcastSetting",["WABase64","WABinary","WATimeUtils","WAWebProtobufsEphemeral.pb","asyncToGeneratorRuntime","decodeProtobuf","err"],(function(a,b,c,d,e,f,g){var h=new Uint8Array(32);function i(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield self.crypto.subtle.importKey("raw",a,"HKDF",!1,["deriveKey"]));b=(yield self.crypto.subtle.deriveKey({name:"HKDF",hash:"SHA-256",salt:h,info:b},a,{name:"HMAC",hash:"SHA-256"},!0,["verify"]));return self.crypto.subtle.exportKey("raw",b)});return j.apply(this,arguments)}function k(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var d=a.slice(0,12);a=a.slice(12,44);a=(yield self.crypto.subtle.importKey("raw",a,"AES-GCM",!1,["decrypt"]));return self.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(d),additionalData:c},a,b)});return l.apply(this,arguments)}function a(a,b,c,d,e){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g){a=a.toString({legacy:!0});b=b.toString({legacy:!0});e=e.toString({legacy:!0});b="Ephemeral "+b+" "+a;a=d("WABinary").Binary.build(b).readByteArray();b=new Uint8Array(g);g=d("WABase64").decodeB64(f);f=d("WABinary").Binary.build(e).readBuffer();e=(yield i(b,a));b=(yield k(e,g,f));a=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsEphemeral.pb").EphemeralSettingSpec,b);e=a.duration;g=a.timestamp;if(e==null||g==null)throw c("err")("ephSetting decoded into malformed proto");return{ephemeralDuration:e,ephemeralSettingTimestamp:d("WATimeUtils").castLongIntToUnixTime(g)}});return m.apply(this,arguments)}g.decodeBroadcastEphemeralSetting=a}),98);
__d("WAWebFutureproofingEdit",["WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){return babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"message_edit",futureproofType:d("WAWebMsgType").MSG_TYPE.PROTOCOL,futureproofSubtype:"message_edit"})}g.futureproofEdit=a}),98);
__d("WAWebGroupMsgReceiveUtils",["WAWebGroupType","WAWebMessageEditGatingUtils","WAWebSchemaGroupMetadata","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaGroupMetadata").getGroupMetadataTable().get(a.toString()));if(!a)return!1;a=d("WAWebGroupType").getGroupTypeFromGroupMetadata(a);return a===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP?!d("WAWebMessageEditGatingUtils").receiveCagMsgEditEnabled():!1});return h.apply(this,arguments)}g.futureproofEditInCAG=a}),98);
__d("WAWebMsgProcessingApiUtils",["Promise","WAJids","WALogger","WANullthrows","WAWebABProps","WAWebAck","WAWebBackendJobs.flow","WAWebBizCoexGatingUtils","WAWebBotGating","WAWebDeviceSentMessageProtoUtils","WAWebE2EProtoParser","WAWebE2EProtoUtils","WAWebEphemeralDecodeBroadcastSetting","WAWebFutureproofingEdit","WAWebGroupMsgReceiveUtils","WAWebHandleMsgCommon","WAWebHandleMsgError","WAWebHandleMsgMetaUtils","WAWebHandleMsgTypes.flow","WAWebMsgKey","WAWebMsgKeyUtils","WAWebMsgType","WAWebProcessBaseMsgInfo","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebWamEnumDeviceType","WAWebWamEnumDsmError","WAWebWamMsgUtils","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["drop: cannot create MsgKey: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["protocol message: wid error in type ",""]);j=function(){return a};return a}function k(a){var b,c="";((b=a.protocolMessage)==null?void 0:b.historySyncNotification)!=null?c="historySyncNotification":((b=a.protocolMessage)==null?void 0:b.initialSecurityNotificationSettingSync)!=null?c="initialSecurityNotificationSettingSync":((b=a.protocolMessage)==null?void 0:b.appStateSyncKeyRequest)!=null?c="appStateSyncKeyRequest":((b=a.protocolMessage)==null?void 0:b.appStateSyncKeyShare)!=null?c="appStateSyncKeyShare":((b=a.protocolMessage)==null?void 0:b.peerDataOperationRequestResponseMessage)!=null?c="peerDataOperationRequestResponseMessage":((b=a.protocolMessage)==null?void 0:b.peerDataOperationRequestMessage)!=null?c="peerDataOperationRequestMessage":((b=a.protocolMessage)==null?void 0:b.cloudApiThreadControlNotification)!=null&&(c="cloudApiThreadControlNotification");d("WALogger").ERROR(j(),c).sendLogs("wid error")}function l(a){var b=a.info,e=a.msgProtobuf,f=a.paymentInfo,g=a.bizInfo;a=a.msgBotInfo;var h,i=G(b);if(!d("WAWebUserPrefsMeUser").isMeAccountNonLid(i)){k(e);return}if(((i=e.protocolMessage)==null?void 0:i.historySyncNotification)!=null){i=d("WAWebE2EProtoParser").parseMsgProto(e,A(b),"relay",f,void 0,void 0,g);B(i,a);h={history:c("WANullthrows")(i.historySyncMetaData)}}else if(((b=e.protocolMessage)==null?void 0:b.initialSecurityNotificationSettingSync)!=null){h={securityNotificationEnabled:{isEnabled:(f=e.protocolMessage.initialSecurityNotificationSettingSync.securityNotificationEnabled)!=null?f:!0}}}else if(((g=e.protocolMessage)==null?void 0:g.appStateSyncKeyShare)!=null)h={appStateSyncKeyShare:e.protocolMessage.appStateSyncKeyShare};else if(((a=e.protocolMessage)==null?void 0:a.appStateSyncKeyRequest)!=null)h={appStateSyncKeyRequest:e.protocolMessage.appStateSyncKeyRequest};else if(((i=e.protocolMessage)==null?void 0:i.peerDataOperationRequestResponseMessage)!=null){h={peerDataOperationRequestResponseMessage:(b=e.protocolMessage)==null?void 0:b.peerDataOperationRequestResponseMessage}}else if(((f=e.protocolMessage)==null?void 0:f.peerDataOperationRequestMessage)!=null){h={peerDataOperationRequestMessage:(g=e.protocolMessage)==null?void 0:g.peerDataOperationRequestMessage}}else if(((a=e.protocolMessage)==null?void 0:a.cloudApiThreadControlNotification)!=null){h={cloudApiThreadControlNotification:(i=e.protocolMessage)==null?void 0:i.cloudApiThreadControlNotification}}return h}function a(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,e=a.msgProtobuf,f=a.info;if(((b=e.protocolMessage)==null?void 0:b.historySyncNotification)!=null||((b=e.protocolMessage)==null?void 0:b.initialSecurityNotificationSettingSync)!=null||((b=e.protocolMessage)==null?void 0:b.appStateSyncKeyShare)!=null||((b=e.protocolMessage)==null?void 0:b.appStateSyncKeyRequest)!=null||((b=e.protocolMessage)==null?void 0:b.peerDataOperationRequestResponseMessage)!=null||((b=e.protocolMessage)==null?void 0:b.peerDataOperationRequestMessage)!=null||((b=e.protocolMessage)==null?void 0:b.cloudApiThreadControlNotification)!=null)return l({info:f,msgProtobuf:e,paymentInfo:a.paymentInfo,bizInfo:a.bizInfo,hsmInfo:a.hsmInfo});switch(f.type){case d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.CHAT:return d("WAWebUserPrefsMeUser").isMeAccount(f.author)?p(a):t(a);case d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.GROUP:return f.isDirect&&d("WAWebUserPrefsMeUser").isMeAccount(f.author)&&!H(a)?p(a):t(a);case d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.PEER_BROADCAST:if(a.ciphertextType===d("WAWebBackendJobs.flow").CiphertextType.Skmsg){if(!f.bclHashValidated)throw c("err")("parseMessage: participants for peer broadcast message is not validated");return t(a)}return r(a);case d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.OTHER_BROADCAST:return t(a);case d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.DIRECT_PEER_STATUS:return f.isDirect===!0?n(a):r(a);case d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.OTHER_STATUS:return t(a);default:throw c("err")("Unrecognized MESSAGE_TYPE")}});return m.apply(this,arguments)}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{return yield p(a)}catch(c){if(c instanceof d("WAWebHandleMsgError").DeviceSentMessageError){var b=Object.keys(a.msgProtobuf).filter(function(a){return a!=="$$unknownFieldCount"&&a!=="messageContextInfo"});if(b.length===1&&b[0]==="senderKeyDistributionMessage")return t(a)}throw c}});return o.apply(this,arguments)}function p(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.msgProtobuf;a=babelHelpers.objectWithoutPropertiesLoose(a,["msgProtobuf"]);var c=b.deviceSentMessage;if(c==null)throw new(d("WAWebHandleMsgError").DeviceSentMessageError)(F(a.info.author),d("WAWebWamEnumDsmError").DSM_ERROR.MISSING_DSM);if(c.destinationJid==null)throw new(d("WAWebHandleMsgError").DeviceSentMessageError)(F(a.info.author),d("WAWebWamEnumDsmError").DSM_ERROR.INVALID_DSM);c=c.destinationJid;b=(yield v(d("WAWebDeviceSentMessageProtoUtils").unwrapDeviceSentMessage(b),a));return babelHelpers["extends"]({deviceSent:{destination:d("WAWebWidFactory").createWid(c)}},b)});return q.apply(this,arguments)}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.msgProtobuf;a=babelHelpers.objectWithoutPropertiesLoose(a,["msgProtobuf"]);var c=a.info,e=b.deviceSentMessage;if(e==null)throw new(d("WAWebHandleMsgError").DeviceSentMessageError)(F(c.author),d("WAWebWamEnumDsmError").DSM_ERROR.MISSING_DSM);if(e.phash==null)throw new(d("WAWebHandleMsgError").DeviceSentMessageError)(F(c.author),d("WAWebWamEnumDsmError").DSM_ERROR.INVALID_DSM);e=e.phash;b=(yield v(d("WAWebDeviceSentMessageProtoUtils").unwrapDeviceSentMessage(b),a));return babelHelpers["extends"]({deviceSent:{phash:e,info:c}},b)});return s.apply(this,arguments)}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.msgProtobuf;a=babelHelpers.objectWithoutPropertiesLoose(a,["msgProtobuf"]);if(b.deviceSentMessage!=null)throw new(d("WAWebHandleMsgError").DeviceSentMessageError)(F(a.info.author),d("WAWebWamEnumDsmError").DSM_ERROR.INVALID_SENDER);b=(yield v(b,a));return babelHelpers["extends"]({deviceSent:null},b)});return u.apply(this,arguments)}function v(a,b){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e,f=b.info,g=b.paymentInfo,h=b.bizInfo,i=b.hidePlaceholder,j=b.processDecryptedProtoParams,k=b.hsmInfo;b=b.msgBotInfo;if(a==null)return{senderKey:null,storeMsg:null,renderableMsgs:[]};h=babelHelpers["extends"]({},d("WAWebE2EProtoParser").parseMsgProto(a,A(f),"relay",g,void 0,void 0,h,f.edit,j==null?void 0:j.rcat,j==null?void 0:(g=j.msgMeta)==null?void 0:g.bizSource,j==null?void 0:j.msgMeta));g=h;g=g.disappearingModeTrigger;e=(e=h.id.remote)!=null?e:h.from;if(e!=null&&c("WAWebWid").isGroup(e)&&g!=null&&d("WAWebABProps").getABPropConfigValue("dm_initiator_trigger_groups")){g=(yield d("WAWebE2EProtoUtils").updateDisappearingModeForGroups(g,e));g!=null&&(h=babelHelpers["extends"]({},h,g))}B(h,b,j==null?void 0:(e=j.msgMeta)==null?void 0:e.targetSenderJid,j==null?void 0:(g=j.msgMeta)==null?void 0:g.targetId);k!=null&&(h.hsmTag=k.tag,h.hsmCategory=k.category);if((j==null?void 0:(b=j.msgMeta)==null?void 0:b.bizSource)!=null){h.bizSource=j==null?void 0:(e=j.msgMeta)==null?void 0:e.bizSource}g=a.senderKeyDistributionMessage!=null?x(f,a.senderKeyDistributionMessage):null;if(h.subtype==="message_edit"&&h.futureproofSubtype!=="message_edit"&&(yield d("WAWebGroupMsgReceiveUtils").futureproofEditInCAG(f.chat))){k=d("WAWebProcessBaseMsgInfo").msgDataToBaseMsgInfo(h);h=babelHelpers["extends"]({},d("WAWebFutureproofingEdit").futureproofEdit(k))}b=h.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&g==null;e=h.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&g!=null;a=null;if(b&&j!=null){k=j.decrypted;j.reparsing;b=babelHelpers.objectWithoutPropertiesLoose(j,["decrypted","reparsing"]);h.futureproofParams=b;h.futureproofBuffer=k}f.type===d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.OTHER_STATUS&&(h.campaignId=f.campaignId,h.campaignDuration=f.campaignDuration);f.type===d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.PEER_BROADCAST&&(h.broadcastId=f.chat,h.broadcastParticipants=f.bclParticipants,h.broadcastEphSettings=f.bclEphSettings,a=h);if(f.type===d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.OTHER_BROADCAST){h.broadcastId=f.chat;j=f.ephSetting;b=h.ephemeralSharedSecret;if(j!=null&&b!=null){k=(yield d("WAWebEphemeralDecodeBroadcastSetting").decodeBroadcastEphemeralSetting(f.chat,f.author.isLid()?c("WANullthrows")(d("WAWebUserPrefsMeUser").getMaybeMeLidUser()):d("WAWebUserPrefsMeUser").getMeUser(),f.author,j,b));j=k.ephemeralDuration;b=k.ephemeralSettingTimestamp;h.ephemeralDuration=j;h.ephemeralSettingTimestamp=b}}k=[];j=h.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN;b=e||j&&i===!0&&h.futureproofType==null;b||(f.type===d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.PEER_BROADCAST?k=(yield C(h,f.bclParticipants,f.bclEphSettings)):(h.subtype==="payment_transaction_request_cancelled"||h.subtype==="payment_action_request_declined")&&h.paymentRequestMessageKey==null||(k=[h]));return{senderKey:g,storeMsg:a,renderableMsgs:k}});return w.apply(this,arguments)}function x(a,b){if(!a.chat.isGroup()&&!a.chat.isBroadcast())throw c("err")("should not have senderkey");var d=b.groupId;b=b.axolotlSenderKeyDistributionMessage;if(d==null||a.chat.toString({legacy:!0})!==d)throw c("err")("senderKeyDistributionMessage: from "+a.chat.toString()+" mismatched to "+(d||"null"));if(!b)throw c("err")("senderKeyDistributionMessage: from "+a.author.toString()+" has no content");return{groupId:d,key:b}}function y(a){if(a.edit===d("WAWebAck").EDIT_ATTR.SENDER_REVOKE&&a.type!==d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.PEER_BROADCAST)return!1;return a.edit===d("WAWebAck").EDIT_ATTR.ADMIN_REVOKE?!1:!0}function e(a){var b=a.msgInfo,c=a.placeholderType,e=a.msgMeta;a=a.placeholderAddReason;if(!y(b))return null;var f=null;switch(c){case d("WAWebHandleMsgTypes.flow").PlaceholderType.E2E:f=void 0;break;case d("WAWebHandleMsgTypes.flow").PlaceholderType.BOT_UNAVAILABLE_FANOUT:f="bot_unavailable_fanout";break;case d("WAWebHandleMsgTypes.flow").PlaceholderType.HOSTED_UNAVAILABLE_FANOUT:f="hosted_unavailable_fanout";break;default:f="fanout"}c=d("WAWebHandleMsgMetaUtils").getMsgTypeFromMsgMeta(e);f=babelHelpers["extends"]({},A(b),{type:d("WAWebMsgType").MSG_TYPE.CIPHERTEXT,kind:d("WAWebMsgType").MsgKind.Ciphertext,subtype:f,e2eSenderType:d("WAWebWamMsgUtils").getWamE2eSenderType(b.author),placeholderAddReason:a,broadcastParticipants:b.type===d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.PEER_BROADCAST?b.bclParticipants:void 0,broadcastEphSettings:b.type===d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.PEER_BROADCAST?b.bclEphSettings:void 0});return c!=null?babelHelpers["extends"]({},f,{parentMsgKey:d("WAWebE2EProtoUtils").createMsgKeyFromThreadInfo(e,b,c),kind:d("WAWebMsgType").MsgKind.PlaceholderAddon,realType:c}):babelHelpers["extends"]({},f,{kind:d("WAWebMsgType").MsgKind.PlaceholderMessage})}function f(a,b){a=babelHelpers["extends"]({},A(a),{type:d("WAWebMsgType").MSG_TYPE.DEBUG_PLACEHOLDER,kind:d("WAWebMsgType").MsgKind.DebugPlaceholder,body:b.toString()});return a}function z(a,b){if(d("WAWebBotGating").isBotMsgParseEnabledForFutureproofOrFullRecv()&&b.botParticipant!=null)return b.botParticipant;if(!a.fromMe&&c("WAWebWid").isGroup(a.remote)||c("WAWebWid").isStatus(a.remote))return a.participant;return!d("WAWebUserPrefsMeUser").isMeDevice(b.author)&&d("WAWebUserPrefsMeUser").isMeAccount(b.author)?b.author:void 0}function A(a){var b=E(a),e=d("WAWebUserPrefsMeUser").getMeUser(),f=d("WAWebUserPrefsMeUser").getMaybeMeLidUser();b.fromMe&&c("WAWebWid").isGroup(b.remote)&&a.author.isLid()&&f!=null?f=f:f=e;f=b.fromMe?f:b.remote;f={id:b,from:f,to:b.fromMe?b.remote:e,type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,t:a.ts||0,ack:d("WAWebMsgKeyUtils").isNoteToSelf(b)?d("WAWebAck").ACK.READ:d("WAWebAck").ACK.SENT,author:z(b,a),notifyName:a.pushname||"",invis:!1,count:a.count};d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&a.hostedBizEncStateMismatch===!0&&((e=f.id)==null?void 0:(b=e.remote)==null?void 0:b.isUser())&&(f.hostedBizEncStateMismatch=!0);d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&a.senderOrRecipientAccountTypeHosted===!0&&((e=f.id)==null?void 0:(b=e.remote)==null?void 0:b.isUser())&&(f.senderOrRecipientAccountTypeHosted=!0);d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&a.placeholderCreatedWhenAccountIsHosted!=null&&((e=f.id)==null?void 0:(b=e.remote)==null?void 0:b.isUser())&&(f.placeholderCreatedWhenAccountIsHosted=a.placeholderCreatedWhenAccountIsHosted);return f}function B(a,b,c,e){if(b!=null&&d("WAWebBotGating").isBotMsgParseEnabledForFutureproofOrFullRecv()){a=a;Object.assign(a,{botEditTargetId:b.botEditTargetId,botEditType:b.botEditType,bizBotType:b.bizBotType,botTargetSenderJid:c,botMsgBodyType:b.botMsgBodyType,botResponseTargetId:e})}}function C(a,b,c){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){e=(yield (h||(h=b("Promise"))).all(e.map(function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var e;try{e=new(c("WAWebMsgKey"))({remote:b,fromMe:!0,id:a.id.id})}catch(a){d("WALogger").WARN(i(),a.stack);return null}var g,h,j=f?f[b.toString()]:null,k=a.ephemeralSharedSecret,l=a.broadcastId;if(l!=null&&j!=null&&k!=null){l=(yield d("WAWebEphemeralDecodeBroadcastSetting").decodeBroadcastEphemeralSetting(l,b,b.isLid()?c("WANullthrows")(d("WAWebUserPrefsMeUser").getMaybeMeLidUser()):d("WAWebUserPrefsMeUser").getMeUser(),j,k));g=l.ephemeralDuration;h=l.ephemeralSettingTimestamp}j=babelHelpers["extends"]({},a,{id:e,from:d("WAWebUserPrefsMeUser").getMeUser(),to:b,broadcast:!0,ephemeralDuration:g,ephemeralSettingTimestamp:h,protocolMessageKey:a.protocolMessageKey==null?void 0:new(c("WAWebMsgKey"))({remote:b,fromMe:!0,id:a.protocolMessageKey.id})});return j});return function(a){return e.apply(this,arguments)}}())));return e.filter(Boolean)});return D.apply(this,arguments)}function E(a){if(a.type===d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.OTHER_BROADCAST)return new(c("WAWebMsgKey"))({remote:d("WAWebWidFactory").toUserWid(a.author),fromMe:!1,id:a.externalId});else if(a.type===d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.CHAT)return d("WAWebBotGating").isBotMsgParseEnabledForFutureproofOrFullRecv()&&a.botParticipant!=null?new(c("WAWebMsgKey"))({remote:a.chat,fromMe:d("WAWebUserPrefsMeUser").isMeAccount(a.author),id:a.externalId,participant:d("WAWebWidFactory").toUserWid(c("WANullthrows")(a.botParticipant))}):new(c("WAWebMsgKey"))({remote:a.chat,fromMe:d("WAWebUserPrefsMeUser").isMeAccount(a.author),id:a.externalId});return new(c("WAWebMsgKey"))({remote:a.chat,fromMe:d("WAWebUserPrefsMeUser").isMeAccount(a.author),participant:d("WAWebWidFactory").toUserWid(a.author),id:a.externalId})}function F(a){return a.device==null||a.device===d("WAJids").DEFAULT_DEVICE_ID?d("WAWebWamEnumDeviceType").DEVICE_TYPE.PRIMARY:d("WAWebWamEnumDeviceType").DEVICE_TYPE.COMPANION}function G(a){return a.type===d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.CHAT?a.author:a.chat}function H(a){var b;return((b=a.meta)==null?void 0:b.appdata)===d("WAWebHandleMsgCommon").APPDATA["default"]&&a.msgProtobuf.senderKeyDistributionMessage!=null}g.parseProtocolMessage=l;g.parseMessage=a;g.isRevokeInfo=y;g.generatePlaceholder=e;g.genDebugPlaceholderMsg=f;g.generateBaseMsg=A;g.generateBclMsgs=C;g.messageInfoToKey=E;g.getDeviceType=F;g.getFrom=G}),98);
__d("WAWebWamEnumAgentEngagementEnumType",[],(function(a,b,c,d,e,f){a=Object.freeze({DIRECT_CHAT:0,INVOKED:1,MEMBER:2});f.AGENT_ENGAGEMENT_ENUM_TYPE=a}),66);
__d("WAWebWamEnumBotType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,METABOT:1,BOT_1P_BIZ:2,BOT_3P_BIZ:3,UGC:4,META_CHARACTER:5});f.BOT_TYPE=a}),66);
__d("WAWebWamEnumInvisibleMessageCategoryType",[],(function(a,b,c,d,e,f){a=Object.freeze({PEER:1,INVISIBLE_KEY_DISTRIBUTION:2,OTHER:3,MEDIA_EXPRESS_NOTIFY:4,EPHEMERAL_SYNC_RESPONSE:5});f.INVISIBLE_MESSAGE_CATEGORY_TYPE=a}),66);
__d("WAWebWamEnumMessageDropReasonType",[],(function(a,b,c,d,e,f){a=Object.freeze({SYNCD_DELETION:1,ADMIN_REVOKE_NOT_ENABLED:2,RECEIVED_WITH_OLD_COUNTER:3,INVALID_STANZA:4,INVALID_PROTOBUF:5,MESSAGE_SECRET_ERROR:6,INVALID_LID_ADDRESSED_MESSAGE:7,UNKNOWN_MESSAGE_TYPE:8,DB_OPERATION_FAILED:9,INTERNAL_ERROR:10,EXPIRED:11,INVALID_HOSTED_COMPANION_STANZA:12,MESSAGE_REVOKED:13,PAYMENT_MESSAGE_REVOKED:14,DUPLICATE_MESSAGE:15,DUPLICATE_DELIVERY:16,INVALID_MESSAGE_REFERENCE:17});f.MESSAGE_DROP_REASON_TYPE=a}),66);
__d("WAWebIncomingMessageDropWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumAddressingMode","WAWebWamEnumAgentEngagementEnumType","WAWebWamEnumBotType","WAWebWamEnumE2eCiphertextType","WAWebWamEnumE2eDestination","WAWebWamEnumE2eDeviceType","WAWebWamEnumE2eFailureReason","WAWebWamEnumInvisibleMessageCategoryType","WAWebWamEnumMediaType","WAWebWamEnumMessageDropReasonType","WAWebWamEnumRevokeType","WAWebWamEnumTypeOfGroupEnum"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({IncomingMessageDrop:[3724,{agentEngagementType:[12,d("WAWebWamEnumAgentEngagementEnumType").AGENT_ENGAGEMENT_ENUM_TYPE],botType:[14,d("WAWebWamEnumBotType").BOT_TYPE],e2eCiphertextType:[1,d("WAWebWamEnumE2eCiphertextType").E2E_CIPHERTEXT_TYPE],e2eDestination:[2,d("WAWebWamEnumE2eDestination").E2E_DESTINATION],e2eFailureReason:[9,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON],e2eSenderType:[3,d("WAWebWamEnumE2eDeviceType").E2E_DEVICE_TYPE],invisibleMessageCategory:[13,d("WAWebWamEnumInvisibleMessageCategoryType").INVISIBLE_MESSAGE_CATEGORY_TYPE],isLid:[15,a.TYPES.BOOLEAN],localAddressingMode:[16,d("WAWebWamEnumAddressingMode").ADDRESSING_MODE],messageDropReason:[4,d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE],messageMediaType:[5,d("WAWebWamEnumMediaType").MEDIA_TYPE],offline:[6,a.TYPES.BOOLEAN],offlineCount:[11,a.TYPES.INTEGER],retryCount:[7,a.TYPES.INTEGER],revokeType:[8,d("WAWebWamEnumRevokeType").REVOKE_TYPE],typeOfGroup:[10,d("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM]},[1,1,1],"regular"]},{IncomingMessageDrop:[]});g.IncomingMessageDropWamEvent=b}),98);
__d("WAWebPostIncomingMessageDropMetric",["WADeprecatedWapParser","WAWebAck","WAWebBackendJobs.flow","WAWebBackendJobsCommon","WAWebDBMessageSerialization","WAWebHandleMsgCommon","WAWebIncomingMessageDropWamEvent","WAWebJidToWid","WAWebMsgGetters","WAWebMsgProcessingApiUtils","WAWebWamEnumAgentEngagementEnumType","WAWebWamEnumBotType","WAWebWamEnumMessageDropReasonType","WAWebWamEnumRevokeType","WAWebWamMsgUtils"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("incomingMsgParserForMetric",function(a){var b={};try{b.type=a.attrEnum("type",d("WAWebHandleMsgCommon").STANZA_MSG_TYPES)}catch(a){}try{b.pollType=b.type===d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.poll?a.child("meta").attrEnumOrNullIfUnknown("polltype",d("WAWebHandleMsgCommon").POLL_TYPES):null}catch(a){}try{var c;b.from=d("WAWebJidToWid").jidWithTypeToWid(a.attrJidWithType("from"));((c=b.from)==null?void 0:c.isUser())?b.author=b.from:((c=b.from)==null?void 0:c.isGroup())&&(b.author=a.hasAttr("participant")?d("WAWebJidToWid").deviceJidToDeviceWid(a.attrDeviceJid("participant")):null)}catch(a){}try{b.offline=a.attrInt("offline")}catch(a){}try{b.edit=a.attrInt("edit")}catch(a){}try{c=a.attrString("category");c=d("WAWebWamMsgUtils").getWamInvisibleMessageCatgoryType(c);c!=null&&(b.invisibleMessageCategoryType=c)}catch(a){}c=a.maybeChild("enc");if(c!=null){try{b.e2eType=c.attrEnumValues("type",d("WAWebBackendJobs.flow").CiphertextType.members())}catch(a){}try{b.encMediaType=d("WAWebBackendJobs.flow").EncMediaType.cast(c.maybeAttrString("mediatype"))}catch(a){}try{b.retryCount=c.attrInt("count")}catch(a){}}try{b.botType=d("WAWebWamEnumBotType").BOT_TYPE.UNKNOWN;if((c=b.author)==null?void 0:c.isBot())b.botType=d("WAWebWamEnumBotType").BOT_TYPE.METABOT;else{a=(c=a.maybeChild("bot"))==null?void 0:c.maybeAttrString("biz_bot");a==="1"?b.botType=d("WAWebWamEnumBotType").BOT_TYPE.BOT_1P_BIZ:a==="3"&&(b.botType=d("WAWebWamEnumBotType").BOT_TYPE.BOT_3P_BIZ)}}catch(a){}return b});function i(a){var b=a.messageDropReason;a=a.stanza;var c=null;try{c=h.parse(a).success}catch(a){}b=new(d("WAWebIncomingMessageDropWamEvent").IncomingMessageDropWamEvent)({messageDropReason:b,offline:((a=c)==null?void 0:a.offline)!=null,offlineCount:(b=c)==null?void 0:b.offline,messageMediaType:d("WAWebBackendJobsCommon").getMetricMediaType({encMediaType:(a=c)==null?void 0:a.encMediaType,msgType:(b=c)==null?void 0:b.type,msgPollType:(a=c)==null?void 0:a.pollType})});if(((a=c)==null?void 0:a.from)!=null){a=d("WAWebBackendJobsCommon").getMetricE2eDestination(c.from);a!=null&&(b.e2eDestination=a)}if(((a=c)==null?void 0:a.author)!=null){a=d("WAWebWamMsgUtils").getWamE2eSenderType(c.author);a!=null&&(b.e2eSenderType=a)}((a=c)==null?void 0:a.e2eType)!=null&&(b.e2eCiphertextType=d("WAWebBackendJobsCommon").getMetricE2eCiphertextType(c.e2eType));((a=c)==null?void 0:a.retryCount)!=null&&(b.retryCount=c.retryCount);((a=c)==null?void 0:a.edit)===d("WAWebAck").EDIT_ATTR.ADMIN_REVOKE?b.revokeType=d("WAWebWamEnumRevokeType").REVOKE_TYPE.ADMIN:((a=c)==null?void 0:a.edit)===d("WAWebAck").EDIT_ATTR.SENDER_REVOKE&&(b.revokeType=d("WAWebWamEnumRevokeType").REVOKE_TYPE.SENDER);if(((a=c)==null?void 0:a.from)!=null&&((a=c)==null?void 0:a.author)!=null){if(((a=c)==null?void 0:(a=a.author)==null?void 0:a.isBot())===!0){((a=c)==null?void 0:(a=a.from)==null?void 0:a.isBot())===!0?b.agentEngagementType=d("WAWebWamEnumAgentEngagementEnumType").AGENT_ENGAGEMENT_ENUM_TYPE.DIRECT_CHAT:b.agentEngagementType=d("WAWebWamEnumAgentEngagementEnumType").AGENT_ENGAGEMENT_ENUM_TYPE.INVOKED}}if((a=c)==null?void 0:a.botType){b.botType=(a=c)==null?void 0:a.botType}((a=c)==null?void 0:a.invisibleMessageCategoryType)!=null&&(b.invisibleMessageCategory=c.invisibleMessageCategoryType);b.commit()}function a(a){i({messageDropReason:d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.INVALID_STANZA,stanza:a})}function b(a){i({messageDropReason:d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.UNKNOWN_MESSAGE_TYPE,stanza:a})}function e(a){i({messageDropReason:d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.INTERNAL_ERROR,stanza:a})}function f(a){i({messageDropReason:d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.DB_OPERATION_FAILED,stanza:a})}function j(a){i({messageDropReason:d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.INVALID_HOSTED_COMPANION_STANZA,stanza:a})}function k(a,b){var c=a.msgInfo,e=a.msgMeta,f=a.enc;a=a.error;b=new(d("WAWebIncomingMessageDropWamEvent").IncomingMessageDropWamEvent)({messageDropReason:b,e2eCiphertextType:d("WAWebBackendJobsCommon").getMetricE2eCiphertextType(f.e2eType),messageMediaType:d("WAWebBackendJobsCommon").getMetricMediaType({encMediaType:f.encMediaType,msgType:e.type,msgPollType:e.pollType}),retryCount:f.retryCount,offline:c.offline!=null,e2eFailureReason:a==null?void 0:a.e2eFailureReason});e=d("WAWebMsgProcessingApiUtils").getFrom(c);f=d("WAWebBackendJobsCommon").getMetricE2eDestination(e);f!=null&&(b.e2eDestination=f);if(e){a=d("WAWebWamMsgUtils").getWamE2eSenderType(e);a!=null&&(b.e2eSenderType=a)}c.edit===d("WAWebAck").EDIT_ATTR.ADMIN_REVOKE?b.revokeType=d("WAWebWamEnumRevokeType").REVOKE_TYPE.ADMIN:c.edit===d("WAWebAck").EDIT_ATTR.SENDER_REVOKE&&(b.revokeType=d("WAWebWamEnumRevokeType").REVOKE_TYPE.SENDER);f=d("WAWebWamMsgUtils").getWamInvisibleMessageCatgoryType(c.category);f!=null&&(b.invisibleMessageCategory=f);if(c.offline!=null){e=parseInt(c.offline,10);Number.isNaN(e)||(b.offlineCount=e)}b.commit()}function l(a){k(a,d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.RECEIVED_WITH_OLD_COUNTER)}function m(a){k(a,d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.DUPLICATE_MESSAGE)}function n(a){k(a,d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.INVALID_PROTOBUF)}function o(a){k(a,d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.INVALID_STANZA)}function p(a){k(a,d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.EXPIRED)}function q(a){for(var b=0;b<a.length;b++){var c=a[b];c=d("WAWebDBMessageSerialization").messageFromDbRow(c);var e=new(d("WAWebIncomingMessageDropWamEvent").IncomingMessageDropWamEvent)({messageDropReason:d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.DB_OPERATION_FAILED,messageMediaType:d("WAWebWamMsgUtils").getWamMediaType(c)});c=d("WAWebMsgGetters").getFrom(c);c=d("WAWebBackendJobsCommon").getMetricE2eDestination(c);c!=null&&(e.e2eDestination=c);e.commit()}}g.postIncomingMessageDropInvalidStanza=a;g.postIncomingMessageDropUnknownMessageType=b;g.postIncomingMessageDropInternalError=e;g.postIncomingMessageDropDBOperationFailed=f;g.postIncomingMessageDropInvalidHostedCompanionStanza=j;g.postIncomingMessageDropOldCounter=l;g.postIncomingMessageDropDuplicateMessage=m;g.postIncomingMessageDropInvalidProtobuf=n;g.postIncomingMessageDropInvalidStanzaFromDecryptedMessageInfo=o;g.postIncomingMessageDropExpired=p;g.postIncomingMessageDropDBOperationFailedForMsgRows=q}),98);
__d("WAWebGetMessageCache",["WAWebMessageProcessorCache"],(function(a,b,c,d,e,f,g){var h=null;function a(){h==null&&(h=d("WAWebMessageProcessorCache").messageProcessorCache);return h}g.getMessageCache=a}),98);
__d("WAWebPushNotificationsGatingUtils",["WAWebABProps","WAWebUA","gkx"],(function(a,b,c,d,e,f,g){function a(){return h()&&d("WAWebABProps").getABPropConfigValue("web_push_notifications")}function h(){try{var a=d("WAWebUA").UA.isSafari&&Number(d("WAWebUA").UA.browserVersion.split(".")[0])<16;return c("gkx")("26262")&&!a}catch(a){return!1}}function b(){try{var a=d("WAWebUA").UA.isSafari||d("WAWebUA").UA.browser===d("WAWebUA").BROWSER_TYPE.FIREFOX||d("WAWebUA").UA.isChrome&&Number(d("WAWebUA").UA.browserVersion.split(".")[0])<80;return c("gkx")("26262")&&!a}catch(a){return!1}}function e(){return d("WAWebUA").UA.isSafari||d("WAWebUA").UA.isFirefox?!1:!0}g.canEnableOfflineNotifications=a;g.canSupportOfflineNotifications=h;g.canSupportPeriodicBackgroundSync=b;g.canSupportNotificationActions=e}),98);
__d("WAWebPushNotificationsOfflineBbApi",["WAWebPushNotificationsGatingUtils","WAWebUserPrefsNotifications"],(function(a,b,c,d,e,f,g){var h=10*1e3,i=!0,j=null;function a(){d("WAWebPushNotificationsGatingUtils").canSupportOfflineNotifications()&&(i=!1,j=self.performance.now())}function b(){d("WAWebPushNotificationsGatingUtils").canSupportOfflineNotifications()&&!i&&j!=null&&self.performance.now()-j>h&&d("WAWebUserPrefsNotifications").setOfflineNotificationsBBStatus({isLongResumeTime:!0})}g.setStartCommsT=a;g.setMainStreamModeReadyT=b}),98);
__d("WAWebOfflineResumeUtils",["Promise","WABackoffUtils","WALogger","WAPromiseDelays","WAPromiseLoop","WAWebABProps","WAWebClearDanglingReceipts","WAWebCmd","WAWebGetMessageCache","WAWebLogoutReasonConstants","WAWebMessageReceiptBatcher","WAWebNetworkStatus","WAWebOffdStorageUpdateOfflinePeerReceipts","WAWebOfflineDeviceCache","WAWebPageLoadLogging","WAWebPruneExpiredMessagesWithAddOns","WAWebPushNotificationsOfflineBbApi","WAWebSocketLogoutJob","WAWebWamOfflineResumeReporter","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] loadMainScreen complete"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] loadMainScreen: pruneExpiredMessages message failed with error: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] restoreDataFromStorage failed with error ","."]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] restoreDataFromStorage."]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][utils] runReceiptCleanUpLoop: Gave up clean up receipts "," tries"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][utils] runReceiptCleanUpLoop: failed with error ","."]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][utils] runReceiptCleanUpLoop: done."]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][utils] runReceiptCleanUpLoop: skip due to offline."]);p=function(){return a};return a}var q={MIN_MESSAGE:20,LIMIT_WITH_MESSAGE:50,MAX_STANZA:200};function a(){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WAWebGetMessageCache").getMessageCache().createSnapshot();d("WAWebOfflineDeviceCache").OfflinePendingDeviceCache.createSnapshot();var a=[d("WAWebGetMessageCache").getMessageCache().checkpointQueue.wait(),d("WAWebOfflineDeviceCache").OfflinePendingDeviceCache.checkpointQueue.wait()];a.push(d("WAWebMessageReceiptBatcher").receiptBatcher.runActiveBatches());yield (h||(h=b("Promise"))).all(a)});return r.apply(this,arguments)}function e(){if(d("WAWebABProps").getABPropConfigValue("web_enable_open_tab_pre_ack")&&!c("WAWebNetworkStatus").online){d("WALogger").LOG(p());return(h||(h=b("Promise"))).resolve()}return d("WAPromiseLoop").promiseLoop(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=d("WAPromiseDelays").delayMs(d("WABackoffUtils").expBackoff(c,12e4,1e3,.1));try{yield d("WAWebClearDanglingReceipts").clearDanglingReceipts();d("WALogger").LOG(o());return a()}catch(e){d("WALogger").LOG(n(),e);if(c>3){d("WALogger").WARN(m(),c);return a()}return b}});return function(b,c,d){return a.apply(this,arguments)}}())}function f(){var a;((a=window.location)==null?void 0:a.reload)&&window.location.reload()}function s(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WAWebPageLoadLogging").startPageLoadQplMeasure("restoreDataFromStorage");try{var c=a.shouldUpdateReceipts;c=c===void 0?!1:c;a=a.shouldRestoreChatsAndMsgs;var e=a===void 0?!0:a;d("WALogger").LOG(l());a=c?d("WAWebOffdStorageUpdateOfflinePeerReceipts").updatePeerReceipts():(h||(h=b("Promise"))).resolve();c=a.then(function(){return e?d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("restoreChatsAndMessages"):(h||(h=b("Promise"))).resolve()});a=d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("restoreGroupsAndContacts");var f=d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("restoreProfilePictures");yield (h||(h=b("Promise"))).all([c,a,f])}catch(a){d("WALogger").ERROR(k(),a).verbose().sendLogs("offline-resume-fatal-error",{sendLogsType:d("WALogger").SendLogsType.USER_FORCEFULLY_LOGGED_OUT_SAD}),void d("WAWebSocketLogoutJob").socketLogout(d("WAWebLogoutReasonConstants").LogoutReason.ClientFatalError)}d("WAWebPageLoadLogging").endPageLoadQplMeasure("restoreDataFromStorage")});return t.apply(this,arguments)}function u(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{yield d("WAWebPruneExpiredMessagesWithAddOns").pruneExpiredMessagesWithAddOns()}catch(a){d("WALogger").ERROR(j(),a);throw a}yield s(a);w();d("WAWebCmd").Cmd.readyForProcessOffline();d("WALogger").LOG(i())});return v.apply(this,arguments)}function w(){d("WAWebCmd").Cmd.readyForMainStreamMode(),d("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logMainScreenLoadT(),d("WAWebPushNotificationsOfflineBbApi").setMainStreamModeReadyT()}function x(a,b){return a+b>q.MAX_STANZA||a>q.MIN_MESSAGE&&a+b>q.LIMIT_WITH_MESSAGE}g.clearOfflineSnapShot=a;g.runReceiptCleanUpLoop=e;g.refreshWindow=f;g.loadMainScreen=u;g.exceedResumeWithOpenTabLimit=x}),98);
__d("WAWebPruneExpiredMessagesWithAddOns",["WALogger","WAWebBackendApi","WAWebDBEphemeralMessage","WAWebMsgKey","WAWebPageLoadLogging","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][utils] pruneExpiredMessagesWithAddOns: pruneExpiredMessages pruned "," msg(s)"]);h=function(){return a};return a}function a(){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WAWebPageLoadLogging").startPageLoadQplMeasure("pruneExpiredMessagesWithAddOns");var a=(yield d("WAWebDBEphemeralMessage").pruneExpiredMessages()),b=a.length;if(b>0){var e=[],f=new Set();a.forEach(function(a){a=a.id.toString();f.add(c("WAWebMsgKey").fromString(a).remote.toString());e.push(a)});a=Array.from(f.values()).join(",").toString();d("WAWebBackendApi").frontendFireAndForget("deleteModelsForLastAddOnPreview",{messagesIds:e});yield d("WAWebPersistedJobManager").getJobManager().waitUntilPersisted(d("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(a,e));d("WALogger").LOG(h(),b)}d("WAWebPageLoadLogging").endPageLoadQplMeasure("pruneExpiredMessagesWithAddOns")});return i.apply(this,arguments)}g.pruneExpiredMessagesWithAddOns=a}),98);
__d("WAWebHandleOrphansForNewMsg",["Promise","WAWebDBAssociatedMsgsAttachDetachAPI","WAWebDBProcessOrphansForNewMsg","WAWebMessageAssociationGatingUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=[d("WAWebDBProcessOrphansForNewMsg").processOrphansForNewMsg(a)];d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&c.push(d("WAWebDBAssociatedMsgsAttachDetachAPI").processOrphansFromAssociationsTableForNewMsg([a]));yield (h||(h=b("Promise"))).all(c)});return i.apply(this,arguments)}g.handleOrphansForNewMsg=a}),98);
__d("WAWebE2EProtoParserApi",["WABase64","WALogger","WAWebGroupType","WAWebMediaCryptoEligibilityUtils","WAWebProtobufsE2E.pb","WAWebWid","gkx"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["mediaKey is missing from msg type ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["url(deprecatedMms3Url) is missing from msg type ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["fileEncSha256 missing from msg type ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["directPath missing from msg type ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["directPath and fileEncSha256 missing from msg type ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["directPath missing from msg type ",""]);m=function(){return a};return a}function a(a){switch(a){case d("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$InviteLinkGroupType.PARENT:return d("WAWebGroupType").GroupType.COMMUNITY;case d("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$InviteLinkGroupType.SUB:return d("WAWebGroupType").GroupType.LINKED_SUBGROUP;case d("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$InviteLinkGroupType.DEFAULT_SUB:return d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP;default:return d("WAWebGroupType").GroupType.DEFAULT}}function b(a){return a!=null&&!a.includes("/u/")?a:void 0}function e(a){return a?d("WABase64").encodeB64(a):void 0}function f(a,b){if(!n(a,b))return;var c=a.type;if(!d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMsg(a)){b.directPath==null&&d("WALogger").LOG(m(),c).sendLogs(c+"-unencrypted-message-missing-direct-path");return}b.directPath==null&&b.fileEncSha256==null?d("WALogger").LOG(l(),c).sendLogs(c+"-message-missing-direct-path-and-file-enc"):b.directPath==null?d("WALogger").LOG(k(),c).sendLogs(c+"-message-missing-direct-path"):b.fileEncSha256==null&&d("WALogger").LOG(j(),c).sendLogs(c+"-message-missing-file-enc");b.url==null&&d("WALogger").LOG(i(),c).sendLogs(c+"-message-missing-mms3-url");b.mediaKey==null&&d("WALogger").LOG(h(),c).sendLogs(c+"-message-missing-media-key")}function n(a,b){var d;if(c("gkx")("26258")&&Math.random()>.001)return!1;if(!a.id)return!1;return((d=a.id.remote)==null?void 0:d.user)==="status"&&c("WAWebWid").isPSA(a.author)&&b.staticUrl==null?!1:!0}g.parseInviteGrpType=a;g.decodeUrl=b;g.decodeBytes=e;g.validateRequiredMediaProperties=f;g.shouldLogE2eProtoValidation=n}),98);
__d("WAWebSendMsgCommonApi",["WADeprecatedWapParser","WAJids","WALogger","WAWap","WAWebABProps","WAWebAck","WAWebAddonRetryRequestUtils","WAWebDeviceListPk","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebReactionsBEUtils","WAWebSchemaMessage","WAWebSendMsgTypes","WAWebSignalCommonUtils","WAWebSignalProtocolStore","WAWebVerifyProtobufMsgObjectKeys","WAWebWidFactory","asyncToGeneratorRuntime","encodeProtobuf","err"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["filterDeviceWithChangedIdentity: cannot determine rowId for message: ",", type: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["filterDeviceWithChangedIdentity: message not found: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["filterDeviceWithChangedIdentity: addon not found: ",""]);j=function(){return a};return a}var k=5;function a(){return(d("WAWebABProps").getABPropConfigValue("web_e2e_backfill_expire_time")||k)*60}function e(a){a=d("encodeProtobuf").encodeProtobuf(d("WAWebProtobufsE2E.pb").MessageSpec,a);d("WAWebSignalCommonUtils").writeRandomPadMax16(a);return a.readByteArray()}function l(a){return a.protocolMessage!=null&&a.protocolMessage.type===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REVOKE}function m(a){return a.reactionMessage!=null&&a.reactionMessage.text===d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT}function n(a){var b;b=(b=(b=a.protocolMessage)==null?void 0:b.type)!=null?b:(b=a.editedMessage)==null?void 0:(b=b.message)==null?void 0:(b=b.protocolMessage)==null?void 0:b.type;return b===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.MESSAGE_EDIT||((b=a.secretEncryptedMessage)==null?void 0:b.secretEncType)===d("WAWebProtobufsE2E.pb").Message$SecretEncryptedMessage$SecretEncType.EVENT_EDIT}function o(a){return a.pinInChatMessage!=null}function p(a){return a.keepInChatMessage!=null&&a.keepInChatMessage.key!=null&&a.keepInChatMessage.key.fromMe===!0&&a.keepInChatMessage.keepType===d("WAWebProtobufsE2E.pb").KeepType.UNDO_KEEP_FOR_ALL}function q(a,b){var c,e=d("WAWebVerifyProtobufMsgObjectKeys").getProtobufMessageTypesSet(a);c=(c=d("WAWebVerifyProtobufMsgObjectKeys").getUnwrappedProtobufMessage(a))!=null?c:a;if(e.has(d("WAWebMsgType").MSG_TYPE.PROTOCOL)){a=(a=c.protocolMessage)==null?void 0:a.type;if(a===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REVOKE){b=b==="admin_revoke"?d("WAWebAck").EDIT_ATTR.ADMIN_REVOKE:d("WAWebAck").EDIT_ATTR.SENDER_REVOKE;return d("WAWap").CUSTOM_STRING(String(b))}else if(a===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.MESSAGE_EDIT)return d("WAWap").CUSTOM_STRING(String(d("WAWebAck").EDIT_ATTR.MESSAGE_EDIT))}else if(e.has(d("WAWebMsgType").MSG_TYPE.EVENT_EDIT_ENCRYPTED))return d("WAWap").CUSTOM_STRING(String(d("WAWebAck").EDIT_ATTR.MESSAGE_EDIT));else if(e.has(d("WAWebMsgType").MSG_TYPE.REACTION)){if(((b=c.reactionMessage)==null?void 0:b.text)===d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT)return d("WAWap").CUSTOM_STRING(String(d("WAWebAck").EDIT_ATTR.SENDER_REVOKE))}else if(e.has(d("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT)){if(p(c))return d("WAWap").CUSTOM_STRING(String(d("WAWebAck").EDIT_ATTR.SENDER_REVOKE))}else if(e.has(d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE))return d("WAWap").CUSTOM_STRING(String(d("WAWebAck").EDIT_ATTR.PIN_IN_CHAT));return d("WAWap").DROP_ATTR}function f(a,b){if(d("WAWebABProps").getABPropConfigValue("web_unwrap_message_for_stanza_attributes"))return q(a,b);if(l(a)){b=b==="admin_revoke"?d("WAWebAck").EDIT_ATTR.ADMIN_REVOKE:d("WAWebAck").EDIT_ATTR.SENDER_REVOKE;return d("WAWap").CUSTOM_STRING(String(b))}else if(m(a))return d("WAWap").CUSTOM_STRING(String(d("WAWebAck").EDIT_ATTR.SENDER_REVOKE));else if(p(a))return d("WAWap").CUSTOM_STRING(String(d("WAWebAck").EDIT_ATTR.SENDER_REVOKE));else if(n(a))return d("WAWap").CUSTOM_STRING(String(d("WAWebAck").EDIT_ATTR.MESSAGE_EDIT));else if(o(a))return d("WAWap").CUSTOM_STRING(String(d("WAWebAck").EDIT_ATTR.PIN_IN_CHAT));return d("WAWap").DROP_ATTR}var r=new(c("WADeprecatedWapParser"))("sendMsgAckSyncParser",function(a){a.assertTag("ack");return{t:a.attrTime("t"),sync:a.hasAttr("sync")?a.attrString("sync"):null,phash:a.hasAttr("phash")?a.attrString("phash"):null,addressingMode:a.hasAttr("addressing_mode")?a.attrString("addressing_mode"):null,count:a.hasAttr("count")?a.attrInt("count"):null,error:a.hasAttr("error")?a.attrInt("error"):null}});function s(a){return a.device==null||a.device===d("WAJids").DEFAULT_DEVICE_ID}function t(a,b){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=a.data.id;if(a.type===d("WAWebSendMsgTypes").SendMessageRecordType.Addon){var e=(yield d("WAWebAddonRetryRequestUtils").hasSentAddonMsg(c));if(e!=null)return d("WAWebSignalProtocolStore").getPersistSignalProtocolStore().updateIdentityRangeAfterEncryption("sentAddonRowId",e.rowId,b.map(function(a){return d("WAWebSignalCommonUtils").createSignalAddressForIdentityTable(a).toString()}))}else if(a.type===d("WAWebSendMsgTypes").SendMessageRecordType.Message){e=(yield d("WAWebSchemaMessage").getMessageTable().get(String(c),!1));a=e==null?void 0:e.rowId;if(a!=null)return d("WAWebSignalProtocolStore").getPersistSignalProtocolStore().updateIdentityRangeAfterEncryption("rowId",a,b.map(function(a){return d("WAWebSignalCommonUtils").createSignalAddressForIdentityTable(a).toString()}))}});return u.apply(this,arguments)}function v(a){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.data.id;if(a.type===d("WAWebSendMsgTypes").SendMessageRecordType.Addon){var c=(yield d("WAWebAddonRetryRequestUtils").hasSentAddonMsg(b));c||d("WALogger").WARN(j(),b);return c==null?void 0:c.rowId}else if(a.type===d("WAWebSendMsgTypes").SendMessageRecordType.Message){c=(yield d("WAWebSchemaMessage").getMessageTable().get(String(b),!1));c||d("WALogger").WARN(i(),b);return c==null?void 0:c.rowId}});return w.apply(this,arguments)}function x(a,b){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=(yield v(a));if(e==null){d("WALogger").WARN(h(),a.data.id,a.data.type);throw c("err")("filterDeviceWithChangedIdentity: cannot determine message rowId")}var f=new Map();b.forEach(function(a){f.set(d("WAWebDeviceListPk").createDeviceListPK(a),a)});var g=Array.from(f.values()).map(function(a){return d("WAWebWidFactory").createDeviceWidFromUserAndDevice(a.user,a.server,d("WAJids").DEFAULT_DEVICE_ID)}),i=(yield d("WAWebSignalProtocolStore").getPersistSignalProtocolStore().bulkGetIdentityWithRowId(g.map(function(a){return d("WAWebSignalCommonUtils").createSignalAddressForIdentityTable(a)}))),j=new Set();i.forEach(function(b,c){b=a.type===d("WAWebSendMsgTypes").SendMessageRecordType.Addon?b==null?void 0:b.sentAddonRowId:b==null?void 0:b.rowId;c=g[c];(b==null||b>e)&&j.add(d("WAWebDeviceListPk").createDeviceListPK(c))});return b.filter(function(a){return!j.has(d("WAWebDeviceListPk").createDeviceListPK(a))})});return y.apply(this,arguments)}g.getResendTimeoutInSeconds=a;g.encodeAndPad=e;g.isRevokeMsg=l;g.isEditMsg=n;g.editAttribute=f;g.sendMsgAckSyncParser=r;g.isPrimaryDevice=s;g.updateIdentityRange=t;g.filterDeviceWithChangedIdentity=x}),98);
__d("WAWebSignal",["WAWebSignalCipherApi","WAWebSignalSessionApi"],(function(a,b,c,d,e,f,g){g.Cipher=d("WAWebSignalCipherApi"),g.Session=d("WAWebSignalSessionApi")}),98);
__d("WAWebSignalCipherApi",["Promise","WAWebCryptoLibrary","WAWebSignalCommonErrors","asyncToGeneratorRuntime","cr:4533","gkx"],(function(a,b,c,d,e,f,g){var h;function a(a,b,c,d){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){if(!c("gkx")("26258")){var i=b("cr:4533")==null?void 0:b("cr:4533").getDebugDecryptFail();if(i!=null&&i>0){b("cr:4533")==null?void 0:b("cr:4533").setDebugDecryptFail(i-1);return(h||(h=b("Promise"))).reject(new(d("WAWebSignalCommonErrors").SignalDecryptionError)())}}return d("WAWebCryptoLibrary").decryptSignalProto(a,e,f,g)});return i.apply(this,arguments)}function e(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){return d("WAWebCryptoLibrary").encryptSignalProto(a,b,c)});return j.apply(this,arguments)}function f(a,b,c,d){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){return d("WAWebCryptoLibrary").decryptGroupSignalProto(a,b,c,e)});return k.apply(this,arguments)}function l(a,b,c,d){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){return d("WAWebCryptoLibrary").encryptSenderKeyMsgSignalProto(a,b,c,e)});return m.apply(this,arguments)}g.decryptSignalProto=a;g.encryptSignalProto=e;g.decryptGroupSignalProto=f;g.encryptSenderKeyMsgSignalProto=l}),98);
__d("WAWebCryptoLibrarySignalGroupUtilsApi",[],(function(a,b,c,d,e,f){var g="v1";function a(a,b,c,d){return{signatureKey:a,chainKey:b,keyId:c,messageKeys:d==null?[]:d}}function b(a){return{sessions:a,version:g}}function c(a){return a}function d(a,b){return{counter:a,key:b}}function e(a,b){return b!=null?{pubKey:a,privKey:b}:a}f.makeLibsignalSenderKeyState=a;f.makeNewLibsignalSenderKeySession=b;f.makeLibsignalSenderKeyMsgKey=c;f.makeLibsignalSenderKeyChainKey=d;f.makeLibsignalSenderKeySignatureKey=e}),66);
__d("WAWebCryptoLibrarySenderkeySessionConversionApi",["invariant","WAByteArray","WAPromiseReduce","WASignalGroupSession","WASignalOther","WAWebCryptoLibrarySignalGroupUtilsApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.sessions;a=(yield d("WAPromiseReduce").promiseReduce(a,function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c=(yield j(b));return a==null?d("WASignalGroupSession").makeNewSenderKeySession(c):d("WASignalGroupSession").updateSessionWithNewSenderKeyState(a,c)});return function(b,c,d){return a.apply(this,arguments)}}(),null));a!=null||h(0,72944);return a});return i.apply(this,arguments)}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.signatureKey.pubKey!==void 0?new Uint8Array(a.signatureKey.pubKey):new Uint8Array(a.signatureKey),c=a.signatureKey.privKey?d("WASignalOther").ensureSize(new Uint8Array(a.signatureKey.privKey),32):void 0,e=d("WASignalGroupSession").makeSenderKeyChainKey(a.chainKey.counter,d("WASignalOther").ensureSize(new Uint8Array(a.chainKey.key),32)),f=a.keyId,g=[],h=function*(b){if(a.messageKeys[b]){var c=a.messageKeys[b];c=(yield d("WASignalOther").hkdf(new Uint8Array(c),null,"WhisperGroup",50).then(function(a){return d("WASignalGroupSession").makeSenderKeyMsgKey(b,a)}));g.push(c)}};for(var i=0;i<a.messageKeys.length;i++)yield* h(i);h=g;i=d("WASignalGroupSession").makeSenderKeyState(b,c,e,f,h);return i});return k.apply(this,arguments)}function l(a){var b=[],c=d("WAWebCryptoLibrarySignalGroupUtilsApi").makeLibsignalSenderKeyChainKey(a.senderKeyChainKey.nextMsgIndex,d("WAByteArray").uint8ArrayToBuffer(a.senderKeyChainKey.chainKey)),e=a.senderKeyId,f=a.senderSigningKeyPrivate;f=f!=null?d("WAWebCryptoLibrarySignalGroupUtilsApi").makeLibsignalSenderKeySignatureKey(d("WAByteArray").uint8ArrayToBuffer(a.senderSigningKeyPublic),d("WAByteArray").uint8ArrayToBuffer(f)):d("WAWebCryptoLibrarySignalGroupUtilsApi").makeLibsignalSenderKeySignatureKey(d("WAByteArray").uint8ArrayToBuffer(a.senderSigningKeyPublic));a=d("WAWebCryptoLibrarySignalGroupUtilsApi").makeLibsignalSenderKeyState(f,c,e,b);return a}function c(a){a=a.senderKeyStates;a=a.map(function(a){return l(a)});return d("WAWebCryptoLibrarySignalGroupUtilsApi").makeNewLibsignalSenderKeySession(a)}g.toCryptoManagerSenderKeySession=a;g.toSignalSenderKeySession=c}),98);
__d("WAWebCryptoLibrarySessionConversionApi",["WAArrayBufferUtils","WALogger","WASignalKeys","WASignalOther","WASignalSessions","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["toCryptoManagerSession: "," "]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["toLibsignalSession: prevSendChainHighestIndex: ",", sendChainCounter: ",""]);i=function(){return a};return a}function a(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=m(a);c=(yield k(c,b));var e=[];for(var f in a.sessions)if(a.sessions[f].indexInfo.closed!==-1){var g=(yield k(a.sessions[f],b));g=d("WASignalSessions").detachSession(g);e.push(g)}return d("WASignalSessions").setPrevSessions(c,e)});return j.apply(this,arguments)}function k(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{var c=[];if(a.currentRatchet.lastRemoteEphemeralKey){var e=a[d("WAArrayBufferUtils").arrayBufferToString(a.currentRatchet.lastRemoteEphemeralKey)];if(e){var f=[],g=function*(a){var b=e.messageKeys[a];b=(yield d("WASignalOther").hkdf(new Uint8Array(b),null,"WhisperMessageKeys",80).then(function(b){return d("WASignalSessions").splitMsgKey(a,b)}));f.push(b)};for(var j=0;j<e.messageKeys.length;j++)yield* g(j);g=a.currentRatchet.lastRemoteEphemeralKey;j=e.chainKey.key;if(g!=null&&j!=null){g=d("WASignalSessions").makeRecvChain(d("WASignalKeys").castToSerializedPubKey(new Uint8Array(g)),e.chainKey.counter+1,d("WASignalOther").toBytes(j,32),f);c.push(g)}}}j=a[d("WAArrayBufferUtils").arrayBufferToString(a.currentRatchet.ephemeralKeyPair.pubKey)];g=d("WASignalKeys").castToSerializedPubKey(new Uint8Array(a.currentRatchet.ephemeralKeyPair.pubKey));var k=j.chainKey.key,l=d("WASignalOther").toBytes(a.currentRatchet.ephemeralKeyPair.privKey,32);l=d("WASignalKeys").makeSerializedKeyPairFrom(l,g);g=d("WASignalSessions").makeSendChain(l,j.chainKey.counter+1,d("WASignalOther").toBytes(k,32));l=b&&{regId:b.registrationId,pubKey:d("WASignalKeys").serializeIdentity(new Uint8Array(b.identityKeyPair.pubKey))};j=b&&{regId:a.registrationId,pubKey:new Uint8Array(a.indexInfo.remoteIdentityKey)};k=a.indexInfo.baseKey&&d("WASignalKeys").castToSerializedPubKey(new Uint8Array(a.indexInfo.baseKey));b=a.currentRatchet.previousCounter;b===-1&&d("WALogger").DEV(i(),b,g.nextMsgIndex);var m=d("WASignalOther").toBytes(a.currentRatchet.rootKey,32),n;a.pendingPreKey!=null&&(n=d("WASignalSessions").makeInitialExchangeInfo(a.pendingPreKey.preKeyId,a.pendingPreKey.signedKeyId,d("WASignalKeys").castToSerializedPubKey(new Uint8Array(a.pendingPreKey.baseKey))));a=[];l=d("WASignalSessions").makeSession(l,j,m,c,g,n,Math.max(b,0),a,k);return l}catch(a){d("WALogger").DEV(h(),a);throw a}});return l.apply(this,arguments)}function m(a){a=a.sessions;for(var b in a)if(a[b].indexInfo.closed===-1)return a[b];throw c("err")("getOpenSession: There are no open session")}g.toCryptoLibrarySessionPrevSessions=a;g.toCryptoManagerSession=k}),98);
__d("WAWebSignalConvertApi",["Promise","WALogger","WAWebCryptoCurve25519","WAWebCryptoLibrarySenderkeySessionConversionApi","WAWebCryptoLibrarySessionConversionApi","WAWebSignalProtocolStore","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["maybeConvertSession: failed with error ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["maybeConvertSession: converting to crypto library"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["maybeConvertSenderKey: failed with error ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["maybeConvertSenderKey: converting to crypto library"]);l=function(){return a};return a}function m(a){return a.sessions!=null}function a(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{if(a==null||!m(a))return a;var e=(yield (h||(h=b("Promise"))).all([d("WAWebSignalProtocolStore").getSignalProtocolStore().getIdentityKeyPair(),d("WAWebSignalProtocolStore").getSignalProtocolStore().getLocalRegistrationId()])),f=e[0];e=e[1];if(!f||e==null)throw c("err")("Attempted to loadSession without registration info");f={identityKeyPair:d("WAWebCryptoCurve25519").toCurveKeyPair(f),registrationId:e};d("WALogger").LOG(j()).sendLogs("libsignal-to-cryptolib-session",{sampling:0});return d("WAWebCryptoLibrarySessionConversionApi").toCryptoLibrarySessionPrevSessions(a,f)}catch(a){d("WALogger").ERROR(i(),a).sendLogs("session-convert-error");throw a}});return n.apply(this,arguments)}function o(a){return a.sessions!=null}function e(a){try{if(a==null||!o(a))return a;d("WALogger").LOG(l()).sendLogs("libsignal-to-cryptolib-senderkey",{sampling:0});return d("WAWebCryptoLibrarySenderkeySessionConversionApi").toCryptoManagerSenderKeySession(a)}catch(a){d("WALogger").ERROR(k(),a).sendLogs("senderkey-convert-error");throw a}}g.shouldConvertSession=m;g.maybeConvertSession=a;g.maybeConvertSenderKey=e}),98);
__d("WAWebSignalKeyApi",["WAWebCryptoCurve25519","WAWebCryptoLibraryUtilsApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=c("WAWebCryptoLibraryUtilsApi").makePreKey(a);var b=a.preKeyId,d=a.privKey;a=a.pubKey;d={privKey:d,pubKey:a};return{keyId:b,keyPair:d,isDirectDistribution:0}});return h.apply(this,arguments)}function e(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=c("WAWebCryptoLibraryUtilsApi").makeSignedPreKey(d("WAWebCryptoCurve25519").toCurveKeyPair(a),b);b=a.preKeyId;var e=a.privKey,f=a.pubKey;a=a.signature;e={privKey:e,pubKey:f};return{keyId:b,keyPair:d("WAWebCryptoCurve25519").toCurveKeyPair(e),signature:a}});return i.apply(this,arguments)}function f(){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return c("WAWebCryptoLibraryUtilsApi").makeKeyPair()});return j.apply(this,arguments)}g.generatePreKeyPair=a;g.generateSignedKeyPair=e;g.generateIdentityKeyPair=f}),98);
__d("WAWebSignalSessionApi",["Promise","WABinary","WAJids","WALogger","WAWebAdvSignatureApi","WAWebApiContact","WAWebCryptoCurve25519","WAWebCryptoLibrary","WAWebCryptoLibraryDbCallbacksApi","WAWebCryptoLibrarySessionApi","WAWebCryptoLibraryUtilsApi","WAWebSignalCommonUtils","WAWebSignalProtocolStore","WAWebSignalStoreApi","WAWebWidFactory","asyncToGeneratorRuntime","err","gkx"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["hasSameBaseKey: MsgId: ",", savedBaseKey and sessionBaseKey is same"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["hasSameBaseKey: MsgId: ",", savedBaseKey and sessionBaseKey is different "]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["hasSameBaseKey: MsgId: ",", no session has been saved locally "]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["hasSameBaseKey: MsgId: ",", no base key has been saved locally "]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["saveSessionBaseKey: for ",", no basekey provided"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Signal::createSignalSession with ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["Signal::createSignalSession"]);r=function(){return a};return a}function a(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=a.wid,f=a.identity,g=a.deviceIdentity;c("gkx")("26258")?d("WALogger").LOG(r()):d("WALogger").LOG(q(),e.toString({legacy:!0}));if(e.device!=null&&e.device!==d("WAJids").DEFAULT_DEVICE_ID){if(!g)throw c("err")("Signal::createSignalSession: expected device-identity in keyBundle for companion device");g=(yield d("WAWebAdvSignatureApi").validateADVwithIdentityKey(e,g,f));if(!g)throw c("err")("Signal::createSignalSession: invalid identityKey fetched")}var h,i,j;try{h=d("WAWebCryptoCurve25519").toSignalCurvePubKey(new(d("WABinary").Binary)(a.identity).readBuffer())}catch(a){d("WALogger").ERROR(p()).sendLogs("Signal::createSignalSession: invalid identityKey fetched");throw a}try{i=d("WAWebCryptoCurve25519").toSignalCurvePubKey(new(d("WABinary").Binary)(a.skey.pubkey).readBuffer())}catch(a){d("WALogger").ERROR(o()).sendLogs("Signal::createSignalSession: invalid signedPreKey fetched");throw a}if(a.key)try{j=d("WAWebCryptoCurve25519").toSignalCurvePubKey(new(d("WABinary").Binary)(a.key.pubkey).readBuffer())}catch(a){d("WALogger").ERROR(n()).sendLogs("Signal::createSignalSession: invalid preKey fetched")}f={registrationId:a.regId,identityKey:h,signedPreKey:{keyId:a.skey.id,publicKey:i,signature:new(d("WABinary").Binary)(a.skey.signature).readBuffer()}};a.key&&j&&(f.preKey={keyId:a.key.id,publicKey:j});return d("WAWebCryptoLibrarySessionApi").createSignalSession(f,e,b)});return s.apply(this,arguments)}function e(a,b){d("WAWebApiContact").checkPnToLidMapping(a,d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_SIGNAL_SESSION_HAS_SIGNAL_SESSIONS);return d("WAWebSignalProtocolStore").getPersistSignalProtocolStore().containSessions(a.map(function(a){return d("WAWebSignalCommonUtils").createSignalAddress(a,b).toString()}))}function f(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebCryptoLibrarySessionApi").getRemoteRegId(a)});return t.apply(this,arguments)}function u(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WAWebApiContact").checkPnToLidMapping([a],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_SIGNAL_SESSION_DELETE_REMOTE_INFO);var c=d("WAWebSignalCommonUtils").createSignalAddress(a,a.isLid()).toString();a=d("WAWebSignalCommonUtils").createSignalAddressForIdentityTable(a).toString();yield (h||(h=b("Promise"))).all([d("WAWebSignalProtocolStore").getSignalProtocolStore().removeIdentity(a),d("WAWebSignalProtocolStore").getSignalProtocolStore().removeSession(c)])});return v.apply(this,arguments)}function w(a){d("WAWebApiContact").checkPnToLidMapping([a],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_SIGNAL_SESSION_DELETE_REMOTE_SESSION);a=d("WAWebSignalCommonUtils").createSignalAddress(a).toString();return d("WAWebSignalProtocolStore").getSignalProtocolStore().removeSession(a)}function x(a){a=d("WAWebSignalCommonUtils").createSignalAddress(a).toString();return d("WAWebSignalProtocolStore").getPersistSignalProtocolStore().maybeCleanUpUnconvertedSession(a)}function y(a,b){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b===void 0&&(b=!1);var e=d("WAWebCryptoLibraryDbCallbacksApi").getCryptoDbCallbacks();a=d("WAJids").unsafeCoerceToDeviceJid(a.toJid());a=(yield c("WAWebCryptoLibraryUtilsApi").getSessionAliceBaseKey(a,b?e.loadSessionDeprecatedLid:e.loadSession));return a.success===!0?a.value:null});return z.apply(this,arguments)}function A(a,b,c){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c===void 0&&(c=!1);d("WAWebApiContact").checkPnToLidMapping([a],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_SIGNAL_SESSION_SAVE_SESSION_BASE_KEY);var e=d("WAWebSignalCommonUtils").createSignalAddress(a,c);a=(yield y(a,c));!a?d("WALogger").LOG(m(),b):yield d("WAWebSignalStoreApi").waSignalStore.saveBaseKey(e.toString(),b,a)});return B.apply(this,arguments)}function C(a,b,c){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){e===void 0&&(e=!1);d("WAWebApiContact").checkPnToLidMapping([a],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_SIGNAL_SESSION_HAS_SAME_BASE_KEY);var f=d("WAWebSignalCommonUtils").createSignalAddress(a,e);a=(yield (h||(h=b("Promise"))).all([y(a,e),d("WAWebSignalStoreApi").waSignalStore.loadBaseKey(f.toString(),c)]));e=a[0];f=a[1];if(!f){d("WALogger").LOG(l(),c);return!1}if(!e){d("WALogger").LOG(k(),c);return!1}if(!d("WAWebSignalCommonUtils").bufferEqual(f,e)){d("WALogger").LOG(j(),c);return!1}d("WALogger").LOG(i(),c);return!0});return D.apply(this,arguments)}function E(a,b,c,d){return F.apply(this,arguments)}function F(){F=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){return d("WAWebCryptoLibrarySessionApi").createGroupSenderSignalSession(d("WAWebWidFactory").createWid(b),a,c,e)});return F.apply(this,arguments)}function G(a,b,c){return H.apply(this,arguments)}function H(){H=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){return d("WAWebCryptoLibrary").getGroupSenderKeyInfo(a,b,c)});return H.apply(this,arguments)}function I(a,b,c){c===void 0&&(c=!1);d("WAWebApiContact").checkPnToLidMapping([b],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_SIGNAL_SESSION_DELETE_GROUP_SENDER_KEY_INFO);b=d("WAWebSignalCommonUtils").createSignalAddress(b,c);c=a.toString({legacy:!0})+"::"+b.toString();return d("WAWebSignalStoreApi").waSignalStore.removeSenderKey(c)}function J(a,b){b===void 0&&(b=!1);d("WAWebApiContact").checkPnToLidMapping([a],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_SIGNAL_SESSION_DELETE_DEVICE_SENDER_KEY);a=String(d("WAWebSignalCommonUtils").createSignalAddress(a,b));return d("WAWebSignalStoreApi").waSignalStore.removeSenderKeyBySenderId(a)}g.createSignalSession=a;g.hasSignalSessions=e;g.getRemoteRegId=f;g.deleteRemoteInfo=u;g.deleteRemoteSession=w;g.maybeDeleteUnconvertedSession=x;g.saveSessionBaseKey=A;g.hasSameBaseKey=C;g.createGroupSignalSession=E;g.getGroupSenderKeyInfo=G;g.deleteGroupSenderKeyInfo=I;g.deleteDeviceSenderKey=J}),98);
__d("WAWebSignalUtilsApi",["WAWap","WAWebCryptoCurve25519","WAWebCryptoLibraryUtilsApi"],(function(a,b,c,d,e,f,g){function a(a){var b;return(b=d("WAWap")).wap("skey",null,b.wap("id",null,b.BIG_ENDIAN_CONTENT(a.keyId,3)),b.wap("value",null,a.keyPair.pubKey),b.wap("signature",null,a.signature))}function b(a){var b;return(b=d("WAWap")).wap("key",null,b.wap("id",null,b.BIG_ENDIAN_CONTENT(a.keyId,3)),b.wap("value",null,a.keyPair.pubKey))}function e(a){a=c("WAWebCryptoLibraryUtilsApi").extractIdentityKey(a);return a.success===!0?d("WAWebCryptoCurve25519").toCurveKeyPubKey(a.value):null}g.xmppSignedPreKey=a;g.xmppPreKey=b;g.extractIdentityKey=e}),98);
__d("WAWebCryptoLibrary",["Promise","WAByteArray","WACryptoLibrary","WAJids","WALogger","WASignalKeys","WAWebBackendJobs.flow","WAWebCryptoLibraryDbCallbacksApi","WAWebCryptoLibraryUtilsApi","WAWebSignalCommonErrors","WAWebWidToJid","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::getGroupSenderKeyInfo failed with error ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::getGroupSenderKeyInfo"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::encryptGroupMessage failed with error ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::encryptGroupMessage no sender key, generating a new one"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::decryptSignalProto failed to decrypt: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::decryptMessage failed with error ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::decryptSignalProto"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::createSignalSession failed with error ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::createSignalSession"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::decryptGroupSignalProto failed to decrypt: ",""]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::decryptGroupMessage failed ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::decryptGroupSignalProto"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::processSenderKeyDistributionMsg failed with error ",""]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::processSenderKeyDistributionMsg"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::encryptSignalProto:failed with error ",""]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::encryptSignalProto"]);x=function(){return a};return a}var y=d("WAWebCryptoLibraryDbCallbacksApi").getCryptoDbCallbacks();function z(){var a;return{establishOutgoingSession:(a=d("WACryptoLibrary")).establishOutgoingSession,decryptContent:a.decryptContent,encryptContent:a.encryptContent,encryptGroupContent:a.encryptGroupContent,decryptGroupContent:a.decryptGroupContent,saveSenderKeySession:a.saveSenderKeySession,rotateGroupSenderKey:a.rotateGroupSenderKey}}function a(a,b,c){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){d("WALogger").LOG(q());var f=(yield y.getRegistrationInfo());if(!f)throw c("err")("No registration info found");return z().establishOutgoingSession({handleNewSession:e?y.handleNewSessionDeprecatedLid:y.handleNewSession},f,d("WAWebWidToJid").widToDeviceJid(a),b,void 0).then(function(a){if(!a.success){d("WALogger").WARN(p(),a.error);throw c("err")(a.error)}})});return A.apply(this,arguments)}function e(a,b,c,d){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){d("WALogger").LOG(o());e=e===d("WAWebBackendJobs.flow").CiphertextType.Pkmsg?"pkmsg":"msg";var i,j=(yield y.getRegistrationInfo());return!j?(h||(h=b("Promise"))).reject(c("err")("No registration info found")):z().decryptContent({handleNewSession:g?y.handleNewSessionDeprecatedLid:y.handleNewSession,loadOneTimePreKey:y.loadOneTimePreKey,loadSession:g?y.loadSessionDeprecatedLid:y.loadSession,loadSignedPreKey:y.loadSignedPreKey},j,d("WAWebWidToJid").widToDeviceJid(a),{ciphertext:f,type:e},function(a){i=d("WAByteArray").uint8ArrayToBuffer(a);return(h||(h=b("Promise"))).resolve()}).then(function(a){if(a.success){if(i==null)throw new(d("WAWebSignalCommonErrors").SignalDecryptionError)("Null result on successful decryption");return i}a=a.error;d("WALogger").WARN(n(),a);if(a==="errDuplicateMsg")throw new(d("WAWebSignalCommonErrors").SignalMessageCounterError)(a);else throw new(d("WAWebSignalCommonErrors").SignalDecryptionError)(a)})["catch"](function(a){if(a instanceof d("WAWebSignalCommonErrors").SignalDecryptionError||a instanceof d("WAWebSignalCommonErrors").SignalMessageCounterError)throw a;d("WALogger").ERROR(m(),a.stack);throw new(d("WAWebSignalCommonErrors").SignalDecryptionError)("Unexpected decryption error")})});return B.apply(this,arguments)}function f(a,b,e){d("WALogger").LOG(x());return z().encryptContent({handleNewSession:e?y.handleNewSessionDeprecatedLid:y.handleNewSession,loadSession:e?y.loadSessionDeprecatedLid:y.loadSession},d("WAWebWidToJid").widToDeviceJid(a),b,null).then(function(a){if(a.success){var b=a.value,e=b.type;b=b.ciphertext;return{type:(e=d("WAWebBackendJobs.flow").CiphertextType.cast(e))!=null?e:d("WAWebBackendJobs.flow").CiphertextType.Msg,ciphertext:d("WAByteArray").uint8ArrayToBuffer(b)}}d("WALogger").WARN(w(),a.error);throw c("err")(a.error)})}function C(a,b){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WAWebWidToJid").widToDeviceJid(a);b=b?yield y.loadSessionDeprecatedLid(a):yield y.loadSession(a);return b==null?void 0:b.remote});return D.apply(this,arguments)}function E(a,b,c,d){return F.apply(this,arguments)}function F(){F=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f){var g;a=d("WAWebWidToJid").widToMulticastJid(a);g=(g=d("WAJids").validateGroupJid(a))!=null?g:d("WAJids").validateStatusJid(a);if(g==null)throw c("err")("Broadcast JIDs are not supported by WACryptoManager yet.");a=d("WAWebWidToJid").widToDeviceJid(b);b=(yield z().encryptGroupContent({loadSenderKeySession:f?y.loadSenderKeySessionDeprecatedLid:y.loadSenderKeySession,saveSenderKeySession:f?y.saveSenderKeySessionDeprecatedLid:y.saveSenderKeySession},g,a,e));if(!b.success&&b.error==="errLoadSenderKeySession"){b.error;d("WALogger").LOG(l());var h=(yield d("WASignalKeys").makeKeyPair());yield z().rotateGroupSenderKey({saveSenderKeySession:f?y.saveSenderKeySessionDeprecatedLid:y.saveSenderKeySession},g,a,h);b=(yield z().encryptGroupContent({loadSenderKeySession:f?y.loadSenderKeySessionDeprecatedLid:y.loadSenderKeySession,saveSenderKeySession:f?y.saveSenderKeySessionDeprecatedLid:y.saveSenderKeySession},g,a,e))}if(b.success){h=b.value.ciphertext.ciphertext;f=b.value.senderKeyDistributionProto;return{ciphertext:d("WAByteArray").uint8ArrayToBuffer(h),senderKeyBytes:d("WAByteArray").uint8ArrayToBuffer(f)}}d("WALogger").WARN(k(),b.error);throw c("err")(b.error)});return F.apply(this,arguments)}function G(a,b,e,f){d("WALogger").LOG(v());return z().saveSenderKeySession({loadSenderKeySession:f?y.loadSenderKeySessionDeprecatedLid:y.loadSenderKeySession,saveSenderKeySession:f?y.saveSenderKeySessionDeprecatedLid:y.saveSenderKeySession},a,d("WAWebWidToJid").widToDeviceJid(b),new Uint8Array(e)).then(function(a){if(!a.success){d("WALogger").WARN(u(),a.error);throw c("err")(a.error)}})}function H(a,c,e,f){d("WALogger").LOG(t());var g=null;return z().decryptGroupContent({loadSenderKeySession:f?y.loadSenderKeySessionDeprecatedLid:y.loadSenderKeySession,saveSenderKeySession:f?y.saveSenderKeySessionDeprecatedLid:y.saveSenderKeySession},d("WAWebWidToJid").widToMulticastJid(a),d("WAWebWidToJid").widToDeviceJid(c),e,function(a){g=d("WAByteArray").uint8ArrayToBuffer(a);return(h||(h=b("Promise"))).resolve()}).then(function(a){if(a.success){if(g==null)throw new(d("WAWebSignalCommonErrors").SignalDecryptionError)("Null result on successful decryption of group msg");return g}a=a.error;d("WALogger").WARN(s(),a);if(a==="errDuplicateMsg")throw new(d("WAWebSignalCommonErrors").SignalMessageCounterError)(a);else throw new(d("WAWebSignalCommonErrors").SignalDecryptionError)(a)})["catch"](function(a){if(a instanceof d("WAWebSignalCommonErrors").SignalDecryptionError||a instanceof d("WAWebSignalCommonErrors").SignalMessageCounterError)throw a;d("WALogger").ERROR(r(),a);throw new(d("WAWebSignalCommonErrors").SignalDecryptionError)("Unexpected decryption error")})}function I(a,b,c){return J.apply(this,arguments)}function J(){J=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){d("WALogger").LOG(j());e=(yield c("WAWebCryptoLibraryUtilsApi").createSenderKeyDistributionMsg(e?y.loadSenderKeySessionDeprecatedLid:y.loadSenderKeySession,e?y.saveSenderKeySessionDeprecatedLid:y.saveSenderKeySession,d("WAJids").toGroupJid(a.toString({legacy:!0})),d("WAWebWidToJid").widToDeviceJid(b)));if(e.success)return d("WAByteArray").uint8ArrayToBuffer(e.value);d("WALogger").WARN(i(),e.error);throw c("err")(e.error)});return J.apply(this,arguments)}g.getCryptoLibModule=z;g.createSignalSession=a;g.decryptSignalProto=e;g.encryptSignalProto=f;g.getRemoteRegId=C;g.encryptSenderKeyMsgSignalProto=E;g.processSenderKeyDistributionMsg=G;g.decryptGroupSignalProto=H;g.getGroupSenderKeyInfo=I}),98);
__d("WAWebCryptoLibraryDbCallbacksApi",["Promise","WAByteArray","WAResultOrError","WASignalKeys","WASignalLocalStorageProtocol.pb","WASignalOther","WAWebApiContact","WAWebSignalCommonUtils","WAWebSignalProtocolStore","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=!1,j=!0;function a(){var a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAWebWidFactory").createDeviceWid(a);d("WAWebApiContact").checkPnToLidMapping([a],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_CRYPTO_LIBRARY_DB_CALLBACK_API_LOAD_SESSION);a=d("WAWebSignalCommonUtils").createSignalAddress(a,i);a=(yield d("WAWebSignalProtocolStore").getSignalProtocolStore().loadSession(a));return(a=a)!=null?a:null});return function(b){return a.apply(this,arguments)}}(),c=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g){g=d("WAWebWidFactory").createDeviceWid(a);d("WAWebApiContact").checkPnToLidMapping([g],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_CRYPTO_LIBRARY_DB_CALLBACK_API_HANDLE_NEW_SESSION);a=d("WAWebSignalCommonUtils").createSignalAddress(g,i);g=d("WAWebSignalCommonUtils").createSignalAddressForIdentityTable(g);return(h||(h=b("Promise"))).all([d("WAWebSignalProtocolStore").getSignalProtocolStore().storeSession(a,c),e&&d("WAWebSignalProtocolStore").getSignalProtocolStore().saveIdentity(g,d("WAByteArray").uint8ArrayToBuffer(e)),f!=null&&d("WAWebSignalProtocolStore").getSignalProtocolStore().removePreKey(f)]).then(function(){return d("WAResultOrError").makeResult()})});return function(b,c,d,e,f){return a.apply(this,arguments)}}(),e=function(a,b){b=d("WAWebWidFactory").createDeviceWid(b);d("WAWebApiContact").checkPnToLidMapping([b],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_CRYPTO_LIBRARY_DB_CALLBACK_API_LOAD_SENDER_KEY_SESSION);a=d("WAWebSignalCommonUtils").createSignalLikeSenderKeyName(a,b,i);return d("WAWebSignalProtocolStore").getSignalProtocolStore().loadSenderKey(a).then(function(a){if(a==null)return d("WAResultOrError").makeError("errLoadSenderKeySession");a=a;return d("WAResultOrError").makeResult(a)})},f=function(a,b,c){b=d("WAWebWidFactory").createDeviceWid(b);d("WAWebApiContact").checkPnToLidMapping([b],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_CRYPTO_LIBRARY_DB_CALLBACK_API_SAVE_SENDER_KEY_SESSION);a=d("WAWebSignalCommonUtils").createSignalLikeSenderKeyName(a,b,i);return d("WAWebSignalProtocolStore").getSignalProtocolStore().storeSenderKey(a,c)},g=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAWebSignalCommonUtils").createSignalAddress(d("WAWebWidFactory").createDeviceWid(a),j);a=(yield d("WAWebSignalProtocolStore").getSignalProtocolStore().loadSession(a));return(a=a)!=null?a:null});return function(b){return a.apply(this,arguments)}}(),k=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g){g=d("WAWebWidFactory").createDeviceWid(a);a=d("WAWebSignalCommonUtils").createSignalAddress(g,j);g=d("WAWebSignalCommonUtils").createSignalAddressForIdentityTable(g);return(h||(h=b("Promise"))).all([d("WAWebSignalProtocolStore").getSignalProtocolStore().storeSession(a,c),e&&d("WAWebSignalProtocolStore").getSignalProtocolStore().saveIdentity(g,d("WAByteArray").uint8ArrayToBuffer(e)),f!=null&&d("WAWebSignalProtocolStore").getSignalProtocolStore().removePreKey(f)]).then(function(){return d("WAResultOrError").makeResult()})});return function(b,c,d,e,f){return a.apply(this,arguments)}}(),l=function(a,b){a=d("WAWebSignalCommonUtils").createSignalLikeSenderKeyName(a,d("WAWebWidFactory").createDeviceWid(b),j);return d("WAWebSignalProtocolStore").getSignalProtocolStore().loadSenderKey(a).then(function(a){if(a==null)return d("WAResultOrError").makeError("errLoadSenderKeySession");a=a;return d("WAResultOrError").makeResult(a)})},m=function(a,b,c){a=d("WAWebSignalCommonUtils").createSignalLikeSenderKeyName(a,d("WAWebWidFactory").createDeviceWid(b),j);return d("WAWebSignalProtocolStore").getSignalProtocolStore().storeSenderKey(a,c)};return{loadSession:a,handleNewSession:c,loadSenderKeySession:e,saveSenderKeySession:f,loadSessionDeprecatedLid:g,handleNewSessionDeprecatedLid:k,loadSenderKeySessionDeprecatedLid:l,saveSenderKeySessionDeprecatedLid:m,loadSignedPreKey:function(a){return d("WAWebSignalProtocolStore").getSignalProtocolStore().loadSignedPreKey(a).then(function(b){if(b==null)return null;var c=d("WASignalKeys").makeKeyPairFromArrayBuffers(b.pubKey,b.privKey);c=d("WASignalOther").encodeSignalProto(d("WASignalLocalStorageProtocol.pb").SignedPreKeyRecordStructureSpec,{id:a,publicKey:d("WASignalKeys").serializePubKey(c),privateKey:c.privateKey,signature:new Uint8Array(b.signature),timestamp:0});return d("WASignalOther").castToByteEncoded(c)})},loadOneTimePreKey:function(a){return d("WAWebSignalProtocolStore").getSignalProtocolStore().loadPreKey(a).then(function(b){if(b==null)return null;b=d("WASignalKeys").makeKeyPairFromArrayBuffers(b.pubKey,b.privKey);b=d("WASignalOther").encodeSignalProto(d("WASignalLocalStorageProtocol.pb").PreKeyRecordStructureSpec,{id:a,publicKey:d("WASignalKeys").serializePubKey(b),privateKey:b.privateKey});return d("WASignalOther").castToByteEncoded(b)})},getRegistrationInfo:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebSignalProtocolStore").getSignalProtocolStore().getLocalRegistrationId()),b=(yield d("WAWebSignalProtocolStore").getSignalProtocolStore().getIdentityKeyPair());if(a==null||b==null)return;if(a&&b)return{regId:d("WASignalOther").castRegistrationId(a),staticKeyPair:d("WASignalKeys").makeKeyPairFromArrayBuffers(b.pubKey.slice(1),b.privKey)}});function c(){return a.apply(this,arguments)}return c}()}}g.getCryptoDbCallbacks=a}),98);
__d("WAWebCryptoLibrarySessionApi",["WALogger","WAWebCryptoLibrary"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::createGroupSenderSignalSession"]);h=function(){return a};return a}function a(a,b){b===void 0&&(b=!1);return d("WAWebCryptoLibrary").getRemoteRegId(a,b).then(function(a){return a==null?void 0:a.regId})}function b(a,b,c){var e;e={identity:new Uint8Array(a.identityKey),oneTimeKey:a.preKey&&{id:(e=a.preKey)==null?void 0:e.keyId,publicKey:((e=a.preKey)==null?void 0:e.publicKey)&&new Uint8Array((e=a.preKey)==null?void 0:e.publicKey)},regId:a.registrationId,signedKey:{id:a.signedPreKey.keyId,publicKey:new Uint8Array(a.signedPreKey.publicKey),signature:new Uint8Array(a.signedPreKey.signature)}};return d("WAWebCryptoLibrary").createSignalSession(b,e,c)}function c(a,b,c,e){d("WALogger").DEV(h());return d("WAWebCryptoLibrary").processSenderKeyDistributionMsg(a,b,c,e)}g.getRemoteRegId=a;g.createSignalSession=b;g.createGroupSenderSignalSession=c}),98);
__d("WAWebCryptoLibraryUtilsApi",["WACryptoPrimitives","WALogger","WAResultOrError","WASignalCipher","WASignalGroupCipher","WASignalGroupSession","WASignalKeys","WASignalOther","WASignalSessions","WASignalSignatures","WASignalWhisperTextProtocol.pb","WATimeUtils","WAWebCryptoLibrary","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["extractIdentityKey: parse proto failed"]);h=function(){return a};return a}a=function(){function a(){}var c=a.prototype;c.createSenderKeyDistributionMsg=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=(yield a(c,e));if(!f.success&&f.error==="errLoadSenderKeySession"){var g=(yield d("WASignalKeys").makeKeyPair());yield d("WAWebCryptoLibrary").getCryptoLibModule().rotateGroupSenderKey({saveSenderKeySession:b},c,e,g);f=(yield a(c,e))}if(f.success){b=f.value.senderKeyStates.slice(-1);if(b.length>0)return d("WAResultOrError").makeResult(d("WASignalGroupCipher").createSenderKeyDistributionProto(d("WASignalGroupSession").convertFromRawToSenderKeyState(b[0])))}return d("WAResultOrError").makeError("errGetSenderKeyProto")});function c(b,c,d,e){return a.apply(this,arguments)}return c}();c.getSessionAliceBaseKey=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield b(a));return(b==null?void 0:b.aliceBaseKey)?d("WAResultOrError").makeResult(d("WASignalOther").toBuffer(b.aliceBaseKey)):d("WAResultOrError").makeError("errSessionExists")});function c(b,c){return a.apply(this,arguments)}return c}();c.extractIdentityKey=function(a){a=d("WASignalCipher").readContent(a,d("WASignalSessions").FORMAT_VERSION,0);if(!a.success)return a;try{a=d("decodeProtobuf").decodeProtobuf(d("WASignalWhisperTextProtocol.pb").PreKeySignalMessageSpec,a.value);var b=a.registrationId,c=a.signedPreKeyId,e=a.baseKey,f=a.identityKey;a=a.message;if(b==null||c==null||e==null||f==null||a==null)return d("WAResultOrError").makeError("errSignalDeserializePkInvalidProtoFormat");d("WASignalOther").ensureSize(new Uint8Array(f),33);return d("WAResultOrError").makeResult(f)}catch(a){d("WALogger").WARN(h()).devConsole(a);return d("WAResultOrError").makeError("errSignalDeserializePkKeyBadFormat")}};c.verifySignature=function(a,b,c){a=d("WASignalSignatures").convertPublicKeyToSerializedPubKey(a);c=d("WASignalOther").ensureSize(c,64);return d("WASignalSignatures").verifyMsgSignalVariant(a,b,c)};c.signMsg=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=d("WASignalKeys").makeKeyPairFromArrayBuffers(a,b);b=(yield d("WASignalSignatures").signMsg(a,new Uint8Array(c)));return d("WASignalOther").toBuffer(b)});function c(b,c,d){return a.apply(this,arguments)}return c}();c.makePreKey=function(a){a=d("WASignalKeys").makePreKeys(a,1);a=a[0].plainObject;var b=a.id;a=a.keyPair;return{preKeyId:b,privKey:d("WASignalOther").toBuffer(a.privateKey),pubKey:d("WASignalOther").toBuffer(a.publicKey)}};c.makeSignedPreKey=function(a,b){a=d("WASignalKeys").makeKeyPairFromArrayBuffers(a.pubKey,a.privKey);b=d("WASignalSignatures").makeSignedPreKey(b,d("WATimeUtils").unixTimeMs(),a);return{preKeyId:b.id,signature:d("WASignalOther").toBuffer(b.signature),pubKey:d("WASignalOther").toBuffer(b.keyPair.publicKey),privKey:d("WASignalOther").toBuffer(b.keyPair.privateKey)}};c.makeKeyPair=function(){var a=d("WASignalKeys").makeKeyPair(),b=a.privateKey;a=a.publicKey;return{privKey:d("WASignalOther").toBuffer(b),pubKey:d("WASignalOther").toBuffer(a)}};return a}();a.prototype.verify=d("WACryptoPrimitives").verify;a.prototype.makeRegistrationId=d("WASignalOther").makeRegistrationId;a.prototype.makeSenderKeyId=d("WASignalOther").makeSenderKeyId;c=new a();e=c;g["default"]=e}),98);
__d("WAWebSignalProtocolStore",["WAWebSignalProtocolStoreUnifiedApi"],(function(a,b,c,d,e,f,g){function a(){return c("WAWebSignalProtocolStoreUnifiedApi")}function b(){return c("WAWebSignalProtocolStoreUnifiedApi")}function d(){c("WAWebSignalProtocolStoreUnifiedApi").switchToMemMode()}function e(){c("WAWebSignalProtocolStoreUnifiedApi").switchToPersistMode()}g.getSignalProtocolStore=a;g.getPersistSignalProtocolStore=b;g.enableMemSignalStore=d;g.enablePersistSignalStore=e}),98);
__d("WAWebProtocolStoreCommonApi",["WAWebSignalCommonUtils"],(function(a,b,c,d,e,f,g){function a(a){return a instanceof ArrayBuffer?d("WAWebSignalCommonUtils").bufferToStr(a):a}g.stringifyIdentityKey=a}),98);
__d("WAWebSignalProtocolStoreCacheApi",["WALogger","WASemaphore","lodash"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Signal]signalSnapshot: get dirty updates for\n  session: ","\n  senderKey: ","\n  identity: ",";\n  preKeyRemove: ","\n  sessionRemove: ","\n  identityRemove: ","\n"]);h=function(){return a};return a}a=function(){function a(){var a;this.RegistrationInfo=null;this.SignedPreKeyStore=new Map();this.PrekeyStore=new Map();this.SessionStore=new Map();this.IdentityStore=new Map();this.SenderKeyStore=new Map();this.Mutex={session:new((a=d("WASemaphore")).Semaphore)(),identity:new a.Semaphore(),senderKey:new a.Semaphore(),preKey:new a.Semaphore()};this.Dirty={session:new Set(),identity:new Set(),senderKey:new Set(),preKey:new Set()}}var b=a.prototype;b.$1=function(){var a=this,b=[],d=[];this.Dirty.session.forEach(function(e){var f=a.SessionStore.get(e);if(!f)return;!f.deleted?b.push({address:e,session:c("lodash").cloneDeep(f.session)}):d.push(e)});return{update:b,remove:d}};b.$2=function(){var a=this,b=[];this.Dirty.senderKey.forEach(function(d){var e=a.SenderKeyStore.get(d);if(e){var f=d.split("::");f.length===2&&b.push({senderKeyName:d,senderId:f[1],senderKey:c("lodash").cloneDeep(e)})}});return b};b.$3=function(){var a=this,b=[],c=[];this.Dirty.identity.forEach(function(d){var e=a.IdentityStore.get(d);if(!e)return;!e.deleted?b.push({identifier:d,identityKey:e.identityKey,rowId:e.rowId,sentAddonRowId:e.sentAddonRowId}):c.push(d)});return{update:b,remove:c}};b.$4=function(){var a=this,b=[];this.Dirty.preKey.forEach(function(c){var d=a.PrekeyStore.get(c);(d==null?void 0:d.deleted)&&b.push(parseInt(c,10))});return b};b.generateCacheUpdate=function(){var a=this.$3(),b=this.$1();b={sessionUpdate:b.update,sessionRemove:b.remove,identityUpdate:a.update,identityRemove:a.remove,senderKeyUpdate:this.$2(),preKeyRemove:this.$4()};i(b);return b};b.clearDirty=function(){this.Dirty={session:new Set(),identity:new Set(),senderKey:new Set(),preKey:new Set()}};b.clear=function(){this.RegistrationInfo=null,this.SignedPreKeyStore.clear(),this.PrekeyStore.clear(),this.SessionStore.clear(),this.IdentityStore.clear(),this.SenderKeyStore.clear(),this.clearDirty()};return a}();function i(a){d("WALogger").DEV(h(),a.sessionUpdate.map(function(a){return a.address}).join(",")||"[]",a.senderKeyUpdate.map(function(a){return a.senderKeyName}).join(",")||"[]",a.identityUpdate.map(function(a){return a.identifier}).join(",")||"[]",a.preKeyRemove.join(",")||"[]",a.sessionRemove.join(",")||"[]",a.identityRemove.join(",")||"[]").tags("unified-store")}g.SignalStoreCache=a}),98);
__d("WAWebSignalProtocolStoreUnifiedApi",["$InternalEnum","Promise","WALogger","WAWebApiContact","WAWebBackendApi","WAWebCryptoCurve25519","WAWebIdentityChangeApi","WAWebProtocolStoreCommonApi","WAWebSignalCommonUtils","WAWebSignalConvertApi","WAWebSignalProtocolStoreCacheApi","WAWebSignalStorageUtils","WAWebSignalStoreApi","WAWebSingleSignalSession","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime","err","gkx"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Signal]maybeCleanUpUnconvertedSession: delete unconverted session"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Signal]updateIdentityRangeAfterEncryption: "," updated"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Signal]updateIdentityRangeAfterEncryption: updates: "," to rowId: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Signal]updateIdentityRangeAfterEncryption: start"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Signal]flushBufferToDiskIfNotMemOnlyMode: done"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Signal]flushBufferToDiskIfNotMemOnlyMode: lock complete"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Signal]flushBufferToDiskIfNotMemOnlyMode: start"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Signal]flushBufferToDiskIfNotMemOnlyMode: skip for memory mode"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Signal]deleteAllCache"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Signal][storeSenderKey][unified] senderKeyName: "," keyId:"," chainCounter: ",""]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Signal][storeSenderKey][unified] senderKeyName: "," keyId:"," chainCounter: ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Signal]bulkCreateIdentity: store "," value(s) (new: ","): end"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Signal]bulkCreateIdentity: store "," value(s): start"]);u=function(){return a};return a}var v=b("$InternalEnum").Mirrored(["Persist","Memory"]);a=function(){function a(){this.Direction={SENDING:1,RECEIVING:2},this._cache=new(d("WAWebSignalProtocolStoreCacheApi").SignalStoreCache)(),this._mode=v.Persist}var e=a.prototype;e.getIdentityKeyPair=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a;this._cache.RegistrationInfo||(this._cache.RegistrationInfo=(yield d("WAWebSignalStoreApi").waSignalStore.getRegistrationInfo()));return((a=this._cache.RegistrationInfo)==null?void 0:a.identityKeyPair)?d("WAWebCryptoCurve25519").toSignalCurveKeyPair(this._cache.RegistrationInfo.identityKeyPair):void 0});function c(){return a.apply(this,arguments)}return c}();e.getLocalRegistrationId=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a;this._cache.RegistrationInfo||(this._cache.RegistrationInfo=(yield d("WAWebSignalStoreApi").waSignalStore.getRegistrationInfo()));return((a=this._cache.RegistrationInfo)==null?void 0:a.registrationId)||void 0});function c(){return a.apply(this,arguments)}return c}();e.isTrustedIdentity=function(a,c){return(h||(h=b("Promise"))).resolve(!0)};e._loadIdentityKeyImpl=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a==null)throw c("err")("Tried to get identity key for undefined/null key");if(!this._cache.IdentityStore.has(a)){var b=(yield d("WAWebSignalStoreApi").waSignalStore.getIdentityKeyWithRowId(a));this._cache.IdentityStore.set(a,b)}return((b=this._cache.IdentityStore.get(a))==null?void 0:b.identityKey)||void 0});function a(b){return a.apply(this,arguments)}return a}();e.loadIdentityKey=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this._cache.Mutex.identity.acquire());try{return yield this._loadIdentityKeyImpl(a)}finally{b.release()}});function c(b){return a.apply(this,arguments)}return c}();e._putIdentityImpl=function(a,b){this._cache.IdentityStore.set(a,{identityKey:b}),this._cache.Dirty.identity.add(a)};e.putIdentity=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield this._cache.Mutex.identity.acquire());try{this._putIdentityImpl(a,b)}finally{c.release()}});function c(b,c){return a.apply(this,arguments)}return c}();e._saveIdentity=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=d("WAWebProtocolStoreCommonApi").stringifyIdentityKey(b);var c=(yield this.loadIdentityKey(a));if(c&&c===b)return;else if(c){if(a===d("WAWebSignalCommonUtils").createSignalAddressForIdentityTable(d("WAWebUserPrefsMeUser").getMeUser()).toString()){d("WAWebBackendApi").frontendFireAndForget("handleSelfPrimaryIdentityChange",{});return}a!=null&&(yield d("WAWebIdentityChangeApi").handleNewIdentity(d("WAWebWidFactory").widFromSignalAddress(a),!1))}yield this.putIdentity(a,b)});function a(b,c){return a.apply(this,arguments)}return a}();e.saveIdentity=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(a==null)throw c("err")("Tried to put identity key for undefined/null key");yield this._saveIdentity(a,b);if(a!==d("WAWebSignalCommonUtils").createSignalAddressForIdentityTable(d("WAWebUserPrefsMeUser").getMeUser()).toString()&&!d("WAWebSingleSignalSession").isUsingAccountIdentifierForSignalStorage()){a=d("WAWebWidFactory").widFromSignalAddress(a);a=d("WAWebApiContact").getAlternateDeviceWid(d("WAWebWidFactory").createDeviceWidFromWid(a));a=a!=null?d("WAWebSignalCommonUtils").createSignalAddressForIdentityTable(a).toString():null;a!=null&&(yield this._saveIdentity(a,b))}});function e(b,c){return a.apply(this,arguments)}return e}();e.getIdentityWithRowId=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a==null)throw c("err")("Tried to get identity key for undefined/null key");yield this.loadIdentityKey(a);a=this._cache.IdentityStore.get(a);if(a==null||a.deleted!==void 0)return;return a});function d(b){return a.apply(this,arguments)}return d}();e.bulkGetIdentityWithRowId=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this;if(a==null)throw c("err")("Tried to get identity key for undefined/null key");if(a.length===0)return[];yield this.bulkLoadIdentityKey(a);return a.map(function(a){a=b._cache.IdentityStore.get(a);if(a==null||a.deleted!==void 0)return;return a})});function d(b){return a.apply(this,arguments)}return d}();e._bulkLoadIdentityKeyImpl=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this;if(a==null)throw c("err")("Tried to get identity key for undefined/null key");if(a.length===0)return[];var e=new Array(a.length),f=[];a.forEach(function(a,c){if(b._cache.IdentityStore.has(a)){var d;e[c]=(d=b._cache.IdentityStore.get(a))==null?void 0:d.identityKey}else f.push({id:a,pos:c})});if(f.length>0){a=(yield d("WAWebSignalStoreApi").waSignalStore.bulkGetIdentityKeyWithRowId(f.map(function(a){return a.id})));a.forEach(function(a,c){c=f[c];b._cache.IdentityStore.set(c.id,a);e[c.pos]=a==null?void 0:a.identityKey})}return e});function a(b){return a.apply(this,arguments)}return a}();e.bulkLoadIdentityKey=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this._cache.Mutex.identity.acquire());try{return yield this._bulkLoadIdentityKeyImpl(a)}finally{b.release()}});function c(b){return a.apply(this,arguments)}return c}();e.expandNewIdentitiesList=function(a){var b=new Map();a.forEach(function(a){b.set(a.identifier,{identifier:a.identifier,identityKey:a.identityKey})});a.forEach(function(a){var c=d("WAWebWidFactory").widFromSignalAddress(a.identifier);c=d("WAWebApiContact").getAlternateDeviceWid(d("WAWebWidFactory").createDeviceWidFromWid(c));if(c==null)return;c=d("WAWebSignalCommonUtils").createSignalAddressForIdentityTable(c).toString();b.set(c,{identifier:c,identityKey:a.identityKey})});return Array.from(b.values())};e._bulkCreateIdentityImpl=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=this;if(a==null)throw c("err")("Tried to bulk put identity key with undefined/null");d("WALogger").LOG(u(),a.length).tags("unified-store");yield d("WAWebSignalStorageUtils").getStorage().lock(["identity-store"],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=a.map(function(a){return a.identifier}),c=(yield e._bulkLoadIdentityKeyImpl(b));b=a.filter(function(a,b){return!c[b]});b.length>0&&!d("WAWebSingleSignalSession").isUsingAccountIdentifierForSignalStorage()&&(b=e.expandNewIdentitiesList(b),yield d("WAWebSignalStoreApi").waSignalStore.bulkPutIdentity(b),b.forEach(function(a){var b=a.identifier;a=a.identityKey;e._cache.IdentityStore.set(b,{identityKey:a})}));d("WALogger").LOG(t(),a.length,b.length).tags("unified-store")}))});function a(b){return a.apply(this,arguments)}return a}();e.bulkCreateIdentity=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this._cache.Mutex.identity.acquire());try{yield this._bulkCreateIdentityImpl(a)}finally{b.release()}});function c(b){return a.apply(this,arguments)}return c}();e._removeIdentityImpl=function(a){this._cache.IdentityStore.set(a,{deleted:!0}),this._cache.Dirty.identity.add(a)};e.removeIdentity=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a==null)return(h||(h=b("Promise"))).reject(c("err")("Tried to remove identity key for undefined/null key"));var d=(yield this._cache.Mutex.identity.acquire());try{yield this._removeIdentityImpl(a)}finally{d.release()}});function d(b){return a.apply(this,arguments)}return d}();e._loadPreKeyImpl=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a==null)return void 0;if(!this._cache.PrekeyStore.has(a)){var b;b=(b=(yield d("WAWebSignalStoreApi").waSignalStore.getPreKeyById(a)))==null?void 0:b.keyPair;this._cache.PrekeyStore.set(a,{keyPair:b})}b=this._cache.PrekeyStore.get(a);return(b==null?void 0:b.keyPair)||void 0});function a(b){return a.apply(this,arguments)}return a}();e.loadPreKey=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this._cache.Mutex.preKey.acquire());try{return yield this._loadPreKeyImpl(a)}finally{b.release()}});function c(b){return a.apply(this,arguments)}return c}();e._removePreKeyImpl=function(a){if(a==null)return(h||(h=b("Promise"))).reject(c("err")("Tried to remove pre key without keyId"));this._cache.PrekeyStore.set(a,{deleted:!0});this._cache.Dirty.preKey.add(a);return(h||(h=b("Promise"))).resolve()};e.removePreKey=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this._cache.Mutex.preKey.acquire());try{yield this._removePreKeyImpl(a)}finally{b.release()}});function c(b){return a.apply(this,arguments)}return c}();e.loadSignedPreKey=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a==null)return void 0;if(!this._cache.SignedPreKeyStore.has(a)){var b=(yield d("WAWebSignalStoreApi").waSignalStore.getSignedPreKeyById(a));b=b?{pubKey:b.keyPair.pubKey,privKey:b.keyPair.privKey,signature:b.signature}:null;this._cache.SignedPreKeyStore.set(a,b)}return this._cache.SignedPreKeyStore.get(a)||void 0});function c(b){return a.apply(this,arguments)}return c}();e._loadSessionImpl=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a==null)return void 0;if(!this._cache.SessionStore.has(a)){var b=(yield d("WAWebSignalStoreApi").waSignalStore.getSession(a));this._cache.SessionStore.set(a,b?{session:b}:void 0)}return(yield d("WAWebSignalConvertApi").maybeConvertSession((b=this._cache.SessionStore.get(a))==null?void 0:b.session))||void 0});function a(b){return a.apply(this,arguments)}return a}();e.loadSession=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this._cache.Mutex.session.acquire());try{return yield this._loadSessionImpl(a)}finally{b.release()}});function c(b){return a.apply(this,arguments)}return c}();e._storeSessionImpl=function(a,b){if(a==null)throw c("err")("Tried to put session without identifier");this._cache.SessionStore.set(a,{session:b});this._cache.Dirty.session.add(a)};e.storeSession=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield this._cache.Mutex.session.acquire());try{this._storeSessionImpl(a,b)}finally{c.release()}});function c(b,c){return a.apply(this,arguments)}return c}();e._removeSessionImpl=function(a){if(a==null)throw c("err")("Tried to remove session without identifier");this._cache.SessionStore.set(a,{deleted:!0});this._cache.Dirty.session.add(a)};e.removeSession=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this._cache.Mutex.session.acquire());try{this._removeSessionImpl(a)}finally{b.release()}});function c(b){return a.apply(this,arguments)}return c}();e._containSessionsImpl=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this,c=[];for(var e of a)this._cache.SessionStore.has(e)||c.push(e);if(c.length>0){e=(yield d("WAWebSignalStoreApi").waSignalStore.bulkGetSession(c));e.forEach(function(a,d){d=c[d];b._cache.SessionStore.set(d,a?{session:a}:void 0)})}return a.map(function(a){a=b._cache.SessionStore.get(a);return a!=null&&!(a==null?void 0:a.deleted)})});function a(b){return a.apply(this,arguments)}return a}();e.containSessions=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this._cache.Mutex.session.acquire());try{return yield this._containSessionsImpl(a)}finally{b.release()}});function c(b){return a.apply(this,arguments)}return c}();e._storeSenderKeyImpl=function(a,e){if(a==null)return(h||(h=b("Promise"))).reject(c("err")("Tried to put session without identifier"));if(!c("gkx")("26258"))if(Array.isArray(e==null?void 0:e.sessions)){var f=e.sessions[e.sessions.length-1];d("WALogger").DEV(s(),a,f==null?void 0:f.keyId,f==null?void 0:(f=f.chainKey)==null?void 0:f.counter)}else{f=e==null?void 0:(f=e.senderKeyStates)==null?void 0:f[0];d("WALogger").DEV(r(),a,f==null?void 0:f.senderKeyId,f==null?void 0:(f=f.senderKeyChainKey)==null?void 0:f.nextMsgIndex)}this._cache.SenderKeyStore.set(a,e);this._cache.Dirty.senderKey.add(a);return(h||(h=b("Promise"))).resolve()};e.storeSenderKey=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield this._cache.Mutex.senderKey.acquire());try{yield this._storeSenderKeyImpl(a,b)}finally{c.release()}});function c(b,c){return a.apply(this,arguments)}return c}();e._loadSenderKeyImpl=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a==null)return void 0;if(!this._cache.SenderKeyStore.has(a)){var b=(yield d("WAWebSignalStoreApi").waSignalStore.getSenderKey(a));this._cache.SenderKeyStore.set(a,b)}return d("WAWebSignalConvertApi").maybeConvertSenderKey(this._cache.SenderKeyStore.get(a))||void 0});function a(b){return a.apply(this,arguments)}return a}();e.loadSenderKey=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this._cache.Mutex.senderKey.acquire());try{return yield this._loadSenderKeyImpl(a)}finally{b.release()}});function c(b){return a.apply(this,arguments)}return c}();e.switchToMemMode=function(){this._mode=v.Memory};e.switchToPersistMode=function(){this._mode=v.Persist};e.generateSnapshot=function(){if(this._mode===v.Memory)return this._cache.generateCacheUpdate()};e.deleteAllCache=function(){d("WALogger").LOG(q()).tags("unified-store"),this._cache.clear()};e.flushBufferToDiskIfNotMemOnlyMode=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(this._mode===v.Memory){d("WALogger").LOG(p()).tags("unified-store");return(h||(h=b("Promise"))).resolve()}d("WALogger").LOG(o()).tags("unified-store");var a=[yield this._cache.Mutex.identity.acquire(),yield this._cache.Mutex.session.acquire(),yield this._cache.Mutex.senderKey.acquire(),yield this._cache.Mutex.preKey.acquire()];d("WALogger").LOG(n()).tags("unified-store");var c=this._cache.generateCacheUpdate();try{yield d("WAWebSignalStorageUtils").getStorage().lock(["session-store","identity-store","prekey-store","senderkey-store"],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield (h||(h=b("Promise"))).all([d("WAWebSignalStoreApi").waSignalStore.bulkPutSession(c.sessionUpdate),d("WAWebSignalStoreApi").waSignalStore.bulkPutIdentityKeyWithRowId(c.identityUpdate),d("WAWebSignalStoreApi").waSignalStore.bulkPutSenderKey(c.senderKeyUpdate),d("WAWebSignalStoreApi").waSignalStore.bulkRemovePreKey(c.preKeyRemove),d("WAWebSignalStoreApi").waSignalStore.bulkRemoveSession(c.sessionRemove),d("WAWebSignalStoreApi").waSignalStore.bulkRemoveIdentity(c.identityRemove)])})),this._cache.clearDirty()}finally{a.forEach(function(a){return a.release()})}d("WALogger").LOG(m()).tags("unified-store")});function c(){return a.apply(this,arguments)}return c}();e._updateIdentityRangeAfterEncryptionImpl=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=this;d("WALogger").LOG(l()).tags("unified-store");yield this._bulkLoadIdentityKeyImpl(c);var f=[];c.forEach(function(c){var d=e._cache.IdentityStore.get(c);if(d&&!d.deleted&&(d[a]==null||d[a]>b)){d=babelHelpers["extends"]({},d);d[a]=b;e._cache.IdentityStore.set(c,d);e._cache.Dirty.identity.add(c);f.push(c)}});d("WALogger").DEV(k(),JSON.stringify(f),b).tags("unified-store");d("WALogger").LOG(j(),f.length).tags("unified-store")});function a(b,c,d){return a.apply(this,arguments)}return a}();e.updateIdentityRangeAfterEncryption=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var d=(yield this._cache.Mutex.identity.acquire());try{yield this._updateIdentityRangeAfterEncryptionImpl(a,b,c)}finally{d.release()}});function c(b,c,d){return a.apply(this,arguments)}return c}();e._maybeCleanUpUnconvertedSessionAfterEncryption=function(a){if(a==null)return(h||(h=b("Promise"))).resolve();var c=this._cache.SessionStore.get(a);c&&d("WAWebSignalConvertApi").shouldConvertSession(c.session)&&(d("WALogger").LOG(i()).tags("unified-store"),this._removeSessionImpl(a));return(h||(h=b("Promise"))).resolve()};e.maybeCleanUpUnconvertedSession=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this._cache.Mutex.session.acquire());try{return yield this._maybeCleanUpUnconvertedSessionAfterEncryption(a)}finally{b.release()}});function c(b){return a.apply(this,arguments)}return c}();return a}();e=new a();g["default"]=e}),98);
__d("WAWebAdvSyncDeviceListApi",["Promise","WALogger","WAWebAdvHandlerApi","WAWebApiContact","WAWebApiDeviceList","WAWebDeviceListPk","WAWebGetIdentityKeysJob","WAWebPhashUtils","WAWebUserPrefsMeUser","WAWebUsync","WAWebUsyncUser","WAWebWidFactory","asyncToGeneratorRuntime","err","lodash"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncDeviceList: skipping "," out of "," records"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncDeviceList: error ",": ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["adv: sync my device list complete"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["adv: sync my device list begin"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to sync device list with error: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["adv: begin syncDeviceList for ",""]);n=function(){return a};return a}var o=new Map();function p(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.wids,f=a.context;a=a.phash;d("WALogger").DEV(n(),e.slice(0,3).join(",")+(e.length>3?"...":""));if(a!=null){var g=(yield d("WAWebApiDeviceList").getDeviceIds(e));g=g.map(function(a){return a==null?[]:a.devices.map(function(b){return d("WAWebWidFactory").createDeviceWidFromDeviceListPk(a.id,b.id,b.isHosted)})});g=c("lodash").flatMap(g,function(a){return a});g=(yield d("WAWebPhashUtils").phashV2(g));if(a===g)return}var i=new Set(),j=[];e.forEach(function(a){var b=o.get(d("WAWebDeviceListPk").createDeviceListPK(a));b?i.add(b):j.push(a)});if(j.length===0){yield (h||(h=b("Promise"))).all(Array.from(i));return}var k=r(j,f);j.map(function(a){o.set(d("WAWebDeviceListPk").createDeviceListPK(a),k)});yield (h||(h=b("Promise"))).all([k].concat(Array.from(i)))});return q.apply(this,arguments)}function r(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){try{var e=(yield d("WAWebApiDeviceList").getDeviceInfoForSync(a)),f=e.map(function(a){return a==null?[]:a.devices.map(function(b){return d("WAWebWidFactory").createDeviceWidFromDeviceListPk(a.id,b.id,b.isHosted)})}),g=(yield (h||(h=b("Promise"))).all(f.map(function(a){return a.length===0?"":d("WAWebPhashUtils").phashV2(a)})));f=a.map(function(a,b){return{id:a,hash:g[b],ts:(a=e[b])==null?void 0:a.timestamp,expectedTs:(a=e[b])==null?void 0:a.expectedTs}});return v(f,c)}catch(a){d("WALogger").ERROR(m(),a)}finally{a.map(function(a){o["delete"](d("WAWebDeviceListPk").createDeviceListPK(a))})}});return s.apply(this,arguments)}function a(){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").DEV(l()),yield p({wids:d("WAWebUserPrefsMeUser").getMePNandLIDWids(),context:null,phash:null}),d("WALogger").DEV(k())});return t.apply(this,arguments)}function e(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield p({wids:a,context:null,phash:null});return d("WAWebApiDeviceList").getDeviceIds(a)});return u.apply(this,arguments)}function v(a,b){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(a.length===0)return;d("WAWebApiContact").checkPnToLidMapping(a.map(function(a){return a.id}),d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_ADV_SYNC_DEVICE_LIST_SEND_DEVICE_SYNC_REQUEST);var e=new(d("WAWebUsync").USyncQuery)().withContext(b||"interactive").withDeviceProtocol();a.forEach(function(a){a.id.user!==0&&e.withUser(new(d("WAWebUsyncUser").USyncUser)().withId(a.id).withDeviceHash(String(a.hash)).withTs(a.ts).withExpectedTs(a.expectedTs))});b=(yield e.execute());if(b.error.all)throw c("err")("syncDeviceList: error "+b.error.all.errorCode+": "+b.error.all.errorText);b.error.devices&&d("WALogger").WARN(j(),b.error.devices.errorCode,b.error.devices.errorText);a=b.list.filter(function(a){return!("errorCode"in a.devices)});a=a.map(function(a){return{wid:a.id,devices:a.devices}});var f=a.filter(function(a){return(a=a.devices.keyIndex)==null?void 0:a.signedKeyIndexBytes}).map(function(a){return a.wid});d("WALogger").LOG(i(),b.list.length-f.length,b.list.length);yield d("WAWebGetIdentityKeysJob").getAndStoreIdentityKeys(f);return d("WAWebAdvHandlerApi").handleADVDeviceSyncResult(a)});return w.apply(this,arguments)}g.syncDeviceList=p;g.syncMyDeviceList=a;g.syncAndGetDeviceList=e}),98);
__d("WAWebDeleteLastAddOnsPreview",["WAWebApiChat","WAWebMsgKey","WAWebShouldUpdateLastAddOnPreview","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Set(a.map(function(a){return c("WAWebMsgKey").fromString(a).remote.toString()}));b=(yield d("WAWebShouldUpdateLastAddOnPreview").bulkGetChatLastAddOnPreviewMap(Array.from(b)));var e=new Map();b.forEach(function(b,c){a.includes(b==null?void 0:b.parentMsgKey)&&e.set(c,void 0)});yield d("WAWebApiChat").bulkUpdateChatLastAddOnPreview(e)});return h.apply(this,arguments)}g.deleteLastAddOnsPreview=a}),98);
__d("WAWebMessageInsertDebugPlaceholder",["WALogger","WAWebBackendApi","WAWebCmd","WAWebMessageProcessorCache","WAWebMessagingGatingUtils","WAWebMsgProcessingApiUtils","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["_insertDebugPlaceholder: msgId::",", failed to insert with error: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["_insertDebugPlaceholder: msgId::",", could not parse message info"]);i=function(){return a};return a}function a(a){if(!d("WAWebMessagingGatingUtils").isMessageDropPlaceholderEnabled())return;void j(a)}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.externalId,c=a.msgInfo,e=a.offline,f=a.nackReason;a=a.additionalInfo;if(c==null){d("WALogger").WARN(i(),b).tags("messaging");return}f=f.toString();a=a!=null?f+" "+a:f;f=babelHelpers["extends"]({},d("WAWebMsgProcessingApiUtils").generateBaseMsg(c),{type:d("WAWebMsgType").MSG_TYPE.DEBUG_PLACEHOLDER,kind:d("WAWebMsgType").MsgKind.DebugPlaceholder,body:a});try{yield d("WAWebMessageProcessorCache").messageProcessorCache.addMessages([{msg:f}],e!==!0),d("WAWebCmd").Cmd.isMainStreamReadyMd&&(yield d("WAWebBackendApi").frontendSendAndReceive("updateMessageUI",{chatId:f.id.remote,msg:f}))}catch(a){d("WALogger").WARN(h(),b,a).tags("messaging")}});return k.apply(this,arguments)}g.maybeInsertDebugPlaceholder=a}),98);
__d("WAWebMessagePostProcessBatcher",["Promise","WABatcher","WAWebBackendApi","WAWebMsgType","WAWebNoop","WAWebWorkerSafeBackendApi"],(function(a,b,c,d,e,f,g){var h,i={delayMs:1e3};a=function(){function a(){var a=this;this.$1=d("WABatcher").createSimpleBatcher(i,function(c){a.$2(c);return(h||(h=b("Promise"))).resolve([])})}var e=a.prototype;e.acceptMessage=function(a){return this.$1.accept(a)};e.runActiveBatches=function(){return this.$1.runActiveBatch().then(c("WAWebNoop"))};e.$2=function(a){d("WAWebBackendApi").frontendFireAndForget("processOrphanReadReceipts",{msgIds:a.map(function(a){return a.id})});a=a.filter(function(a){return a.type===d("WAWebMsgType").MSG_TYPE.PAYMENT&&a.subtype==="send"});a.length>0&&d("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("processOrphanPaymentNotifications",{msgs:a})};return a}();e=new a();g.messagePostProcessBatcher=e}),98);
__d("WAWebMessagePostprocessRenderable",["Promise","WALogger","WAWebBackendApi","WAWebBizUpdateVerifiedInfoAction","WAWebMessagePostProcessBatcher","WAWebOfflineResumeMsgProcessReporter","WAWebUserPrefsMeUser","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[unify][message] UI update completed"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[unify][message] UI update started"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["handlePrivacyModeChange: failed to update biz privacy status with error ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["query contact info on new chat failed"]);l=function(){return a};return a}function a(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.msgInfo,e=a.messageOverwriteOption,f=a.msgs,g=a.isOffline,k=a.shouldQueryContactInfo,l=a.latestPrivacyMode,m=d("WAWebOfflineResumeMsgProcessReporter").msgProcessReporter.startMarker(d("WAWebOfflineResumeMsgProcessReporter").msgProcessReporter.stage.PostProcessing);d("WALogger").DEV(j());yield (h||(h=b("Promise"))).all(f.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebBackendApi").frontendSendAndReceive("updateMessageUI",{chatId:a.id.remote,msg:a,messageOverwriteOption:e,preserveOrder:!0,isOffline:g}),void d("WAWebMessagePostProcessBatcher").messagePostProcessBatcher.acceptMessage(a),g||void d("WAWebMessagePostProcessBatcher").messagePostProcessBatcher.runActiveBatches()});return function(b){return a.apply(this,arguments)}}()));(k||l!=null)&&n(a);d("WALogger").DEV(i());yield d("WAWebBackendApi").frontendSendAndReceive("updateUnattributedMessages",{messageInfo:c,messages:f});m==null?void 0:m()});return m.apply(this,arguments)}function n(a){var b=a.shouldQueryContactInfo,c=a.msgInfo,e=a.latestPrivacyMode;a=a.msgs;var f=c.chat;b&&d("WAWebBizUpdateVerifiedInfoAction").queryAndUpdateContactPropertiesOnNewChat(f)["catch"](function(a){d("WALogger").WARN(l())});!d("WAWebUserPrefsMeUser").isMeAccount(c.author)&&e!=null&&d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("updateBizPrivacyStatus",{msgIds:a.map(function(a){return a.id}),privacyMode:e})["catch"](function(a){d("WALogger").ERROR(k(),a)})}g.postprocessRenderableMessages=a}),98);
__d("WAWebWamEnumOfflineProcessRunReasons",[],(function(a,b,c,d,e,f){a=Object.freeze({PUSH_NOTIFICATION:1,PERIODIC_BACKGROUND_SYNC:2});f.OFFLINE_PROCESS_RUN_REASONS=a}),66);
__d("WAWebWamEnumOfflineProcessStages",[],(function(a,b,c,d,e,f){a=Object.freeze({PAGE_LOAD:1,SOCKET_CONNECT:2,OFFLINE_PREVIEW:3,PROCESSING:4,PROCESS_COMPLETE:5,PROCESS_INTERRUPTED:6});f.OFFLINE_PROCESS_STAGES=a}),66);
__d("WAWebWebcOfflineNotificationProcessWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumOfflineProcessRunReasons","WAWebWamEnumOfflineProcessStages"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({WebcOfflineNotificationProcess:[4222,{currentOfflineProcessStage:[4,d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES],offlineProcessDecryptErrorCount:[5,a.TYPES.INTEGER],offlineProcessMailboxAge:[6,a.TYPES.INTEGER],offlineProcessMessageCount:[7,a.TYPES.INTEGER],offlineProcessNotificationCount:[8,a.TYPES.INTEGER],offlineProcessSessionId:[9,a.TYPES.STRING],offlineProcessStageTimestampMs:[10,a.TYPES.INTEGER],runReason:[12,d("WAWebWamEnumOfflineProcessRunReasons").OFFLINE_PROCESS_RUN_REASONS],swVersion:[11,a.TYPES.STRING]},[1,1,1],"regular"]},{WebcOfflineNotificationProcess:[]});g.WebcOfflineNotificationProcessWamEvent=b}),98);
__d("WAWebWamWorkerOfflineProcessReporter",["WAHex","WALogger","WAShiftTimer","WATimeUtils","WAWebBuildConstants","WAWebRuntimeEnvironmentUtils","WAWebUserPrefsGeneral","WAWebUserPrefsMultiDevice","WAWebWamEnumOfflineProcessRunReasons","WAWebWamEnumOfflineProcessStages","WAWebWamOfflineResumeReporter","WAWebWebcOfflineNotificationProcessWamEvent","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][worker] worker offline processing ends\n        ========= worker offline processing perf ==========\n        message: ","\n        receipt: ","\n        notification: ","\n        ProcessedMessage: ","\n        ProcessedNotification: ","\n        decryptError: ","\n        pageLoadT: 0\n        socketConnectT: ","\n        offlinePreviewT: ","\n        processCompleteT: ","\n        mailboxAge: ","\n        isInterrupted: ","\n        runReason: ","\n        ===================================================\n        "]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose([" [offline-resume][worker] worker offline processing takes too long"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][worker] worker offline processing progress updates\n          ======= worker offline processing update ========\n          ProcessedMessage: ","\n          ProcessedNotification: ","\n          currentProcessingT: ","\n          =================================================\n         "]);j=function(){return a};return a}var k=1e4,l=12e4;a=function(){function a(){this.$7=null,this.$1=this.$12(),this.$2=d("WAWebWamEnumOfflineProcessRunReasons").OFFLINE_PROCESS_RUN_REASONS.PUSH_NOTIFICATION,this.pageLoadT=self.performance.now(),this.$3=0,this.$4=0,this.$5=0,this.$6=0,this.$8=0,this.$9=0,this.$10=0}var c=a.prototype;c.$12=function(){return""+d("WAHex").randomHex(4)+d("WATimeUtils").unixTimeWithoutClockSkewCorrection()};c.$13=function(a,b){b=new(d("WAWebWebcOfflineNotificationProcessWamEvent").WebcOfflineNotificationProcessWamEvent)({offlineProcessSessionId:this.$1,offlineProcessStageTimestampMs:b,currentOfflineProcessStage:a,swVersion:d("WAWebBuildConstants").VERSION_BASE,runReason:this.$2});(a===d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESSING||a===d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_COMPLETE||a===d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_INTERRUPTED)&&this.$14(b);a===d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_COMPLETE||a===d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_INTERRUPTED?void b.commitAndWaitForFlush(!0):b.commit()};c.$14=function(a){var b;a.offlineProcessMessageCount=d("WAWebWamOfflineResumeReporter").roundUp((b=this.$9)!=null?b:0,10);a.offlineProcessNotificationCount=d("WAWebWamOfflineResumeReporter").roundUp((b=this.$10)!=null?b:0,10);a.offlineProcessMailboxAge=d("WAWebWamOfflineResumeReporter").countDays((b=this.$6)!=null?b:0);a.offlineProcessDecryptErrorCount=(b=this.$8)!=null?b:0};c.$15=function(){var a=this;this.$7==null&&(this.$7=new(d("WAShiftTimer").ShiftTimer)(function(){if(a.$11!==d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESSING)return;var b=Math.floor(self.performance.now()-a.pageLoadT);d("WALogger").LOG(j(),a.$9,a.$10,b);if(b>l){d("WALogger").ERROR(i()).sendLogs("worker-offline-process-takes-too-long");return}a.$13(d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESSING,b);a.$15()}));this.$7.onOrAfter(k)};c.$16=function(){var a;this.$11=d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESSING;(a=this.$7)==null?void 0:a.cancel();this.$15()};c.$17=function(a){a===void 0&&(a=-1),d("WALogger").LOG(h(),this.$3,this.$4,this.$5,this.$9,this.$10,this.$8,this.socketConnectT,this.offlinePreviewT,this.processCompleteT,a,this.$11===d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_INTERRUPTED,this.$2)};c.getCurrentStage=function(){return this.$11};c.updateOldestStanzaTime=function(a){(this.$6==null||this.$6>a)&&(this.$6=a)};c.updateOfflineCount=function(a){this.$3=a.message,this.$4=a.receipt,this.$5=a.notification};c.updateOfflineDecryptionErrorCount=function(a){this.$8=a};c.updateProcessedMessageCount=function(){d("WAWebRuntimeEnvironmentUtils").isWorker()&&(this.$9+=1)};c.updateProcessedNotificationCount=function(){d("WAWebRuntimeEnvironmentUtils").isWorker()&&(this.$10+=1)};c.logWorkerInitialized=function(a){this.$11=d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PAGE_LOAD,this.$2=a,this.$13(d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PAGE_LOAD,0)};c.logSocketConnect=function(){this.$11=d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.SOCKET_CONNECT;var a=Math.floor(self.performance.now()-this.pageLoadT);this.socketConnectT=a;this.$13(d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.SOCKET_CONNECT,a)};c.logOfflinePreview=function(){this.$11=d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.OFFLINE_PREVIEW;var a=Math.floor(self.performance.now()-this.pageLoadT);this.offlinePreviewT=a;this.$13(d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.OFFLINE_PREVIEW,a);this.$16()};c.logProcessComplete=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a;if(this.$11===d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_COMPLETE||this.$11===d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_INTERRUPTED)return;this.$11=d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_COMPLETE;(a=this.$7)==null?void 0:a.cancel();this.$7=null;a=d("WAWebWamOfflineResumeReporter").countDays(this.$6);yield d("WAWebUserPrefsMultiDevice").setRecentMailboxAgeDays(a);var b=Math.floor(self.performance.now()-this.pageLoadT);this.processCompleteT=b;this.$17(a);this.$13(d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_COMPLETE,b);void d("WAWebUserPrefsGeneral").setLastPushCompleteTimestamp(d("WATimeUtils").unixTimeMs())});function c(){return a.apply(this,arguments)}return c}();c.logProcessInterrupted=function(){var a;if(this.$11==null||this.$11===d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_COMPLETE||this.$11===d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_INTERRUPTED)return;this.$11=d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_INTERRUPTED;(a=this.$7)==null?void 0:a.cancel();this.$7=null;a=Math.floor(self.performance.now()-this.pageLoadT);this.processCompleteT=a;this.$17();this.$13(d("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_INTERRUPTED,a)};return a}();c=new a();g.WorkerOfflineResumeReporter=c}),98);
__d("WAWebMessageProcessDBPipeline",["Promise","WALogger","WAWebHandleOrphansForNewMsg","WAWebMessageProcessorCache","WAWebWamWorkerOfflineProcessReporter","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["processRenderableMessages write to DB from cache, failed with error: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["process msgs orphans ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[unify][message] processing messages in cache completed"]);k=function(){return a};return a}function a(a,c){return d("WAWebMessageProcessorCache").messageProcessorCache.addMessages(a.map(function(a){return{msg:a}}),c).then(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").DEV(k()),d("WAWebWamWorkerOfflineProcessReporter").WorkerOfflineResumeReporter.updateProcessedMessageCount(),c&&(d("WALogger").LOG(j(),a.length),yield (h||(h=b("Promise"))).all(a.map(function(a){return d("WAWebHandleOrphansForNewMsg").handleOrphansForNewMsg(a)})))}))["catch"](function(a){d("WALogger").ERROR(i(),a).tags("messaging").sendLogs("processRenderableMessages write to DB from cache, failed")})}g.processMsgDataDBPipeline=a}),98);
__d("WAWebGetGroupAddressingMode",["WAWebDBGroupsGroupMetadata","WAWebHandleMsgCommon","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!a.isGroup())return;a=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(a));if(a==null)return null;return a.isLidAddressingMode==null?d("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.pn:a.isLidAddressingMode?d("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.lid:d("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.pn});return h.apply(this,arguments)}function c(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Map(),c=(yield d("WAWebDBGroupsGroupMetadata").bulkGetGroupMetadata(a));a.map(function(a,e){if(!a.isGroup()){b.set(a.toString(),null);return}e=c[e];e!=null?b.set(e.id,e.isLidAddressingMode===!0?d("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.lid:d("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.pn):b.set(a.toString(),null)});return b});return i.apply(this,arguments)}g.getGroupAddressingMode=a;g.bulkGetGroupAddressingMode=c}),98);
__d("WAWebMessageProcessorCache",["Promise","WALogger","WANullthrows","WAShiftTimer","WAWebABProps","WAWebDBCreateLidPnMappings","WAWebDBReportingTokenUtils","WAWebGetGroupAddressingMode","WAWebGroupDatabaseJob","WAWebGroupHandleAddressingModeMismatch","WAWebHandleMessageTypes.flow","WAWebPromiseQueue","WAWebSendOfflineDeliveryReceiptJob","WAWebSignalProtocolStore","WAWebSignalStorageUtils","WAWebSignalStoreApi","WAWebStoreMsgs","WAWebWamEnumMismatchOriginType","WAWebWidFactory","asyncToGeneratorRuntime","justknobx"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[unify][message-cache]: aggregated receipts sent for "," - ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[unify][message-cache]: signal key store updated for "," - ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[unify][message-cache]: messages added to table for "," - ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["MessageProcessorCache: missing doneFn"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[unify][message-cache]: creating snapshot for "," - "," messages"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[unify][message-cache]: flushing due to max size reached: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[unify][offline][message-cache]: adding to cache (current length: ",", next checkpoint index: ","): ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[unify][online][message-cache]: flushing immediately"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[unify][message-cache]: flushing cache due to timeout"]);q=function(){return a};return a}function r(){return d("WAWebABProps").getABPropConfigValue("web_message_processing_cache_size")}function s(){return t()>0}function t(){return d("WAWebABProps").getABPropConfigValue("web_offline_message_processor_timeout_seconds")}a=function(){function a(){var a=this;this.cache=[];this.additionalInfoCache=[];this.checkpointQueue=new(d("WAWebPromiseQueue").PromiseQueue)();this.nextCheckpointIndex=0;this.checkpointPromises=new Map();this.flushImmediately=!1;this.snapshotTimer=new(d("WAShiftTimer").ShiftTimer)(function(){d("WALogger").LOG(q()),a.createSnapshot()})}var e=a.prototype;e.size=function(){return this.cache.length};e.addMessages=function(a,b){var c;b===void 0&&(b=!1);(c=this.cache).push.apply(c,a);c=this.$1();if(b){d("WALogger").DEV(p());this.flushImmediately=!0;this.createSnapshot();return c}this.flushImmediately=!1;d("WALogger").DEV(o(),this.cache.length,this.nextCheckpointIndex,a.map(function(a){var b;return a.msg!=null?"msg "+((b=a.msg)==null?void 0:(b=b.id)==null?void 0:b.toString()):"receipt "+(((b=a.receiptInfo)==null?void 0:b.externalId)||"")}));if(this.cache.length>=r()){d("WALogger").DEV(n(),this.cache.length);this.createSnapshot();return c}s()&&!this.snapshotTimer.isScheduled()&&this.snapshotTimer.onOrBefore(t()*1e3);return c};e.addAdditionalInfo=function(a,b){b===void 0&&(b=!1);this.additionalInfoCache.push(a);if(b){a=this.additionalInfoCache;this.additionalInfoCache=[];void this.$2(a)}};e.handleChangedAddressingMode=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=new Map();a.forEach(function(b){b=b.msg;if(b!=null&&b.id.remote.isGroup()){var a=b==null?void 0:b.groupAddressingMode;a!=null&&e.set(b.id.remote.toString(),a)}});var f=(yield d("WAWebGetGroupAddressingMode").bulkGetGroupAddressingMode(Array.from(e.keys()).map(d("WAWebWidFactory").createWid)));a=[];for(var g of e.entries()){var i=g[0],j=g[1];f.get(i)!==j&&a.push(d("WAWebWidFactory").createWid(i))}this.flushImmediately||(yield d("WAWebGroupDatabaseJob").bulkMarkGroupParticipantStaleJob(a));yield (h||(h=b("Promise"))).all(a.map(function(a){return d("WAWebGroupHandleAddressingModeMismatch").handleAddressingModeMismatch(a,{localAddressingMode:c("WANullthrows")(f.get(a.toString())),serverAddressingMode:c("WANullthrows")(e.get(a.toString())),mismatchOrigin:d("WAWebWamEnumMismatchOriginType").MISMATCH_ORIGIN_TYPE.INCOMING_GROUP_MESSAGE})}))});function e(b){return a.apply(this,arguments)}return e}();e.$1=function(){var a=this,d=this.nextCheckpointIndex;if(!this.checkpointPromises.has(d)){var e,f=function(a){return void 0};this.checkpointPromises.set(d,{promise:new(h||(h=b("Promise")))(function(a,b){e=a,f=b}),markCheckpointDone:function(b){a.checkpointPromises["delete"](c("justknobx")._("2434")?d:a.nextCheckpointIndex);if(b!=null){f(b);return}e()}})}return c("WANullthrows")(this.checkpointPromises.get(d)).promise};e.$3=function(a){var b=[];a.forEach(function(a){a=a.msg;a!=null&&b.push(a)});return d("WAWebStoreMsgs").storeMsgs(b)};e.$2=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.filter(function(a){return a.type===d("WAWebHandleMessageTypes.flow").MsgAdditionalInfoType.ReportingInfo}).map(function(a){return a.data});void d("WAWebDBReportingTokenUtils").handleAddReportingInfos(a)});function c(b){return a.apply(this,arguments)}return c}();e.createSnapshot=function(){var a,c=this,e=this.cache,f=this.additionalInfoCache;this.cache=[];this.additionalInfoCache=[];this.snapshotTimer.isScheduled()&&this.snapshotTimer.cancel();var g=this.nextCheckpointIndex,n=g+e.length;this.nextCheckpointIndex=n;d("WALogger").LOG(m(),g,n);if(e.length===0)return;var o=(a=(a=this.checkpointPromises.get(g))==null?void 0:a.markCheckpointDone)!=null?a:function(a){d("WALogger").ERROR(l()).sendLogs("message-cache-missing-doneFn")},p=d("WAWebSignalProtocolStore").getSignalProtocolStore().generateSnapshot();this.checkpointQueue.enqueue(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{yield (h||(h=b("Promise"))).all([c.$3(e),d("WAWebDBCreateLidPnMappings").flushLidPnMappingsToDb()]),d("WALogger").LOG(k(),g,n),p!=null&&(yield d("WAWebSignalStorageUtils").getStorage().lock(["session-store","identity-store","prekey-store","senderkey-store"],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield (h||(h=b("Promise"))).all([d("WAWebSignalStoreApi").waSignalStore.bulkPutSession(p.sessionUpdate),d("WAWebSignalStoreApi").waSignalStore.bulkPutIdentityKeyWithRowId(p.identityUpdate),d("WAWebSignalStoreApi").waSignalStore.bulkPutSenderKey(p.senderKeyUpdate),d("WAWebSignalStoreApi").waSignalStore.bulkRemovePreKey(p.preKeyRemove),d("WAWebSignalStoreApi").waSignalStore.bulkRemoveSession(p.sessionRemove),d("WAWebSignalStoreApi").waSignalStore.bulkRemoveIdentity(p.identityRemove)])})),d("WALogger").LOG(j(),g,n)),yield d("WAWebSendOfflineDeliveryReceiptJob").sendAggregateOfflineReceipts(e),yield c.$2(f),d("WALogger").LOG(i(),g,n)}catch(a){o(a);return}o()}));d("WAWebABProps").getABPropConfigValue("lid_groups_handle_server_addressing_mode")&&void this.handleChangedAddressingMode(e)};return a}();e=new a();g.messageProcessorCache=e}),98);
__d("WAWebApiMessageInfoStore",["WAJids","WALogger","WAWebAck","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebModelStorageUtils","WAWebMsgKey","WAWebSchemaMessage","WAWebSchemaMessageInfo","WAWebUserPrefsMeUser","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["queryMsgInfo: targetedMsgInfoKey: ",", ack count: ",", receiver: ",",\n        played: ",", read: ",", delivery: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["MessageInfoStore: ",", ",":"," has been delivered"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["MessageInfoStore: ",", ",":",": primary identity change after message has been delivered"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["MessageInfoStore: ",", ",":",": companion identity changed"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["MessageInfoStore: missing record for ",", ",""]);l=function(){return a};return a}var m=[d("WAWebAck").ACK_STRING.PLAYED,d("WAWebAck").ACK_STRING.READ,d("WAWebAck").ACK_STRING.DELIVERY],n=Object.freeze({ELIGIBLE:"ELGIBLE",INELIGIBLE_RECORD_MISSING:"INELIGIBLE_RECORD_MISSING",INELIGIBLE_ALREADY_DELIVERED:"INELIGIBLE_ALREADY_DELIVERED",INELIGIBLE_NOT_MD:"INELIGIBLE_NOT_MD",INELIGIBLE_CHANGED_IDENTITY:"INELIGIBLE_CHANGED_IDENTITY"});function a(a){var c=new Map();a.forEach(function(a){var b=a.msgKey;a=a.receiverId;var e=d("WAWebWidFactory").toUserWid(a).toString();b=b.toString();var f=b+","+e;a=(a=a.device)!=null?a:d("WAJids").DEFAULT_DEVICE_ID;var g=c.get(f);!g?c.set(f,{msgKey:b,receiverUserJid:e,deviceDelivered:[],deviceNotDelivered:[a]}):g.deviceNotDelivered.push(a)});return d("WAWebModelStorageUtils").getStorage().lock(["message-info"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=Array.from(c.values()).map(function(a){return[a.msgKey,a.receiverUserJid]});a=(yield a.anyOf(["msgKey","receiverUserJid"],b));a.forEach(function(a){var b=a.msgKey+","+a.receiverUserJid,d=c.get(b);d&&c.set(b,babelHelpers["extends"]({},a,{deviceNotDelivered:[].concat(a.deviceNotDelivered,d.deviceNotDelivered)}))});return d("WAWebSchemaMessageInfo").getMessageInfoTable().bulkCreateOrReplace(Array.from(c.values()))});return function(b){return a.apply(this,arguments)}}())}function e(a,b,c,e){var f=d("WAWebWidFactory").toUserWid(b).toString(),g=b.device||0;return d("WAWebSchemaMessageInfo").getMessageInfoTable().get([a.toString(),f]).then(function(h){if(!h){d("WALogger").LOG(l(),a.toString(),f);return n.INELIGIBLE_RECORD_MISSING}else if(h.deviceNotDelivered.includes(g)){if(c!=null&&e>=c)return n.ELIGIBLE;if(b.device!=null&&b.device!==d("WAJids").DEFAULT_DEVICE_ID){d("WALogger").LOG(k(),a.toString(),f,g);return n.INELIGIBLE_CHANGED_IDENTITY}else if(h.delivery!=null){d("WALogger").LOG(j(),a.toString(),f,g);return n.INELIGIBLE_CHANGED_IDENTITY}return n.ELIGIBLE}d("WALogger").LOG(i(),a.toString(),f,g);return n.INELIGIBLE_ALREADY_DELIVERED})}function f(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield p([a]));b=b.get(a.toString());if(!b)throw c("err")("No message info found for "+a.toString());return b});return o.apply(this,arguments)}function p(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet(a.map(function(a){return a.toString()}))),e=new Map(),f=new Map();for(var g=0;g<a.length;g++){var h,i=a[g].toString();h=(h=(h=b[g])==null?void 0:h.latestEditMsgKey)!=null?h:i;f.set(h,i);var j={messageInfoRecords:[],ackReceiver:b[g]?b[g].count:null};e.set(h,j);if((d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()||d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.shouldApplyNonMigratedMessagingRules())&&a[g].remote.isUser()){h=(h=d("WAWebLidMigrationUtils").getAlternateMsgKey(c("WAWebMsgKey").from(h)))==null?void 0:h.toString();h!=null&&(f.set(h,i),e.set(h,j))}}i=(yield d("WAWebSchemaMessageInfo").getMessageInfoTable().anyOf(["msgKey"],Array.from(e.keys())));i.forEach(function(a){var b;(b=e.get(a.msgKey))==null?void 0:b.messageInfoRecords.push(a)});h=r(e);j=new Map();for(g of h){b=g[0];a=g[1];i=f.get(b);i!=null&&j.set(i,a)}return j});return q.apply(this,arguments)}function r(a){var b=new Map(),e=function(a){var e=a[0];a=a[1];var f=a.ackReceiver;a=a.messageInfoRecords;var g=0,i={delivery:[],deliveryRemaining:0,played:[],playedRemaining:0,read:[],readRemaining:0},j=!1;a.forEach(function(a){var b=d("WAWebWidFactory").createWid(a.receiverUserJid);if(d("WAWebUserPrefsMeUser").isMeAccount(b))return;s(a);for(var f=0;f<m.length;f++){var h=m[f],k=a[h];if(k!=null){i[h].push({id:b,t:k});k=c("WAWebWid").isGroup(c("WAWebMsgKey").fromString(e).remote);k&&h==="read"&&(b==null?void 0:b.isBot())&&(j=!0);if(k)break}}a.delivery!=null&&a.deliveryPrivacyMode!=null&&(i.deliveryPrivacyMode=a.deliveryPrivacyMode);g+=1});a=f!=null&&f!==0?f:g;j&&a++;d("WALogger").LOG(h(),e,f,a,i.played.length,i.read.length,i.delivery.length);i.playedRemaining=a-i.played.length;i.readRemaining=i.playedRemaining-i.read.length;i.deliveryRemaining=i.readRemaining-i.delivery.length;b.set(e,i)};for(a of a.entries())e(a);return b}function s(a){var b=a.read;b!=null&&(a.delivery==null||a.delivery>b)&&(a.delivery=b)}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Map(),c=(yield p(a));for(a of a){var e=c.get(a.toString());if(e==null)continue;var f=void 0;e.playedRemaining===0&&e.played.length>0?f=d("WAWebAck").ACK.PLAYED:e.readRemaining===0&&e.read.length>0?f=d("WAWebAck").ACK.READ:e.deliveryRemaining===0&&e.delivery.length>0&&(f=d("WAWebAck").ACK.RECEIVED);f!=null&&b.set(a.toString(),f)}return b});return u.apply(this,arguments)}g.RetryEligibilityResult=n;g.createOrMergeReceiptRecords=a;g.isRetryEligible=e;g.queryMsgInfo=f;g.queryMsgInfos=p;g.getHighestMsgAcks=t}),98);
__d("WAWebSchemaPeerReadReceipt",["WAWebOffdStorageUtils","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addAutoIncrementingPrimaryKey;function a(){d("WAWebOffdStorageUtils").getStorage().add("peer-read-receipt").version(d("WAWebOffdStorageUtils").getStorage().versions.version(2),[i("id"),h("msgKeys"),h("ts"),h("ack")]).view(function(a){return a})}function b(){return d("WAWebOffdStorageUtils").getStorage().table("peer-read-receipt")}g.addTable=a;g.getTable=b}),98);
__d("WAWebMessageReceiptBatcher",["Promise","WABatcher","WAJids","WALogger","WAPromiseMap","WAWebAck","WAWebApiMessageInfoStore","WAWebBackendApi","WAWebDBBulkGetRootMsgs","WAWebHandleMsgReceiptCommon","WAWebHandlePrivacyModeUpdateMsgAction","WAWebModelStorageUtils","WAWebMsgKey","WAWebNoop","WAWebSchemaMessage","WAWebSchemaMessageInfo","WAWebSchemaPeerReadReceipt","WAWebUserPrefsMeUser","WAWebWidFactory","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime","lodash"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[unify][batcher]: process peer receipts batch: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["_processOtherReceipts: failed to process privacy mode updates"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[unify][batcher] process other receipts batch: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[unify][batcher]: receipt has unsupported ack type ",""]);l=function(){return a};return a}var m=Object.freeze((a={},a[(e=d("WAWebAck")).ACK.SENT]=e.ACK_STRING.DELIVERY,a[e.ACK.RECEIVED]=e.ACK_STRING.DELIVERY,a[e.ACK.READ]=e.ACK_STRING.READ,a[e.ACK.PLAYED]=e.ACK_STRING.PLAYED,a[e.ACK.INACTIVE]=e.ACK_STRING.INACTIVE,a)),n={delayMs:1e3};f=function(){function a(){var a=this;this.$1=d("WABatcher").createSimpleBatcher(n,function(b){return a.$2(b).then(function(){return[]})});this.$3=d("WABatcher").createSimpleBatcher(n,function(b){return a.$4(b).then(function(){return[]})})}var e=a.prototype;e.acceptPeerReceipt=function(a){return this.$1.accept(a)};e.acceptOtherReceipt=function(a){return this.$3.accept(a)};e.runActiveBatches=function(){return(h||(h=b("Promise"))).all([this.$1.runActiveBatch(),this.$3.runActiveBatch()]).then(c("WAWebNoop"))};e.$5=function(a){var b=[];for(a of a){var e=a.ack,f=a.privacyMode,g=a.msgKeys,h=a.receiverId;e===d("WAWebAck").ACK.RECEIVED&&f!=null&&b.push({remote:h,deliveryPrivacyMode:f,msgKeys:g.map(function(a){return c("WAWebMsgKey").from(a)})})}return b};e.$6=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAPromiseMap").promiseMap(a,function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebHandlePrivacyModeUpdateMsgAction").handlePrivacyModeTransition(a.remote,a.deliveryPrivacyMode),yield d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("updateBizPrivacyStatus",{msgIds:a.msgKeys,privacyMode:a.deliveryPrivacyMode})});return function(b){return a.apply(this,arguments)}}())});function c(b){return a.apply(this,arguments)}return c}();e.$7=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=this.$8(a);b=b.map(function(a){return c("WAWebMsgKey").from(a)}).filter(function(a){return a.remote.isGroup()||a.remote.isStatus()||a.remote.isBot()});b=(yield d("WAWebApiMessageInfoStore").getHighestMsgAcks(b));for(b of b.entries()){var e=b[0],f=b[1];a.set(e,f)}return a});function e(b,c){return a.apply(this,arguments)}return e}();e.$8=function(a){var b=new Map();for(a of a){var d=a.msgKeys,e=a.ack,f=a.isBotInvoke,g=a.isSender;for(d of d)if(c("WAWebMsgKey").from(d).remote.isUser()&&f!==!0&&g!==!0){var h;b.set(d,Math.max(e,(h=b.get(d))!=null?h:Number.NEGATIVE_INFINITY))}}return b};e.$9=function(a){var b=new Map();a.forEach(function(a){var c=a.ack,e=a.ts,f=a.receiverId;a=a.msgKeys;var g=f.isNewsletter()?f.toJid():d("WAWebWidFactory").toUserWid(f).toString(),h=(f=f.device)!=null?f:d("WAJids").DEFAULT_DEVICE_ID;a.forEach(function(a){var f=m[c.toString()];if(f==null){d("WALogger").WARN(l(),c);return}a=a+","+g;var i=b.get(a);if(!i){b.set(a,(a={},a[f]=e,a.deviceDelivered=new Set([h]),a))}else f!==m[d("WAWebAck").ACK.INACTIVE]&&(i[f]=q(i[f],e)),i.deviceDelivered.add(h)})});return Array.from(b,function(a){var b=a[0];a=a[1];b=b.split(",");var c=b[0];b=b[1];return[[c,b],a]})};e.$4=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=this,f=this.$9(a),g=Array.from(new Set(c("lodash").flatMap(a,function(a){return a.msgKeys}))),i=(yield d("WAWebModelStorageUtils").getStorage().lock(["message-info","message","chat"],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var i=(yield (h||(h=b("Promise"))).all([d("WAWebSchemaMessageInfo").getMessageInfoTable().bulkGet(f.map(function(a){var b=a[0];a[1];return b})),d("WAWebDBBulkGetRootMsgs").bulkGetRootMsgs(g,!1)])),j=i[0],l=i[1],m=new Map(g.map(function(a,b){return[a,l[b]]}));i=j.map(function(a,b){b=f[b];var c=b[0],d=c[0];c=c[1];b=b[1];if(!b)return null;if(!a)return{delivery:b.delivery,read:b.read,played:b.played,msgKey:d,receiverUserJid:c,deviceDelivered:Array.from(b.deviceDelivered),deviceNotDelivered:[]};var e=b.deviceDelivered;a.deviceDelivered.forEach(function(a){return e.add(a)});return{delivery:q(a.delivery,b.delivery),read:q(a.read,b.read),played:q(a.played,b.played),msgKey:a.msgKey,receiverUserJid:a.receiverUserJid,deviceDelivered:Array.from(e),deviceNotDelivered:a.deviceNotDelivered.filter(function(a){return!e.has(a)})}}).filter(Boolean);d("WALogger").DEV(k(),JSON.stringify(i));yield d("WAWebSchemaMessageInfo").getMessageInfoTable().bulkCreateOrReplace(i);j=(yield e.$7(a,g));i=Array.from(j.entries()).map(function(a){var b=a[0];a=a[1];var d=c("WAWebMsgKey").fromString(b);d=d.remote;if(d.isUser()||d.isGroup()||d.isStatus()){d=m.get(b);if(d==null)return;if(a>((b=d.ack)!=null?b:Number.NEGATIVE_INFINITY))return{id:d.id.toString(),ack:a}}}).filter(Boolean);return{ackUpdates:i,receiptMsgKeyToMsg:m}})));yield d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(i.ackUpdates);d("WAWebBackendApi").frontendFireAndForget("updateMsgModelAcks",{updates:i.ackUpdates.map(function(a){var b=a.id;a=a.ack;return{id:c("WAWebMsgKey").from(b),ack:a}})});d("WAWebBackendApi").frontendFireAndForget("updateMsgInfo",{updates:c("lodash").flatMap(a,function(a){var b=a.msgKeys,e=a.ack,f=a.ts,g=a.receiverId;return b.map(function(a){a=i.receiptMsgKeyToMsg.get(a);if(a==null)return;a=c("WAWebMsgKey").from(a.id);if(!a.fromMe)return;if(!(a.remote.isUser()||a.remote.isGroup()||a.remote.isStatus()))return;var b=d("WAWebWidFactory").toUserWid(g);if(b.equals(d("WAWebUserPrefsMeUser").getMeUser()))return;return{msgKey:a,ts:f,participant:b,ack:e}})}).filter(Boolean)});this.$6(this.$5(a))["catch"](function(){d("WALogger").ERROR(j())})});function e(b){return a.apply(this,arguments)}return e}();e.$2=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").DEV(i(),JSON.stringify(a));var b=a.some(function(a){return!a.isOffline});if(b){yield d("WAPromiseMap").promiseMap(a,o);return}b=a.map(function(a){var b=a.ts,c=a.msgKeys;a=a.ack;return{ts:b,msgKeys:c,ack:a}});yield d("WAWebSchemaPeerReadReceipt").getTable().bulkCreate(b)});function c(b){return a.apply(this,arguments)}return c}();return a}();function o(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.msgKeys.map(function(a){return c("WAWebMsgKey").from(a)});if(a.remote.isStatus()){d("WAWebBackendApi").frontendFireAndForget("handleReadStatus",{msgKeys:b});return d("WAWebBackendApi").frontendSendAndReceive("updateMsgPeerAcks",{msgKeys:b,ack:d("WAWebAck").ACK.READ,t:a.ts})}if((a.remote.isUser()||a.remote.isGroup()||a.remote.isNewsletter())&&a.ack>=d("WAWebAck").ACK.RECEIVED)if(a.ack===d("WAWebAck").ACK.READ)return d("WAWebHandleMsgReceiptCommon").updateChatPeerRead(a.remote,b);else if(a.ack===d("WAWebAck").ACK.PLAYED)return d("WAWebBackendApi").frontendSendAndReceive("updateMsgPeerAcks",{msgKeys:b,ack:a.ack,t:a.ts})});return p.apply(this,arguments)}function q(a,b){if(a!=null&&b!=null)return Math.min(a,b);a=(a=a)!=null?a:b;return(b=a)!=null?b:void 0}e=new f();g.receiptBatcher=e}),98);
__d("WAWebOfflineResumeTypes.flow",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({Toastbar:"toastbar",ButterBar:"butterbar",None:"none"});c=b("$InternalEnum").Mirrored(["Blocking","NonBlocking","Worker"]);f.ResumeUIProgressBarType=a;f.ResumeType=c}),66);
__d("WAWebThreadMetadata",["WALogger","WAWebBackendApi"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["processOfflineThreadMeta:"]);h=function(){return a};return a}var i=null;function a(a){d("WALogger").DEV(h()).devConsole(a),i=a,d("WAWebBackendApi").frontendFireAndForget("updateChatPreviewT",{threadMeta:a.chatTimestamp})}function j(){return i}function b(a){var b=j();if(b==null)return;return b.chatTimestamp[a.toString({legacy:!0})]}function c(){var a;a=(a=i)==null?void 0:a.chatTimestamp;a!=null&&d("WAWebBackendApi").frontendFireAndForget("resetChatPreviewT",{chatIds:Object.keys(a)});i=null}g.setOfflineThreadMeta=a;g.getOfflineThreadMetaPreview=j;g.getOfflineMetaPreviewForChat=b;g.resetThreadMeta=c}),98);
__d("WAWebMsgSyncConfiguratedTunnel",["WALogger","WAWebABProps","WAWebMessagePostprocessRenderable","WAWebMsgSyncTunnelConfig","WAWebOfflineHandler","WAWebOfflineResumeTypes.flow","WAWebThreadMetadata","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["msgSyncTunnel: sending bulk UI update with "," messages"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["msgSyncTunnel: sending UI update "," "]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["msgSyncTunnel: sendUIUpdate "," for the accessed chat"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["msgSyncTunnel: cache "," "]);k=function(){return a};return a}var l={CACHE:new Map(),ACTIVE:!1};function m(){var a=l.CACHE,b=l.CACHE;l.CACHE=new Map();l.ACTIVE=!1;return{cache:a,accessedChats:b}}function n(a,b){var c=a.id.remote,e=l.CACHE.get(c.toString());e==null&&(e=[],l.CACHE.set(c.toString(),e));e.push(babelHelpers["extends"]({},b,{msgData:a}));d("WALogger").LOG(k(),a.id.toString())}function o(a){var b=l.CACHE.get(a);l.CACHE["delete"](a);return b}function p(a){var b=d("WAWebMsgSyncTunnelConfig").msgSyncTunnelConfig.openedChat;if(b==null)return!1;a=a.id.remote;return a.equals(b)}function q(a){var b=d("WAWebThreadMetadata").getOfflineMetaPreviewForChat(a.id.remote);return a.t===b}function a(){return{isEnabled:function(){return d("WAWebOfflineHandler").OfflineMessageHandler.getResumeType()!==d("WAWebOfflineResumeTypes.flow").ResumeType.NonBlocking?!1:!0},drainCacheForChat:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=o(a);if(b==null)return;r(b);d("WALogger").LOG(j(),a)});function c(b){return a.apply(this,arguments)}return c}(),completeUIUpdate:function(){var a=m();a=a.cache;a.forEach(function(a,b){r(a)})},accept:function(a){if(!t())return s(a);l.ACTIVE||(l.ACTIVE=!0);var b=a.msgs,c=babelHelpers.objectWithoutPropertiesLoose(a,["msgs"]);a=void 0;b.forEach(function(b){p(b)?(a=s(babelHelpers["extends"]({},c,{msgs:[b]})),d("WALogger").LOG(i(),b.id.toString())):(n(b,c),q(b)&&void u.drainCacheForChat(b.id.remote.toString()))});return a}}}function r(a){if(a.length===0)return;d("WALogger").LOG(h(),a.length);a.forEach(function(a){var b=a.msgData;a=babelHelpers.objectWithoutPropertiesLoose(a,["msgData"]);return s(babelHelpers["extends"]({},a,{msgs:[b]}))})}function s(a){if(d("WAWebABProps").getABPropConfigValue("web_non_blocking_fire_ui_update"))void d("WAWebMessagePostprocessRenderable").postprocessRenderableMessages(a);else return d("WAWebMessagePostprocessRenderable").postprocessRenderableMessages(a)}var t=function(){return!1};function c(){return l}var u=a();g.isMsgSyncTunnelActive=t;g.internal_getTunnelState=c;g.msgSyncTunnel=u}),98);
__d("WAWebMsgSyncTunnelTimeoutUtils",[],(function(a,b,c,d,e,f){function a(a){var b=[],c=null;function d(){c=self.performance.now()}function e(){if(c==null)return b[b.length-1];var d=self.performance.now();d=Math.floor(d-c);c=null;b.length>=a&&b.shift();b.push(d);return d}function f(){if(b.length===0)return 0;var a=b.reduce(function(a,b){return a+b},0);return a/b.length}function g(a){var b=f();return Math.floor(b*(1+a/100))}return{perfStart:d,perfEnd:e,getAverage:f,getAveragePlusNPercent:g,at:function(a){return(a=b.at(a))!=null?a:0}}}f.createPerformanceCache=a}),66);
__d("WAWebMsgSyncTunnelJobThrottler",["WALogger","WAWebMsgSyncTunnelTimeoutUtils","asyncToGeneratorRuntime","lodash"],(function(a,b,c,d,e,f,g){function a(){var b=babelHelpers.taggedTemplateLiteralLoose(["[msg-tunnel] "," done in ",""]);a=function(){return b};return b}function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[msg-tunnel] "," failed ",", cache "," items preserved, error ",""]);h=function(){return a};return a}function e(){var a=babelHelpers.taggedTemplateLiteralLoose(["[msg-tunnel] "," start, cache size: ",""]);e=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[msg-tunnel] "," delayMs is ","ms, config: ","ms"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[msg-tunnel] set "," delayMs to ","ms"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[msg-tunnel] switch "," to debounce"]);k=function(){return a};return a}function f(a,e,f){var g=[],l=e.defaultTimeoutMs,m=d("WAWebMsgSyncTunnelTimeoutUtils").createPerformanceCache(3),n=!1;function o(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b===void 0&&(b=!1);if(g.length===0)return;if(n&&!b)return;n=!0;b=g;g=[];m.perfStart();try{yield f(b)}catch(c){g=b.concat(g),d("WALogger").WARN(h(),a,m.perfEnd(),b.length,c).sendLogs("msg-tunnel-"+a+"-failed",{sampling:.01})}n=!1;b=m.perfEnd();if(b==null)return;if(e.defaultTimeoutMs<b){var c=15;if(l>b){var i=m.getAveragePlusNPercent(c);if(i<b)return;r(i);return}b=m.getAveragePlusNPercent(c);if(l+100>=b)return;r(b)}});return p.apply(this,arguments)}var q=c("lodash").throttle(o,l,{leading:!1,trailing:!0,maxWait:e.maxWait});function r(b){var f=l;l=Math.min(b,(b=e.debounceThreshold)!=null?b:15e3);if(l===e.debounceThreshold){if(f===l)return;q.cancel();q=c("lodash").debounce(o,l,{leading:!1,trailing:!0,maxWait:e.maxWait});d("WALogger").LOG(k(),a)}else q.cancel(),q=c("lodash").throttle(o,l,{leading:!1,trailing:!0,maxWait:e.maxWait});d("WALogger").LOG(j(),a,l);l>12e3&&d("WALogger").WARN(i(),a,l,e.defaultTimeoutMs).sendLogs("msg-tunnel-"+a+"-exceeds-12s",{sampling:.01})}return{take:function(a){g.push(a),void q()},forceDrain:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield o(!0),r(e.defaultTimeoutMs)});function c(){return a.apply(this,arguments)}return c}()}}g.createJobThrottler=f}),98);
__d("WAWebMsgSyncTunnelBatcher",["Promise","WALogger","WAWebABProps","WAWebAddonLogUtils","WAWebCmd","WAWebMessagePostprocessRenderable","WAWebMessageProcessDBPipeline","WAWebMsgSyncTunnelJobThrottler","WAWebOfflineHandler","WAWebOfflineResumeTypes.flow","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["failed incoming addons processing"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["failed storing messages ",""]);j=function(){return a};return a}function a(){var a,c=d("WAWebMsgSyncTunnelJobThrottler").createJobThrottler("write-db",{defaultTimeoutMs:(a=d("WAWebABProps").getABPropConfigValue("web_msg_sync_update_tunnel_timeout_ms"))!=null?a:500,debounceThreshold:5e3},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(d("WAWebABProps").getABPropConfigValue("web_msg_sync_update_tunnel_store_before_postprocess"))try{a=a.reduce(function(a,b){return a.concat(b.msgs)},[]);yield d("WAWebMessageProcessDBPipeline").processMsgDataDBPipeline(a,!0)}catch(a){d("WALogger").ERROR(j(),a).tags("messaging").sendLogs("msg-tunnel-storing-failure")}});return function(b){return a.apply(this,arguments)}}()),e=d("WAWebMsgSyncTunnelJobThrottler").createJobThrottler("update-ui",{defaultTimeoutMs:(a=d("WAWebABProps").getABPropConfigValue("web_msg_sync_update_tunnel_timeout_ms"))!=null?a:500,maxWait:5e3},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield (h||(h=b("Promise"))).allSettled(a.map(d("WAWebMessagePostprocessRenderable").postprocessRenderableMessages)));d("WAWebAddonLogUtils").hasSettledWithError(a)&&d("WALogger").ERROR(i()).tags("messaging").sendLogs("msg-tunnel-renderable-msgs-processing")});return function(b){return a.apply(this,arguments)}}()),f=function(a){e.take(a),c.take(a)},g=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield c.forceDrain(),yield e.forceDrain()});return function(){return a.apply(this,arguments)}}(),k=function(){var a=d("WAWebOfflineHandler").OfflineMessageHandler.getResumeType();return a===d("WAWebOfflineResumeTypes.flow").ResumeType.NonBlocking?d("WAWebABProps").getABPropConfigValue("web_msg_sync_update_tunnel"):!1};return{isEnabled:k,isActive:function(){return d("WAWebCmd").Cmd.isOfflineDeliveryEnd?!1:k()},accept:function(a){d("WAWebABProps").getABPropConfigValue("web_msg_sync_update_tunnel_store_before_postprocess")||void d("WAWebMessageProcessDBPipeline").processMsgDataDBPipeline(a.msgs,!1),f(a)},drain:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield g()});function c(){return a.apply(this,arguments)}return c}()}}c=a();g.nonBlockingMsgsSyncTunnel=c}),98);
__d("WAWebMsgSyncTunnelConfig",["WALogger","WAWebMsgSyncConfiguratedTunnel"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Active chat out of sync closed: ",", cached: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["msgSyncTunnel: set new config"]);i=function(){return a};return a}var j={openedChat:null};function k(a){d("WALogger").LOG(i()).devConsole({newConfig:a,oldConfig:babelHelpers["extends"]({},j)});Object.assign(j,a);if(a.openedChat!=null&&d("WAWebMsgSyncConfiguratedTunnel").internal_getTunnelState().ACTIVE){if(j.openedChat==null)return;void d("WAWebMsgSyncConfiguratedTunnel").msgSyncTunnel.drainCacheForChat(j.openedChat.toString())}}function a(a){if(!a)return;if(!d("WAWebMsgSyncConfiguratedTunnel").isMsgSyncTunnelActive())return;var b=j.openedChat;if(b==null)return;b.equals(a)||d("WALogger").WARN(h(),a,j.openedChat).sendLogs("msg_sync_tunnel_config_out_of_sync");k({openedChat:null})}function b(){if(!d("WAWebMsgSyncConfiguratedTunnel").isMsgSyncTunnelActive())return;k({openedChat:null})}g.msgSyncTunnelConfig=j;g.setMsgSyncTunnelConfig=k;g.resetMsgSyncTunnelOpenedChat=a;g.resetMsgSyncTunnelConfig=b}),98);
__d("WAWebProcessMatMessages",["WANullthrows","WAWebApiChat","WAWebMsgGetters","WAWebMsgKey","WAWebMsgType","WAWebPnhGatingUtils","WAWebWid","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=[],f=[];a=a.filter(function(a){var b=c("WANullthrows")(a.id.remote,"message key must have a remote");b.isUser()?f.push(b):e.push(a);return b.isUser()});var g=a.filter(function(a){return a.subtype==="sender_revoke"}),h=[];g.forEach(function(a){a=a.protocolMessageKey;a&&(h.push(a),a.remote.isUser()&&f.push(a.remote))});var i=(yield d("WAWebApiChat").getMatChatBulk_DEPRECATED(f)),j=new Map();g.forEach(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.protocolMessageKey;if(b!=null){var d=(yield i.get(b.remote));if(d!=null&&!c("WAWebWid").equals(d,b.remote)){b=c("WAWebMsgKey").from({fromMe:b.fromMe,id:b.id,participant:b.participant,remote:d});j.set(a.id.id,b)}}});return function(b){return a.apply(this,arguments)}}());a.forEach(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(b=(yield i.get((b=a.id.remote)!=null?b:a.from)))!=null?b:a.id.remote;if(b.isSameAccount(a.id.remote)){e.push(a);return}var f=c("WAWebMsgKey").from({fromMe:a.id.fromMe,id:a.id.id,participant:a.id.participant,remote:b});if(a.subtype==="sender_revoke"){var g;e.push(babelHelpers["extends"]({},a,{id:f,kind:d("WAWebMsgType").MsgKind.ProtocolRevoke,protocolMessageKey:(g=j.get(a.id.id))!=null?g:a.protocolMessageKey,from:a.id.fromMe?a.from:b}))}else e.push(babelHelpers["extends"]({},a,{id:f,from:a.id.fromMe?a.from:b}));d("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("incrementPnhCtwaDailyCount",{chatId:b})});return function(b){return a.apply(this,arguments)}}());return e});return h.apply(this,arguments)}function i(a,b,d){d=c("WAWebMsgKey").from({fromMe:d.fromMe,id:d.id,participant:d.participant,remote:b});a=c("WAWebMsgKey").from({fromMe:a.fromMe,id:a.id,participant:a.participant,remote:b});return{newMsgKey:a,newParentMsgKey:d}}function e(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return n(a,"reactionParentKey")});return j.apply(this,arguments)}function f(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return n(a,"protocolMessageKey")});return k.apply(this,arguments)}function l(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return n(a,"pollUpdateParentKey")});return m.apply(this,arguments)}function n(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e;e=(e=a.id.remote)!=null?e:a.from;if(!e.isUser())return a;var f=(yield d("WAWebApiChat").getMatChat_DEPRECATED(e)),g=a[b];if(f==null||g==null||!(g instanceof c("WAWebMsgKey"))||f.isSameAccount(e))return a;e=i(a.id,f,g);g=e.newMsgKey;e=e.newParentMsgKey;d("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("incrementPnhCtwaDailyCount",{chatId:f});return babelHelpers["extends"]({},a,(g={id:g},g[b]=e,g.from=a.id.fromMe?a.from:f,g))});return o.apply(this,arguments)}function p(a){var b=new Set(),e=new Map();d("WAWebPnhGatingUtils").isMatFullyEnabled()&&a.forEach(function(a){var f=c("WANullthrows")(a.pollUpdateParentKey);a=d("WAWebMsgGetters").getOriginalSender(a);if(f!=null&&a!=null&&f.remote.isUser()&&!a.isSameAccount(f.remote)){a=c("WAWebMsgKey").from({fromMe:f.fromMe,id:f.id,participant:f.participant,remote:a});b.add(a.toString());e.set(f.toString(),a)}});return{matParentMsgKeys:b,alternateWidMap:e}}g.processRenderableMatMessages_DEPRECATED=a;g.processReactionMatMessages=e;g.processEditMatMessages=f;g.processPollUpdateMatMessages=l;g.processAddonMatMessages=n;g.getAlternateWidMapForPolls=p}),98);
__d("WAWebL10NConstants",[],(function(a,b,c,d,e,f){a={DEBUG:99,SAVED:6,PHONE:5,PREVIOUS:4,URL:3,BROWSER:2,DEFAULT:1};b="en";c="en-US";d=new Set(["ur"]);e=new Set(["af","az","ca","cs","da","de","el","et","fi","fr","he","hr","hu","id","it","kk","lt","mk","nb","pl","pt","pt-BR","ro","ru","sk","sl","sr","sv","th","tr","uk"]);var g={"zh-tw":{longDateFormat:{LT:"Ah:mm",LTS:"Ah:m:s",L:"YYYY\u5e74MMMD\u65e5",LL:"YYYY\u5e74MMMD\u65e5",LLL:"YYYY\u5e74MMMD\u65e5LT",LLLL:"YYYY\u5e74MMMD\u65e5ddddLT",l:"YYYY\u5e74MMMD\u65e5",ll:"YYYY\u5e74MMMD\u65e5",lll:"YYYY\u5e74MMMD\u65e5LT",llll:"YYYY\u5e74MMMD\u65e5ddddLT"}},"zh-cn":{longDateFormat:{LT:"Ah:mm",LTS:"Ah:m:s",L:"YYYY-MM-DD",LL:"YYYY\u5e74MMMD\u65e5",LLL:"YYYY\u5e74MMMD\u65e5LT",LLLL:"YYYY\u5e74MMMD\u65e5ddddLT",l:"YYYY\u5e74MMMD\u65e5",ll:"YYYY\u5e74MMMD\u65e5",lll:"YYYY\u5e74MMMD\u65e5LT",llll:"YYYY\u5e74MMMD\u65e5ddddLT"}},ar:{longDateFormat:{LT:"h:mm A",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"}},ta:{longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY, h:mm A"},preparse:null,postformat:null,meridiem:null,meridiemHour:null},nl:{longDateFormat:{l:"DD-MM-YYYY",L:"DD-MM-YYYY"}},"en-ie":{longDateFormat:{l:"DD/MM/YYYY",L:"DD/MM/YYYY"}},hi:{preparse:function(a){return a},postformat:function(a){return a},longDateFormat:{LT:"A h:mm \u092c\u091c\u0947",LTS:"A h:mm:ss \u092c\u091c\u0947",LLL:"D MMMM YYYY A h:mm \u092c\u091c\u0947",LLLL:"dddd, D MMMM YYYY, A h:mm \u092c\u091c\u0947"},meridiem:function(a,b,c){if(a===0&&b===0)return"\u092e\u0927\u094d\u092f\u0930\u093e\u0924\u094d\u0930\u093f";if(a>=20||a<4)return"\u0930\u093e\u0924";if(a>=4&&a<12)return"\u0938\u0941\u092c\u0939";return a>=12&&a<16?"\u0926\u094b\u092a\u0939\u0930":"\u0936\u093e\u092e"}}},h={"pt-pt":{weekdays:["Domingo","Segunda-feira","Ter\xe7a-feira","Quarta-feira","Quinta-feira","Sexta-feira","S\xe1bado"]}};h=babelHelpers["extends"]({},g,h);var i=!1;i=i;f.L10N_PRIORITY=a;f.DEFAULT_LOCALE=b;f.DEFAULT_MOMENT_LOCALE=c;f.SHOULD_USE_MOMENT_LOCALE_FORMAT=d;f.LOCALES_THAT_PREFER_24HOUR_TIME=e;f.LOCALE_DATE_TIME_CUSTOMIZATIONS=g;f.LOCALE_CUSTOMIZATIONS=h;f.MARK_TRANSLATIONS_ENABLED=i}),66);
__d("WAWebWamEnumPlatformType",[],(function(a,b,c,d,e,f){a=Object.freeze({IPHONE:1,ANDROID:2,BB:3,BBX:7,S40:4,SYMBIAN:5,WP:6,WEBCLIENT:8,OSMETA:11,ENT:12,SMBA:13,KAIOS:14,SMBI:15,WINDOWS:16,WEB:17,PORTAL:18,BLOKS:19,BLUEA:20,BLUEI:21,FBLITEA:22,GREENA:23,GREENI:24,IGDA:25,IGDI:26,IGLITEA:27,MLITEA:28,MSGRA:29,MSGRI:30,MSGRP:31,MSGRW:32,IGDW:33,PAGE:34,MSGRDM:35,MSGRDW:36,MSGROM:37,MSGROC:38,MSGRM:43,IGDM:44,WEARM:45,CAPI:46,XR:47,MACOS:48,WAMETA_REPL:49,ARDEV:50,WEAROS:51,MSGRVR:52,BLUEW:53,IPHONEWAMETATEST:54,MSGRAR:57,IPAD:58,WAVOIP_CLI:59,MSGRT:60,IGDT:61,ANDROIDWAMETATEST:62,MSGRSG:63,IGDSG:64,INTEROP:65,INTEROP_MSGR:66,IGDVR:67,TEST:9,UNKNOWN:10});f.PLATFORM_TYPE=a}),66);
__d("WAWebWamEnumAppBuildType",[],(function(a,b,c,d,e,f){a=Object.freeze({DEBUG:1,ALPHA:2,BETA:3,RELEASE:4});f.APP_BUILD_TYPE=a}),66);
__d("WAWebWamEnumDeviceClassification",[],(function(a,b,c,d,e,f){a=Object.freeze({MOBILE:0,TABLET:1,WEARABLES:2,VR:3,DESKTOP:4,FOLDABLE:5,AR_GLASS:6,UNDEFINED:100});f.DEVICE_CLASSIFICATION=a}),66);
__d("WAWebWamEnumWebcEnvCode",[],(function(a,b,c,d,e,f){a=Object.freeze({PROD:0,INTERN:1,DEV:2,E2E:3});f.WEBC_ENV_CODE=a}),66);
__d("WAWebWamEnumWebcWebPlatformType",[],(function(a,b,c,d,e,f){a=Object.freeze({WEB:1,WIN32:2,DARWIN:3,IOS_TABLET:4,ANDROID_TABLET:5,WINSTORE:6,MACSTORE:7,DARWIN_BETA:8,WIN32_BETA:9,PWA:10});f.WEBC_WEB_PLATFORM_TYPE=a}),66);
__d("WAWebWamGlobals",["WAWebWamCodegenUtils","WAWebWamEnumAppBuildType","WAWebWamEnumDeviceClassification","WAWebWamEnumPlatformType","WAWebWamEnumWebcEnvCode","WAWebWamEnumWebcWebPlatformType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineGlobal({abKey2:[4473,a.TYPES.STRING,["regular"]],appBuild:[1657,d("WAWebWamEnumAppBuildType").APP_BUILD_TYPE,["regular","private"]],appIsBetaRelease:[21,a.TYPES.BOOLEAN,["regular","private"]],appVersion:[17,a.TYPES.STRING,["regular","private"]],beaconSessionId:[18529,a.TYPES.INTEGER,["regular"]],browser:[779,a.TYPES.STRING,["regular"]],browserVersion:[295,a.TYPES.STRING,["regular"]],datacenter:[2795,a.TYPES.STRING,["regular"]],deviceClassification:[14507,d("WAWebWamEnumDeviceClassification").DEVICE_CLASSIFICATION,["regular"]],deviceName:[13,a.TYPES.STRING,["regular","private"]],deviceVersion:[4505,a.TYPES.STRING,["regular"]],expoKey:[5029,a.TYPES.STRING,["regular","private"]],isInCohort:[19129,a.TYPES.BOOLEAN,["regular"]],mcc:[5,a.TYPES.INTEGER,["regular","private"]],memClass:[655,a.TYPES.INTEGER,["regular","private"]],mnc:[3,a.TYPES.INTEGER,["regular","private"]],networkIsWifi:[23,a.TYPES.BOOLEAN,["regular"]],numCpu:[10317,a.TYPES.INTEGER,["regular"]],ocVersion:[6251,a.TYPES.INTEGER,["regular","private"]],osVersion:[15,a.TYPES.STRING,["regular","private"]],platform:[11,d("WAWebWamEnumPlatformType").PLATFORM_TYPE,["regular","private"]],psCountryCode:[6833,a.TYPES.STRING,["private"]],psId:[6005,a.TYPES.STRING,["private"]],serviceImprovementOptOut:[13293,a.TYPES.BOOLEAN,["regular","private"]],streamId:[3543,a.TYPES.INTEGER,["regular","private"]],wametaLoggerTestFilter:[15881,a.TYPES.STRING,["regular","private"]],webcBucket:[875,a.TYPES.STRING,["regular"]],webcEnv:[633,d("WAWebWamEnumWebcEnvCode").WEBC_ENV_CODE,["regular"]],webcNativeAutolaunch:[1009,a.TYPES.BOOLEAN,["regular"]],webcNativeBetaUpdates:[1007,a.TYPES.BOOLEAN,["regular"]],webcPhoneAppVersion:[1005,a.TYPES.STRING,["regular"]],webcPhoneCharging:[783,a.TYPES.BOOLEAN,["regular"]],webcPhoneDeviceManufacturer:[829,a.TYPES.STRING,["regular"]],webcPhoneDeviceModel:[831,a.TYPES.STRING,["regular"]],webcPhoneOsBuildNumber:[833,a.TYPES.STRING,["regular"]],webcPhoneOsVersion:[835,a.TYPES.STRING,["regular"]],webcPhonePlatform:[707,d("WAWebWamEnumPlatformType").PLATFORM_TYPE,["regular"]],webcRevision:[18491,a.TYPES.INTEGER,["regular"]],webcTabId:[3727,a.TYPES.STRING,["regular"]],webcWebArch:[6605,a.TYPES.STRING,["regular"]],webcWebDeviceManufacturer:[6599,a.TYPES.STRING,["regular"]],webcWebDeviceModel:[6601,a.TYPES.STRING,["regular"]],webcWebOsReleaseNumber:[6603,a.TYPES.STRING,["regular"]],webcWebPlatform:[899,d("WAWebWamEnumWebcWebPlatformType").WEBC_WEB_PLATFORM_TYPE,["regular","private"]],yearClass:[689,a.TYPES.INTEGER,["regular","private"]],yearClass2016:[2617,a.TYPES.INTEGER,["regular","private"]]});c=[{key:"DefaultPsId",keyHashInt:113760892,rotationPeriodDays:-1},{key:"IdPreMetrics",keyHashInt:56300709,rotationPeriodDays:-1},{key:"IdTtl90Days",keyHashInt:37887164,rotationPeriodDays:90},{key:"IdTtlDaily",keyHashInt:248614979,rotationPeriodDays:1},{key:"IdTtlMonthly",keyHashInt:191000728,rotationPeriodDays:30},{key:"IdTtlWeekly",keyHashInt:42196056,rotationPeriodDays:7}];g.Global=b;g.PrivateStatsAllIds=c}),98);
__d("WAWebWebcRawPlatformsWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({WebcRawPlatforms:[2416,{webcRawPlatform:[1,d("WAWebWamCodegenUtils").TYPES.STRING]},[1,1,1],"regular"]},{WebcRawPlatforms:[]});g.WebcRawPlatformsWamEvent=a}),98);
__d("WAWebConnModel",["WALogger","WAWebBaseModel","WAWebL10N","WAWebL10NConstants","WAWebMobilePlatforms","WAWebUserPrefsGeneral","WAWebUserPrefsMeUser","WAWebWamEnumPlatformType","WAWebWamGlobals","WAWebWebcRawPlatformsWamEvent","gkx","lodash"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Conn: platform change: ",""]);h=function(){return a};return a}a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,e;for(var f=arguments.length,g=new Array(f),h=0;h<f;h++)g[h]=arguments[h];return(b=e=a.call.apply(a,[this].concat(g))||this,e.id=d("WAWebBaseModel").prop(),e.ref=d("WAWebBaseModel").prop(),e.refTTL=d("WAWebBaseModel").prop(),e.refId=d("WAWebBaseModel").prop(),e.wid=d("WAWebBaseModel").prop(),e.connected=d("WAWebBaseModel").prop(),e.protoVersion=d("WAWebBaseModel").prop(),e.clientToken=d("WAWebBaseModel").prop(),e.serverToken=d("WAWebBaseModel").prop(),e.secret=d("WAWebBaseModel").prop(),e.isResponse=d("WAWebBaseModel").prop(),e.lc=d("WAWebBaseModel").prop(),e.lg=d("WAWebBaseModel").prop(),e.locales=d("WAWebBaseModel").prop(),e.is24h=d("WAWebBaseModel").prop(),e.platform=d("WAWebBaseModel").prop(),e.phone=d("WAWebBaseModel").prop(),e.tos=d("WAWebBaseModel").prop(),e.smbTos=d("WAWebBaseModel").prop(0),e.pushname=d("WAWebBaseModel").prop(),e.blockStoreAdds=d("WAWebBaseModel").session(!1),e.meReadyTriggered=d("WAWebBaseModel").session(!1),e.refExpiry=d("WAWebBaseModel").derived(function(){return Date.now()+this.refTTL},["ref","refTTL"]),e.locale=d("WAWebBaseModel").derived(function(){return this.formatLocale(this.lg,this.lc)},["lg","lc"]),e.localesList=d("WAWebBaseModel").derived(function(){return!this.locales||!this.locales.length?!this.lg?[]:[[this.lg,this.lc]]:this.locales.split(",").reduce(function(a,b){b=b.split("-");var c=b[0];b=b[1];if(!c)return a;a.push([c,b]);return a},[])},["locales","lg","lc"]),e.allLocales=d("WAWebBaseModel").derived(function(){var a=this;return c("lodash").uniq(this.localesList.map(function(b){var c=b[0];b=b[1];return a.formatLocale(c,b)})).filter(Boolean)},["localesList"]),e.allLanguages=d("WAWebBaseModel").derived(function(){return c("lodash").uniq(this.localesList.map(function(a){var b=a[0];a[1];return b}))},["localesList"]),e.platformField=d("WAWebBaseModel").derived(function(){if(this.platform==="wp7")return d("WAWebWamEnumPlatformType").PLATFORM_TYPE.WP;else if(this.platform)return d("WAWebWamEnumPlatformType").PLATFORM_TYPE[this.platform.toUpperCase()]||d("WAWebWamEnumPlatformType").PLATFORM_TYPE.UNKNOWN;return d("WAWebWamEnumPlatformType").PLATFORM_TYPE.UNKNOWN},["platform"]),e.tosShowCallNotification=d("WAWebBaseModel").derived(function(){return!0},["tos"]),e.isSMB=d("WAWebBaseModel").derived(function(){return this.platform===d("WAWebMobilePlatforms").PLATFORMS.SMBA||this.platform===d("WAWebMobilePlatforms").PLATFORMS.SMBI},["platform"]),b)||babelHelpers.assertThisInitialized(e)}var e=b.prototype;e.initialize=function(){var a=this;d("WAWebBaseModel").BaseModel.prototype.initialize.call(this);this.listenTo(this,"change:locale",function(a,b){c("WAWebL10N").setLocale(b,d("WAWebL10NConstants").L10N_PRIORITY.PHONE,!1)});this.listenTo(this,"change:phone",function(){i(a.phone)});this.listenTo(this,"change:platform",this.$ConnImpl1)};e["delete"]=function(){d("WAWebUserPrefsGeneral").setPushname(),this.clear()};e.canSetMyPushname=function(){return!this.isSMB};e.$ConnImpl1=function(){d("WALogger").LOG(h(),this.platform),this.platform&&d("WAWebWamGlobals").Global.set({webcPhonePlatform:this.platformField}),c("gkx")("26259")&&new(d("WAWebWebcRawPlatformsWamEvent").WebcRawPlatformsWamEvent)({webcRawPlatform:this.platform}).commit()};e.formatLocale=function(a,b){return!a?null:b?a.toLowerCase()+"-"+b.toUpperCase():a.toLowerCase()};e.shouldSaveToCache=function(){return!!d("WAWebUserPrefsMeUser").getMe()&&!!this.id};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="conn";function i(a){a===void 0&&(a={});var b=a,c=b.mcc;b=b.mnc;c&&typeof c==="string"&&(c=parseInt(c,10));b&&typeof b==="string"&&(b=parseInt(b,10));d("WAWebWamGlobals").Global.set({mcc:c!=null?c:null,mnc:b!=null?b:null,webcPhoneDeviceManufacturer:a.device_manufacturer||null,webcPhoneDeviceModel:a.device_model||null,webcPhoneOsBuildNumber:a.os_build_number||null,webcPhoneOsVersion:a.os_version||null,webcPhoneAppVersion:a.wa_version||null})}b=d("WAWebBaseModel").defineModel(a);e=new b({id:"1"});g.Conn=e}),98);
__d("WAWebAddonPluginProcessor",["WANullthrows","WAWebAddonCrossWindowUtils","WAWebMessagePluginProcessAsAddonRegistry"],(function(a,b,c,d,e,f,g){function a(){var a=new Map();for(var b=c("WAWebMessagePluginProcessAsAddonRegistry"),d=Array.isArray(b),e=0,b=d?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=b.length)break;f=b[e++]}else{e=b.next();if(e.done)break;f=e.value}f=f;var g=f.type;f=f.processor;f!=null&&a.set(g,f)}return a}var h=a();function b(){return h}function e(a){var b;typeof a==="string"?b=a:b=d("WAWebAddonCrossWindowUtils").getAddonProcessorType(a);return c("WANullthrows")(h.get(b))}function f(a){return Boolean(h.get(a))}g.getAddonProcessorsMap=b;g.getAddonProcessor=e;g.hasAddonProcessor=f}),98);
__d("WAWebPluginCreateRegistryLookup",[],(function(a,b,c,d,e,f){function a(a){var b=new Map();for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e,f;if(c){if(d>=a.length)break;f=a[d++]}else{d=a.next();if(d.done)break;f=d.value}f=f;var g=f.type;e=(e=f.subtype)!=null?e:null;var h=b.get(g);h==null&&(h=new Map(),b.set(g,h));h.set(e,f)}return function(a,c){return(a=b.get(a))==null?void 0:a.get((a=c)!=null?a:null)}}f.createMsgTypeRegistryLookup=a}),66);
__d("WAWebMessagePluginGenerateReportingTokenContent",["WAWebMessagePluginGenerateReportingTokenContentRegistry","WAWebMessagingGatingUtils","WAWebMsgType","WAWebPluginCreateRegistryLookup"],(function(a,b,c,d,e,f,g){var h=d("WAWebPluginCreateRegistryLookup").createMsgTypeRegistryLookup(c("WAWebMessagePluginGenerateReportingTokenContentRegistry"));function a(a){var b;return(b=h(a.type,a.subtype))==null?void 0:b.generateReportingTokenContent==null?void 0:b.generateReportingTokenContent(a)}function b(a,b){return!d("WAWebMessagingGatingUtils").isReportingTokenFromInclusionListEnabled()?a!==d("WAWebMsgType").MSG_TYPE.REACTION&&a!==d("WAWebMsgType").MSG_TYPE.REACTION_ENC&&a!==d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE&&a!==d("WAWebMsgType").MSG_TYPE.EVENT_EDIT_ENCRYPTED&&a!==d("WAWebMsgType").MSG_TYPE.POLL_UPDATE:Boolean((a=h(a,b))==null?void 0:a.generateReportingTokenContent)}g.generateReportingTokenContent=a;g.isMsgTypeReportingTokenCompatible=b}),98);
__d("WAWebMessagePluginParseProtobuf",["WALogger","WAWebMessagePluginParseProtobufRegistry","WAWebMultipleMessageParserPluginParseProtobuf"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseProtoPlugins: Matched more than 1 plugin types ",""]);h=function(){return a};return a}function a(a){var b=d("WAWebMultipleMessageParserPluginParseProtobuf").parseProtobufWithMultipleMessageParserPlugin(a),e=b.result;b=b.pluginsMatched;for(var f=c("WAWebMessagePluginParseProtobufRegistry"),g=Array.isArray(f),i=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j;if(g){if(i>=f.length)break;j=f[i++]}else{i=f.next();if(i.done)break;j=i.value}j=j;j=j(a);if(j!=null){var k;b.push(j.msgData.type+":"+((k=j.msgData.subtype)!=null?k:"null"));e==null&&(e=j)}}if(b.length>1){d("WALogger").ERROR(h(),b.join(",")).sendLogs("parse-protobuf-unexpected-plugin-match");return null}return e}g.parseProtobuf=a}),98);
__d("WAWebGenerateChatReportingTokenContent",[],(function(a,b,c,d,e,f){function a(a){a=new TextEncoder().encode((a=a.body)!=null?a:"");return self.crypto.getRandomValues(new Uint8Array(a.length))}f["default"]=a}),66);
__d("WAWebMessagePluginGenerateReportingTokenContentRegistry",["WAWebGenerateAudioOrPttReportingTokenContent","WAWebGenerateChatReportingTokenContent","WAWebGenerateDocumentReportingTokenContent","WAWebGenerateImageReportingTokenContent","WAWebGenerateInteractiveResponseReportingTokenContent","WAWebGeneratePtvReportingTokenContent","WAWebGenerateStickerReportingTokenContent","WAWebGenerateVideoReportingTokenContent"],(function(a,b,c,d,e,f,g){a=[{type:"album",subtype:void 0,generateReportingTokenContent:null},{type:"audio",subtype:void 0,generateReportingTokenContent:c("WAWebGenerateAudioOrPttReportingTokenContent")},{type:"biz_content_placeholder",subtype:void 0,generateReportingTokenContent:null},{type:"buttons_response",subtype:void 0,generateReportingTokenContent:null},{type:"chat",subtype:"url",generateReportingTokenContent:c("WAWebGenerateChatReportingTokenContent")},{type:"chat",subtype:void 0,generateReportingTokenContent:c("WAWebGenerateChatReportingTokenContent")},{type:"ciphertext",subtype:"bot_unavailable_fanout",generateReportingTokenContent:null},{type:"ciphertext",subtype:"fanout",generateReportingTokenContent:null},{type:"ciphertext",subtype:"hosted_unavailable_fanout",generateReportingTokenContent:null},{type:"ciphertext",subtype:void 0,generateReportingTokenContent:null},{type:"comment",subtype:void 0,generateReportingTokenContent:null},{type:"debug_placeholder",subtype:void 0,generateReportingTokenContent:null},{type:"document",subtype:void 0,generateReportingTokenContent:c("WAWebGenerateDocumentReportingTokenContent")},{type:"event_creation",subtype:void 0,generateReportingTokenContent:null},{type:"event_edit_encrypted",subtype:void 0,generateReportingTokenContent:null},{type:"event_response",subtype:void 0,generateReportingTokenContent:null},{type:"groups_v4_invite",subtype:void 0,generateReportingTokenContent:null},{type:"hsm",subtype:void 0,generateReportingTokenContent:null},{type:"image",subtype:void 0,generateReportingTokenContent:c("WAWebGenerateImageReportingTokenContent")},{type:"interactive",subtype:void 0,generateReportingTokenContent:c("WAWebGenerateInteractiveResponseReportingTokenContent")},{type:"interactive_response",subtype:void 0,generateReportingTokenContent:null},{type:"keep_in_chat",subtype:void 0,generateReportingTokenContent:null},{type:"list",subtype:void 0,generateReportingTokenContent:null},{type:"list_response",subtype:void 0,generateReportingTokenContent:null},{type:"location",subtype:void 0,generateReportingTokenContent:null},{type:"multi_vcard",subtype:void 0,generateReportingTokenContent:null},{type:"native_flow",subtype:void 0,generateReportingTokenContent:null},{type:"newsletter_admin_invite",subtype:void 0,generateReportingTokenContent:null},{type:"notification_template",subtype:"contact_info_card",generateReportingTokenContent:null},{type:"order",subtype:void 0,generateReportingTokenContent:null},{type:"payment",subtype:"ciphertext",generateReportingTokenContent:null},{type:"payment",subtype:"futureproof",generateReportingTokenContent:null},{type:"payment",subtype:"invite",generateReportingTokenContent:null},{type:"payment",subtype:"request",generateReportingTokenContent:null},{type:"payment",subtype:"send",generateReportingTokenContent:null},{type:"pin_message",subtype:void 0,generateReportingTokenContent:null},{type:"pinned_message",subtype:void 0,generateReportingTokenContent:null},{type:"poll_creation",subtype:void 0,generateReportingTokenContent:null},{type:"poll_result_snapshot",subtype:void 0,generateReportingTokenContent:null},{type:"poll_update",subtype:"poll_vote",generateReportingTokenContent:null},{type:"product",subtype:void 0,generateReportingTokenContent:null},{type:"protocol",subtype:"admin_revoke",generateReportingTokenContent:null},{type:"protocol",subtype:"bot_feedback",generateReportingTokenContent:null},{type:"protocol",subtype:"bot_memu_onboarding",generateReportingTokenContent:null},{type:"protocol",subtype:"bot_request_welcome",generateReportingTokenContent:null},{type:"protocol",subtype:"ephemeral_setting",generateReportingTokenContent:null},{type:"protocol",subtype:"ephemeral_sync_response",generateReportingTokenContent:null},{type:"protocol",subtype:"event_edit_decrypted",generateReportingTokenContent:null},{type:"protocol",subtype:"history_sync_notification",generateReportingTokenContent:null},{type:"protocol",subtype:"message_edit",generateReportingTokenContent:null},{type:"protocol",subtype:"sender_revoke",generateReportingTokenContent:null},{type:"protocol",subtype:"share_phone_number",generateReportingTokenContent:null},{type:"protocol",subtype:"status_mention_message",generateReportingTokenContent:null},{type:"ptt",subtype:void 0,generateReportingTokenContent:c("WAWebGenerateAudioOrPttReportingTokenContent")},{type:"ptv",subtype:void 0,generateReportingTokenContent:c("WAWebGeneratePtvReportingTokenContent")},{type:"reaction",subtype:void 0,generateReportingTokenContent:null},{type:"reaction_enc",subtype:void 0,generateReportingTokenContent:null},{type:"request_phone_number",subtype:void 0,generateReportingTokenContent:null},{type:"revoked",subtype:"admin",generateReportingTokenContent:null},{type:"revoked",subtype:"sender",generateReportingTokenContent:null},{type:"sticker",subtype:void 0,generateReportingTokenContent:c("WAWebGenerateStickerReportingTokenContent")},{type:"sticker-pack",subtype:void 0,generateReportingTokenContent:null},{type:"template_button_reply",subtype:void 0,generateReportingTokenContent:null},{type:"unknown",subtype:"payment_action_request_declined",generateReportingTokenContent:null},{type:"unknown",subtype:"payment_transaction_request_cancelled",generateReportingTokenContent:null},{type:"unknown",subtype:"phone",generateReportingTokenContent:null},{type:"unknown",subtype:"phone_only_feature",generateReportingTokenContent:null},{type:"unknown",subtype:void 0,generateReportingTokenContent:null},{type:"vcard",subtype:void 0,generateReportingTokenContent:null},{type:"video",subtype:void 0,generateReportingTokenContent:c("WAWebGenerateVideoReportingTokenContent")}];g["default"]=a}),98);
__d("WAWebAlbumsGatingUtils",["WAWebABProps","WAWebMessageAssociationGatingUtils"],(function(a,b,c,d,e,f,g){function h(){return d("WAWebABProps").getABPropConfigValue("album_v2_receiving_enabled")&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()}function i(){return d("WAWebABProps").getABPropConfigValue("album_v2_sender_enabled")&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()}function a(){return i()&&d("WAWebABProps").getABPropConfigValue("album_v2_forward_as_album_enabled")}function b(){return h()&&d("WAWebABProps").getABPropConfigValue("album_v2_replying_enabled")}function c(){return h()&&d("WAWebABProps").getABPropConfigValue("album_v2_reactions_enabled")}function e(){return h()&&d("WAWebABProps").getABPropConfigValue("album_v2_item_with_caption_in_album_receiver_enabled")}g.isAlbumsReceivingEnabled=h;g.isAlbumsForwardingEnabled=a;g.isAlbumsReplyingEnabled=b;g.isAlbumsReactionEnabled=c;g.isAlbumCaptionReceivingEnabled=e}),98);
__d("WAWebAlbumsParseAlbumMessageProto",["WAWebAlbumsGatingUtils","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.albumMessage;if(b==null)return null;b=b.contextInfo;return!d("WAWebAlbumsGatingUtils").isAlbumsReceivingEnabled()?{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,futureproofType:d("WAWebMsgType").MSG_TYPE.ALBUM}),contextInfo:b}:{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.ALBUM,kind:d("WAWebMsgType").MsgKind.Album}),contextInfo:b}}g["default"]=a}),98);
__d("WAWebEventsGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("event_name_length_limit")}function b(){return d("WAWebABProps").getABPropConfigValue("event_description_length_limit")}function c(){return d("WAWebABProps").getABPropConfigValue("events_m3_end_time_receive")}function e(){return d("WAWebABProps").getABPropConfigValue("events_m3_end_time_send")}function f(){return d("WAWebABProps").getABPropConfigValue("events_m3_maybe_respone_send")}function h(){return d("WAWebABProps").getABPropConfigValue("events_m3_maybe_response_receive")}g.getEventsNameLengthLimit=a;g.getEventsDescriptionLengthLimit=b;g.isEventEndTimeReceiveEnabled=c;g.isEventEndTimeSendEnabled=e;g.isEventMaybeSendEnabled=f;g.isEventMaybeReceiveEnabled=h}),98);
__d("WAWebEventsValidationError",["$InternalEnum","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({MISSING_MESSAGE_SECRET:"missing_message_secret",INVALID_MESSAGE_SECRET:"invalid_message_secret",EVENT_CREATION_INVALID_NAME:"event_creation_invalid_name",EVENT_CREATION_INVALID_DESCRIPTION:"event_creation_invalid_description",EVENT_CREATION_INVALID_CANCELED_STATUS:"event_creation_invalid_canceled_status",EVENT_CREATION_MISSING_DATE:"event_creation_missing_date",EVENT_CREATION_INVALID_LOCATION:"event_creation_invalid_location",EVENT_CREATION_MISSING_MESSAGE_SENDER:"event_creation_missing_message_sender",EVENT_CREATION_INVALID_END_TIME:"event_creation_invalid_end_time",EVENT_CREATION_INVALID_JOIN_LINK:"event_creation_invalid_join_link"});c=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="EventCreationValidationError",b)||babelHelpers.assertThisInitialized(c)}return b}(d("WAWebHandleMsgError").MessageValidationError);e=b("$InternalEnum")({EVENT_RESPONSE_MISSING_MESSAGE_KEY:"event_response_missing_message_key",EVENT_RESPONSE_MISSING_ENC_IV:"event_response_missing_enc_iv",EVENT_RESPONSE_INVALID_SIZE_ENC_IV:"event_response_invalid_size_enc_iv",EVENT_RESPONSE_MISSING_ENC_PAYLOAD:"event_response_missing_enc_payload",EVENT_RESPONSE_MISSING_MESSAGE_SENDER:"event_response_missing_message_sender"});f=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="EncryptedEventResponseValidationError",b)||babelHelpers.assertThisInitialized(c)}return b}(d("WAWebHandleMsgError").MessageValidationError);b=b("$InternalEnum")({EVENT_EDIT_MISSING_TARGET_MESSAGE_KEY:"event_edit_missing_target_message_key",EVENT_EDIT_MISSING_ENC_IV:"event_edit_missing_enc_iv",EVENT_EDIT_INVALID_SIZE_ENC_IV:"event_edit_invalid_size_enc_iv",EVENT_EDIT_MISSING_ENC_PAYLOAD:"event_edit_missing_enc_payload",EVENT_EDIT_MISSING_MESSAGE_SENDER:"event_edit_missing_message_sender",EVENT_EDIT_MISSING_EDITED_MESSAGE:"event_edit_missing_edited_message",EVENT_EDIT_MISSING_SENDER_TIMESTAMP:"event_edit_missing_sender_timestamp",EVENT_EDIT_PARENT_SENDER_MISMATCH:"event_edit_parent_sender_mismatch",EVENT_EDIT_INVALID_PROTOCOL_MESSAGE_TYPE:"event_edit_invalid_protocol_message_type",EVENT_EDIT_MISSING_MESSAGE_SECRET:"event_edit_missing_message_secret"});d=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="EncryptedEventEditValidationError",b)||babelHelpers.assertThisInitialized(c)}return b}(d("WAWebHandleMsgError").MessageValidationError);g.EventCreationValidationErrorCode=a;g.EventCreationValidationError=c;g.EncryptedEventResponseValidationErrorCode=e;g.EncryptedEventResponseValidationError=f;g.EncryptedEventEditValidationErrorCode=b;g.EncryptedEventEditValidationError=d}),98);
__d("WAWebEventsParseEventCreationMessageProto",["WALongInt","WAWebEventsGatingUtils","WAWebEventsValidationError","WAWebMsgType","WAWebURLUtils","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,e=a.baseMessage;a=a.msgContext;var f=b.eventMessage;if(f==null)return null;var g=f.contextInfo,h=f.isCanceled,i=f.name,j=f.description,k=f.joinLink,l=f.startTime,m=f.endTime;f=f.location;l=d("WALongInt").maybeNumberOrThrowIfTooLarge(l);m=d("WALongInt").maybeNumberOrThrowIfTooLarge(m);if(k!=null&&c("WAWebURLUtils").isValidCallLink(k)===!1)throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_INVALID_JOIN_LINK,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(i==null||i===""||i.length>d("WAWebEventsGatingUtils").getEventsNameLengthLimit())throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_INVALID_NAME,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(l==null)throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_MISSING_DATE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(j!=null&&j.length>d("WAWebEventsGatingUtils").getEventsDescriptionLengthLimit())throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_INVALID_DESCRIPTION,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(h==null)throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_INVALID_CANCELED_STATUS,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if((f==null?void 0:f.degreesLatitude)==null&&(f==null?void 0:f.degreesLongitude)!=null||(f==null?void 0:f.degreesLatitude)!=null&&(f==null?void 0:f.degreesLongitude)==null)throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_INVALID_LOCATION,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(m!=null&&m<l)throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_INVALID_END_TIME,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);i=babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.EVENT_CREATION,kind:d("WAWebMsgType").MsgKind.EventCreation,eventName:i,eventDescription:j,eventJoinLink:k,eventStartTime:l,isEventCanceled:Boolean(h),eventLocation:f,eventEndTime:(e=m)!=null?e:void 0});if(a==="quoted"||a==="history_quoted"||a==="history")return{msgData:i,contextInfo:g};k=(j=b.messageContextInfo)==null?void 0:j.messageSecret;if(k==null)throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.MISSING_MESSAGE_SECRET,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.MISSING_MESSAGE_SECRET);if(k.byteLength!==32)throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.INVALID_MESSAGE_SECRET,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.MESSAGE_SECRET_INVALID);return{msgData:i,contextInfo:g}}g["default"]=a}),98);
__d("WAWebBizContentPlaceholderMsgData.flow",["$InternalEnum"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({MASK_LINKED_DEVICES:0});g.BizContentPlaceholderType=a}),98);
__d("WAWebParseBizContentPlaceholderProto",["WAWebBizContentPlaceholderMsgData.flow","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.placeholderMessage;if(b==null||b.type==null)return;b=h(b.type);return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.BIZ_CONTENT_PLACEHOLDER,kind:d("WAWebMsgType").MsgKind.BizContentPlaceholder,bizContentPlaceholderType:b}),contextInfo:void 0}}function h(a){switch(a){case d("WAWebProtobufsE2E.pb").Message$PlaceholderMessage$PlaceholderType.MASK_LINKED_DEVICES:return d("WAWebBizContentPlaceholderMsgData.flow").BizContentPlaceholderType.MASK_LINKED_DEVICES}}g["default"]=a}),98);
__d("WAWebParseBotMemuOnboardingMessageProto",["WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;if(((b=b.protocolMessage)==null?void 0:b.type)!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.BOT_MEMU_ONBOARDING_MESSAGE)return;return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"bot_memu_onboarding"}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebParseBotRequestWelcomeMessageProto",["WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;if(((b=b.protocolMessage)==null?void 0:b.type)!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REQUEST_WELCOME_MESSAGE)return;return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"bot_request_welcome"}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebParseGroupInviteMessageProto",["WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.groupInviteMessage;if(b==null)return;var c=b.caption,e=b.inviteCode,f=b.inviteExpiration,g=b.groupJid,h=b.groupName;b=b.contextInfo;a=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE,kind:d("WAWebMsgType").MsgKind.GroupsV4Invite,comment:c,inviteCode:e,inviteCodeExp:f==null?void 0:f.toString(),inviteGrp:g,inviteGrpName:h});return{msgData:a,contextInfo:b}}g["default"]=a}),98);
__d("WAWebParseListMessageProto",["WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.listMessage;if(b==null)return;var c=b.listType;if(c===d("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.SINGLE_SELECT||c===d("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.PRODUCT_LIST){c=a.businessOwnerJid;var e=a.productListItemCount;if(b.listType===d("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.PRODUCT_LIST){var f;c=(f=b.productListInfo)==null?void 0:f.businessOwnerJid;e=(f=b.productListInfo)==null?void 0:f.productSections.reduce(function(a,b){return a+b.products.length},0)}f=babelHelpers["extends"]({},a,{businessOwnerJid:c,productListItemCount:e,type:d("WAWebMsgType").MSG_TYPE.LIST,kind:d("WAWebMsgType").MsgKind.List,list:b,footer:b.footerText})}else f=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown});return{msgData:f,contextInfo:b.contextInfo}}g["default"]=a}),98);
__d("WAWebMultiVcardMessageValidationError",["$InternalEnum","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({EMPTY_LIST:"contacts_array_empty_list",INVALID_LIST_SIZE:"contacts_array_invalid_list_size"});c=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="MultiVcardMessageValidationError",b)||babelHelpers.assertThisInitialized(c)}return b}(d("WAWebHandleMsgError").MessageValidationError);g.MultiVcardValidationErrorCode=a;g.MultiVcardMessageValidationError=c}),98);
__d("WAWebParseMultiVcardMessageProto",["WAWebMsgType","WAWebMultiVcardMessageValidationError","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.msgContext;b=b.contactsArrayMessage;if(b==null)return;var e=b.contacts,f=b.contextInfo;b=b.displayName;if((a==="relay"||a==="outgoing")&&(e==null||e.length===0))throw new(d("WAWebMultiVcardMessageValidationError").MultiVcardMessageValidationError)(d("WAWebMultiVcardMessageValidationError").MultiVcardValidationErrorCode.EMPTY_LIST,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_PROTOCOL_BUFFER);a=babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.MULTI_VCARD,kind:d("WAWebMsgType").MsgKind.MultiVcard,vcardFormattedName:b,vcardList:Array.isArray(e)?e.map(function(a){return{displayName:a.displayName,vcard:a.vcard,isMultiVcard:!1}}):[]});return{msgData:a,contextInfo:f}}g["default"]=a}),98);
__d("WAWebParsePaymentInviteMessageProto",["WALogger","WALongInt","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[payment-invite] render payment invite of type ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[payment-invite] parsePaymentInviteMessageProto: does not support novi transactions"]);i=function(){return a};return a}function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.paymentInviteMessage;if(b==null)return;if(b.serviceType===d("WAWebProtobufsE2E.pb").Message$PaymentInviteMessage$ServiceType.NOVI){d("WALogger").LOG(i());return{msgData:babelHelpers["extends"]({},a,{kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"phone_only_feature"}),contextInfo:null}}d("WALogger").LOG(h(),b.serviceType);return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PAYMENT,kind:d("WAWebMsgType").MsgKind.Payment,subtype:"invite",paymentExpiryTimestamp:d("WALongInt").maybeNumberOrThrowIfTooLarge(b.expiryTimestamp),paymentInviteServiceType:b.serviceType}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebParseProtocolSharePhoneNumberMessageProto",["WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.protocolMessage;if(b==null)return;if(b.type!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.SHARE_PHONE_NUMBER)return;b=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"share_phone_number"});return{msgData:b,contextInfo:void 0}}g["default"]=a}),98);
__d("WAWebStatusGatingUtils",["WAWebABProps","WAWebPrimaryFeatures"],(function(a,b,c,d,e,f,g){var h=["\ud83d\ude0d","\ud83d\ude02","\ud83d\ude2e","\ud83d\ude22","\ud83d\ude4f","\ud83d\udc4f","\ud83c\udf89","\ud83d\udcaf"],i=new Set(["\ud83d\ude0d","\ud83d\ude02","\ud83d\ude2e","\ud83d\ude22","\ud83d\ude4f","\ud83d\udc4f","\ud83c\udf89","\ud83d\udcaf","\ud83d\udc4d","\u2764","\ud83d\ude0a","\ud83e\udd70","\ud83e\udd29","\ud83d\udc9a","\ud83e\udd23","\ud83d\ude06","\ud83d\udd25","\ud83d\ude4c","\ud83e\udd73","\ud83d\ude2d","\ud83d\ude14","\ud83e\udd7a","\ud83d\ude32","\ud83e\udd2f","\ud83d\ude21","\ud83d\ude24"]);function a(){try{var a=JSON.parse(d("WAWebABProps").getABPropConfigValue("status_reaction_emojis"));a=a.map(function(a){return String.fromCodePoint(a)}).filter(function(a){return i.has(a)});return a.length===0?h:a}catch(a){return h}}function j(){return d("WAWebPrimaryFeatures").primaryFeatureEnabled("post_status_in_companion")&&d("WAWebABProps").getABPropConfigValue("web_status_posting_enabled")}function b(){return j()&&d("WAWebABProps").getABPropConfigValue("web_status_posting_thumbnails_enabled")}function c(){return d("WAWebABProps").getABPropConfigValue("web_status_likes_receive_enabled")}function e(){return d("WAWebABProps").getABPropConfigValue("web_status_likes_send_enabled")}function f(){return d("WAWebABProps").getABPropConfigValue("status_poster_side_gating_enabled")}function k(){return d("WAWebABProps").getABPropConfigValue("status_mentions_receiver")}function l(){return d("WAWebABProps").getABPropConfigValue("status_mentions_in_chat_receiver")}function m(){return d("WAWebABProps").getABPropConfigValue("status_ranking_poster_side_gating_enabled")}g.statusQuickReplyEmojis=a;g.isStatusPostingEnabled=j;g.isStatusPostingThumbnailsEnabled=b;g.isStatusLikesReceiveEnabled=c;g.isStatusLikesSendEnabled=e;g.canCheckStatusLikesPosterGating=f;g.isStatusPrivateMentionsReceiveEnabled=k;g.isStatusMentionsInChatReceiveEnabled=l;g.canCheckStatusRankingPosterGating=m}),98);
__d("WAWebParseProtocolStatusMentionMessageProto",["WAWebMsgType","WAWebStatusGatingUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage;a.msgContext;if(!d("WAWebStatusGatingUtils").isStatusPrivateMentionsReceiveEnabled())return;a=b.statusMentionMessage;if(a==null||(a==null?void 0:a.message)==null)return;return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,futureproofType:d("WAWebMsgType").MSG_TYPE.PROTOCOL,futureproofSubtype:"status_mention_message"}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebParseRequestPhoneNumberMessageProto",["WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.requestPhoneNumberMessage;if(b==null)return;b=b.contextInfo;a=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.REQUEST_PHONE_NUMBER,kind:d("WAWebMsgType").MsgKind.RequestPhoneNumber});return{msgData:a,contextInfo:b}}g["default"]=a}),98);
__d("WAWebParseVcardMessageProto",["WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.contactMessage;if(b==null)return;var c=b.contextInfo,e=b.displayName;b=b.vcard;a=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.VCARD,kind:d("WAWebMsgType").MsgKind.Vcard,body:b,vcardFormattedName:e});return{msgData:a,contextInfo:c}}g["default"]=a}),98);
__d("WAWebMessagePluginParseProtobufRegistry",["WAWebAlbumsParseAlbumMessageProto","WAWebEventsParseEventCreationMessageProto","WAWebEventsParseEventEditEncryptedMessageProto","WAWebEventsParseEventResponseMessageProto","WAWebParseBizContentPlaceholderProto","WAWebParseBotFeedbackProtocolMessageProto","WAWebParseBotMemuOnboardingMessageProto","WAWebParseBotRequestWelcomeMessageProto","WAWebParseButtonsResponseMessageProto","WAWebParseCancelPaymentMessageProto","WAWebParseChatMessageProto","WAWebParseDeclinePaymentMessageProto","WAWebParseDocumentMessageProto","WAWebParseEncCommentMessageProto","WAWebParseEphemeralSyncResponseMessageProto","WAWebParseExtendedTextUrlChatMessageProto","WAWebParseGroupInviteMessageProto","WAWebParseHsmMessageProto","WAWebParseImageMessageProto","WAWebParseInteractiveMessageProto","WAWebParseInteractiveResponseMessageProto","WAWebParseKeepInChatMessageProto","WAWebParseListMessageProto","WAWebParseListResponseMessageProto","WAWebParseLocationMessageProto","WAWebParseMultiVcardMessageProto","WAWebParseNativeFlowButtonsMessageProto","WAWebParseNewsletterAdminInviteMessageProto","WAWebParseOrderMessageProto","WAWebParsePaymentInviteMessageProto","WAWebParsePinMessageProto","WAWebParsePollResultSnapshotMessageProto","WAWebParseProductMessageProto","WAWebParseProtocolAdminRevokeMessageProto","WAWebParseProtocolEphemeralSettingMessageProto","WAWebParseProtocolHistorySyncNotificationMessageProto","WAWebParseProtocolMessageEditProto","WAWebParseProtocolSenderRevokeMessageProto","WAWebParseProtocolSharePhoneNumberMessageProto","WAWebParseProtocolStatusMentionMessageProto","WAWebParseRequestPaymentMessageProto","WAWebParseRequestPhoneNumberMessageProto","WAWebParseSendPaymentMessageProto","WAWebParseStickerPackMessageProto","WAWebParseTemplateButtonReplyMessageProto","WAWebParseVcardMessageProto","WAWebParseVideoMessageProto","WAWebPollsParsePollCreationMessageProto","WAWebPollsParsePollVoteMessageProto","WAWebPttParseAudioMessageProto","WAWebPttParsePttMessageProto","WAWebPtvParsePtvMessageProto","WAWebReactionsParseReactionEncMessageProto","WAWebReactionsParseReactionMessageProto","WAWebStickersParseStickerMessageProto"],(function(a,b,c,d,e,f,g){a=[c("WAWebAlbumsParseAlbumMessageProto"),c("WAWebEventsParseEventCreationMessageProto"),c("WAWebEventsParseEventEditEncryptedMessageProto"),c("WAWebEventsParseEventResponseMessageProto"),c("WAWebParseBizContentPlaceholderProto"),c("WAWebParseBotFeedbackProtocolMessageProto"),c("WAWebParseBotMemuOnboardingMessageProto"),c("WAWebParseBotRequestWelcomeMessageProto"),c("WAWebParseButtonsResponseMessageProto"),c("WAWebParseCancelPaymentMessageProto"),c("WAWebParseChatMessageProto"),c("WAWebParseDeclinePaymentMessageProto"),c("WAWebParseDocumentMessageProto"),c("WAWebParseEncCommentMessageProto"),c("WAWebParseEphemeralSyncResponseMessageProto"),c("WAWebParseExtendedTextUrlChatMessageProto"),c("WAWebParseGroupInviteMessageProto"),c("WAWebParseHsmMessageProto"),c("WAWebParseImageMessageProto"),c("WAWebParseInteractiveMessageProto"),c("WAWebParseInteractiveResponseMessageProto"),c("WAWebParseKeepInChatMessageProto"),c("WAWebParseListMessageProto"),c("WAWebParseListResponseMessageProto"),c("WAWebParseLocationMessageProto"),c("WAWebParseMultiVcardMessageProto"),c("WAWebParseNativeFlowButtonsMessageProto"),c("WAWebParseNewsletterAdminInviteMessageProto"),c("WAWebParseOrderMessageProto"),c("WAWebParsePaymentInviteMessageProto"),c("WAWebParsePinMessageProto"),c("WAWebParsePollResultSnapshotMessageProto"),c("WAWebParseProductMessageProto"),c("WAWebParseProtocolAdminRevokeMessageProto"),c("WAWebParseProtocolEphemeralSettingMessageProto"),c("WAWebParseProtocolHistorySyncNotificationMessageProto"),c("WAWebParseProtocolMessageEditProto"),c("WAWebParseProtocolSenderRevokeMessageProto"),c("WAWebParseProtocolSharePhoneNumberMessageProto"),c("WAWebParseProtocolStatusMentionMessageProto"),c("WAWebParseRequestPaymentMessageProto"),c("WAWebParseRequestPhoneNumberMessageProto"),c("WAWebParseSendPaymentMessageProto"),c("WAWebParseStickerPackMessageProto"),c("WAWebParseTemplateButtonReplyMessageProto"),c("WAWebParseVcardMessageProto"),c("WAWebParseVideoMessageProto"),c("WAWebPollsParsePollCreationMessageProto"),c("WAWebPollsParsePollVoteMessageProto"),c("WAWebPttParseAudioMessageProto"),c("WAWebPttParsePttMessageProto"),c("WAWebPtvParsePtvMessageProto"),c("WAWebReactionsParseReactionEncMessageProto"),c("WAWebReactionsParseReactionMessageProto"),c("WAWebStickersParseStickerMessageProto")];g["default"]=a}),98);
__d("WAWebMessagePluginProcessAsAddonRegistry",["WAWebAddonCommentMsgProcessor","WAWebEventEditAddonMessageProcessor","WAWebEventResponseAddonMessageProcessor","WAWebPinAddonMessageProcessor","WAWebPollVoteAddonMessageProcessor","WAWebReactionAddonMessageProcessor"],(function(a,b,c,d,e,f,g){a=[{type:"album",processor:null},{type:"audio",processor:null},{type:"biz_content_placeholder",processor:null},{type:"buttons_response",processor:null},{type:"chat",processor:null},{type:"chat",processor:null},{type:"ciphertext",processor:null},{type:"ciphertext",processor:null},{type:"ciphertext",processor:null},{type:"ciphertext",processor:null},{type:"comment",processor:c("WAWebAddonCommentMsgProcessor")},{type:"debug_placeholder",processor:null},{type:"document",processor:null},{type:"event_creation",processor:null},{type:"event_edit_encrypted",processor:c("WAWebEventEditAddonMessageProcessor")},{type:"event_response",processor:c("WAWebEventResponseAddonMessageProcessor")},{type:"groups_v4_invite",processor:null},{type:"hsm",processor:null},{type:"image",processor:null},{type:"interactive",processor:null},{type:"interactive_response",processor:null},{type:"keep_in_chat",processor:null},{type:"list",processor:null},{type:"list_response",processor:null},{type:"location",processor:null},{type:"multi_vcard",processor:null},{type:"native_flow",processor:null},{type:"newsletter_admin_invite",processor:null},{type:"notification_template",processor:null},{type:"order",processor:null},{type:"payment",processor:null},{type:"payment",processor:null},{type:"payment",processor:null},{type:"payment",processor:null},{type:"payment",processor:null},{type:"pin_message",processor:c("WAWebPinAddonMessageProcessor")},{type:"pinned_message",processor:null},{type:"poll_creation",processor:null},{type:"poll_result_snapshot",processor:null},{type:"poll_update",processor:c("WAWebPollVoteAddonMessageProcessor")},{type:"product",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"ptt",processor:null},{type:"ptv",processor:null},{type:"reaction",processor:c("WAWebReactionAddonMessageProcessor")},{type:"reaction_enc",processor:c("WAWebReactionAddonMessageProcessor")},{type:"request_phone_number",processor:null},{type:"revoked",processor:null},{type:"revoked",processor:null},{type:"sticker",processor:null},{type:"sticker-pack",processor:null},{type:"template_button_reply",processor:null},{type:"unknown",processor:null},{type:"unknown",processor:null},{type:"unknown",processor:null},{type:"unknown",processor:null},{type:"unknown",processor:null},{type:"vcard",processor:null},{type:"video",processor:null}];g["default"]=a}),98);
__d("WAWebMultipleMessageParserPluginParseProtobuf",["WAWebMultipleMessageParserPluginParseProtobufRegistry"],(function(a,b,c,d,e,f,g){function a(a){var b=[],d;for(var e=c("WAWebMultipleMessageParserPluginParseProtobufRegistry"),f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;h=h(a);if(h!=null){var i;b.push(h.msgData.type+":"+((i=h.msgData.subtype)!=null?i:"null"));d==null&&(d=h)}}return{result:d,pluginsMatched:b}}g.parseProtobufWithMultipleMessageParserPlugin=a}),98);
__d("WAWebMultipleMessageParserPluginParseProtobufRegistry",["WAWebParseHistorySyncProtocolMessageEditProto","WAWebParseNonNFMButtonsMessageProto","WAWebParseTemplateMessageProto"],(function(a,b,c,d,e,f,g){a=[c("WAWebParseHistorySyncProtocolMessageEditProto"),c("WAWebParseNonNFMButtonsMessageProto"),c("WAWebParseTemplateMessageProto")];g["default"]=a}),98);
__d("WAWebAudioMessageProtoUtils",["WALogger","WAWebE2EProtoParserApi"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["fileLength is missing from msg type ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["seconds is 0 in msg type ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["seconds is missing from msg type ",""]);j=function(){return a};return a}function a(a,b){if(!d("WAWebE2EProtoParserApi").shouldLogE2eProtoValidation(a,b))return;a=a.type;b.seconds==null?d("WALogger").LOG(j(),a).sendLogs(a+"-message-missing-seconds"):b.seconds===0&&d("WALogger").LOG(i(),a).sendLogs(a+"-message-incorrect-seconds");b.fileLength==null&&d("WALogger").LOG(h(),a).sendLogs(a+"-message-missing-fileLength")}function b(a){return a.byteLength>=64&&a.byteLength<=192}g.validateRequiredAudioProperties=a;g.validateWaveform=b}),98);
__d("WAWebButtonsMessageProtoUtils",["WAWebE2EProtoUtils","WAWebMsgType","WAWebParseDocumentMessageProto","WAWebParseImageMessageProto","WAWebParseLocationMessageProto","WAWebParseVideoMessageProto","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.buttonsMessage,e=a.baseMessage,f=a.msgContext,g=b.documentMessage,h=b.imageMessage,i=b.locationMessage,j=b.videoMessage,k=b.contentText;a=b.footerText;var l=b.text;b=b.headerType;var m=function(){var a=babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.CHAT,kind:d("WAWebMsgType").MsgKind.Chat,title:l==null?e.title:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(l),body:k==null?e.body:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(k)});if(h){var b;return(b=(b=c("WAWebParseImageMessageProto")({messageProtobuf:{imageMessage:h},baseMessage:e,msgContext:f}))==null?void 0:b.msgData)!=null?b:a}if(g){return(b=(b=c("WAWebParseDocumentMessageProto")({messageProtobuf:{documentMessage:g},baseMessage:e,msgContext:f}))==null?void 0:b.msgData)!=null?b:a}if(i){return(b=(b=c("WAWebParseLocationMessageProto")({messageProtobuf:{locationMessage:babelHelpers["extends"]({},i,{name:void 0,address:void 0})},baseMessage:e,msgContext:f}))==null?void 0:b.msgData)!=null?b:a}if(j){return(b=(b=c("WAWebParseVideoMessageProto")({messageProtobuf:{videoMessage:j},baseMessage:e,msgContext:f}))==null?void 0:b.msgData)!=null?b:a}return a};m=m();return babelHelpers["extends"]({},m,{headerType:b,caption:k!=null?d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(k):m.caption,footer:a!=null?d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(a):m.footer})}function b(a,b,c){var e=a.documentMessage,f=a.imageMessage,g=a.locationMessage,h=a.videoMessage;if(b.isForwarded&&(e||f||g||h))return a;a={buttons:b.isForwarded===!0?void 0:b.dynamicReplyButtons,footerText:b.footer,contextInfo:c};e?(a.documentMessage=e,a.headerType=d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.DOCUMENT,a.contentText=b.caption):f?(a.imageMessage=f,a.headerType=d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.IMAGE,a.contentText=b.caption):g?(a.locationMessage=g,a.headerType=d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.LOCATION,a.contentText=b.caption):h?(a.videoMessage=h,a.headerType=d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.VIDEO,a.contentText=b.caption):b.title?(a.text=b.title,a.headerType=d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.TEXT,a.contentText=b.body):(a.contentText=b.body,a.headerType=d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.EMPTY);return{buttonsMessage:a}}g.parseButtonsMessageProto=a;g.createDynamicReplyButtonsMessage=b}),98);
__d("WAWebCommonMsgSubtypeTypes",[],(function(a,b,c,d,e,f){a=Object.freeze({Subject:"subject",Add:"add",Remove:"remove",Leave:"leave",Picture:"picture",Modify:"modify",Suspend:"suspend",Delete:"delete",Create:"create",Promote:"promote",Demote:"demote",Invite:"invite",RevokeInvite:"revoke_invite",Description:"description",ParentGroupDescription:"parent_group_description",Restrict:"restrict",Announce:"announce",AnnounceMsgBounce:"announce_msg_bounce",V4AddInviteSent:"v4_add_invite_sent",V4AddInviteJoin:"v4_add_invite_join",NoFrequentlyForwarded:"no_frequently_forwarded",InitialPHashMismatch:"initial_pHash_mismatch",Ephemeral:"ephemeral",GrowthLocked:"growth_locked",GrowthUnlocked:"growth_unlocked",ParentGroupLink:"parent_group_link",SiblingGroupLink:"sibling_group_link",SubGroupLink:"sub_group_link",ParentGroupUnlink:"parent_group_unlink",SiblingGroupUnlink:"sibling_group_unlink",SubGroupUnlink:"sub_group_unlink",LinkedGroupJoin:"linked_group_join",DeleteParentGroup:"delete_parent_group",DeleteParentGroupUnlink:"delete_parent_group_unlink",DeleteParentSubGroupUnlink:"delete_parent_sub_group_unlink",IntegrityParentGroupUnlink:"integrity_parent_group_unlink",IntegritySubGroupUnlink:"integrity_sub_group_unlink",LinkedGroupPromote:"linked_group_promote",LinkedGroupDemote:"linked_group_demote",MembershipApprovalMode:"membership_approval_mode",MembershipApprovalRequest:"membership_approval_request",MemberAddMode:"member_add_mode",CreatedMembershipRequests:"created_membership_requests",RevokedMembershipRequests:"revoked_membership_requests",AutoAdd:"auto_add",DefaultSubGroupAdminAdd:"default_sub_group_admin_add",DefaultSubGroupPromote:"default_sub_group_promote",DefaultSubGroupDemote:"default_sub_group_demote",InviteAutoAdd:"invite_auto_add",CommunityParticipantAddRich:"community_participant_add_rich",CommunityInviteRich:"community_invite_rich",SubGroupParticipantAddRich:"sub_group_participant_add_rich",SubGroupInviteRich:"sub_group_invite_rich",CommunityLinkParentGroupRich:"community_link_parent_group_rich",CommunityInviteAutoAddRich:"community_invite_auto_add_rich",AllowNonAdminSubGroupCreation:"allow_non_admin_sub_group_creation",AllowAdminReports:"allow_admin_reports",CreatedSubgroupSuggestion:"created_subgroup_suggestion",RevokedSubGroupSuggestions:"revoked_sub_group_suggestions",AdminReportReceived:"admin_report_received",SubgroupSuggestionsChangeNumber:"subgroup_suggestions_change_number",SubgroupAdminTriggeredAutoAdd:"subgroup_admin_triggered_auto_add",SubgroupAdminTriggeredInviteAutoAdd:"subgroup_admin_triggered_invite_auto_add",EmptySubgroupCreate:"empty_subgroup_create",GeneralChatAdd:"general_chat_add",GeneralChatAutoAddDisabled:"general_chat_auto_add_disabled",CommunityOwnerUpdate:"community_owner_update",HiddenGroup:"hidden_group",Url:"url",Encrypt:"encrypt",EncryptNow:"encrypt_now",E2EIdentityUnavailable:"e2e_identity_unavailable",Identity:"identity",Device:"device",ChatPsa:"chat_psa",ErrorInDeviceList:"error_in_device_list",Miss:"miss",MissVideo:"miss_video",MissGroup:"miss_group",MissGroupVideo:"miss_group_video",Silence:"silence",AdminRevoke:"admin_revoke",SenderRevoke:"sender_revoke",EphemeralSetting:"ephemeral_setting",EphemeralSyncResponse:"ephemeral_sync_response",SharePhoneNumber:"share_phone_number",AppStateFatalExceptionNotification:"app_state_fatal_exception_notification",AppStateSyncKeyShare:"app_state_sync_key_share",AppStateSyncKeyRequest:"app_state_sync_key_request",HistorySyncNotification:"history_sync_notification",MessageEdit:"message_edit",BotFeedback:"bot_feedback",BotMemuOnboarding:"bot_memu_onboarding",BotRequestWelcome:"bot_request_welcome",StatusMentionMessage:"status_mention_message",Request:"request",Send:"send",Ciphertext:"ciphertext",Futureproof:"futureproof",PollVote:"poll_vote",Sender:"sender",Admin:"admin",Phone:"phone",PhoneOnlyFeature:"phone_only_feature",Reaction:"reaction",NonVerifiedTransition:"non_verified_transition",UnverifiedTransition:"unverified_transition",VerifiedTransition:"verified_transition",VerifiedLowUnknown:"verified_low_unknown",VerifiedHigh:"verified_high",VerifiedInitialUnknown:"verified_initial_unknown",VerifiedInitialLow:"verified_initial_low",VerifiedInitialHigh:"verified_initial_high",VerifiedTransitionAnyToNone:"verified_transition_any_to_none",VerifiedTransitionAnyToHigh:"verified_transition_any_to_high",VerifiedTransitionHighToLow:"verified_transition_high_to_low",VerifiedTransitionHighToUnknown:"verified_transition_high_to_unknown",VerifiedTransitionUnknownToLow:"verified_transition_unknown_to_low",VerifiedTransitionLowToUnknown:"verified_transition_low_to_unknown",VerifiedTransitionNoneToLow:"verified_transition_none_to_low",VerifiedTransitionNoneToUnknown:"verified_transition_none_to_unknown",PaymentTransactionStatusUpdateFailed:"payment_transaction_status_update_failed",PaymentTransactionStatusUpdateRefunded:"payment_transaction_status_update_refunded",PaymentTransactionStatusUpdateRefundFailed:"payment_transaction_status_update_refund_failed",PaymentTransactionStatusReceiverPendingSetup:"payment_transaction_status_receiver_pending_setup",PaymentTransactionStatusReceiverSuccessAfterHiccup:"payment_transaction_status_receiver_success_after_hiccup",PaymentTransactionRequestCancelled:"payment_transaction_request_cancelled",PaymentActionAccountSetupReminder:"payment_action_account_setup_reminder",PaymentActionSendPaymentReminder:"payment_action_send_payment_reminder",PaymentActionSendPaymentInvitation:"payment_action_send_payment_invitation",PaymentActionRequestDeclined:"payment_action_request_declined",PaymentActionRequestExpired:"payment_action_request_expired",PaymentInviteAccountSetUp:"payment_invite_account_set_up",BizVerifiedTransitionTopToBottom:"biz_verified_transition_top_to_bottom",BizVerifiedTransitionBottomToTop:"biz_verified_transition_bottom_to_top",BizIntroTop:"biz_intro_top",BizIntroBottom:"biz_intro_bottom",BizNameChange:"biz_name_change",BizMoveToConsumerApp:"biz_move_to_consumer_app",BizTwoTierMigrationTop:"biz_two_tier_migration_top",BizTwoTierMigrationBottom:"biz_two_tier_migration_bottom",SenderInvite:"sender_invite",ReceiverInvite:"receiver_invite",ChangeNumber:"change_number",ChangeUsername:"change_username",MaskedThreadCreated:"masked_thread_created",CagMaskedThreadCreated:"cag_masked_thread_created",InfoEncrypted:"info_encrypted",DescAdd:"desc_add",DescRemove:"desc_remove",Fanout:"fanout",BotUnavailableFanout:"bot_unavailable_fanout",HostedUnavailableFanout:"hosted_unavailable_fanout",DisappearingMode:"disappearing_mode",DisappearingModeUpdate:"disappearing_mode_update",DisappearingModeUnsupported:"disappearing_mode_unsupported",BlockContact:"block_contact",CommunityCreate:"community_create",EphemeralKeepInChat:"ephemeral_keep_in_chat",KeepInChat:"keep_in_chat",ChatAssignment:"chat_assignment",PeerDataOperationRequestMessage:"peer_data_operation_request_message",ChatAssignmentUnassign:"chat_assignment_unassign",PeerDataOperationRequestResponseMessage:"peer_data_operation_request_response_message",NewsletterCreated:"newsletter_created",NewsletterPrivacy:"newsletter_privacy",NewsletterDeleted:"newsletter_deleted",NewsletterAdminContextCard:"newsletter_admin_context_card",PollCreation:"poll_creation",PollUpdate:"poll_update",ContactInfoCard:"contact_info_card",OrderEphemeralExemption:"order_ephemeral_exemption",BotInit:"bot_init",BotTypingPlaceholder:"bot_typing_placeholder",BotInvokeDisclaimer:"bot_invoke_disclaimer",BizBot1PDisclosure:"biz_bot_1p_disclosure",BizBot3PDisclosure:"biz_bot_3p_disclosure",BlueMsgBspFbToBspPremise:"blue_msg_bsp_fb_to_bsp_premise",BlueMsgBspFbToSelfFb:"blue_msg_bsp_fb_to_self_fb",BlueMsgBspFbToSelfPremise:"blue_msg_bsp_fb_to_self_premise",BlueMsgBspFbUnverified:"blue_msg_bsp_fb_unverified",BlueMsgBspFbUnverifiedToBspPremiseVerified:"blue_msg_bsp_fb_unverified_to_bsp_premise_verified",BlueMsgBspFbUnverifiedToSelfFbVerified:"blue_msg_bsp_fb_unverified_to_self_fb_verified",BlueMsgBspFbUnverifiedToSelfPremiseVerified:"blue_msg_bsp_fb_unverified_to_self_premise_verified",BlueMsgBspFbVerified:"blue_msg_bsp_fb_verified",BlueMsgBspFbVerifiedToBspPremiseUnverified:"blue_msg_bsp_fb_verified_to_bsp_premise_unverified",BlueMsgBspFbVerifiedToSelfFbUnverified:"blue_msg_bsp_fb_verified_to_self_fb_unverified",BlueMsgBspFbVerifiedToSelfPremiseUnverified:"blue_msg_bsp_fb_verified_to_self_premise_unverified",BlueMsgBspPremiseToSelfPremise:"blue_msg_bsp_premise_to_self_premise",BlueMsgBspPremiseUnverified:"blue_msg_bsp_premise_unverified",BlueMsgBspPremiseUnverifiedToSelfPremiseVerified:"blue_msg_bsp_premise_unverified_to_self_premise_verified",BlueMsgBspPremiseVerified:"blue_msg_bsp_premise_verified",BlueMsgBspPremiseVerifiedToSelfPremiseUnverified:"blue_msg_bsp_premise_verified_to_self_premise_unverified",BlueMsgConsumerToBspFbUnverified:"blue_msg_consumer_to_bsp_fb_unverified",BlueMsgConsumerToBspPremiseUnverified:"blue_msg_consumer_to_bsp_premise_unverified",BlueMsgConsumerToSelfFbUnverified:"blue_msg_consumer_to_self_fb_unverified",BlueMsgConsumerToSelfPremiseUnverified:"blue_msg_consumer_to_self_premise_unverified",BlueMsgSelfFbToBspPremise:"blue_msg_self_fb_to_bsp_premise",BlueMsgSelfFbToSelfPremise:"blue_msg_self_fb_to_self_premise",BlueMsgSelfFbUnverified:"blue_msg_self_fb_unverified",BlueMsgSelfFbUnverifiedToBspPremiseVerified:"blue_msg_self_fb_unverified_to_bsp_premise_verified",BlueMsgSelfFbUnverifiedToSelfPremiseVerified:"blue_msg_self_fb_unverified_to_self_premise_verified",BlueMsgSelfFbVerified:"blue_msg_self_fb_verified",BlueMsgSelfFbVerifiedToBspPremiseUnverified:"blue_msg_self_fb_verified_to_bsp_premise_unverified",BlueMsgSelfFbVerifiedToSelfPremiseUnverified:"blue_msg_self_fb_verified_to_self_premise_unverified",BlueMsgSelfPremiseToBspPremise:"blue_msg_self_premise_to_bsp_premise",BlueMsgSelfPremiseUnverified:"blue_msg_self_premise_unverified",BlueMsgSelfPremiseVerified:"blue_msg_self_premise_verified",BlueMsgToBspFb:"blue_msg_to_bsp_fb",BlueMsgToConsumer:"blue_msg_to_consumer",BlueMsgToSelfFb:"blue_msg_to_self_fb",BlueMsgUnverifiedToBspFbVerified:"blue_msg_unverified_to_bsp_fb_verified",BlueMsgUnverifiedToBspPremiseVerified:"blue_msg_unverified_to_bsp_premise_verified",BlueMsgUnverifiedToSelfFbVerified:"blue_msg_unverified_to_self_fb_verified",BlueMsgUnverifiedToVerified:"blue_msg_unverified_to_verified",BlueMsgVerifiedToBspFbUnverified:"blue_msg_verified_to_bsp_fb_unverified",BlueMsgVerifiedToBspPremiseUnverified:"blue_msg_verified_to_bsp_premise_unverified",BlueMsgVerifiedToSelfFbUnverified:"blue_msg_verified_to_self_fb_unverified",BlueMsgVerifiedToUnverified:"blue_msg_verified_to_unverified",BizPrivacyModeInitFb:"biz_privacy_mode_init_fb",BizPrivacyModeInitBsp:"biz_privacy_mode_init_bsp",BizPrivacyModeToFb:"biz_privacy_mode_to_fb",BizPrivacyModeToBsp:"biz_privacy_mode_to_bsp",SagaInit:"saga_init",BizAccountTypeChangedToHosted:"biz_account_type_changed_to_hosted",BizMeAccountTypeIsHostedSystemMsg:"biz_me_account_type_is_hosted",BizMeAccountTypeIsHostedSystemMsgTransition:"biz_me_account_type_is_hosted_transition",BizAccountTypeIsHostedSystemMsg:"biz_account_type_is_hosted",EventEditDecrypted:"event_edit_decrypted",HostedGroup:"is_capi_hosted_group"});f.MsgSubtype=a}),66);
__d("WAWebMessageAssociationValidation",["$InternalEnum","WACustomError","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({MISSING_PARENT_MESSAGE_KEY:"missing_parent_message_key",INVALID_PARENT_MESSAGE_KEY:"invalid_parent_message_key",MISSING_ASSOCIATION_TYPE:"missing_association_type",MISMATCH_SENDER:"mismatch_sender",UNSUPPORTED_ASSOCIATION_TYPE:"unsupported_association_type",INVALID_CHILD_MESSAGE:"invalid_child_message"});c=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="MessageAssociationValidationError",b)||babelHelpers.assertThisInitialized(c)}return b}(d("WAWebHandleMsgError").MessageValidationError);e=b("$InternalEnum")({MESSAGE_ASSOCIATIONS_MISMATCH:"message_associations_mismatch"});f=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){b="errorCode: "+String(b);c!=null&&(b+=" comment: "+c);return a.call(this,b)||this}return b}(d("WACustomError").customError("MessageAssociationInfraError"));g.MessageAssociationValidationErrorCode=a;g.MessageAssociationValidationError=c;g.MessageAssociationInfraErrorCode=e;g.MessageAssociationInfraError=f}),98);
__d("WAWebSagaSystemMsg",["WAWebContactSystemMsg","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebContactSystemMsg").genNotificationMsg(a,{type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"saga_init",templateParams:[]})}g.genSagaInitSystemMsg=a}),98);
__d("WAWebViewOnceGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("view_once_sp_receiver")}function b(){return d("WAWebABProps").getABPropConfigValue("enable_soox_message_receiving")}function c(){return d("WAWebABProps").getABPropConfigValue("enable_soox_message_sending")}g.isViewOnceSunsetEnabled=a;g.isReceivingViewOnceV2Enabled=b;g.isSendingViewOnceV2Enabled=c}),98);
__d("WAWebE2EProtoParser",["WALogger","WANullthrows","WAWebABPropsSaga","WAWebAssociationProtoUtils","WAWebBotGating","WAWebCommonMsgSubtypeTypes","WAWebCrashlog","WAWebE2EProtoParserForCtwaContext","WAWebE2EProtoUtils","WAWebHandleSingleMsg","WAWebMessageAssociation.flow","WAWebMessageAssociationGatingUtils","WAWebMessageAssociationValidation","WAWebMessagePluginParseProtobuf","WAWebMsgKeyUtils","WAWebMsgType","WAWebParseForwardedNewsletterMessageInfo","WAWebQuotedMessageProtoUtils","WAWebSagaSystemMsg","WAWebViewOnceGatingUtils","WAWebWamEnumE2eFailureReason","WAWebWid"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["InAppSupport: Could not upload logs. No ticketId was provided."]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["InAppSupport: Logs upload complete for ticketId=",", logsId=",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["InAppSupport: Logs upload failed for ticketId=",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["InAppSupport: Uploading logs for ticketId=",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseContextInfoProto: failed to parse forwarded newsletter info"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseContextInfoProto: payment not supported"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["drop: not Message"]);n=function(){return a};return a}function o(a,b,c,e,f,g,h,i,j,k,l){a||d("WALogger").ERROR(n()).devConsole(a,b).sendLogs("null-message");var m=a.messageContextInfo;a=q(a,b,c,e,f,g,h,i,j,k,l);b=a.contextInfo;e=a.msgData;s(e,b,c,g);x(e,m);return e}function p(a,b){b=b==null?void 0:b.messageAssociation;if(b!=null&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){var c=b.parentMessageKey;b=b.associationType;if(c==null)throw new(d("WAWebMessageAssociationValidation").MessageAssociationValidationError)(d("WAWebMessageAssociationValidation").MessageAssociationValidationErrorCode.MISSING_PARENT_MESSAGE_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(b==null)throw new(d("WAWebMessageAssociationValidation").MessageAssociationValidationError)(d("WAWebMessageAssociationValidation").MessageAssociationValidationErrorCode.MISSING_ASSOCIATION_TYPE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);var e=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(c,a);if(e==null)throw new(d("WAWebMessageAssociationValidation").MessageAssociationValidationError)(d("WAWebMessageAssociationValidation").MessageAssociationValidationErrorCode.INVALID_PARENT_MESSAGE_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);e=d("WAWebMsgKeyUtils").equalSendersAddressingSensitive(e,a.id);if(!e)throw new(d("WAWebMessageAssociationValidation").MessageAssociationValidationError)(d("WAWebMessageAssociationValidation").MessageAssociationValidationErrorCode.MISMATCH_SENDER,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.ERROR_PARENT_CHILD_SENDER_JID_MISMATCH);return{associationType:b,parentMessageKey:c}}return null}function q(a,b,c,e,f,g,h,i,j,k,l){var m,n=a.viewOnceMessage,o=a.viewOnceMessageV2,q=a.viewOnceMessageV2Extension,s=a.ephemeralMessage,t=a.documentWithCaptionMessage,x=a.groupMentionedMessage,y=a.editedMessage,z=a.botInvokeMessage,A=a.callLogMesssage,B=p(b,a.messageContextInfo);if(B!=null&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){var C=d("WAWebAssociationProtoUtils").getValidatedAssociationFieldsFromProto(B,b);if(C.associationType===d("WAWebMessageAssociation.flow").MessageAssociationType.UNKNOWN){var D=b;D=babelHelpers["extends"]({},D,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:"associatedUnknown",associationType:C.associationType,parentMsgKey:C.associationParentMsgKey,viewMode:C.viewMode});return{contextInfo:m,msgData:D}}}C=d("WAWebMessagePluginParseProtobuf").parseProtobuf({messageProtobuf:a,baseMessage:b,msgContext:c,paymentInfo:e,quotedPaymentInfo:g,editAttr:i,bizInfo:h,finalLocation:f,rcat:j,bizSource:k,msgMeta:l,messageAssociation:B});if(C){if(B!=null&&(C==null?void 0:C.msgData.associationType)!==d("WAWebAssociationProtoUtils").convertAssociationTypeFromProtoToClientSupportedAssociationType(B.associationType))throw new(d("WAWebMessageAssociationValidation").MessageAssociationValidationError)(d("WAWebMessageAssociationValidation").MessageAssociationValidationErrorCode.INVALID_CHILD_MESSAGE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);r(C.msgData);return C}x&&v(b,x,c);t&&v(b,t,c);n&&v(b,n,c);d("WAWebViewOnceGatingUtils").isViewOnceSunsetEnabled()&&(o&&v(b,o,c),q&&d("WAWebViewOnceGatingUtils").isReceivingViewOnceV2Enabled()&&v(b,q,c));(n||d("WAWebViewOnceGatingUtils").isViewOnceSunsetEnabled()&&(o||d("WAWebViewOnceGatingUtils").isReceivingViewOnceV2Enabled()&&q))&&r(b);s&&v(b,s,c);y&&v(b,y,c);D=a.deviceSentMessage;D&&u(b,D,c);z&&v(b,z,c);A&&w(b,A);return{contextInfo:m,msgData:b}}function r(a){if(a.isViewOnce!==!0)return;["body","caption","deprecatedMms3Url","directPath","encFilehash","filehash","mediaKey","mediaKeyTimestamp","scanLengths","scansSidecar","size","staticUrl","thumbnailDirectPath","thumbnailEncSha256","thumbnailSha256","url","height","width"].forEach(function(b){a[b]=void 0})}function s(a,b,c,e){if(!b)return;t(a,b,c,e);d("WAWebE2EProtoParserForCtwaContext").parseCtwaContextProto(a,b)}function t(a,b,c,e){var f=b.quotedMessage,g=b.mentionedJid,h=b.groupMentions;if(f!=null&&d("WAWebE2EProtoUtils").isQuotedSupported(f)){var i=a.selectedCarouselCardIndex!=null;a.quotedMsg=d("WAWebQuotedMessageProtoUtils").parseQuotedMessage({quotedMsg:f,msgContext:c,isCarouselCardReply:i,contextInfo:b,targetMessageKey:a.id})}a.quotedMsg&&a.quotedMsg.type==="payment"&&e&&d("WALogger").LOG(m());a.quotedStanzaID=b.stanzaId;a.quotedParticipant=d("WAWebE2EProtoUtils").decodeJid(b.participant);a.quotedRemoteJid=d("WAWebE2EProtoUtils").decodeJid(b.remoteJid);a.quotedGroupSubject=d("WAWebE2EProtoUtils").decodeJid(b.groupSubject);a.quotedParentGroupJid=d("WAWebE2EProtoUtils").decodeJid(b.parentGroupJid);a.mentionedJidList=Array.isArray(g)?g.map(d("WAWebE2EProtoUtils").decodeJid):g;a.groupMentions=Array.isArray(h)?h.map(function(a){return{groupSubject:a.groupSubject,groupJid:d("WAWebE2EProtoUtils").decodeJid(a.groupJid)}}):h;a.isForwarded=b.isForwarded;a.forwardingScore=b.forwardingScore;b.expiration!=null&&(a.ephemeralDuration=b.expiration);b.ephemeralSettingTimestamp!=null&&(a.ephemeralSettingTimestamp=b.ephemeralSettingTimestamp);b.ephemeralSharedSecret!=null&&(a.ephemeralSharedSecret=b.ephemeralSharedSecret);f=b.disappearingMode;if(f!=null){c=d("WAWebE2EProtoUtils").protoToDisappearingModeInitiator(a,f);c!=null&&(a.disappearingModeInitiator=c);i=d("WAWebE2EProtoUtils").protoToDisappearingMode(a,f);i!=null&&(a.disappearingModeTrigger=i.disappearingModeTrigger,a.disappearingModeInitiatedByMe=i.initiatedByMe)}b.actionLink!=null&&(a.actionLink=b.actionLink);b.smbClientCampaignId!=null&&(a.smbClientCampaignId=b.smbClientCampaignId);if(b.forwardedNewsletterMessageInfo!=null)try{a.forwardedNewsletterMessageInfo=d("WAWebParseForwardedNewsletterMessageInfo").parseForwardedNewsletterMessageInfo(b.forwardedNewsletterMessageInfo)}catch(a){d("WALogger").ERROR(l()).devConsole(a).sendLogs("Failed to parse Forwarded Newsletter Message Info.")}}function u(a,b,c){var e=d("WAWebE2EProtoUtils").decodeJid(b.destinationJid);a.id.remote=e;a.to=e;Object.assign(a,o(b.message,a,c))}function v(a,b,d){Object.assign(a,o(c("WANullthrows")(b.message),a,d))}function w(a,b){a.type=d("WAWebMsgType").MSG_TYPE.CALL_LOG;var c=!!b.isVideo;b.participants.length>1?a.subtype=c?d("WAWebCommonMsgSubtypeTypes").MsgSubtype.MissGroupVideo:d("WAWebCommonMsgSubtypeTypes").MsgSubtype.MissGroup:a.subtype=c?d("WAWebCommonMsgSubtypeTypes").MsgSubtype.MissVideo:d("WAWebCommonMsgSubtypeTypes").MsgSubtype.Miss}function x(a,b){var e;if(!b)return;b.messageSecret!=null&&(a.messageSecret=new Uint8Array(b.messageSecret));if(d("WAWebBotGating").isBotReceiveEnabled()&&(((e=a.id)==null?void 0:(e=e.participant)==null?void 0:e.isBot())||((e=a.id)==null?void 0:(e=e.remote)==null?void 0:e.isBot()))){(b==null?void 0:(e=b.botMetadata)==null?void 0:(e=e.pluginMetadata)==null?void 0:e.pluginType)!=null?a.botPluginType=b.botMetadata.pluginMetadata.pluginType:(b==null?void 0:(e=b.botMetadata)==null?void 0:e.pluginMetadata)!=null&&(a.botPluginMaybeParent=!0);(b==null?void 0:(e=b.botMetadata)==null?void 0:(e=e.pluginMetadata)==null?void 0:e.referenceIndex)!=null&&(a.botPluginReferenceIndex=b.botMetadata.pluginMetadata.referenceIndex);(b==null?void 0:(e=b.botMetadata)==null?void 0:(e=e.pluginMetadata)==null?void 0:e.provider)!=null&&(a.botPluginSearchProvider=b.botMetadata.pluginMetadata.provider);(b==null?void 0:(e=b.botMetadata)==null?void 0:(e=e.pluginMetadata)==null?void 0:e.searchProviderUrl)!=null&&(a.botPluginSearchUrl=b.botMetadata.pluginMetadata.searchProviderUrl);(b==null?void 0:(e=b.botMetadata)==null?void 0:(e=e.pluginMetadata)==null?void 0:e.thumbnailCdnUrl)!=null&&(a.botReelPluginThumbnailCdnUrl=b.botMetadata.pluginMetadata.thumbnailCdnUrl);(b==null?void 0:(e=b.botMetadata)==null?void 0:(e=e.pluginMetadata)==null?void 0:e.searchQuery)!=null&&(a.botPluginSearchQuery=b.botMetadata.pluginMetadata.searchQuery)}if(c("WAWebWid").isCAPISupportAccount(a==null?void 0:(e=a.id)==null?void 0:e.remote)&&(b==null?void 0:b.supportPayload)!=null){var f=JSON.parse(b.supportPayload);if(f.should_show_system_message===!0&&d("WAWebABPropsSaga").getIsSagaProtobufSystemMessageEnabled()){void d("WAWebHandleSingleMsg").handleSingleMsg(a==null?void 0:(e=a.id)==null?void 0:e.remote,d("WAWebSagaSystemMsg").genSagaInitSystemMsg(a==null?void 0:(b=a.id)==null?void 0:b.remote))}f.is_ai_message!=null&&d("WAWebABPropsSaga").getIsSagaProtobufAIStardustEnabled()&&(a.isSupportAIMessage=f.is_ai_message);if(f.should_upload_client_logs===!0&&d("WAWebABPropsSaga").getIsSagaV1ReengagementEnabled())if(f.ticket_id!=null&&f.ticket_id!=="no_ticket_created"){e=864e5;d("WALogger").LOG(k(),f.ticket_id);b={reason:d("WAWebCrashlog").SERVER_REQUESTED,immediate:!0,isHighPri:!0,logType:d("WAWebCrashlog").LogType.SUPPORT,ticketId:f.ticket_id,fromTimestamp:Date.now()-e};d("WAWebCrashlog").upload(b).then(function(a){a==null?d("WALogger").LOG(j(),f.ticket_id):d("WALogger").LOG(i(),f.ticket_id,a)})}else d("WALogger").LOG(h())}}g.parseMsgProto=o;g.validateMessageAssociationInMessageContextInfo=p;g.parseContextInfo=s;g.parseContextInfoProto=t;g.parseMessageContextInfoProto=x}),98);
__d("WAWebAddonProcessingError",["$InternalEnum","WAWebHandleMsgError","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){"use strict";var h=b("$InternalEnum")({MISSING_THREAD_MESSAGE_ID:"missing_thread_message_id",MISSING_THREAD_MESSAGE_SENDER_JID:"missing_thread_message_sender_jid"}),i=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c){a="type: "+a+", errorCode: "+String(c);c=b.call(this,a,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE)||this;c.name="PlaceholderValidationError";return c}return a}(d("WAWebHandleMsgError").MessageValidationError);a=function(a,b){var c=a.threadMsgId;a=a.threadMsgSenderJid;if(c==null)throw new i(b,h.MISSING_THREAD_MESSAGE_ID);else if(a==null)throw new i(b,h.MISSING_THREAD_MESSAGE_SENDER_JID);return{threadMsgId:c,threadMsgSenderJid:a}};g.validateMsgMeta=a}),98);
__d("WAWebSpecialEmojisWithSkinTones",[],(function(a,b,c,d,e,f){a={"\ud83e\udd1d\ud83c\udffb":"\ud83e\udd1d","\ud83e\udd1d\ud83c\udffc":"\ud83e\udd1d","\ud83e\udd1d\ud83c\udffd":"\ud83e\udd1d","\ud83e\udd1d\ud83c\udffe":"\ud83e\udd1d","\ud83e\udd1d\ud83c\udfff":"\ud83e\udd1d","\ud83d\udc6f\ud83c\udffb":"\ud83d\udc6f","\ud83d\udc6f\ud83c\udffc":"\ud83d\udc6f","\ud83d\udc6f\ud83c\udffd":"\ud83d\udc6f","\ud83d\udc6f\ud83c\udffe":"\ud83d\udc6f","\ud83d\udc6f\ud83c\udfff":"\ud83d\udc6f","\ud83d\udc6f\ud83c\udffb\u200d\u2642":"\ud83d\udc6f\u200d\u2642","\ud83d\udc6f\ud83c\udffc\u200d\u2642":"\ud83d\udc6f\u200d\u2642","\ud83d\udc6f\ud83c\udffd\u200d\u2642":"\ud83d\udc6f\u200d\u2642","\ud83d\udc6f\ud83c\udffe\u200d\u2642":"\ud83d\udc6f\u200d\u2642","\ud83d\udc6f\ud83c\udfff\u200d\u2642":"\ud83d\udc6f\u200d\u2642"};f["default"]=a}),66);
__d("WAWebConvertToTextWithoutSpecialEmojis",["WAWebEmojiCompile","WAWebSpecialEmojisWithSkinTones"],(function(a,b,c,d,e,f,g){var h=null;function a(a){if(!h){var b=c("WAWebEmojiCompile")(Object.keys(c("WAWebSpecialEmojisWithSkinTones")));h=new RegExp("("+b+")","g")}h.lastIndex=0;return a.replace(h,function(a){return c("WAWebSpecialEmojisWithSkinTones")[a]})}g.convertToTextWithoutSpecialEmojis=a}),98);
__d("WAWebInteractiveMessageType",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({NATIVE_FLOW:"native_flow",SHOPS_STOREFRONT:"shops_storefront",CAROUSEL:"carousel"});c=a;f["default"]=c}),66);
__d("WAWebInteractiveResponseMessageType",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({NATIVE_FLOW:"native_flow"});c=a;f["default"]=c}),66);
__d("WAWebE2EProtoUtils",["invariant","WABase64","WAJids","WALogger","WALongInt","WANullthrows","WATypeUtils","WAWebABProps","WAWebAddonCrossWindowUtils","WAWebAddonProcessMsgsUtils","WAWebAddonProcessingError","WAWebApiContact","WAWebBackendApi","WAWebBackendJobs.flow","WAWebBizCoexGatingUtils","WAWebBizGatingUtils","WAWebBizTemplateAndInteractiveMessagesUtils","WAWebConvertToTextWithoutSpecialEmojis","WAWebDBGroupsGroupMetadata","WAWebEphemeralityTypes","WAWebHandleMsgCommon","WAWebInteractiveMessageType","WAWebInteractiveMessagesNativeFlowName","WAWebInteractiveResponseMessageType","WAWebIsCagGroupCache","WAWebMobilePlatforms","WAWebMsgKey","WAWebMsgKeyUtils","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebUpdateDbForGroupActionApi","WAWebUserPrefsMeUser","WAWebVerifyProtobufMsgObjectKeys","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g,h){function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["url(deprecatedMms3Url) missing from msg type ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["fileEncSha256 missing from msg type ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["fileSha256 missing from msg type ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["directPath missing from msg type ",""]);l=function(){return a};return a}function m(a){if(d("WAWebABProps").getABPropConfigValue("web_unwrap_message_for_stanza_attributes")){var b;b=(b=d("WAWebVerifyProtobufMsgObjectKeys").getUnwrappedProtobufMessage(a))!=null?b:a}else b=a;if(b.ephemeralMessage){a=b.ephemeralMessage.message;return a?m(a):d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.text}if(b.groupMentionedMessage){a=b.groupMentionedMessage.message;return a?m(a):d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.text}if(b.botInvokeMessage){a=b.botInvokeMessage.message;return a?m(a):d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.text}if(b.deviceSentMessage){a=b.deviceSentMessage.message;return a?m(a):d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.text}if(b.reactionMessage||b.encReactionMessage)return d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.reaction;if(b.eventMessage||b.encEventResponseMessage||((a=b.secretEncryptedMessage)==null?void 0:a.secretEncType)===d("WAWebProtobufsE2E.pb").Message$SecretEncryptedMessage$SecretEncType.EVENT_EDIT)return d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.event;if(b.pollCreationMessage||b.pollCreationMessageV2||b.pollCreationMessageV3||b.pollUpdateMessage)return d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.poll;if(((a=b.extendedTextMessage)==null?void 0:a.matchedText)!=null&&b.extendedTextMessage.matchedText.trim()!=="")return d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.media;return Boolean(b.conversation)||b.extendedTextMessage||b.templateButtonReplyMessage||b.protocolMessage||b.interactiveMessage||b.keepInChatMessage||b.requestPhoneNumberMessage||b.editedMessage||b.pinInChatMessage||b.encCommentMessage||b.newsletterAdminInviteMessage||b.pollResultSnapshotMessage?d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.text:d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.media}function a(a){if(d("WAWebAddonCrossWindowUtils").getAddonProcessorType(a)===d("WAWebMsgType").MSG_TYPE.COMMENT){a=d("WAWebAddonProcessMsgsUtils").getParentMsgKey(a);var b=c("WANullthrows")(a.participant,"undefined participant");b=d("WAWebApiContact").getCurrentLid(d("WAWebWidFactory").toUserWid(b));return{threadMsgId:a.id,threadMsgSenderLid:c("WANullthrows")(b,"undefined lid")}}}function e(a){if(d("WAWebABProps").getABPropConfigValue("web_unwrap_message_for_stanza_attributes")){var b;b=(b=d("WAWebVerifyProtobufMsgObjectKeys").getUnwrappedProtobufMessage(a))!=null?b:a}else b=a;return b.reactionMessage!=null||b.encReactionMessage!=null||((a=b.pollUpdateMessage)==null?void 0:a.vote)!=null||b.keepInChatMessage!=null||b.editedMessage!=null||b.pinInChatMessage!=null||b.protocolMessage!=null&&b.protocolMessage.type===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.EPHEMERAL_SYNC_RESPONSE||((a=b.botInvokeMessage)==null?void 0:(a=a.message)==null?void 0:(a=a.protocolMessage)==null?void 0:a.type)===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REQUEST_WELCOME_MESSAGE||((a=b.protocolMessage)==null?void 0:a.type)===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REQUEST_WELCOME_MESSAGE||b.encEventResponseMessage!=null||((a=b.secretEncryptedMessage)==null?void 0:a.secretEncType)===d("WAWebProtobufsE2E.pb").Message$SecretEncryptedMessage$SecretEncType.EVENT_EDIT?d("WAWebBackendJobs.flow").DecryptFailType.Hide:d("WAWebBackendJobs.flow").DecryptFailType.Show}function f(a,b){var e=a.fromMe,f=a.id,g=a.participant;a=a.remoteJid;g=(g=g)!=null?g:b==null?void 0:b.toString();e!=null&&a!=null&&f!=null||h(0,56276);b=g!=null&&d("WAWebWidFactory").isWidlike(g)?d("WAWebWidFactory").createWid(g):void 0;g=d("WAWebWidFactory").createWid(a);(g.isGroup()||g.isBroadcast())&&e&&(b=d("WAWebUserPrefsMeUser").getMaybeMeUser());return new(c("WAWebMsgKey"))({fromMe:e,id:f,participant:b,remote:d("WAWebWidFactory").createWid(a)})}function n(a){var b;return{fromMe:a.fromMe,id:a.id,participant:a.fromMe?void 0:(b=a.participant)==null?void 0:b.toString({legacy:!0}),remoteJid:a.remote.toString({legacy:!0})}}function o(a){return{paymentStatus:a.status,paymentTxnStatus:a.txnStatus,paymentCurrency:a.currency||"",paymentAmount1000:c("WANullthrows")(d("WALongInt").maybeNumberOrThrowIfTooLarge(a.amount1000)),paymentMessageReceiverJid:d("WAWebWidFactory").createWid(c("WANullthrows")(a.receiverJid)),paymentExpiryTimestamp:d("WALongInt").maybeNumberOrThrowIfTooLarge(a.expiryTimestamp),paymentTransactionTimestamp:c("WANullthrows")(d("WALongInt").maybeNumberOrThrowIfTooLarge(a.transactionTimestamp))}}function p(a){var b,c=["XUS","XDX","USDP"];b=(a==null?void 0:(b=a.primaryAmount)==null?void 0:b.currencyCode)||(a==null?void 0:a.currency);return c.includes(b==null?void 0:b.toUpperCase())?!0:!1}function q(a,b){return a.remote.isGroup()&&!((a=a.participant)==null?void 0:a.equals(d("WAWebUserPrefsMeUser").getMeUser()))&&!b.equals(d("WAWebUserPrefsMeUser").getMeUser())?!1:!0}function r(a,b){return a!=null||(b==null?void 0:b.nativeFlowName)!=null?!d("WAWebBizGatingUtils").nativeFlowMessagesEnabled()?!1:s(a,b):!0}function s(a,b){return(a!=null||(b==null?void 0:b.nativeFlowName)!=null)&&(b==null?void 0:b.nativeFlowName)!=null?a!=null&&c("WAWebInteractiveMessagesNativeFlowName").cast(b.nativeFlowName)===a:!0}function t(a){return a===c("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS||a===c("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS||a===c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_STATUS||a===c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_METHOD||a===c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO}function u(a){var b;b=(b=a.interactiveMessage)==null?void 0:(b=b.nativeFlowMessage)==null?void 0:b.buttons;if(b!=null&&b.length>0&&!d("WAWebBizTemplateAndInteractiveMessagesUtils").buttonsViolateButtonImprovementsConstraints(b.map(function(a){return{nativeFlowButton:a}})))return String(d("WAWebBizTemplateAndInteractiveMessagesUtils").getNativeFlowNameByButtonName(b[0].name));if(((b=a.buttonsMessage)==null?void 0:(b=b.buttons)==null?void 0:b.length)===1){return String(d("WAWebBizTemplateAndInteractiveMessagesUtils").getNativeFlowNameByButtonName((b=a.buttonsMessage.buttons[0].nativeFlowInfo)==null?void 0:b.name))}}var v=["novi_login","novi_report_transaction","novi_hub","novi_view_code","novi_view_transaction","novi_view_bank_detail","novi_view_card_detail","wa_payment_transaction_details","wa_payment_learn_more","wa_payment_fbpin_reset"];function w(a){return a.some(function(a){return a.nativeFlowInfo&&v.includes(a.nativeFlowInfo.name)||v.includes(a.buttonId)})}function x(a){switch(a){case c("WAWebInteractiveMessageType").NATIVE_FLOW:return d("WAWebBizGatingUtils").interactiveNativeFlowMessagesEnabled();case c("WAWebInteractiveMessageType").SHOPS_STOREFRONT:return d("WAWebBizGatingUtils").shopsInteractiveMessageEnabled();case c("WAWebInteractiveMessageType").CAROUSEL:return d("WAWebBizGatingUtils").carouselsEnabled()}}function y(a){switch(a){case c("WAWebInteractiveMessageType").NATIVE_FLOW:return"nativeFlowMessage";case c("WAWebInteractiveMessageType").SHOPS_STOREFRONT:return"shopStorefrontMessage";case c("WAWebInteractiveMessageType").CAROUSEL:return"carouselMessage"}}function z(a){for(var b of c("WAWebInteractiveMessageType").members())if(y(b)in a)return b;return null}function A(a,b){b=b==null?void 0:b.messageVersion;if(b==null||a==null)return!1;switch(a){case c("WAWebInteractiveMessageType").NATIVE_FLOW:return b<=1;case c("WAWebInteractiveMessageType").SHOPS_STOREFRONT:return b<=1;case c("WAWebInteractiveMessageType").CAROUSEL:return b<=1}}function B(a){switch(a){case c("WAWebInteractiveResponseMessageType").NATIVE_FLOW:return"nativeFlowResponseMessage"}}function C(a){for(var b of c("WAWebInteractiveResponseMessageType").members())if(B(b)in a)return b;return null}function D(a){switch(a){case c("WAWebInteractiveResponseMessageType").NATIVE_FLOW:return d("WAWebBizGatingUtils").interactiveNativeFlowResponseMessagesEnabled()}}function E(a,b,d){switch(a){case c("WAWebInteractiveResponseMessageType").NATIVE_FLOW:b=c("WANullthrows")(b.nativeFlowResponseMessage);var e=c("WANullthrows")(c("WAWebInteractiveMessagesNativeFlowName").cast(b.name)),f=c("WANullthrows")(b.version);if(f>1||!s(e,d))throw c("err")("Invalid message");return{name:e,version:f,type:a,paramsJson:c("WANullthrows")(b.paramsJson)}}}function F(a){return a.reactionMessage!=null?!1:!0}function G(a){return a!=null&&c("WAWebWid").isWid(a)?d("WAWebWidFactory").createWid(a):a}function H(a){if(a==null)return;c("WAWebWid").isWid(a)||h(0,64887);return d("WAWebWidFactory").createWid(a)}function I(a,b){if(!a)throw c("err")("getMsgKey: no message key is defined for protocol message");var d=a.id;if(d==null||d==="")throw c("err")("getMsgKey: no message id is defined for protocol message");return M(d,a,b)}function J(a,b){if(a==null)return;var c=a.id;if(c==null)return;return M(c,a,b,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon)}function K(a,b){if(a==null)return;var c=a.id;if(c==null)return;return M(c,a,b,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Message)}function L(a,b,e){a=d("WAWebAddonProcessingError").validateMsgMeta(a,e);e=a.threadMsgId;a=a.threadMsgSenderJid;return new(c("WAWebMsgKey"))({id:e,fromMe:d("WAWebUserPrefsMeUser").isMeAccount(a),remote:b.chat,participant:a})}function M(a,b,e,f){var g,h,i;if(!(e==null?void 0:(g=e.id)==null?void 0:g.fromMe)){g=e.id.remote;var j=c("WAWebIsCagGroupCache").isCag(g);if(b.fromMe===!0){h=!1;i=e.author;if(j&&((j=i)==null?void 0:j.isLid())&&f!==d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon){j=d("WAWebApiContact").getPhoneNumber(e.author);j!=null&&(i=j)}}else{j=G(b.participant);!(j instanceof c("WAWebWid"))?h=!0:(h=d("WAWebUserPrefsMeUser").isMeAccount(j),(!g.isUser()||j.isBot())&&(h?i=j.isLid()?d("WAWebUserPrefsMeUser").getMeLidUser():d("WAWebUserPrefsMeUser").getMeUser():i=j))}}else{h=Boolean(b.fromMe);g=G(b.remoteJid);if(b.fromMe===!0){if(g instanceof c("WAWebWid")&&!g.isUser()){j=c("WAWebIsCagGroupCache").isCag(g);j=j&&f!==d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon;j=j||!((f=e.author)==null?void 0:f.isLid())?d("WAWebUserPrefsMeUser").getMeUser():d("WAWebUserPrefsMeUser").getMeLidUser();i=j}}else i=G(b.participant)}e.type===d("WAWebMsgType").MSG_TYPE.REACTION&&g!=null&&(g instanceof c("WAWebWid")&&g.isBroadcast()&&!g.isStatus()||d("WAJids").interpretAndValidateJid(g.toString()).jidType==="broadcast")&&(g=G(b.participant),i=void 0);return new(c("WAWebMsgKey"))({id:a,fromMe:h,remote:g,participant:i})}function N(a){return a==null||a===""||d("WAWebMobilePlatforms").getMobilePlatform()===d("WAWebMobilePlatforms").PLATFORMS.ANDROID?a:d("WAWebConvertToTextWithoutSpecialEmojis").convertToTextWithoutSpecialEmojis(a)}function O(a){var b={fromMe:a.fromMe,id:a.id},c=P(a.remote);a=P(a.participant);d("WATypeUtils").isString(c)&&(b.remoteJid=c);d("WATypeUtils").isString(a)&&(b.participant=a);return b}function P(a){if(a instanceof c("WAWebWid"))return a.toString({legacy:!0});else if(d("WATypeUtils").isString(a))return a.replace(/@c.us$/,"@s.whatsapp.net");return void 0}function Q(a){return a!=null&&a!==""?d("WABase64").decodeB64(a):void 0}function R(a){var b=P(a.to);a={fromMe:!0,id:a.id.id};d("WATypeUtils").isString(b)&&(a.remoteJid=b);return a}function S(a,b,c){if(Boolean(b.viewOnce))return;b.directPath==null&&b.staticUrl==null&&d("WALogger").LOG(l(),a).sendLogs("outgoing-"+a+"-message-missing-direct-path");b.fileSha256==null&&d("WALogger").LOG(k(),a).sendLogs("outgoing-"+a+"-message-missing-file-sha");!c&&b.fileEncSha256==null&&d("WALogger").LOG(j(),a).sendLogs("outgoing-"+a+"-message-missing-file-enc-sha");b.url==null&&b.staticUrl==null&&!c&&d("WALogger").LOG(i(),a).sendLogs("outgoing-"+a+"-message-missing-mms3-url")}function T(a,b,c){var e,f,g;switch(a){case d("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat:e=d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.CHANGED_IN_CHAT;break;case d("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe:e=d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.INITIATED_BY_ME;break;case d("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByOther:e=d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.INITIATED_BY_OTHER;break;case d("WAWebEphemeralityTypes").DisappearingModeInitiator.BizUpgradeFbHosting:e=d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.INITIATED_BY_OTHER;break}if(d("WAWebABProps").getABPropConfigValue("dm_initiator_trigger")){if(b)switch(b){case d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings:f=d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.CHAT_SETTING;break;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings:f=d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.ACCOUNT_SETTING;break;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.BulkChange:f=d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.BULK_CHANGE;break;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.Unknown:f=d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.UNKNOWN;break;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.UnknownGroups:f=d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.UNKNOWN_GROUPS;break;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.BizSupportFbHosting:f=d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.UNKNOWN;break}c!=null&&(g=c)}return{initiator:e,trigger:f,initiatedByMe:g}}function U(a,b){if(a.from==null)return;a=d("WAWebUserPrefsMeUser").isMeAccount(a.from);if(b.initiator==null)return;switch(b.initiator){case d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.CHANGED_IN_CHAT:return d("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat;case d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.INITIATED_BY_ME:return a?d("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe:d("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByOther;case d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.INITIATED_BY_OTHER:case d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.BIZ_UPGRADE_FB_HOSTING:return a?d("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByOther:d("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe}}function V(a,b){if(!d("WAWebABProps").getABPropConfigValue("dm_initiator_trigger"))return;a=d("WAWebUserPrefsMeUser").isMeAccount(a.from);var c=b.initiator,e=b.trigger,f=b.initiatedByMe;if(e!=null&&d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&e===d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.BIZ_SUPPORTS_FB_HOSTING)return{disappearingModeTrigger:Y(e),initiatedByMe:a?f:!f};if(e!=null&&f!=null)return{disappearingModeTrigger:Y(e),initiatedByMe:a?f:!f};if(b.initiator==null)return;if(c!=null)switch(c){case d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.CHANGED_IN_CHAT:return{disappearingModeTrigger:d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings};case d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.INITIATED_BY_ME:return{disappearingModeTrigger:d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings,initiatedByMe:a};case d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.BIZ_UPGRADE_FB_HOSTING:case d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.INITIATED_BY_OTHER:return{disappearingModeTrigger:d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings,initiatedByMe:!a}}}function W(a,b){return X.apply(this,arguments)}function X(){X=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(b)),e=c==null?void 0:c.disappearingModeInitiatedByMe;c!=null&&a!=null&&c.disappearingModeTrigger===d("WAWebEphemeralityTypes").DisappearingModeTrigger.UnknownGroups&&a!==d("WAWebEphemeralityTypes").DisappearingModeTrigger.UnknownGroups&&(void d("WAWebUpdateDbForGroupActionApi").syncDisappearingModeTriggerToDB(b,a),void d("WAWebBackendApi").frontendFireAndForget("syncEphemeralTriggerCollectionForGroup",{chatId:b,trigger:a}));if(e!=null)return{disappearingModeTrigger:a,disappearingModeInitiatedByMe:e}});return X.apply(this,arguments)}function Y(a){switch(a){case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.CHAT_SETTING:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings;case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.ACCOUNT_SETTING:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings;case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.BULK_CHANGE:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.BulkChange;case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.BIZ_SUPPORTS_FB_HOSTING:return d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()?d("WAWebEphemeralityTypes").DisappearingModeTrigger.BizSupportFbHosting:d("WAWebEphemeralityTypes").DisappearingModeTrigger.Unknown;case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.UNKNOWN_GROUPS:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.UnknownGroups;case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.UNKNOWN:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.Unknown}}var Z=function(a){return a};g.typeAttributeFromProtobuf=m;g.extractCommentTargetIdAndSenderLid=a;g.decryptFailAttributeFromProtobuf=e;g.protobufToMsgKey=f;g.msgKeyToProtobuf=n;g.parseMsgPaymentInfo=o;g.hasUnsupportedCurrency=p;g.isEitherSenderOrReceiverOfPaymentMessage=q;g.shouldParseNFM=r;g.isValidNativeFlowName=s;g.isOrderNativeFlow=t;g.getBizNativeFlowName=u;g.hasUnsupportedButtons=w;g.isInteractiveMessageTypeEnabled=x;g.getInteractiveMessageFieldNameForType=y;g.getInteractiveMessageTypeForProto=z;g.isSupportedInteractiveMessageVersion=A;g.getInteractiveResponseMessageFieldNameForType=B;g.getInteractiveResponseMessageTypeForProto=C;g.isInteractiveResponseMessageTypeEnabled=D;g.getInteractiveResponsePayload=E;g.isQuotedSupported=F;g.decodeJid=G;g.strictDecodeJid=H;g.getMsgKey=I;g.translateAddonMessageKeyToLocalReference=J;g.translateRegularMessageKeyToLocalReference=K;g.createMsgKeyFromThreadInfo=L;g.translateKeyToLocalReference=M;g.convertToTextWithoutSpecialEmojis=N;g.encodeKey=O;g.encodeJid=P;g.encodeBytes=Q;g.createMessageKey=R;g.validateOutgoingRequiredMediaProperties=S;g.disappearingModeInitiatorToProto=T;g.protoToDisappearingModeInitiator=U;g.protoToDisappearingMode=V;g.updateDisappearingModeForGroups=W;g.getMutableMessageProtobuf=Z}),98);
__d("WAWebBizOrderDetailsParams",["$InternalEnum"],(function(a,b,c,d,e,f){e=b("$InternalEnum")({PIX_STATIC_CODE:"pix_static_code",PIX_DYNAMIC_CODE:"pix_dynamic_code",CARDS:"cards",PAYMENT_GATEWAY:"payment_gateway"});function a(a){return JSON.parse(a)}function c(a){return JSON.stringify(a)}function d(a){return JSON.stringify(a)}f.PaymentSettingType=e;f.parse=a;f.stringify=c;f.stringifyPaymentStatus=d}),66);
__d("WAWebStateUtils",[],(function(a,b,c,d,e,f){function a(a){return(a==null?void 0:a.$ProxyState$state)?a.$ProxyState$state:a}f.unproxy=a}),66);
__d("WAWebOrderDetails",["WAWebBizOrderDetailsParams","WAWebInteractiveMessageType","WAWebInteractiveMessagesNativeFlowName","WAWebMsgType","WAWebStateUtils","filterNulls"],(function(a,b,c,d,e,f,g){function h(a){var b=a==null?void 0:a.value;if(b==null)return;a=(a=a==null?void 0:a.offset)!=null?a:1;return parseFloat((b=b)!=null?b:0)/parseInt(a,10)}function i(a){return a==null?null:c("filterNulls")(a.map(function(a){return(a==null?void 0:a.type)!=null?babelHelpers["extends"]({type:a.type},a.payment_instruction!=null?{paymentInstruction:a.payment_instruction}:{}):null}))}var j=function(){return"custom-item"},k=function(a,b){var c;if(a!=="review_and_pay"&&a!=="payment_info"||b==null)return null;b=d("WAWebBizOrderDetailsParams").parse(b);var e=b.order,f=b.currency,g=b.reference_id,k=b.payment_configuration,l=b.external_payment_configurations,m=b.payment_settings,n=h(b.total_amount);c=(c=e==null?void 0:e.items)!=null?c:[];var o=c.map(function(a){var b;return{id:(b=(b=a==null?void 0:a.product_id)!=null?b:a==null?void 0:a.retailer_id)!=null?b:"",name:(b=a==null?void 0:a.name)!=null?b:"",amount:h(a==null?void 0:a.amount),quantity:parseInt((b=a==null?void 0:a.quantity)!=null?b:0,10),isCustomItem:(b=a==null?void 0:a.isCustomItem)!=null?b:(a==null?void 0:(b=a.retailer_id)==null?void 0:b.indexOf(j()))===0,isQuantitySet:(b=a==null?void 0:a.isQuantitySet)!=null?b:!0}}),p=o.reduce(function(a,b){return a+b.quantity},0);c=(c=c[0])==null?void 0:c.name;if(a==="payment_info"&&(m==null?void 0:m.length)===1&&m[0].type===d("WAWebBizOrderDetailsParams").PaymentSettingType.PIX_STATIC_CODE){var q=m[0][d("WAWebBizOrderDetailsParams").PaymentSettingType.PIX_STATIC_CODE];c=q.merchant_name}if(c==null||g==null||f==null||n==null)return null;q=h(e==null?void 0:e.shipping);var r=h(e==null?void 0:e.tax),s=h(e==null?void 0:e.discount);e=h(e==null?void 0:e.subtotal);l=i(l);return babelHelpers["extends"]({title:c,referenceId:g,currency:f,quantity:p,shipping:q,tax:r,discount:s,subtotal:e,totalAmount:n,items:o,payment_configuration:k,type:b.type},l!=null?{externalPaymentConfigurations:l}:{},{paymentSettings:m,buttonName:a})};a=function(a){return l(d("WAWebStateUtils").unproxy(a.safe()))};var l=function(a){var b;if(a.nativeFlowName!==c("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS&&a.nativeFlowName!==c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO)return null;if(a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&a.interactiveType===c("WAWebInteractiveMessageType").NATIVE_FLOW&&((b=a.interactivePayload)==null?void 0:b.buttons)){b=a.interactivePayload.buttons[0];var e=b.name;b=b.buttonParamsJson;return k(e,b)}else if(a.type===d("WAWebMsgType").MSG_TYPE.NATIVE_FLOW){b=((e=a.nativeFlowButtons)!=null?e:[])[0].nativeFlowInfo;return k(b==null?void 0:b.name,b==null?void 0:b.paramsJson)}};g.getCustomItemIdPrefix=j;g.paramsJsonToOrderInfo=k;g.getOrderInfoFromMsg=a;g.getOrderInfo=l}),98);
__d("WAWebNativeFlowValidation",["WAWebBizGatingUtils","WAWebBizTemplateAndInteractiveMessagesUtils","WAWebInteractiveMessageType","WAWebInteractiveMessagesNativeFlowName","WAWebMsgType","WAWebOrderDetails","WAWebOrderPaymentStatus","WAWebOrderStatus"],(function(a,b,c,d,e,f,g){function a(a,b,e){if(a.nativeFlowName==null)return!1;switch(a.nativeFlowName){case c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO:return d("WAWebOrderDetails").getOrderInfo(a)!=null;case c("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS:return d("WAWebOrderDetails").getOrderInfo(a)!=null;case c("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS:return d("WAWebOrderStatus").getOrderStatusInfo(a)!=null;case c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_STATUS:return d("WAWebOrderPaymentStatus").getOrderPaymentStatusInfoFromNativeFlow(a)!=null;case c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_METHOD:return d("WAWebOrderPaymentStatus").getOrderPaymentStatusInfoFromNativeFlow(a)!=null;case c("WAWebInteractiveMessagesNativeFlowName").MESSAGE_WITH_LINK:return h(a)!==!1;case c("WAWebInteractiveMessagesNativeFlowName").MESSAGE_WITH_LINK_STATUS:return d("WAWebBizGatingUtils").isMessageWithLinkNfmEnabled();case c("WAWebInteractiveMessagesNativeFlowName").CTA_CALL:return d("WAWebBizTemplateAndInteractiveMessagesUtils").isInteractiveCtaMessageEnabled(c("WAWebInteractiveMessagesNativeFlowName").CTA_CALL,e,b)&&i(a)!=null;case c("WAWebInteractiveMessagesNativeFlowName").CTA_URL:return d("WAWebBizTemplateAndInteractiveMessagesUtils").isInteractiveCtaMessageEnabled(c("WAWebInteractiveMessagesNativeFlowName").CTA_URL,e,b)&&i(a)!=null;case c("WAWebInteractiveMessagesNativeFlowName").QUICK_REPLY:return d("WAWebBizTemplateAndInteractiveMessagesUtils").isInteractiveCtaMessageEnabled(c("WAWebInteractiveMessagesNativeFlowName").QUICK_REPLY,e,b)&&i(a)!=null;case c("WAWebInteractiveMessagesNativeFlowName").CTA_CATALOG:return d("WAWebBizTemplateAndInteractiveMessagesUtils").isInteractiveCtaMessageEnabled(c("WAWebInteractiveMessagesNativeFlowName").CTA_CATALOG,e,b)&&i(a)!=null;case c("WAWebInteractiveMessagesNativeFlowName").CTA_COPY_CODE:return d("WAWebBizTemplateAndInteractiveMessagesUtils").isInteractiveCtaMessageEnabled(c("WAWebInteractiveMessagesNativeFlowName").CTA_COPY_CODE,e,b)&&i(a)!=null}return!1}function h(a){if(d("WAWebBizGatingUtils").isMessageWithLinkNfmEnabled()){if(a.nativeFlowName!==c("WAWebInteractiveMessagesNativeFlowName").MESSAGE_WITH_LINK||a.type!==d("WAWebMsgType").MSG_TYPE.INTERACTIVE||a.interactiveType!==c("WAWebInteractiveMessageType").NATIVE_FLOW||a.interactivePayload==null)return!1;a=a.interactivePayload;if((a==null?void 0:a.buttons)&&a.buttons.length>0){a=a.buttons[0];var b=a.name;a=a.buttonParamsJson;if(b==="open_webview"&&a!=null)return!0}}return!1}function i(a){var b;a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&a.interactiveType===c("WAWebInteractiveMessageType").NATIVE_FLOW&&d("WAWebBizTemplateAndInteractiveMessagesUtils").supportedNativeFlowButtonNamesForInteractiveMsg.includes(a.nativeFlowName)&&((b=a.interactivePayload)==null?void 0:b.buttons)!=null&&a.interactivePayload.buttons.forEach(function(a){a=j(a);if(a)return!0});return!1}function j(a){return d("WAWebBizTemplateAndInteractiveMessagesUtils").supportedNativeFlowButtonNamesForInteractiveMsg.includes(d("WAWebBizTemplateAndInteractiveMessagesUtils").getNativeFlowNameByButtonName(a.name))}g.isValidNativeFlowMessage=a}),98);
__d("WAWebParseNonNFMButtonsMessageProto",["WAWebButtonsMessageProtoUtils","WAWebE2EProtoUtils","WAWebInteractiveMessagesNativeFlowName","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,e=a.baseMessage,f=a.bizInfo;a=a.msgContext;b=b.buttonsMessage;if(b==null)return;var g=b.buttons;g=g===void 0?[]:g;var h=b.headerType,i=c("WAWebInteractiveMessagesNativeFlowName").cast(d("WAWebE2EProtoUtils").getBizNativeFlowName({buttonsMessage:b}));if(i!=null||(f==null?void 0:f.nativeFlowName)!=null)return;if(d("WAWebE2EProtoUtils").hasUnsupportedButtons(g))return{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"phone_only_feature"}),contextInfo:b.contextInfo};if(h===d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.UNKNOWN||!new Set(d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.members()).has(h))return{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown}),contextInfo:b.contextInfo};i=d("WAWebButtonsMessageProtoUtils").parseButtonsMessageProto({buttonsMessage:b,baseMessage:e,msgContext:a});return g.length?{msgData:babelHelpers["extends"]({},i,{isDynamicReplyButtonsMsg:!0,dynamicReplyButtons:g}),contextInfo:b.contextInfo}:{msgData:i,contextInfo:b.contextInfo}}g["default"]=a}),98);
__d("WAWebParseTemplateMessageProto",["WANullthrows","WAWebBizTemplateAndInteractiveMessagesUtils","WAWebE2EProtoUtils","WAWebMsgType","WAWebParseDocumentMessageProto","WAWebParseImageMessageProto","WAWebParseInteractiveMessageProto","WAWebParseLocationMessageProto","WAWebParseVideoMessageProto"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,e=a.baseMessage,f=a.msgContext;a=b.templateMessage;if(a==null)return;b=a.interactiveMessageTemplate;if(b)return h(e,f,b,a.templateId);b=(b=a.hydratedTemplate)!=null?b:c("WANullthrows")(a.hydratedFourRowTemplate);var g=b.documentMessage,i=b.imageMessage,j=b.locationMessage,k=b.videoMessage;a=b.hydratedButtons;var l=b.hydratedContentText,m=b.hydratedFooterText,n=b.hydratedTitleText;b=b.templateId;var o=function(){var a=babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.CHAT,kind:d("WAWebMsgType").MsgKind.Chat},Boolean(l)&&{body:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(l)});if(i){var b;return(b=(b=c("WAWebParseImageMessageProto")({messageProtobuf:{imageMessage:i},baseMessage:e,msgContext:f}))==null?void 0:b.msgData)!=null?b:a}if(g){return(b=(b=c("WAWebParseDocumentMessageProto")({messageProtobuf:{documentMessage:g},baseMessage:e,msgContext:f}))==null?void 0:b.msgData)!=null?b:a}if(j){return(b=(b=c("WAWebParseLocationMessageProto")({messageProtobuf:{locationMessage:j},baseMessage:e,msgContext:f}))==null?void 0:b.msgData)!=null?b:a}if(k){return(b=(b=c("WAWebParseVideoMessageProto")({messageProtobuf:{videoMessage:k},baseMessage:e,msgContext:f}))==null?void 0:b.msgData)!=null?b:a}return a};if(d("WAWebBizTemplateAndInteractiveMessagesUtils").buttonsViolateButtonImprovementsConstraints(a.map(function(a){return{hydratedTemplateButton:a}})))return{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"phone_only_feature"}),contextInfo:void 0};o=o();return{msgData:babelHelpers["extends"]({},o,{templateId:b,isFromTemplate:!0,caption:Boolean(l)?d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(l):o.caption,footer:Boolean(m)?d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(m):o.footer,title:Boolean(n)?d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(n):o.title},a.length>0&&{hydratedButtons:a}),contextInfo:void 0}}function h(a,b,e,f){var g;g=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.CHAT,kind:d("WAWebMsgType").MsgKind.Chat},Boolean((g=e.body)==null?void 0:g.text)&&{body:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis((g=e.body)==null?void 0:g.text)});a=(b=(e=c("WAWebParseInteractiveMessageProto")({messageProtobuf:{interactiveMessage:e},baseMessage:a,msgContext:b,bizSource:a.bizSource||""}))==null?void 0:e.msgData)!=null?b:g;return{msgData:babelHelpers["extends"]({},a,{templateId:f,isFromTemplate:!0,caption:a.caption,footer:a.footer,title:a.title}),contextInfo:void 0}}g["default"]=a}),98);
__d("WAWebQuotedMessageProtoUtils",["WALogger","WAWebE2EProtoParser","WAWebMsgType"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["failed parsing quoted message: ",""]);h=function(){return a};return a}function i(a){var b=a.quotedMsg,c=a.msgContext;a=a.isCarouselCardReply;return d("WAWebE2EProtoParser").parseMsgProto(b,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN},c==="history"?"history_quoted":"quoted",null,null,null,null,null,null,a?"quoted_carousel_card":null)}function a(a){try{return i(a)}catch(a){d("WALogger").ERROR(h(),a).sendLogs("parse-quoted-msg-error");return null}}g.parseQuotedMessage=a}),98);
__d("WAWebApiActiveMessageRanges",["Promise","WALogger","WANullthrows","WASyncAction.pb","WAWebDBMsgUtils","WAWebSchemaActiveMessageRanges","asyncToGeneratorRuntime","decodeProtobuf","err"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["getRangesForChat failed with error: ",""]);i=function(){return a};return a}var j=new Map(),k={reset:function(){j=new Map()},removeRange:function(a,b){var c;(c=j.get(a))==null?void 0:c["delete"](b);return d("WAWebSchemaActiveMessageRanges").getActiveMessageRangesTable().remove([a,b])},createOrReplaceRange:function(a){var b=j.get(a.chatId);b==null&&(b=new Map(),j.set(a.chatId,b));b.set(a.action,a);return d("WAWebSchemaActiveMessageRanges").getActiveMessageRangesTable().createOrReplace(a)},bulkCreateOrReplaceRanges:function(a,c){c===void 0&&(c=!0);a.forEach(function(a){var b=j.get(a.chatId);b==null&&(b=new Map(),j.set(a.chatId,b));b.set(a.action,a)});return c?d("WAWebSchemaActiveMessageRanges").getActiveMessageRangesTable().bulkCreateOrReplace(a):(h||(h=b("Promise"))).resolve()},getRangesForChat:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=j.get(a);try{if(b==null){var c=(yield d("WAWebSchemaActiveMessageRanges").getActiveMessageRangesTable().anyOf(["chatId"],[a]));b=new Map(c.map(function(a){return[a.action,a]}));j.set(a,b)}}catch(a){d("WALogger").ERROR(i(),a)}return b?Array.from(b.values()):[]});function c(b){return a.apply(this,arguments)}return c}()};function l(a,b){switch(a){case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.Archive:return{action:d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.Archive,actionValue:c("WANullthrows")(b.archiveChatAction)};case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.MarkChatAsRead:return{action:d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.MarkChatAsRead,actionValue:c("WANullthrows")(b.markChatAsReadAction)};case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatKeepStarredKeepMedia:return{action:d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatKeepStarredKeepMedia,actionValue:c("WANullthrows")(b.clearChatAction)};case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatKeepStarredDeleteMedia:return{action:d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatKeepStarredDeleteMedia,actionValue:c("WANullthrows")(b.clearChatAction)};case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatDeleteStarredKeepMedia:return{action:d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatDeleteStarredKeepMedia,actionValue:c("WANullthrows")(b.clearChatAction)};case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatDeleteStarredDeleteMedia:return{action:d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatDeleteStarredDeleteMedia,actionValue:c("WANullthrows")(b.clearChatAction)};case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.DeleteChatDeleteMedia:return{action:d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.DeleteChatDeleteMedia,actionValue:c("WANullthrows")(b.deleteChatAction)};case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.DeleteChatKeepMedia:return{action:d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.DeleteChatKeepMedia,actionValue:c("WANullthrows")(b.deleteChatAction)};default:throw c("err")("unsupported action for message ranges: "+String(a))}}function a(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,c);var e=l(b,c);e=e.actionValue;e=((e=e.messageRange)==null?void 0:e.messages)||[];var f=(yield d("WAWebDBMsgUtils").filterReceivedMessagesInRange(a,e));e=Math.max(0,e.length-f.length);return k.createOrReplaceRange(babelHelpers["extends"]({chatId:a},l(b,c),{remainingMessages:e}))});return m.apply(this,arguments)}function e(a,b){return k.removeRange(a,b)}function f(a,b){b===void 0&&(b=!0);return k.bulkCreateOrReplaceRanges(a,b)}function n(a){return k.getRangesForChat(a)}function o(a,b){switch(a){case"archive":return d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.Archive;case"markChatAsRead":return d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.MarkChatAsRead;case"clearChat":if((b==null?void 0:b.deleteStarred)&&b.deleteMedia)return d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatDeleteStarredDeleteMedia;else if((b==null?void 0:b.deleteStarred)&&!b.deleteMedia)return d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatDeleteStarredKeepMedia;else if((b==null?void 0:b.deleteMedia)&&!b.deleteStarred)return d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatKeepStarredDeleteMedia;return d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatKeepStarredKeepMedia;case"deleteChat":return(b==null?void 0:b.deleteMedia)?d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.DeleteChatDeleteMedia:d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.DeleteChatKeepMedia;default:throw c("err")("unsupported active message range action")}}g._cache=k;g.addActiveMessageRange=a;g.removeActiveMessageRange=e;g.bulkUpdateActiveMessageRanges=f;g.getActiveMessageRanges=n;g.getActiveRangeAction=o}),98);
__d("WAWebBusinessHSMTypes",[],(function(a,b,c,d,e,f){a={MARKETING:"MARKETING",UTILITY:"UTILITY",AUTHENTICATION:"AUTHENTICATION"};f.HSM_TAG_TYPE=a}),66);
__d("WAWebProtobufsMdStorageChatRowOpaqueData.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({NONE:0,IMAGE:1,VIDEO:2});c={};e={};f={};b={};c.internalSpec={draftMessage:[1,(d=d("WAProtoConst")).TYPES.MESSAGE,e]};e.internalSpec={text:[1,d.TYPES.STRING],omittedUrl:[2,d.TYPES.STRING],ctwaContextLinkData:[3,d.TYPES.MESSAGE,b],ctwaContext:[4,d.TYPES.MESSAGE,f],timestamp:[5,d.TYPES.INT64]};f.internalSpec={conversionSource:[1,d.TYPES.STRING],conversionData:[2,d.TYPES.BYTES],sourceUrl:[3,d.TYPES.STRING],sourceId:[4,d.TYPES.STRING],sourceType:[5,d.TYPES.STRING],title:[6,d.TYPES.STRING],description:[7,d.TYPES.STRING],thumbnail:[8,d.TYPES.STRING],thumbnailUrl:[9,d.TYPES.STRING],mediaType:[10,d.TYPES.ENUM,a],mediaUrl:[11,d.TYPES.STRING],isSuspiciousLink:[12,d.TYPES.BOOL]};b.internalSpec={context:[1,d.TYPES.STRING],sourceUrl:[2,d.TYPES.STRING],icebreaker:[3,d.TYPES.STRING],phone:[4,d.TYPES.STRING]};g.ChatRowOpaqueData$DraftMessage$CtwaContextData$ContextInfoExternalAdReplyInfoMediaType=a;g.ChatRowOpaqueDataSpec=c;g.ChatRowOpaqueData$DraftMessageSpec=e;g.ChatRowOpaqueData$DraftMessage$CtwaContextDataSpec=f;g.ChatRowOpaqueData$DraftMessage$CtwaContextLinkDataSpec=b}),98);
__d("WAWebDBChatSerialization",["WAWebProtobufsMdStorageChatRowOpaqueData.pb","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g){var h=["draftMessage"];function a(a){a=babelHelpers["extends"]({},a);i(a);return a}function i(a){var b=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsMdStorageChatRowOpaqueData.pb").ChatRowOpaqueDataSpec,a.chatRowOpaqueData);h.forEach(function(c){(b==null?void 0:b[c])!=null&&(a[c]=b==null?void 0:b[c])})}function b(a){a=babelHelpers["extends"]({},a);j(a);return a}function j(a){var b={};h.forEach(function(c){b[c]=a[c],delete a[c]});var c=d("encodeProtobuf").encodeProtobuf(d("WAWebProtobufsMdStorageChatRowOpaqueData.pb").ChatRowOpaqueDataSpec,b);a.chatRowOpaqueData=c.readBuffer()}g.deserializeChat=a;g.serializeChat=b}),98);
__d("WAWebApiChat",["Promise","WALogger","WATimeUtils","WAWeb-dexie","WAWebAck","WAWebApiContact","WAWebBackendApi","WAWebBusinessHSMTypes","WAWebChatThreadLogging","WAWebDBChatSerialization","WAWebDBMsgUtils","WAWebEphemeralityUtils","WAWebMiscErrors","WAWebModelStorageUtils","WAWebMsgGetters","WAWebMsgType","WAWebPnhGatingUtils","WAWebSchemaChat","WAWebSchemaMessage","WAWebTrustedContactsUtils","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["chat with id "," is not found"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["createChatRecord: update chat table failed"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["reduceChatUnreadCount: could not find chat with id ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["removeUnreadMentionChat: could not find chats"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["addUnreadMentionChat: could not find chats"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["markMessageAndChatAsRead: chatId: ",", update acks for "," messages"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["markMessageAndChatAsRead: chatId: ",", update unread to ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["markMessageAndChatAsRead: lastReadRowId: ",", chatId: ",", keepChatUnread: ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateMarkChatAsReadSync: could not find chat with id ",""]);q=function(){return a};return a}var r=new Map(),s=function(b){babelHelpers.inheritsLoose(a,b);function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(a=c=b.call.apply(b,[this].concat(e))||this,c.name="CreateChatDuplicateError",a)||babelHelpers.assertThisInitialized(c)}return a}(babelHelpers.wrapNativeSuper(Error));function a(a,b){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{yield d("WAWebSchemaChat").getChatTable().create(babelHelpers["extends"]({id:a.toString()},b))}catch(a){if(a instanceof d("WAWebMiscErrors").DbOnLogoutAbort)throw a;d("WALogger").ERROR(j()).verbose().devConsole(a);if(a instanceof c("WAWeb-dexie").ConstraintError)throw new s();throw c("err")("update chat table failed")}d("WAWebPnhGatingUtils").isMatFullyEnabled()&&a.isUser()&&Q(a)});return t.apply(this,arguments)}function e(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=(yield d("WAWebSchemaChat").getChatTable().get(a.toString(),!1));if(e)return{unreadCount:e.unreadCount,timestamp:e.t};d("WALogger").ERROR(i(),a.toString());return(h||(h=b("Promise"))).reject(c("err")("Failed to find row in chat table"))});return u.apply(this,arguments)}function f(a){return d("WAWebModelStorageUtils").getStorage().lock(["chat"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var c=(yield b.get(a));if(c==null){d("WALogger").ERROR(q(),a);return}if(c.unreadCount===-1)return b.createOrMerge(a,{id:a,unreadCount:0,unreadMentionsOfMe:[],unreadMentionCount:0})});return function(a){return c.apply(this,arguments)}}())}function v(a){return d("WAWebSchemaChat").getChatTable().bulkCreateOrMerge(a)}function w(a){a=Array.from(a).map(function(a){var b=a[0];a=a[1];return{id:b,chatlistPreview:a,lastReactionPreview:void 0}});return d("WAWebSchemaChat").getChatTable().bulkCreateOrMerge(a)}function x(a){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaMessage").getMessageTable().equals(["from","pendingReadReceipt"],[a,d("WAWebDBMsgUtils").PendingReadReceiptType.Message],{shouldDecrypt:!1}));return a.filter(function(a){return a.type!==d("WAWebMsgType").MSG_TYPE.UNKNOWN})});return y.apply(this,arguments)}function z(a,c,e){d("WALogger").DEV(p(),a,c,e);return d("WAWebModelStorageUtils").getStorage().lock(["message","chat"],function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(f){f[0];f=f[1];var g=(yield x(c)),i=[],j=0,k=[];g.forEach(function(b){b.hsmTag===d("WAWebBusinessHSMTypes").HSM_TAG_TYPE.AUTHENTICATION&&d("WAWebBackendApi").frontendFireAndForget("logOTPMessageReadActions",{msgRow:b});if(a==null||b.rowId!=null&&b.rowId>a){j++;if(d("WAWebMsgGetters").getIsImportantMessage(b)){var c={id:b.id,timestamp:b.t};k.push(c)}return}i.push({id:b.id,ack:Math.max(b.ack,d("WAWebAck").ACK.READ),pendingReadReceipt:null})});g=j===0&&e?-1:j;d("WALogger").DEV(o(),c,g);f=[f.merge(c,{id:c,unreadCount:g,unreadDividerOffset:0,unreadMentionsOfMe:k,unreadMentionCount:0})];i.length>0&&(d("WALogger").DEV(n(),c,i.length),f.push(d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(i).then(function(){return d("WAWebChatThreadLogging").handleActivitiesForChatThreadLogging([{activityType:"msgRead",ts:d("WATimeUtils").unixTime(),chatId:d("WAWebWidFactory").createWid(c),readCount:i.length}])})));yield (h||(h=b("Promise"))).all(f)});return function(a){return f.apply(this,arguments)}}())}function A(a,c){return d("WAWebModelStorageUtils").getStorage().lock(["chat"],function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b[0];b=Array.from(a.keys());if(b.length===0)return;b=(yield d("WAWebSchemaChat").getChatTable().bulkGet(b));if(!b||b.length===0){d("WALogger").ERROR(m());return}var e=[];b.forEach(function(b){if(b){var d=b.id.toString();b=(b=b.unreadMentionsOfMe)!=null?b:[];var f=a.get(d);f&&(b=b.concat(f));f={id:d,unreadMentionsOfMe:b};if(c){var g;g=(g=c.get(d))!=null?g:0;f={id:d,unreadMentionsOfMe:b,unreadMentionCount:g}}e.push(f)}});return d("WAWebSchemaChat").getChatTable().bulkCreateOrMerge(e)});return function(a){return e.apply(this,arguments)}}())}function B(a){return d("WAWebModelStorageUtils").getStorage().lock(["chat"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b[0];b=Array.from(a.keys());if(b.length===0)return;b=(yield d("WAWebSchemaChat").getChatTable().bulkGet(b));if(!b||b.length===0){d("WALogger").ERROR(l());return}var c=[];b.forEach(function(b){if(b){var d;d=(d=b.unreadMentionsOfMe)!=null?d:[];var e=a.get(b.id.toString());e&&(d=d.filter(function(a){return!e.includes(a.id)}));c.push({id:b.id.toString(),unreadMentionsOfMe:d})}});return d("WAWebSchemaChat").getChatTable().bulkCreateOrMerge(c)});return function(a){return c.apply(this,arguments)}}())}function C(a){return d("WAWebModelStorageUtils").getStorage().lock(["chat"],function(c){c=c[0];var d=Array.from(a.keys());if(d.length===0)return(h||(h=b("Promise"))).resolve();d=d.map(function(b){var c;c=(c=a.get(b))!=null?c:!1;return{id:b,archiveAtMentionViewedInDrawer:c}});return c.bulkCreateOrMerge(d)})}function D(a,c,e){c===void 0&&(c=1);e===void 0&&(e=!0);return d("WAWebModelStorageUtils").getStorage().lock(["chat"],function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var f=(yield b.get(a));if(f==null){d("WALogger").ERROR(k(),a);return}var g=Math.max(f.unreadCount-c,0);f=(f=f.unreadDividerOffset)!=null?f:0;e&&(f+=c);return b.merge(a,{unreadCount:g,unreadDividerOffset:f})});return function(a){return f.apply(this,arguments)}}())}function E(){var a=d("WAWebTrustedContactsUtils").tokenExpirationCutoff(d("WAWebTrustedContactsUtils").TcTokenMode.Receiver);return d("WAWebModelStorageUtils").getStorage().lock(["chat"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var c=(yield b.lessThan(["tcTokenTimestamp"],a));if(!c||c.length===0)return;c=c.map(function(a){return{id:a.id,tcToken:null,tcTokenTimestamp:null}});return b.bulkCreateOrMerge(c)});return function(a){return c.apply(this,arguments)}}())}function F(){var a=d("WAWebTrustedContactsUtils").tokenExpirationCutoff(d("WAWebTrustedContactsUtils").TcTokenMode.Receiver),c=[];return d("WAWebModelStorageUtils").getStorage().lock(["orphan-tc-token"],function(){var d=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var d=(yield b.all());d.forEach(function(b){var d=b.tcTokenTimestamp;d!=null&&d<a&&c.push(b.chatId)});return b.bulkRemove(c)});return function(a){return d.apply(this,arguments)}}())}function G(a){return d("WAWebSchemaChat").getChatTable().get(a.toString(),!1)}function H(a){return d("WAWebSchemaChat").getChatTable().anyOf(["accountLid"],[a.toString()])}function I(a){return d("WAWebSchemaChat").getChatTable().bulkGet(a.map(function(a){return a.toString()}))}function J(){return d("WAWebSchemaChat").getChatTable().all().then(function(a){return a.map(function(a){return d("WAWebDBChatSerialization").deserializeChat(a)})})}function K(a){return L.apply(this,arguments)}function L(){L=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!a.isLid()){var b=(yield G(a));if(b!=null)return a;b=d("WAWebApiContact").getCurrentLid(d("WAWebWidFactory").toUserWid(a));if(b!=null){var c=(yield G(b));if(c!=null)return b}return a}c=(yield G(a));if(c!=null&&!c.isDeprecated)return a;b=d("WAWebApiContact").getPhoneNumber(d("WAWebWidFactory").toUserWid(a));if(b!=null){c=(yield G(b));if(c)return b}return a});return L.apply(this,arguments)}function M(a){return N(a)}function N(a){var b=r.get(a.toString());if(b!=null)return b;b=K(a);r.set(a.toString(),b);return b}function O(a){return P.apply(this,arguments)}function P(){P=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=[];a=a.filter(function(a){return a.isUser()});a.map(function(a){var b=r.get(a.toString());b==null&&c.push(a)});var e=d("WAWebApiContact").getAlternateWidBulk_DEPRECATED(c);Array.from(e.keys()).map(function(a){return c.push(d("WAWebWidFactory").createWidFromWidLike(a))});if(c.length>0){var f=(yield I(c));f.forEach(function(a){if(a!=null){var c;c=(c=e.get(a.id.toString()))!=null?c:a.id.toString();!(a==null?void 0:a.isDeprecated)&&!r.has(c.toString())&&r.set(c.toString(),(h||(h=b("Promise"))).resolve(d("WAWebWidFactory").createWidFromWidLike(a.id)))}})}var g=new Map();a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield r.get(a.toString()));b!=null?g.set(a,b):g.set(a,a)});return function(b){return a.apply(this,arguments)}}());return g});return P.apply(this,arguments)}function Q(a){r.set(a.toString(),(h||(h=b("Promise"))).resolve(a));var c=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").toUserWid(a));c!=null&&r.set(c.toString(),(h||(h=b("Promise"))).resolve(a))}function R(a){var b=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").toUserWid(a));b!=null&&r["delete"](b.toString());r["delete"](a.toString())}function S(a){a.filter(function(a){return c("WAWebWid").isUser(a.id)&&!a.isDeprecated}).map(function(a){a=d("WAWebWidFactory").createWid(a.id);(!a.isLid()||r.get(a.toString())==null)&&r.set(a.toString(),(h||(h=b("Promise"))).resolve(a));var c=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").toUserWid(a));c!=null&&(c.isLid()||r.get(c.toString())==null)&&r.set(c.toString(),(h||(h=b("Promise"))).resolve(a))})}function T(a,b){b?R(a):Q(a)}function U(){r.clear()}function V(a){return W.apply(this,arguments)}function W(){W=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.map(function(a){return a.id.toString()}),c=(yield d("WAWebSchemaChat").getChatTable().bulkGet(b));b=a.map(function(a,b){a=a;if(c[b]!=null){b=c[b];var e=b.disappearingModeInitiatedByMe;b=b.disappearingModeTrigger;e!=null&&(a=babelHelpers["extends"]({},a,{disappearingModeInitiatedByMe:e}));b!=null&&(a=babelHelpers["extends"]({},a,{disappearingModeTrigger:d("WAWebEphemeralityUtils").getDisappearingModeTriggerFromString(b)}))}return a});return b});return W.apply(this,arguments)}g.matChatCache=r;g.CreateChatDuplicateError=s;g.createChatRecord=a;g.getChatMeta=e;g.updateChatForMarkAsReadSync=f;g.latestChatBulkUpdates=v;g.bulkUpdateChatLastAddOnPreview=w;g.queryPendingReadReceiptMsgRows=x;g.markMessageAndChatAsRead=z;g.addUnreadMentionChat=A;g.removeUnreadMentionChat=B;g.updateChatArchiveDrawer=C;g.reduceChatUnreadCount=D;g.pruneExpiredTcTokens=E;g.pruneExpiredOrphanTcTokens=F;g.getChatRecord=G;g.getChatRecordByAccountLid=H;g.bulkGetChats=I;g.getAllChatsDeserialized=J;g._getActiveChatWid_DEPRECATED=K;g.getMatChatIncomingMessage=M;g.getMatChat_DEPRECATED=N;g.getMatChatBulk_DEPRECATED=O;g.removeMatChatMapping_DEPRECATED=R;g.populateMatCacheBulk=S;g.updateDeprecatedChatMatCache_DEPRECATED=T;g.clearMatChatCache_DEPRECATED=U;g.injectAdditionalEphemeralInfoFromDB=V}),98);
__d("WAWebApiFilterAndReplaceMessages",["WALogger","WAWebApiOrphanRevoke","WAWebLidMigrationUtils","WAWebMessageAssociationGatingUtils","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["filterAndReplaceMessages: found orphan revoke for message id: ",""]);h=function(){return a};return a}function a(a){return function(b){return b.associationType!=null&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()?a.get(b.id.toString()):b}}function e(a,b){var c=[];a.forEach(function(a){if(a!=null)if(b){var d=b(a);d&&c.push(d)}else c.push(a)});return c}function f(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=(yield d("WAWebApiOrphanRevoke").getOrphansRevokesCache()),f=[],g=[];a.forEach(function(a){var i=a.id.toString(),j=d("WAWebLidMigrationUtils").getAlternateMsgKey(a.id);i=(i=e.get(i))!=null?i:j&&e.get(j.toString());if(i)d("WALogger").LOG(h(),a.id.id),c("WAWebWid").isStatus(a.id.remote)||g.push(d("WAWebApiOrphanRevoke").createRevokeMsgFromOrphanRevoke(a,i)),f.push(i);else if(b){j=b(a);j&&g.push(j)}else g.push(a)});void d("WAWebApiOrphanRevoke").bulkRemoveOrphansUsingOrphansCache(f);return{newMsgs:g}});return i.apply(this,arguments)}g.validateMsgFn=a;g.filterAndReplaceMessagesInitialHistorySync=e;g.filterAndReplaceMessages=f}),98);
__d("WAWebApiOrphanRevoke",["WANullthrows","WAWebMsgGetters","WAWebMsgKey","WAWebMsgType","WAWebProcessBaseMsgInfo","WAWebSchemaOrphanRevoke","WAWebViewMode.flow","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=new Map(),i=!1,j={reset:function(){h=new Map(),i=!1},bulkRemoveOrphans:function(a){a.forEach(function(a){h["delete"](a.msgKey)});return d("WAWebSchemaOrphanRevoke").getOrphanRevokeTable().bulkRemove(a.map(function(a){return a.msgKey}))},bulkCreateOrReplaceOrphanRevokes:function(a){a.forEach(function(a){h.has(a.msgKey)&&h["delete"](a.msgKey),h.set(a.msgKey,a)});return d("WAWebSchemaOrphanRevoke").getOrphanRevokeTable().bulkCreateOrReplace(a)},getAllOrphanRevokes:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!i){var a=(yield d("WAWebSchemaOrphanRevoke").getOrphanRevokeTable().all());h=new Map(a.map(function(a){return[a.msgKey,a]}));i=!0}return h});function c(){return a.apply(this,arguments)}return c}()};function a(a){return j.bulkCreateOrReplaceOrphanRevokes(a)}function e(){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return j.getAllOrphanRevokes()});return k.apply(this,arguments)}function f(a){return j.bulkRemoveOrphans(a)}function l(a,b){var c;return{id:a.id,to:a.to,author:a.author,revokeSender:d("WAWebWidFactory").createWidFromWidLike((c=b.sender)!=null?c:d("WAWebMsgGetters").getSender(a)),type:d("WAWebMsgType").MSG_TYPE.REVOKED,kind:d("WAWebMsgType").MsgKind.RevokedMessage,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:b.subtype==="admin_revoke"?"admin":"sender",protocolMessageKey:a.id,from:a.from,t:a.t,broadcast:a.broadcast}}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield j.getAllOrphanRevokes()),e=[],f=[];a.forEach(function(a){var g=a.id.toString();if(b.has(g)){g=c("WANullthrows")(b.get(g));f.push(babelHelpers["extends"]({},d("WAWebProcessBaseMsgInfo").msgDataToBaseMsgInfo(a),{id:c("WAWebMsgKey").fromString(g.msgKey),type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.ProtocolRevoke,subtype:g.subtype==="admin_revoke"?"admin_revoke":"sender_revoke",protocolMessageKey:a.id,t:g.timestamp}));e.push(g)}});j.bulkRemoveOrphans(e);return f});return n.apply(this,arguments)}g.addOrphanRevokes=a;g.getOrphansRevokesCache=e;g.bulkRemoveOrphansUsingOrphansCache=f;g.createRevokeMsgFromOrphanRevoke=l;g.applyAddonRevokes=m}),98);
__d("WAWebApiVerifiedBusinessName",["invariant","$InternalEnum","Promise","WAWebBizGatingUtils","WAWebHandleMsgTypes.flow","WAWebLidMigrationUtils","WAWebSchemaVerifiedBusinessName","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){var i;function a(){return d("WAWebSchemaVerifiedBusinessName").getVerifiedBusinessNameTable().all()}var j=b("$InternalEnum").Mirrored(["Replace","Merge"]);function k(a){return d("WAWebSchemaVerifiedBusinessName").getVerifiedBusinessNameTable().get(u(a))}function l(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a.isLid()||h(0,86986);var b=(yield k(a));if(b==null){var c=d("WAWebLidMigrationUtils").toPn(a);if(c!=null){c=(yield k(c));if(c!=null)return babelHelpers["extends"]({},c,{id:u(a)})}}return b});return m.apply(this,arguments)}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebLidMigrationUtils").toLid(a);if(b!=null){b=(yield k(b));if(b!=null)return babelHelpers["extends"]({},b,{id:u(a)})}return k(a)});return o.apply(this,arguments)}function e(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebBizGatingUtils").isLidMigrationForVnameEnabled())return k(a);return!c("WAWebWid").isUserWid(a)?null:a.isLid()?l(a):n(a)});return p.apply(this,arguments)}function q(a,b,c){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c===void 0&&(c=j.Replace);var e=d("WAWebSchemaVerifiedBusinessName").getVerifiedBusinessNameTable();a=u(a);b=babelHelpers["extends"]({},b,{id:a});c===j.Replace?yield e.createOrReplace(b):yield e.createOrMerge(a,b)});return r.apply(this,arguments)}function f(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield k(a));return(a==null?void 0:a.privacyMode)==null?null:t(a.privacyMode)});return s.apply(this,arguments)}function t(a){var b=d("WAWebHandleMsgTypes.flow").ActualActorsEnumType.cast(a.actualActors),c=d("WAWebHandleMsgTypes.flow").HostStorageEnumType.cast(a.hostStorage);return b==null||c==null?null:{actualActors:b,hostStorage:c,privacyModeTs:a.privacyModeTs}}function u(a){return a.isLid()?a.toString():a.user}function v(a,b,c){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){e===void 0&&(e=j.Replace);a=d("WAWebBizGatingUtils").isLidMigrationForVnameEnabled()?d("WAWebLidMigrationUtils").getPnAndLidToUpdate(a):[a];return(i||(i=b("Promise"))).all(a.map(function(a){return q(a,c,e)}))});return w.apply(this,arguments)}g.getAllVerifiedNames=a;g.VerifiedBusinessNameUpdateType=j;g.getVerifiedBusinessNameRecord=k;g.getVerifiedBusinessNameRecordLidAware=e;g.createOrUpdateVerifiedBusinessName=q;g.getPrivacyMode=f;g.convertPrivacyModeFromStorageType=t;g.widToId=u;g.createOrUpdateVerifiedBusinessNameLidAware=v}),98);
__d("WAWebUpdateDuplicatedLidThread",["WALogger","WAWebApiChat","WAWebApiContact","WAWebSchemaChat","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateChatIsDeprecatedBulk: deprecating lid chats "]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["updateChatIsDeprecatedBulk - true: deprecated "," chats during offline resume"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["shouldDeprecateLidThread: called with deprecated chatid"]);j=function(){return a};return a}function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[],e=a.filter(function(a){return a!=null&&c("WAWebWid").isLid(a.id)&&!a.isDeprecated}),f=d("WAWebApiContact").getAlternateWidBulkForLids_DEPRECATED(e.map(function(a){return a.id.toString()}));e.forEach(function(c){var d;d=l(c,(d=f.get(c.id.toString()))!=null?d:[],a);d&&b.push({id:c.id.toString(),isDeprecated:!0})});if(b.length===0)return;yield d("WAWebSchemaChat").getChatTable().bulkCreateOrMerge(b).then(function(){d("WALogger").LOG(i(),b.length),d("WALogger").WARN(h()).sendLogs("deprecating-lid-chat-pnh-ctwa-mat")})});return k.apply(this,arguments)}function l(a,b,e){if(!c("WAWebWid").isLid(a.id)||b.length===0)return!1;if(a.isDeprecated===!0){d("WALogger").WARN(j()).sendLogs("deprecating-lid-chat-pnh-ctwa-mat");return!0}b=b.some(function(a){return e.some(function(b){return(b==null?void 0:b.id)===a})});b&&d("WAWebApiChat").updateDeprecatedChatMatCache_DEPRECATED(d("WAWebWidFactory").createWid(a.id),!0);return b}g.updateDuplicatedLidThreadBulk=a;g.shouldDeprecateLidThread=l}),98);
__d("WAWebOffdStorageUpdateOfflinePeerReceipts",["Promise","WAJids","WALogger","WAWebAck","WAWebBackendApi","WAWebDBBulkGetRootMsgs","WAWebDBMsgUtils","WAWebLid1X1MigrationGating","WAWebMarkAddOnsAsReadJob","WAWebModelStorageUtils","WAWebMsgGetters","WAWebMsgKey","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","WAWebSchemaMessage","WAWebSchemaPeerReadReceipt","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage]: getUpdatesForPeerReadReceipts: found "," pendingReadMessages"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage]: updatePeerReceipts: finish update add-on tables"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage]: updatePeerReceipts: finish update chat/message table"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage]: updatePeerReceipts: finish compute peer played updates"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage]: updatePeerReceipts: finish compute peer receipt updates"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["updatePeerReceipts: unknown ack type: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage]: updatePeerReceipts: find "," peer receipts"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage]: updatePeerReceipts: start updatePeerReceipts"]);p=function(){return a};return a}function a(){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.OFFLINE_RESUME,"UpdatePeerReceipts_start");d("WALogger").DEV(p());var a=(yield d("WAWebSchemaPeerReadReceipt").getTable().all());if(d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated())yield (h||(h=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a.msgKeys=(yield d("WAWebDBBulkGetRootMsgs").fixMsgKeysWithChatId(a.msgKeys))});return function(b){return a.apply(this,arguments)}}()));else if(d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.shouldApplyNonMigratedMessagingRules()){var e=[],f=[];for(var g of a)for(var i of g.msgKeys){var q=c("WAWebMsgKey").fromString(i);q.remote.isLid()&&(g.ack===d("WAWebAck").ACK.READ?e.push(q):g.ack===d("WAWebAck").ACK.PLAYED&&f.push(q))}e.length>0&&a.push({ack:d("WAWebAck").ACK.READ,msgKeys:d("WAWebDBBulkGetRootMsgs").fixMsgKeysWithPnMapping(e).map(String)});f.length>0&&a.push({ack:d("WAWebAck").ACK.PLAYED,msgKeys:Array.from(f).map(String)})}d("WALogger").DEV(o(),a.length);var s=[],v=[];a.forEach(function(a){a.ack===d("WAWebAck").ACK.READ?s.push(a):a.ack===d("WAWebAck").ACK.PLAYED?v.push(a):d("WALogger").WARN(n(),a.ack)});q=(yield r(s));var w=q.chatUpdates;i=q.ackUpdates;d("WALogger").DEV(m());var x=new Map(i.map(function(a){return[a.id,a]}));g=u(v);g.forEach(function(a){var b=x.get(a.id);b==null?x.set(a.id,a):x.set(a.id,babelHelpers["extends"]({},b,{ack:a.ack}))});var y=Array.from(x.values());d("WALogger").DEV(l());d("WAWebBackendApi").frontendFireAndForget("updateOfflinePeerReceipt",{chatUpdates:w.map(function(a){return{chatId:a.id,unreadCount:a.unreadCount,unreadMentionsOfMe:(a=a.unreadMentionsOfMe)!=null?a:[]}}),ackUpdates:y.map(function(a){return{msgKey:a.id,ack:a.ack}})});yield (h||(h=b("Promise"))).all([d("WAWebModelStorageUtils").getStorage().lock(["message","chat"],function(a){var c=a[0];a=a[1];return(h||(h=b("Promise"))).all([c.bulkCreateOrMerge(y),a.bulkCreateOrMerge(w)])}).then(function(){d("WALogger").DEV(k())}),d("WAWebMarkAddOnsAsReadJob").markUnclassifiedAddOnsAsReadJob(Array.from(t(s)).map(function(a){return c("WAWebMsgKey").from(a)})).then(function(){d("WALogger").DEV(j())})]);return d("WAWebSchemaPeerReadReceipt").getTable().clear().then(function(){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.OFFLINE_RESUME,"UpdatePeerReceipts_end")})});return q.apply(this,arguments)}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=t(a),f=(yield j(a));j=Array.from(f.keys());var g=(yield d("WAWebSchemaMessage").getMessageTable().anyOf(["from","pendingReadReceipt"],j.reduce(function(a,b){var c;a.push([b,d("WAWebDBMsgUtils").PendingReadReceiptType.Message]);((c=d("WAWebWidFactory").createWid(b))==null?void 0:c.isBot())&&a.push([b,d("WAWebDBMsgUtils").PendingReadReceiptType.MessageEdit]);return a},[]),{shouldDecrypt:!1}));d("WALogger").DEV(i(),g.length);g.forEach(function(a){return l(f.get(a.from),a)});g.forEach(function(a){return m(f.get(a.from),a)});a=n(g).concat(o(e));n=j.map(function(a){var b=f.get(a);return b!=null&&b.lastUnreadMsgRowId!=null?{id:a,unreadCount:b.unreadCount,unreadMentionsOfMe:b.unreadMentionsOfMe}:null}).filter(Boolean);return{chatUpdates:n,ackUpdates:a};function h(a){return c("WAWebMsgKey").fromString(a).remote.toString()}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return new Map(a.flatMap(function(a){return a.msgKeys}).map(h).filter(function(a){return a!==d("WAJids").STATUS_JID}).map(function(a){return[a,{unreadCount:0,lastUnreadMsgRowId:void 0,unreadMentionsOfMe:[],unreadMentionCount:0}]}))});return k.apply(this,arguments)}function l(a,b){var c=b.rowId;b=b.id;if(a==null||c==null)return;e.has(b)&&(a.lastUnreadMsgRowId==null||c>a.lastUnreadMsgRowId)&&(a.lastUnreadMsgRowId=c)}function m(a,b){var c=b.rowId;if(a==null||c==null||a.lastUnreadMsgRowId==null)return;if(c>a.lastUnreadMsgRowId){a.unreadCount+=1;if(d("WAWebMsgGetters").getIsImportantMessage(b)){c={id:b.id,timestamp:b.t};a.unreadMentionsOfMe.push(c)}}}function n(a){return g.flatMap(function(a){var b=a.rowId,c=f.get(a.from);if(c==null||b==null||c.lastUnreadMsgRowId==null)return[];return b<=c.lastUnreadMsgRowId?[{id:a.id,ack:d("WAWebAck").ACK.READ,pendingReadReceipt:null}]:[]})}function o(a){return Array.from(a).filter(function(a){return h(a)===d("WAJids").STATUS_JID}).map(function(a){return{id:a,ack:d("WAWebAck").ACK.READ}})}});return s.apply(this,arguments)}function t(a){return new Set(a.flatMap(function(a){return a.msgKeys}))}function u(a){var b=new Set();a.forEach(function(a){a.ack===d("WAWebAck").ACK.PLAYED&&a.msgKeys.forEach(function(a){return b.add(a)})});return Array.from(b).map(function(a){return{id:a,ack:d("WAWebAck").ACK.PLAYED,pendingReadReceipt:null}})}g.updatePeerReceipts=a}),98);
__d("WAWebSchemaPendingDeviceSync",["WAWebOffdStorageUtils","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addUserDefinedPrimaryKey;function a(){d("WAWebOffdStorageUtils").getStorage().add("pending-device-sync").version(d("WAWebOffdStorageUtils").getStorage().versions.version(4),[h("id")]).view(function(a){return a})}function b(){return d("WAWebOffdStorageUtils").getStorage().table("pending-device-sync")}g.addTable=a;g.getTable=b}),98);
__d("WAWebApiPendingDeviceSync",["WALogger","WAWebSchemaPendingDeviceSync","WAWebSyncDeviceAdvDeviceListJob","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["doPendingDeviceSync failed during RESUME_WITH_OPEN_TAB"]);h=function(){return a};return a}function a(){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var a=(yield d("WAWebSchemaPendingDeviceSync").getTable().all());yield d("WAWebSyncDeviceAdvDeviceListJob").syncDeviceListJob(a.map(function(a){return d("WAWebWidFactory").createWid(a.id)}),null,null);yield d("WAWebSchemaPendingDeviceSync").getTable().bulkRemove(a.map(function(a){return a.id}))}catch(a){d("WALogger").ERROR(h()).verbose().devConsole(a)}});return i.apply(this,arguments)}function c(a){return d("WAWebSchemaPendingDeviceSync").getTable().bulkCreateOrMerge(a.map(function(a){return{id:a}}))}g.doPendingDeviceSync=a;g.addUserToPendingDeviceSync=c}),98);
__d("WASyncdCollectionsStateMachine",["WAGetCollectionVersion","WALogger","WASyncdConst","WATimeUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Collection "," is in finite retry state with no failure start time"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: ",": "," ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: state machine persistToDb. states:"]);j=function(){return a};return a}a=function(){function a(){}a.loadStatesFromDb=function(){var a=this,c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getAllCollectionVersionsInTransaction());case 2:c=e.sent,c.forEach(function(b){return a.collectionStates.set(b.collection,{collection:b.collection,state:b.state,finiteFailureStartTime:b.finiteFailureStartTime})});case 4:case"end":return e.stop()}},null,this)};a.persistToDb=function(){var a=[];this.collectionStates.forEach(function(b){return a.push(b)});d("WALogger").LOG(j());a.forEach(function(a){var b=a.finiteFailureStartTime==null?"":"(failure start: "+a.finiteFailureStartTime+")";d("WALogger").LOG(i(),a.collection,a.state,b)});return d("WAGetCollectionVersion").bulkUpdateCollectionVersionInTransaction(a)};a.clean=function(){this.collectionStates=new Map()};a.getCollectionState=function(a){var b=this.collectionStates.get(a);if(b)return b.state;this.moveCollectionsToUpToDate([a]);return d("WASyncdConst").CollectionSyncState.UpToDate};a.getCollectionsInStateDirty=function(){var a=[];this.collectionStates.forEach(function(b){b.state===d("WASyncdConst").CollectionSyncState.Dirty&&a.push(b.collection)});return a};a.getCollectionsInStateRetry=function(){var a=[];this.collectionStates.forEach(function(b){b.state===d("WASyncdConst").CollectionSyncState.FailingFiniteRetry&&a.push(b.collection)});return a};a.getCollectionsInStateFatal=function(){var a=[];this.collectionStates.forEach(function(b){b.state===d("WASyncdConst").CollectionSyncState.Fatal&&a.push(b.collection)});return a};a.getCollectionsInStateBlocked=function(){var a=[];this.collectionStates.forEach(function(b){b.state===d("WASyncdConst").CollectionSyncState.Blocked&&a.push(b.collection)});return a};a.moveCollectionsToUpToDate=function(a){var b=this;a.forEach(function(a){return b.collectionStates.set(a,{collection:a,state:d("WASyncdConst").CollectionSyncState.UpToDate,finiteFailureStartTime:void 0})})};a.moveCollectionsToDirty=function(a){var b=this;a.forEach(function(a){return b.collectionStates.set(a,{collection:a,state:d("WASyncdConst").CollectionSyncState.Dirty,finiteFailureStartTime:(a=b.collectionStates.get(a))==null?void 0:a.finiteFailureStartTime})})};a.moveCollectionsToFiniteRetry=function(a){var b=this;a.forEach(function(a){return b.collectionStates.set(a,{collection:a,state:d("WASyncdConst").CollectionSyncState.FailingFiniteRetry,finiteFailureStartTime:(a=(a=b.collectionStates.get(a))==null?void 0:a.finiteFailureStartTime)!=null?a:d("WATimeUtils").unixTimeMs()})})};a.moveCollectionsToFatal=function(a){var b=this;a.forEach(function(a){return b.collectionStates.set(a,{collection:a,state:d("WASyncdConst").CollectionSyncState.Fatal})})};a.moveCollectionsToBlocked=function(a){var b=this;a.forEach(function(a){return b.collectionStates.set(a,{collection:a,state:d("WASyncdConst").CollectionSyncState.Blocked,finiteFailureStartTime:(a=b.collectionStates.get(a))==null?void 0:a.finiteFailureStartTime})})};a.getExpiredCollections=function(){var a=[];this.collectionStates.forEach(function(b){if(b.state===d("WASyncdConst").CollectionSyncState.FailingFiniteRetry){var c;b.finiteFailureStartTime==null?(c=Infinity,d("WALogger").WARN(h(),b.collection)):c=b.finiteFailureStartTime;c=c+d("WASyncdConst").FINITE_FAILURE_EXPIRY_DURATION;c<d("WATimeUtils").unixTimeMs()&&a.push(b.collection)}});return a};a.getCollectionMinFailureTime=function(){var a=Array.from(this.collectionStates.values()).filter(function(a){return a.state===d("WASyncdConst").CollectionSyncState.FailingFiniteRetry}).map(function(a){return a.finiteFailureStartTime}).filter(Boolean);return a.length===0?null:Math.min.apply(Math,a)};return a}();a.collectionStates=new Map();g["default"]=a}),98);
__d("WASyncd",["Promise","WABaseGlobals","WAGetCollectionVersion","WAGetMissingKey","WAGetPendingMutation","WAGetSyncAction","WAGetSyncKey","WALogger","WASyncdCollectionsStateMachine","WASyncdConst","WASyncdCryptoUtils","WASyncdDisabled","WASyncdKeyCache","WASyncdMetricCriticalBootstrapStage","WASyncdMetricFatalError","WASyncdOrphan","WASyncdServerSync","WASyncdWamAppState","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: syncing pending mutations and blocked collections due to app resume"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: syncPendingMutationsAndBlockedCollections: [","]"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: syncPendingMutationsAndBlockedCollections"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: retry is in flight"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: state machine tick"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: expired collections"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: cleanup after handleRetry()"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: exception during handleRetry(): ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: server sync retry successful"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: initiate server sync retry"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: cleanup after sync()"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: exception during sync(): ",""]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: server sync successful"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: initiate server sync"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: no collections to sync"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: dirty collections: ",""]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: syncBlockedCollections:\n    \tmoving blocked collections to dirty: [","]\n    \tadding inflight collections to pending: [","]"],["syncd: syncBlockedCollections:\n    \\tmoving blocked collections to dirty: [","]\n    \\tadding inflight collections to pending: [","]"]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: sync blocked collections: ",""]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd:\n        key id: ","\n        key timestamp: ","\n        key device indexes: ",""]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: "," unsupported mutations"]);B=function(){return a};return a}function C(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd:\n        "," successful "," mutations\n        "," orphan "," mutations,\n        "," failed "," mutations"]);C=function(){return a};return a}function D(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: local version (",")for "," >= server version (","); will not mark for sync."]);D=function(){return a};return a}function E(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: local version (",") for "," less than server version (","); will mark for sync."]);E=function(){return a};return a}function F(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: server version for "," missing; will mark for sync."]);F=function(){return a};return a}function G(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: local version for "," missing; will mark for sync."]);G=function(){return a};return a}function H(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: start filter collections: ",""]);H=function(){return a};return a}function I(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: "," state before sync: ",""]);I=function(){return a};return a}function J(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: marking for sync: ",""]);J=function(){return a};return a}var K=1e3,L=1e3*60*60,M=2,N=new Set(),O=new Set(),P,Q=!1,R=0,S=0;function T(a,e){var f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:if(!(e!=null)){g.next=6;break}g.next=3;return b("regeneratorRuntime").awrap(U(a,e));case 3:g.t0=g.sent;g.next=7;break;case 6:g.t0=a;case 7:f=g.t0;d("WALogger").LOG(J(),f);f.forEach(function(a){var b=c("WASyncdCollectionsStateMachine").getCollectionState(a);d("WALogger").LOG(I(),a,b);b===d("WASyncdConst").CollectionSyncState.UpToDate?c("WASyncdCollectionsStateMachine").moveCollectionsToDirty([a]):b===d("WASyncdConst").CollectionSyncState.Dirty&&(O=new Set([].concat(Array.from(O),[a])))});g.next=12;return b("regeneratorRuntime").awrap(c("WASyncdCollectionsStateMachine").persistToDb());case 12:return g.abrupt("return",V());case 13:case"end":return g.stop()}},null,this)}function U(a,c){var e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:d("WALogger").LOG(H(),a);g.next=3;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").bulkGetCollectionVersionsInTransaction(a));case 3:e=g.sent;f=new Map(a.map(function(a,b){return[a,(a=e[b])==null?void 0:a.version]}));return g.abrupt("return",a.filter(function(a){var b=f.get(a);if(b==null){d("WALogger").LOG(G(),a);return!0}var e=c.get(a);if(e==null){d("WALogger").LOG(F(),a);return!0}if(b<e){d("WALogger").LOG(E(),b,a,e);return!0}d("WALogger").LOG(D(),b,a,e);return!1}));case 6:case"end":return g.stop()}},null,this)}function a(){var a,c,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").countSyncActionsInTransaction());case 2:a=g.sent;d("WASyncdWamAppState").setStoredMutationCount(a);g.next=6;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionsByActionStatesInTransaction([d("WASyncdConst").SyncActionState.Malformed]));case 6:c=g.sent;d("WASyncdWamAppState").setInvalidActionCount(c.length);g.next=10;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionsByActionStatesInTransaction([d("WASyncdConst").SyncActionState.Unsupported]));case 10:e=g.sent;d("WASyncdWamAppState").setUnsupportedActionCount(e.length);g.next=14;return b("regeneratorRuntime").awrap(d("WAGetMissingKey").getMissingKeyCountTransaction());case 14:f=g.sent,d("WASyncdWamAppState").setMissingKeyCount(f);case 16:case"end":return g.stop()}},null,this)}function e(){var a,c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=7;break;e.next=3;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getAllSyncActions());case 3:a=e.sent,Array.from(d("WASyncdConst").Actions.members()).forEach(function(b){var c=a.filter(function(a){return a.action!=null&&a.action===b});if(c.length>0){var e=c.filter(function(a){return a.actionState===d("WASyncdConst").SyncActionState.Success||a.actionState===d("WASyncdConst").SyncActionState.Skipped}),f=c.filter(function(a){return a.actionState===d("WASyncdConst").SyncActionState.Orphan});c=c.filter(function(a){return a.actionState===d("WASyncdConst").SyncActionState.Malformed||a.actionState===d("WASyncdConst").SyncActionState.Failed});d("WALogger").DEV(C(),e.length,b,f.length,b,c.length,b)}}),c=a.filter(function(a){return a.actionState===d("WASyncdConst").SyncActionState.Unsupported}),d("WALogger").DEV(B(),c.length);case 7:case"end":return e.stop()}},null,this)}function f(){var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=5;break;c.next=3;return b("regeneratorRuntime").awrap(d("WAGetSyncKey").getAllSyncKeysInTransaction());case 3:a=c.sent,a.forEach(function(a){d("WALogger").DEV(A(),d("WASyncdCryptoUtils").syncKeyIdToHex(a.keyId),a.timestamp,a.fingerprint.deviceIndexes)});case 5:case"end":return c.stop()}},null,this)}function e(){var a=c("WASyncdCollectionsStateMachine").getCollectionsInStateBlocked();d("WALogger").LOG(z(),a);c("WASyncdCollectionsStateMachine").moveCollectionsToDirty(a);O=new Set([].concat(Array.from(O),Array.from(N)));d("WALogger").LOG(y(),a,Array.from(N));return V()}function V(){var a,e,f,g;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:if(!d("WASyncdDisabled").isSyncdDisabled()){i.next=2;break}return i.abrupt("return",(h||(h=b("Promise"))).resolve());case 2:a=c("WASyncdCollectionsStateMachine").getCollectionsInStateDirty();d("WALogger").LOG(x(),a);e=new Set(a.filter(function(a){return!N.has(a)}));if(!(e.size===0)){i.next=8;break}d("WALogger").LOG(w());return i.abrupt("return",(h||(h=b("Promise"))).resolve());case 8:f=[];i.prev=9;N=new Set([].concat(Array.from(N),Array.from(e)));d("WALogger").LOG(v());i.next=14;return b("regeneratorRuntime").awrap(d("WASyncdServerSync").serverSync(Array.from(e)));case 14:f=i.sent;d("WALogger").LOG(u());g=f.filter(function(a){return a.state===d("WASyncdConst").CollectionState.ErrorRetry});g.length>0&&(S=g[0].serverBackoff||0,R=0);$(f);i.next=26;break;case 22:i.prev=22,i.t0=i["catch"](9),d("WALogger").LOG(t(),i.t0),c("WASyncdCollectionsStateMachine").moveCollectionsToFiniteRetry(Array.from(e));case 26:i.prev=26;d("WALogger").LOG(s());c("WASyncdCollectionsStateMachine").persistToDb();N=new Set(Array.from(N).filter(function(a){return!e.has(a)}));Z();i.next=33;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().handleSyncCompleted(f));case 33:return i.finish(26);case 34:case"end":return i.stop()}},null,this,[[9,22,26,34]])}function W(){if(d("WASyncdDisabled").isSyncdDisabled())return;var a=new Set(c("WASyncdCollectionsStateMachine").getCollectionsInStateRetry());if(a.size===0)return;P=setTimeout(function(){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.prev=0;Q=!0;R+=1;d("WALogger").LOG(r());f.next=6;return b("regeneratorRuntime").awrap(d("WASyncdServerSync").serverSync(Array.from(a)));case 6:e=f.sent;d("WALogger").LOG(q());$(e);f.next=15;break;case 11:f.prev=11,f.t0=f["catch"](0),d("WALogger").LOG(p(),f.t0),c("WASyncdCollectionsStateMachine").moveCollectionsToFiniteRetry(Array.from(a));case 15:f.prev=15;d("WALogger").LOG(o());f.next=19;return b("regeneratorRuntime").awrap(Y());case 19:c("WASyncdCollectionsStateMachine").persistToDb();Q=!1;Z();return f.finish(15);case 23:case"end":return f.stop()}},null,this,[[0,11,15,23]])},X(R,S))}function X(a,b){a=Math.pow(M,a)*K;return Math.min(Math.max(a,b),L)}function Y(){var a;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:a=c("WASyncdCollectionsStateMachine").getExpiredCollections();if(!(a.length>0)){e.next=7;break}c("WASyncdCollectionsStateMachine").moveCollectionsToFatal(a);e.next=5;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().printSyncdLog());case 5:d("WALogger").ERROR(n()).sendLogs("syncd: fatal error: expired collections"),d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.TOO_MANY_INTERNAL_SERVER_ERRORS_IN_7D,a[0]);case 7:case"end":return e.stop()}},null,this)}function Z(){d("WALogger").LOG(m());c("WASyncdCollectionsStateMachine").getCollectionsInStateDirty().length>0&&(O=new Set(Array.from(O).filter(function(a){return N.has(a)})),V());var a=c("WASyncdCollectionsStateMachine").getCollectionsInStateRetry();if(a.length>0){if(Q){d("WALogger").LOG(l());return}P!=null&&clearTimeout(P);O=new Set(Array.from(O).filter(function(b){return!a.includes(b)}));W()}c("WASyncdCollectionsStateMachine").getCollectionsInStateFatal().length>0&&d("WABaseGlobals").getDbImpls().handleSyncdFatal({collections:c("WASyncdCollectionsStateMachine").getCollectionsInStateFatal()})}function $(a){return a.forEach(function(a){if(a.state===d("WASyncdConst").CollectionState.Success&&!O.has(a.name))return c("WASyncdCollectionsStateMachine").moveCollectionsToUpToDate([a.name]);if(a.state===d("WASyncdConst").CollectionState.ErrorRetry){d("WASyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(d("WASyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.ENTERED_RETRY_MODE);return c("WASyncdCollectionsStateMachine").moveCollectionsToFiniteRetry([a.name])}if(a.state===d("WASyncdConst").CollectionState.ErrorFatal)return c("WASyncdCollectionsStateMachine").moveCollectionsToFatal([a.name]);if(a.state===d("WASyncdConst").CollectionState.Blocked&&!O.has(a.name))return c("WASyncdCollectionsStateMachine").moveCollectionsToBlocked([a.name])})}function aa(){var a,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:d("WALogger").LOG(k());g.next=3;return b("regeneratorRuntime").awrap(d("WAGetPendingMutation").getAllSyncPendingMutationsInTransaction());case 3:a=g.sent,e=c("WASyncdCollectionsStateMachine").getCollectionsInStateBlocked(),c("WASyncdCollectionsStateMachine").moveCollectionsToDirty(e),f=a.map(function(a){return a.collection}).concat(e),f.length>0&&(d("WALogger").LOG(j(),f),T(f));case 8:case"end":return g.stop()}},null,this)}function ba(){return c("WASyncdCollectionsStateMachine").loadStatesFromDb().then(function(){return Z()})}function ca(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:a.next=2;return b("regeneratorRuntime").awrap(d("WASyncdOrphan").applyAllOrphansAndUnsupported());case 2:d("WALogger").LOG(i());a.next=5;return b("regeneratorRuntime").awrap(aa());case 5:case"end":return a.stop()}},null,this)}function da(){return d("WABaseGlobals").runInTransaction({SyncActionStore:!0,CollectionVersionStore:!0,PendingMutationStore:!0,MissingKeyStore:!0,SyncKeyStore:!0},function(a){var e=a.SyncActionStore,f=a.CollectionVersionStore,g=a.PendingMutationStore,i=a.MissingKeyStore;a=a.SyncKeyStore;return(h||(h=b("Promise"))).all([e.clear(),f.clear(),g.clear(),i.clear(),a.clear()]).then(function(){c("WASyncdCollectionsStateMachine").clean(),d("WASyncdKeyCache").clearSyncKeysCache()})})}function ea(){return N}function fa(){return O}g.markCollectionsForSync=T;g.reportWam=a;g.logKeysInfoInIntern=f;g.syncBlockedCollections=e;g.initializeStateMachine=ba;g.processOnAppResume=ca;g.clearSyncdData=da;g.getInFlightCollections=ea;g.getPendingCollections=fa}),98);
__d("WAMediaCalculateFilehash",["WACryptoDependencies","WACryptoSha256"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("WACryptoSha256").sha256Base64(a)}function b(){var a=d("WACryptoDependencies").getCrypto().getRandomValues(new Uint8Array(20));a=a.buffer;return d("WACryptoSha256").sha256Base64(a)}g.calculateFilehash=a;g.getRandomFilehash=b}),98);
__d("WASyncdRequestEncode",["WAServerSync.pb","WASyncAction.pb","WASyncdError","WASyncdMetricFatalError","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function a(a){try{return d("encodeProtobuf").encodeProtobuf(d("WAServerSync.pb").SyncdPatchSpec,a).readBuffer()}catch(a){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.PATCH_PROTOBUF_SERIALIZATION_FAILED);throw new(d("WASyncdError").SyncdFatalError)("patch protobuf serialization failed")}}function b(a){try{return d("encodeProtobuf").encodeProtobuf(d("WAServerSync.pb").SyncdMutationsSpec,a).readBuffer()}catch(a){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.MUTATIONS_PROTOBUF_SERIALIZATION_FAILED);throw new(d("WASyncdError").SyncdFatalError)("mutations protobuf serialization failed")}}function c(a){try{return d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,a).readBuffer()}catch(a){d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.ACTION_DATA_PROTOBUF_SERIALIZATION_FAILED);throw new(d("WASyncdError").SyncdFatalError)("action data protobuf serialization failed")}}g.encodeSyncdPatch=a;g.encodeSyncdMutations=b;g.encodeSyncActionData=c}),98);
__d("WASyncdEncryptMutations",["WAArrayBufferUtils","WABaseGlobals","WACryptoDependencies","WAGetSyncAction","WAServerSync.pb","WASyncAction.pb","WASyncdAntiTampering","WASyncdCrypto","WASyncdCryptoConst","WASyncdCryptoUtils","WASyncdError","WASyncdKeyCache","WASyncdMetricFatalError","WASyncdRequestEncode","decodeProtobuf","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c,e){var f,g,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E;return b("regeneratorRuntime").async(function(F){while(1)switch(F.prev=F.next){case 0:f=a.index,g=a.operation;i=c.keyId;j=c.keyData;F.t0=g;F.next=F.t0===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET?6:F.t0===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE?7:20;break;case 6:return F.abrupt("break",20);case 7:F.next=9;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionInTransaction(f));case 9:k=F.sent;if(k){F.next=12;break}throw new(d("WASyncdError").SyncdFatalError)("no corresponding set mutation");case 12:l=k.keyId;F.next=15;return b("regeneratorRuntime").awrap(d("WASyncdKeyCache").getKeyData(l));case 15:m=F.sent;if(!(m==null)){F.next=18;break}throw new(d("WASyncdError").SyncdFatalError)("no key data for corresponding mutation");case 18:i=l,j=m;case 20:F.next=22;return b("regeneratorRuntime").awrap(h(a,i,j));case 22:n=F.sent;o=n.indexMac;p=n.indexAndValueCipherText;q=d("WASyncdCrypto").valueMacFromIndexAndValueCipherText(p);r=d("WABaseGlobals").getConfig().syncdShouldParsePatchDebugData();if(!(r&&g===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE)){F.next=50;break}F.next=30;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionsByIndexMacsInTransaction([o]));case 30:v=F.sent;w=v.length>0?v[0]:null;x="\n  generating a REMOVE mutation\n  calculated indexMac: "+d("WASyncdAntiTampering").indexAndValueMacToString(o,p)+" using keyId: "+d("WASyncdCryptoUtils").syncKeyIdToHex(i)+"\n  db action based on the index: "+(k==null?"":d("WASyncdAntiTampering").indexAndValueMacToString((s=k)==null?void 0:s.indexMac,(t=k)==null?void 0:t.valueMac))+" using keyId: "+(k==null?"":d("WASyncdCryptoUtils").syncKeyIdToHex((u=k)==null?void 0:u.keyId))+"\n  db action based on the indexMac: "+(w?d("WASyncdAntiTampering").indexAndValueMacToString(w.indexMac,w.valueMac):"N/A")+" using keyId: "+(w?d("WASyncdCryptoUtils").syncKeyIdToHex(w.keyId):"N/A")+"\n  ";F.next=35;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(e,x));case 35:if(!(w===null&&k!=null)){F.next=50;break}F.next=38;return b("regeneratorRuntime").awrap(d("WASyncdKeyCache").getKeyData(k.keyId));case 38:y=F.sent;if(!(y!=null)){F.next=50;break}F.next=42;return b("regeneratorRuntime").awrap(h(a,k.keyId,y));case 42:B=F.sent;C=B.indexMac;D=B.indexAndValueCipherText;F.next=47;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionsByIndexMacsInTransaction([k.indexMac]));case 47:E=F.sent;F.next=50;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().writeSyncdLog(e,"could not fetch row from sync action. recalculated indexMac: "+d("WASyncdAntiTampering").indexAndValueMacToString(C,D)+" using keyId: "+d("WASyncdCryptoUtils").syncKeyIdToHex(k.keyId)+".\n           cached indexMac: "+d("WASyncdAntiTampering").indexAndValueMacToString(k.indexMac,k.valueMac)+" using keyId: "+d("WASyncdCryptoUtils").syncKeyIdToHex(k.keyId)+".\n           correspondingSetAction.index===mutation.index ? "+(k.index===a.index?"true":"false")+".\n           index mac from self fetch: "+(E==null?"":d("WASyncdAntiTampering").indexAndValueMacToString((z=E[0])==null?void 0:z.indexMac,(A=E[0])==null?void 0:A.valueMac))+"\n                with keyId: "+(E==null?"":d("WASyncdCryptoUtils").syncKeyIdToHex(k.keyId))+".\n           is corresponding set action outgoing? "+(k.isOutgoing===!0?"true":k.isOutgoing===!1?"false":"unknown")+".\n           is corresponding set action individual mutation? "+(k.isIndividualMutation===!0?"true":k.isIndividualMutation===!1?"false":"unknown")+".\n           corresponding action state: "+k.actionState+"\n           corresponding action has model type? "+(k.modelType!=null?"true":"false")+".\n           "));case 50:return F.abrupt("return",babelHelpers["extends"]({},a,{keyId:i,keyData:j,indexMac:o,indexAndValueCipherText:p,valueMac:q}));case 51:case"end":return F.stop()}},null,this)}function h(a,c,e){var f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v,w;return b("regeneratorRuntime").async(function(x){while(1)switch(x.prev=x.next){case 0:x.prev=0;f=a.index,g=a.binarySyncAction,h=a.operation,j=a.version;k=d("WAArrayBufferUtils").stringToArrayBuffer(f);x.next=5;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateEncryptionKeys(e));case 5:l=x.sent;m=l.indexKey,n=l.valueEncryptionKey,o=l.valueMacKey;x.next=9;return b("regeneratorRuntime").awrap(d("WACryptoDependencies").getCrypto().getRandomValues(new Uint8Array(d("WASyncdCryptoConst").IV_LENGTH)));case 9:p=x.sent;q=d("WASyncdCrypto").generatePadding(k.byteLength,g.byteLength);r=i(k,g,q,j);x.next=14;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateCipherText(p,n,r));case 14:s=x.sent;t=d("WASyncdCrypto").generateAssociatedData(h,c);x.next=18;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateMac(t,s,o));case 18:u=x.sent;v=d("WASyncdCryptoUtils").combine([s,u]);x.next=22;return b("regeneratorRuntime").awrap(d("WASyncdCrypto").generateIndexMac(m,k));case 22:w=x.sent;return x.abrupt("return",{indexMac:w,indexAndValueCipherText:v});case 26:x.prev=26;x.t0=x["catch"](0);d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.ENCRYPTION_FAILED);throw new(d("WASyncdError").SyncdFatalError)("encryption failure");case 30:case"end":return x.stop()}},null,this,[[0,26]])}function i(a,b,c,e){return d("WASyncdRequestEncode").encodeSyncActionData({index:a,value:d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,b),padding:c,version:e})}g.encryptMutation=a}),98);
__d("WAArrayBuffersConcat",[],(function(a,b,c,d,e,f){"use strict";function a(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];var d=b.reduce(function(a,b){return a+b.byteLength},0),e=new Uint8Array(d),f=0;b.forEach(function(a){e.set(new Uint8Array(a),f),f+=a.byteLength});return e.buffer}f.concatArrayBuffers=a}),66);
__d("WASyncdRotateKey",["WAArrayBuffersConcat","WABaseGlobals","WAByteArray","WACryptoDependencies","WAJids","WASyncdKeyManagementUtils","WASyncdKeyTypes","WATimeUtils","equalsSet"],(function(a,b,c,d,e,f,g){"use strict";var h=1,i=90;function a(a){a=a.timestamp;var b=Math.min(i,Math.max(h,d("WABaseGlobals").getConfig().syncdKeyMaxUseDays()));b=b*d("WATimeUtils").DAY_MILLISECONDS;a=d("WATimeUtils").unixTimeMs()-a;return a>b}function b(a,b){a=a.fingerprint;var d=b.rawId,e=b.currentIndex;b=b.deviceIndexes;var f=new Set(a.deviceIndexes);for(var g=a.currentIndex+1;g<=e;g++)f.add(g);return a.rawId!==d||!c("equalsSet")(f,new Set(b))}function e(a,b){b=j(b);var c=b.keyId;b=b.keyEpoch;var e=k(),f=d("WATimeUtils").unixTimeMs();return{keyId:c,keyEpoch:b,keyData:e,fingerprint:a,timestamp:f}}function j(a){if(a==null){var b=new Uint8Array(16);d("WACryptoDependencies").getCrypto().getRandomValues(b);b=d("WASyncdKeyManagementUtils").generateNewKeyEpoch(d("WASyncdKeyTypes").toSyncKeyId(b.buffer))}else b=d("WASyncdKeyManagementUtils").generateNewKeyEpoch(a.keyId);a=d("WAJids").interpretAsNumber(d("WAJids").extractDeviceId(d("WABaseGlobals").getMyDeviceJid()));return{keyId:d("WASyncdKeyTypes").toSyncKeyId(new Uint8Array(d("WAArrayBuffersConcat").concatArrayBuffers(d("WAByteArray").intToBytes(2,a).buffer,d("WAByteArray").intToBytes(4,b).buffer)).buffer),keyEpoch:b}}function k(){return d("WASyncdKeyTypes").toSyncKeyData(d("WACryptoDependencies").getCrypto().getRandomValues(new Uint8Array(32)).buffer)}g.hasKeyExpired=a;g.hasADeviceBeenRemoved=b;g.rotateKey=e}),98);
__d("WASyncdKeyManagement",["WABaseGlobals","WAGetSyncKey","WALogger","WAPromiseQueue","WASyncdCryptoUtils","WASyncdKeyManagementUtils","WASyncdMetrics","WASyncdRotateKey","err","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: key rotation due to no key present"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: key rotation due to device removal"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: key rotation due to key expiry"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: stored key rotation key id ",""]);k=function(){return a};return a}var l=new(d("WAPromiseQueue").PromiseQueue)();function a(a){a===void 0&&(a=!0);return l.enqueue(function(){return m(a)})}function m(a){var e,f,g,l,o;return b("regeneratorRuntime").async(function(p){while(1)switch(p.prev=p.next){case 0:a===void 0&&(a=!0);p.next=3;return b("regeneratorRuntime").awrap(n());case 3:e=p.sent;p.next=6;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().getDeviceFingerprint());case 6:f=p.sent;g=!1;l=!1;if(!(e!=null)){p.next=16;break}g=d("WASyncdRotateKey").hasKeyExpired(e);l=d("WASyncdRotateKey").hasADeviceBeenRemoved(e,f);if(!(!a||!g&&!l)){p.next=14;break}return p.abrupt("return",{keyId:e.keyId,keyData:e.keyData});case 14:p.next=18;break;case 16:if(!(!a||d("WABaseGlobals").getConfig().isCompanion())){p.next=18;break}throw c("err")("syncd: No sync key available");case 18:o=d("WASyncdRotateKey").rotateKey(f,e);d("WALogger").LOG(k(),d("WASyncdCryptoUtils").syncKeyIdToHex(o.keyId));p.next=22;return b("regeneratorRuntime").awrap(d("WAGetSyncKey").setSyncKeyInTransaction(o));case 22:p.next=24;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().sendSyncdKeyRotation([o]));case 24:g&&(d("WALogger").LOG(j()),d("WASyncdMetrics").reportSyncdKeyRotationEvent(d("WASyncdMetrics").SyncdKeyRotationEventType.APP_STATE_SYNC_KEY_EXPIRY));l&&(d("WALogger").LOG(i()),d("WASyncdMetrics").reportSyncdKeyRotationEvent(d("WASyncdMetrics").SyncdKeyRotationEventType.DEVICE_DEREGISTERATION));e==null&&(d("WALogger").LOG(h()),d("WASyncdMetrics").reportSyncdKeyRotationEvent(d("WASyncdMetrics").SyncdKeyRotationEventType.NO_KEYS));return p.abrupt("return",m(a));case 28:case"end":return p.stop()}},null,this)}function n(){var a,c,e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:j.next=2;return b("regeneratorRuntime").awrap(d("WAGetSyncKey").getAllSyncKeysInTransaction());case 2:a=j.sent;if(!(a.length===0)){j.next=5;break}return j.abrupt("return",null);case 5:c=a.map(function(a){return d("WASyncdKeyManagementUtils").getKeyEpoch(a.keyId)});e=Math.max.apply(Math,c);f=a.filter(function(a){return d("WASyncdKeyManagementUtils").getKeyEpoch(a.keyId)===e});g=f.map(function(a){return d("WASyncdKeyManagementUtils").getKeyDeviceId(a.keyId)});h=Math.min.apply(Math,g);i=g.indexOf(h);return j.abrupt("return",f[i]);case 12:case"end":return j.stop()}},null,this)}g.getActiveKey=a;g.getNewestKeyPair=n}),98);
__d("WASyncdMMSUpload",["WABaseGlobals"],(function(a,b,c,d,e,f,g){"use strict";var h=100,i=2e3,j=10,k=100;function a(a){var b=Math.min(i,Math.max(d("WABaseGlobals").getConfig().syncdInlineMutationsMaxCount(),h));return a.length>b}function b(a){var b=Math.min(k,Math.max(d("WABaseGlobals").getConfig().syncdPatchProtobufMaxSize(),j))*1e3;return a.byteLength>b}g.exceedInlineMutationCount=a;g.exceedPatchProtobufSize=b}),98);
__d("WASyncdRequestBuilderTypesConverter",["WASyncAction.pb","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return a.map(function(a){var c=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,a.binarySyncData).value;c=d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,c).readBuffer();return{collection:a.collection,index:a.index,binarySyncAction:c,operation:b,version:a.version,timestamp:a.timestamp,action:a.action}})}g.syncActionsToPendingMutations=a}),98);
__d("WASyncdRequestBuilderBuild",["Promise","WABase64","WABaseGlobals","WAGetCollectionVersion","WAGetSyncAction","WAJids","WALogger","WAMediaCalculateFilehash","WAServerSync.pb","WASyncdAntiTampering","WASyncdConst","WASyncdCryptoUtils","WASyncdEncryptMutations","WASyncdKeyManagement","WASyncdKeyManagementUtils","WASyncdKeyTypes","WASyncdMMSUpload","WASyncdRequestBuilderTypesConverter","WASyncdRequestEncode","WASyncdWamAppState","WAWap","regeneratorRuntime","sortBy"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: end _buildCollectionNodes"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: skipping "," in sync iq patch because initial full sync\n        is incomplete"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: start _buildCollectionNodes"]);k=function(){return a};return a}var l=5;function a(a,c){var e,f,g,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:k.next=2;return b("regeneratorRuntime").awrap(n(a,c));case 2:e=k.sent;f=e.collectionNodes;g=e.collectionWithEncryptedMutations;h=e.localCollectionVersions;i=e.collectionsToSkip;j=m(d("WAWap").wap("sync",null,f));return k.abrupt("return",{syncIqNode:j,collectionWithEncryptedMutations:g,localCollectionVersions:h,collectionsToSkip:i});case 9:case"end":return k.stop()}},null,this)}function e(){return m(d("WAWap").wap("delete_all_data",null))}function m(a){return d("WAWap").wap("iq",{id:d("WAWap").generateId(),to:d("WAWap").S_WHATSAPP_NET,type:"set",xmlns:"w:sync:app:state"},a)}function n(a,c){var e,f,g,l,m,n,p;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:d("WALogger").LOG(k());e=[];f=function(a,f){var g,h,i,k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:n.next=2;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").getCollectionVersionInTransaction(a).then(function(a){return a==null?void 0:a.version}));case 2:g=n.sent;if(!(f!=null&&f.length>0)){n.next=16;break}if(!(g==null)){n.next=9;break}d("WALogger").LOG(j(),a);e.push(a);n.next=16;break;case 9:n.next=11;return b("regeneratorRuntime").awrap(o(a,f,c));case 11:k=n.sent,l=k.patchNode,m=k.encryptedMutations,h=l,i=m;case 16:return n.abrupt("return",{collection:a,version:g,patchNode:h,encryptedMutations:i});case 17:case"end":return n.stop()}},null,this)};g=new Map();l=new Map();m=[];a.forEach(function(a,b){return m.push(f(b,a))});q.next=9;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(m));case 9:n=q.sent;p=n.map(function(a){var b=a.collection,c=a.version,e=a.patchNode;a=a.encryptedMutations;a&&l.set(b,a);g.set(b,c);return d("WAWap").wap("collection",{name:d("WAWap").CUSTOM_STRING(b),return_snapshot:c===void 0?"true":"false",version:d("WAWap").INT((a=c)!=null?a:d("WASyncdConst").DEFAULT_COLLECTION_VERSION)},e)});d("WALogger").LOG(i());return q.abrupt("return",{collectionNodes:p,collectionWithEncryptedMutations:l,localCollectionVersions:g,collectionsToSkip:e});case 13:case"end":return q.stop()}},null,this)}function o(a,c,e){var f,g,i,j,k,l,m,n,o,w,x,y,z,A,B;return b("regeneratorRuntime").async(function(C){while(1)switch(C.prev=C.next){case 0:C.next=2;return b("regeneratorRuntime").awrap(d("WASyncdKeyManagement").getActiveKey(!p(c)));case 2:f=C.sent;C.next=5;return b("regeneratorRuntime").awrap(v(a,c,f));case 5:g=C.sent;i=g.map(function(b){return d("WASyncdEncryptMutations").encryptMutation(b,f,a)});C.next=9;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(i));case 9:j=C.sent;k=j.map(function(a){return{indexMac:a.indexMac,valueMac:a.valueMac,operation:a.operation}});C.next=13;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").computeLtHash(a,k,e));case 13:l=C.sent;m=l.ltHash;C.next=17;return b("regeneratorRuntime").awrap(d("WASyncdAntiTampering").computeOutgoingSnapshotAndPatchMacs(a,m,j,f.keyData));case 17:n=C.sent;o=n.snapshotMac;w=n.patchMac;x=j.map(function(a){return u(a.keyId,a.operation,a.indexMac,a.indexAndValueCipherText)});y=t(x);z=function(){var a,c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(d("WABaseGlobals").getDbImpls().uploadSyncExternalPatch(y));case 2:a=e.sent;e.next=5;return b("regeneratorRuntime").awrap(q(a,y));case 5:c=e.sent;return e.abrupt("return",r(c,f.keyId,o,w));case 7:case"end":return e.stop()}},null,this)};if(!d("WASyncdMMSUpload").exceedInlineMutationCount(x)){C.next=29;break}C.next=26;return b("regeneratorRuntime").awrap(z());case 26:A=C.sent;C.next=34;break;case 29:A=s(x,f.keyId,o,w);if(!d("WASyncdMMSUpload").exceedPatchProtobufSize(A)){C.next=34;break}C.next=33;return b("regeneratorRuntime").awrap(z());case 33:A=C.sent;case 34:B=d("WAWap").wap("patch",null,A);return C.abrupt("return",{patchNode:B,encryptedMutations:j});case 36:case"end":return C.stop()}},null,this)}function p(a){return d("WABaseGlobals").getConfig().logoutInProgress()&&a.some(function(a){return JSON.parse(a.index)[0]===d("WASyncdConst").Actions.Sentinel})}function q(a,c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=a.mediaKey,f=a.directPath,g=a.encFilehash,h=a.handle;j.next=3;return b("regeneratorRuntime").awrap(d("WAMediaCalculateFilehash").calculateFilehash(c));case 3:i=j.sent;return j.abrupt("return",{mediaKey:e,directPath:f,handle:h,fileSizeBytes:c.byteLength,fileSha256:d("WABase64").decodeB64(i),fileEncSha256:g});case 5:case"end":return j.stop()}},null,this)}function r(a,b,c,e){var f=d("WABaseGlobals").getConfig().syncdPatchDeviceIndexIncluded()?d("WAJids").extractDeviceId(d("WABaseGlobals").getMyDeviceJid()):void 0;return d("WASyncdRequestEncode").encodeSyncdPatch({keyId:{id:d("WASyncdKeyTypes").fromSyncKeyId(b)},externalMutations:a,snapshotMac:c,patchMac:e,deviceIndex:f})}function s(a,b,c,e){var f=d("WABaseGlobals").getConfig().syncdPatchDeviceIndexIncluded()?d("WAJids").extractDeviceId(d("WABaseGlobals").getMyDeviceJid()):void 0;return d("WASyncdRequestEncode").encodeSyncdPatch({keyId:{id:d("WASyncdKeyTypes").fromSyncKeyId(b)},mutations:a,snapshotMac:c,patchMac:e,deviceIndex:f})}function t(a){return d("WASyncdRequestEncode").encodeSyncdMutations({mutations:a})}function u(a,b,c,e){return{operation:b,record:{keyId:{id:d("WASyncdKeyTypes").fromSyncKeyId(a)},index:{blob:c},value:{blob:e}}}}function v(a,c,e){var f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:j.next=2;return b("regeneratorRuntime").awrap(d("WAGetSyncAction").getSyncActionsByCollectionsInTransaction([a]));case 2:f=j.sent;g=c;h=w(f,c,e.keyId);g=g.concat(h);i=x(f,g,e.keyId);d("WASyncdWamAppState").addKeyRotationRemoveCount(i.length);g=g.concat(i);return j.abrupt("return",g);case 10:case"end":return j.stop()}},null,this)}function w(a,b,e){a=a.filter(function(a){return!b.map(function(a){return a.index}).includes(a.index)&&!d("WASyncdCryptoUtils").syncKeyIdsEqual(a.keyId,e)});a=c("sortBy")(a,function(a){return d("WASyncdKeyManagementUtils").getKeyEpoch(a.keyId)});var f=Math.min(l,d("WABaseGlobals").getConfig().syncdAdditionalMutations());a=a.slice(0,f);return d("WASyncdRequestBuilderTypesConverter").syncActionsToPendingMutations(a,d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET)}function x(a,b,c){var e=b.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET}).map(function(a){return a.index});b=a.filter(function(a){return e.includes(a.index)});a=b.filter(function(a){return!d("WASyncdCryptoUtils").syncKeyIdsEqual(a.keyId,c)});return d("WASyncdRequestBuilderTypesConverter").syncActionsToPendingMutations(a,d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE)}g.buildSyncIqNode=a;g.buildDeleteAllIqNode=e;g._generateMutationsToUpload=v}),98);
__d("WASyncdRequestBuilderUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a){return g(a.reverse(),function(a){return a.index}).reverse()}function g(a,b){var c=new Set();return a.filter(function(a){a=b(a);if(c.has(a))return!1;c.add(a);return!0})}f.compactPatch=a}),66);
__d("WASyncdRequestBuilder",["Promise","WAGetPendingMutation","WASyncdRequestBuilderBuild","WASyncdRequestBuilderUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,c){var e,f,g;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:e=new Map();f=new Map();i.next=4;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(a.map(function(a){var c,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:i.next=2;return b("regeneratorRuntime").awrap(d("WAGetPendingMutation").getSyncPendingMutationsByCollectionInTransaction(a));case 2:c=i.sent,g=c.map(function(a){return a.id}).filter(Boolean),f.set(a,g),h=d("WASyncdRequestBuilderUtils").compactPatch(c),e.set(a,h);case 7:case"end":return i.stop()}},null,this)})));case 4:i.next=6;return b("regeneratorRuntime").awrap(d("WASyncdRequestBuilderBuild").buildSyncIqNode(e,c));case 6:g=i.sent;return i.abrupt("return",{syncIqNode:g.syncIqNode,collectionWithPendingMutationsIds:f,collectionWithEncryptedMutations:g.collectionWithEncryptedMutations,localCollectionVersions:g.localCollectionVersions,collectionsToSkip:g.collectionsToSkip});case 8:case"end":return i.stop()}},null,this)}g["default"]=a}),98);
__d("WASyncdResponseParser",["WADeprecatedWapParser","WALogger","WASyncdConst","WASyncdDecode","WASyncdError","WASyncdMetricFatalError"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection "," did not get server error"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection "," got server code has_more_patches"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: retryable error: collection "," throws ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error 404: collection "," throws ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: collection "," throws ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection "," got server error: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: successfully parsed collection ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection "," has no version, patches or snapshot"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: start parsing syncd collections"]);p=function(){return a};return a}a=new(c("WADeprecatedWapParser"))("syncResponseParser",function(a){d("WALogger").LOG(p());var b=[];a=a.child("sync");a.mapChildrenWithTag("collection",function(a){var c=babelHelpers["extends"]({},null),e=d("WASyncdConst").CollectionName.cast(a.attrString("name"));if(!e)throw new(d("WASyncdError").SyncdFatalError)("invalid collection name");c.name=e;c.state=q(a,c.name);a.hasAttr("version")&&(c.version=parseInt(a.attrString("version"),10));a.hasChild("patches")&&(c.patches=a.child("patches").mapChildrenWithTag("patch",function(a){return d("WASyncdDecode").decodeSyncdPatch(e,a.contentBytes())}));a.hasChild("snapshot")&&(c.snapshot=d("WASyncdDecode").decodeExternalBlobReference(e,a.child("snapshot").contentBytes()));b.push(c);c.version==null&&c.patches==null&&c.snapshot==null&&d("WALogger").LOG(o(),e);d("WALogger").LOG(n(),e)});return b});function q(a,b){if(a.hasAttr("type")&&a.attrString("type")==="error"){var c=a.child("error"),e=c.attrString("code");c=c.attrString("text");d("WALogger").LOG(m(),b,e);switch(e){case"409":return a.hasAttr("has_more_patches")?d("WASyncdConst").CollectionState.ConflictHasMore:d("WASyncdConst").CollectionState.Conflict;case"400":d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.XMPP_BAD_REQUEST_FOR_COLLECTION);d("WALogger").ERROR(l(),String(b),c).sendLogs("syncd: fatal error 400: collection "+String(b));return d("WASyncdConst").CollectionState.ErrorFatal;case"404":d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.XMPP_NOT_FOUND_FOR_COLLECTION);d("WALogger").ERROR(k(),String(b),c).sendLogs("syncd: fatal error: collection "+String(b));return d("WASyncdConst").CollectionState.ErrorFatal;default:d("WALogger").WARN(j(),String(b),c).sendLogs("syncd: retryable error: collection "+String(b));return d("WASyncdConst").CollectionState.ErrorRetry}}else if(a.hasAttr("has_more_patches")){d("WALogger").LOG(i(),b);return d("WASyncdConst").CollectionState.SuccessHasMore}else{d("WALogger").LOG(h(),b);return d("WASyncdConst").CollectionState.Success}}g.syncResponseParser=a}),98);
__d("WASyncdServerSync",["Promise","WABaseGlobals","WADeprecatedSendIq","WAGetCollectionVersion","WAGetPendingMutation","WALogger","WASyncd","WASyncdCollectionHandler","WASyncdConst","WASyncdError","WASyncdMetricCriticalBootstrapStage","WASyncdMetricFatalError","WASyncdMetrics","WASyncdRequestBuilder","WASyncdResponseParser","WASyncdWamAppState","WATimeUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: cannot log collection sync start: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: received sync response for collections:\n      ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: completed network operation for collections:\n    ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: retryable error: syncd global throws ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: syncd global throws ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: end apply collections: ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: start apply collections:\n      ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["\n\t"," v",""],["\\n\\t"," v",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: local collection versions:"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: deferred local mutation upload for ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: reached max iterations for collections: ",""]);t=function(){return a};return a}var u=5,v=500;function a(a){var c,e,f,g,i,j,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:c=Math.random().toString(36).substr(2,5);l.next=3;return b("regeneratorRuntime").awrap(A(a,c+" start serverSync"));case 3:e=[],f=[].concat(a),g=0;case 6:if(!(g<u||f.length>0&&g<v)){l.next=22;break}if(!(f.length===0)){l.next=9;break}return l.abrupt("break",22);case 9:l.next=11;return b("regeneratorRuntime").awrap(w(f,c));case 11:i=l.sent;j=i.doneCollections;k=i.refetchCollections;l.next=16;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(j.map(function(a){return A([a.name],c+" done collection "+a.name+",\n            state: "+a.state)})));case 16:f=k;e=e.concat(j);g++;c=Math.random().toString(36).substr(2,5);l.next=6;break;case 22:if(!(f.length>0)){l.next=27;break}l.next=25;return b("regeneratorRuntime").awrap(A(f,"error: max iterations"));case 25:d("WALogger").ERROR(t(),f).tags("syncd").sendLogs("syncd: max iteration"),e=e.concat(f.map(function(a){return{state:d("WASyncdConst").CollectionState.ErrorRetry,name:a}}));case 27:return l.abrupt("return",e);case 28:case"end":return l.stop()}},null,this)}function w(a,c){var e,f,g,i,j,k,l,t,u,v,w;return b("regeneratorRuntime").async(function(y){while(1)switch(y.prev=y.next){case 0:if(!(a.length===0)){y.next=2;break}return y.abrupt("return",{doneCollections:[],refetchCollections:[]});case 2:y.next=4;return b("regeneratorRuntime").awrap(z(a));case 4:y.prev=4;y.next=7;return b("regeneratorRuntime").awrap(x(a,c));case 7:e=y.sent;f=e.collectionDetails;g=e.localCollectionVersions;i=e.collectionsToUpload;i.length>0&&d("WALogger").LOG(s(),i);d("WALogger").LOG(r(),c);g.forEach(function(a,b){d("WALogger").LOG(q(),b,(b=a)!=null?b:"(undefined)}")});j=[];k=[];f.forEach(function(a){switch(a.state){case d("WASyncdConst").CollectionState.ErrorRetry:case d("WASyncdConst").CollectionState.ErrorFatal:case d("WASyncdConst").CollectionState.Blocked:k.push(a);return;default:j.push(a)}(a.state===d("WASyncdConst").CollectionState.Conflict||a.state===d("WASyncdConst").CollectionState.ConflictHasMore)&&d("WASyncdWamAppState").incConflict()});d("WALogger").LOG(p(),c,j.map(function(a){return a.name}));l=new(d("WASyncdMetrics").SyncdEventFlow)();y.next=21;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(j.map(function(a){return d("WASyncdCollectionHandler").applyAppStateSyncResponse(a,c,g.get(a.name),l)})));case 21:t=y.sent;l.end();d("WALogger").LOG(o(),j.map(function(a){return a.name}));u=[];y.next=27;return b("regeneratorRuntime").awrap((h||(h=b("Promise"))).all(t.map(function(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:if(!(a.state===d("WASyncdConst").CollectionState.Conflict)){e.next=8;break}e.next=3;return b("regeneratorRuntime").awrap(d("WAGetPendingMutation").getSyncPendingMutationsByCollectionInTransaction(a.name));case 3:e.t0=e.sent.length;c=e.t0>0;c?u.push(a.name):(a.state=d("WASyncdConst").CollectionState.Success,k.push(a));e.next=15;break;case 8:if(!(a.state===d("WASyncdConst").CollectionState.ConflictHasMore||a.state===d("WASyncdConst").CollectionState.SuccessHasMore||a.state===d("WASyncdConst").CollectionState.Success&&i.some(function(b){return b===a.name}))){e.next=12;break}u.push(a.name);e.next=15;break;case 12:k.push(a);e.next=15;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").updateLastSuccessfulSyncEndTimeInTransaction(a.name));case 15:case"end":return e.stop()}},null,this)})));case 27:return y.abrupt("return",{doneCollections:k,refetchCollections:u});case 30:y.prev=30;y.t0=y["catch"](4);if(!(y.t0 instanceof d("WASyncdError").SyncdFatalError)){y.next=38;break}d("WALogger").ERROR(n(),y.t0.message).sendLogs("syncd: fatal error: syncd global throws "+y.t0.message);y.next=36;return b("regeneratorRuntime").awrap(A(a,c+" moving to fatal state: "+y.t0.name+" "+y.t0.message+" "+y.t0.stack));case 36:v=a.map(function(a){return{state:d("WASyncdConst").CollectionState.ErrorFatal,name:a}});return y.abrupt("return",{doneCollections:v,refetchCollections:[]});case 38:d("WALogger").WARN(m(),c,y.t0.message).sendLogs("syncd: retryable error: syncd global throws "+y.t0.message);y.next=41;return b("regeneratorRuntime").awrap(A(a,"["+c+"] retryable error: "+y.t0));case 41:w=a.map(function(a){return{state:d("WASyncdConst").CollectionState.ErrorRetry,name:a,serverBackoff:y.t0.errorBackoff}});return y.abrupt("return",{doneCollections:w,refetchCollections:[]});case 43:case"end":return y.stop()}},null,this,[[4,30]])}function x(a,e){var f,g,h,i,m,n,o,p,q,r,s,t;return b("regeneratorRuntime").async(function(u){while(1)switch(u.prev=u.next){case 0:u.next=2;return b("regeneratorRuntime").awrap(c("WASyncdRequestBuilder")(a,e));case 2:f=u.sent;g=f.syncIqNode;h=f.collectionWithPendingMutationsIds;i=f.collectionWithEncryptedMutations;m=f.localCollectionVersions;n=f.collectionsToSkip;d("WASyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(d("WASyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.REQUEST_BUILT);o="["+e+"] syncd: before sendIq for collections:\n    "+a.map(function(a){var b;return"\n\t\n          "+a+" v"+((b=m.get(a))!=null?b:"(undefined)")+" "+(((b=(b=h.get(a))==null?void 0:b.length)!=null?b:0)>0&&m.get(a)!=null?" with local changes":"")}).join(",")+"\n\n  in flight: "+Array.from(d("WASyncd").getInFlightCollections()).join(",")+"\n  pending: "+Array.from(d("WASyncd").getPendingCollections()).join(",")+"\n  is worker? "+B().toString()+"\n  ";d("WALogger").LOG(l(),e,o);u.next=13;return b("regeneratorRuntime").awrap(A(a,o));case 13:u.next=15;return b("regeneratorRuntime").awrap(d("WADeprecatedSendIq").deprecatedSendIq(g,d("WASyncdResponseParser").syncResponseParser));case 15:p=u.sent;d("WALogger").LOG(k(),e,a);d("WASyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(d("WASyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.RESPONSE_RECEIVED);if(!p.success){u.next=26;break}d("WASyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(d("WASyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.RESPONSE_PARSED_VALID);u.next=22;return b("regeneratorRuntime").awrap(A(a,"["+e+"] after sendIq success"));case 22:q=p.result;d("WALogger").LOG(j(),e,q.map(function(a){var b="\n"+a.name;a.version!=null&&(b+="\n\tupdated to version "+a.version);a.snapshot!=null&&(b+="\n\tcontains snapshot");a.patches!=null&&(b+="\n\tcontains "+a.patches.length+" patches");return b}));q.forEach(function(a){var b=h.get(a.name);b&&(a.syncedPendingMutationsId=b);b=i.get(a.name);b&&(a.syncedEncryptedMutations=b)});return u.abrupt("return",{collectionDetails:q,localCollectionVersions:m,collectionsToUpload:n});case 26:r=p.errorCode,s=p.errorText,t=p.errorBackoff;throw y(r,s,t);case 28:case"end":return u.stop()}},null,this)}function y(a,b,c){switch(a){case 400:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.XMPP_BAD_REQUEST_GLOBAL_ERROR);return new(d("WASyncdError").SyncdFatalError)(b);case 404:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.XMPP_NOT_FOUND_GLOBAL_ERROR);return new(d("WASyncdError").SyncdFatalError)(b);case 405:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.XMPP_BAD_METHOD_GLOBAL_ERROR);return new(d("WASyncdError").SyncdFatalError)(b);case 406:d("WASyncdMetricFatalError").reportSyncdFatalError(d("WASyncdMetricFatalError").SyncdFatalErrorType.XMPP_NOT_ACCEPTABLE_GLOBAL_ERROR);return new(d("WASyncdError").SyncdFatalError)(b);default:return new(d("WASyncdError").SyncdRetryableError)(b,c)}}function z(a){var c,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.prev=0;c=5;g.next=4;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").bulkGetCollectionVersionsInTransaction(a));case 4:e=g.sent;f=e.filter(Boolean).map(function(a){var b;b=((b=a.lastSyncAttemptStartTimes)!=null?b:[]).slice(-c+1);return{collection:a.collection,lastSyncAttemptStartTimes:[].concat(b,[d("WATimeUtils").unixTimeMs()])}});g.next=8;return b("regeneratorRuntime").awrap(d("WAGetCollectionVersion").bulkSetCollectionSyncAttemptStartTimesInTransaction(f));case 8:g.next=13;break;case 10:g.prev=10,g.t0=g["catch"](0),d("WALogger").ERROR(i(),g.t0).tags("syncd").sendLogs("syncd: cannot log collection sync start");case 13:case"end":return g.stop()}},null,this,[[0,10]])}function A(a,c){return(h||(h=b("Promise"))).all(a.map(function(a){return d("WABaseGlobals").getDbImpls().writeSyncdLog(a,c)}))}function B(){return typeof WorkerGlobalScope!=="undefined"&&typeof importScripts==="function"}g.serverSync=a;g.isWorker=B}),98);
__d("WAWebSyncdDb",["WALogger","WASyncAction.pb","WASyncdKeyTypes","WAWebABProps","WAWebSchemaCollectionVersion","WAWebSchemaMissingKeys","WAWebSchemaPendingMutations","WAWebSchemaSyncActions","WAWebSchemaSyncKeys","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: adding pending mutations:\n  ",""]);h=function(){return a};return a}function a(){return d("WAWebSchemaPendingMutations").getPendingMutationsTable().all()}function c(a,b){return d("WAWebSchemaPendingMutations").getPendingMutationsTable().equals(a,b)}function e(a,b){return d("WAWebSchemaPendingMutations").getPendingMutationsTable().equals(a,b)}function f(a){d("WALogger").DEV(h(),JSON.stringify(a.map(function(a){return{operation:a.operation,index:a.index,value:d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,a.binarySyncAction)}}),null,2));return d("WAWebSchemaPendingMutations").getPendingMutationsTable().bulkCreate(a)}function i(a){return d("WAWebSchemaPendingMutations").getPendingMutationsTable().bulkRemove(a)}function j(a,b,c){return d("WAWebSchemaCollectionVersion").getCollectionVersionTable().createOrMerge(a,{collection:a,version:b,ltHash:c})}function k(a){return d("WAWebSchemaSyncActions").getSyncActionsTable().get(a)}function l(a,b){return d("WAWebSchemaSyncActions").getSyncActionsTable().anyOf(a,b)}function m(a){return d("WAWebSchemaSyncActions").getSyncActionsTable().createOrReplace(a)}function n(a){return d("WAWebSchemaSyncActions").getSyncActionsTable().bulkCreateOrReplace(a)}function o(a){return d("WAWebSchemaSyncActions").getSyncActionsTable().bulkCreateOrMerge(a.map(function(a){return babelHelpers["extends"]({},a)}))}function p(a){return d("WAWebSchemaSyncActions").getSyncActionsTable().bulkRemove(a)}function q(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaSyncKeys").getSyncKeysTable().get(new Uint8Array(d("WASyncdKeyTypes").fromSyncKeyId(a))));return a==null?a:d("WAWebSchemaSyncKeys").convertToSyncKeyFromRow(a)});return r.apply(this,arguments)}function s(){return d("WAWebSchemaSyncKeys").getSyncKeysTable().all().then(function(a){return a.map(d("WAWebSchemaSyncKeys").convertToSyncKeyFromRow)})}function t(a){return d("WAWebABProps").getABPropConfigValue("enable_override_syncd_key")?d("WAWebSchemaSyncKeys").getSyncKeysTable().createOrReplace(d("WAWebSchemaSyncKeys").convertFromSyncKeyToRow(a)).then(function(a){return d("WASyncdKeyTypes").toSyncKeyId(a.buffer)}):d("WAWebSchemaSyncKeys").getSyncKeysTable().create(d("WAWebSchemaSyncKeys").convertFromSyncKeyToRow(a)).then(function(a){return d("WASyncdKeyTypes").toSyncKeyId(a.buffer)})}function u(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaSyncKeys").getSyncKeysTable().equals(["keyEpoch"],a));a.forEach(function(a){return d("WAWebSchemaSyncKeys").getSyncKeysTable().merge({keyId:a.keyId},{timestamp:0})})});return v.apply(this,arguments)}function w(){return d("WAWebSchemaMissingKeys").getMissingKeysTable().count()}function x(a){return d("WAWebSchemaMissingKeys").getMissingKeysTable().bulkGet(a).then(function(a){return a.map(function(a){return a==null?null:d("WAWebSchemaMissingKeys").convertToMissingKeyFromRow(a)})})}function y(){return d("WAWebSchemaMissingKeys").getMissingKeysTable().all().then(function(a){return a.map(d("WAWebSchemaMissingKeys").convertToMissingKeyFromRow)})}function z(a){return d("WAWebSchemaMissingKeys").getMissingKeysTable().bulkRemove(a)}function A(a){return d("WAWebSchemaMissingKeys").getMissingKeysTable().bulkCreateOrMerge(a.map(d("WAWebSchemaMissingKeys").convertFromMissingKeyToRow))}g.getAllPendingMutationsRows=a;g.getPendingMutationsRows=c;g.getPendingMutationsRowsByIndex=e;g.appendPendingMutationsRows=f;g.bulkRemovePendingMutations=i;g.setCollectionVersion=j;g.getSyncAction=k;g.getSyncActionsRows=l;g.setSyncAction=m;g.setSyncActionRows=n;g.updateSyncActionRows=o;g.deleteSyncActionRows=p;g.getSyncKey=q;g.getAllSyncKeys=s;g.createSyncKey=t;g.expireSyncKey=u;g.getMissingKeyCount=w;g.bulkGetMissingKeys=x;g.getAllMissingKeys=y;g.bulkRemoveMissingKeys=z;g.createOrUpdateMissingKeys=A}),98);
__d("WAWebUserPrefsAppStateSync",["WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsKeys","WAWebUserPrefsStore","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.CRITICAL_DATA_SYNCED,!0);return c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").MD_KEYS.CRITICAL_DATA_SYNCED,!0)});return h.apply(this,arguments)}function e(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.CRITICAL_DATA_SYNCED);return a===!0}function f(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.LAST_PERIODIC_APP_STATE_SYNC_TS,a);return c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").MD_KEYS.LAST_PERIODIC_APP_STATE_SYNC_TS,a)});return i.apply(this,arguments)}function j(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.RECENT_MAILBOX_AGE_DAYS);return a}function k(){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.SHOULD_CHECK_CONTACT_SYNC_STATUS,!0);return c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").MD_KEYS.SHOULD_CHECK_CONTACT_SYNC_STATUS,!0)});return l.apply(this,arguments)}function m(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.MD_SYNC_ACTIONS_ACTION_SANITIZED);return a===!0}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.MD_SYNC_ACTIONS_ACTION_SANITIZED,a),c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").MD_KEYS.MD_SYNC_ACTIONS_ACTION_SANITIZED,a)});return o.apply(this,arguments)}function p(){return c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").MD_KEYS.SYNCD_PRIMARY_ALLOWS_ALL_MUTATIONS,!0)}function q(){return!!c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").MD_KEYS.SYNCD_PRIMARY_ALLOWS_ALL_MUTATIONS)}function r(){return d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.NON_CRITICAL_DATA_SYNC_STATUS)}function s(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(b=(yield r()))!=null?b:{};yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.NON_CRITICAL_DATA_SYNC_STATUS,babelHelpers["extends"]({},b,a))});return t.apply(this,arguments)}g.setAllCriticalDataSynced=a;g.getAllCriticalDataSynced=e;g.setLastPeriodicAppStateSyncTs=f;g.getLastPeriodicAppStateSyncTs=j;g.setShouldCheckContactSyncStatus=k;g.getMdSyncActionsActionSanitized=m;g.setMdSyncActionsActionSanitized=n;g.setPrimaryAllowsAllMutations=p;g.getPrimaryAllowsAllMutations=q;g.getNonCriticalDataSyncStatus=r;g.setNonCriticalDataSyncStatus=s}),98);
__d("WAWebSyncd",["Promise","WALogger","WAServerSync.pb","WASyncd","WASyncdConst","WASyncdDisabled","WASyncdGetActionHandler","WASyncdRequestBuilderTypesConverter","WATypeUtils","WAWebCmd","WAWebEventsWaitForOfflineDeliveryEnd","WAWebLid1X1MigrationGating","WAWebModelStorageUtils","WAWebSchemaChat","WAWebSchemaSyncActions","WAWebSyncdDb","WAWebUserPrefsAppStateSync","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","lodash","tryParseJSONMixed"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: getPnMutationsForLidCleanup: chat JID not a string"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: getPnMutationsForLidCleanup: indexParts is not an array"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: invalid action ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: sanitizing null 'action' property in sync-actions table"]);l=function(){return a};return a}var m=["pending-mutations"];function a(){if(d("WASyncdDisabled").isSyncdDisabled())return(h||(h=b("Promise"))).resolve();n();d("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd().then(function(){d("WASyncd").processOnAppResume()});o();return d("WASyncd").initializeStateMachine()}function n(){var a=1e3*60;a=c("lodash").debounce(d("WASyncd").reportWam,a,{maxWait:a*3});d("WAWebCmd").Cmd.on(d("WAWebCmd").APP_STATE_SYNC_COMPLETED,a)}function o(){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebUserPrefsAppStateSync").getMdSyncActionsActionSanitized());if(!a){d("WALogger").LOG(l());a=(yield d("WAWebSchemaSyncActions").getSyncActionsTable().all());a=a.filter(function(a){return a.action==null});a=a.map(function(a){var b=JSON.parse(a.index)[0],c=d("WASyncdConst").Actions.cast(b);if(!c){d("WALogger").LOG(k(),b);return babelHelpers["extends"]({},a)}return babelHelpers["extends"]({},a,{action:b})});yield d("WAWebSyncdDb").updateSyncActionRows(a);yield d("WAWebUserPrefsAppStateSync").setMdSyncActionsActionSanitized(!0)}});return p.apply(this,arguments)}function e(a,c,e){a=[].concat(a,m);d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&a.push("chat","sync-actions");a=d("WAWebModelStorageUtils").getStorage().lock(a,function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var f=(yield q(c));return(h||(h=b("Promise"))).all([d("WAWebSyncdDb").appendPendingMutationsRows(c.concat(f)),e(a)])});return function(b){return a.apply(this,arguments)}}()).then(function(){var a=c.map(function(a){return a.collection});void d("WASyncd").markCollectionsForSync(a)});return(h||(h=b("Promise"))).resolve(a)}function q(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()||d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isSyncdSessionMigrated())return[];a=(yield (h||(h=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.action==null)return;var b=d("WASyncdGetActionHandler").getActionHandler(a.action);if((b==null?void 0:b.chatJidIndex)==null)return;b=b.chatJidIndex;a=c("tryParseJSONMixed")(a.index);if(!Array.isArray(a)){d("WALogger").ERROR(j()).sendLogs("syncd-lid-cleanup-invalid-index-non-array");return}var e=a[b];if(!d("WATypeUtils").isString(e)){d("WALogger").ERROR(i()).sendLogs("syncd-lid-cleanup-invalid-index-non-string-jid");return}if(!c("WAWebWid").isLid(e))return;e=(yield d("WAWebSchemaChat").getChatTable().equals(["accountLid"],e,{shouldDecrypt:!1}))[0];if(e==null||e.accountLid===e.id)return;e=d("WAWebWidFactory").createWid(e.id).toJid();a=[].concat(a);a[b]=e;b=JSON.stringify(a);return d("WAWebSchemaSyncActions").getSyncActionsTable().get(b)});return function(b){return a.apply(this,arguments)}}()))).filter(Boolean).map(d("WAWebSchemaSyncActions").convertToSyncActionFromRow);return d("WASyncdRequestBuilderTypesConverter").syncActionsToPendingMutations(a,d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE)});return r.apply(this,arguments)}g.initialize=a;g.sanitizeActionInSyncActionsRow=o;g.lockForSync=e}),98);
__d("WASyncdAction",["Promise","WASyncdConst"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(){}var c=a.prototype;c.resolveConflicts=function(a,c){c=c.timestamp;return c>=a.timestamp?(h||(h=b("Promise"))).resolve(d("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal):(h||(h=b("Promise"))).resolve(d("WASyncdConst").ConflictResolutionState.SkipRemote)};c.dropMutationDueToCrossIndexConflict=function(a,c){return(h||(h=b("Promise"))).resolve(!1)};return a}();g.SyncActionBase=a}),98);
__d("WASyncdActionUtils",["WASyncAction.pb","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){return JSON.stringify([a].concat(b))}function a(a){var b=a.action,c=a.indexArgs,e=a.collection,f=a.value,g=a.version,i=a.operation;a=a.timestamp;return{collection:e,index:h(b,c),binarySyncAction:d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,babelHelpers["extends"]({},f,{timestamp:a})).readBuffer(),version:g,operation:i,timestamp:a,action:b}}function b(a){var b=a.remoteJid,c=a.id,d=a.fromMe;a=a.participant;return[b,c,d?"1":"0",a!=null&&!d?a:"0"]}g.buildIndex=h;g.buildPendingMutation=a;g.buildMessageKey=b}),98);
__d("WAWebNuxSync",["Promise","WALogger","WAServerSync.pb","WASyncdAction","WASyncdActionUtils","WASyncdConst","WATimeUtils","WATypeUtils","WAWebSyncd","WAWebUserPrefsNuxPreferences","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["NuxSync: update nux to local store"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["NuxSync: malformed mutation"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["NuxSync: operation not supported ",""]);k=function(){return a};return a}a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.chatJidIndex=null,b)||babelHelpers.assertThisInitialized(c)}var e=c.prototype;e.getVersion=function(){return 7};e.getAction=function(){return d("WASyncdConst").Actions.Nux};e.applyMutations=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[];a=a.map(function(a){if(a.operation!=="set"){d("WALogger").WARN(k(),a);return{actionState:d("WASyncdConst").SyncActionState.Malformed}}var c=a.indexParts[1];if(!d("WATypeUtils").isString(c)){d("WALogger").WARN(j()).devConsole(a);return{actionState:d("WASyncdConst").SyncActionState.Malformed}}b.push({nuxKey:c,acknowledged:((c=a.value.nuxAction)==null?void 0:c.acknowledged)===!0});return{actionState:d("WASyncdConst").SyncActionState.Success}});b.length!==0&&(d("WALogger").LOG(i()),d("WAWebUserPrefsNuxPreferences").updateNuxSyncList(b));return a});function c(b){return a.apply(this,arguments)}return c}();e.$NuxSync1=function(a,b,c){c={nuxAction:{acknowledged:c}};return d("WASyncdActionUtils").buildPendingMutation({collection:d("WASyncdConst").CollectionName.RegularLow,indexArgs:[a],value:c,version:this.getVersion(),operation:d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET,timestamp:b,action:this.getAction()})};e.acknowledgeNux=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield this.$NuxSync2(a,!0)});function c(b){return a.apply(this,arguments)}return c}();e.unAcknowledgeNux=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield this.$NuxSync2(a,!1)});function c(b){return a.apply(this,arguments)}return c}();e.$NuxSync2=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){d("WAWebUserPrefsNuxPreferences").updateNuxSyncList([{nuxKey:a,acknowledged:c}]);a=this.$NuxSync1(a,d("WATimeUtils").unixTimeMs(),c);yield d("WAWebSyncd").lockForSync([],[a],function(){return(h||(h=b("Promise"))).resolve()})});function c(b,c){return a.apply(this,arguments)}return c}();return c}(d("WASyncdAction").SyncActionBase);c=new a();g["default"]=c}),98);
__d("WAWebTimestampConversionUtils",["WALogger","WALongInt","WATimeUtils"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: maybeMillisecondsToSeconds: messageTimestamp: "," too large to cast"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: maybeMillisecondsToSeconds: no need to adjust timestamp"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: maybeMillisecondsToSeconds: adjusting future timestamp"]);j=function(){return a};return a}function a(a){var b=a;try{d("WALongInt").numberOrThrowIfTooLarge(a)/d("WATimeUtils").unixTime()>10?(b=d("WALongInt").numberOrThrowIfTooLarge(a)/1e3,d("WALogger").LOG(j())):d("WALogger").LOG(i())}catch(b){d("WALogger").WARN(h(),a)}return b}g.maybeMillisecondsToSeconds=a}),98);
__d("WAWebActiveMessageRanges",["WALogger","WALongInt","WAWebApiActiveMessageRanges","WAWebHandleForMessageRangeEnums","WAWebSchemaActiveMessageRanges","WAWebTimestampConversionUtils"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: last message timestamp was converted to seconds from ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing message range from row."]);i=function(){return a};return a}function j(a,b){var c,e;if(a==null){d("WALogger").WARN(i());return d("WAWebHandleForMessageRangeEnums").RangeContain.DOES_NOT_CONTAIN}var f=a.messages;a=a.lastMessageTimestamp;c=d("WAWebTimestampConversionUtils").maybeMillisecondsToSeconds((c=a)!=null?c:0);c!==((e=a)!=null?e:0)&&d("WALogger").LOG(h(),a).sendLogs("syncd: last message timestamp was converted to seconds",{sampling:.01});if(b.t!=null&&b.t<d("WALongInt").numberOrThrowIfTooLarge(c))return d("WAWebHandleForMessageRangeEnums").RangeContain.CONTAINS_BY_TIMESTAMP;e=b.id;for(a=f,c=Array.isArray(a),b=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(c){if(b>=a.length)break;f=a[b++]}else{b=a.next();if(b.done)break;f=b.value}f=f;f=f.key;if(f!=null&&e!=null&&f.id===e.id)return d("WAWebHandleForMessageRangeEnums").RangeContain.CONTAINS_BY_ADDITIONAL}return d("WAWebHandleForMessageRangeEnums").RangeContain.DOES_NOT_CONTAIN}function a(a,b){d("WAWebApiActiveMessageRanges").getActiveMessageRanges(a.remote.toString()).then(function(c){c.forEach(function(c){if([d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.Archive,d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.MarkChatAsRead].includes(c.action)&&j(c.actionValue.messageRange,{id:a,t:b})===d("WAWebHandleForMessageRangeEnums").RangeContain.DOES_NOT_CONTAIN)return d("WAWebApiActiveMessageRanges").removeActiveMessageRange(a.remote.toString(),c.action)})})}g.rangeContainsMessage=j;g.checkAndRemoveActiveMessageRanges=a}),98);
__d("WAWebWamEnumCollection",[],(function(a,b,c,d,e,f){a=Object.freeze({REGULAR:1,REGULAR_LOW:2,REGULAR_HIGH:3,CRITICAL_BLOCK:4,CRITICAL_UNBLOCK_LOW:5});f.COLLECTION=a}),66);
__d("WAWebWamEnumMdSyncdCriticalEventCode",[],(function(a,b,c,d,e,f){a=Object.freeze({MESSAGE_RANGE_UNSET:1,MESSAGE_RANGE_LAST_SYSTEM_MESSAGE_TIMESTAMP_SET:2,MESSAGE_RANGE_MESSAGES_UNSET:3,MESSAGE_RANGE_MESSAGES_EMPTY:4,MESSAGE_RANGE_MESSAGES_CROSS_LIMIT:5,MESSAGE_RANGE_MESSAGE_KEY_UNSET:6,MESSAGE_RANGE_MESSAGE_KEY_REMOTE_JID_UNSET:7,MESSAGE_RANGE_MESSAGE_KEY_FROM_ME_UNSET:8,MESSAGE_RANGE_MESSAGE_KEY_STANZA_ID_UNSET:9,MESSAGE_RANGE_MESSAGE_KEY_REMOTE_JID_INVALID:10,MESSAGE_RANGE_MESSAGE_KEY_PARTICIPANT_UNSET:11,MALFORMED_PENDING_MUTATION:12,ACTION_INVALID_INDEX_DATA:13,MISSING_MUTATION_TO_REMOVE:14,LTHASH_INCONSISTENCY_ON_DAILY_CHECK:15,LTHASH_INCONSISTENCY_ON_SNAPSHOT_MAC_MISMATCH:16});f.MD_SYNCD_CRITICAL_EVENT_CODE=a}),66);
__d("WAWebMdCriticalEventWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumCollection","WAWebWamEnumMdSyncdCriticalEventCode"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({MdCriticalEvent:[2746,{collection:[2,d("WAWebWamEnumCollection").COLLECTION],mdCriticalEventCode:[1,d("WAWebWamEnumMdSyncdCriticalEventCode").MD_SYNCD_CRITICAL_EVENT_CODE]},[1,1,1],"regular"]},{MdCriticalEvent:[]});g.MdCriticalEventWamEvent=a}),98);
__d("WAWebSyncdUtils",["WASyncdActionUtils","WASyncdConst","WAWebMdCriticalEventWamEvent","WAWebWamEnumCollection"],(function(a,b,c,d,e,f,g){function a(a){return d("WASyncdActionUtils").buildIndex(d("WASyncdConst").Actions.Star,h(a))}function b(a){return h(a.id)}function h(a){var b=i(a);return[a.remote.toString({legacy:!0}),a.id,a.fromMe?"1":"0",b]}function i(a){var b="0";a.participant&&!a.remote.isUser()&&!a.fromMe&&(b=a.participant.toString({legacy:!0}));return b}function j(a){switch(a){case d("WASyncdConst").CollectionName.CriticalBlock:return d("WAWebWamEnumCollection").COLLECTION.CRITICAL_BLOCK;case d("WASyncdConst").CollectionName.CriticalUnblockLow:return d("WAWebWamEnumCollection").COLLECTION.CRITICAL_UNBLOCK_LOW;case d("WASyncdConst").CollectionName.Regular:return d("WAWebWamEnumCollection").COLLECTION.REGULAR;case d("WASyncdConst").CollectionName.RegularHigh:return d("WAWebWamEnumCollection").COLLECTION.REGULAR_HIGH;case d("WASyncdConst").CollectionName.RegularLow:return d("WAWebWamEnumCollection").COLLECTION.REGULAR_LOW}}function c(a,b){a=new(d("WAWebMdCriticalEventWamEvent").MdCriticalEventWamEvent)({mdCriticalEventCode:a});b!=null&&(a.collection=j(b));a.commit()}g.constructStarMsgKeyFromMsgKey=a;g.constructMsgKeySegments=b;g.constructMsgKeySegmentsFromMsgKey=h;g.extractParticipantForSync=i;g.collectionNameToMetric=j;g.uploadCriticalEventMetric=c}),98);
__d("WAWebHandleForMessageRange",["Promise","WALogger","WASyncAction.pb","WAWebActiveMessageRanges","WAWebAddonGatingUtils","WAWebApiActiveMessageRanges","WAWebHandleForMessageRangeEnums","WAWebMsgRangeContainmentHandlers","WAWebMsgType","WAWebSchemaActiveMessageRanges","WAWebSyncdDb","WAWebSyncdUtils","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleMessageContainment called with unknwon message range action action: ",""]);i=function(){return a};return a}var j=new Set(),k=function(a){return a.reduce(function(a,b){return new Set([].concat(Array.from(a),Array.from(b)))},new Set())};function l(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e;switch(a.action){case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.Archive:a.actionValue.archived?yield d("WAWebMsgRangeContainmentHandlers").handleForArchive(a,c):yield d("WAWebMsgRangeContainmentHandlers").handleForUnarchive(a,c);return j;case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.MarkChatAsRead:yield d("WAWebMsgRangeContainmentHandlers").handleForMarkAsReadUnread(a,c,!!a.actionValue.read);return j;case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatDeleteStarredDeleteMedia:case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatDeleteStarredKeepMedia:e=d("WAWebMsgRangeContainmentHandlers").handleForClearChat(a,c);return e?new Set([e]):j;case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatKeepStarredDeleteMedia:case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatKeepStarredKeepMedia:if(!(yield n(b.id))){e=d("WAWebMsgRangeContainmentHandlers").handleForClearChat(a,c);return e?new Set([e]):j}return j;case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.DeleteChatDeleteMedia:case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.DeleteChatKeepMedia:e=d("WAWebMsgRangeContainmentHandlers").handleForDeleteChat(a,c);return e?new Set([e]):j}d("WALogger").WARN(i(),a.action);return j});return m.apply(this,arguments)}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAWebSyncdUtils").constructStarMsgKeyFromMsgKey(a);a=(yield d("WAWebSyncdDb").getSyncAction(a));if(a){a=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,a.binarySyncData).value;return(a==null?void 0:(a=a.starAction)==null?void 0:a.starred)||!1}return!1});return o.apply(this,arguments)}function p(a,b,c){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){e===void 0&&(e=!0);if(d("WAWebMsgType").SYSTEM_MESSAGE_TYPES.includes(c.type))return j;a=(yield d("WAWebApiActiveMessageRanges").getActiveMessageRanges(a.toString()));a=a.map(function(a){return[a,d("WAWebActiveMessageRanges").rangeContainsMessage(a.actionValue.messageRange,c)]});var f=a.filter(function(a){a=a[1];return a===d("WAWebHandleForMessageRangeEnums").RangeContain.CONTAINS_BY_ADDITIONAL}).map(function(a){a=a[0];return a});f.forEach(function(a){a.remainingMessages--});yield d("WAWebApiActiveMessageRanges").bulkUpdateActiveMessageRanges(f,e);f=a.map(function(a){var b=a[0];a=a[1];return l(b,c,a)});e=(yield (h||(h=b("Promise"))).all(f));return k(e)});return q.apply(this,arguments)}function r(a){if(d("WAWebAddonGatingUtils").isUnifiedInfraEnabledForType(a.type))return!0;return a.type==="reaction"||a.type==="poll_update"?!0:!1}function a(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=new Map();a.forEach(function(a){if(d("WAWebMsgType").SYSTEM_MESSAGE_TYPES.includes(a.type)||r(a))return;var b=c.get(a.id.remote.toString());(b==null||b.t<a.t)&&c.set(a.id.remote.toString(),a)});yield (h||(h=b("Promise"))).all(Array.from(c.entries()).map(function(a){var b=a[0];a=a[1];return p(d("WAWebWidFactory").createWid(b),a)}))});return s.apply(this,arguments)}g.handleForActiveMessageRange=p;g.handleOfflineForMessageRange=a}),98);
__d("WAWebChatDbUpdatesApi",["WAWebBackendApi","WAWebSchemaChat","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebSchemaChat").getChatTable().bulkCreateOrMerge(a);a=a.map(function(a){return{id:d("WAWebWidFactory").createWid(a.id),archive:a.archive}});d("WAWebBackendApi").frontendFireAndForget("chatCollectionUpdate",{updates:a})});return h.apply(this,arguments)}g.setArchive=a}),98);
__d("WAWebMsgRangeContainmentHandlers",["WALogger","WAWebApiActiveMessageRanges","WAWebBackendApi","WAWebChatDbUpdatesApi","WAWebHandleForMessageRangeEnums","WAWebUserPrefsMultiDevice","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleForArchive: Unarchiving chat due to an incoming message"]);h=function(){return a};return a}function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(b===d("WAWebHandleForMessageRangeEnums").RangeContain.DOES_NOT_CONTAIN){b=(yield d("WAWebUserPrefsMultiDevice").getArchiveV2EnabledSetting());var c=(yield d("WAWebUserPrefsMultiDevice").getUnarchiveChatsSetting());(!b||c)&&(d("WALogger").DEV(h()),d("WAWebChatDbUpdatesApi").setArchive([{id:a.chatId,archive:!1}]));yield d("WAWebApiActiveMessageRanges").removeActiveMessageRange(a.chatId,a.action)}});return i.apply(this,arguments)}function c(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){(b===d("WAWebHandleForMessageRangeEnums").RangeContain.DOES_NOT_CONTAIN||a.remainingMessages===0)&&(yield d("WAWebApiActiveMessageRanges").removeActiveMessageRange(a.chatId,a.action))});return j.apply(this,arguments)}function e(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b===d("WAWebHandleForMessageRangeEnums").RangeContain.DOES_NOT_CONTAIN?yield d("WAWebApiActiveMessageRanges").removeActiveMessageRange(a.chatId,a.action):a.remainingMessages===0&&(d("WAWebBackendApi").frontendFireAndForget("updateChatReadStatus",{id:d("WAWebWidFactory").createWid(a.chatId),read:c}),yield d("WAWebApiActiveMessageRanges").removeActiveMessageRange(a.chatId,a.action))});return k.apply(this,arguments)}function f(a,b){switch(b){case d("WAWebHandleForMessageRangeEnums").RangeContain.CONTAINS_BY_TIMESTAMP:case d("WAWebHandleForMessageRangeEnums").RangeContain.CONTAINS_BY_ADDITIONAL:return d("WAWebHandleForMessageRangeEnums").ActiveRangeHandlerAction.DropMessage;case d("WAWebHandleForMessageRangeEnums").RangeContain.DOES_NOT_CONTAIN:return}}function l(a,b){switch(b){case d("WAWebHandleForMessageRangeEnums").RangeContain.CONTAINS_BY_TIMESTAMP:case d("WAWebHandleForMessageRangeEnums").RangeContain.CONTAINS_BY_ADDITIONAL:return d("WAWebHandleForMessageRangeEnums").ActiveRangeHandlerAction.DropMessage;case d("WAWebHandleForMessageRangeEnums").RangeContain.DOES_NOT_CONTAIN:return}}g.handleForArchive=a;g.handleForUnarchive=c;g.handleForMarkAsReadUnread=e;g.handleForClearChat=f;g.handleForDeleteChat=l}),98);
__d("WAWebABPropsSaga",["WAWebABProps","WAWebConnModel","gkx"],(function(a,b,c,d,e,f,g){function h(a){return!c("gkx")("26258")?d("WAWebABProps").getABPropConfigValue(a):!d("WAWebConnModel").Conn.isSMB&&d("WAWebABProps").getABPropConfigValue(a)}function a(){return h("saga_enabled")}function b(){return h("saga_copy")}function e(){return h("saga_v1_enabled")}function f(){return h("saga_v1_reengagement_enabled")}function i(){return h("saga_protobuf_show_sysmsg_web")}function j(){return h("saga_protobuf_ai_stardust_web")}function k(){return h("saga_v1_nux_enabled")}function l(){return d("WAWebABProps").getABPropConfigValue("support_message_feedback_enabled")}function m(){return h("chat_with_support_cta")}g.getIsSagaEnabled=a;g.getIsSagaCopyEnabled=b;g.getIsSagaV1Enabled=e;g.getIsSagaV1ReengagementEnabled=f;g.getIsSagaProtobufSystemMessageEnabled=i;g.getIsSagaProtobufAIStardustEnabled=j;g.getIsSagaV1NuxEnabled=k;g.getSagaFeedbackEnabled=l;g.getChatWithSupportTextEnabled=m}),98);
__d("PaymentLink",["WAWebABProps","WAWebMobilePlatforms"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.url=a}var b=a.prototype;b.isValid=function(){return this.getPSP()!=null};b.shouldDetectInComposer=function(){return d("WAWebMobilePlatforms").isSMB()};b.getPSP=function(){var a=JSON.parse(d("WAWebABProps").getABPropConfigValue("smb_payment_links_url_regex_list"));for(var b in a)if(this.url.match(b))return a[b];return null};b.getPaymentLinkDefaultMetaData=function(){var a=JSON.parse(d("WAWebABProps").getABPropConfigValue("smb_payment_links_url_regex_list"));for(var b in a)if(this.url.match(b))return{psp:a[b],shouldDetectInComposer:this.shouldDetectInComposer()};return null};return a}();g.PaymentLink=a}),98);
__d("WAWebApi",[],(function(a,b,c,d,e,f){a={GROUP_INVITE:"GROUP_INVITE",MSG_SEND:"MSG_SEND",INVALID:"INVALID",CATALOG:"CATALOG",PRODUCT:"PRODUCT",PUSH_NOTIFICATION:"PUSH_NOTIFICATION",CREATE_COMMUNITY:"CREATE_COMMUNITY",NEWSLETTER:"NEWSLETTER",AVATAR_STICKERPACK:"AVATAR_STICKERPACK",ADVERTISE:"ADVERTISE",MANAGE_ADS:"MANAGE_ADS",MESSAGE_YOURSELF:"MESSAGE_YOURSELF",BROADCAST:"BROADCAST",STATUS_POST:"STATUS_POST",EDIT_PROFILE_PICTURE:"EDIT_PROFILE_PICTURE",CALL_USER:"CALL_USER",PAYMENT_LINK:"PAYMENT_LINK",FAVORITES:"FAVORITES",OPEN_CATALOG:"OPEN_CATALOG",STICKER_PACK:"STICKER_PACK"};f.APICmd=a}),66);
__d("WAWebApiParseUtils",["WAWebBuildConstants"],(function(a,b,c,d,e,f,g){b=function(a){return a.replace(/\/+$/,"")};c=b(d("WAWebBuildConstants").BUILD_URL).replace(/[\/\.]/g,"\\$&");e="((?:/\\w+)*)";f="(?:(?:/\\w+)*)";function a(a){a=a.hostname;return a==="whatsapp.com"||a==="www.whatsapp.com"||a==="wa.me"}g.ORIGIN=c;g.OPTIONAL_PATH_PART=e;g.OPTIONAL_NON_CAPTURING_PATH_PART=f;g.isWhatsappHost=a}),98);
__d("WAWebBroadcastApiParse",["$InternalEnum","WAWebABProps","WAWebApiParseUtils"],(function(a,b,c,d,e,f,g){var h="channel",i="channels",j="status",k="updates",l=new RegExp("^"+d("WAWebApiParseUtils").ORIGIN+d("WAWebApiParseUtils").OPTIONAL_PATH_PART+"/accept/?\\?channel_invite_code=(?:&.*)?$","i"),m=b("$InternalEnum").Mirrored(["Newsletter","Status"]);function n(a){return a.length===0||a.length===1&&a[0]===""}function a(a){try{var b=new URL(a),c=b.pathname;c=c.split("/");c[0];var e=c[1];c=c.slice(2);if(d("WAWebApiParseUtils").isWhatsappHost(b)){if(!n(c))return null;switch(e){case i:case h:return{feature:m.Newsletter,url:b.href};case j:return{feature:m.Status,url:b.href};case k:return!d("WAWebABProps").getABPropConfigValue("status_deeplink_enabled")?null:{feature:m.Status,url:b.href}}}c=a.match(l);if(c)return{feature:m.Newsletter,url:a}}catch(a){}return null}g.BroadcastFeatureType=m;g.parseBroadcastFeatureLink=a}),98);
__d("WAWebChatEntryPoint",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["NewsletterIntegrity","NewsletterChatlist","NewsletterDirectory","NewsletterDirectorySearch","NewsLetterRecommendation","NewsletterCreationFlow","NewsletterAdminInviteAcceptModal","NewsletterPostLinkCard","NewsletterLinkCard","NewsletterLinkCardButton","ForwardedNewsletterMessage","NewsletterCTAOnStatus","SimilarNewsletters","Link","Deeplink","Chatlist","Vcard","Notification","Unknown","BotChatListShortcut","PrivateReply","DirectMessage","ContactInfo","Mention"]);f.ChatEntryPoint=a}),66);
__d("WAWebNewsletterApiParse",["$InternalEnum","WAWebApiParseUtils","WAWebChatEntryPoint"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum").Mirrored(["Handle","InviteCode","Id"]),i="channel",j="create",k="directory",l=new RegExp("^"+d("WAWebApiParseUtils").ORIGIN+d("WAWebApiParseUtils").OPTIONAL_PATH_PART+"/accept/?\\?channel_invite_code=(\\w+)(?:&.*)?$","i"),m=new RegExp("^whatsapp://("+i+")/(\\w+)/?(?:\\?.*)?$","i");function n(a){return a.length===0||a.length===1&&a[0]===""}function o(a){try{var b=new URL(a),c=b.pathname;c=c.split("/");c[0];var e=c[1],f=c[2];c=c.slice(3);if(e===i&&d("WAWebApiParseUtils").isWhatsappHost(b)){if(n(c))switch(f){case j:return{type:"create",url:b.href};case k:return{type:"directory",url:b.href};default:if(f!=null&&f!=="")return{identifier:f,url:b.href,identifierType:h.InviteCode,type:"view",chatEntryPoint:d("WAWebChatEntryPoint").ChatEntryPoint.Link}}if(f!==j&&f!==k&&(c.length===1||c.length===2&&c[1]==="")){e=parseInt(c[0],10);return babelHelpers["extends"]({identifier:f,url:b.href,identifierType:h.InviteCode,type:"view",chatEntryPoint:d("WAWebChatEntryPoint").ChatEntryPoint.Link},!Number.isNaN(e)&&{serverId:e})}}c=p(l,a);if(c!=null)return c;f=p(m,a);return f!=null?f:null}catch(a){return null}}function p(a,b){a=b.match(a);if(a){var c=a[2];if(c===j)return{type:"create",url:b};return c===k?{type:"directory",url:b}:{identifier:a[2],url:a[1]||"/",identifierType:h.InviteCode,type:"view",chatEntryPoint:d("WAWebChatEntryPoint").ChatEntryPoint.Deeplink}}return null}function a(a){if(a==null)return!1;return a.startsWith("http://")||a.startsWith("https://")?o(a)!=null:o("https://"+a)!=null}g.NewsletterIdentifierType=h;g.parseNewsletter=o;g.isNewsletterInviteCode=a}),98);
__d("WAWebStatusApiParse",["$InternalEnum","WAWebApiParseUtils","WAWebPonyfillsUrlSearchParams"],(function(a,b,c,d,e,f,g){"use strict";var h="status",i="text",j="photo",k=b("$InternalEnum").Mirrored(["Text","Media"]);function l(a){return a.length===0||a.length===1&&a[0]===""}function a(a){try{a=new URL(a);var b=a.pathname;if(!d("WAWebApiParseUtils").isWhatsappHost(a))return null;b=b.split("/");b[0];var e=b[1];b=b.slice(2);if(!l(b))return null;if(e!==h)return null;b=a.searchParams||new(c("WAWebPonyfillsUrlSearchParams"))(a.search);e=b.get(i);if(e!=null)return{postType:k.Text,url:a.href};e=b.get(j);if(e!=null)return{postType:k.Media,url:a.href}}catch(a){}return null}g.StatusPostType=k;g.parseStatusPostFeatureLink=a}),98);
__d("WAWebApiParse",["PaymentLink","WABinary","WAWebABProps","WAWebApi","WAWebApiParseUtils","WAWebBroadcastApiParse","WAWebFaqUrl","WAWebNewsletterApiParse","WAWebPonyfillsUrlSearchParams","WAWebStatusApiParse"],(function(a,b,c,d,e,f,g){var h=new RegExp("^"+(b=d("WAWebApiParseUtils")).ORIGIN+b.OPTIONAL_PATH_PART+"/accept/?\\?code=(\\w+)(?:&.*)?$","i"),i=/^https?:\/\/chat\.whatsapp\.com\/invite\/(\w+)(?:\?.*)?$/i,j=/^https?:\/\/chat\.whatsapp\.com\/(\w+)(?:\?.*)?$/i,k=/^whatsapp:\/\/chat\/?\?code=(\w+)(?:&.*)?$/i,l=function(a){var b=a.match(h);if(b)return{code:b[2],url:b[1]||"/"};b=a.match(i);if(b)return{code:b[1]};b=a.match(j);if(b)return{code:b[1]};b=a.match(k);if(b)return{code:b[1]}},m="utm_source",n="utm_campaign",o="partnertoken",p=["utm_source","utm_campaign","text","phone","data","source","context","icebreaker","source_url","type",o];function q(a){return p.find(function(b){return b===a})}var r=32;function s(a){if(!a||typeof a!=="string")return;a=d("WABinary").Binary.build(a);if(a.size()>d("WAWebABProps").getABPropConfigValue("ctwa_data_max_length"))return;return a.readBuffer()}function t(a){var b={};new(c("WAWebPonyfillsUrlSearchParams"))(a).forEach(function(a,c){c=q(c.toLowerCase());if(c==null)return;switch(c){case"data":var e=s(a);if(!e)return;b.conversionTuple==null?b.conversionTuple={conversionData:e}:b.conversionTuple.conversionData=e;break;case"source":e=a;var f=d("WABinary").numUtf8Bytes(e);if(f>r)return;b.conversionTuple==null?b.conversionTuple={conversionSource:e}:b.conversionTuple.conversionSource=e;break;case"source_url":b.ctwaContextLinkData!=null?b.ctwaContextLinkData.sourceUrl=a:b.ctwaContextLinkData={sourceUrl:a};break;case"context":b.ctwaContextLinkData!=null?b.ctwaContextLinkData.context=a:b.ctwaContextLinkData={context:a};break;case"icebreaker":b.ctwaContextLinkData!=null?b.ctwaContextLinkData.icebreaker=a:b.ctwaContextLinkData={icebreaker:a};break;case"utm_campaign":b.utm!=null?b.utm.campaign=a:b.utm={campaign:a};break;case"utm_source":b.utm!=null?b.utm.source=a:b.utm={source:a};break;default:c,b[c]=a}});b.phone!=null&&b.phone!==""&&(b.phone=b.phone.replace(/\D/g,"")+"@c.us",b.ctwaContextLinkData&&(b.ctwaContextLinkData.phone=b.phone));if(b.phone!=null&&b.phone!==""||b.text!=null&&b.text!=="")return b}var u=new RegExp("^"+b.ORIGIN+b.OPTIONAL_PATH_PART+"/send/?\\?(.+)$","i"),v=/^https?:\/\/api\.whatsapp\.com\/send\/?\?(.+)$/i,w=/^whatsapp:\/\/send\/?\?(.*)$/i,x=/^https?:\/\/wa\.me\/?(?:([0-9.]{0,20})|([0-9a-z.]{5,35}))?\/?\??(.+)?$/i;e=/^https?:\/\/wa\.me\/p\/([0-9]{0,20})\/([0-9]{0,20})$/i;f=/^whatsapp:\/\/product\/([0-9]{0,20})\/([0-9]{0,20})$/i;var y=new RegExp("^"+b.ORIGIN+b.OPTIONAL_NON_CAPTURING_PATH_PART+"/product/([0-9]{0,20})/([0-9]{0,20})$","i"),z=/^https?:\/\/wa\.me\/p\/([0-9]{0,20})\/([0-9]{0,20})(\/?\?.*)$/i,A=/^whatsapp:\/\/product\/([0-9]{0,20})\/([0-9]{0,20})(\/?\?.*)$/i,B=new RegExp("^"+b.ORIGIN+b.OPTIONAL_NON_CAPTURING_PATH_PART+"/product/([0-9]{0,20})/([0-9]{0,20})(/?.*)$","i"),C=/^https?:\/\/wa\.me\/p\/([^\/]{0,200})\/([0-9]{0,20})$/i,D=/^whatsapp:\/\/product\/([^\/]{0,200})\/([0-9]{0,20})$/i,E=new RegExp("^"+b.ORIGIN+b.OPTIONAL_NON_CAPTURING_PATH_PART+"/product/([^/]{0,200})/([0-9]{0,20})$","i"),F=/^https?:\/\/wa\.me\/p\/([^\/]{0,200})\/([0-9]{0,20})(\/?\?.*)$/i,G=/^whatsapp:\/\/product\/([^\/]{0,200})\/([0-9]{0,20})(\/?\?.*)$/i,H=new RegExp("^"+b.ORIGIN+b.OPTIONAL_NON_CAPTURING_PATH_PART+"/product/([^/]{0,200})/([0-9]{0,20})(/?.*)$","i"),I=/^https?:\/\/wa\.me\/biz-add-product\/?(.+)$/i,J=/^whatsapp-smb:\/\/advertise\/?(.+)$/i,K=/^whatsapp-smb:\/\/manage-ads\/?(?:\?.*)?$/,aa=/^whatsapp:\/\/message_yourself\/?(?:\?.*)?$/i,ba=/^https?:\/\/wa\.me\/message_yourself\/?(?:\?.*)?$/i,ca=new RegExp("^"+b.ORIGIN+b.OPTIONAL_PATH_PART+"/calluser/?\\?(.+)$","i"),da=/^https?:\/\/wa\.me\/call\/?\\?(.+)$/i,L=[e,f,C,D],M=[y,E],N=[B,H],O=[z,A,F,G],ea=[].concat(L,M,N,O);function P(a,b){for(var c=0;c<b.length;c++){var d=a.match(b[c]);if(d)return d}}e=function(a){return P(a,ea)!=null};var fa=new RegExp("^"+b.ORIGIN+b.OPTIONAL_NON_CAPTURING_PATH_PART+"/push/","i"),Q=/^https?:\/\/wa\.me\/c\/([0-9]{0,20})(?:\?.*)?$/i,R=/^whatsapp:\/\/catalog\/([0-9]{0,20})(?:\?.*)?$/i,S=new RegExp("^"+b.ORIGIN+b.OPTIONAL_NON_CAPTURING_PATH_PART+"/catalog/([0-9]{0,20})?$","i"),T=new RegExp("^"+b.ORIGIN+b.OPTIONAL_NON_CAPTURING_PATH_PART+"/catalog/([0-9]{0,20})(/?.*)?$","i");f=function(a){return[Q,R,S,T].some(function(b){return a.match(b)})};var ga=/^https?:\/\/wa\.me\/favorites\/?(?:\\?.*)?$/i,ha=new RegExp("^"+b.ORIGIN+b.OPTIONAL_NON_CAPTURING_PATH_PART+"/favorites/?(?:\\?.*)?$","i");function ia(a){var b=a.match(u);if(b){var c=t(b[2]);if(c){c.url=b[1]||"/";return c}}b=a.match(v);if(b)return t(b[1]);b=a.match(w);if(b)return t(b[1]);b=a.match(x);if(b){var d;b[1]?d={phone:b[1]+"@c.us"}:b[2]&&(d={url:a,customURL:b[2]});if(b[3]){c=t(b[3]);c&&(d=babelHelpers["extends"]({},d,c))}if(d){b=U(a);b!=null&&(d.partnertoken=b)}return d}}function U(a){return new URL(a).searchParams.get(o)}var ja=/^https?:\/\/wa\.me\/community\/create\/?(\?(.*))?$/i;function ka(a){a=a.match(ja);if(a){a=new(c("WAWebPonyfillsUrlSearchParams"))(a[1]).get("entrypoint");return{url:"/",entrypointType:a}}}function V(a,b){a={catalogOwnerJid:a[1]+"@s.whatsapp.net"};b=U(b);b!=null&&(a.partnertoken=b);return a}function W(a){a=new(c("WAWebPonyfillsUrlSearchParams"))(a);var b=a.get(m);a=a.get(n);if(a==null&&b==null)return null;var d={};b!=null&&(d.source=b);a!=null&&(d.campaign=a);return d}function la(a){var b=a.match(Q)||a.match(R);if(b)return V(b,a);b=a.match(S);if(b)return babelHelpers["extends"]({},V(b,a),{url:"/"});b=a.match(T);if(b){var c=W(b[2]);return babelHelpers["extends"]({},V(b,a),c!=null&&{utm:c},{url:"/"})}}function X(a,b){a={productId:a[1],businessOwnerJid:a[2]+"@s.whatsapp.net"};b=U(b);b!=null&&(a.partnertoken=b);return a}function ma(a){var b=P(a,L);if(b)return X(b,a);b=P(a,M);if(b)return babelHelpers["extends"]({},X(b,a),{url:"/"});b=P(a,N);if(b){var c=W(b[3]);return babelHelpers["extends"]({},X(b,a),c!=null&&{utm:c},{url:"/"})}b=P(a,O);if(b){c=W(b[3]);return babelHelpers["extends"]({},X(b,a),c!=null&&{utm:c})}}function na(a){a=a.match(fa);if(a)return{url:"/"}}function Y(a){a=new(c("WAWebPonyfillsUrlSearchParams"))(a);var b=a.get("wa_campaign_id");if(b==null||b==="")return;a=a.get("wa_campaign_type");return a==null||a===""?null:{campaignId:b,campaignType:a}}function oa(a){a=a.match(J);if(a)return Y(a[1])}function pa(a){a=a.match(I);if(a)return Y(a[1])}function qa(a){a=new(d("PaymentLink").PaymentLink)(a);return a.getPaymentLinkDefaultMetaData()}var ra=/^https?:\/\/wa\.me\/stickerpack\/meta-avatar$/i,sa=/^https?:\/\/wa\.me\/edit-profile-picture$/i,Z=/^https?:\/\/wa\.me\/stickerpack\/(?!meta-avatar)/i;function $(a){a=a.match(Z);return a!=null}function ta(a){a=a.match(ra);if(a)return{url:d("WAWebFaqUrl").getAvatarFaqUrl()}}var ua=/^https?:\/\/wa\.me\/ais\/(\d{14,20})\/?(\?.*)?$/i,va=new RegExp("^"+b.ORIGIN+b.OPTIONAL_NON_CAPTURING_PATH_PART+"/ais/(\\d{14,20})/?(\\?.*)?$","i");function wa(a){var b;a=((b=(b=a.match(ua))!=null?b:a.match(va))!=null?b:[])[1];return a?{resultType:"UGC_BOT",data:{fbid:a}}:null}function xa(a){if($(a)){a=new URL(a);a=a.pathname.split("/");a[0];a[1];a=a[2];return a}}function ya(a){var b=a.match(Z);if(b){b=xa(a);return{resultType:"STICKER_PACK",data:{url:b}}}}function a(a){if(typeof a!=="string")return{resultType:d("WAWebApi").APICmd.INVALID};var b=l(a);if(b)return{resultType:d("WAWebApi").APICmd.GROUP_INVITE,data:b};b=la(a);if(b)return{resultType:d("WAWebApi").APICmd.CATALOG,data:b};b=ma(a);if(b)return{resultType:d("WAWebApi").APICmd.PRODUCT,data:b};b=ka(a);if(b)return{resultType:d("WAWebApi").APICmd.CREATE_COMMUNITY,data:b};b=ta(a);if(b)return{resultType:d("WAWebApi").APICmd.AVATAR_STICKERPACK,data:b};b=d("WAWebStatusApiParse").parseStatusPostFeatureLink(a);if(b)return{resultType:d("WAWebApi").APICmd.STATUS_POST,data:b};b=d("WAWebBroadcastApiParse").parseBroadcastFeatureLink(a);if(b)return{resultType:d("WAWebApi").APICmd.BROADCAST,data:b};b=d("WAWebNewsletterApiParse").parseNewsletter(a);if(b)return{resultType:d("WAWebApi").APICmd.NEWSLETTER,data:b};if([aa,ba].some(function(b){return a.match(b)}))return{resultType:d("WAWebApi").APICmd.MESSAGE_YOURSELF};if([ga,ha].some(function(b){return a.match(b)}))return{resultType:d("WAWebApi").APICmd.FAVORITES,data:{url:"/"}};b=pa(a);if(b!=null)return{resultType:d("WAWebApi").APICmd.OPEN_CATALOG,data:b};b=ya(a);if(b){return{resultType:d("WAWebApi").APICmd.STICKER_PACK,data:{url:(b=b.data.url)!=null?b:""}}}b=ia(a);if(b)return{resultType:d("WAWebApi").APICmd.MSG_SEND,data:b};b=na(a);if(b)return{resultType:d("WAWebApi").APICmd.PUSH_NOTIFICATION,data:b};b=oa(a);if(b!=null)return{resultType:d("WAWebApi").APICmd.ADVERTISE,data:b};if(a.match(K))return{resultType:d("WAWebApi").APICmd.MANAGE_ADS,trigger:"chatListBanner"};if(a.match(sa))return{resultType:d("WAWebApi").APICmd.EDIT_PROFILE_PICTURE};if(d("WAWebABProps").getABPropConfigValue("wa_web_calling_deep_link_error")&&[ca,da].some(function(b){return a.match(b)}))return{resultType:d("WAWebApi").APICmd.CALL_USER,data:{url:"/"}};b=qa(a);if(b!=null)return{resultType:d("WAWebApi").APICmd.PAYMENT_LINK,data:b};b=wa(a);return b?b:{resultType:d("WAWebApi").APICmd.INVALID}}g.parseConversionData=s;g.matchProductUrl=e;g.matchCatalogUrl=f;g.isStickerPackURL=$;g.parseAPICmd=a}),98);
__d("WAWebCTWAConstants",[],(function(a,b,c,d,e,f){a="11478";b="11525";c="11522";d="12015";e=new Map([[a,"WHATSAPP_FOR_SMB_WEB_WHATSAPP_SMB_WEB_CHATLIST_BANNER_QP"],[b,"WHATSAPP_FOR_WEB_GROUPSBANNER_QP"],[c,"WHATSAPP_FOR_WEB_PROFILEBANNER_QP"],[d,"WHATSAPP_FOR_SMB_WEB_BUSINESS_HOME_CARD_QP"]]);var g=20*1e3,h=20*1e3,i=20*1e3,j=20*1e3,k=Object.freeze({NEW_ORDER:2,PENDING_PAYMENT:3,PAID:4,ORDER_COMPLETE:5}),l=new Set(Object.keys(k).map(function(a){return k[a]})),m=1,n=7,o=8;f.QP_SURFACE_ID_CHAT_LIST_TOP=a;f.QP_SURFACE_ID_EXITED_GROUP=b;f.QP_SURFACE_ID_PROFILE=c;f.QP_SURFACE_BUSINESS_HOME_TOP_CARD=d;f.KNOWN_QP_SURFACES=e;f.QP_FETCH_TIMEOUT_MS=g;f.QP_ACTION_MUTATION_TIMEOUT_MS=h;f.MANAGE_ADS_FETCH_TIMEOUT_MS=i;f.AD_ENTRY_POINTS_FETCH_TIMEOUT_MS=j;f.ALLOWED_PREDEFINED_LABEL_IDS=k;f.ALLOWED_PREDEFINED_LABEL_IDS_SET=l;f.NEW_CUSTOMER_LABEL_ID=m;f.FOLLOW_UP_LABEL_ID=n;f.LEAD_LABEL_ID=o}),66);
__d("WAWebComplianceConstants",[],(function(a,b,c,d,e,f){a={INDIA:"IN"};b={ENTITY_NAME:1024,ENTITY_TYPE_CUSTOM:1024,EMAIL:256,GRIEVANCE_OFFICER_NAME:256,LANDLINE_NUMBER:20,MOBILE_NUMBER:20,IMPORTER_NAME:1024,STREET1:1024,STREET2:1024,CITY:1024,REGION:1024,POSTAL_CODE:12};f.COMPLIANCE_INFO_CODES=a;f.COMPLIANCE_INFO_LENGTH=b}),66);
__d("WAWebL10NCountryCodes",[],(function(a,b,c,d,e,f){var g={1:{2:{0:{4:{c:"CA"}},2:{6:{c:"CA"}},3:{6:{c:"CA"}},4:{2:{c:"BS"},9:{c:"CA"}},5:{0:{c:"CA"}},6:{4:{c:"AI"},8:{c:"AG"}},8:{4:{c:"VG"},9:{c:"CA"}}},3:{0:{6:{c:"CA"}},4:{0:{c:"VI"},3:{c:"CA"},5:{c:"KY"}},6:{5:{c:"CA"},7:{c:"CA"}}},4:{0:{3:{c:"CA"}},1:{6:{c:"CA"},8:{c:"CA"}},3:{1:{c:"CA"},7:{c:"CA"},8:{c:"CA"}},4:{1:{c:"BM"}},5:{0:{c:"CA"}},7:{3:{c:"GD"}}},5:{0:{6:{c:"CA"}},1:{4:{c:"CA"},9:{c:"CA"}},4:{8:{c:"CA"}},7:{9:{c:"CA"}},8:{1:{c:"CA"},7:{c:"CA"}}},6:{0:{4:{c:"CA"}},1:{3:{c:"CA"}},3:{9:{c:"CA"}},4:{7:{c:"CA"},9:{c:"TC"}},5:{8:{c:"JM"}},6:{4:{c:"MS"}},7:{0:{c:"MP"},1:{c:"GU"},2:{c:"CA"}},8:{4:{c:"AS"}}},7:{0:{5:{c:"CA"},9:{c:"CA"}},2:{1:{c:"MF"}},5:{8:{c:"LC"}},6:{7:{c:"DM"}},7:{8:{c:"CA"}},8:{0:{c:"CA"},2:{c:"CA"},4:{c:"VC"},7:{c:"PR"}}},8:{0:{7:{c:"CA"},9:{c:"DO"}},1:{9:{c:"CA"}},2:{5:{c:"CA"},9:{c:"DO"}},4:{9:{c:"DO"}},6:{7:{c:"CA"},8:{c:"TT"},9:{c:"KN"}},7:{3:{c:"CA"},6:{c:"JM"}}},9:{0:{2:{c:"CA"},5:{c:"CA"}},3:{9:{c:"PR"}}}},2:{0:{c:"EG"},1:{1:{c:"SS"},2:{c:"MA"},3:{c:"DZ"},6:{c:"TN"},8:{c:"LY"}},2:{0:{c:"GM"},1:{c:"SN"},2:{c:"MR"},3:{c:"ML"},4:{c:"GN"},5:{c:"CI"},6:{c:"BF"},7:{c:"NE"},8:{c:"TG"},9:{c:"BJ"}},3:{0:{c:"MU"},1:{c:"LR"},2:{c:"SL"},3:{c:"GH"},4:{c:"NG"},5:{c:"TD"},6:{c:"CF"},7:{c:"CM"},8:{c:"CV"},9:{c:"ST"}},4:{0:{c:"GQ"},1:{c:"GA"},2:{c:"CG"},3:{c:"CD"},4:{c:"AO"},5:{c:"GW"},6:{c:"IO"},7:{c:"AC"},8:{c:"SC"},9:{c:"SD"}},5:{0:{c:"RW"},1:{c:"ET"},2:{c:"SO"},3:{c:"DJ"},4:{c:"KE"},5:{c:"TZ"},6:{c:"UG"},7:{c:"BI"},8:{c:"MZ"}},6:{0:{c:"ZM"},1:{c:"MG"},2:{c:"RE"},3:{c:"ZW"},4:{c:"NA"},5:{c:"MW"},6:{c:"LS"},7:{c:"BW"},8:{c:"SZ"},9:{c:"KM"}},7:{c:"ZA"},9:{0:{c:"SH"},1:{c:"ER"},7:{c:"AW"},8:{c:"FO"},9:{c:"GL"}}},3:{0:{c:"GR"},1:{c:"NL"},2:{c:"BE"},3:{c:"FR"},4:{c:"ES"},5:{0:{c:"GI"},1:{c:"PT"},2:{c:"LU"},3:{c:"IE"},4:{c:"IS"},5:{c:"AL"},6:{c:"MT"},7:{c:"CY"},8:{c:"FI"},9:{c:"BG"}},6:{c:"HU"},7:{0:{c:"LT"},1:{c:"LV"},2:{c:"EE"},3:{c:"MD"},4:{c:"AM"},5:{c:"BY"},6:{c:"AD"},7:{c:"MC"},8:{c:"SM"}},8:{0:{c:"UA"},1:{c:"RS"},2:{c:"ME"},3:{c:"XK"},5:{c:"HR"},6:{c:"SI"},7:{c:"BA"},9:{c:"MK"}},9:{c:"IT"}},4:{0:{c:"RO"},1:{c:"CH"},2:{0:{c:"CZ"},1:{c:"SK"},3:{c:"LI"}},3:{c:"AT"},4:{c:"GB"},5:{c:"DK"},6:{c:"SE"},7:{c:"NO"},8:{c:"PL"},9:{c:"DE"}},5:{0:{0:{c:"FK"},1:{c:"BZ"},2:{c:"GT"},3:{c:"SV"},4:{c:"HN"},5:{c:"NI"},6:{c:"CR"},7:{c:"PA"},8:{c:"PM"},9:{c:"HT"}},1:{c:"PE"},2:{c:"MX"},3:{c:"CU"},4:{c:"AR"},5:{c:"BR"},6:{c:"CL"},7:{c:"CO"},8:{c:"VE"},9:{0:{c:"GP"},1:{c:"BO"},2:{c:"GY"},3:{c:"EC"},4:{c:"GF"},5:{c:"PY"},6:{c:"MQ"},7:{c:"SR"},8:{c:"UY"},9:{c:"CW"}}},6:{0:{c:"MY"},1:{c:"AU"},2:{c:"ID"},3:{c:"PH"},4:{c:"NZ"},5:{c:"SG"},6:{c:"TH"},7:{0:{c:"TL"},2:{c:"NF"},3:{c:"BN"},4:{c:"NR"},5:{c:"PG"},6:{c:"TO"},7:{c:"SB"},8:{c:"VU"},9:{c:"FJ"}},8:{0:{c:"PW"},1:{c:"WF"},2:{c:"CK"},3:{c:"NU"},5:{c:"WS"},6:{c:"KI"},7:{c:"NC"},8:{c:"TV"},9:{c:"PF"}},9:{0:{c:"TK"},1:{c:"FM"},2:{c:"MH"}}},7:{c:"RU"},8:{1:{c:"JP"},2:{c:"KR"},4:{c:"VN"},5:{0:{c:"KP"},2:{c:"HK"},3:{c:"MO"},5:{c:"KH"},6:{c:"LA"}},6:{c:"CN"},8:{0:{c:"BD"},6:{c:"TW"}}},9:{0:{c:"TR"},1:{c:"IN"},2:{c:"PK"},3:{c:"AF"},4:{c:"LK"},5:{c:"MM"},6:{0:{c:"MV"},1:{c:"LB"},2:{c:"JO"},3:{c:"SY"},4:{c:"IQ"},5:{c:"KW"},6:{c:"SA"},7:{c:"YE"},8:{c:"OM"}},7:{0:{c:"PS"},1:{c:"AE"},2:{c:"IL"},3:{c:"BH"},4:{c:"QA"},5:{c:"BT"},6:{c:"MN"},7:{c:"NP"}},8:{c:"IR"},9:{2:{c:"TJ"},3:{c:"TM"},4:{c:"AZ"},5:{c:"GE"},6:{c:"KG"},8:{c:"UZ"}}}};function h(a,b){if(a!=null&&a.length>0&&b!=null){b=b[a[0]];a=a;while(a.length>0&&b){if(b.c)return b.c;a=a.substr(1,a.length-1);b=b[a[0]]}}return""}function a(a){if(a==null||a.length===0)return"";var b=h(a,g);if(b===""&&a[0]==="1")return"US";return b==="RU"&&["6","7"].includes(a[1])?"KZ":b}f.getCountryShortcodeByPhone=a}),66);
__d("WAWebListsGatingUtils",["WAWebABProps","WAWebMobilePlatforms","WAWebPrimaryFeatures"],(function(a,b,c,d,e,f,g){function h(){return d("WAWebPrimaryFeatures").primaryFeatureEnabled("primary_lists_support")&&d("WAWebABProps").getABPropConfigValue("lists_feature_enabled")}function a(){return!d("WAWebMobilePlatforms").isSMB()&&h()}g.isListsEnabled=h;g.shouldListsSettingsItemBeVisible=a}),98);
__d("WAWebBizGatingUtils",["$InternalEnum","WALogger","WAWebABProps","WAWebApiContact","WAWebBusinessProfileTypes","WAWebCTWAConstants","WAWebClientFeatureFlags","WAWebComplianceConstants","WAWebL10NCountryCodes","WAWebListsGatingUtils","WAWebMobilePlatforms","WAWebPrimaryFeatures","WAWebServerPropsModel","WAWebUserPrefsMeUser","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["qpSurfaceIdsUsingGraphQL: unknown surface ID ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["isOrderDetailsQuickPayEnabled failed to parse config json: error ",""]);i=function(){return a};return a}function a(){return d("WAWebMobilePlatforms").isSMB()}function c(){return d("WAWebMobilePlatforms").isSMB()}function j(){return d("WAWebMobilePlatforms").isSMB()}function e(a){return!a.isNewsletter&&j()&&!((a=a.contact.businessProfile)==null?void 0:a.isBizBot3p)}function f(){return d("WAWebABProps").getABPropConfigValue("business_profile_refresh_m1_enabled")}function k(){return d("WAWebABProps").getABPropConfigValue("smb_collections_enabled")}function l(){return d("WAWebABProps").getABPropConfigValue("smb_collections_appeal_flow_enabled")}function m(){return d("WAWebABProps").getABPropConfigValue("nfm_rendering_enabled")}function n(){return!d("WAWebABProps").getABPropConfigValue("interactive_message_native_flow_killswitch")}function o(){return!d("WAWebABProps").getABPropConfigValue("interactive_response_message_killswitch")}function p(){return!d("WAWebABProps").getABPropConfigValue("interactive_response_message_native_flow_killswitch")}function q(a){var b;if(a!=null){var c;b=a.isLid()?(c=d("WAWebApiContact").getPhoneNumber(d("WAWebWidFactory").toUserWid(a)))==null?void 0:c.user:a.user;if(a.isLid()&&b==null)return!0}return u(b)}function r(a){return y(a,function(){return d("WAWebABProps").getABPropConfigValue("smb_ecommerce_compliance_india_m4")},function(){return d("WAWebServerPropsModel").ServerProps.smbEcommerceComplianceIndiaM4})}function s(a){return y(a,function(){return d("WAWebABProps").getABPropConfigValue("smb_ecommerce_compliance_india_m4_5")},function(){return d("WAWebServerPropsModel").ServerProps.smbEcommerceComplianceIndiaM4_5})}function t(a){var b=y(a==null?void 0:a.id,function(){return d("WAWebABProps").getABPropConfigValue("web_abprop_block_catalog_creation_ecommerce_compliance_india")},function(){return d("WAWebServerPropsModel").ServerProps.blockCatalogCreationEcommerceComplianceIndia});return b&&(a==null?void 0:(b=a.profileOptions)==null?void 0:b.commerceExperience)===d("WAWebBusinessProfileTypes").CommerceExperienceTypes.NONE}function u(a){a=d("WAWebL10NCountryCodes").getCountryShortcodeByPhone(a||"");var b=d("WAWebComplianceConstants").COMPLIANCE_INFO_CODES.INDIA;return a===b||d("WAWebClientFeatureFlags").isFeatureEnabled("skip_compliance_phone_check")}function v(a){a=d("WAWebL10NCountryCodes").getCountryShortcodeByPhone(a||"");return a==="BR"}function w(a){var b;if(!a)return!1;b=a.isLid()?(b=d("WAWebApiContact").getPhoneNumber(d("WAWebWidFactory").toUserWid(a)))==null?void 0:b.user:a.user;return b==null?!1:u(b)||v(b)}function x(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("web_business_tools_drawer_enabled")}function y(a,b,c){b===void 0&&(b=function(){return!1});c===void 0&&(function(){return!1});var e;if(a!=null){e=a.isLid()?(c=d("WAWebApiContact").getPhoneNumber(d("WAWebWidFactory").toUserWid(a)))==null?void 0:c.user:a.user;if(a.isLid()&&e==null)return!0}return!u(e)?!1:b()}function z(){return!d("WAWebMobilePlatforms").isSMB()?d("WAWebABProps").getABPropConfigValue("tos_3_client_gating_enabled"):!1}function A(){return d("WAWebABProps").getABPropConfigValue("tos_client_state_fetch_iteration")}function B(){return!d("WAWebMobilePlatforms").isSMB()?d("WAWebABProps").getABPropConfigValue("tos_client_state_fetch_enabled"):!1}function C(){return d("WAWebABProps").getABPropConfigValue("web_shop_storefront_message")}function D(){return d("WAWebABProps").getABPropConfigValue("banned_shops_ux_enabled")}function E(){return d("WAWebMobilePlatforms").isSMB()?d("WAWebABProps").getABPropConfigValue("smb_click_to_chat_logging_enabled"):!1}function F(){return d("WAWebMobilePlatforms").isSMB()?d("WAWebABProps").getABPropConfigValue("smb_biz_profile_logging_enabled"):!1}function G(){return d("WAWebABProps").getABPropConfigValue("web_abprop_business_profile_refresh_linked_accounts_killswitch")}function H(){return d("WAWebABProps").getABPropConfigValue("web_abprop_business_profile_refresh_linked_account_enabled")}function I(){return d("WAWebABProps").getABPropConfigValue("commerce_sanctioned")}function J(){return d("WAWebABProps").getABPropConfigValue("web_abprop_business_profile_refresh_edit_cover_photo_enabled")}function K(){return d("WAWebABProps").getABPropConfigValue("web_abprop_business_profile_refresh_cover_photo_view_enabled")}function L(){return d("WAWebABProps").getABPropConfigValue("message_quick_reply")}function M(){return d("WAWebABProps").getABPropConfigValue("catalog_categories_enabled")}var N=b("$InternalEnum")({DIGITAL_GOODS:"digital-goods",PHYSICAL_GOODS:"physical-goods",ANY:"any",NONE:"none"});function O(a){a===void 0&&(a=N.NONE);try{var b=JSON.parse(d("WAWebABProps").getABPropConfigValue("order_details_quick_pay"));b=b.allowed_product_type;if(b&&b!==N.NONE)return b===N.ANY||b===a}catch(a){d("WALogger").WARN(i(),a)}return!1}function P(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_billing_enabled")}function Q(){return d("WAWebABProps").getABPropConfigValue("web_enable_biz_catalog_view_ps_logging")}function aa(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smart_filters_enabled")||!d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smart_filters_enabled_consumer")}function R(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_multi_device_message_attribution_enabled")}b=function(){return d("WAWebABProps").getABPropConfigValue("order_messages_ephemeral_exception_enabled")};function ba(){return R()&&d("WAWebABProps").getABPropConfigValue("smb_multi_device_agents_logging_V2_enabled")}function ca(){return!d("WAWebMobilePlatforms").isSMB()?!1:d("WAWebABProps").getABPropConfigValue("smb_orange_enabled")}function da(){return!d("WAWebMobilePlatforms").isSMB()?!1:S()||T()}function S(){return!d("WAWebMobilePlatforms").isSMB()?!1:d("WAWebABProps").getABPropConfigValue("premium_blue_enabled")}function T(){return!d("WAWebMobilePlatforms").isSMB()?!1:d("WAWebABProps").getABPropConfigValue("smb_billing_enabled")||d("WAWebABProps").getABPropConfigValue("smb_ctwa_billing_enabled")}function ea(){return d("WAWebABProps").getABPropConfigValue("native_commerce_threads_logging_enabled")}function fa(){return d("WAWebABProps").getABPropConfigValue("smb_biz_profile_custom_url")}function ga(){return d("WAWebABProps").getABPropConfigValue("web_quantity_controls_enabled")}function ha(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebPrimaryFeatures").primaryFeatureEnabled("companion_biz_quick_reply_sync_support")&&d("WAWebABProps").getABPropConfigValue("web_quick_reply_authoring")}function ia(){return d("WAWebABProps").getABPropConfigValue("smb_catalog_collections_reordering_enabled")}function ja(){return d("WAWebABProps").getABPropConfigValue("smb_temp_cover_photo_privacy_messaging")}function U(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_md_agent_chat_assignment_enabled")}function ka(){return U()&&d("WAWebABProps").getABPropConfigValue("smb_md_agent_chat_assignment_system_messages_enabled")}function la(){return!U()?0:d("WAWebABProps").getABPropConfigValue("smb_md_agent_chat_assignment_nux_impressions")}function ma(){return d("WAWebABProps").getABPropConfigValue("smb_hide_unsupported_currency_price")}function na(){return d("WAWebABProps").getABPropConfigValue("graphql_privacy_imp_m1")}function oa(){return d("WAWebABProps").getABPropConfigValue("graphql_privacy_imp_m2")}function pa(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_create_product_catalog")}function qa(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_get_product_catalog")}function ra(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_add_product")}function sa(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_edit_product")}function ta(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_get_product")}function ua(){return d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_report_product")}function va(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_appeal_product")}function wa(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_create_collection")}function xa(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_update_collection")}function ya(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_update_collection_list")}function za(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_delete_collection")}function Aa(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_appeal_collection")}function Ba(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_get_collection")}function Ca(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_get_single_collection")}function Da(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_get_product_list")}function Ea(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_update_product_visibility")}function Fa(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_commerce_settings")}function Ga(){return d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_verify_postcode")}function Ha(){return d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_get_public_key")}function Ia(){return d("WAWebABProps").getABPropConfigValue("smb_orders_graphql_refresh_cart")}function Ja(){return!d("WAWebMobilePlatforms").isSMB()?"{}":d("WAWebABProps").getABPropConfigValue("smb_billing_premium_access_config")}function Ka(){return d("WAWebABProps").getABPropConfigValue("country_client_gating_enabled")}function La(){return d("WAWebABProps").getABPropConfigValue("order_details_custom_item_enabled")}function Ma(){return d("WAWebABProps").getABPropConfigValue("order_details_from_catalog_enabled")}function Na(){return d("WAWebABProps").getABPropConfigValue("order_details_from_cart_enabled")}function Oa(){return d("WAWebABProps").getABPropConfigValue("order_details_total_order_minimum_value")}function Pa(a){return Lb(a)?5e3:d("WAWebABProps").getABPropConfigValue("order_details_total_maximum_value")}function Qa(){return d("WAWebABProps").getABPropConfigValue("order_management_enabled")}function Ra(){return d("WAWebABProps").getABPropConfigValue("btm_threads_logging_enabled")}function Sa(a){return a?d("WAWebABProps").getABPropConfigValue("smb_md_agent_chat_assignment_chats_reorder_on_chat_unassignment_enabled"):d("WAWebABProps").getABPropConfigValue("smb_md_agent_chat_assignment_chats_reorder_on_chat_assignment_enabled")}function Ta(){return d("WAWebABProps").getABPropConfigValue("utm_tracking_expiration_hours")}function Ua(){return d("WAWebABProps").getABPropConfigValue("utm_tracking_enabled")}function Va(){return!d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("wa_ctwa_web_thread_ad_attribution_enabled")||d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("wa_web_parse_always_show_ad_attribution")}function Wa(){return d("WAWebABProps").getABPropConfigValue("wa_ctwa_web_hide_ad_context_if_soft_dismissed_in_primary")}function Xa(){return d("WAWebABProps").getABPropConfigValue("ctwa_consumer_data_sharing_consent")}function Ya(){return d("WAWebABProps").getABPropConfigValue("ctwa_mm_biz_ai_disclosure_update_enabled")&&!d("WAWebABProps").getABPropConfigValue("ctwa_mm_biz_ai_tos_filtering_enabled")}function Za(){return d("WAWebABProps").getABPropConfigValue("ctwa_mm_biz_ai_disclosure_update_enabled")&&d("WAWebABProps").getABPropConfigValue("ctwa_mm_biz_ai_tos_filtering_enabled")}function $a(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_smb_data_sharing_consent")}function ab(){return d("WAWebABProps").getABPropConfigValue("ctwa_smb_data_sharing_opt_in_cool_off_period")}function bb(){return d("WAWebABProps").getABPropConfigValue("smb_md_agent_chat_assignment_notifications_enabled")}function cb(){return d("WAWebABProps").getABPropConfigValue("smb_md_agent_chat_assignment_chat_list_new_label_enabled")}function V(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("wa_ctwa_ads_action_banner_enabled_web")}function db(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("wa_ctwa_action_banner_logging_enabled_web")}function eb(){return V()&&d("WAWebABProps").getABPropConfigValue("in_app_comms_manage_ads_web_banner_campaign_enabled")}function fb(){return d("WAWebMobilePlatforms").isSMB()||d("WAWebABProps").getABPropConfigValue("quick_promotion_banner_client_consumer_enabled")}function gb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("qp_campaign_client_enabled")}function hb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_graphql_to_fetch_qp_enabled")}function ib(){return d("WAWebABProps").getABPropConfigValue("smb_graphql_to_fetch_qp_frequency_mins")}function jb(){var a=d("WAWebABProps").getABPropConfigValue("smb_graphql_to_fetch_qp_surface_ids"),b=new Map(Array.from(d("WAWebCTWAConstants").KNOWN_QP_SURFACES.values(),function(a){return[a,a]})),c=new Set();a.split(",").forEach(function(a){var e=b.get(a);e!=null?c.add(e):d("WALogger").ERROR(h(),a)});return c}var kb=function(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("wa_ctwa_web_entrypoint_home_header_enabled")},lb=function(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("wa_ctwa_web_entrypoint_home_header_dropdown_enabled")},mb=function(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_ad_creation_entry_point_catalog_web")},nb=function(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_ad_creation_entry_point_catalog_product_web")};function W(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("kill_switch_ctwa_ml_entry_point_config")===!1}function ob(){return d("WAWebABProps").getABPropConfigValue("ctwa_entry_point_config_fetch_threshhold")}function pb(){return W()&&d("WAWebABProps").getABPropConfigValue("ctwa_long_term_holdout_content_enabled")}function qb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_long_term_holdout_client_side_check")}var rb=function(a){return d("WAWebMobilePlatforms").isSMB()&&(a==null?void 0:a.hasCreatedAd)===!0&&d("WAWebABProps").getABPropConfigValue("wa_ctwa_web_entrypoint_manage_ads_home_header_dropdown_enabled")},sb=function(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("wa_ctwa_web_fetch_linked_accounts_enabled")};function X(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_manage_ads_tab_web")}function tb(){return X()&&d("WAWebABProps").getABPropConfigValue("ctwa_manage_ads_tab_web_ad_actions_menu")}function ub(){return X()&&d("WAWebABProps").getABPropConfigValue("ctwa_manage_ads_tab_web_ad_metrics")}function Y(){return X()&&d("WAWebABProps").getABPropConfigValue("ctwa_manage_ads_tab_web_recovery_flow")}function vb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_ad_account_token_storage_kill_switch_web")===!1}function wb(){return d("WAWebABProps").getABPropConfigValue("ctwa_ad_account_nonce_push_wait_timeout_web")}function xb(){return d("WAWebABProps").getABPropConfigValue("ctwa_ad_account_nonce_retries_max_web")}function yb(){return Y()&&d("WAWebABProps").getABPropConfigValue("smb_graphql_token_recovery_during_account_recovery_enabled")}function zb(){return d("WAWebABProps").getABPropConfigValue("smb_premium_messages_spam_report_enabled")}function Ab(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("business_tool_enhanced_logging")}function Bb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_labels_ctwa_data_sharing")}function Cb(){return d("WAWebMobilePlatforms").isSMB()&&Z()}function Z(){return d("WAWebABProps").getABPropConfigValue("payments_br_content_optimization_variant")!==0}function Db(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_smb_data_sharing_settings_killswitch")===!1}function Eb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_message_labels_ctwa_data_sharing")}function Fb(){return d("WAWebABProps").getABPropConfigValue("payments_link_to_lite_consumer_enabled")}function Gb(){return d("WAWebABProps").getABPropConfigValue("smb_premium_messages_click_logging_enabled")}function $(){return d("WAWebABProps").getABPropConfigValue("row_buyer_order_revamp_m0_enabled")}function Hb(){return d("WAWebABProps").getABPropConfigValue("seller_orders_management_revamp")}function Ib(){return $()&&d("WAWebABProps").getABPropConfigValue("buyer_initiated_order_request_variant_enabled")}function Jb(){return d("WAWebABProps").getABPropConfigValue("order_statuses_revamp_m1_enabled")}function Kb(){return d("WAWebABProps").getABPropConfigValue("smb_premium_messages_url_cta_alert_dialog_enabled")}function Lb(a){var b=d("WAWebUserPrefsMeUser").getMeUser();b=d("WAWebL10NCountryCodes").getCountryShortcodeByPhone(b.user);a=d("WAWebL10NCountryCodes").getCountryShortcodeByPhone(a.contact.id.user);return b==="BR"&&a==="BR"}function Mb(){return d("WAWebABProps").getABPropConfigValue("carousel_message_client_enabled")}function Nb(){return(d("WAWebMobilePlatforms").isSMB()||d("WAWebListsGatingUtils").isListsEnabled())&&d("WAWebPrimaryFeatures").primaryFeatureEnabled("companion_biz_label_sync_support")&&d("WAWebABProps").getABPropConfigValue("web_labels_editing_enabled")}function Ob(){return(d("WAWebMobilePlatforms").isSMB()||d("WAWebListsGatingUtils").isListsEnabled())&&d("WAWebABProps").getABPropConfigValue("smb_label_improvements_reordering")}function Pb(){return(d("WAWebMobilePlatforms").isSMB()||d("WAWebListsGatingUtils").isListsEnabled())&&d("WAWebABProps").getABPropConfigValue("smb_label_improvements_reordering")&&d("WAWebABProps").getABPropConfigValue("web_smb_label_reordering_m2_two_way")}function Qb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_new_customer_label_signals")}function Rb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_lead_labels_send_signals")}function Sb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smba_premium_messages_leaving_wa_content")}function Tb(){return d("WAWebABProps").getABPropConfigValue("smba_premium_messages_insights_v2_trackable_link_domain")}function Ub(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_notes_v1_enabled")}function Vb(){return d("WAWebABProps").getABPropConfigValue("smb_notes_privacy_string")}function Wb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("wa_web_business_tools_top_card_enabled")}function Xb(){return d("WAWebABProps").getABPropConfigValue("smb_meta_verified_context_card")}function Yb(){return d("WAWebPrimaryFeatures").primaryFeatureEnabled("profile_edit_for_mv_users_enabled")}function Zb(){return d("WAWebABProps").getABPropConfigValue("web_catalog_video_view_fallback_enabled")}function $b(){return d("WAWebABProps").getABPropConfigValue("web_catalog_video_view_enabled")}function ac(){return d("WAWebABProps").getABPropConfigValue("smb_get_subscriptions_graphql_migration_enabled")}function bc(){return d("WAWebABProps").getABPropConfigValue("smb_custom_url_get_user_graphql_migration_enabled")}function cc(){return d("WAWebABProps").getABPropConfigValue("web_biz_ai_chat_assignment_hiding_enabled")}function dc(){return d("WAWebABProps").getABPropConfigValue("lid_migration_for_vname_enabled")}function ec(){return d("WAWebABProps").getABPropConfigValue("use_signed_shimmed_url_link")}function fc(){return d("WAWebABProps").getABPropConfigValue("lid_migration_for_biz_profile_enabled")}function gc(){return d("WAWebABProps").getABPropConfigValue("catalog_product_sale_price_enabled")}g.canDisplayLabel=a;g.canEditLabelAssociation=c;g.canSendQuickReply=j;g.canSendQuickReplyInChat=e;g.canSeeBizProfileV3=f;g.canManageCollections=k;g.canAppealCollections=l;g.nativeFlowMessagesEnabled=m;g.interactiveNativeFlowMessagesEnabled=n;g.interactiveResponseMessagesEnabled=o;g.interactiveNativeFlowResponseMessagesEnabled=p;g.canSeeECommerceComplianceIndiaSoftEnforcement=q;g.canSeeECommerceComplianceIndiaHardEnforcementBusinessJourney=r;g.canSeeECommerceComplianceIndiaCountryOriginExemptBusinessJourney=s;g.blockCatalogCreationECommerceComplianceIndia=t;g.isWidInPaymentsCountry=w;g.isBizToolsDrawerEnabled=x;g.tos3GatingEnabled=z;g.tosFetchIteration=A;g.tosFetchEnabled=B;g.shopsInteractiveMessageEnabled=C;g.bannedShopsEnabled=D;g.smbClickToChatLoggingEnabled=E;g.smbBizProfileLoggingEnabled=F;g.bizLinkedAccountsEnabled=G;g.canViewBizLinkedAccounts=H;g.commerceFeaturesDisabledBySanctions=I;g.isBizCoverPhotoEditEnabled=J;g.isBizCoverPhotoViewEnabled=K;g.messageQuickReplyEnabled=L;g.catalogCategoriesEnabled=M;g.QuickPayProductTypeGating=N;g.isOrderDetailsQuickPayEnabled=O;g.billingEnabled=P;g.isPSForCatalogViewEnabled=Q;g.smartFiltersEnabled=aa;g.isMultiDeviceMessageAttributionEnabled=R;g.inOrderMessagesEphemeralExceptionEnabled=b;g.isMultiDeviceAgentsLoggingEnabled=ba;g.isSmbOrangeEnabled=ca;g.subscriptionFetchEnabled=da;g.isMetaVerifiedEnabled=S;g.isPremiumBillingEnabled=T;g.commerceThreadsLoggingEnabled=ea;g.isCustomURLViaBizProfileEnabled=fa;g.isQuantityControlsFeatureEnabled=ga;g.quickRepliesManagementEnabled=ha;g.isCollectionReorderingEnabled=ia;g.coverPhotoPrivacyMessagingEnabled=ja;g.chatAssignmentEnabled=U;g.chatAssignmentSystemMessagesEnabled=ka;g.chatAssignmentMaxNuxImpressions=la;g.hideUnsupportedCurrency=ma;g.graphQLForCatalogM1Enabled=na;g.graphQLForCollectionM2Enabled=oa;g.graphQLForCreateProductCatalogEnabled=pa;g.graphQLForGetProductCatalogEnabled=qa;g.graphQLForAddProductEnabled=ra;g.graphQLForEditProductEnabled=sa;g.graphQLForGetProductEnabled=ta;g.graphQLForReportProductEnabled=ua;g.graphQLForAppealProductEnabled=va;g.graphQLForCreateCollectionEnabled=wa;g.graphQLForUpdateCollectionEnabled=xa;g.graphQLForUpdateCollectionListEnabled=ya;g.graphQLForDeleteCollectionEnabled=za;g.graphQLForAppealCollectionEnabled=Aa;g.graphQLForGetCollectionsEnabled=Ba;g.graphQLForGetSingleCollectionEnabled=Ca;g.graphQLForGetProductListEnabled=Da;g.graphQLForUpdateProductVisibilityEnabled=Ea;g.graphQLForCommerceSettingsEnabled=Fa;g.isGraphQLForVerifyPostcodeEnabled=Ga;g.isGraphQLForGetPublicKeyEnabled=Ha;g.graphQLForRefreshCartEnabled=Ia;g.getBillingPremiumAccessConfig=Ja;g.countryGatingEnabled=Ka;g.orderDetailsCustomItemEnabled=La;g.orderDetailsFromCatalogEnabled=Ma;g.orderDetailsFromCartEnabled=Na;g.orderDetailsTotalOrderMinimumValue=Oa;g.orderDetailsTotalMaxValue=Pa;g.orderManagementEnabled=Qa;g.btmThreadsLoggingEnabled=Ra;g.shouldReorderChatOnAssignment=Sa;g.utmTrackingExpirationInHours=Ta;g.isUtmTrackingEnabled=Ua;g.isAdsAttributionEnabled=Va;g.isHideAdContextIfSoftDismissed=Wa;g.isConsumerTransparencyEnabled=Xa;g.isUpdatedConsumerDisclosureUiRowEnabled=Ya;g.isUpdatedConsumerDisclosureUiIndiaEnabled=Za;g.smbDataSharingConsentEnabled=$a;g.smbDataSharingOptInCoolOffSeconds=ab;g.chatAssignmentNotificationsEnabled=bb;g.chatAssignmentNewChatlistLabelEnabled=cb;g.adsActionBannersEnabled=V;g.adsActionBannersLoggingEnabled=db;g.adsActionBannersEnabledOnStartup=d("WAWebMobilePlatforms").isSMB;g.adsActionManageAdsBannerEnabled=eb;g.qpSDKProcessingEnabled=fb;g.qpCampaignsEnabled=gb;g.qpGraphQLEnabled=hb;g.qpGraphQLFetchIntervalMinutes=ib;g.qpSurfaceIdsUsingGraphQL=jb;g.shouldShowAdCreationIcon=kb;g.shouldShowAdCreationDropdown=lb;g.adCreationEntryPointCatalogEnabled=mb;g.adCreationEntryPointCatalogProductEnabled=nb;g.adEntryPointsConfigurationFetchEnabled=W;g.adEntryPointsConfigurationFetchThreshold=ob;g.adEntryPointsConfigurationFetchM1Enabled=pb;g.isInLongTermHoldoutFallbackWhenAdEntryPointsConfigurationMissing=qb;g.shouldShowManageAdsDropdown=rb;g.shouldFetchLinkedAccounts=sb;g.adManagementEnabled=X;g.adManagementActionsDisplayingEnabled=tb;g.adManagementMetricsDisplayingEnabled=ub;g.adManagementRecoveryFlowEnabled=Y;g.adAccountTokenStoringEnabled=vb;g.adAccountTokenNoncePushWaitTimeoutSeconds=wb;g.adAccountTokenNonceMaxRetries=xb;g.grapQLRecoveryDuringAdAccountRecoveryEnabled=yb;g.isSMBMMSpamReportEnabled=zb;g.isSMBEnhancedLoggingEnabled=Ab;g.isSMBLabelsDataSharingEnabledForChats=Bb;g.isSMBDataSharingOrderCopyOptimizationEnabled=Cb;g.isOrderContentOptimizationEnabled=Z;g.shouldShowSMBDataSharingSettings=Db;g.isSMBLabelsDataSharingEnabledForMessages=Eb;g.isMessageWithLinkNfmEnabled=Fb;g.isPremiumMessagesClickLoggingEnabled=Gb;g.isBuyerOrderRevampEnabled=$;g.isSellerOrderRevampEnabled=Hb;g.isBuyerOrderRequestVariantEnabled=Ib;g.isOrderStatusM1Enabled=Jb;g.isPremiumMessagesUrlCtaDialogEnabled=Kb;g.carouselsEnabled=Mb;g.labelsEditingEnabled=Nb;g.isLabelReorderingSyncFromPrimaryEnabled=Ob;g.isLabelReorderingInWebEnabled=Pb;g.is3pdSignalNewCustomerEnabled=Qb;g.is3pdLeadOptimisationLabelSignalsEnabled=Rb;g.isPremiumMessagesNewLeavingWAContentEnabled=Sb;g.getTrackableLinkDomain=Tb;g.smbNotesV1Enabled=Ub;g.smbNotesPrivacyStringABProp=Vb;g.isBizToolsTopCardEnabled=Wb;g.isMetaVerifiedContextCardEnabled=Xb;g.isMetaVerifiedLockedProfileEditingV1Enabled=Yb;g.isCatalogVideoViewFallbackEnabled=Zb;g.isCatalogVideoViewEnabled=$b;g.isGetSubscriptionsGraphqlMigrationEnabled=ac;g.isGetCustomUrlUserGraphqlMigrationEnabled=bc;g.isBizAiChatAssignmentHidingEnabled=cc;g.isLidMigrationForVnameEnabled=dc;g.isUsingSignedShimmedLinkInCatalogueEnabled=ec;g.isLidMigrationForBusinessProfileEnabled=fc;g.isCatalogProductSalePriceEnabled=gc}),98);
__d("WAWebBizTemplateAndInteractiveMessagesUtils",["WAWebABProps","WAWebBizGatingUtils","WAWebInteractiveMessagesNativeFlowName","WAWebMsgGetters"],(function(a,b,c,d,e,f,g){var h=3,i=[(e=c("WAWebInteractiveMessagesNativeFlowName")).QUICK_REPLY,e.CTA_CALL,e.CTA_URL,e.CTA_CATALOG,e.CTA_COPY_CODE];function j(a){switch(a){case"review_and_pay":return c("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS;case"payment_info":return c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO;case"review_order":return c("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS;case"payment_status":return c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_STATUS;case"payment_method":return c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_METHOD;case"open_webview":return c("WAWebInteractiveMessagesNativeFlowName").MESSAGE_WITH_LINK;case"message_with_link_status":return c("WAWebInteractiveMessagesNativeFlowName").MESSAGE_WITH_LINK_STATUS;case"cta_url":return c("WAWebInteractiveMessagesNativeFlowName").CTA_URL;case"cta_call":return c("WAWebInteractiveMessagesNativeFlowName").CTA_CALL;case"quick_reply":return c("WAWebInteractiveMessagesNativeFlowName").QUICK_REPLY;case"cta_catalog":return c("WAWebInteractiveMessagesNativeFlowName").CTA_CATALOG;case"cta_copy":return c("WAWebInteractiveMessagesNativeFlowName").CTA_COPY_CODE}}function a(a,b,e){if(d("WAWebMsgGetters").isBizSourceFromMarketingMessage(e))return d("WAWebABProps").getABPropConfigValue("web_premium_messages_interactivity_rendering_enabled");else if(e==="quoted_carousel_card"&&a===c("WAWebInteractiveMessagesNativeFlowName").QUICK_REPLY)return d("WAWebBizGatingUtils").carouselsEnabled();else if(l(a))return!0;return b===!0?d("WAWebABProps").getABPropConfigValue("web_premium_messages_interactivity_rendering_enabled"):!1}var k=function(a){if(a.hydratedTemplateButton!=null)return a.hydratedTemplateButton.quickReplyButton!=null;else if(a.nativeFlowButton!=null)return a.nativeFlowButton.name===String(c("WAWebInteractiveMessagesNativeFlowName").QUICK_REPLY);return!1};function b(a){if(a.length>h)return!0;if(a.length>0){var b=k(a[0]);if(!a.slice(1).every(function(a){var c=k(a);a=a.nativeFlowButton!=null?i.includes(j((a=a.nativeFlowButton)==null?void 0:a.name)):!0;return a&&b===c}))return!0}return!1}function l(a){return i.includes(a)}g.supportedNativeFlowButtonNamesForInteractiveMsg=i;g.getNativeFlowNameByButtonName=j;g.isInteractiveCtaMessageEnabled=a;g.buttonsViolateButtonImprovementsConstraints=b}),98);
__d("WAWebMessagingGatingUtils",["WAWebABProps","WAWebDBReportingTokenUtils"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("web_send_invisible_msg_to_new_groups")}function b(){return d("WAWebABProps").getABPropConfigValue("web_send_invisible_msg_min_group_size")}function c(){return d("WAWebABProps").getABPropConfigValue("web_send_invisible_msg_max_group_size")}function e(){var a;return(a=d("WAWebABProps").getABPropConfigValue("group_size_bypassing_sampling"))!=null?a:1e5}function f(){return d("WAWebABProps").getABPropConfigValue("retry_receipt_error_code_enabled")}function h(){return d("WAWebABProps").getABPropConfigValue("web_device_sync_manager_group_enabled")}function i(){return n()>0}function j(){return d("WAWebABProps").getABPropConfigValue("rt_receive_reporting_tag")}function k(){return d("WAWebABProps").getABPropConfigValue("rt_sync_reporting_tag")}function l(){var a;return(a=d("WAWebABProps").getABPropConfigValue("rt_clean_reporting_tag"))!=null?a:d("WAWebDBReportingTokenUtils").DEFAULT_RT_CLEANUP_OLDER_THAN_DAYS}function m(){return d("WAWebABProps").getABPropConfigValue("rt_clean_reporting_token")}function n(){return d("WAWebABProps").getABPropConfigValue("rt_sender_reporting_token_version")}function o(){return d("WAWebABProps").getABPropConfigValue("rt_validate_reporting_token")}function p(){return d("WAWebABProps").getABPropConfigValue("rt_store_reporting_data")}function q(){return d("WAWebABProps").getABPropConfigValue("rt_send_reporting_data")}function r(){return d("WAWebABProps").getABPropConfigValue("rt_report_token_from_inclusion_list")}function s(){return d("WAWebABProps").getABPropConfigValue("web_inactive_receipts_v2")}function t(){return d("WAWebABProps").getABPropConfigValue("visible_message_drop_placeholder_enabled_internal_only")}function u(){return d("WAWebABProps").getABPropConfigValue("web_payment_notifications_ack_kick_fix_enabled")}function v(){return d("WAWebABProps").getABPropConfigValue("web_flush_message_cache_before_sending_preacks_enabled")}g.sendKeyDistributionMsgToNewGroups=a;g.sendKeyDistributionMsgMinGroupSize=b;g.sendKeyDistributionMsgMaxGroupSize=c;g.getGroupSizeBypassingSampling=e;g.isRetryReceiptErrorCodeEnabled=f;g.isDeviceSyncManagerGroupEnabled=h;g.isReportingTokenSendingEnabled=i;g.isReportingTokenReceivingEnabled=j;g.isReportingTagSyncingEnabled=k;g.getReportingTagCleanupDays=l;g.getReportingTokenCleanupDays=m;g.getSenderReportingTokenVersion=n;g.isReportingTokenValidationActionEnabled=o;g.isReportingDataStoringEnabled=p;g.isSendReportingDataEnabled=q;g.isReportingTokenFromInclusionListEnabled=r;g.isInactiveReceiptsV2Enabled=s;g.isMessageDropPlaceholderEnabled=t;g.isPaymentNotificationAckKickFixEnabled=u;g.isFlushMessageCacheBeforeSendingPreacksEnabled=v}),98);
__d("WAWebMiscGatingUtils",["WAWebABProps","WAWebGroupType","WAWebMobilePlatforms","WAWebModernizr","WAWebPrimaryFeatures","WAWebServerPropsModel","WAWebUA"],(function(a,b,c,d,e,f,g){function a(){return!d("WAWebABProps").getABPropConfigValue("disable_auto_download")}function b(a){if(a>=d("WAWebABProps").getABPropConfigValue("pnh_cag_disable_reactions_group_size"))return!1;return d("WAWebMobilePlatforms").isSMB()?d("WAWebABProps").getABPropConfigValue("parent_group_view_enabled_for_smb_on_web"):!0}function c(){return d("WAWebServerPropsModel").ServerProps.webPaymentBackgroundEnabled?!0:!1}function e(){return d("WAWebABProps").getABPropConfigValue("web_2fa")}function f(a){a===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP?a=d("WAWebABProps").getABPropConfigValue("community_announcement_group_size_limit"):a=d("WAWebABProps").getABPropConfigValue("group_size_limit")-1;(a==null||a<=0||Number.isNaN(a))&&(a=d("WAWebServerPropsModel").ServerProps.maxParticipants);return a}function h(){return d("WAWebABProps").getABPropConfigValue("recent_sticker_rollout_phase")>=3&&d("WAWebPrimaryFeatures").primaryFeatureEnabled("recent_sticker")}function i(){return d("WAWebPrimaryFeatures").primaryFeatureEnabled("favorite_sticker")}function j(){return d("WAWebABProps").getABPropConfigValue("recent_sticker_rollout_phase")>=4||d("WAWebABProps").getABPropConfigValue("favorite_sticker_rmr_sync_enabled")}function k(){var a=d("WAWebModernizr").getModernizr();return d("WAWebUA").UA.isGecko&&!(a==null?void 0:a.exiforientation)?!1:!0}function l(){return d("WAWebABProps").getABPropConfigValue("web_group_profile_editor")}function m(){return d("WAWebABProps").getABPropConfigValue("message_level_reporting")}function n(){return d("WAWebABProps").getABPropConfigValue("web_multi_skin_toned_emoji_picker")}function o(){return d("WAWebABProps").getABPropConfigValue("web_message_list_a11y_redesign")}function p(){return d("WAWebABProps").getABPropConfigValue("web_abprop_media_links_docs_search")}function q(){return d("WAWebABProps").getABPropConfigValue("graphql_locale_remapping")}function r(){return d("WAWebABProps").getABPropConfigValue("web_message_custom_aria_label")}function s(){return d("WAWebABProps").getABPropConfigValue("four_reactions_in_bubble_enabled")}function t(){return d("WAWebABProps").getABPropConfigValue("pnh_cag_show_masked_members")}function u(){return d("WAWebABProps").getABPropConfigValue("web_message_plugin_frontend_registration_enabled")}function v(){return!d("WAWebMobilePlatforms").isSMB()}function w(){return d("WAWebPrimaryFeatures").primaryFeatureEnabled("ddm_settings")&&d("WAWebABProps").getABPropConfigValue("web_privacy_settings_v2")}function x(){var a;return(a=d("WAWebABProps").getABPropConfigValue("drop_last_name"))!=null?a:!1}function y(){var a;return(a=d("WAWebABProps").getABPropConfigValue("admin_hfm_toggle"))!=null?a:!1}function z(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_rambutan_enabled")}function A(){return d("WAWebABProps").getABPropConfigValue("group_suspend_v2_enabled")}function B(){return d("WAWebABProps").getABPropConfigValue("query_verified_name_when_msg_differs")}function C(){return d("WAWebABProps").getABPropConfigValue("blue_enabled")}function D(){return d("WAWebABProps").getABPropConfigValue("blue_education_enabled")}function E(){return!d("WAWebMobilePlatforms").isSMB()?!1:d("WAWebABProps").getABPropConfigValue("blue_profile_locked_ui_enabled")}function F(){return d("WAWebABProps").getABPropConfigValue("blue_strings_enabled")}function G(){return d("WAWebABProps").getABPropConfigValue("blue_client_p0_logging_enabled")}g.webMediaAutoDownloadEnabled=a;g.cagReactionsSend=b;g.paymentBackgroundEnabled=c;g.web2FAEnabled=e;g.getGroupSizeLimit=f;g.isRecentStickersMDEnabled=h;g.isFavoriteStickersEnabled=i;g.isStickerRmrSyncEnabled=j;g.isHighQualityVideoThumbnailsEnabled=k;g.groupProfileEditorEnabled=l;g.messageLevelReportingEnabled=m;g.multiSkinToneEmojiPickerEnabled=n;g.messageListA11yRedesignEnabled=o;g.mediaLinksDocsFilteringEnabled=p;g.getGraphqlLocaleRemapping=q;g.messageCustomAriaLabelEnabled=r;g.fourReactionsInBubbleEnabled=s;g.pnhCagShowMaskedMembersEnabled=t;g.messagePluginFrontendRegistrationEnabled=u;g.isPrivacyNarrativeV1Enabled=v;g.isDefaultDisappearingMessagesEnabled=w;g.isDropLastNameEnabled=x;g.isAdminHfmToggleEnabled=y;g.isRambutanEnabled=z;g.isGroupSuspendV2Enabled=A;g.queryVerifiedNameWhenMsgDiffers=B;g.isBlueEnabled=C;g.isBlueEducationEnabled=D;g.isBlueLockingEnabled=E;g.isBlueStringsEnabled=F;g.isBlueP0LoggingEnabled=G}),98);
__d("WAWebSyncGatingUtils",["WALogger","WAWebABProps","WAWebMobilePlatforms","WAWebPrimaryFeaturesModel","WAWebUserPrefsHistorySync"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[rdu] History sync on demand feature is disabled as initial sync is incomplete or initial sync boundary is not available"]);h=function(){return a};return a}function a(){if(!d("WAWebPrimaryFeaturesModel").PrimaryFeatures.historySyncOnDemand)return!1;var a=d("WAWebUserPrefsHistorySync").getInitialHistorySyncCompleteLocalStorage(),b=d("WAWebUserPrefsHistorySync").getHistoryInitialSyncBoundary();if(a&&(b==null||Object.keys(b).length===0)){d("WALogger").LOG(h());return!1}a=d("WAWebMobilePlatforms").getMobilePlatform()===d("WAWebMobilePlatforms").PLATFORMS.ANDROID||d("WAWebMobilePlatforms").getMobilePlatform()===d("WAWebMobilePlatforms").PLATFORMS.SMBA;return a&&d("WAWebPrimaryFeaturesModel").PrimaryFeatures.isPrimaryBetaBuild&&d("WAWebABProps").getABPropConfigValue("history_sync_on_demand_with_android_beta")?!0:d("WAWebABProps").getABPropConfigValue("history_sync_on_demand")}function b(){return d("WAWebPrimaryFeaturesModel").PrimaryFeatures.historySyncOnDemand}function c(){return d("WAWebABProps").getABPropConfigValue("placeholder_message_resend")}function e(){return d("WAWebPrimaryFeaturesModel").PrimaryFeatures.webLinkPreviewNseSupport}function f(){return d("WAWebPrimaryFeaturesModel").PrimaryFeatures.messagePlaceholderResendNseSupport}function i(){return d("WAWebABProps").getABPropConfigValue("web_noncritical_history_sync_message_processing_break_iteration")}function j(){return d("WAWebABProps").getABPropConfigValue("web_recent_sync_handling_loop_restart_v2_enabled")}function k(){return d("WAWebABProps").getABPropConfigValue("web_recent_sync_chunk_download_optimization")}function l(){return d("WAWebABProps").getABPropConfigValue("web_recent_sync_worker_compatible_handling")}function m(){return d("WAWebABProps").getABPropConfigValue("web_recent_sync_next_chunk_fetch_optimization")}function n(){return d("WAWebABProps").getABPropConfigValue("web_recent_sync_chunk_data_handling_worker")}g.isHistorySyncOnDemandEnabled=a;g.shouldPopulateStarMessageWithTimestamp=b;g.isPlaceholderMessageResendEnabled=c;g.isWebLinkPreviewNseSupportEnabled=e;g.isMessagePlaceholderResendNseSupportEnabled=f;g.getRecentSyncMessageProcessingBreakIteration=i;g.isHistorySyncHandlingRestartV2Enabled=j;g.isRecentSyncDownloadOptimizationEnabled=k;g.isRecentSyncWorkerComaptibleHandlingEnabled=l;g.isRecentSyncNextChunkFetchOptimizationEnabled=m;g.isRecentSyncChunkDataHandlingInWorkerEnabled=n}),98);
__d("WAWebServerPropsModel",["WALogger","WAWebBaseModel","WAWebPonyfillsUrlSearchParams","WAWebProductTypes.flow","WAWebRuntimeEnvironmentUtils","WAWebWamGlobals","gkx"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[ephemeral] incorrect type for ephemeralMessagesAllowedValues"]);h=function(){return a};return a}var i=100*1024*1024,j=3,k=604800;b=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=c=a.call.apply(a,[this].concat(f))||this,c.serverPropsVersion=d("WAWebBaseModel").prop(),c.gifProvider=d("WAWebBaseModel").prop("tenor"),c.maxParticipants=d("WAWebBaseModel").prop(256),c.maxSubject=d("WAWebBaseModel").prop(25),c.maxFileSize=d("WAWebBaseModel").prop(i),c.streamingUploadChunkSize=d("WAWebBaseModel").prop(0),c.groupDescLength=d("WAWebBaseModel").prop(512),c.ephemeralMessagesAllowedValues=d("WAWebBaseModel").prop(""+k),c.mmsCatV1ForwardHotOverrideEnabled=d("WAWebBaseModel").prop(!1),c.pttConversationWaveform=d("WAWebBaseModel").prop(!1),c.pttOotPlayback=d("WAWebBaseModel").prop(!1),c.pttPausableEnabled=d("WAWebBaseModel").prop(!1),c.pttPlaybackSpeedEnabled=d("WAWebBaseModel").prop(!1),c.pttRememberPlayPosition=d("WAWebBaseModel").prop(!1),c.mmsMediaKeyTTL=d("WAWebBaseModel").prop(Infinity),c.syncdInlineMutationsMaxCount=d("WAWebBaseModel").prop(1e3),c.syncdPatchProtobufMaxSize=d("WAWebBaseModel").prop(100),c.syncdKeyMaxUseDays=d("WAWebBaseModel").prop(30),c.syncdWaitForKeyTimeoutDays=d("WAWebBaseModel").prop(2),c.syncdSentinelTimeoutSeconds=d("WAWebBaseModel").prop(3),c.syncdQPLLoggingEnabled=d("WAWebBaseModel").prop(!1),c.webPaymentBackgroundEnabled=d("WAWebBaseModel").prop(!1),c.webBizProfileOptions=d("WAWebBaseModel").prop(j),c.shopsProductGrid=d("WAWebBaseModel").prop(!1),c.greenAlertBannerDuration=d("WAWebBaseModel").prop(0),c.webProductListMessagePageSize=d("WAWebBaseModel").prop(d("WAWebProductTypes.flow").PRODUCT_PAGE_SIZE),c.blockCatalogCreationEcommerceComplianceIndia=d("WAWebBaseModel").prop(!1),c.smbEcommerceComplianceIndiaM4=d("WAWebBaseModel").prop(!1),c.smbEcommerceComplianceIndiaM4_5=d("WAWebBaseModel").prop(!1),c.webLogUploadDownloadCrashes=d("WAWebBaseModel").prop(!1),c.webMdMmsSyncDeletionRequest=d("WAWebBaseModel").prop(!0),c.maxKeys=d("WAWebBaseModel").prop(200),b)||babelHelpers.assertThisInitialized(c)}var e=b.prototype;e["delete"]=function(){a.prototype["delete"].call(this),this.updateProps({})};e.initialize=function(){a.prototype.initialize.call(this),c("gkx")("26258")!==!0&&this.updateProps({})};e.updateProps=function(a){var b=this,e=a;c("gkx")("26258")!==!0&&!d("WAWebRuntimeEnvironmentUtils").isWorker()&&(e=this.extendAndOverrideFromURLParams(e));d("WAWebWamGlobals").Global.set({webcBucket:e.bucket||null});this.__props.forEach(function(a){var c=e[a];c===void 0&&(a==="serverPropsVersion"?c=b.serverPropsVersion:c=b.getDefault(a));b.set(a,c)})};e.extendAndOverrideFromURLParams=function(a){var b=new(c("WAWebPonyfillsUrlSearchParams"))(window.location.search),d=a;this.__props.forEach(function(a){if(b.has(a)===!0){var c=b.get(a);if(c==null)return;c==="true"||c==="false"?d[a]=c==="true":!isNaN(c)&&!isNaN(parseFloat(c))?d[a]=parseFloat(c):d[a]=c}});return d};e.getEphemeralMessagesAllowedValues=function(){try{return this.ephemeralMessagesAllowedValues.split(",").map(function(a){return parseInt(a,10)})}catch(a){d("WALogger").ERROR(h()).sendLogs("ephemeral");return[k]}};return b}(d("WAWebBaseModel").BaseModel);b.Proxy="serverProps";e=d("WAWebBaseModel").defineModel(b);var l=new e({id:"1"});function a(){return l.maxFileSize}g.DEFAULT_MAX_FILE_SIZE_BYTES=i;g.UNINITIALIZED_VALUE_WEB_BIZ_PROFILE_OPTIONS=j;g.ServerPropsImpl=b;g.ServerProps=l;g.getMaxFilesSizeServerProp=a}),98);
__d("WAWebBizSystemMsgSubtypes",[],(function(a,b,c,d,e,f){a=["blue_msg_bsp_fb_to_bsp_premise","blue_msg_bsp_fb_to_self_fb","blue_msg_bsp_fb_to_self_premise","blue_msg_bsp_fb_unverified","blue_msg_bsp_fb_unverified_to_bsp_premise_verified","blue_msg_bsp_fb_unverified_to_self_fb_verified","blue_msg_bsp_fb_unverified_to_self_premise_verified","blue_msg_bsp_fb_verified","blue_msg_bsp_fb_verified_to_bsp_premise_unverified","blue_msg_bsp_fb_verified_to_self_fb_unverified","blue_msg_bsp_fb_verified_to_self_premise_unverified","blue_msg_bsp_premise_to_self_premise","blue_msg_bsp_premise_unverified","blue_msg_bsp_premise_unverified_to_self_premise_verified","blue_msg_bsp_premise_verified","blue_msg_bsp_premise_verified_to_self_premise_unverified","blue_msg_consumer_to_bsp_fb_unverified","blue_msg_consumer_to_bsp_premise_unverified","blue_msg_consumer_to_self_fb_unverified","blue_msg_consumer_to_self_premise_unverified","blue_msg_self_fb_to_bsp_premise","blue_msg_self_fb_to_self_premise","blue_msg_self_fb_unverified","blue_msg_self_fb_unverified_to_bsp_premise_verified","blue_msg_self_fb_unverified_to_self_premise_verified","blue_msg_self_fb_verified","blue_msg_self_fb_verified_to_bsp_premise_unverified","blue_msg_self_fb_verified_to_self_premise_unverified","blue_msg_self_premise_to_bsp_premise","blue_msg_self_premise_unverified","blue_msg_self_premise_verified","blue_msg_to_bsp_fb","blue_msg_to_consumer","blue_msg_to_self_fb","blue_msg_unverified_to_bsp_fb_verified","blue_msg_unverified_to_bsp_premise_verified","blue_msg_unverified_to_self_fb_verified","blue_msg_unverified_to_verified","blue_msg_verified_to_bsp_fb_unverified","blue_msg_verified_to_bsp_premise_unverified","blue_msg_verified_to_self_fb_unverified","blue_msg_verified_to_unverified"];b=["biz_privacy_mode_init_fb","biz_privacy_mode_init_bsp"];c=["biz_privacy_mode_to_fb","biz_privacy_mode_to_bsp"];d=[].concat(b,c);e=["biz_account_type_is_hosted","biz_account_type_changed_to_hosted","biz_me_account_type_is_hosted","biz_me_account_type_is_hosted_transition"];c="product_inquiry";f.BIZ_SYSTEM_MSG_SUBTYPES=a;f.BIZ_SYSTEM_MSG_SUBTYPES_V2_INIT=b;f.BIZ_SYSTEM_MSG_SUBTYPES_V2=d;f.COEX_MSG_SUBTYPES=e;f.PRODUCT_INQUIRY_TYPE=c}),66);
__d("WAWebEphemeralConstants",["$InternalEnum","WATimeUtils"],(function(a,b,c,d,e,f,g){c=d("WATimeUtils").DAY_SECONDS*7;e=d("WATimeUtils").DAY_SECONDS*90;f=b("$InternalEnum").Mirrored(["KEPT","UNKEPT"]);var h=b("$InternalEnum").Mirrored(["Seconds","Minutes","Hours","Days","Weeks"]);function a(a,b){b===void 0&&(b=!1);if(a<=d("WATimeUtils").MINUTE_SECONDS)return{duration:a,unit:h.Seconds};else if(a<d("WATimeUtils").HOUR_SECONDS){var c=Math.floor(a/60);return{duration:c,unit:h.Minutes}}else if(a<=d("WATimeUtils").DAY_SECONDS){c=Math.floor(a/60/60);return{duration:c,unit:h.Hours}}else if(Boolean(b)){if(a<d("WATimeUtils").WEEK_SECONDS){c=Math.floor(a/24/60/60);return{duration:c,unit:h.Days}}b=Math.floor(a/7/24/60/60);return{duration:b,unit:h.Weeks}}c=Math.floor(a/24/60/60);return{duration:c,unit:h.Days}}g.ONE_DAY=d("WATimeUtils").DAY_SECONDS;g.SEVEN_DAYS=c;g.NINETY_DAYS=e;g.KeepInChatState=f;g.DurationUnit=h;g.getDurationForString=a}),98);
__d("WAWebEphemeralityWAMUtils",["WAWebEphemeralityTypes","WAWebWamEnumDisappearingChatInitiatorType","WAWebWamEnumEphemeralityInitiatorType","WAWebWamEnumEphemeralityTriggerActionType"],(function(a,b,c,d,e,f,g){function a(a){switch(a){case d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.ACCOUNT_SETTINGS;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.CHAT_SETTINGS;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.BulkChange:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.BULK_CHANGE;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.UnknownGroups:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.UNKNOWN_GROUP;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.BizSupportFbHosting:case d("WAWebEphemeralityTypes").DisappearingModeTrigger.Unknown:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.UNKNOWN}}function b(a){a===void 0&&(a=!1);return Boolean(a)?d("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE.INITIATED_BY_ME:d("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE.INITIATED_BY_OTHER}function c(a){switch(a){case d("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe:return d("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE.INITIATED_BY_ME;case d("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByOther:case d("WAWebEphemeralityTypes").DisappearingModeInitiator.BizUpgradeFbHosting:return d("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE.INITIATED_BY_OTHER;case d("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat:return d("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE.CHAT}}g.getWamDisappearingModeTrigger=a;g.getWamDisappearingModeInitiatedByMe=b;g.getWamDisappearingModeInitiator=c}),98);
__d("WAWebGetters",["err"],(function(a,b,c,d,e,f,g){var h=function(){var a=i;i++;return a},i=0;function a(a){a=a||{};var b=a.root,d=a.rootEqualityCheck;a=a.createCache;a=a===void 0?s:a;var e=a(),f=h(),g=function(){var a=i;i++;return a},i=0,l=(a=b)!=null?a:k({getterGroupId:f,getterId:g(),resultEqualityCheck:(b=d)!=null?b:r,cache:e});if(l.kind!=="identity")throw c("err")("root must be an identity getter but got kind "+l.kind);return{field:function(a,b){b=b||{};var c=b["default"],d=b.getDefault;b=b.resultEqualityCheck;b=b===void 0?r:b;var h;d!=null?h=function(b){b=b[0];return(b=b[a])!=null?b:d()}:c===void 0?h=function(b){b=b[0];return b[a]}:h=function(b){b=b[0];return(b=b[a])!=null?b:c};return j({getterGroupId:f,getterId:g(),root:l,cache:e,resultFunc:h,resultEqualityCheck:b,props:{kind:"field",dependencyKey:a,dependencies:[l]}})},computed:function(a,b,c){c=c||{};c=c.resultEqualityCheck;c=c===void 0?r:c;return j({getterGroupId:f,getterId:g(),root:l,cache:e,resultFunc:a,resultEqualityCheck:c,props:{kind:"computed",dependencies:b}})},unsafeIdentityGetter:l,clearCacheFor:function(a){e["delete"](t(a))}}}function j(a){var b=a.getterGroupId,d=a.getterId,e=a.root,f=a.cache,g=a.resultFunc,h=a.resultEqualityCheck;a=a.props;var i=a.dependencies,j=i.length,k=n(d),m=o(d),r=p(d);return l({getterGroupId:b,getterId:d,root:e,cache:f,props:babelHelpers["extends"]({},a,{resultFunc:g}),recomputeIfNeeded:function(a,d,e){a=e[b];var f=a[m],l=a[r];if(l!=null&&f!=null){if(l===d)return f;if(l!=null&&j>0){var n=!1;for(var o=0;o<j;o++){var p=i[o];p=p.$$extractChangedAt(e[p.$$getterGroupId]);n=p==null||p>l;if(n)break}if(!n){a[r]=d;return f}}}p=new Array(j);for(o=0;o<j;o++){l=i[o];n=l.$$extractResult(e[l.$$getterGroupId]);if(n===void 0)throw c("err")("No result was stored");p[o]=u(n)}l=g(p);n=a[k];if(f!=null&&n!==void 0&&h(l,u(n))){a[r]=d;return f}a[k]=l===void 0?q:l;a[m]=d;a[r]=d;return d}})}function k(a){var b=a.getterGroupId,c=a.getterId,d=a.resultEqualityCheck;a=a.cache;var e=n(c),f=o(c),g=p(c);return l({getterGroupId:b,getterId:c,root:null,cache:a,props:{kind:"identity",dependencies:[]},recomputeIfNeeded:function(a,c,h){h=h[b];var i=h[e],j=a,k=h[g];a=a==null?0:a.revisionNumber||0;if(i!==void 0&&k===a&&d(j,u(i)))return c;k=c+1;h[e]=j===void 0?q:j;h[f]=k;h[g]=a;return k}})}function l(a){var b=a.getterGroupId,d=a.getterId,e=a.root,f=a.cache,g=a.recomputeIfNeeded;a=a.props;var h=a.dependencies,i=n(d),j=o(d),k=p(d);d=function(a){var d=t(a),e={};for(var f=0;f<s.length;f++){var g=s[f],h=r[g],j=h.get(d);j==null&&(j={},h.set(d,j));e[g]=j}h=q.$$recomputeIfNeeded(a,q.$$extractChangedAt(e[q.$$getterGroupId])||0,e);g=e[b];j=g[k];if(j==null||h>j)for(d=0;d<l.length;d++){f=j!=null;var m=l[d];for(var n=0;n<m.length;n++){var o=m[n].$$recomputeIfNeeded(a,h,e);(j==null||o>j)&&(f=!1)}if(f)break}o=g[i];if(o===void 0)throw c("err")("No result was stored");return u(o)};a=Object.assign(d,{kind:a.kind,dependencies:h,dependencyKey:a.dependencyKey,resultFunc:a.resultFunc,$$getterGroupId:b,$$root:e||d,$$cache:f,$$recomputeIfNeeded:g,$$extractChangedAt:function(a){return a[j]},$$extractResult:function(a){return a[i]}});var l=m(a),q=a.$$root;for(e=0;e<h.length;e++)if(h[e].$$root!==q)throw c("err")("Getter created with multiple roots. This means you used getters that came from different `createGetterFactories()` calls as dependencies in a `computed()` getter. If you want to do this, you must pass the identity getter created by one of the `createGetterFactories()` calls as the `root` option to the other.");var r=(d={},d[q.$$getterGroupId]=q.$$cache,d),s=[q.$$getterGroupId];for(f=0;f<l.length;f++)for(g=0;g<l[f].length;g++){h=l[f][g];e=h.$$getterGroupId;d=h.$$cache;r[e]==null&&(s.push(e),r[e]=d)}return a}function m(a){a=[a];for(var b=0;b<a.length;b++){var d=a[b];d.dependencies!=null&&a.push.apply(a,d.dependencies)}d=Array.from(new Set(a.reverse()));b=[];a=[];for(var e=0;e<d.length;e++){var f=d[e];switch(f.kind){case"identity":break;case"field":b.push(f);break;case"computed":a.push(f);break;default:throw c("err")("Invalid getter kind: "+f.kind)}}return[b,a].filter(function(a){return a.length>0})}var n=function(a){return 3*a},o=function(a){return 3*a+1},p=function(a){return 3*a+2};b=function(){function a(){}var b=a.prototype;b.toString=function(){return"UndefinedSentinel"};return a}();var q=new b();function r(a,b){return a===b}function s(){return new Map()}function t(a){if(a==null)throw c("err")("Getter was called with "+String(a)+" data.");a=a.id;if(a==null)throw c("err")("Data passed to getter must include an id property (it's how we memoize) but got "+String(a));return a.toString()}function u(a){return a===q?void 0:a}g.createGetterFactories=a}),98);
__d("WAWebDummyCacheMap",[],(function(a,b,c,d,e,f){a=function(){function a(){this.size=0}var b=a.prototype;b.clear=function(){};b["delete"]=function(){return!1};b.get=function(){return void 0};b.has=function(){return!1};b.set=function(){return this};return a}();f.FakeCacheMap=a}),66);
__d("WAWebGettersCaches",["WAWebABProps","WAWebDummyCacheMap","WAWebEnvironment"],(function(a,b,c,d,e,f,g){a=function(){if(d("WAWebABProps").getABPropConfigValue("web_getters_noop_cache"))return new(d("WAWebDummyCacheMap").FakeCacheMap)();return c("WAWebEnvironment").isWindows?new(d("WAWebDummyCacheMap").FakeCacheMap)():new Map()};b=a;e=a;f=function(){return new Map()};var h=function(){return new Map()},i=a,j=a,k=a,l=a,m=a,n=a,o=a,p=a,q=a,r=a,s=a,t=a,u=a,v=a,w=a,x=a,y=a,z=a,A=a,B=a;a=a;g.createMessagesCache=b;g.createFrontendMessagesCache=e;g.createContactsCache=f;g.createFrontendContactsCache=h;g.createLabelsCache=i;g.createMuteCache=j;g.createPinInChatsCache=k;g.createFrontendPinInChatsCache=l;g.createMsgInfosCache=m;g.createPollVotesCache=n;g.createFrontendPollVotesCache=o;g.createNewsletterPollVotesCache=p;g.createFrontendNewsletterPollVotesCache=q;g.createSettingsCache=r;g.createStickerModelMdCache=s;g.createMediaEditControllerCache=t;g.createOrderCache=u;g.createOrderItemCache=v;g.createQuickReplyCache=w;g.createFrontendQuickReplyCache=x;g.createStatusCache=y;g.createFrontendStatusCache=z;g.createRecordingSessionCache=A;g.createEventResponseCache=B;g.createFrontendEventResponseCache=a}),98);
__d("WAWebInteractiveMessageHeaderMediaType",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["IMAGE","VIDEO","DOCUMENT"]);c=new Set([a.IMAGE,a.VIDEO,a.DOCUMENT]);f.InteractiveMessageHeaderMediaType=a;f.IM_MEDIA_HEADER_TYPES=c}),66);
__d("WAWebCountriesNativeCountryNames",[],(function(a,b,c,d,e,f){a={AC:"Ascension Island",AD:"Andorra",AE:"\u0627\u0644\u0625\u0645\u0627\u0631\u0627\u062a \u0627\u0644\u0639\u0631\u0628\u064a\u0629 \u0627\u0644\u0645\u062a\u062d\u062f\u0629",AF:"\u0627\u0641\u063a\u0627\u0646\u0633\u062a\u0627\u0646",AG:"Antigua & Barbuda",AI:"Anguilla",AL:"Shqip\xebri",AM:"\u0540\u0561\u0575\u0561\u057d\u057f\u0561\u0576",AO:"Angola",AR:"Argentina",AS:"American Samoa",AT:"\xd6sterreich",AU:"Australia",AW:"Aruba",AX:"\xc5land",AZ:"Az\u0259rbaycan",BA:"Bosna i Hercegovina",BB:"Barbados",BD:"\u09ac\u09be\u0982\u09b2\u09be\u09a6\u09c7\u09b6",BE:"Belgi\xeb",BF:"Burkina Faso",BG:"\u0411\u044a\u043b\u0433\u0430\u0440\u0438\u044f",BH:"\u0627\u0644\u0628\u062d\u0631\u064a\u0646",BI:"Burundi",BJ:"B\xe9nin",BL:"Saint-Barth\xe9lemy",BM:"Bermuda",BN:"Brunei",BO:"Bolivia",BQ:"Caribisch Nederland",BR:"Brasil",BS:"Bahamas",BT:"\u0f60\u0f56\u0fb2\u0f74\u0f42",BW:"Botswana",BY:"\u0411\u0435\u043b\u0430\u0440\u0443\u0441\u044c",BZ:"Belize",CA:"Canada",CC:"Kepulauan Cocos (Keeling)",CD:"Congo-Kinshasa",CF:"R\xe9publique centrafricaine",CG:"Congo-Brazzaville",CH:"Schweiz",CI:"C\xf4te d\u2019Ivoire",CK:"Cook Islands",CL:"Chile",CM:"Cameroon",CN:"\u4e2d\u56fd",CO:"Colombia",CR:"Costa Rica",CU:"Cuba",CV:"Cabo Verde",CW:"Cura\xe7ao",CX:"Christmas Island",CY:"\u039a\u03cd\u03c0\u03c1\u03bf\u03c2",CZ:"\u010cesko",DE:"Deutschland",DJ:"Djibouti",DK:"Danmark",DM:"Dominica",DO:"Rep\xfablica Dominicana",DZ:"\u0627\u0644\u062c\u0632\u0627\u0626\u0631",EC:"Ecuador",EE:"Eesti",EG:"\u0645\u0635\u0631",ER:"\u0625\u0631\u064a\u062a\u0631\u064a\u0627",ES:"Espa\xf1a",ET:"\u12a2\u1275\u12ee\u1335\u12eb",FI:"Suomi",FJ:"Fiji",FK:"Falkland Islands",FM:"Micronesia",FO:"F\xf8royar",FR:"France",GA:"Gabon",GB:"United Kingdom",GD:"Grenada",GE:"\u10e1\u10d0\u10e5\u10d0\u10e0\u10d7\u10d5\u10d4\u10da\u10dd",GF:"Guyane fran\xe7aise",GG:"Guernsey",GH:"Ghana",GI:"Gibraltar",GL:"Kalaallit Nunaat",GM:"Gambia",GN:"Guin\xe9e",GP:"Guadeloupe",GQ:"Guinea Ecuatorial",GR:"\u0395\u03bb\u03bb\u03ac\u03b4\u03b1",GT:"Guatemala",GU:"Guam",GW:"Guin\xe9-Bissau",GY:"Guyana",HK:"\u4e2d\u570b\u9999\u6e2f\u7279\u5225\u884c\u653f\u5340",HN:"Honduras",HR:"Hrvatska",HT:"Ha\xefti",HU:"Magyarorsz\xe1g",ID:"Indonesia",IE:"Ireland",IL:"\u05d9\u05e9\u05e8\u05d0\u05dc",IM:"Isle of Man",IN:"India",IO:"British Indian Ocean Territory",IQ:"\u0627\u0644\u0639\u0631\u0627\u0642",IR:"\u0627\u06cc\u0631\u0627\u0646",IS:"\xcdsland",IT:"Italia",JE:"Jersey",JM:"Jamaica",JO:"\u0627\u0644\u0623\u0631\u062f\u0646",JP:"\u65e5\u672c",KE:"Kenya",KG:"\u041a\u044b\u0440\u0433\u044b\u0437\u0441\u0442\u0430\u043d",KH:"\u1780\u1798\u17d2\u1796\u17bb\u1787\u17b6",KI:"Kiribati",KM:"\u062c\u0632\u0631 \u0627\u0644\u0642\u0645\u0631",KN:"St. Kitts & Nevis",KP:"\uc870\uc120\ubbfc\uc8fc\uc8fc\uc758\uc778\ubbfc\uacf5\ud654\uad6d",KR:"\ub300\ud55c\ubbfc\uad6d",KW:"\u0627\u0644\u0643\u0648\u064a\u062a",KY:"Cayman Islands",KZ:"\u049a\u0430\u0437\u0430\u049b\u0441\u0442\u0430\u043d",LA:"\u0ea5\u0eb2\u0ea7",LB:"\u0644\u0628\u0646\u0627\u0646",LC:"St. Lucia",LI:"Liechtenstein",LK:"\u0dc1\u0dca\u200d\u0dbb\u0dd3 \u0dbd\u0d82\u0d9a\u0dcf\u0dc0",LR:"Liberia",LS:"Lesotho",LT:"Lietuva",LU:"L\xebtzebuerg",LV:"Latvija",LY:"\u0644\u064a\u0628\u064a\u0627",MA:"\u0627\u0644\u0645\u063a\u0631\u0628",MC:"Monaco",MD:"Republica Moldova",ME:"\u0426\u0440\u043d\u0430 \u0413\u043e\u0440\u0430",MF:"Saint-Martin",MG:"Madagascar",MH:"Marshall Islands",MK:"\u0421\u0435\u0432\u0435\u0440\u043d\u0430 \u041c\u0430\u043a\u0435\u0434\u043e\u043d\u0438\u0458\u0430",ML:"Mali",MM:"\u1019\u103c\u1014\u103a\u1019\u102c",MN:"\u041c\u043e\u043d\u0433\u043e\u043b",MO:"\u4e2d\u570b\u6fb3\u9580\u7279\u5225\u884c\u653f\u5340",MP:"Northern Mariana Islands",MQ:"Martinique",MR:"\u0645\u0648\u0631\u064a\u062a\u0627\u0646\u064a\u0627",MS:"Montserrat",MT:"Malta",MU:"Mauritius",MV:"Maldives",MW:"Malawi",MX:"M\xe9xico",MY:"Malaysia",MZ:"Mo\xe7ambique",NA:"Namibia",NC:"Nouvelle-Cal\xe9donie",NE:"Niger",NF:"Norfolk Island",NG:"Nigeria",NI:"Nicaragua",NL:"Nederland",NO:"Norge",NP:"\u0928\u0947\u092a\u093e\u0932",NR:"Nauru",NU:"Niue",NZ:"New Zealand",OM:"\u0639\u064f\u0645\u0627\u0646",PA:"Panam\xe1",PE:"Per\xfa",PF:"Polyn\xe9sie fran\xe7aise",PG:"Papua New Guinea",PH:"Philippines",PK:"\u067e\u0627\u06a9\u0633\u062a\u0627\u0646",PL:"Polska",PM:"Saint-Pierre-et-Miquelon",PR:"Puerto Rico",PS:"\u0627\u0644\u0623\u0631\u0627\u0636\u064a \u0627\u0644\u0641\u0644\u0633\u0637\u064a\u0646\u064a\u0629",PT:"Portugal",PW:"Palau",PY:"Paraguay",QA:"\u0642\u0637\u0631",RE:"La R\xe9union",RO:"Rom\xe2nia",RS:"\u0421\u0440\u0431\u0438\u0458\u0430",RU:"\u0420\u043e\u0441\u0441\u0438\u044f",RW:"U Rwanda",SA:"\u0627\u0644\u0645\u0645\u0644\u0643\u0629 \u0627\u0644\u0639\u0631\u0628\u064a\u0629 \u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629",SB:"Solomon Islands",SC:"Seychelles",SD:"\u0627\u0644\u0633\u0648\u062f\u0627\u0646",SE:"Sverige",SG:"Singapore",SH:"St. Helena",SI:"Slovenija",SJ:"\u0428\u043f\u0438\u0446\u0431\u0435\u0440\u0433\u0435\u043d \u0438 \u042f\u043d-\u041c\u0430\u0439\u0435\u043d",SK:"Slovensko",SL:"Sierra Leone",SM:"San Marino",SN:"S\xe9n\xe9gal",SO:"Soomaaliya",SR:"Suriname",SS:"South Sudan",ST:"S\xe3o Tom\xe9 e Pr\xedncipe",SV:"El Salvador",SX:"Sint-Maarten",SY:"\u0633\u0648\u0631\u064a\u0627",SZ:"Eswatini",TC:"Turks & Caicos Islands",TD:"Tchad",TG:"Togo",TH:"\u0e44\u0e17\u0e22",TJ:"\u0422\u043e\u04b7\u0438\u043a\u0438\u0441\u0442\u043e\u043d",TK:"Tokelau",TL:"Timor-Leste",TM:"T\xfcrkmenistan",TN:"\u062a\u0648\u0646\u0633",TO:"Tonga",TR:"T\xfcrkiye",TT:"Trinidad & Tobago",TV:"Tuvalu",TW:"\u53f0\u7063",TZ:"Tanzania",UA:"\u0423\u043a\u0440\u0430\u0457\u043d\u0430",UG:"Uganda",US:"United States",UY:"Uruguay",UZ:"O\u02bbzbekiston",VA:"Citt\xe0 del Vaticano",VC:"St. Vincent & Grenadines",VE:"Venezuela",VG:"British Virgin Islands",VI:"U.S. Virgin Islands",VN:"Vi\u1ec7t Nam",VU:"Vanuatu",WF:"Wallis-et-Futuna",WS:"Samoa",XK:"Kosov\xeb",YE:"\u0627\u0644\u064a\u0645\u0646",YT:"Mayotte",ZA:"iNingizimu Afrika",ZM:"Zambia",ZW:"Zimbabwe"};f["default"]=a}),66);
__d("WAWebL10nGetRenderedLocale",["IntlCurrentLocale"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("IntlCurrentLocale").code}g.WAWebL10nGetRenderedLocale=a}),98);
__d("WAWebLocaleModules",["JSResource","WAWebL10nGetRenderedLocale","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){switch(d("WAWebL10nGetRenderedLocale").WAWebL10nGetRenderedLocale()){case"af_ZA":return c("JSResource")("WAWebCountriesLocaleAF").__setRef("WAWebLocaleModules").load();case"ar_AR":return c("JSResource")("WAWebCountriesLocaleAR").__setRef("WAWebLocaleModules").load();case"az_AZ":return c("JSResource")("WAWebCountriesLocaleAZ").__setRef("WAWebLocaleModules").load();case"bg_BG":return c("JSResource")("WAWebCountriesLocaleBG").__setRef("WAWebLocaleModules").load();case"bn_IN":return c("JSResource")("WAWebCountriesLocaleBN").__setRef("WAWebLocaleModules").load();case"ca_ES":return c("JSResource")("WAWebCountriesLocaleCA").__setRef("WAWebLocaleModules").load();case"cs_CZ":return c("JSResource")("WAWebCountriesLocaleCS").__setRef("WAWebLocaleModules").load();case"da_DK":return c("JSResource")("WAWebCountriesLocaleDA").__setRef("WAWebLocaleModules").load();case"de_DE":return c("JSResource")("WAWebCountriesLocaleDE").__setRef("WAWebLocaleModules").load();case"el_GR":return c("JSResource")("WAWebCountriesLocaleEL").__setRef("WAWebLocaleModules").load();case"en_GB":return c("JSResource")("WAWebCountriesLocaleEN").__setRef("WAWebLocaleModules").load();case"es_LA":return c("JSResource")("WAWebCountriesLocaleES").__setRef("WAWebLocaleModules").load();case"et_EE":return c("JSResource")("WAWebCountriesLocaleET").__setRef("WAWebLocaleModules").load();case"fa_IR":return c("JSResource")("WAWebCountriesLocaleFA").__setRef("WAWebLocaleModules").load();case"fi_FI":return c("JSResource")("WAWebCountriesLocaleFI").__setRef("WAWebLocaleModules").load();case"tl_PH":return c("JSResource")("WAWebCountriesLocaleFIL").__setRef("WAWebLocaleModules").load();case"fr_FR":return c("JSResource")("WAWebCountriesLocaleFR").__setRef("WAWebLocaleModules").load();case"gu_IN":return c("JSResource")("WAWebCountriesLocaleGU").__setRef("WAWebLocaleModules").load();case"he_IL":return c("JSResource")("WAWebCountriesLocaleHE").__setRef("WAWebLocaleModules").load();case"hi_IN":return c("JSResource")("WAWebCountriesLocaleHI").__setRef("WAWebLocaleModules").load();case"hr_HR":return c("JSResource")("WAWebCountriesLocaleHR").__setRef("WAWebLocaleModules").load();case"hu_HU":return c("JSResource")("WAWebCountriesLocaleHU").__setRef("WAWebLocaleModules").load();case"id_ID":return c("JSResource")("WAWebCountriesLocaleID").__setRef("WAWebLocaleModules").load();case"it_IT":return c("JSResource")("WAWebCountriesLocaleIT").__setRef("WAWebLocaleModules").load();case"ja_JP":return c("JSResource")("WAWebCountriesLocaleJA").__setRef("WAWebLocaleModules").load();case"kk_KZ":return c("JSResource")("WAWebCountriesLocaleKK").__setRef("WAWebLocaleModules").load();case"kn_IN":return c("JSResource")("WAWebCountriesLocaleKN").__setRef("WAWebLocaleModules").load();case"ko_KR":return c("JSResource")("WAWebCountriesLocaleKO").__setRef("WAWebLocaleModules").load();case"lt_LT":return c("JSResource")("WAWebCountriesLocaleLT").__setRef("WAWebLocaleModules").load();case"lv_LV":return c("JSResource")("WAWebCountriesLocaleLV").__setRef("WAWebLocaleModules").load();case"mk_MK":return c("JSResource")("WAWebCountriesLocaleMK").__setRef("WAWebLocaleModules").load();case"ml_IN":return c("JSResource")("WAWebCountriesLocaleML").__setRef("WAWebLocaleModules").load();case"mr_IN":return c("JSResource")("WAWebCountriesLocaleMR").__setRef("WAWebLocaleModules").load();case"ms_MY":return c("JSResource")("WAWebCountriesLocaleMS").__setRef("WAWebLocaleModules").load();case"nb_NO":return c("JSResource")("WAWebCountriesLocaleNB").__setRef("WAWebLocaleModules").load();case"nl_NL":return c("JSResource")("WAWebCountriesLocaleNL").__setRef("WAWebLocaleModules").load();case"pa_IN":return c("JSResource")("WAWebCountriesLocalePA").__setRef("WAWebLocaleModules").load();case"pl_PL":return c("JSResource")("WAWebCountriesLocalePL").__setRef("WAWebLocaleModules").load();case"pt_BR":case"pt_PT":return c("JSResource")("WAWebCountriesLocalePT").__setRef("WAWebLocaleModules").load();case"ro_RO":return c("JSResource")("WAWebCountriesLocaleRO").__setRef("WAWebLocaleModules").load();case"ru_RU":return c("JSResource")("WAWebCountriesLocaleRU").__setRef("WAWebLocaleModules").load();case"sk_SK":return c("JSResource")("WAWebCountriesLocaleSK").__setRef("WAWebLocaleModules").load();case"sl_SI":return c("JSResource")("WAWebCountriesLocaleSL").__setRef("WAWebLocaleModules").load();case"sq_AL":return c("JSResource")("WAWebCountriesLocaleSQ").__setRef("WAWebLocaleModules").load();case"sr_RS":return c("JSResource")("WAWebCountriesLocaleSR").__setRef("WAWebLocaleModules").load();case"sv_SE":return c("JSResource")("WAWebCountriesLocaleSV").__setRef("WAWebLocaleModules").load();case"sw_KE":return c("JSResource")("WAWebCountriesLocaleSW").__setRef("WAWebLocaleModules").load();case"ta_IN":return c("JSResource")("WAWebCountriesLocaleTA").__setRef("WAWebLocaleModules").load();case"te_IN":return c("JSResource")("WAWebCountriesLocaleTE").__setRef("WAWebLocaleModules").load();case"th_TH":return c("JSResource")("WAWebCountriesLocaleTH").__setRef("WAWebLocaleModules").load();case"tr_TR":return c("JSResource")("WAWebCountriesLocaleTR").__setRef("WAWebLocaleModules").load();case"uk_UA":return c("JSResource")("WAWebCountriesLocaleUK").__setRef("WAWebLocaleModules").load();case"ur_PK":return c("JSResource")("WAWebCountriesLocaleUR").__setRef("WAWebLocaleModules").load();case"uz_UZ":return c("JSResource")("WAWebCountriesLocaleUZ").__setRef("WAWebLocaleModules").load();case"vi_VN":return c("JSResource")("WAWebCountriesLocaleVI").__setRef("WAWebLocaleModules").load();case"zh_CN":return c("JSResource")("WAWebCountriesLocaleZH-CN").__setRef("WAWebLocaleModules").load();case"zh_TW":return c("JSResource")("WAWebCountriesLocaleZH-TW").__setRef("WAWebLocaleModules").load();case"zh_HK":return c("JSResource")("WAWebCountriesLocaleZH-HK").__setRef("WAWebLocaleModules").load();default:return c("JSResource")("WAWebCountriesLocaleEN").__setRef("WAWebLocaleModules").load()}});return h.apply(this,arguments)}g.getCountryData=a}),98);
__d("WAWebCountriesUtils",["WAWebCountriesNativeCountryNames","WAWebL10NCountryCodes","WAWebLocaleModules","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=Object.freeze({META_RECOGNIZED:"META_RECOGNIZED",WHATSAPP_REGISTRATION:"WHATSAPP_REGISTRATION"}),i=new Map(Object.entries(c("WAWebCountriesNativeCountryNames")).map(function(a){a=a[0];return[a,a]})),j=(c={},c[h.META_RECOGNIZED]=["AC","CP","DG","EA","EU","EZ","IC","QO","TA","UN","XA","XB"],c[h.WHATSAPP_REGISTRATION]=["AQ","BV","CP","DG","EA","EH","EU","EZ","GS","HM","IC","PN","QO","TA","TF","UM","UN","XA","XB","ZZ"],c);function k(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(a==null||a==="")return void 0;if(b&&j[b].includes(a.toUpperCase()))return void 0;b=(yield d("WAWebLocaleModules").getCountryData());return b[a.toUpperCase()]});return l.apply(this,arguments)}function a(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebLocaleModules").getCountryData());b=Object.entries(b).filter(function(b){b=b[0];return!b.includes("@")&&!j[a.filter].includes(b)}).sort(function(a,b){a=a[1];b=b[1];return String(a).localeCompare(String(b))});a.prependWith!=null&&b.unshift([a.prependWith[0],a.prependWith[1].toJSON()]);return b.map(function(a){var b=a[0];a=a[1];return[b,a]})});return m.apply(this,arguments)}function e(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAWebL10NCountryCodes").getCountryShortcodeByPhone(a);if(a!=="")return k(a)});return n.apply(this,arguments)}function f(a){return i.get(a)}g.COUNTRY_FILTER_TYPE=h;g.getCountryName=k;g.getCountries=a;g.getCountryNameByPhone=e;g.asISOCountryCode=f}),98);
__d("WAWebMusicParsingUtils",["WABase64","WALogger","WAWebCountriesUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[music] invalid country codes"]);h=function(){return a};return a}function i(a){a=Array.from(new Uint8Array(a)).map(function(a){return String.fromCharCode(a)});var b=new Set(),c=new Set();for(var e=0;e<a.length-1;e+=2){var f=(""+a[e]+a[e+1]).toUpperCase(),g=d("WAWebCountriesUtils").asISOCountryCode(f);g!=null?b.add(g):c.add(f)}c.size>0&&d("WALogger").ERROR(h()).devConsole(c).sendLogs("music-invalid-country-codes");return b}function a(a){var b=a.musicContentMediaId,c=a.songId,e=a.author,f=a.title,g=a.artworkDirectPath,h=a.artworkSha256,j=a.artworkEncSha256,k=a.artistAttribution,l=a.countryBlocklist,m=a.isExplicit;a=a.artworkMediaKey;return b==null||c==null||e==null||f==null?null:{musicContentMediaId:b,songId:c,author:e,title:f,artworkDirectPath:g,artworkSha256:h!=null?d("WABase64").encodeB64(h):void 0,artworkEncSha256:j!=null?d("WABase64").encodeB64(j):void 0,artworkMediaKey:a!=null?d("WABase64").encodeB64(a):void 0,isExplicit:Boolean(m),artistAttribution:k,countryBlocklist:l!=null?i(l):new Set()}}g.mapToCountryCode=i;g.toMusicMetadata=a}),98);
__d("WAWebNewsletterIsNewsletterMsg",["WAWebWid"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.from;a=a.to;return c("WAWebWid").isNewsletter(b)||c("WAWebWid").isNewsletter(a)}g["default"]=a}),98);
__d("WAWebMsgGetters",["WABase64","WALogger","WAPhoneFindCC","WATimeUtils","WATypeUtils","WAWebAck","WAWebBizSystemMsgSubtypes","WAWebBotTypes","WAWebBusinessHSMTypes","WAWebCommonMsgUtils","WAWebConstantsDeprecated","WAWebEphemeralConstants","WAWebEphemeralityWAMUtils","WAWebGetters","WAWebGettersCaches","WAWebInteractiveMessageHeaderMediaType","WAWebMimeTypes","WAWebMsgType","WAWebMusicParsingUtils","WAWebNewsletterIsNewsletterMsg","WAWebProtobufsE2E.pb","WAWebUserPrefsMeUser","WAWebVcardParsingUtils","WAWebViewMode.flow","WAWebViewModeUtils","WAWebWamEnumEditType","WAWebWid","WAWebWidFactory","gkx","lodash"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Msg: could not derive isInternational as some data is missing"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unexpected non-wid for originalSelfAuthorOrSender; value=","; typeof=","; msg.type=",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unexpected non-wid for originalSelfAuthorOrSender; typeof=","; msg.type=",""]);j=function(){return a};return a}a=d("WAWebGetters").createGetterFactories({createCache:d("WAWebGettersCaches").createMessagesCache});b=a.field;e=a.computed;f=a.unsafeIdentityGetter;a=a.clearCacheFor;a=a;f=f;function k(a){if(a instanceof c("WAWebWid"))return a;return a.user!=null?d("WAWebWidFactory").createUserWid(a.user,a.server):a}var l=b("type"),m=b("subtype"),n=b("id"),o=b("to"),p=b("from"),q=b("broadcastId"),aa=e(function(a){var b=a[0];a=a[1];return a!=null?a:b.remote},[n,q]),r=b("viewMode"),s=b("author"),t=b("ack"),ba=b("viewCount"),ca=b("viewed"),u=b("originalSelfAuthor"),v=b("kicState"),da=b("kicTimestampMs"),w=b("list"),x=b("latestEditMsgKey"),ea=b("errorCode"),y=b("ephemeralDuration"),fa=b("ephemeralSettingUser"),z=b("t",{"default":0}),A=b("backgroundColor"),ga=b("headerType"),B=b("interactiveHeader"),ha=b("interactiveType"),ia=b("footer"),C=b("mentionedJidList"),ja=b("groupMentions",{getDefault:function(){return[]}}),D=b("quotedMsg"),ka=b("quotedRemoteJid"),E=b("quotedParticipant"),F=b("rcat"),G=b("isViewOnce",{"default":!1}),la=b("isGif",{"default":!1}),ma=b("gifAttribution",{"default":d("WAWebProtobufsE2E.pb").Message$VideoMessage$Attribution.NONE}),na=b("ctwaContext"),H=b("mimetype"),oa=b("filehash"),pa=b("deprecatedMms3Url"),qa=b("waveform"),I=b("disappearingModeInitiator"),J=b("disappearingModeTrigger"),K=b("disappearingModeInitiatedByMe"),ra=b("activeBotMsgStreamingInProgress"),L=b("bizBotType"),M=b("botTargetSenderJid"),sa=b("isSupportAIMessage"),ta=b("forwardedNewsletterMessageInfo"),ua=b("newsletterAdminInviteInfo"),va=b("bizSource");function wa(a){return a==="smb_promo"}var xa=e(function(a){a=a[0];return wa(a)},[va]),ya=e(function(a){a=a[0];return a!=null},[D]),za=e(function(a){a=a[0];return d("WAWebMimeTypes").isOpus(a)},[H]),Aa=e(function(a){a=a[0];return a==null?null:d("WABase64").encodeB64UrlSafe(a,!0)},[F]),Ba=e(function(a){a=a[0];return a==null?!1:a.some(function(a){return d("WAWebUserPrefsMeUser").isMeAccount(k(a))})},[C]),Ca=b("local",{"default":!1}),N=e(function(a){var b=a[0];a=a[1];return b&&a?d("WAWebUserPrefsMeUser").isMeAccount(k(a)):!1},[D,E]);N=e(function(a){var b=a[0];a=a[1];return b||a},[Ba,N]);var Da=b("botPluginReferenceIndex"),Ea=e(function(a){var b=a[0],c=a[1],e=a[2];a=a[3];if(c!=null)return!1;if(!d("WAWebViewModeUtils").isViewModeVisibleInSurface(d("WAWebViewMode.flow").ViewModeSurface.CHAT,a))return!1;switch(b){case"interactive":return e;case"chat":case"image":case"video":case"ptv":case"audio":case"ptt":case"document":case"vcard":case"location":case"ciphertext":case"oversized":case"multi_vcard":case"sticker":case"status":case"product":case"groups_v4_invite":case"poll_creation":case"poll_result_snapshot":case"list":case"newsletter_admin_invite":case"event_creation":case"sticker-pack":case"album":return!0;case"revoked":case"protocol":case"order":case"biz-cover-photo":case"broadcast_notification":case"buttons_response":case"call_log":case"debug":case"debug_placeholder":case"e2e_notification":case"gp2":case"hsm":case"interactive_response":case"keep_in_chat":case"list_response":case"native_flow":case"notification":case"notification_template":case"payment":case"poll_update":case"reaction":case"reaction_enc":case"request_phone_number":case"template_button_reply":case"pin_message":case"pinned_message":case"newsletter_notification":case"comment":case"event_response":case"history_bundle":case"biz_content_placeholder":case"event_edit_encrypted":case"unknown":return!1;default:b;return!1}},[l,Da,xa,r]),O=e(function(a){var b=a[0];a=a[1];return c("WAWebWid").isGroup(b)||c("WAWebWid").isGroup(a)},[p,o]),P=e(function(a){var b=a[0];a=a[1];return c("WAWebNewsletterIsNewsletterMsg")({from:b,to:a})},[p,o]),Q=e(function(a){var b=a[0];a=a[1];return b||a!=null},[P,ta]),R=e(function(a){a=a[0];return c("WAWebWid").isStatus(a.remote)},[n]),Fa=e(function(a){var b=a[0];a=a[1];return d("WAWebCommonMsgUtils").isNotificationType(b,a)},[l,m]),S=e(function(a){var b=a[0],c=a[1],e=a[2];a=a[3];var f=b;if(a)return b.fromMe;return f.self==="in"||e?!1:d("WAWebUserPrefsMeUser").isMeAccount(c)},[n,p,Fa,P]),T=e(function(a){var b=a[0],c=a[1],e=a[2],f=a[3],g=a[4];a=a[5];return b?f?d("WAWebUserPrefsMeUser").getMeUser():g:c||e||(a==null?void 0:a.isBot())?a:g},[S,O,R,P,p,s]),Ga=e(function(a){var b=a[0],e=a[1];a=a[2];b=b||e;b!=null&&b.isUser==null&&(c("gkx")("26258")?d("WALogger").ERROR(j(),typeof b,a).sendLogs("non-wid-originalselfauthororsender"):d("WALogger").ERROR(i(),String(b),typeof b,a).sendLogs("non-wid-originalselfauthororsender"));return b!=null&&(b.isUser==null?void 0:b.isUser())?d("WAWebWidFactory").toUserWid(b):null},[u,T,l]),Ha=e(function(a){a=a[0];return a===d("WAWebMsgType").MSG_TYPE.REACTION||a===d("WAWebMsgType").MSG_TYPE.REACTION_ENC},[l]),Ia=e(function(a){var b=a[0];a=a[1];return b===d("WAWebMsgType").MSG_TYPE.POLL_UPDATE&&a==="poll_vote"},[l,m]),Ja=e(function(a){var b=a[0];a=a[1];return b===d("WAWebMsgType").MSG_TYPE.UNKNOWN||b===d("WAWebMsgType").MSG_TYPE.PAYMENT&&a==="futureproof"},[l,m]),Ka=e(function(a){a=a[0];return a===d("WAWebMsgType").MSG_TYPE.STICKER},[l]),La=b("isCarouselCard",{"default":!1}),Ma=e(function(a){var b=a[0];a=a[1];return!b&&!a},[G,Ka]),Na=e(function(a){a=a[0];return a===d("WAWebEphemeralConstants").KeepInChatState.KEPT},[v]),Oa=e(function(a){a=a[0];return a===d("WAWebEphemeralConstants").KeepInChatState.UNKEPT},[v]),Pa=e(function(a){a=a[0];return c("WAWebWid").isPSA(a.remote)},[n]),Qa=e(function(a){a=a[0];return c("WAWebWid").isIAS(a.remote)},[n]),Ra=e(function(a){a=a[0];return c("WAWebWid").isCAPISupportAccount(a.remote)},[n]),Sa=e(function(a){var b=a[0];a=a[1];return b===d("WAWebMsgType").MSG_TYPE.LIST&&(a==null?void 0:a.listType)===d("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.PRODUCT_LIST},[l,w]),Ta=b("title"),U=b("body",{"default":""}),Ua=b("caption"),Va=b("comment"),Wa=b("pollName",{"default":""}),Xa=b("pollOptions"),Ya=b("pollSelectableOptionsCount",{"default":0}),Za=b("pollInvalidated",{"default":!1}),$a=b("pollVotesSnapshot"),ab=b("eventName",{"default":""}),bb=b("eventDescription"),cb=b("eventStartTime",{"default":0}),db=b("eventEndTime"),eb=b("eventJoinLink"),fb=b("eventLocation"),gb=b("isEventCanceled",{"default":!1}),hb=b("eventInvalidated",{"default":!1}),ib=b("replyCount",{"default":0}),jb=b("nativeFlowName"),kb=b("nativeFlowButtons"),lb=b("paymentCurrency",{"default":""}),mb=b("paymentAmount1000",{"default":0}),nb=b("paymentMessageReceiverJid"),ob=b("paymentStatus"),pb=b("paymentTxnStatus"),qb=b("paymentNoteMsg"),rb=b("paymentRequestMessageKey"),sb=b("paymentExpiryTimestamp"),tb=b("paymentInviteServiceType"),ub=b("paymentBackground"),vb=b("isFromTemplate",{"default":!1}),wb=b("isLive",{"default":!1}),V=b("isDynamicReplyButtonsMsg",{"default":!1}),xb=b("dynamicReplyButtons"),yb=e(function(a){var b=a[0],c=a[1];a=a[2];return b===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&c==="ephemeral_setting"?!1:a!=null&&a!==0},[l,m,y]),zb=e(function(a){a=a[0];return a!=null},[x]),Ab=e(function(a){var b=a[0];a=a[1];return b===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&a==="message_edit"},[l,m]),Bb=e(function(a){var b=a[0];a=a[1];if(!b)return null;b="rgba(86, 150, 255, 255)";a=a;if(a==null||a===0)return b;b=a>>24&255;var c=a>>16&255,d=a>>8&255;a=a&255;return"rgba("+c+", "+d+", "+a+", "+b+")"},[R,A]),Cb=e(function(a){a=a[0];switch(a){case"protocol":case"chat":case"location":case"vcard":case"multi_vcard":case"image":case"video":case"ptv":case"audio":case"ptt":case"document":case"sticker":case"status":case"product":case"groups_v4_invite":case"order":case"poll_creation":case"poll_result_snapshot":case"newsletter_admin_invite":case"comment":case"event_creation":case"sticker-pack":case"album":return!0;case"biz-cover-photo":case"broadcast_notification":case"buttons_response":case"call_log":case"ciphertext":case"debug_placeholder":case"debug":case"e2e_notification":case"gp2":case"newsletter_notification":case"hsm":case"interactive":case"interactive_response":case"keep_in_chat":case"list":case"list_response":case"native_flow":case"notification":case"notification_template":case"oversized":case"payment":case"poll_update":case"reaction":case"reaction_enc":case"request_phone_number":case"revoked":case"template_button_reply":case"pin_message":case"pinned_message":case"event_response":case"history_bundle":case"biz_content_placeholder":case"event_edit_encrypted":case"unknown":return!1;default:a;return!1}},[l]),Db=e(function(a){var b=a[0],c=a[1];a=a[2];return b.fromMe&&c&&a},[n,Ca,Cb]),Eb=b("revokeSender"),Fb=e(function(a){a=a[0];return a!=null&&d("WAWebUserPrefsMeUser").isMeAccount(a)},[Eb]),Gb=e(function(a){var b=a[0],c=a[1];a=a[2];b=b.fromMe;b=b?c==null?void 0:c.toString({legacy:!0}):a==null?void 0:a.toString({legacy:!0});a=(c=d("WAWebUserPrefsMeUser").getMaybeMeUser())==null?void 0:c.toString({legacy:!0});if(b&&a)return d("WAPhoneFindCC").phoneCC(b)!==d("WAPhoneFindCC").phoneCC(a);d("WALogger").WARN(h());return!1},[n,o,p]),Hb=e(function(a){var b=a[0];a=a[1];if(b===d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE){if(d("WAWebBizSystemMsgSubtypes").BIZ_SYSTEM_MSG_SUBTYPES.includes(a))return!0;if(d("WAWebBizSystemMsgSubtypes").BIZ_SYSTEM_MSG_SUBTYPES_V2.includes(a))return!0;switch(a){case"verified_initial_unknown":case"verified_initial_low":case"verified_initial_high":case"verified_transition_any_to_none":case"verified_transition_any_to_high":case"verified_transition_high_to_low":case"verified_transition_high_to_unknown":case"verified_transition_unknown_to_low":case"verified_transition_low_to_unknown":case"verified_transition_none_to_low":case"verified_transition_none_to_unknown":case"biz_verified_transition_top_to_bottom":case"biz_verified_transition_bottom_to_top":case"biz_intro_top":case"biz_intro_bottom":case"biz_name_change":case"biz_move_to_consumer_app":case"biz_two_tier_migration_top":case"biz_two_tier_migration_bottom":return!0;default:return!1}}return!1},[l,m]),Ib=e(function(a){var b=a[0];a=a[1];switch(b){case"image":case"video":case"audio":case"sticker-pack":return!0;case"interactive":return a==null?!1:a.mediaType===d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.IMAGE||a.mediaType===d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.VIDEO;default:return!1}},[l,B]),W=b("isForwarded",{"default":!1}),Jb=b("forwardingScore"),Kb=e(function(a){var b=a[0];a=a[1];return a==null?b?1:0:a||0},[W,Jb]),Lb=e(function(a){a=a[0];return a>=c("WAWebConstantsDeprecated").FREQUENTLY_FORWARDED_SENTINEL},[Kb]),Mb=e(function(a){var b=a[0];a=a[1];return b.fromMe&&a!=null&&a.some(function(a){return a.isBot()})},[n,C]),Nb=e(function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return b||c||a||!d},[W,Q,S,Mb]),Ob=b("invis",{"default":!1}),Pb=b("isNewMsg",{"default":!1}),Qb=b("isSendFailure",{"default":!1}),Rb=e(function(a){var b=a[0],c=a[1];a=a[2];return b&&c!=null&&c<d("WAWebAck").ACK.CLOCK||a},[S,t,Qb]),Sb=e(function(a){var b=a[0];a=a[1];if(b!==d("WAWebMsgType").MSG_TYPE.VCARD)return void 0;try{return d("WAWebVcardParsingUtils").parseVcard(a)}catch(a){return void 0}},[l,U]),Tb=b("description"),Ub=b("matchedText",{"default":""}),Vb=b("thumbnail"),Wb=b("thumbnailHQ"),Xb=b("musicArtwork"),Yb=b("richPreviewType",{"default":d("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$PreviewType.NONE}),Zb=e(function(a){var b=a[0],e=a[1],f=a[2];a=a[3];return d("WATypeUtils").isString(a)&&(!c("lodash").isEmpty(e)||!c("lodash").isEmpty(f))&&b!=null&&b.includes(a)},[U,Ta,Tb,Ub]),$b=e(function(a){var b=a[0];a=a[1];return b||a},[V,vb]),ac=e(function(a){var b=a[0];a=a[1];return a||b===d("WAWebMsgType").MSG_TYPE.LIST||b===d("WAWebMsgType").MSG_TYPE.INTERACTIVE},[l,V]),bc=768,cc=e(function(a){var b=a[0];a=a[1];var c=308;return(a==null?void 0:a.isBot())?Infinity:b?c:bc},[Lb,T]),dc=e(function(a){var b=a[0];a=a[1];return b===d("WAWebMsgType").MSG_TYPE.E2E_NOTIFICATION&&a==="encrypt"||d("WAWebBizSystemMsgSubtypes").BIZ_SYSTEM_MSG_SUBTYPES_V2_INIT.includes(a)},[l,m]),ec=e(function(a){var b=a[0];a=a[1];return b===d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&a==="disappearing_mode"},[l,m]),fc=b("kicKey"),gc=e(function(a){var b=a[0];a=a[1];if(b!=null)if(b.fromMe)return d("WAWebUserPrefsMeUser").getMaybeMeUser();else if(a&&b.participant!=null)return d("WAWebWidFactory").toUserWid(b.participant);else if(!a)return d("WAWebWidFactory").toUserWid(b.remote)},[fc,O]),hc=e(function(a){var b=a[0],c=a[1];a=a[2];if(a==="ephemeral_setting")return null;return b==null||b===0?null:c+b},[y,z,m]),X=e(function(a){var b=a[0];a=a[1];return b===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&(a==="sender_revoke"||a==="admin_revoke")},[l,m]),ic=b("revokeDuration"),jc=e(function(a){var b=a[0],c=a[1];a=a[2];return c?b==="admin_revoke"?d("WAWebWamEnumEditType").EDIT_TYPE.ADMIN_REVOKE:d("WAWebWamEnumEditType").EDIT_TYPE.SENDER_REVOKE:a?d("WAWebWamEnumEditType").EDIT_TYPE.EDITED:d("WAWebWamEnumEditType").EDIT_TYPE.NOT_EDITED},[m,X,zb]),kc=e(function(a){a=a[0];if(a==null)return;return d("WAWebEphemeralityWAMUtils").getWamDisappearingModeTrigger(a)},[J]),lc=e(function(a){a=a[0];if(a==null)return;return d("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiatedByMe(a)},[K]),mc=e(function(a){a=a[0];if(a==null)return;return d("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiator(a)},[I]),nc=b("inviteCode",{"default":""}),oc=b("inviteCodeExp",{"default":""}),pc=b("inviteGrp",{"default":""}),qc=b("inviteGrpName"),rc=b("inviteGrpJpegThum"),sc=b("inviteGrpType"),tc=e(function(a){var b=a[0],c=a[1];a=a[2];if(b!==d("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE)return!1;if(!c)return!0;b=new Date().getTime()/1e3;return parseInt(b,10)>=parseInt(a,10)},[l,nc,oc]),uc=e(function(a){var b=a[0];a=a[1];if(b!==d("WAWebMsgType").MSG_TYPE.NEWSLETTER_ADMIN_INVITE)return!1;if(a==null)return!0;b=a.inviteExpiration;a=d("WATimeUtils").unixTime();return a>=b},[l,ua]),vc=b("productHeaderImageRejected",{"default":!1}),wc=e(function(a){var b=a[0];a=a[1];return b===!0?null:(b=a==null?void 0:(b=a.productListInfo)==null?void 0:(a=b.headerImage)==null?void 0:a.jpegThumbnail)!=null?b:null},[vc,w]),xc=e(function(a){var b=a[0];a=a[1];return b===d("WAWebMsgType").MSG_TYPE.PTT||b===d("WAWebMsgType").MSG_TYPE.PTV||a&&b===d("WAWebMsgType").MSG_TYPE.AUDIO},[l,Q]),yc=b("hasReaction",{"default":!1}),zc=b("recipients",{getDefault:function(){return[]}}),Ac=b("templateParams",{getDefault:function(){return[]}}),Bc=b("clientUrl",{"default":""}),Cc=b("loc",{"default":""}),Dc=b("lat"),Ec=b("lng"),Fc=b("shareDuration"),Gc=b("finalLat"),Hc=b("finalLng"),Ic=b("star",{"default":!1}),Jc=b("currencyCode"),Kc=b("priceAmount1000"),Lc=b("salePriceAmount1000"),Mc=b("isVcardOverMmsDocument",{"default":!1}),Nc=b("interactiveAnnotations"),Y=e(function(a){a=a[0];return a==null?null:a.filter(function(a){return((a=a.embeddedContent)==null?void 0:a.embeddedMusic)!=null})},[Nc]),Oc=e(function(a){a=a[0];return a==null?null:a[0]},[Y]),Pc=e(function(a){var b=a[0];a=a[1];return b&&a!=null&&a.length>0},[R,Y]),Qc=e(function(a){a=a[0];if(a==null)return null;a=(a=a.embeddedContent)==null?void 0:a.embeddedMusic;return a==null?null:d("WAWebMusicParsingUtils").toMusicMetadata(a)},[Oc]),Rc=b("messageSecret"),Sc=b("broadcast",{"default":!1}),Tc=b("vcardList",{getDefault:function(){return[]}}),Uc=b("vcardFormattedName"),Vc=b("labels",{getDefault:function(){return[]}}),Wc=b("agentId"),Xc=b("url"),Yc=b("retailerId"),Zc=b("businessOwnerJid"),$c=b("productId"),ad=b("productImageCount"),bd=b("isMdHistoryMsg",{"default":!1}),cd=b("campaignId"),dd=b("filename"),ed=b("smbClientCampaignId"),fd=b("isCaptionByUser",{"default":!1}),gd=b("doNotPlayInline"),hd=b("thumbnailDirectPath"),id=b("thumbnailHeight"),jd=b("thumbnailWidth"),kd=b("orderTitle"),ld=b("itemCount"),md=b("totalAmount1000"),nd=b("totalCurrencyCode"),od=b("futureproofType"),pd=b("futureproofSubtype"),qd=b("ephemeralOutOfSync"),rd=b("isAvatar"),sd=b("bizPrivacyStatus"),td=b("verifiedBizName"),ud=b("mediaKey"),vd=b("message",{"default":""}),wd=b("size",{"default":0}),xd=b("hostedBizEncStateMismatch"),yd=e(function(a){a=a[0];return a==="bot_unavailable_fanout"},[m]),zd=e(function(a){var b=a[0];a=a[1];return b.remote.isBot()?b.fromMe:a!=null&&a.some(function(a){return a.isBot()})},[n,C]),Ad=e(function(a){var b=a[0];a=a[1];return!b.fromMe&&a===d("WAWebBotTypes").BizBotType.BIZ_1P},[n,L]),Bd=e(function(a){var b=a[0];a=a[1];return!b.fromMe&&a===d("WAWebBotTypes").BizBotType.BIZ_3P},[n,L]),Cd=b("botPluginSearchProvider"),Dd=b("botPluginSearchUrl"),Ed=b("botResponseTargetId"),Fd=b("botPluginSearchQuery"),Gd=b("botPluginType"),Hd=e(function(a){var b=a[0];a=a[1];return b!=null&&a!=null},[Cd,Dd]),Z=e(function(a){a=a[0];return(a==null?void 0:a.isBot())===!0},[T]),Id=e(function(a){var b=a[0];a=a[1];return Boolean(b&&d("WAWebUserPrefsMeUser").isMeAccount(a))},[Z,M]),Jd=e(function(a){var b=a[0];a=a[1];return a&&!b.remote.isBot()},[n,Z]),Kd=e(function(a){var b=a[0],c=a[1];a=a[2];return b||c||a},[Z,Ad,Bd]),Ld=e(function(a){var b=a[0];a=a[1];return b===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&a==="bot_feedback"},[l,m]),$=b("hsmTag"),Md=e(function(a){a=a[0];return a===d("WAWebBusinessHSMTypes").HSM_TAG_TYPE.AUTHENTICATION},[$]),Nd=e(function(a){a=a[0];return a===d("WAWebBusinessHSMTypes").HSM_TAG_TYPE.MARKETING},[$]),Od=b("botRespOrInvocationRevokeBotWid"),Pd=e(function(a){var b=a[0];a=a[1];return Boolean((b==null?void 0:b.isBot())&&a)},[Od,X]),Qd=e(function(a){var b=a[0];a=a[1];return a&&(b===d("WAWebProtobufsE2E.pb").BotPluginMetadata$PluginType.SEARCH||b===d("WAWebProtobufsE2E.pb").BotPluginMetadata$PluginType.REELS)},[Gd,Z]),Rd=b("botPluginMaybeParent"),Sd=b("botReelPluginThumbnailCdnUrl");e=e(function(a){a=a[0];return a===d("WAWebMsgType").MSG_TYPE.BIZ_CONTENT_PLACEHOLDER},[l]);b=b("statusMentioned");g.clearMsgGetterCacheFor=a;g.getMsgUnsafe=f;g.getType=l;g.getSubtype=m;g.getId=n;g.getTo=o;g.getFrom=p;g.getBroadcastId=q;g.getRemote=aa;g.getViewMode=r;g.getAuthor=s;g.getAck=t;g.getViewCount=ba;g.getViewed=ca;g.getOriginalSelfAuthor=u;g.getKicState=v;g.getKicTimestampMs=da;g.getList=w;g.getLatestEditMsgKey=x;g.getErrorCode=ea;g.getEphemeralDuration=y;g.getEphemeralSettingUser=fa;g.getT=z;g.getBackgroundColor=A;g.getHeaderType=ga;g.getInteractiveHeader=B;g.getInteractiveType=ha;g.getFooter=ia;g.getMentionedJidList=C;g.getGroupMentions=ja;g.getQuotedMsg=D;g.getQuotedRemoteJid=ka;g.getQuotedParticipant=E;g.getRcat=F;g.getIsViewOnce=G;g.getIsGif=la;g.getGifAttribution=ma;g.getCtwaContext=na;g.getMimetype=H;g.getFilehash=oa;g.getDeprecatedMms3Url=pa;g.getWaveform=qa;g.getDisappearingModeInitiator=I;g.getDisappearingModeTrigger=J;g.getDisappearingModeInitiatedByMe=K;g.getActiveBotMsgStreamingInProgress=ra;g.getBizBotType=L;g.getBotTargetSenderJid=M;g.getIsSupportAIMessage=sa;g.getForwardedNewsletterMessageInfo=ta;g.getNewsletterAdminInviteInfo=ua;g.getBizSource=va;g.isBizSourceFromMarketingMessage=wa;g.getIsMarketingMessage=xa;g.getIsReply=ya;g.getIsOpus=za;g.getRcatString=Aa;g.getHasMentionOfMe=Ba;g.getLocal=Ca;g.getIsImportantMessage=N;g.getBotPluginReferenceIndex=Da;g.getIsUnreadType=Ea;g.getIsGroupMsg=O;g.getIsNewsletterMsg=P;g.getHasOriginatedFromNewsletter=Q;g.getIsStatus=R;g.getIsNotification=Fa;g.getIsSentByMe=S;g.getSender=T;g.getOriginalSender=Ga;g.getIsReaction=Ha;g.getIsPollVote=Ia;g.getIsFutureproof=Ja;g.getIsStickerMsg=Ka;g.getIsCarouselCard=La;g.getHasThumbList=Ma;g.getIsKept=Na;g.getIsUnkept=Oa;g.getIsPSA=Pa;g.getIsIAS=Qa;g.getIsCAPISupport=Ra;g.getIsProductListMessage=Sa;g.getTitle=Ta;g.getBody=U;g.getCaption=Ua;g.getComment=Va;g.getPollName=Wa;g.getPollOptions=Xa;g.getPollSelectableOptionsCount=Ya;g.getPollInvalidated=Za;g.getPollVotesSnapshot=$a;g.getEventName=ab;g.getEventDescription=bb;g.getEventStartTime=cb;g.getEventEndTime=db;g.getEventJoinLink=eb;g.getEventLocation=fb;g.getIsEventCanceled=gb;g.getEventInvalidated=hb;g.getReplyCount=ib;g.getNativeFlowName=jb;g.getNativeFlowButtons=kb;g.getPaymentCurrency=lb;g.getPaymentAmount1000=mb;g.getPaymentMessageReceiverJid=nb;g.getPaymentStatus=ob;g.getPaymentTxnStatus=pb;g.getPaymentNoteMsg=qb;g.getPaymentRequestMessageKey=rb;g.getPaymentExpiryTimestamp=sb;g.getPaymentInviteServiceType=tb;g.getPaymentBackground=ub;g.getIsFromTemplate=vb;g.getIsLive=wb;g.getIsDynamicReplyButtonsMsg=V;g.getDynamicReplyButtons=xb;g.getIsEphemeral=yb;g.getIsEdited=zb;g.getIsEditProtocolMsg=Ab;g.getStatusCanvasColor=Bb;g.getIsUserCreatedType=Cb;g.getIsSentByMeFromWeb=Db;g.getRevokeSender=Eb;g.getIsRevokedByMe=Fb;g.getIsInternational=Gb;g.getIsBizNotification=Hb;g.getIsMedia=Ib;g.getIsForwarded=W;g.getForwardingScore=Jb;g.getNumTimesForwarded=Kb;g.getIsFrequentlyForwarded=Lb;g.getIsBotInvoke=Mb;g.getShouldDisplayAsForwarded=Nb;g.getInvis=Ob;g.getIsNewMsg=Pb;g.getIsSendFailure=Qb;g.getIsFailed=Rb;g.getVcard=Sb;g.getDescription=Tb;g.getMatchedText=Ub;g.getThumbnail=Vb;g.getThumbnailHQ=Wb;g.getMusicArtwork=Xb;g.getRichPreviewType=Yb;g.getLinkPreview=Zb;g.getSupportsMessageFooter=$b;g.getSupportsMessageFooterLinks=ac;g.INITIAL_PAGE_SIZE=bc;g.getInitialPageSize=cc;g.getIsInitialE2ENotification=dc;g.getIsDisappearingModeSystemMessage=ec;g.getKicKey=fc;g.getKicSender=gc;g.getEphemeralExpirationTimestamp=hc;g.getIsRevoke=X;g.getRevokeDuration=ic;g.getWamEditType=jc;g.getWamDisappearingModeTrigger=kc;g.getWamDisappearingModeInitiatedByMe=lc;g.getWamDisappearingModeInitiator=mc;g.getInviteCode=nc;g.getInviteCodeExp=oc;g.getInviteGrp=pc;g.getInviteGrpName=qc;g.getInviteGrpJpegThum=rc;g.getInviteGrpType=sc;g.getIsGroupsV4InviteExpired=tc;g.getIsNewsletterAdminInviteExpired=uc;g.getProductHeaderImageRejected=vc;g.getProductListHeaderImage=wc;g.getIsAckPlayable=xc;g.getHasReaction=yc;g.getRecipients=zc;g.getTemplateParams=Ac;g.getClientUrl=Bc;g.getLoc=Cc;g.getLat=Dc;g.getLng=Ec;g.getShareDuration=Fc;g.getFinalLat=Gc;g.getFinalLng=Hc;g.getStar=Ic;g.getCurrencyCode=Jc;g.getPriceAmount1000=Kc;g.getSalePriceAmount1000=Lc;g.getIsVcardOverMmsDocument=Mc;g.getInteractiveAnnotations=Nc;g.getMusicAnnotations=Y;g.getFirstMusicAnnotation=Oc;g.isStatusWithMusic=Pc;g.getFirstMusicAnnotationEmbeddedContent=Qc;g.getMessageSecret=Rc;g.getBroadcast=Sc;g.getVcardList=Tc;g.getVcardFormattedName=Uc;g.getLabels=Vc;g.getAgendId=Wc;g.getUrl=Xc;g.getRetailerId=Yc;g.getBusinessOwnerJid=Zc;g.getProductId=$c;g.getProductImageCount=ad;g.getIsMdHistoryMsg=bd;g.getCampaignId=cd;g.getFilename=dd;g.getSmbClientCampaignId=ed;g.getIsCaptionByUser=fd;g.getDoNotPlayInline=gd;g.getThumbnailDirectPath=hd;g.getThumbnailHeight=id;g.getThumbnailWidth=jd;g.getOrderTitle=kd;g.getItemCount=ld;g.getTotalAmount1000=md;g.getTotalCurrencyCode=nd;g.getFutureproofType=od;g.getFutureproofSubtype=pd;g.getEphemeralOutOfSync=qd;g.getIsAvatar=rd;g.getBizPrivacyStatus=sd;g.getVerifiedBizName=td;g.getMediaKey=ud;g.getMessage=vd;g.getSize=wd;g.getHostedBizEncStateMismatch=xd;g.getIsBotFutureproofPlaceholder=yd;g.getIsBotQuery=zd;g.getIsBizBot1pResponse=Ad;g.getIsBizBot3pResponse=Bd;g.getBotPluginSearchProvider=Cd;g.getBotPluginSearchUrl=Dd;g.getBotResponseTargetId=Ed;g.getBotPluginSearchQuery=Fd;g.getBotPluginType=Gd;g.getIsBotSearchResponse=Hd;g.getIsMetaBotResponse=Z;g.isMetaBotResponseToMyInvoke=Id;g.getIsMetaBotInvokeResponse=Jd;g.getIsBotResponse=Kd;g.getIsBotFeedbackMessage=Ld;g.getHsmTag=$;g.getIsAuthenticationMessage=Md;g.getIsMarketingTemplateTag=Nd;g.getBotRespOrInvocationRevokeBotWid=Od;g.getIsRevokeForMsgFromOrDeliveredToBot=Pd;g.getIsBotPluginCarouselMsg=Qd;g.getBotPluginMaybeParent=Rd;g.getBotReelPluginThumbnailCdnUrl=Sd;g.getIsBizContentPlaceholder=e;g.getStatusMentioned=b}),98);
__d("WAWebL10NNumbersPluginRegistry",[],(function(a,b,c,d,e,f){var g=Math.pow(10,3),h=Math.pow(10,6);function i(a,b,c,d){d===void 0&&(d=1);var e=".";a=a/Math.pow(10,b);b=a.toString(10).split(".");a=b[0];b=b[1];return b==null||b.startsWith("0".repeat(d))||Number.parseInt(a,10)>=100?parseInt(a,10).toLocaleString(c):parseFloat(""+a+e+b.slice(0,d)).toLocaleString(c)}function j(a,b){return Intl.NumberFormat(b,{notation:"compact"}).format(a)}b={locales:["fr","fr-BE","fr-CA","fr-CH","fr-FR"],format:function(a,b){a=j(a,b);return a.toLocaleUpperCase(b)}};c={locales:["he","he-IL"],format:function(a,b){if(a<g)return a.toLocaleString(b);return a<h?i(a,3,b)+" \u05d0\u05dc\u05e3":i(a,6,b)+" \u05de\u05d9\u05dc\u05d9\u05d5\u05df"}};d={locales:["ro","ro-RO"],format:function(a,b){if(a<g)return a.toLocaleString(b);if(a===g)return"1 mie";return a<h?i(a,3,b)+" mii":i(a,6,b)+" mil."}};e={locales:["zh-SG","zh-CN"],format:function(a,b){if(a<g)return a.toLocaleString(b);return a<Math.pow(10,4)?i(a,3,b)+"\u5343":j(a,b)}};var k={locales:["ja"],format:function(a,b){if(a<g)return a.toLocaleString(b);return a<Math.pow(10,4)?i(a,3,b)+"\u5343":j(a,b)}},l={locales:["de","de-AT","de-CH","de-DE","de-LI","de-LU"],format:function(a,b){return a>g&&a<h?i(a,3,b)+" Tsd.":j(a,b)}},m={locales:["it","it-CH","it-IT"],format:function(a,b){if(a<g)return a.toLocaleString(b);return a<h?i(a,3,b)+" mila":i(a,6,b)+" mln"}},n={locales:["pt","pt-BR","pt-PT"],format:function(a,b){if(a<g)return a.toLocaleString(b);return a<h?j(a,b):i(a,6,b)+" M"}},o={locales:["zh-TW","zh-MO","zh-HK"],format:function(a,b){if(a<g)return a.toLocaleString(b);return a<Math.pow(10,4)?i(a,3,b)+"\u5343":j(a,"zh-TW")}},p=[l,b,m,c,k,n,d,o,e];l=a();function a(){var a=new Map(),b=function(){var b=p[c];b.locales.forEach(function(c){return a.set(c,b)})};for(var c=0;c<p.length;c++)b();return a}f.M=h;f.l10nNumberFormattersRegister=l}),66);
__d("WAWebL10NPlurals",[],(function(a,b,c,d,e,f){a={ach:{name:"Acholi",numbers:[1,2],plurals:function(a){return Number(a>1)}},af:{name:"Afrikaans",numbers:[1,2],plurals:function(a){return Number(a!=1)}},ak:{name:"Akan",numbers:[1,2],plurals:function(a){return Number(a>1)}},am:{name:"Amharic",numbers:[1,2],plurals:function(a){return Number(a>1)}},an:{name:"Aragonese",numbers:[1,2],plurals:function(a){return Number(a!=1)}},ar:{name:"Arabic",numbers:[0,1,2,3,11,100],plurals:function(a){return Number(a===0?0:a==1?1:a==2?2:a%100>=3&&a%100<=10?3:a%100>=11?4:5)}},arn:{name:"Mapudungun",numbers:[1,2],plurals:function(a){return Number(a>1)}},ast:{name:"Asturian",numbers:[1,2],plurals:function(a){return Number(a!=1)}},ay:{name:"Aymar\xe1",numbers:[1],plurals:function(a){return 0}},az:{name:"Azerbaijani",numbers:[1,2],plurals:function(a){return Number(a!=1)}},be:{name:"Belarusian",numbers:[1,2,5],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},bg:{name:"Bulgarian",numbers:[1,2],plurals:function(a){return Number(a!=1)}},bn:{name:"Bengali",numbers:[1,2],plurals:function(a){return Number(a!=1)}},bo:{name:"Tibetan",numbers:[1],plurals:function(a){return 0}},br:{name:"Breton",numbers:[1,2],plurals:function(a){return Number(a>1)}},bs:{name:"Bosnian",numbers:[1,2,5],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},ca:{name:"Catalan",numbers:[1,2],plurals:function(a){return Number(a!=1)}},cgg:{name:"Chiga",numbers:[1],plurals:function(a){return 0}},cs:{name:"Czech",numbers:[1,2,5],plurals:function(a){return Number(a==1?0:a>=2&&a<=4?1:2)}},csb:{name:"Kashubian",numbers:[1,2,5],plurals:function(a){return Number(a==1?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},cy:{name:"Welsh",numbers:[1,2,3,8],plurals:function(a){return Number(a==1?0:a==2?1:a!=8&&a!=11?2:3)}},da:{name:"Danish",numbers:[1,2],plurals:function(a){return Number(a!=1)}},de:{name:"German",numbers:[1,2],plurals:function(a){return Number(a!=1)}},dz:{name:"Dzongkha",numbers:[1],plurals:function(a){return 0}},el:{name:"Greek",numbers:[1,2],plurals:function(a){return Number(a!=1)}},en:{name:"English",numbers:[1,2],plurals:function(a){return Number(a!=1)}},eo:{name:"Esperanto",numbers:[1,2],plurals:function(a){return Number(a!=1)}},es:{name:"Spanish",numbers:[1,2],plurals:function(a){return Number(a!=1)}},es_ar:{name:"Argentinean Spanish",numbers:[1,2],plurals:function(a){return Number(a!=1)}},et:{name:"Estonian",numbers:[1,2],plurals:function(a){return Number(a!=1)}},eu:{name:"Basque",numbers:[1,2],plurals:function(a){return Number(a!=1)}},fa:{name:"Persian",numbers:[1,2],plurals:function(a){return Number(a>1)}},fi:{name:"Finnish",numbers:[1,2],plurals:function(a){return Number(a!=1)}},fil:{name:"Filipino",numbers:[1,2],plurals:function(a){return Number(a>1)}},fo:{name:"Faroese",numbers:[1,2],plurals:function(a){return Number(a!=1)}},fr:{name:"French",numbers:[1,2],plurals:function(a){return Number(a>1)}},fur:{name:"Friulian",numbers:[1,2],plurals:function(a){return Number(a!=1)}},fy:{name:"Frisian",numbers:[1,2],plurals:function(a){return Number(a!=1)}},ga:{name:"Irish",numbers:[1,2,3,7,11],plurals:function(a){return Number(a==1?0:a==2?1:a<7?2:a<11?3:4)}},gd:{name:"Scottish Gaelic",numbers:[1,2,3,20],plurals:function(a){return Number(a==1||a==11?0:a==2||a==12?1:a>2&&a<20?2:3)}},gl:{name:"Galician",numbers:[1,2],plurals:function(a){return Number(a!=1)}},gu:{name:"Gujarati",numbers:[1,2],plurals:function(a){return Number(a!=1)}},gun:{name:"Gun",numbers:[1,2],plurals:function(a){return Number(a>1)}},ha:{name:"Hausa",numbers:[1,2],plurals:function(a){return Number(a!=1)}},he:{name:"Hebrew",numbers:[1,2,20,3],plurals:function(a){return Number(a===1?0:a===2?1:a>=20&&a%10===0?2:3)}},hi:{name:"Hindi",numbers:[1,2],plurals:function(a){return Number(a!=1)}},hr:{name:"Croatian",numbers:[1,2,5],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},hu:{name:"Hungarian",numbers:[1,2],plurals:function(a){return Number(a!=1)}},hy:{name:"Armenian",numbers:[1,2],plurals:function(a){return Number(a!=1)}},ia:{name:"Interlingua",numbers:[1,2],plurals:function(a){return Number(a!=1)}},id:{name:"Indonesian",numbers:[1],plurals:function(a){return 0}},is:{name:"Icelandic",numbers:[1,2],plurals:function(a){return Number(a%10!=1||a%100==11)}},it:{name:"Italian",numbers:[1,2],plurals:function(a){return Number(a!=1)}},ja:{name:"Japanese",numbers:[1],plurals:function(a){return 0}},jbo:{name:"Lojban",numbers:[1],plurals:function(a){return 0}},jv:{name:"Javanese",numbers:[0,1],plurals:function(a){return Number(a!==0)}},ka:{name:"Georgian",numbers:[1],plurals:function(a){return 0}},kk:{name:"Kazakh",numbers:[1],plurals:function(a){return 0}},km:{name:"Khmer",numbers:[1],plurals:function(a){return 0}},kn:{name:"Kannada",numbers:[1,2],plurals:function(a){return Number(a!=1)}},ko:{name:"Korean",numbers:[1],plurals:function(a){return 0}},ku:{name:"Kurdish",numbers:[1,2],plurals:function(a){return Number(a!=1)}},kw:{name:"Cornish",numbers:[1,2,3,4],plurals:function(a){return Number(a==1?0:a==2?1:a==3?2:3)}},ky:{name:"Kyrgyz",numbers:[1],plurals:function(a){return 0}},lb:{name:"Letzeburgesch",numbers:[1,2],plurals:function(a){return Number(a!=1)}},ln:{name:"Lingala",numbers:[1,2],plurals:function(a){return Number(a>1)}},lo:{name:"Lao",numbers:[1],plurals:function(a){return 0}},lt:{name:"Lithuanian",numbers:[1,2,10],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&(a%100<10||a%100>=20)?1:2)}},lv:{name:"Latvian",numbers:[0,1,2],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a!==0?1:2)}},mai:{name:"Maithili",numbers:[1,2],plurals:function(a){return Number(a!=1)}},mfe:{name:"Mauritian Creole",numbers:[1,2],plurals:function(a){return Number(a>1)}},mg:{name:"Malagasy",numbers:[1,2],plurals:function(a){return Number(a>1)}},mi:{name:"Maori",numbers:[1,2],plurals:function(a){return Number(a>1)}},mk:{name:"Macedonian",numbers:[1,2],plurals:function(a){return Number(a==1||a%10==1?0:1)}},ml:{name:"Malayalam",numbers:[1,2],plurals:function(a){return Number(a!=1)}},mn:{name:"Mongolian",numbers:[1,2],plurals:function(a){return Number(a!=1)}},mnk:{name:"Mandinka",numbers:[0,1,2],plurals:function(a){return Number(a===0?0:a==1?1:2)}},mr:{name:"Marathi",numbers:[1,2],plurals:function(a){return Number(a!=1)}},ms:{name:"Malay",numbers:[1],plurals:function(a){return 0}},mt:{name:"Maltese",numbers:[1,2,11,20],plurals:function(a){return Number(a==1?0:a===0||a%100>1&&a%100<11?1:a%100>10&&a%100<20?2:3)}},nah:{name:"Nahuatl",numbers:[1,2],plurals:function(a){return Number(a!=1)}},nap:{name:"Neapolitan",numbers:[1,2],plurals:function(a){return Number(a!=1)}},nb:{name:"Norwegian Bokmal",numbers:[1,2],plurals:function(a){return Number(a!=1)}},ne:{name:"Nepali",numbers:[1,2],plurals:function(a){return Number(a!=1)}},nl:{name:"Dutch",numbers:[1,2],plurals:function(a){return Number(a!=1)}},nn:{name:"Norwegian Nynorsk",numbers:[1,2],plurals:function(a){return Number(a!=1)}},no:{name:"Norwegian",numbers:[1,2],plurals:function(a){return Number(a!=1)}},nso:{name:"Northern Sotho",numbers:[1,2],plurals:function(a){return Number(a!=1)}},oc:{name:"Occitan",numbers:[1,2],plurals:function(a){return Number(a>1)}},or:{name:"Oriya",numbers:[2,1],plurals:function(a){return Number(a!=1)}},pa:{name:"Punjabi",numbers:[1,2],plurals:function(a){return Number(a!=1)}},pap:{name:"Papiamento",numbers:[1,2],plurals:function(a){return Number(a!=1)}},pl:{name:"Polish",numbers:[1,2,5],plurals:function(a){return Number(a==1?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},pms:{name:"Piemontese",numbers:[1,2],plurals:function(a){return Number(a!=1)}},ps:{name:"Pashto",numbers:[1,2],plurals:function(a){return Number(a!=1)}},pt:{name:"Portuguese",numbers:[1,2],plurals:function(a){return Number(a!=1)}},"pt-BR":{name:"Brazilian Portuguese",numbers:[1,2],plurals:function(a){return Number(a!=1)}},rm:{name:"Romansh",numbers:[1,2],plurals:function(a){return Number(a!=1)}},ro:{name:"Romanian",numbers:[1,2,20],plurals:function(a){return Number(a==1?0:a===0||a%100>0&&a%100<20?1:2)}},ru:{name:"Russian",numbers:[1,2,5],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},sah:{name:"Yakut",numbers:[1],plurals:function(a){return 0}},sco:{name:"Scots",numbers:[1,2],plurals:function(a){return Number(a!=1)}},se:{name:"Northern Sami",numbers:[1,2],plurals:function(a){return Number(a!=1)}},si:{name:"Sinhala",numbers:[1,2],plurals:function(a){return Number(a!=1)}},sk:{name:"Slovak",numbers:[1,2,5],plurals:function(a){return Number(a==1?0:a>=2&&a<=4?1:2)}},sl:{name:"Slovenian",numbers:[5,1,2,3],plurals:function(a){return Number(a%100==1?1:a%100==2?2:a%100==3||a%100==4?3:0)}},so:{name:"Somali",numbers:[1,2],plurals:function(a){return Number(a!=1)}},son:{name:"Songhay",numbers:[1,2],plurals:function(a){return Number(a!=1)}},sq:{name:"Albanian",numbers:[1,2],plurals:function(a){return Number(a!=1)}},sr:{name:"Serbian",numbers:[1,2,5],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},su:{name:"Sundanese",numbers:[1],plurals:function(a){return 0}},sv:{name:"Swedish",numbers:[1,2],plurals:function(a){return Number(a!=1)}},sw:{name:"Swahili",numbers:[1,2],plurals:function(a){return Number(a!=1)}},ta:{name:"Tamil",numbers:[1,2],plurals:function(a){return Number(a!=1)}},te:{name:"Telugu",numbers:[1,2],plurals:function(a){return Number(a!=1)}},tg:{name:"Tajik",numbers:[1,2],plurals:function(a){return Number(a>1)}},th:{name:"Thai",numbers:[1],plurals:function(a){return 0}},ti:{name:"Tigrinya",numbers:[1,2],plurals:function(a){return Number(a>1)}},tk:{name:"Turkmen",numbers:[1,2],plurals:function(a){return Number(a!=1)}},tr:{name:"Turkish",numbers:[1,2],plurals:function(a){return Number(a>1)}},tt:{name:"Tatar",numbers:[1],plurals:function(a){return 0}},ug:{name:"Uyghur",numbers:[1],plurals:function(a){return 0}},uk:{name:"Ukrainian",numbers:[1,2,5],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},ur:{name:"Urdu",numbers:[1,2],plurals:function(a){return Number(a!=1)}},uz:{name:"Uzbek",numbers:[1,2],plurals:function(a){return Number(a>1)}},vi:{name:"Vietnamese",numbers:[1],plurals:function(a){return 0}},wa:{name:"Walloon",numbers:[1,2],plurals:function(a){return Number(a>1)}},wo:{name:"Wolof",numbers:[1],plurals:function(a){return 0}},yo:{name:"Yoruba",numbers:[1,2],plurals:function(a){return Number(a!=1)}},zh:{name:"Chinese",numbers:[1],plurals:function(a){return 0}}};f["default"]=a}),66);
__d("WAWebLocaleToTranslation",[],(function(a,b,c,d,e,f){a={pt:"pt_br",pt_ao:"pt_pt",pt_ch:"pt_pt",pt_cv:"pt_pt",pt_fr:"pt_pt",pt_gq:"pt_pt",pt_gw:"pt_pt",pt_lu:"pt_pt",pt_mo:"pt_pt",pt_mz:"pt_pt",pt_pt:"pt_pt",pt_st:"pt_pt",pt_tl:"pt_pt"};b=babelHelpers["extends"]({},a,{zh_hans:"zh_cn",zh_hant:"zh_tw",zh_sg:"zh_cn",tl:"fil","in":"id",iw:"he",mo:"ro",jw:"jv",ji:"yi"});c=b;f["default"]=c}),66);
__d("WAWebSupportedLocales",[],(function(a,b,c,d,e,f){a=Object.freeze({af:"af",ar:"ar",ar_xb:"ar-XB",az:"az",bg:"bg",bn:"bn",ca:"ca",cs:"cs",da:"da",de:"de",el:"el",en:"en",es:"es",et:"et",fa:"fa",fi:"fi",fil:"fil",fr:"fr",gu:"gu",he:"he",hi:"hi",hr:"hr",hu:"hu",id:"id",it:"it",ja:"ja",kk:"kk",kn:"kn",ko:"ko",lt:"lt",lv:"lv",mk:"mk",ml:"ml",mr:"mr",ms:"ms",nb:"nb",nl:"nl",pa:"pa",pl:"pl",pt:"pt",pt_br:"pt-BR",pt_pt:"pt-PT",ro:"ro",ru:"ru",sk:"sk",sl:"sl",sq:"sq",sr:"sr",sv:"sv",sw:"sw",ta:"ta",te:"te",th:"th",tr:"tr",uk:"uk",ur:"ur",uz:"uz",vi:"vi",zh_cn:"zh-CN",zh_hk:"zh-HK",zh_tw:"zh-TW"});b=a;f["default"]=b}),66);
__d("WAWebBaseL10N",["Locale","WAWeb-moment","WAWebEventEmitter","WAWebL10NConstants","WAWebL10NHelpers","WAWebL10NNumbersPluginRegistry","WAWebL10NPlurals","WAWebLocaleToTranslation","WAWebSupportedLocales","err","filesize","latenize"],(function(a,b,c,d,e,f,g){var h=new Set(["fa"]),i="\u0660\u0661\u0662\u0663\u0664\u0665\u0666\u0667\u0668\u0669".split(""),j=1024*1024*1024,k=Math.pow(10,6),l=Math.pow(10,3),m=Math.pow(10,4);function n(a){return i[parseInt(a,10)]}var o=c("err")("Unimplemented method");a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,e){var f;f=a.call(this)||this;if(!b||!c)throw o;f._locale=b;f.localeStrings={};f.localeStrings[d("WAWebL10NConstants").DEFAULT_LOCALE]=c;f.fbtStrings={};f.fbtStrings[d("WAWebL10NConstants").DEFAULT_LOCALE]={en_GB:{}};f.markTranslations=e;f.customizeMoment();return f}var e=b.prototype;e.getLocale=function(){throw o};e.getNormalizedLocale=function(){throw o};e.getFullLocale=function(){throw o};e.getFbtTranslations=function(){throw o};e.setLocale=function(a,b,c){throw o};e.normalizeLocaleToWajsLocale=function(a){a=a.replace(/-/g,"_").toLowerCase();var b=this._getTranslationFilename(a);if(b)return b;b=a;while(b){b=b.split("_").slice(0,-1).join("_");a=b&&this._getTranslationFilename(b);if(a)return a}return void 0};e.isLocaleSupported=function(a){return!!a&&!!this.normalizeLocaleToWajsLocale(a)};e._getTranslationFilename=function(a){a=c("WAWebLocaleToTranslation")[a]||a;return c("WAWebSupportedLocales")[a]};e.isRTL=function(){return d("Locale").isRTL()};e.LR=function(a,b){return this.isRTL()?b:a};e.embedDir=function(a,b){b===void 0&&(b=this.isRTL());return b?this.embedRTL(a):this.embedLTR(a)};e.embedLTR=function(a){return"\u202a"+a+"\u202c"};e.embedRTL=function(a){return"\u202b"+a+"\u202c"};e.isolateLTR=function(a){return"\u2066"+a+"\u2069"};e.isolateRTL=function(a){return"\u2067"+a+"\u2069"};e.forceLTR=function(a){return"\u200e"+a};e.forceRTL=function(a){return"\u200f"+a};e._getString=function(a,b,e){var f=this.localeStrings[b]||this.localeStrings[d("WAWebL10NConstants").DEFAULT_LOCALE];if(f==null)throw c("err")("Couldn't find translations for locale "+b+" or default ("+d("WAWebL10NConstants").DEFAULT_LOCALE+")");if(!Array.isArray(f))throw c("err")("Unexpected locale format.");var g=f[0];f=f[1];g=g[a]||"";if(e==null)return g;b=c("WAWebL10NPlurals")[b];if(b==null)return g;e=b.numbers[b.plurals(e)];if(e===1)return g;b=b.numbers.length===2&&e===2?a.toString():a+"_"+e;return f[b]||g};e.useArabicScriptDigits=function(a){return h.has((a=a)!=null?a:this.getNormalizedLocale())};e.isLatinAlphabetLanguage=function(a){return c("latenize").isLatin(this.removeAccents(a))};e.d=function(a,b,c){var e=d("WAWebL10NNumbersPluginRegistry").l10nNumberFormattersRegister.get(this.getFullLocale());if(e!=null&&typeof a==="number")return e.format(a,this.getFullLocale());e=typeof a==="number"&&(a>=k||a>=l&&a<m)?1:0;return this.n(a,b,babelHelpers["extends"]({},c,{notation:"compact",roundingMode:"trunc",trailingZeroDisplay:"stripIfInteger",minimumFractionDigits:e,maximumFractionDigits:e}))};e.n=function(a,b,c){a=a;if(typeof a==="number")return Intl.NumberFormat(this.getFullLocale(),c).format(a);return this.useArabicScriptDigits(b)?a.toString().replace(/[0-9]/g,n):a};e.filesizeWithParams=function(a,b){var d=a>j?1:0,e=this.getFullLocale();return this.n(c("filesize")(a,{base:2,round:d,locale:e,symbols:b}))};e.normalizeForm=function(a){a===void 0&&(a="");return d("WAWebL10NHelpers").normalizeForm(a)};e.removeAccents=function(a){a===void 0&&(a="");return d("WAWebL10NHelpers").removeAccents(a)};e.accentFold=function(a){a===void 0&&(a="");return this.removeAccents(a).toLowerCase()};e.customizeMoment=function(){var a;(a=c("WAWeb-moment")).relativeTimeRounding(Math.floor);a.relativeTimeThreshold("s",60);a.relativeTimeThreshold("m",60);a.relativeTimeThreshold("h",24)};return b}(c("WAWebEventEmitter"));g.WAWebBaseL10n=a}),98);
__d("WAWebL10NCoerceToFBLocale",["bcp-47","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h="en_GB",i=new Map([["af","af_ZA"],["ar","ar_AR"],["az","az_AZ"],["bg","bg_BG"],["bn","bn_IN"],["ca","ca_ES"],["cs","cs_CZ"],["da","da_DK"],["de","de_DE"],["el","el_GR"],["en","en_GB"],["es","es_LA"],["et","et_EE"],["fa","fa_IR"],["fi","fi_FI"],["fr","fr_FR"],["gu","gu_IN"],["he","he_IL"],["hi","hi_IN"],["hr","hr_HR"],["hu","hu_HU"],["id","id_ID"],["it","it_IT"],["ja","ja_JP"],["kk","kk_KZ"],["kn","kn_IN"],["ko","ko_KR"],["lt","lt_LT"],["lv","lv_LV"],["mk","mk_MK"],["ml","ml_IN"],["mr","mr_IN"],["ms","ms_MY"],["nb","nb_NO"],["nl","nl_NL"],["pa","pa_IN"],["pl","pl_PL"],["pt","pt_BR"],["ro","ro_RO"],["ru","ru_RU"],["sk","sk_SK"],["sl","sl_SI"],["sq","sq_AL"],["sr","sr_RS"],["sv","sv_SE"],["sw","sw_KE"],["ta","ta_IN"],["te","te_IN"],["th","th_TH"],["tl","tl_PH"],["tr","tr_TR"],["uk","uk_UA"],["ur","ur_PK"],["uz","uz_UZ"],["vi","vi_VN"],["zh","zh_CN"]]),j=new Map([["pt_ao","pt_PT"],["pt_ch","pt_PT"],["pt_cv","pt_PT"],["pt_fr","pt_PT"],["pt_gq","pt_PT"],["pt_gw","pt_PT"],["pt_lu","pt_PT"],["pt_mo","pt_PT"],["pt_mz","pt_PT"],["pt_pt","pt_PT"],["pt_st","pt_PT"],["pt_tl","pt_PT"],["zh_cn","zh_CN"],["zh_hk","zh_HK"],["zh_tw","zh_TW"],["zh_hant","zh_HK"],["zh_hans","zh_CN"],["fil","tl_PH"],["in","id_ID"],["iw","he_IL"],["mo","ro_RO"],["jw","jv_ID"],["ji","yi_DE"]]),k=new Map([["fb_aa","fb_AA"],["fb_ac","fb_AC"],["fb_ar","fb_AR"],["fb_ha","fb_HA"],["fb_hx","fb_HX"],["fb_ll","fb_LL"],["fb_ls","fb_LS"],["fb_lt","fb_LT"],["fb_rl","fb_RL"],["fb_zh","fb_ZH"],["fbt_ac","fbt_AC"]]);function a(a){if(c("gkx")("26259")){var b=a.toLocaleLowerCase("en").replaceAll("-","_");if(k.has(b)){return(b=k.get(b))!=null?b:h}}b=a.toLocaleLowerCase("en").replaceAll("_","-");try{a=c("bcp-47").parse(b);b=[];a.region!=null&&b.push(a.language+"_"+a.region);a.script!=null&&b.push(a.language+"_"+a.script);for(var d=0;d<b.length;d++){var e=b[d];e=j.get(e);if(e)return e}return(e=i.get(a.language))!=null?e:h}catch(a){return h}}function b(a){return c("gkx")("26259")?k.has(a.toLocaleLowerCase("en")):!1}g.DEFAULT_WA_WEB_LOCALE=h;g.LANGUAGE_TO_FB_LOCALE=i;g.EXCEPTION_LANG_REGION_TO_FB_LOCALE=j;g.DEBUG_LOCALES=k;g.coerceWAWebL10nLocaleToFBLocale=a;g.isWAWebl10nDebugLocale=b}),98);
__d("WAWebLocaleToMomentResource",[],(function(a,b,c,d,e,f){a={"zh-HK":"zh-TW",pa:"pa-IN"};b=a;f["default"]=b}),66);
__d("WAWebMomentLocales",["JSResource","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){switch(a.toLocaleLowerCase("en")){case"en-au":yield c("JSResource")("WAWebMoment-en-au").__setRef("WAWebMomentLocales").load();return!0;case"en-ca":yield c("JSResource")("WAWebMoment-en-ca").__setRef("WAWebMomentLocales").load();return!0;case"en-gb":yield c("JSResource")("WAWebMoment-en-gb").__setRef("WAWebMomentLocales").load();return!0;case"en-ie":yield c("JSResource")("WAWebMoment-en-ie").__setRef("WAWebMomentLocales").load();return!0;case"en-in":yield c("JSResource")("WAWebMoment-en-in").__setRef("WAWebMomentLocales").load();return!0;case"en-nz":yield c("JSResource")("WAWebMoment-en-nz").__setRef("WAWebMomentLocales").load();return!0;case"en-sg":yield c("JSResource")("WAWebMoment-en-sg").__setRef("WAWebMomentLocales").load();return!0;case"af":yield c("JSResource")("WAWebMoment-af").__setRef("WAWebMomentLocales").load();return!0;case"ar-dz":yield c("JSResource")("WAWebMoment-ar-dz").__setRef("WAWebMomentLocales").load();return!0;case"ar":yield c("JSResource")("WAWebMoment-ar").__setRef("WAWebMomentLocales").load();return!0;case"ar-kw":yield c("JSResource")("WAWebMoment-ar-kw").__setRef("WAWebMomentLocales").load();return!0;case"ar-ly":yield c("JSResource")("WAWebMoment-ar-ly").__setRef("WAWebMomentLocales").load();return!0;case"ar-ma":yield c("JSResource")("WAWebMoment-ar-ma").__setRef("WAWebMomentLocales").load();return!0;case"ar-sa":yield c("JSResource")("WAWebMoment-ar-sa").__setRef("WAWebMomentLocales").load();return!0;case"ar-tn":yield c("JSResource")("WAWebMoment-ar-tn").__setRef("WAWebMomentLocales").load();return!0;case"az":yield c("JSResource")("WAWebMoment-az").__setRef("WAWebMomentLocales").load();return!0;case"be":yield c("JSResource")("WAWebMoment-be").__setRef("WAWebMomentLocales").load();return!0;case"bg":yield c("JSResource")("WAWebMoment-bg").__setRef("WAWebMomentLocales").load();return!0;case"bm":yield c("JSResource")("WAWebMoment-bm").__setRef("WAWebMomentLocales").load();return!0;case"bn-bd":yield c("JSResource")("WAWebMoment-bn-bd").__setRef("WAWebMomentLocales").load();return!0;case"bn":yield c("JSResource")("WAWebMoment-bn").__setRef("WAWebMomentLocales").load();return!0;case"bo":yield c("JSResource")("WAWebMoment-bo").__setRef("WAWebMomentLocales").load();return!0;case"br":yield c("JSResource")("WAWebMoment-br").__setRef("WAWebMomentLocales").load();return!0;case"bs":yield c("JSResource")("WAWebMoment-bs").__setRef("WAWebMomentLocales").load();return!0;case"ca":yield c("JSResource")("WAWebMoment-ca").__setRef("WAWebMomentLocales").load();return!0;case"cs":yield c("JSResource")("WAWebMoment-cs").__setRef("WAWebMomentLocales").load();return!0;case"cv":yield c("JSResource")("WAWebMoment-cv").__setRef("WAWebMomentLocales").load();return!0;case"cy":yield c("JSResource")("WAWebMoment-cy").__setRef("WAWebMomentLocales").load();return!0;case"da":yield c("JSResource")("WAWebMoment-da").__setRef("WAWebMomentLocales").load();return!0;case"de-at":yield c("JSResource")("WAWebMoment-de-at").__setRef("WAWebMomentLocales").load();return!0;case"de-ch":yield c("JSResource")("WAWebMoment-de-ch").__setRef("WAWebMomentLocales").load();return!0;case"de":yield c("JSResource")("WAWebMoment-de").__setRef("WAWebMomentLocales").load();return!0;case"dv":yield c("JSResource")("WAWebMoment-dv").__setRef("WAWebMomentLocales").load();return!0;case"el":yield c("JSResource")("WAWebMoment-el").__setRef("WAWebMomentLocales").load();return!0;case"eo":yield c("JSResource")("WAWebMoment-eo").__setRef("WAWebMomentLocales").load();return!0;case"es-do":yield c("JSResource")("WAWebMoment-es-do").__setRef("WAWebMomentLocales").load();return!0;case"es":yield c("JSResource")("WAWebMoment-es").__setRef("WAWebMomentLocales").load();return!0;case"es-mx":yield c("JSResource")("WAWebMoment-es-mx").__setRef("WAWebMomentLocales").load();return!0;case"es-us":yield c("JSResource")("WAWebMoment-es-us").__setRef("WAWebMomentLocales").load();return!0;case"et":yield c("JSResource")("WAWebMoment-et").__setRef("WAWebMomentLocales").load();return!0;case"eu":yield c("JSResource")("WAWebMoment-eu").__setRef("WAWebMomentLocales").load();return!0;case"fa":yield c("JSResource")("WAWebMoment-fa").__setRef("WAWebMomentLocales").load();return!0;case"fi":yield c("JSResource")("WAWebMoment-fi").__setRef("WAWebMomentLocales").load();return!0;case"fil":yield c("JSResource")("WAWebMoment-fil").__setRef("WAWebMomentLocales").load();return!0;case"fo":yield c("JSResource")("WAWebMoment-fo").__setRef("WAWebMomentLocales").load();return!0;case"fr-ca":yield c("JSResource")("WAWebMoment-fr-ca").__setRef("WAWebMomentLocales").load();return!0;case"fr-ch":yield c("JSResource")("WAWebMoment-fr-ch").__setRef("WAWebMomentLocales").load();return!0;case"fr":yield c("JSResource")("WAWebMoment-fr").__setRef("WAWebMomentLocales").load();return!0;case"fy":yield c("JSResource")("WAWebMoment-fy").__setRef("WAWebMomentLocales").load();return!0;case"ga":yield c("JSResource")("WAWebMoment-ga").__setRef("WAWebMomentLocales").load();return!0;case"gd":yield c("JSResource")("WAWebMoment-gd").__setRef("WAWebMomentLocales").load();return!0;case"gl":yield c("JSResource")("WAWebMoment-gl").__setRef("WAWebMomentLocales").load();return!0;case"gom-deva":yield c("JSResource")("WAWebMoment-gom-deva").__setRef("WAWebMomentLocales").load();return!0;case"gom-latn":yield c("JSResource")("WAWebMoment-gom-latn").__setRef("WAWebMomentLocales").load();return!0;case"gu":yield c("JSResource")("WAWebMoment-gu").__setRef("WAWebMomentLocales").load();return!0;case"he":yield c("JSResource")("WAWebMoment-he").__setRef("WAWebMomentLocales").load();return!0;case"hi":yield c("JSResource")("WAWebMoment-hi").__setRef("WAWebMomentLocales").load();return!0;case"hr":yield c("JSResource")("WAWebMoment-hr").__setRef("WAWebMomentLocales").load();return!0;case"hu":yield c("JSResource")("WAWebMoment-hu").__setRef("WAWebMomentLocales").load();return!0;case"hy-am":yield c("JSResource")("WAWebMoment-hy-am").__setRef("WAWebMomentLocales").load();return!0;case"id":yield c("JSResource")("WAWebMoment-id").__setRef("WAWebMomentLocales").load();return!0;case"is":yield c("JSResource")("WAWebMoment-is").__setRef("WAWebMomentLocales").load();return!0;case"it-ch":yield c("JSResource")("WAWebMoment-it-ch").__setRef("WAWebMomentLocales").load();return!0;case"it":yield c("JSResource")("WAWebMoment-it").__setRef("WAWebMomentLocales").load();return!0;case"ja":yield c("JSResource")("WAWebMoment-ja").__setRef("WAWebMomentLocales").load();return!0;case"jv":yield c("JSResource")("WAWebMoment-jv").__setRef("WAWebMomentLocales").load();return!0;case"ka":yield c("JSResource")("WAWebMoment-ka").__setRef("WAWebMomentLocales").load();return!0;case"kk":yield c("JSResource")("WAWebMoment-kk").__setRef("WAWebMomentLocales").load();return!0;case"km":yield c("JSResource")("WAWebMoment-km").__setRef("WAWebMomentLocales").load();return!0;case"kn":yield c("JSResource")("WAWebMoment-kn").__setRef("WAWebMomentLocales").load();return!0;case"ko":yield c("JSResource")("WAWebMoment-ko").__setRef("WAWebMomentLocales").load();return!0;case"ku":yield c("JSResource")("WAWebMoment-ku").__setRef("WAWebMomentLocales").load();return!0;case"ky":yield c("JSResource")("WAWebMoment-ky").__setRef("WAWebMomentLocales").load();return!0;case"lb":yield c("JSResource")("WAWebMoment-lb").__setRef("WAWebMomentLocales").load();return!0;case"lo":yield c("JSResource")("WAWebMoment-lo").__setRef("WAWebMomentLocales").load();return!0;case"lt":yield c("JSResource")("WAWebMoment-lt").__setRef("WAWebMomentLocales").load();return!0;case"lv":yield c("JSResource")("WAWebMoment-lv").__setRef("WAWebMomentLocales").load();return!0;case"me":yield c("JSResource")("WAWebMoment-me").__setRef("WAWebMomentLocales").load();return!0;case"mi":yield c("JSResource")("WAWebMoment-mi").__setRef("WAWebMomentLocales").load();return!0;case"mk":yield c("JSResource")("WAWebMoment-mk").__setRef("WAWebMomentLocales").load();return!0;case"ml":yield c("JSResource")("WAWebMoment-ml").__setRef("WAWebMomentLocales").load();return!0;case"mn":yield c("JSResource")("WAWebMoment-mn").__setRef("WAWebMomentLocales").load();return!0;case"mr":yield c("JSResource")("WAWebMoment-mr").__setRef("WAWebMomentLocales").load();return!0;case"ms":yield c("JSResource")("WAWebMoment-ms").__setRef("WAWebMomentLocales").load();return!0;case"ms-my":yield c("JSResource")("WAWebMoment-ms-my").__setRef("WAWebMomentLocales").load();return!0;case"mt":yield c("JSResource")("WAWebMoment-mt").__setRef("WAWebMomentLocales").load();return!0;case"my":yield c("JSResource")("WAWebMoment-my").__setRef("WAWebMomentLocales").load();return!0;case"nb":yield c("JSResource")("WAWebMoment-nb").__setRef("WAWebMomentLocales").load();return!0;case"ne":yield c("JSResource")("WAWebMoment-ne").__setRef("WAWebMomentLocales").load();return!0;case"nl-be":yield c("JSResource")("WAWebMoment-nl-be").__setRef("WAWebMomentLocales").load();return!0;case"nl":yield c("JSResource")("WAWebMoment-nl").__setRef("WAWebMomentLocales").load();return!0;case"nn":yield c("JSResource")("WAWebMoment-nn").__setRef("WAWebMomentLocales").load();return!0;case"oc-lnc":yield c("JSResource")("WAWebMoment-oc-lnc").__setRef("WAWebMomentLocales").load();return!0;case"pa-in":yield c("JSResource")("WAWebMoment-pa-in").__setRef("WAWebMomentLocales").load();return!0;case"pl":yield c("JSResource")("WAWebMoment-pl").__setRef("WAWebMomentLocales").load();return!0;case"pt-br":yield c("JSResource")("WAWebMoment-pt-br").__setRef("WAWebMomentLocales").load();return!0;case"pt":yield c("JSResource")("WAWebMoment-pt").__setRef("WAWebMomentLocales").load();return!0;case"ro":yield c("JSResource")("WAWebMoment-ro").__setRef("WAWebMomentLocales").load();return!0;case"ru":yield c("JSResource")("WAWebMoment-ru").__setRef("WAWebMomentLocales").load();return!0;case"sd":yield c("JSResource")("WAWebMoment-sd").__setRef("WAWebMomentLocales").load();return!0;case"se":yield c("JSResource")("WAWebMoment-se").__setRef("WAWebMomentLocales").load();return!0;case"si":yield c("JSResource")("WAWebMoment-si").__setRef("WAWebMomentLocales").load();return!0;case"sk":yield c("JSResource")("WAWebMoment-sk").__setRef("WAWebMomentLocales").load();return!0;case"sl":yield c("JSResource")("WAWebMoment-sl").__setRef("WAWebMomentLocales").load();return!0;case"sq":yield c("JSResource")("WAWebMoment-sq").__setRef("WAWebMomentLocales").load();return!0;case"sr-cyrl":yield c("JSResource")("WAWebMoment-sr-cyrl").__setRef("WAWebMomentLocales").load();return!0;case"sr":yield c("JSResource")("WAWebMoment-sr").__setRef("WAWebMomentLocales").load();return!0;case"ss":yield c("JSResource")("WAWebMoment-ss").__setRef("WAWebMomentLocales").load();return!0;case"sv":yield c("JSResource")("WAWebMoment-sv").__setRef("WAWebMomentLocales").load();return!0;case"sw":yield c("JSResource")("WAWebMoment-sw").__setRef("WAWebMomentLocales").load();return!0;case"ta":yield c("JSResource")("WAWebMoment-ta").__setRef("WAWebMomentLocales").load();return!0;case"te":yield c("JSResource")("WAWebMoment-te").__setRef("WAWebMomentLocales").load();return!0;case"tet":yield c("JSResource")("WAWebMoment-tet").__setRef("WAWebMomentLocales").load();return!0;case"tg":yield c("JSResource")("WAWebMoment-tg").__setRef("WAWebMomentLocales").load();return!0;case"th":yield c("JSResource")("WAWebMoment-th").__setRef("WAWebMomentLocales").load();return!0;case"tk":yield c("JSResource")("WAWebMoment-tk").__setRef("WAWebMomentLocales").load();return!0;case"tlh":yield c("JSResource")("WAWebMoment-tlh").__setRef("WAWebMomentLocales").load();return!0;case"tl-ph":yield c("JSResource")("WAWebMoment-tl-ph").__setRef("WAWebMomentLocales").load();return!0;case"tr":yield c("JSResource")("WAWebMoment-tr").__setRef("WAWebMomentLocales").load();return!0;case"tzl":yield c("JSResource")("WAWebMoment-tzl").__setRef("WAWebMomentLocales").load();return!0;case"tzm":yield c("JSResource")("WAWebMoment-tzm").__setRef("WAWebMomentLocales").load();return!0;case"tzm-latn":yield c("JSResource")("WAWebMoment-tzm-latn").__setRef("WAWebMomentLocales").load();return!0;case"ug-cn":yield c("JSResource")("WAWebMoment-ug-cn").__setRef("WAWebMomentLocales").load();return!0;case"uk":yield c("JSResource")("WAWebMoment-uk").__setRef("WAWebMomentLocales").load();return!0;case"ur":yield c("JSResource")("WAWebMoment-ur").__setRef("WAWebMomentLocales").load();return!0;case"uz":yield c("JSResource")("WAWebMoment-uz").__setRef("WAWebMomentLocales").load();return!0;case"uz-latn":yield c("JSResource")("WAWebMoment-uz-latn").__setRef("WAWebMomentLocales").load();return!0;case"vi":yield c("JSResource")("WAWebMoment-vi").__setRef("WAWebMomentLocales").load();return!0;case"x-pseudo":yield c("JSResource")("WAWebMoment-x-pseudo").__setRef("WAWebMomentLocales").load();return!0;case"yo":yield c("JSResource")("WAWebMoment-yo").__setRef("WAWebMomentLocales").load();return!0;case"zh-cn":yield c("JSResource")("WAWebMoment-zh-cn").__setRef("WAWebMomentLocales").load();return!0;case"zh-hk":yield c("JSResource")("WAWebMoment-zh-hk").__setRef("WAWebMomentLocales").load();return!0;case"zh-mo":yield c("JSResource")("WAWebMoment-zh-mo").__setRef("WAWebMomentLocales").load();return!0;case"zh-tw":yield c("JSResource")("WAWebMoment-zh-tw").__setRef("WAWebMomentLocales").load();return!0;default:return!1}});return h.apply(this,arguments)}g.downloadAndDefineLocale=a}),98);
__d("WAWebUserPrefsLocales",["WAComms","WAWebABProps","WAWebL10NConstants","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsKeys","WAWebUserPrefsLocalStorage","WAWebUserPrefsStore"],(function(a,b,c,d,e,f,g){function a(){var a=c("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(d("WAWebUserPrefsKeys").KEYS.LANG_FROM_PHONE);return a!=null?a:c("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(d("WAWebUserPrefsKeys").KEYS.LANG)}function b(){return c("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(d("WAWebUserPrefsKeys").KEYS.LANG_FROM_USER)}function e(a){d("WAWebABProps").getABPropConfigValue("language_and_time_web")&&(c("WAWebUserPrefsLocalStorage").setItemToLocalStorage(d("WAWebUserPrefsKeys").KEYS.LANG_FROM_USER,a),d("WAComms").isSocketConnected()&&void d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").KEYS.LANG_FROM_USER,a))}function f(a){c("WAWebUserPrefsLocalStorage").setItemToLocalStorage(d("WAWebUserPrefsKeys").KEYS.LANG_FROM_PHONE,a),d("WAComms").isSocketConnected()&&void d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").KEYS.LANG_FROM_PHONE,a)}function h(a){c("WAWebUserPrefsLocalStorage").setItemToLocalStorage(d("WAWebUserPrefsKeys").KEYS.LANG_DID_MISMATCH_WITH_COOKIE,a)}function i(){var a;return(a=c("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(d("WAWebUserPrefsKeys").KEYS.LANG_DID_MISMATCH_WITH_COOKIE))!=null?a:!1}function j(){if(!d("WAWebL10NConstants").MARK_TRANSLATIONS_ENABLED)return!1;var a=c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").KEYS.MARK_TRANSLATIONS);return typeof a==="boolean"?a:d("WAWebL10NConstants").MARK_TRANSLATIONS_ENABLED}function k(a){c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.MARK_TRANSLATIONS,a)}function l(a){c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.HOUR_24_FROM_PHONE,a)}function m(a){c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.HOUR_24_FROM_DEVICE,a)}function n(){var a=c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").KEYS.HOUR_24_FROM_PHONE);if(typeof a==="boolean")return a;a=c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").KEYS.HOUR_24);typeof a==="boolean"&&c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.HOUR_24_FROM_PHONE,a);return typeof a==="boolean"?a:null}function o(){var a=c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").KEYS.HOUR_24_FROM_DEVICE);return typeof a==="boolean"?a:null}g.getPhoneLangPref=a;g.getUserLangPref=b;g.setUserLangPref=e;g.setPhoneLangPref=f;g.setLangPrefCookieDidMismatchWithUserPref=h;g.getLangPrefCookieDidMismatchWithUserPref=i;g.getMarkTranslations=j;g.setMarkTranslations=k;g.setPhoneHour24=l;g.setDeviceHour24=m;g.getPhoneHour24=n;g.getDeviceHour24=o}),98);
__d("WAWebL10N",["WALogger","WAWeb-moment","WAWebABProps","WAWebBackendApi","WAWebBaseL10N","WAWebEventsWaitForMainStreamReadyMd","WAWebL10NCoerceToFBLocale","WAWebL10NConstants","WAWebL10nGetRenderedLocale","WAWebLocaleToMomentResource","WAWebMomentLocales","WAWebUserPrefsLocales","asyncToGeneratorRuntime","bcp-47","gkx","justknobx","lodash","nullthrows"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[l10n] constructor: Mismatch between rendered locale and user-pref locale. Using cleaned user-pref locale: ","; setting cookie to: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[l10n] constructor: Mismatch between rendered locale: ","; and cleaned user-pref locale: ","; NOT setting cookie to avoid refresh loop."]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[l10n] moment locale updated to: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Could not fetch moment locales, using default en-US"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(['[l10n] _cleanRawLocaleString: "','" not compatible with Intl.NumberFormat, falling back to "','"']);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(['[l10n] _cleanRawLocaleString: loc: "','", cleaned: "','"']);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[l10n] init: with locale ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[l10n] constructor: Using pref locale as full locale: ","; rendered locale: ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[l10n] setLocale: Language change detected from "," to ",", reloading page."]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[l10n] setLocale: No language change detected (","), skipping page reload."]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[l10n] setLocale: fullLocale:",", renderedLocale:",", newLocale:",""]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[l10n] setLocale: USER TRIGGERED Language change detected from "," to ","."]);s=function(){return a};return a}var t=5e3,u=d("WAWebL10NCoerceToFBLocale").DEFAULT_WA_WEB_LOCALE.replaceAll("_","-");a=function(a){babelHelpers.inheritsLoose(e,a);function e(){var e,f;f=a.call(this,{l:"en",loc:"en"},{},!1)||this;f.$L10n4=null;f.setLocale=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){if(a==null)return;c=(c=c)!=null?c:!1;b=(b=b)!=null?b:d("WAWebL10NConstants").L10N_PRIORITY.PHONE;var e=d("WAWebABProps").getABPropConfigValue("language_and_time_web")&&b>=d("WAWebL10NConstants").L10N_PRIORITY.SAVED,g=f.normalizeLocaleToBcp47Compliant(a);if(g==null||g===f.$L10n2)return;e?d("WAWebUserPrefsLocales").setUserLangPref(a):d("WAWebUserPrefsLocales").setPhoneLangPref(a);if(d("WAWebABProps").getABPropConfigValue("language_and_time_web")&&b===d("WAWebL10NConstants").L10N_PRIORITY.PHONE&&d("WAWebUserPrefsLocales").getUserLangPref()!=null)return;e=f.$L10n1;f.$L10n2=g;a=d("WAWebL10NCoerceToFBLocale").coerceWAWebL10nLocaleToFBLocale(g);yield d("WAWebBackendApi").frontendSendAndReceive("setLocalePrefCookie",{locale:a});f.$L10n3=g;f.$L10n4=a;c===!0&&b===d("WAWebL10NConstants").L10N_PRIORITY.SAVED&&d("WALogger").LOG(s(),e,a);d("WALogger").LOG(r(),g,f.$L10n1,a);if(c!==!0)f.trigger("locale_changed_on_phone",{newLocale:a,currentLocale:e});else if(e===a)f.$L10n9.cancel(),d("WALogger").LOG(q(),e),yield f.applyMomentLocale(g),f.trigger("locale_change",{l:a,loc:g});else if(c===!0){d("WALogger").LOG(p(),e,a);f.$L10n1=a;if(b>=d("WAWebL10NConstants").L10N_PRIORITY.SAVED){f.$L10n10();return}void f.$L10n9()}});return function(b,c,d){return a.apply(this,arguments)}}();f.$L10n9=c("lodash").debounce(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield c("WAWebEventsWaitForMainStreamReadyMd")();return f.$L10n10()}),t);f.$L10n1=d("WAWebL10nGetRenderedLocale").WAWebL10nGetRenderedLocale();f.$L10n2=f.$L10n5(d("WAWebL10nGetRenderedLocale").WAWebL10nGetRenderedLocale());var g=f.$L10n6(),h=f.$L10n7();e=(e=g)!=null?e:h;h=g==null;if(e==null){d("WAWebUserPrefsLocales").setPhoneLangPref(f.$L10n1);return babelHelpers.assertThisInitialized(f)}g=f.$L10n5(e);f.$L10n3=g;if(g==null){h?d("WAWebUserPrefsLocales").setPhoneLangPref(f.$L10n1):d("WAWebUserPrefsLocales").setUserLangPref(f.$L10n1);return babelHelpers.assertThisInitialized(f)}h=d("WAWebL10NCoerceToFBLocale").coerceWAWebL10nLocaleToFBLocale(g);f.$L10n4=h;h===f.$L10n1&&(d("WALogger").LOG(o(),e,f.$L10n1),f.$L10n2=g);void f.applyMomentLocale(g);return f}var f=e.prototype;f.init=function(a){d("WALogger").LOG(n(),a);return this.setLocale(a,d("WAWebL10NConstants").L10N_PRIORITY.SAVED,!1)};f.getLocale=function(){return this.$L10n1};f.getFullLocale=function(){return!c("gkx")("26258")?d("WAWebL10NCoerceToFBLocale").isWAWebl10nDebugLocale(this.$L10n2)?u:this.$L10n2:this.$L10n2};f.getNormalizedLocale=function(){var a;return(a=this.normalizeLocaleToWajsLocale(String(this.getLocale())))!=null?a:this.getLocale()};f.getLanguage=function(){return this.$L10n8(this.getFullLocale())};f.$L10n8=function(a){return d("bcp-47").parse(a).language};f.getRegion=function(){var a;a=(a=d("bcp-47").parse(this.getFullLocale()))==null?void 0:a.region;if(a!=null)return a;a=this.$L10n1.replace(/_/g,"-");return c("nullthrows")((a=d("bcp-47").parse(a))==null?void 0:a.region)};f.$L10n6=function(){return this.normalizeLocaleToBcp47Compliant(d("WAWebUserPrefsLocales").getUserLangPref())};f.$L10n7=function(){return this.normalizeLocaleToBcp47Compliant(d("WAWebUserPrefsLocales").getPhoneLangPref())};f.normalizeLocaleToBcp47Compliant=function(a){if(a==null)return null;var b=this.$L10n5(a);if(b!==a){d("WALogger").LOG(m(),a,b);try{new Intl.NumberFormat(b)}catch(a){d("WALogger").LOG(l(),b,d("WAWebL10NCoerceToFBLocale").DEFAULT_WA_WEB_LOCALE),b=d("WAWebL10NCoerceToFBLocale").DEFAULT_WA_WEB_LOCALE.replaceAll("_","-")}}return b};f.$L10n5=function(a){return a.replace(/@.*/,"").replace(/_/g,"-")};f.$L10n10=function(){self.setTimeout(function(){window.location.reload()},100)};f.applyMomentLocale=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.toLocaleLowerCase("en");var b;if(a===d("WAWebL10NConstants").DEFAULT_MOMENT_LOCALE.toLocaleLowerCase("en"))b=a;else{var e=[];e.push(a);if(a.match(/en/i)==null){a=a.replace(/_/g,"-");e.push(a);c("WAWebLocaleToMomentResource")[a]!=null&&e.push(c("WAWebLocaleToMomentResource")[a])}e.push(this.getLanguage());e.push(u);for(a=0;a<e.length;++a){var f=(yield d("WAWebMomentLocales").downloadAndDefineLocale(e[a]));if(f){b=e[a];break}}}b==null&&(d("WALogger").WARN(k()),b=d("WAWebL10NConstants").DEFAULT_MOMENT_LOCALE);c("WAWeb-moment").locale(b);d("WALogger").LOG(j(),b);this.customizeMomentLocale(c("WAWeb-moment").locale())});function e(b){return a.apply(this,arguments)}return e}();f.customizeMomentLocale=function(a){var b=d("WAWebL10NConstants").LOCALE_CUSTOMIZATIONS[a];b&&c("WAWeb-moment").locale(a,b)};f.checkForLocaleMismatchBetweenCookieAndUserPref=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(this.$L10n1===this.$L10n4){d("WAWebUserPrefsLocales").setLangPrefCookieDidMismatchWithUserPref(!1);return}d("WAWebUserPrefsLocales").getLangPrefCookieDidMismatchWithUserPref()?d("WALogger").WARN(i(),this.$L10n1,this.$L10n3):this.$L10n4&&(d("WALogger").LOG(h(),this.$L10n3,this.$L10n4),yield d("WAWebBackendApi").frontendSendAndReceive("setLocalePrefCookie",{locale:this.$L10n4}),d("WAWebUserPrefsLocales").setLangPrefCookieDidMismatchWithUserPref(!0),c("justknobx")._("2237")||void this.$L10n9())});function e(){return a.apply(this,arguments)}return e}();return e}(d("WAWebBaseL10N").WAWebBaseL10n);e=new a();g["default"]=e}),98);
__d("WAWebAccentDiacriticRegex",[],(function(a,b,c,d,e,f){a=/(?:[\^`\xA8\xAF\xB4\xB7\xB8\u02B0-\u034E\u0350-\u0357\u035D-\u0362\u0374\u0375\u037A\u0384\u0385\u0483-\u0487\u0559\u0591-\u05A1\u05A3-\u05BD\u05BF\u05C1\u05C2\u05C4\u064B-\u0652\u0657\u0658\u06DF\u06E0\u06E5\u06E6\u06EA-\u06EC\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F5\u0818\u0819\u08E3-\u08FE\u093C\u094D\u0951-\u0954\u0971\u09BC\u09CD\u0A3C\u0A4D\u0ABC\u0ACD\u0AFD-\u0AFF\u0B3C\u0B4D\u0BCD\u0C4D\u0CBC\u0CCD\u0D3B\u0D3C\u0D4D\u0DCA\u0E47-\u0E4C\u0E4E\u0EC8-\u0ECC\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F82-\u0F84\u0F86\u0F87\u0FC6\u1037\u1039\u103A\u1087-\u108D\u108F\u109A\u109B\u17C9-\u17D3\u17DD\u1939-\u193B\u1A75-\u1A7C\u1A7F\u1AB0-\u1ABD\u1B34\u1B44\u1B6B-\u1B73\u1BAA\u1BAB\u1C36\u1C37\u1C78-\u1C7D\u1CD0-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1D2C-\u1D6A\u1DC4-\u1DCF\u1DF5-\u1DF9\u1DFD-\u1DFF\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2CEF-\u2CF1\u2E2F\u302A-\u302F\u3099-\u309C\u30FC\uA66F\uA67C\uA67D\uA67F\uA69C\uA69D\uA6F0\uA6F1\uA717-\uA721\uA788\uA7F8\uA7F9\uA8C4\uA8E0-\uA8F1\uA92B-\uA92E\uA953\uA9B3\uA9C0\uA9E5\uAA7B-\uAA7D\uAABF-\uAAC2\uAAF6\uAB5B-\uAB5F\uABEC\uABED\uFB1E\uFE20-\uFE2F\uFF3E\uFF40\uFF70\uFF9E\uFF9F\uFFE3]|\uD800\uDEE0|\uD802[\uDEE5\uDEE6]|\uD803[\uDD22-\uDD27\uDF46-\uDF50]|\uD804[\uDCB9\uDCBA\uDD33\uDD34\uDD73\uDDC0\uDDCA-\uDDCC\uDE35\uDE36\uDEE9\uDEEA\uDF3C\uDF4D\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC42\uDC46\uDCC2\uDCC3\uDDBF\uDDC0\uDE3F\uDEB6\uDEB7\uDF2B]|\uD806[\uDC39\uDC3A\uDE34\uDE47\uDE99]|\uD807[\uDC3F\uDD42\uDD44\uDD45\uDD97]|\uD81A[\uDEF0-\uDEF4]|\uD81B[\uDF8F-\uDF9F]|\uD834[\uDD67-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD]|\uD83A[\uDCD0-\uDCD6\uDD44-\uDD46\uDD48-\uDD4A])/g;b=a;f["default"]=b}),66);
__d("WAWebL10NHelpers",["WAWebABProps","WAWebAccentDiacriticRegex","WAWebL10N","latenize"],(function(a,b,c,d,e,f,g){function h(a){a===void 0&&(a="");return a.normalize("NFKD")}function a(a){a===void 0&&(a="");return c("latenize")(h(a).replace(c("WAWebAccentDiacriticRegex"),""))}function b(a){a=a.replace(/_/g,"-").split("-");return a[0].toLowerCase()}function e(a){a=a.replace(/_/g,"-").split("-");return a.length<=1?null:a[a.length-1].toUpperCase()}var i=new Set(["en-GB","en-AU","en-IN"]);function f(){var a=c("WAWebL10N").getFullLocale();return i.has(a)&&d("WAWebABProps").getABPropConfigValue("british_english_localization_enabled_web")}g.normalizeForm=h;g.removeAccents=a;g.getLanguageCodeFromLocale=b;g.getRegionCodeFromLocale=e;g.isUsingSupportedBritishEnglishLocale=f}),98);
__d("WAWebMmsMediaTypes",["WAWebInteractiveMessageHeaderMediaType","WAWebMsgGetters","WAWebMsgType","err","lodash"],(function(a,b,c,d,e,f,g){var h=Object.freeze({AUDIO:"audio",DOCUMENT:"document",GIF:"gif",IMAGE:"image",NATIVE_FLOW:"native_flow",PPIC:"ppic",PRODUCT:"product",PTT:"ptt",STICKER:"sticker",VIDEO:"video",PTV:"ptv",TEMPLATE:"template",THUMBNAIL_DOCUMENT:"thumbnail-document",THUMBNAIL_IMAGE:"thumbnail-image",THUMBNAIL_VIDEO:"thumbnail-video",THUMBNAIL_LINK:"thumbnail-link",HISTORY_SYNC:"md-msg-hist",MD_APP_STATE:"md-app-state",PRODUCT_CATALOG_IMAGE:"product-catalog-image",PAYMENT_BG_IMAGE:"payment-bg-image",BIZ_COVER_PHOTO:"biz-cover-photo",PREVIEW:"preview",NEWSLETTER_AUDIO:"newsletter-audio",NEWSLETTER_DOCUMENT:"newsletter-document",NEWSLETTER_IMAGE:"newsletter-image",NEWSLETTER_GIF:"newsletter-gif",NEWSLETTER_PTT:"newsletter-ptt",NEWSLETTER_STICKER:"newsletter-sticker",NEWSLETTER_THUMBNAIL_LINK:"newsletter-thumbnail-link",NEWSLETTER_VIDEO:"newsletter-video",NATIVE_AD_IMAGE:"ads-image",STICKER_PACK:"sticker-pack",THUMBNAIL_STICKER_PACK:"thumbnail-sticker-pack",MUSIC_ARTWORK:"music-artwork"});e=c("lodash").values(h);function a(a){var b;if(a==null)b=h.DOCUMENT;else if(a in h)b=h[a];else throw c("err")("castToV4: unexpected mmsv3 type "+a);return b}function i(a){var b=a.type,e=a.isGif,f=a.interactiveHeader;a=a.isNewsletter;switch(b){case d("WAWebMsgType").MSG_TYPE.IMAGE:return a?h.NEWSLETTER_IMAGE:h.IMAGE;case d("WAWebMsgType").MSG_TYPE.VIDEO:return a?e===!0?h.NEWSLETTER_GIF:h.NEWSLETTER_VIDEO:e===!0?h.GIF:h.VIDEO;case d("WAWebMsgType").MSG_TYPE.AUDIO:return a?h.NEWSLETTER_AUDIO:h.AUDIO;case d("WAWebMsgType").MSG_TYPE.PTT:return a?h.NEWSLETTER_PTT:h.PTT;case d("WAWebMsgType").MSG_TYPE.PTV:return h.PTV;case d("WAWebMsgType").MSG_TYPE.DOCUMENT:return h.DOCUMENT;case d("WAWebMsgType").MSG_TYPE.STICKER_PACK:return h.STICKER_PACK;case d("WAWebMsgType").MSG_TYPE.STICKER:return a?h.NEWSLETTER_STICKER:h.STICKER;case d("WAWebMsgType").MSG_TYPE.PRODUCT:return h.PRODUCT;case d("WAWebMsgType").MSG_TYPE.NATIVE_FLOW:return h.NATIVE_FLOW;case d("WAWebMsgType").MSG_TYPE.INTERACTIVE:if((f==null?void 0:f.mediaType)!=null)switch(f.mediaType){case d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.DOCUMENT:return h.DOCUMENT;case d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.VIDEO:return h.VIDEO;case d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.IMAGE:return h.IMAGE}break}throw c("err")("msg is not a media msg: "+b+", isGif="+String(e))}function b(a){return i({type:a.type,interactiveHeader:a.interactiveHeader,isGif:a.type===d("WAWebMsgType").MSG_TYPE.VIDEO?a.isGif:!1,isNewsletter:d("WAWebMsgGetters").getIsNewsletterMsg(a)})}g.MEDIA_TYPES=h;g.MEDIA_TYPE_VALUES=e;g.castToV4=a;g.msgToMediaType=i;g.getMsgMediaType=b}),98);
__d("WAWebMediaCryptoEligibilityUtils",["WAWebMmsMediaTypes","WAWebMsgGetters"],(function(a,b,c,d,e,f,g){function a(a){return a.isNewsletter?!1:!0}function b(a){return d("WAWebMsgGetters").getIsNewsletterMsg(a)?!1:!0}var h=new Set([(f=d("WAWebMmsMediaTypes")).MEDIA_TYPES.NEWSLETTER_AUDIO,f.MEDIA_TYPES.NEWSLETTER_DOCUMENT,f.MEDIA_TYPES.NEWSLETTER_GIF,f.MEDIA_TYPES.NEWSLETTER_IMAGE,f.MEDIA_TYPES.NEWSLETTER_PTT,f.MEDIA_TYPES.NEWSLETTER_STICKER,f.MEDIA_TYPES.NEWSLETTER_THUMBNAIL_LINK,f.MEDIA_TYPES.NEWSLETTER_VIDEO]);function i(a){return h.has(a)}function c(a){return i(a)?!1:!0}function e(a){return i(a)?!1:!0}g.isMediaCryptoExpectedForChat=a;g.isMediaCryptoExpectedForMsg=b;g.isMediaCryptoExpectedForMediaType=c;g.isRmrSupportedForMediaType=e}),98);
__d("WAWebBaseMirror",["lodash"],(function(a,b,c,d,e,f,g){function a(a){var b={},c=0,d=function(a){b["change:"+a]=c++};a.props&&Object.keys(a.props).forEach(d);a.session&&Object.keys(a.session).forEach(d);a.derived&&Object.keys(a.derived).forEach(d);return b}var h="change",i=32;function b(a,b){var c=[];for(var d=0;d<b.length;d++){var e=a["change:"+b[d]],f=Math.floor(e/i);e=e%i;k(c,f+1);c[f]|=1<<e}return c}d=function(){function a(a){this.state=a}var b=a.prototype;b.destructor=function(){this.state.off("all",this.onGatherEvent,this)};b.initListener=function(){this.state.on("all",this.onGatherEvent,this),this.masks=[],this.listeners=[],this.changeEvents=[]};b.onGatherEvent=function(a){if(a===h){var b=this.changeEvents;if(!b.filter(Boolean).length)return;this.onChange();this.changeEvents=[]}else{b=this.state.mirrorMask[a];if(b===void 0)return;a=b/i|0;b=b%i|0;k(this.changeEvents,a+1);this.changeEvents[a]|=1<<b}};b.onChange=function(){if(this.listeners==null)return;var a=this.state,b=this.changeEvents;c("lodash").zip(this.masks,this.listeners).forEach(function(c){var d=c[0];c=c[1];var e=Math.min(b.length,d.length);for(var f=0;f<e;f++)if(b[f]&d[f]){var g=c[0],h=c[1];g!=null&&h!=null&&g(h,a);break}})};b.addListener=function(a,b,c){this.listeners||this.initListener();this.masks.push(b);(b=this.listeners)==null?void 0:b.push([a,c])};b.removeListener=function(a){var b=this.listeners;if(b==null)return;for(var c=0;c<b.length;c++)b[c][0]===a&&(b[c][0]=null,b[c][1]=null,j(this.masks,c),j(b,c))};return a}();function j(a,b){a[b]=a[a.length-1],a.pop()}function k(a,b){if(b<=a.length)return;b=b-a.length;for(var c=0;c<b;c++)a.push(0)}g.genMirrorMask=a;g.genBitMask=b;g.BaseMirror=d}),98);
/**
 * License: https://www.facebook.com/legal/license/MDzNl_j9yvg/
 */
__d("toposort-1.0.3",[],(function(a,b,c,d,e,f){"use strict";a={};var g={exports:a};function h(){g.exports=a=function(a){return b(c(a),a)};a.array=b;function b(a,b){var c=a.length,d=new Array(c),e={},f=c;while(f--)e[f]||g(a[f],f,[]);return d;function g(h,f,i){if(i.indexOf(h)>=0)throw new Error("Cyclic dependency: "+JSON.stringify(h));if(!~a.indexOf(h))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(h));if(e[f])return;e[f]=!0;var j=b.filter(function(a){return a[0]===h});if(f=j.length){i=i.concat(h);do{var k=j[--f][1];g(k,a.indexOf(k),i)}while(f)}d[--c]=h}}function c(a){var b=[];for(var c=0,d=a.length;c<d;c++){var e=a[c];b.indexOf(e[0])<0&&b.push(e[0]);b.indexOf(e[1])<0&&b.push(e[1])}return b}}var i=!1;function j(){i||(i=!0,h());return g.exports}function b(a){switch(a){case void 0:return j()}}e.exports=b}),null);
__d("toposort",["toposort-1.0.3"],(function(a,b,c,d,e,f){e.exports=b("toposort-1.0.3")()}),null);
__d("WAWebModelUtils",["WANullthrows","WATypeUtils","err","lodash","toposort"],(function(a,b,c,d,e,f,g){var h={sentinel:"DEFAULT VALUE PLACEHOLDER"},i={PROP:"PROP",SESSION:"SESSION",DERIVED:"DERIVED"},j=Symbol("NO_DEFAULT_VALUE"),k={PROPS:"Props",SESSION:"Session",DERIVED:"Derived",GETTER:"Getter",COLLECTION:"Collection"};function a(a){a===void 0&&(a=j);a={defaultValue:a,type:k.PROPS};return a}function b(a){a===void 0&&(a=j);a={defaultValue:a,type:k.SESSION};return a}function e(a,b){a={fn:a,deps:b,type:k.DERIVED};return a}function f(a){a={fn:a,type:k.GETTER};return a}function l(a){a={val:a,type:k.COLLECTION};return a}function m(a){a=a.defaultValue;return a===j?{}:{defaultValue:a}}var n="__x_";function o(a){return n+a}function p(a,b,e,f){if(!c("lodash").isObject(e))throw c("err")("Invalid Prop/Session definition.");var g={sk:o(b),evt:"change:"+b,attr:f};e.defaultValue!==void 0&&(g.defaultValue=e.defaultValue);a._definition[b]=g;var i=d("WATypeUtils").isFunction(g.defaultValue);if(g.defaultValue!=null&&!i)if(Array.isArray(g.defaultValue))throw c("err")("Do not return mutable types as default values as they are shared. Type: Array provided.");else if(c("lodash").isObject(g.defaultValue))throw c("err")("Do not return mutable types as default values as they are shared. Type: Object provided.");var j=g.sk;Object.defineProperty(a,b,{set:function(a){this.set(b,a)},get:function(){var a=this[j];if(a!==h)return a;return i?this[j]=g.defaultValue():g.defaultValue}})}function q(a,b,c){var d=o(b),e=c.fn;a._definition[b]=a._derived[b]={sk:d,evt:"change:"+b,attr:i.DERIVED,fn:e,deps:c.deps};Object.defineProperty(a,b,{get:function(){var a=this[d];if(a!==h)return a;a=e.call(this);this[d]=a;return a},set:function(){throw new TypeError("'"+b+"' is a derived property, it can't be set directly.")}})}function r(a){var b=[];for(var c in a){if(typeof a[c]==="function")continue;b.push([c,a[c]])}return b}function s(a){var b={},c=Object.getPrototypeOf({}),d=a;Object.getOwnPropertyNames(d).forEach(function(a){if(typeof d[a]!=="function")return;b[a]=d[a]});while((d=Object.getPrototypeOf(d))&&d!==c)Object.getOwnPropertyNames(d).forEach(function(a){if(a in b)return;b[a]=d[a]});return b}function t(a){var b=new a({},{_internalInitializationDoNotUse:!0}),d={name:a.name||"Unknown",props:{},session:{},derived:{},collections:{},isIdType:a.isIdType};a.Collection&&(d.Collection=a.Collection);a.idClass&&(d.idClass=a.idClass);a.allowedIds&&(d.allowedIds=a.allowedIds);var e=new Set(["constructor"]),f=new Set(["collection","parent","revisionNumber","__changes","__fired","__initialized"]),g=new Map(r(b).filter(function(a){var b=a[0];a=a[1];return!f.has(b)&&(a==null?void 0:a.type)===k.GETTER}).map(function(a){var b=a[0];a=a[1].fn;return[a,b]})),h=c("lodash").memoize(function(a){a=c("lodash").flatMap((a=a.dependencies)!=null?a:[],function(a){if(a.dependencyKey!=null)return[a.dependencyKey];var b=g.get(a);return b!=null?[b]:h(a)});return Array.from(new Set(a))});r(b).forEach(function(b){var g=b[0];b=b[1];if(f.has(g)||b==null)return;switch(b.type){case k.PROPS:d.props[g]=m(b);break;case k.SESSION:d.session[g]=m(b);break;case k.DERIVED:d.derived[g]=c("lodash").omit(b,"type");e.add(b.fn.name);break;case k.GETTER:var i=b.fn;d.derived[g]={fn:function(){return i(this)},deps:h(i)};e.add(i.name);break;case k.COLLECTION:d.collections[g]=b.val;break;default:throw c("err")("Invalid defineModel Class type for "+a.name+":"+g+".")}});var i=s(b);e.forEach(function(a){delete i[a]});Object.assign(d,i);return d}function u(a,b){var c;a=(c={},c[b]=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(a),c)[b];return a}function v(a,b){var d,e=c("WANullthrows")(b.name);delete b.name;a=u(a,e);var f=a.prototype,g=f.__props=[],j=f.__session=[],k=f.__derived=[],l=f._collections={};e=f._definition={};var m=f._derived={},n=["props","session","derived","collections"];(d=c("lodash")).forOwn(b.props,function(a,b){g.push(b),p(f,b,a,i.PROP)});d.forOwn(b.session,function(a,b){j.push(b),p(f,b,a,i.SESSION)});d.forOwn(b.derived,function(a,b){k.push(b),q(f,b,a)});d.forOwn(b.collections,function(a,b){l[b]=a});Object.assign(f,d.omit(b,n));var o=g.concat(j),r=o.length;Object.defineProperties(f,{attributes:{get:function(){var a={};for(var b=0;b<r;++b)a[o[b]]=this[o[b]];return a}},isState:{get:function(){return!0},set:function(){throw c("err")("attempt to set isState")}}});d={};for(b=0;b<r;b++){n=o[b];"defaultValue"in e[n]&&(d[n]=h)}c("lodash").isEmpty(d)||(f.__defaults=d);if(k.length){var s=[],t={},v={};c("lodash").forOwn(m,function(a,b){v[b]=!0,c("lodash").forOwn(a.deps,function(a){v[a]=!0,(t[a]||(t[a]=[])).push(b),s.push([b,a])})});s.length&&(f._deps=t,f._topo=c("toposort").array(Object.keys(v),s).reverse(),f._topoIndexMap=new Map(f._topo.map(function(a,b){return[a,b]})))}return a}g.INIT=h;g.Attr=i;g.prop=a;g.session=b;g.derived=e;g.getter=f;g.collection=l;g.convert=t;g.stateExtend=v}),98);
__d("WAWebProxyStateFactory",["WACustomError","WALogger","gkx"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(['Cannot write proxy property "',".",'" created in <',"/>. Make sure it is in your list of concerns."]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(['Cannot read proxy property "',".",'" created in <',"/>. Make sure it is in your list of concerns."]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(['Cannot read proxy property "',".",'" created in <',"/>. Make sure it is in your list of concerns."]);j=function(){return a};return a}var k=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}return a}(d("WACustomError").customError("DuplicatedProxyProperty")),l={};a=function(a,b,e){var f=b.props,g=b.session,m=b.collections,n=b.derived;b=babelHelpers.objectWithoutPropertiesLoose(b,["props","session","collections","derived"]);var o=function(a){this.$ProxyState$state=a},p={};[f,g,m,n].forEach(function(b){if(!b)return;Object.keys(b).forEach(function(b){p[b]={get:function(){c("gkx")("26258")?d("WALogger").WARN(j(),a,b,this.$ProxyState$ComponentName):d("WALogger").ERROR(i(),a,b,this.$ProxyState$ComponentName).sendLogs("Invalid ProxyState Access");return this.$ProxyState$state[b]},set:function(c){d("WALogger").ERROR(h(),a,b,this.$ProxyState$ComponentName).sendLogs("Invalid ProxyState Write"),this.$ProxyState$state[b]=c}}})});p.proxyName={value:a};p.mirrorMask={value:e};["set","get"].concat(Object.keys(b)).forEach(function(a){p[a]={value:function(){var b=this.$ProxyState$state;return b[a].apply(b,arguments)}}});o.prototype=Object.create(null,p);o.prototype.constructor=o;if(a in l)throw new k('Duplicated proxy property "'+a+'".');l[a]=o};g.ProxyStates=l;g.ProxyStateFactory=a}),98);
__d("WAWebBaseModel",["WALogger","WANullthrows","WATypeUtils","WAWebBaseMirror","WAWebCmd","WAWebEventEmitter","WAWebModelUtils","WAWebNetworkStatus","WAWebProxyStateFactory","cr:5292","err","gkx"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["\t",":"],["\\t",":"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["derived:"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["\t",":"],["\\t",":"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["session:"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["\t",":"],["\\t",":"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["props:"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Detected UI change inside a transaction in model ",".\n      This can result in a consistency issue. See https://fburl.com/aleoj4tt item #1 for details."]);n=function(){return a};return a}function a(a){return typeof a==="string"?a:a.toString()}var o=/^change:/,p=function(e){babelHelpers.inheritsLoose(a,e);function a(a,b){var c;b===void 0&&(b={});c=e.call(this)||this;c.stale=d("WAWebModelUtils").session(!1);c.revisionNumber=1;c.__fired=null;c.__changes=null;c.__initialized=!1;if(b._internalInitializationDoNotUse)return babelHelpers.assertThisInitialized(c);c.stale=(a==null?void 0:a.stale)||c.getDefault("stale")===!0;c.parent=b.parent;c.collection=b.collection;c._initDeriveds();c._initCollections();var f=c.__defaults;f=f?babelHelpers["extends"]({},f,a):a;f&&!q(f)&&c.set(f,babelHelpers["extends"]({silent:!0},b));c.initialize();c.__initialized=!0;return c}var f=a.prototype;f.initialize=function(){if(this.collection&&this.id&&!this.collection.modelClass.prototype.isIdType(this.id)){var a=this.collection?typeof this.collection.modelClass.prototype.idClass:"N/A";throw c("err")("Model id:"+String(this.id)+" is wrong type ("+typeof this.id+" vs expected "+a+")")}this._uiObservers=0;this.mirrorMask&&(this.mirror=new(d("WAWebBaseMirror").BaseMirror)(this))};f._refreshStaleModel=function(){if(!this._uiObservers&&this.stale)return;if(this.getCollection)this.getCollection().find(this.id);else throw c("err")("base_model:_refreshStaleModel getCollection does not exist")};f.incObservers=function(a){this._uiObservers++;if(a)return;c("WAWebNetworkStatus").online&&this.stale&&(d("WAWebCmd").Cmd.uiBusy?this.listenToOnce(d("WAWebCmd").Cmd,"ui_idle",this._refreshStaleModel):this._refreshStaleModel())};f.decObservers=function(){this._uiObservers>0&&this._uiObservers--,this._uiObservers===0&&this.stopListening(d("WAWebCmd").Cmd,"ui_idle",this._refreshStaleModel)};f.hasObservers=function(){return this._uiObservers>0};f.getObservers_TEST_ONLY=function(){return null};f.addChild=function(a,b){var c={};c[a]=b;this.set(c,{silent:!0});this.listenTo(b,"all",this._getCachedEventBubblingHandler(a))};f.get=function(a){return this[a]};f.set=function(a,e,f){!c("gkx")("26258")&&(b("cr:5292")==null?void 0:b("cr:5292").currentTransaction)&&d("WALogger").WARN(n(),this.constructor.name);f=f;if(typeof a==="string")return this._set(a,e,f);f=e;return((e=f)==null?void 0:e.merge)?this._set(r(a),f):this._set(a,f)};f._markChange=function(a,b){if(!this.__initialized)return;this._getChanges().push({key:a,oldValue:b});this.__fired&&(this.__fired[a]=!1)};f._set=function(a,b,e){var f,g=this;this.revisionNumber++;var h=!!this.__changes;f=d("WATypeUtils").isString(a)?[(f={},f[a]=b,f),e]:[a,b];var i=f[0],j=f[1],k=new Set();Object.keys(i).forEach(function(a){a=g._setKV(a,i[a],j);a==null?void 0:a.forEach(function(a){k.add(a)})});k.size>0&&(function(){var a=c("WANullthrows")(g._topo,"_topo unexpectedly undefined"),b=c("WANullthrows")(g._topoIndexMap),d=function(d){var e=a[d];if(!k.has(e))return"continue";e=g._setD(e);e==null?void 0:e.forEach(function(a){var e=c("WANullthrows")(b.get(a));if(e<d)throw c("err")("Circular derived properties / event listeners");k.add(a)})};for(var e=0;e<a.length;e++){var f=d(e);if(f==="continue")continue}})();e=j==null?void 0:j.silent;if(!e&&this.hasUnfiredChanges()){a=this.__fired={};b=this._getChanges();f=b.length>0;while(b.length){e=b.shift();var l=e.key;e=e.oldValue;if(!a[l]){a[l]=!0;var m=this._definition[l].evt;if(this.isListening(m)||this.isListening("all")){l=this[l];this.trigger(m,this,l,e)}}}(f&&this.isListening("change")||this.isListening("all"))&&this.trigger("change",this)}h||(this.__changes&&(this.__changes=null),this.__fired&&(this.__fired=null));return this};f._setKV=function(a,b,e){if(this._collections[a]){this[a].set(b,e);return}e=this._definition[a];if(!e){this[a]=b;return}else if(e.attr===d("WAWebModelUtils").Attr.DERIVED)throw c("err")("Attempting to directly set derived property: "+a);e=e.sk;var f=this[a];if(b===f)return;this[e]=b;this._markChange(a,f);return(e=this._deps)==null?void 0:e[a]};f._setD=function(a){var b=this._definition[a],c=b.sk;b=b.fn.call(this);var d=this[c];if(b===d)return;this[c]=b;this._markChange(a,d);return(c=this._deps)==null?void 0:c[a]};f.hasUnfiredChanges=function(){var a=this.__fired,b=this.__changes;if(!b)return!1;if(!a)return!0;for(var c=0;c<b.length;c++)if(!a[b[c].key])return!0;return!1};f._getChanges=function(){return this.__changes||(this.__changes=[])};f._initDeriveds=function(){var a=this;this.__derived.forEach(function(b){a[a._definition[b].sk]=d("WAWebModelUtils").INIT})};f._initCollections=function(){var a=this;Object.entries(this._collections).forEach(function(b){var c=b[0];b=b[1];a[c]=new b(null,{parent:a})})};f.unset=function(a,b){a=Array.isArray(a)?a:[a];var c={};for(var a=a,d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;c[f]=void 0}this.set(c,b)};f.clear=function(){this.unset([].concat(this.__props,this.__session))};f["delete"]=function(){this.stopListening()};f.reset=function(){this.set(this.__defaults)};f.toJSON=function(){return this.serialize()};f.serialize=function(){var a=this,b={};for(var c=0;c<this.__props.length;c++)b[this.__props[c]]=this[this.__props[c]];Object.keys(this._collections).forEach(function(c){b[c]=a[c].serialize()});return b};f.getDefault=function(a){a=this._definition[a];if(!a)return void 0;a=a.defaultValue;return d("WATypeUtils").isFunction(a)?a():a};f._getCachedEventBubblingHandler=function(a){return function(b,c,d){o.test(b)?this.trigger("change:"+a+"."+b.split(":")[1],c,d):b==="change"&&this.trigger("change",this)}.bind(this)};a.isIdType=function(a){if(this.allowedIds&&this.allowedIds.includes(a))return!0;return this.idClass?a instanceof this.idClass:typeof a==="string"};f.pp=function(){var a=this;if(!c("gkx")("26258")){var b="#cc3333",e="#33cc33",f="#3333cc";this.__props.length&&d("WALogger").LOG(m()).color(b);this.__props.forEach(function(c){var e=a[c];d("WALogger").LOG(l(),c).color(b).devConsole(e)});this.__session.length&&d("WALogger").LOG(k()).color(e);this.__session.forEach(function(b){var c=a[b];d("WALogger").LOG(j(),b).color(e).devConsole(c)});this.__derived.length&&d("WALogger").LOG(i()).color(f);this.__derived.forEach(function(b){var c=a[b];d("WALogger").LOG(h(),b).color(f).devConsole(c)})}};return a}(c("WAWebEventEmitter"));function e(a){var b=d("WAWebModelUtils").convert(a),c=d("WAWebModelUtils").stateExtend(p,b);if(a.Proxy){var e=d("WAWebBaseMirror").genMirrorMask(b);c.prototype.mirrorMask=e;c.prototype.proxyName=a.Proxy;d("WAWebProxyStateFactory").ProxyStateFactory(a.Proxy,b,e)}return c}function q(a){for(var b in a)if(Object.prototype.hasOwnProperty.call(a,b))return!1;return!0}function r(a){var b=Object.keys(a),c=b.length,d={};for(var e=0;e<c;e++){var f=b[e];a[f]!==void 0&&(d[f]=a[f])}return d}g.prop=(f=d("WAWebModelUtils")).prop;g.session=f.session;g.derived=f.derived;g.getter=f.getter;g.collection=f.collection;g.idTypeToString=a;g.BaseModel=p;g.defineModel=e}),98);
__d("WAWebMsgDataUtils",["WANullthrows","WATimeUtils","WAWebAck","WAWebBizGatingUtils","WAWebBotTypes","WAWebCommonMsgUtils","WAWebMsgKey","WAWebMsgType","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){var b=a.type,e=a.subtype,f;b===d("WAWebMsgType").MSG_TYPE.GP2?e==="subject"?f=d("WAWebCommonMsgUtils").EventType.NOTEWORTHY:e==="add"||e==="invite"||e==="invite_auto_add"||e==="linked_group_join"||e==="community_invite_auto_add_rich"?a.recipients&&d("WAWebUserPrefsMeUser").isMePrimary(a.recipients[0])?f=d("WAWebCommonMsgUtils").EventType.SIGNIFICANT:f=d("WAWebCommonMsgUtils").EventType.IGNORE:e==="community_owner_update"?a.recipients&&d("WAWebUserPrefsMeUser").isMePrimary(a.recipients[0])?f=d("WAWebCommonMsgUtils").EventType.DEFAULT:f=d("WAWebCommonMsgUtils").EventType.IGNORE:e==="linked_group_promote"||e==="linked_group_demote"?c("WAWebWid").isGroup(a.id.remote)&&a.recipients&&d("WAWebUserPrefsMeUser").isMePrimary(a.recipients[0])&&!d("WAWebUserPrefsMeUser").isMeAccount(a.author)?f=d("WAWebCommonMsgUtils").EventType.SIGNIFICANT:f=d("WAWebCommonMsgUtils").EventType.IGNORE:e==="remove"?a.recipients&&d("WAWebUserPrefsMeUser").isMePrimary(a.recipients[0])?f=d("WAWebCommonMsgUtils").EventType.NOTEWORTHY:f=d("WAWebCommonMsgUtils").EventType.IGNORE:e==="create"||e==="empty_subgroup_create"||e==="general_chat_add"?f=d("WAWebCommonMsgUtils").EventType.NOTEWORTHY:e==="created_subgroup_suggestion"?f=d("WAWebCommonMsgUtils").EventType.DEFAULT:e==="parent_group_link"||e==="auto_add"||e==="default_sub_group_admin_add"||e==="community_participant_add_rich"||e==="subgroup_admin_triggered_auto_add"||e==="subgroup_admin_triggered_invite_auto_add"||e==="sibling_group_link"||e==="community_invite_rich"||e==="sub_group_participant_add_rich"||e==="sub_group_invite_rich"||e==="community_link_parent_group_rich"?f=d("WAWebCommonMsgUtils").EventType.SIGNIFICANT:e==="membership_approval_request"||e==="created_membership_requests"?f=d("WAWebCommonMsgUtils").EventType.NOTEWORTHY:e==="sibling_group_unlink"?f=d("WAWebCommonMsgUtils").EventType.NOTEWORTHY:f=d("WAWebCommonMsgUtils").EventType.IGNORE:b===d("WAWebMsgType").MSG_TYPE.BROADCAST_NOTIFICATION||b===d("WAWebMsgType").MSG_TYPE.NOTIFICATION||b===d("WAWebMsgType").MSG_TYPE.E2E_NOTIFICATION?e==="create"?f=d("WAWebCommonMsgUtils").EventType.NOTEWORTHY:f=d("WAWebCommonMsgUtils").EventType.IGNORE:b===d("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE&&d("WAWebUserPrefsMeUser").isMePrimary(a.from)?f=d("WAWebCommonMsgUtils").EventType.IGNORE:b===d("WAWebMsgType").MSG_TYPE.CALL_LOG?f=d("WAWebCommonMsgUtils").EventType.NOTEWORTHY:a.broadcast?c("WAWebWid").isBroadcast(a.id.remote)?f=d("WAWebCommonMsgUtils").EventType.NOTEWORTHY:f=d("WAWebCommonMsgUtils").EventType.IGNORE:b===d("WAWebMsgType").MSG_TYPE.REVOKED?f=d("WAWebCommonMsgUtils").EventType.IGNORE:c("WAWebWid").isPSA(a.id.remote)?f=a.ack===d("WAWebAck").ACK.RECEIVED?d("WAWebCommonMsgUtils").EventType.DEFAULT:d("WAWebCommonMsgUtils").EventType.AMBIENT:b===d("WAWebMsgType").MSG_TYPE.CIPHERTEXT||b===d("WAWebMsgType").MSG_TYPE.OVERSIZED?f=d("WAWebCommonMsgUtils").EventType.AMBIENT:b===d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE?e==="sender_invite"||(e==="chat_assignment"||e==="chat_assignment_unassign")&&d("WAWebBizGatingUtils").shouldReorderChatOnAssignment(e==="chat_assignment_unassign")?f=d("WAWebCommonMsgUtils").EventType.NOTEWORTHY:f=d("WAWebCommonMsgUtils").EventType.IGNORE:b===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&e==="ephemeral_setting"?f=d("WAWebCommonMsgUtils").EventType.IGNORE:b===d("WAWebMsgType").MSG_TYPE.REACTION?f=d("WAWebCommonMsgUtils").EventType.IGNORE:f=d("WAWebCommonMsgUtils").EventType.DEFAULT;return f}function e(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=a.id,f=c("WANullthrows")(d("WAWebUserPrefsMeUser").getMaybeMeLidUser()),g=a.id.isLid()?f:d("WAWebUserPrefsMeUser").getMaybeMeUser(),h=void 0;if(a.isGroup){var i;g=((i=a.groupMetadata)==null?void 0:i.isLidAddressingMode)===!0?f:d("WAWebUserPrefsMeUser").getMaybeMeUser();h=d("WAWebWidFactory").toUserWid(g)}else a.id.isStatus()&&(h=d("WAWebUserPrefsMeUser").assertGetMeUser());i=new(c("WAWebMsgKey"))({from:g,to:e,id:yield c("WAWebMsgKey").newId(),participant:h,selfDir:"out"});h=(f=a.contact.businessProfile)==null?void 0:f.automatedType;var j;if(h)switch(h){case d("WAWebBotTypes").BizBotAutomatedType.PARTIAL_1P:j=d("WAWebBotTypes").BizBotType.BIZ_1P;break;case d("WAWebBotTypes").BizBotAutomatedType.FULL_3P:j=d("WAWebBotTypes").BizBotType.BIZ_3P;break;case d("WAWebBotTypes").BizBotAutomatedType.UNKNOWN:j=null}return{id:i,from:c("WANullthrows")(g),to:e,type:b,t:d("WATimeUtils").unixTime(),viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,isNewMsg:!0,local:!0,ack:d("WAWebAck").ACK.CLOCK,bizBotType:j}});return h.apply(this,arguments)}g.eventTypeFromMsgType=a;g.genOutgoingMsgData=e}),98);
__d("WAWebWamMsgUtils",["WAWebApiParse","WAWebBotTypes","WAWebHandleMsgCommon","WAWebInteractiveMessageType","WAWebMsgGetters","WAWebProtobufsE2E.pb","WAWebUserPrefsMeUser","WAWebWamEnumAgentEngagementEnumType","WAWebWamEnumBotType","WAWebWamEnumE2eDeviceType","WAWebWamEnumInvisibleMessageCategoryType","WAWebWamEnumMediaType","WAWebWamEnumMessageType","WAWebWid"],(function(a,b,c,d,e,f,g){function a(a){if(d("WAWebMsgGetters").getIsStatus(a))return d("WAWebWamEnumMessageType").MESSAGE_TYPE.STATUS;else if(d("WAWebMsgGetters").getIsGroupMsg(a))return d("WAWebWamEnumMessageType").MESSAGE_TYPE.GROUP;else if(c("WAWebWid").isBroadcast(a.id.remote))return d("WAWebWamEnumMessageType").MESSAGE_TYPE.BROADCAST;else if(c("WAWebWid").isNewsletter(a.id.remote))return d("WAWebWamEnumMessageType").MESSAGE_TYPE.CHANNEL;return d("WAWebWamEnumMessageType").MESSAGE_TYPE.INDIVIDUAL}function b(a){switch(a){case"chat":return d("WAWebWamEnumMessageType").MESSAGE_TYPE.INDIVIDUAL;case"group":return d("WAWebWamEnumMessageType").MESSAGE_TYPE.GROUP;case"peer_broadcast":case"other_broadcast":return d("WAWebWamEnumMessageType").MESSAGE_TYPE.BROADCAST;case"direct_peer_status":case"other_status":return d("WAWebWamEnumMessageType").MESSAGE_TYPE.STATUS}}function e(a){if(a.isDynamicReplyButtonsMsg===!0)return d("WAWebWamEnumMediaType").MEDIA_TYPE.BUTTON_MESSAGE;switch(a.type){case"image":return d("WAWebWamEnumMediaType").MEDIA_TYPE.PHOTO;case"video":return a.isGif===!0?d("WAWebWamEnumMediaType").MEDIA_TYPE.GIF:d("WAWebWamEnumMediaType").MEDIA_TYPE.VIDEO;case"ptv":return d("WAWebWamEnumMediaType").MEDIA_TYPE.PUSH_TO_VIDEO;case"audio":return d("WAWebWamEnumMediaType").MEDIA_TYPE.AUDIO;case"ptt":return d("WAWebWamEnumMediaType").MEDIA_TYPE.PTT;case"document":return d("WAWebWamEnumMediaType").MEDIA_TYPE.DOCUMENT;case"unknown":return d("WAWebWamEnumMediaType").MEDIA_TYPE.FUTURE;case"location":return a.isLive===!0?d("WAWebWamEnumMediaType").MEDIA_TYPE.LIVE_LOCATION:d("WAWebWamEnumMediaType").MEDIA_TYPE.LOCATION;case"vcard":return d("WAWebWamEnumMediaType").MEDIA_TYPE.CONTACT;case"multi_vcard":return d("WAWebWamEnumMediaType").MEDIA_TYPE.CONTACT_ARRAY;case"chat":if(a.matchedText!=null){if(d("WAWebApiParse").matchCatalogUrl(a.matchedText))return d("WAWebWamEnumMediaType").MEDIA_TYPE.CATALOG_LINK;else if(d("WAWebApiParse").matchProductUrl(a.matchedText))return d("WAWebWamEnumMediaType").MEDIA_TYPE.PRODUCT_LINK;return d("WAWebWamEnumMediaType").MEDIA_TYPE.URL}return d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"sticker":return d("WAWebWamEnumMediaType").MEDIA_TYPE.STICKER;case"product":return d("WAWebWamEnumMediaType").MEDIA_TYPE.PRODUCT_IMAGE;case"list":var b;b=(b=(b=a.list)==null?void 0:b.listType)!=null?b:d("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.UNKNOWN;switch(b){case d("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.SINGLE_SELECT:return d("WAWebWamEnumMediaType").MEDIA_TYPE.LIST;case d("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.PRODUCT_LIST:return d("WAWebWamEnumMediaType").MEDIA_TYPE.PRODUCT_LIST;default:return d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE}case"list_response":return d("WAWebWamEnumMediaType").MEDIA_TYPE.LIST_REPLY;case"buttons_response":return d("WAWebWamEnumMediaType").MEDIA_TYPE.BUTTON_RESPONSE_MESSAGE;case"order":return d("WAWebWamEnumMediaType").MEDIA_TYPE.ORDER;case"interactive":return h(a.interactiveType);case"reaction":case"reaction_enc":return d("WAWebWamEnumMediaType").MEDIA_TYPE.REACTION;case"poll_creation":return d("WAWebWamEnumMediaType").MEDIA_TYPE.POLL_CREATE;case"poll_result_snapshot":return d("WAWebWamEnumMediaType").MEDIA_TYPE.POLL_RESULT_SNAPSHOT;case"poll_update":return a.subtype==="poll_vote"?d("WAWebWamEnumMediaType").MEDIA_TYPE.POLL_VOTE:d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"keep_in_chat":return a.keepType===d("WAWebProtobufsE2E.pb").KeepType.KEEP_FOR_ALL?d("WAWebWamEnumMediaType").MEDIA_TYPE.KEEP:d("WAWebWamEnumMediaType").MEDIA_TYPE.UNKEEP;case"pin_message":return d("WAWebWamEnumMediaType").MEDIA_TYPE.PIN_IN_CHAT;case"protocol":return a.subtype==="ephemeral_sync_response"?d("WAWebWamEnumMediaType").MEDIA_TYPE.EPHEMERAL_SYNC_RESPONSE:d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"event_creation":return d("WAWebWamEnumMediaType").MEDIA_TYPE.EVENT_CREATE;case"event_response":return d("WAWebWamEnumMediaType").MEDIA_TYPE.EVENT_RESPOND;case"album":return d("WAWebWamEnumMediaType").MEDIA_TYPE.MEDIA_ALBUM;case"biz-cover-photo":case"broadcast_notification":case"call_log":case"ciphertext":case"debug_placeholder":case"debug":case"e2e_notification":case"gp2":case"groups_v4_invite":case"hsm":case"interactive_response":case"native_flow":case"newsletter_notification":case"notification":case"notification_template":case"oversized":case"payment":case"pinned_message":case"request_phone_number":case"revoked":case"status":case"template_button_reply":case"comment":case"history_bundle":case"newsletter_admin_invite":case"biz_content_placeholder":case"event_edit_encrypted":case"sticker-pack":return d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;default:a.type;return d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE}}function h(a){if(a==null)return d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;switch(a){case c("WAWebInteractiveMessageType").SHOPS_STOREFRONT:return d("WAWebWamEnumMediaType").MEDIA_TYPE.SHOP_STOREFRONT;case c("WAWebInteractiveMessageType").NATIVE_FLOW:return d("WAWebWamEnumMediaType").MEDIA_TYPE.INTERACTIVE_NFM;case c("WAWebInteractiveMessageType").CAROUSEL:return d("WAWebWamEnumMediaType").MEDIA_TYPE.INTERACTIVE_CAROUSEL}}function f(a){if(!(a instanceof c("WAWebWid")))return null;return d("WAWebUserPrefsMeUser").isMeAccount(a)?a.isCompanion()?d("WAWebWamEnumE2eDeviceType").E2E_DEVICE_TYPE.MY_COMPANION:d("WAWebWamEnumE2eDeviceType").E2E_DEVICE_TYPE.MY_PRIMARY:a.isCompanion()?d("WAWebWamEnumE2eDeviceType").E2E_DEVICE_TYPE.OTHER_COMPANION:d("WAWebWamEnumE2eDeviceType").E2E_DEVICE_TYPE.OTHER_PRIMARY}function i(a){if(a.id.remote.isBot())return d("WAWebWamEnumAgentEngagementEnumType").AGENT_ENGAGEMENT_ENUM_TYPE.DIRECT_CHAT;var b=d("WAWebMsgGetters").getIsBotQuery(a);a=d("WAWebMsgGetters").getIsMetaBotResponse(a);return b||a?d("WAWebWamEnumAgentEngagementEnumType").AGENT_ENGAGEMENT_ENUM_TYPE.INVOKED:null}function j(a,b,c){if(a==null?void 0:a.isBot())return d("WAWebWamEnumBotType").BOT_TYPE.METABOT;if(b){if(b===d("WAWebBotTypes").BizBotType.BIZ_1P)return d("WAWebWamEnumBotType").BOT_TYPE.BOT_1P_BIZ;if(b===d("WAWebBotTypes").BizBotType.BIZ_3P)return d("WAWebWamEnumBotType").BOT_TYPE.BOT_3P_BIZ}if(c){if(c===d("WAWebBotTypes").BizBotAutomatedType.PARTIAL_1P)return d("WAWebWamEnumBotType").BOT_TYPE.BOT_1P_BIZ;if(c===d("WAWebBotTypes").BizBotAutomatedType.FULL_3P)return d("WAWebWamEnumBotType").BOT_TYPE.BOT_3P_BIZ}return d("WAWebWamEnumBotType").BOT_TYPE.UNKNOWN}function k(a){if(a==null||a==="")return null;switch(a){case d("WAWebHandleMsgCommon").CATEGORY_PEER:return d("WAWebWamEnumInvisibleMessageCategoryType").INVISIBLE_MESSAGE_CATEGORY_TYPE.PEER;default:return null}}g.getWamMessageType=a;g.getMessageTypeFromMsgInfoType=b;g.getWamMediaType=e;g.getInteractiveWamType=h;g.getWamE2eSenderType=f;g.getWamAgentEngagementType=i;g.getWamBotType=j;g.getWamInvisibleMessageCatgoryType=k}),98);
__d("WAWebOrderPaymentStatus",["$InternalEnum","WAWebE2EProtoUtils","WAWebInteractiveMessageType","WAWebMsgType"],(function(a,b,c,d,e,f,g){var h=-1e3;e=(a=b("$InternalEnum"))({Pending:"pending",Captured:"captured"});f=a({Confirm:"confirm",PaymentInstruction:"payment_instruction"});b=a({CPI:"cpi",PIX:"pix",NATIVE:"native"});a=a({P2M_LITE:"p2m_lite",P2M_PRO:"p2m_pro",P2M_BASIC:"p2m_basic"});var i=function(a){var b={};try{b=JSON.parse(a)}catch(a){return null}if(b==null)return null;a=b;b=a.reference_id;var c=a.payment_method;a=a.payment_status;return b==null||a==null&&c==null?null:{refId:b,paymentMethod:c,paymentStatus:a}},j=function(a){var b;if(a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&a.interactiveType===c("WAWebInteractiveMessageType").NATIVE_FLOW&&d("WAWebE2EProtoUtils").isOrderNativeFlow(a.nativeFlowName)&&((b=a.interactivePayload)==null?void 0:b.buttons)){b=a.interactivePayload;a=b.buttons[0].buttonParamsJson;if(a!=null)return i(a)}return null},k=function(a){var b;return a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&a.interactiveType===c("WAWebInteractiveMessageType").NATIVE_FLOW&&d("WAWebE2EProtoUtils").isOrderNativeFlow(a.nativeFlowName)&&((b=a.interactivePayload)==null?void 0:b.buttons)?a.interactivePayload.buttons[0]:null},l=function(a){a=k(a);if(a==null)return null;var b=a.name;a=a.buttonParamsJson;return b!=null&&a!=null?i(a):null},m=function(a,b){a=a.msgs.getModelsArray().slice(h);var e=null;a=a.findLast(function(a){if(a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.subtype==="phone_only_feature"&&a.quotedMsg!=null){var f;e=j(a.quotedMsg);if(((f=e)==null?void 0:f.refId)===b)return!0}else if(a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&a.interactiveType===c("WAWebInteractiveMessageType").NATIVE_FLOW&&d("WAWebE2EProtoUtils").isOrderNativeFlow(a.nativeFlowName)){e=l(a);if(((f=e)==null?void 0:f.refId)===b)return!0}return!1});return a!=null&&e!=null?e:null};g.OrderPaymentStatus=e;g.OrderPaymentMethod=f;g.OrderAcceptedPaymentMethods=b;g.OrderP2MType=a;g.paramsJsonToOrderPaymentInfo=i;g.getOrderPaymentStatusInfo=j;g.getOrderPaymentStatusInfoFromNativeFlow=l;g.findLastOrderPaymentStatusInfo=m}),98);
__d("WAWebOrderStatus",["$InternalEnum","WAWebBizGatingUtils","WAWebE2EProtoUtils","WAWebInteractiveMessageType","WAWebInteractiveMessagesNativeFlowName","WAWebMsgType","WAWebOrderDetails"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum")({Pending:"pending",Processing:"processing",PartiallyShipped:"partially_shipped",Shipped:"shipped",Complete:"completed",Canceled:"canceled",PaymentRequested:"payment_requested",PreparingToShip:"preparing_to_ship",Delivered:"delivered"}),i=function(a){if(a==null)return null;try{a=JSON.parse(a);var b=a.order;a=a.reference_id;b=h.cast(b==null?void 0:b.status);return b==null||a==null?null:{refId:a,status:b}}catch(a){return null}},j=function(a){var b;if(!d("WAWebE2EProtoUtils").isOrderNativeFlow(a.nativeFlowName))return null;if(a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&a.interactiveType===c("WAWebInteractiveMessageType").NATIVE_FLOW&&((b=a.interactivePayload)==null?void 0:b.buttons)){b=a.interactivePayload.buttons[0].buttonParamsJson;return i(b)}else if(a.type===d("WAWebMsgType").MSG_TYPE.NATIVE_FLOW){a=((b=a.nativeFlowButtons)!=null?b:[])[0].nativeFlowInfo;return i(a==null?void 0:a.paramsJson)}};a=function(a,b){a=a.msgs.getModelsArray().slice(-1e3);a=(a=a.findLast(function(a){return[c("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS,c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO].includes(a.nativeFlowName)&&((a=d("WAWebOrderDetails").getOrderInfo(a))==null?void 0:a.referenceId)===b}))==null?void 0:a.safe();return a};var k=function(a,b){a=a.msgs.getModelsArray().slice(-1e3);a=(a=a.findLast(function(a){return d("WAWebE2EProtoUtils").isOrderNativeFlow(a.nativeFlowName)&&((a=j(a))==null?void 0:a.refId)===b}))==null?void 0:a.safe();return a},l=function(){return d("WAWebBizGatingUtils").isOrderStatusM1Enabled()?h.PaymentRequested:h.Pending};e=function(a,b){a=k(a,b);b=a!=null?j(a):null;return(a=b==null?void 0:b.status)!=null?a:l()};g.OrderStatus=h;g.paramsJsonToOrderStatusInfo=i;g.getOrderStatusInfo=j;g.findOrderDetailsMessage=a;g.getDefaultOrderStatus=l;g.findOrderStatus=e}),98);
__d("WAWebUserPrefsNuxPreferences",["WAWebBizGatingUtils","WAWebEventEmitter","WAWebNux","WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(a,b,c,d,e,f,g){var h=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}var c=a.prototype;c.handleNuxChange=function(a){this.trigger(a)};return a}(c("WAWebEventEmitter")),i=new h();function a(a){var b=d("WAWebNux").getNuxSyncKey(a);if(b!=null&&n(b))return!1;b=j(a);return!b?!0:b.views<p(a)}function j(a){a=c("WAWebUserPrefsStore").getUser(a);if(a==null||typeof a!=="object")return null;a=a.views;return typeof a==="number"?{views:a}:null}function b(a,b){c("WAWebUserPrefsStore").setUser(a,b),i.handleNuxChange(a)}function k(a){c("WAWebUserPrefsStore").setUser(a),i.handleNuxChange(a)}function l(){var a=c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").KEYS.NUX_LIST);return a instanceof Array?a.filter(function(a){return typeof a==="string"}):[]}function e(a){var b=new Set(l());a.forEach(function(a){var c=a.nuxKey;a=a.acknowledged;a?b.add(c):b["delete"](c)});c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.NUX_LIST,Array.from(b));a.forEach(function(a){a=a.nuxKey;a=o(a);a!=null&&i.handleNuxChange(a)})}function f(){c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.NUX_LIST,[])}function m(a){k(a);var b=l().filter(function(b){return b!==a});c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.NUX_LIST,b)}function n(a){return l().includes(a)}function o(a){switch(a){case"message_label_deprecation_migrated":return d("WAWebNux").NUX.MESSAGE_LABEL_DEPRECATION_MIGRATED_PERMANENT;default:return null}}function p(a){switch(a){case"message_label_deprecation_migrated_permanent":case"desktop_upsell":return Number.POSITIVE_INFINITY;case"chat_assignment":return d("WAWebBizGatingUtils").chatAssignmentMaxNuxImpressions();case"status_quick_replies":return 3;default:a;return 1}}g.NuxPrefsEvent=i;g.shouldShowNUX=a;g.getNUX=j;g.setNUX=b;g.removeNUX=k;g.getNuxSyncList=l;g.updateNuxSyncList=e;g.removeAllNuxSync=f;g.resetNux=m;g.nuxExistsInNuxSync=n;g.getNuxMaxViews=p}),98);
__d("WAWebEventsWaitForBbEvent",["Promise","WAAbortError"],(function(a,b,c,d,e,f,g){var h;function a(a,c,e,f){e===void 0&&(e=function(){return!0});return(f==null?void 0:f.aborted)?(h||(h=b("Promise"))).reject(new(d("WAAbortError").AbortError)()):new(h||(h=b("Promise")))(function(b,g){var h=function(){if(!e.apply(this,arguments))return;j==null?void 0:j();b(arguments)},i=function(){j==null?void 0:j(),g(new(d("WAAbortError").AbortError)())},j=function(){a.off(c,h),f==null?void 0:f.removeEventListener("abort",i),j=null};f==null?void 0:f.addEventListener("abort",i);a.on(c,h)})}g["default"]=a}),98);
__d("WAWebEventsWaitForMainStreamReadyMd",["Promise","WAWebCmd","WAWebEventsWaitForBbEvent"],(function(a,b,c,d,e,f,g){var h;function a(){return d("WAWebCmd").Cmd.isMainStreamReadyMd?(h||(h=b("Promise"))).resolve():c("WAWebEventsWaitForBbEvent")(d("WAWebCmd").Cmd,"main_stream_mode_ready")}g["default"]=a}),98);
__d("WAWebEventsWaitForOfflineDeliveryEnd",["WACustomError","WALogger","WAPromiseTimeout","WAWebCmd","WAWebEventsWaitForBbEvent","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] offline delievery promise not resolved within 5 mins"]);h=function(){return a};return a}var i,j=5*60*1e3;function a(){if(i)return;i=c("WAWebEventsWaitForBbEvent")(d("WAWebCmd").Cmd,"offline_delivery_end");d("WAWebCmd").Cmd.on("offline_delivery_state_reset",function(){i=c("WAWebEventsWaitForBbEvent")(d("WAWebCmd").Cmd,"offline_delivery_end")})}function e(){return d("WAWebCmd").Cmd.isOfflineDeliveryEnd}function f(){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(d("WAWebCmd").Cmd.isOfflineDeliveryEnd)return;if(!i)throw c("err")("waitForOfflineDeliveryEnd called before init");try{yield d("WAPromiseTimeout").promiseTimeout(i,j)}catch(a){if(a instanceof d("WACustomError").TimeoutError)d("WALogger").ERROR(h()).sendLogs("offline-resume-promise-unresolved");else throw a}yield i});return k.apply(this,arguments)}g.initWaitForOfflineDeliveryEnd=a;g.isOfflineDeliveryEnd=e;g.waitForOfflineDeliveryEnd=f}),98);
__d("WAWebEventsWaitForReadyForOffline",["Promise","WAWebCmd","WAWebEventsWaitForBbEvent","err"],(function(a,b,c,d,e,f,g){var h,i;function a(){if(i)return;i=c("WAWebEventsWaitForBbEvent")(d("WAWebCmd").Cmd,"offline_process_ready")}function e(){return!i?(h||(h=b("Promise"))).reject(c("err")("waitForOfflineProcessReady called before init")):i}g.initWaitForOfflineProcessReady=a;g.waitForOfflineProcessReady=e}),98);
__d("WASignalAggregator",["err"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){var a=this;this.$1=!1;this.$2=new AbortController();this.$3=new Set();this.signal=this.$2.signal;this.$5=function(b){a["delete"](b.currentTarget),a.$6()}}var b=a.prototype;b.add=function(){this.$4();for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];for(var d=0;d<b.length;d++){var e=b[d];e.aborted||(e.addEventListener("abort",this.$5),this.$3.add(e))}this.$6()};b.$6=function(){if(this.$1)return;var a=Array.from(this.$3).every(function(a){return a.aborted});if(!a)return;this.dispose();this.$2.abort()};b["delete"]=function(){this.$4(),this.$7.apply(this,arguments)};b.$7=function(){var a=!1;for(var b=arguments.length,c=new Array(b),d=0;d<b;d++)c[d]=arguments[d];for(var e=0;e<c.length;e++){var f=c[e];this.$3["delete"](f)&&(a=!0,f.removeEventListener("abort",this.$5))}a&&this.$6()};b.$4=function(){if(this.$1)throw c("err")("Attempt to modify disposed SignalAggregator")};b.dispose=function(){if(this.$1)return;this.$1=!0;for(var a=this.$3,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;this.$7(d)}};b.getSignals__INTERNAL=function(){return this.$3};return a}();g["default"]=a}),98);
__d("WAMemoizeConcurrent",["Promise","WAAbortError","WAPromiseRaceAbort","WASignalAggregator"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,e){var f=new Map();return function(g){if(g.signal.aborted)return(h||(h=b("Promise"))).reject(new(d("WAAbortError").AbortError)());var i=a.call(this,g),j=f.get(i);if(j==null||j.aggregator.signal.aborted){var k=new(c("WASignalAggregator"))(),l=babelHelpers["extends"]({},g,{signal:k.signal});j={aggregator:k,promise:e.call(this,l)["finally"](function(){k.dispose(),f["delete"](i)})};f.set(i,j)}l=g.signal||new AbortController().signal;j.aggregator.add(l);return c("WAPromiseRaceAbort")(j.promise,l)}}g["default"]=a}),98);
__d("WAWebNetworkGetResponseIfOnline",["WAWebXHR"],(function(a,b,c,d,e,f,g){function a(a,b,d,e,f){b===void 0&&(b="GET");return c("WAWebXHR").request(a,b,d,f,e).then(function(a){return a.status&&a.status<12e3?a:null})["catch"](function(){return null})}g["default"]=a}),98);
__d("WAWebNetworkStatus",["Promise","WALogger","WAMemoizeConcurrent","WAWebBaseModel","WAWebBuildConstants","WAWebMiscBrowserUtils","WAWebNetworkGetResponseIfOnline","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[comms] NetworkStatus ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["NetworkStatus:checkOnline errored! ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["NetworkStatus:checkOnline response ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["NetworkStatus:checkOnline simulating offline behavior"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["NetworkStatus:checkOnline checking"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["waitIfOffline: Continuing..."]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["waitIfOffline: Waiting..."]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["waitIfOffline: XHR online is false, but navigator.onLine is true, resolving promise"]);p=function(){return a};return a}var q=d("WAWebBuildConstants").DYN_ORIGIN+"status.json",r=!1;a=function(a){babelHelpers.inheritsLoose(e,a);function e(){var e,f;for(var g=arguments.length,i=new Array(g),s=0;s<g;s++)i[s]=arguments[s];return(e=f=a.call.apply(a,[this].concat(i))||this,f.online=d("WAWebBaseModel").session(!0),f.simulatedOfflineConditions=d("WAWebBaseModel").session(!1),f.waitIfOffline=c("WAMemoizeConcurrent")(function(){return"all"},b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this;if(this.online)return;if(c("WAWebMiscBrowserUtils").info().name!=="Firefox"&&navigator.onLine){d("WALogger").LOG(p());return}d("WALogger").LOG(o());yield new(h||(h=b("Promise")))(function(b){a.listenToOnce(a,"change:online",function(){d("WALogger").LOG(n()),b()})})})),f.checkOnline=c("WAMemoizeConcurrent")(function(){return"all"},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.signal;d("WALogger").LOG(m());if((r||c("gkx")("26256"))&&this.simulatedOfflineConditions){d("WALogger").LOG(l());return}try{a=(yield c("WAWebNetworkGetResponseIfOnline")(q,"GET",null,void 0,a));this.online=!!a;d("WALogger").LOG(k(),String(this.online))}catch(a){d("WALogger").WARN(j(),String(a)).devConsole(a)}});return function(b){return a.apply(this,arguments)}}()),e)||babelHelpers.assertThisInitialized(f)}var f=e.prototype;f.initialize=function(){this.listenTo(this,"change:online",this.$NetworkStatus1),this.$NetworkStatus1()};f.$NetworkStatus1=function(){var a=this.online;d("WALogger").LOG(i(),a?"online":"offline").tags("comms")};f.simulateNetworkStatus=function(a){(r||c("gkx")("26256"))&&(this.online=a,this.simulatedOfflineConditions=!a)};return e}(d("WAWebBaseModel").BaseModel);e=d("WAWebBaseModel").defineModel(a);f=new e();g["default"]=f}),98);
__d("WAWebPairList",["lodash"],(function(a,b,c,d,e,f,g){function a(a){return c("lodash").flatten(a.map(function(a){return[a[0],a[1]]}))}function b(a){if(a.length%2!==0)throw new RangeError("Flattened pairs come in 2, invalid list size to unflatten!");var b=[];for(var c=0;c<a.length;c++)b.push([a[c],a[++c]]);return b}g.flattenPairList=a;g.unFlattenPairList=b}),98);
__d("WAWebProfilePicConstants",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["Remove","Set"]);f.ProfilePicCommand=a}),66);
__d("WAWebGroupSystemMsg",["Promise","WALogger","WATimeUtils","WAWebABProps","WAWebApiParticipantStore","WAWebCommunityGatingUtils","WAWebContactSystemMsg","WAWebDBCommunity","WAWebDBGroupsGroupMetadata","WAWebGroupType","WAWebGroupsParticipantsApi","WAWebMsgKey","WAWebMsgType","WAWebPairList","WAWebProfilePicConstants","WAWebRequestMethodType","WAWebSchemaGroupMetadata","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["genIntegrityDelteteParentNotificationMsgs: missing parentGroupMetadata"]);i=function(){return a};return a}function j(a,b){var e,f=a.chatId;e=(e=(e=b.owner)!=null?e:a.author)!=null?e:d("WAWebUserPrefsMeUser").getMaybeMeUser();var g=b.participants.some(function(a){var b=a.isAdmin;a=a.id;return d("WAWebUserPrefsMeUser").isMeAccount(a)&&b}),h=f,i=!1,j=b.subject,k,l;if(b.defaultSubgroup===!0){var m;k="community_create";b.parentGroup&&(l=[b.parentGroup,b.subject]);e=(m=b.owner)!=null?m:a.author}else if(b.generalSubgroup===!0&&g&&d("WAWebCommunityGatingUtils").communityGeneralChatUIEnabled()){k="general_chat_add";l=["created",b.subject];e=(m=b.owner)!=null?m:a.author}else{e=(g=b.owner)!=null?g:a.author;m=b.membershipApprovalMode===!0?"true":"false";g=b.hiddenSubgroup===!0?"true":"false";b.parentGroup&&b.participants.length===1&&d("WAWebCommunityGatingUtils").communityShortGroupCreationEnabled()?(l=[b.parentGroup,b.parentGroupSubject,b.subject,m,g],k="empty_subgroup_create"):k="create"}return{id:new(c("WAWebMsgKey"))({remote:h,fromMe:i,participant:e,id:C(a,k)}),author:e,body:j,from:f,recipients:[],subtype:k,t:(m=b.creation)!=null?m:a.ts,type:"gp2",kind:d("WAWebMsgType").MsgKind.Gp2,templateParams:l}}function a(a,b,c,d){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){var g=c.participants.find(function(a){var b=a.isAdmin;a=a.id;return d("WAWebUserPrefsMeUser").isMeAccount(a)&&b});return(yield (h||(h=b("Promise"))).all([i(),k(),l(),m()])).flat();function i(){return!e&&!g&&c.defaultSubgroup===!0&&c.incognito===!0?[d("WAWebContactSystemMsg").genNotificationMsg(c.id,{type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"cag_masked_thread_created",templateParams:[]})]:[]}function k(){return e?[]:[j(a,c)]}function l(){var b=c.ephemeralDuration;return a.author&&a.ts!=null&&b!=null&&b>0?[p(a.chatId,a.ts,a.author,b)]:[]}function m(){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return f==null?[]:[yield n(a,f)]});return o.apply(this,arguments)}});return k.apply(this,arguments)}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=a.parentGroupId;if(!a)return!1;a=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(a));return!a||a!=null&&(yield d("WAWebDBCommunity").getJoinedSubgroups(d("WAWebWidFactory").createWid(a.id))).length<=b?!0:!1});return m.apply(this,arguments)}function n(a,b,c){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=a.chatId,g=a.isAdmin;g=g===void 0?!1:g;var h=a.author&&d("WAWebWidFactory").toUserWid(a.author)||void 0,i=f,j=!1,k=null,m=[],n=h,o=b.actionType,p=null,q,r=b.parentGroupId;switch(b.actionType){case d("WAWebGroupType").GROUP_ACTIONS.SUBJECT:k=b.subject;break;case d("WAWebGroupType").GROUP_ACTIONS.MODIFY:m=b.participants.map(function(a){a=a.id;return a});break;case d("WAWebGroupType").GROUP_ACTIONS.ADD:if(b.reason===d("WAWebGroupType").ADD_REASON.INVITE)if(r&&b.participants.some(function(a){a=a.id;return d("WAWebUserPrefsMeUser").isMeAccount(a)}))if(b.generalSubgroup===!0&&d("WAWebCommunityGatingUtils").communityGeneralChatUIEnabled()){var s;o="general_chat_add";p=["linked_group_join",(s=b.groupName)!=null?s:""]}else if(b.defaultSubgroup===!0){o="community_invite_rich";p=[r,(s=b.groupName)!=null?s:""]}else{o="sub_group_invite_rich";s=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(r));p=[r,(s=s==null?void 0:s.subject)!=null?s:""]}else o="invite";else if(b.reason===d("WAWebGroupType").ADD_REASON.LINKED_GROUP_JOIN)if(b.generalSubgroup===!0&&r!=null&&b.participants.some(function(a){a=a.id;return d("WAWebUserPrefsMeUser").isMeAccount(a)})&&d("WAWebCommunityGatingUtils").communityGeneralChatUIEnabled()){o="general_chat_add";p=["linked_group_join",(s=b.groupName)!=null?s:""]}else o="linked_group_join";else if(b.reason===d("WAWebGroupType").ADD_REASON.AUTO_ADD)if(r){p=[r,(s=b.groupName)!=null?s:"",(s=b.contextGroupId)!=null?s:""];o="subgroup_admin_triggered_auto_add"}else{o="auto_add";if(yield l(b,2)){p=[b.parentGroupId,(s=b.groupName)!=null?s:""]}}else if(b.reason===d("WAWebGroupType").ADD_REASON.DEFAULT_SUBGROUP_ADMIN_ADD)if(r){o="community_participant_add_rich";p=[r,(s=b.groupName)!=null?s:""]}else{o="default_sub_group_admin_add";if(yield l(b,1)){p=[b.parentGroupId,(s=b.groupName)!=null?s:""]}}else if(b.reason===d("WAWebGroupType").ADD_REASON.DEFAULT_SUBGROUP_PROMOTE)o="default_sub_group_promote";else if(b.reason===d("WAWebGroupType").ADD_REASON.INVITE_AUTO_ADD)if(r&&Boolean(b.defaultSubgroup)&&b.participants.some(function(a){a=a.id;return d("WAWebUserPrefsMeUser").isMeAccount(a)})){p=[r,(s=b.groupName)!=null?s:"",(s=b.contextGroupId)!=null?s:""];o="subgroup_admin_triggered_invite_auto_add"}else o="invite_auto_add",b.contextGroupId&&(p=[b.contextGroupId,""],(yield l(b,2))?p.push("false"):p.push("true"));else if(b.participants.some(function(a){a=a.id;return d("WAWebUserPrefsMeUser").isMeAccount(a)})&&b.reason===d("WAWebGroupType").ADD_REASON.GENERAL_CHAT_AUTO_ADD&&d("WAWebCommunityGatingUtils").communityGeneralChatUIEnabled())o="general_chat_add",p=["general_chat_auto_add",b.groupName];else if(b.reason==null&&r&&b.participants.some(function(a){a=a.id;return d("WAWebUserPrefsMeUser").isMeAccount(a)})&&b.generalSubgroup===!0&&d("WAWebCommunityGatingUtils").communityGeneralChatUIEnabled()){o="general_chat_add";p=["",(s=b.groupName)!=null?s:""]}else if(r&&b.participants.some(function(a){a=a.id;return d("WAWebUserPrefsMeUser").isMeAccount(a)})){s=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(r));p=[r,(r=s==null?void 0:s.subject)!=null?r:""];o=b.defaultSubgroup===!0?"community_participant_add_rich":"sub_group_participant_add_rich"}case d("WAWebGroupType").GROUP_ACTIONS.PROMOTE:case d("WAWebGroupType").GROUP_ACTIONS.DEMOTE:case d("WAWebGroupType").GROUP_ACTIONS.REMOVE:case d("WAWebGroupType").GROUP_ACTIONS.LINKED_GROUP_PROMOTE:case d("WAWebGroupType").GROUP_ACTIONS.LINKED_GROUP_DEMOTE:if(b.actionType===d("WAWebGroupType").GROUP_ACTIONS.REMOVE&&b.reason===d("WAWebGroupType").REMOVE_REASON.DEFAULT_SUBGROUP_DEMOTE){o="default_sub_group_demote";break}m=b.participants.map(function(a){a=a.id;return a});m.length===1&&(n=m[0]);b.actionType===d("WAWebGroupType").GROUP_ACTIONS.REMOVE&&m.length===1&&h===n&&(o="leave");break;case d("WAWebGroupType").GROUP_ACTIONS.INVITE_CODE:o="revoke_invite";break;case d("WAWebGroupType").GROUP_ACTIONS.DESC_ADD:o=b.isParentGroup===!0?"parent_group_description":"description";k=b.desc;break;case d("WAWebGroupType").GROUP_ACTIONS.DESC_REMOVE:o=b.isParentGroup===!0?"parent_group_description":"description";break;case d("WAWebGroupType").GROUP_ACTIONS.RESTRICT:p=[b.value?d("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.On:d("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.Off];k=p[0];b.threshold!=null&&p.push(b.threshold);break;case d("WAWebGroupType").GROUP_ACTIONS.ANNOUNCE:case d("WAWebGroupType").GROUP_ACTIONS.NO_FORWARD:p=[b.value?d("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.On:d("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.Off];k=p[0];break;case d("WAWebGroupType").GROUP_ACTIONS.EPHEMERAL:h&&(p=[""+b.duration,h]);break;case d("WAWebGroupType").GROUP_ACTIONS.GROWTH_LOCKED:p=[b.type];k=p[0];break;case d("WAWebGroupType").GROUP_ACTIONS.SUB_GROUP_LINK:case d("WAWebGroupType").GROUP_ACTIONS.SIBLING_GROUP_LINK:case d("WAWebGroupType").GROUP_ACTIONS.SUB_GROUP_UNLINK:case d("WAWebGroupType").GROUP_ACTIONS.PARENT_GROUP_UNLINK:case d("WAWebGroupType").GROUP_ACTIONS.SIBLING_GROUP_UNLINK:case d("WAWebGroupType").GROUP_ACTIONS.DELETE_PARENT_GROUP_UNLINK:case d("WAWebGroupType").GROUP_ACTIONS.INTEGRITY_PARENT_GROUP_UNLINK:p=d("WAWebPairList").flattenPairList(b.groupDatas.map(function(a){return[a.id,a.subject]}));break;case d("WAWebGroupType").GROUP_ACTIONS.PARENT_GROUP_LINK:p=d("WAWebPairList").flattenPairList(b.groupDatas.map(function(a){return[a.id,a.subject]}));o="community_link_parent_group_rich";q="parentGroupLink";break;case d("WAWebGroupType").GROUP_ACTIONS.DELETE_PARENT_GROUP:p=[b.communityTitle];break;case d("WAWebGroupType").GROUP_ACTIONS.MEMBERSHIP_APPROVAL_MODE:p=[b.value?d("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.On:d("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.Off,g?d("WAWebGroupType").GroupSettingChangeSystemMessageIsAdmin.Admin:d("WAWebGroupType").GroupSettingChangeSystemMessageIsAdmin.Regular];b.triggered==="server"&&(h=void 0);break;case d("WAWebGroupType").GROUP_ACTIONS.MEMBER_ADD_MODE:if(!d("WAWebABProps").getABPropConfigValue("web_anyone_can_add_group_setting_enabled"))break;s=b.memberAddMode;s!=null&&(p=[s===d("WAWebSchemaGroupMetadata").MemberAddMode.ALL_MEMBER_ADD?d("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.On:d("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.Off]);break;case d("WAWebGroupType").GROUP_ACTIONS.CREATED_MEMBERSHIP_REQUESTS:r=b.requests;b.requestMethod===d("WAWebRequestMethodType").RequestMethod.NonAdminAdd&&h!=null&&r.length>0?(p=[h.toJid()].concat(r.map(function(a){return a.toJid()})),o="created_membership_requests"):o="membership_approval_request";break;case d("WAWebGroupType").GROUP_ACTIONS.ALLOW_ADMIN_REPORTS:p=[b.value?d("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.On:d("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.Off];g=(yield d("WAWebApiParticipantStore").isCurrentUserGroupAdmin(a.chatId.toString()));p.push(g?d("WAWebGroupType").GroupSettingChangeSystemMessageIsAdmin.Admin:d("WAWebGroupType").GroupSettingChangeSystemMessageIsAdmin.Regular);break;case d("WAWebGroupType").GROUP_ACTIONS.ALLOW_NON_ADMIN_SUB_GROUP_CREATION:p=[b.value?d("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.On:d("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.Off];break;case d("WAWebGroupType").GROUP_ACTIONS.CREATED_SUBGROUP_SUGGESTION:o="created_subgroup_suggestion";p=[b.subject];break;case d("WAWebGroupType").GROUP_ACTIONS.GENERAL_CHAT_AUTO_ADD_DISABLED:o="general_chat_auto_add_disabled";p=[d("WAWebGroupType").GeneralChatAutoAddDisabledReasonEnum.Full];break;case d("WAWebGroupType").GROUP_ACTIONS.COMMUNITY_OWNER_UPDATE:o="community_owner_update";p=[b.newOwner.toString()];m=[b.newOwner];break;case d("WAWebGroupType").GROUP_ACTIONS.HIDDEN_GROUP:o="hidden_group";break}return{id:new(c("WAWebMsgKey"))({remote:i,fromMe:j,participant:n,id:C(a,q)}),body:k?k:void 0,author:h,from:f,to:d("WAWebUserPrefsMeUser").getMeUser(),recipients:m.map(d("WAWebWidFactory").toUserWid)||[],subtype:o,t:(s=e)!=null?s:a.ts,type:"gp2",viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,kind:d("WAWebMsgType").MsgKind.Gp2,templateParams:p?p:void 0}});return o.apply(this,arguments)}function e(a,b,e,f){var g=!1;return{type:"gp2",kind:d("WAWebMsgType").MsgKind.Gp2,subtype:"picture",viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,t:e,author:f,body:b===d("WAWebProfilePicConstants").ProfilePicCommand.Set?"set":"remove",recipients:[],from:a,to:d("WAWebUserPrefsMeUser").getMeUser(),id:new(c("WAWebMsgKey"))({remote:a,fromMe:g,id:c("WAWebMsgKey").newId_DEPRECATED()})}}function p(a,b,e,f){return{id:new(c("WAWebMsgKey"))({remote:a,fromMe:!1,participant:e,id:c("WAWebMsgKey").newId_DEPRECATED()}),author:e,from:a,to:d("WAWebUserPrefsMeUser").getMeUser(),recipients:[],subtype:"ephemeral",t:b,type:"gp2",kind:d("WAWebMsgType").MsgKind.Gp2,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,templateParams:[""+f]}}function f(a,b){return{id:new(c("WAWebMsgKey"))({remote:a,fromMe:!1,id:c("WAWebMsgKey").newId_DEPRECATED()}),from:a,to:d("WAWebUserPrefsMeUser").getMeUser(),recipients:[],subtype:"initial_pHash_mismatch",t:b,type:"gp2",kind:d("WAWebMsgType").MsgKind.Gp2,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE}}function q(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c,e=[],f=a.chatId,g=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(f));if(g==null||g.isParentGroup===!1)return e;var i=(yield d("WAWebDBCommunity").getDefaultSubgroup(f)),j=(c=g==null?void 0:g.subject)!=null?c:"",k=d("WATimeUtils").unixTime();i!=null&&(yield d("WAWebGroupsParticipantsApi").checkMyMembership(i))&&e.push(yield n({chatId:i,author:a.author,ts:k},{actionType:d("WAWebGroupType").GROUP_ACTIONS.DELETE_PARENT_GROUP,communityTitle:j}));yield (h||(h=b("Promise"))).all(((c=(yield d("WAWebDBCommunity").getJoinedSubgroups(d("WAWebWidFactory").createWid(g.id))))!=null?c:[]).filter(function(a){return!(i!=null&&i.equals(a))}).map(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){e.push(yield n({chatId:b,author:a.author,ts:k},{actionType:d("WAWebGroupType").GROUP_ACTIONS.DELETE_PARENT_GROUP,communityTitle:j})),e.push(yield n({chatId:b,author:a.author,ts:k},{actionType:d("WAWebGroupType").GROUP_ACTIONS.PARENT_GROUP_UNLINK,groupDatas:[{id:f,subject:j}]}))});return function(a){return c.apply(this,arguments)}}()));return e});return r.apply(this,arguments)}function s(a,b){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=[],f=a.chatId,g=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(f));if(g==null){d("WALogger").ERROR(i());return[]}var j=(yield d("WAWebDBCommunity").getDefaultSubgroup(f));if(j!=null&&(yield d("WAWebGroupsParticipantsApi").checkMyMembership(j))){e.push(yield n({chatId:j,author:void 0,ts:d("WATimeUtils").unixTime()},{actionType:d("WAWebGroupType").GROUP_ACTIONS.DELETE,reason:d("WAWebGroupType").DELETE_REASON.INTEGRITY_DELETE_PARENT,groupDatas:[{id:f,subject:(c=g==null?void 0:g.subject)!=null?c:""}]}))}yield (h||(h=b("Promise"))).all(((a=(yield d("WAWebDBCommunity").getJoinedSubgroups(f)))!=null?a:[]).filter(function(a){return!(j!=null&&j.equals(a))}).map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return e.push(yield n({chatId:a,author:void 0,ts:d("WATimeUtils").unixTime()},{actionType:d("WAWebGroupType").GROUP_ACTIONS.INTEGRITY_PARENT_GROUP_UNLINK,groupDatas:[{id:f,subject:(a=g==null?void 0:g.subject)!=null?a:""}]}))});return function(b){return a.apply(this,arguments)}}()));return e});return t.apply(this,arguments)}function u(a,b){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=a.chatId,e=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(c));if((e==null?void 0:e.isParentGroup)===!0){e=(yield d("WAWebDBCommunity").getDefaultSubgroup(c));if(e&&(b.actionType===d("WAWebGroupType").GROUP_ACTIONS.DESC_ADD||b.actionType===d("WAWebGroupType").GROUP_ACTIONS.DESC_REMOVE))return n(babelHelpers["extends"]({},a,{chatId:e}),babelHelpers["extends"]({},b,{isParentGroup:!0}))}return n(a,b)});return v.apply(this,arguments)}function w(a,b){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=a.chatId;c=(yield d("WAWebDBCommunity").getDefaultSubgroup(c));if(!c)return;var e=(yield d("WAWebGroupsParticipantsApi").getParticipants(c));e=Boolean(e==null?void 0:e.participants.find(function(a){return d("WAWebUserPrefsMeUser").isMeAccount(d("WAWebWidFactory").createWid(a))}));if(!e)return;return n(babelHelpers["extends"]({},a,{chatId:c}),b)});return x.apply(this,arguments)}function y(a,b){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=a.chatId;c=(yield d("WAWebDBCommunity").getDefaultSubgroup(c));if(!(c&&b.actionType===d("WAWebGroupType").GROUP_ACTIONS.CREATED_SUBGROUP_SUGGESTION))return;return n(babelHelpers["extends"]({},a,{chatId:c}),b)});return z.apply(this,arguments)}function A(a,b){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(!d("WAWebABProps").getABPropConfigValue("community_transfer_ownership_receiver"))return;var c=a.chatId;c=(yield d("WAWebDBCommunity").getDefaultSubgroup(c));if(!c)return;var e=(yield d("WAWebGroupsParticipantsApi").getParticipants(c));e=Boolean(e==null?void 0:e.participants.find(function(a){return d("WAWebUserPrefsMeUser").isMeAccount(d("WAWebWidFactory").createWid(a))}));if(!e)return;return n(babelHelpers["extends"]({},a,{chatId:c}),b)});return B.apply(this,arguments)}function C(a,b){var d;d=(d=a.externalId)!=null?d:c("WAWebMsgKey").newId_DEPRECATED();b!=null&&(d=""+d+b);return""+d+((b=a.ts)!=null?b:"")}g.genMsgsForGroupCreation=a;g.genGroupNotificationMsg=n;g.genGroupPicChangeNotificationMsg=e;g.genInitialPhashMismatchMsg=f;g.generateDeleteParentNotificationMessages=q;g.genIntegrityDeleteParentNotificationMsgs=s;g.genDescriptionNotificationMsg=u;g.genAllowNonAdminSubGroupCreationNotificationMsg=w;g.genCreatedSubgroupSuggestionNotificationMsg=y;g.genCommunityOwnerUpdateNotificationMsg=A}),98);
__d("WAWebReportingTokenValidationFailureWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumEditType","WAWebWamEnumMediaType","WAWebWamEnumMessageType","WAWebWamEnumReportingTokenValidationFailureReason"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({ReportingTokenValidationFailure:[5466,{editType:[1,d("WAWebWamEnumEditType").EDIT_TYPE],isLid:[5,d("WAWebWamCodegenUtils").TYPES.BOOLEAN],isMessageRetry:[6,d("WAWebWamCodegenUtils").TYPES.BOOLEAN],messageMediaType:[2,d("WAWebWamEnumMediaType").MEDIA_TYPE],messageType:[3,d("WAWebWamEnumMessageType").MESSAGE_TYPE],reportingTokenValidationFailureReason:[4,d("WAWebWamEnumReportingTokenValidationFailureReason").REPORTING_TOKEN_VALIDATION_FAILURE_REASON]},[1,1,1],"regular"]},{ReportingTokenValidationFailure:[]});g.ReportingTokenValidationFailureWamEvent=a}),98);
__d("WAWebWamReportingTokenMismatchReporter",["WAWebMessagingGatingUtils","WAWebMsgGetters","WAWebMsgKeyUtils","WAWebReportingTokenValidationFailureWamEvent","WAWebWamMsgUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.msg,c=a.reason;a=a.isMessageRetry;if(!d("WAWebMessagingGatingUtils").isReportingTokenValidationActionEnabled())return;new(d("WAWebReportingTokenValidationFailureWamEvent").ReportingTokenValidationFailureWamEvent)({editType:d("WAWebMsgGetters").getWamEditType(b),messageMediaType:d("WAWebWamMsgUtils").getWamMediaType(b),messageType:d("WAWebWamMsgUtils").getWamMessageType(b),reportingTokenValidationFailureReason:c,isLid:d("WAWebMsgKeyUtils").isLidMsgKey(b.id,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Message),isMessageRetry:a}).commit()}g.logReportingTokenValidationEvent=a}),98);
__d("WAWebWamEnumCoexStatusReplyPrivacyDisclaimerUserAction",[],(function(a,b,c,d,e,f){a=Object.freeze({DISPLAYED:1,TAPPED:2});f.COEX_STATUS_REPLY_PRIVACY_DISCLAIMER_USER_ACTION=a}),66);
__d("WAWebWamEnumCoexSysMsgInsertionChannel",[],(function(a,b,c,d,e,f){a=Object.freeze({CHAT_OPEN:0,MESSAGE_RECEIVE:1,HISTORY_SYNC:2});f.COEX_SYS_MSG_INSERTION_CHANNEL=a}),66);
__d("WAWebWamEnumCoexSysMsgStateTransitionAttempt",[],(function(a,b,c,d,e,f){a=Object.freeze({E2EE_TO_HOSTED:0,HOSTED_TO_E2EE:1,HOSTED_TO_HOSTED:2});f.COEX_SYS_MSG_STATE_TRANSITION_ATTEMPT=a}),66);
__d("WAWebCoexPrivacySysMsgWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumCoexStatusReplyPrivacyDisclaimerUserAction","WAWebWamEnumCoexSysMsgInsertionChannel","WAWebWamEnumCoexSysMsgStateTransitionAttempt"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({CoexPrivacySysMsg:[5204,{coexStatusReplyPrivacyDisclaimerUserAction:[8,d("WAWebWamEnumCoexStatusReplyPrivacyDisclaimerUserAction").COEX_STATUS_REPLY_PRIVACY_DISCLAIMER_USER_ACTION],coexSysMsgBusinessId:[1,a.TYPES.STRING],coexSysMsgInsertionChannel:[9,d("WAWebWamEnumCoexSysMsgInsertionChannel").COEX_SYS_MSG_INSERTION_CHANNEL],coexSysMsgInsertionErrorCode:[2,a.TYPES.INTEGER],coexSysMsgInsertionErrorMsg:[3,a.TYPES.STRING],coexSysMsgInsertionSuccess:[4,a.TYPES.BOOLEAN],coexSysMsgIsSelf:[5,a.TYPES.BOOLEAN],coexSysMsgMultiDeviceId:[6,a.TYPES.INTEGER],coexSysMsgStateTransitionAttempt:[7,d("WAWebWamEnumCoexSysMsgStateTransitionAttempt").COEX_SYS_MSG_STATE_TRANSITION_ATTEMPT]},[1,1,1],"private",113760892]},{CoexPrivacySysMsg:[]});g.CoexPrivacySysMsgWamEvent=b}),98);
__d("WAWebBizCoexUtils",["WALogger","WATimeUtils","WAWebBizCoexGatingUtils","WAWebCoexPrivacySysMsgWamEvent","WAWebMsgKey","WAWebOfflineDeviceCache","WAWebOfflineHandler","WAWebSchemaChat","WAWebSyncDeviceAdvDeviceListJob","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDevice","WAWebWamEnumCoexSysMsgStateTransitionAttempt","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["comit coex system msg wam event failed with error: "," message: ",""]);h=function(){return a};return a}var i=99,j=["biz_account_type_is_hosted","biz_account_type_changed_to_hosted","biz_me_account_type_is_hosted","biz_me_account_type_is_hosted_transition"],k=new Set(),l=new Set();function a(a){return a.some(function(a){return a.isHosted()})}function e(a,b){if(!d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()||a==null)return;((a=a[0])==null?void 0:a.id)===i&&m(b)}function m(a){!d("WAWebOfflineHandler").OfflineMessageHandler.isResumeFromRestartComplete()?d("WAWebOfflineDeviceCache").OfflinePendingDeviceCache.addOfflinePendingDevice(a.toString(),null):void d("WAWebSyncDeviceAdvDeviceListJob").syncDeviceListJob([a],null,null)}function f(a){return!d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()||a==null?!1:j.includes(a)}function n(a){if(!d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled())return!1;return d("WAWebUserPrefsMultiDevice").getIsHostedMeAccountFromLocalStorage()||a.isHosted===!0?!0:!1}function o(a){if(!d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled())return;q(a.map(function(a){var b=a[0];a[1];return b==null?null:{id:b.id,subtype:b.subtype}}))}function p(a){var b;q([{id:a==null?void 0:(b=a.id)==null?void 0:b.toString(),subtype:a==null?void 0:a.subtype}])}function q(a){try{var b,e=d("WAWebUserPrefsMeUser").getMe(),f=(b=e==null?void 0:e.device)!=null?b:0;a.forEach(function(a){if((a==null?void 0:a.id)==null)return;var b=c("WAWebMsgKey").fromString(a.id),g={coexSysMsgInsertionSuccess:!0,coexSysMsgMultiDeviceId:f,coexSysMsgStateTransitionAttempt:d("WAWebWamEnumCoexSysMsgStateTransitionAttempt").COEX_SYS_MSG_STATE_TRANSITION_ATTEMPT.E2EE_TO_HOSTED};switch(a.subtype){case"biz_account_type_is_hosted":case"biz_account_type_changed_to_hosted":a=new(d("WAWebCoexPrivacySysMsgWamEvent").CoexPrivacySysMsgWamEvent)(g);a.coexSysMsgIsSelf=!1;a.coexSysMsgBusinessId=b.remote.user;a.commit();break;case"biz_me_account_type_is_hosted":case"biz_me_account_type_is_hosted_transition":b=new(d("WAWebCoexPrivacySysMsgWamEvent").CoexPrivacySysMsgWamEvent)(g);b.coexSysMsgIsSelf=!0;b.coexSysMsgBusinessId=(a=e==null?void 0:e.user)!=null?a:"";b.commit();break;default:break}})}catch(a){d("WALogger").ERROR(h(),a.name,a.message).verbose().devConsole(a).sendLogs("comit coex system msg wam event failed")}}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(k.has(a))return!1;var b=(yield d("WAWebSchemaChat").getChatTable().get(a,!1));k.add(a);return!b});return s.apply(this,arguments)}function t(a){k["delete"](a.toString())}function u(a){a=a.toString()+"_"+d("WATimeUtils").unixTime().toString();if(l.has(a))return!0;l.add(a);return!1}function v(){l.clear()}g.HOSTED_DEVICE_ID=i;g.fanoutListContainsHostedDevice=a;g.triggerUsyncForCoexDeviceAdd=e;g.triggerUsyncForCoexUpdate=m;g.isCoexSystemMsgType=f;g.isMeOrCurrentContactHosted=n;g.sendWamCoexPrivacySysMsgInsertSuccess=o;g.sendWamCoexPrivacySysMsgHistorySyncInsert=p;g.shouldCreateFallbackHostedAdvSystemMsgOnPlaceholder=r;g.deleteChatFromFallbackHostedAdvSystemMsgOnPlaceholderCache=t;g.shouldDedupInitialHostedSystemMsg=u;g.clearDedupInitialHostedSystemMsgCache=v}),98);
__d("WAWebParseBotFeedbackProtocolMessageProto",["WAWebBotTypes","WAWebE2EProtoUtils","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.protocolMessage;if(b==null)return;var c=b.type;b=b.botFeedbackMessage;if(c!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.BOT_FEEDBACK_MESSAGE)return;if(b==null)return;c=b.messageKey;var e=b.kind;b=b.text;if(c==null)return;if(e==null)return;var f;switch(e){case d("WAWebProtobufsE2E.pb").Message$BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_POSITIVE:f=d("WAWebBotTypes").BotFeedbackKind.POSITIVE;break;case d("WAWebProtobufsE2E.pb").Message$BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_GENERIC:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_GENERIC;break;case d("WAWebProtobufsE2E.pb").Message$BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_HELPFUL:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_HELPFUL;break;case d("WAWebProtobufsE2E.pb").Message$BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_INTERESTING:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_INTERESTING;break;case d("WAWebProtobufsE2E.pb").Message$BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_ACCURATE:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_ACCURATE;break;case d("WAWebProtobufsE2E.pb").Message$BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_SAFE:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_SAFE;break;case d("WAWebProtobufsE2E.pb").Message$BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_OTHER:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_OTHER;break;case d("WAWebProtobufsE2E.pb").Message$BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_REFUSED:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_REFUSED;break;case d("WAWebProtobufsE2E.pb").Message$BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_NOT_VISUALLY_APPEALING:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_NOT_VISUALLY_APPEALING;break;case d("WAWebProtobufsE2E.pb").Message$BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_NOT_RELEVANT_TO_TEXT:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_NOT_RELEVANT_TO_TEXT;break}if(f==null)return;return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"bot_feedback",protocolMessageKey:d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(c,a),botFeedbackKind:f,botFeedbackText:b}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebBotGating",["WAWebABProps","WAWebBotGenTypingIndicatorMsg","WAWebL10N","WAWebMobilePlatforms","WAWebMsgGetters"],(function(a,b,c,d,e,f,g){function h(){if(d("WAWebMobilePlatforms").isSMB())return!1;return!w()?!1:j()}function i(){return d("WAWebABProps").getABPropConfigValue("bonsai_receiver_enabled")===!0}function j(){return d("WAWebABProps").getABPropConfigValue("bonsai_enabled")===!0}function k(){return d("WAWebABProps").getABPropConfigValue("bonsai_entry_point_enabled")===!0}function a(){return h()||i()}function b(){return h()&&d("WAWebABProps").getABPropConfigValue("bonsai_ptt_enabled")===!0}function e(a){return!h()?!1:Boolean(d("WAWebMsgGetters").getIsMetaBotResponse(a))||a.subtype===d("WAWebBotGenTypingIndicatorMsg").BOT_TYPING_PLACEHOLDER_MSG_SUBTYPE}function f(){return d("WAWebABProps").getABPropConfigValue("wabai_message_rendering_enabled")}function l(){return d("WAWebABProps").getABPropConfigValue("wabai_message_feedback_enabled")}function m(){return d("WAWebABProps").getABPropConfigValue("bot_3p_status")!==0}function n(){return d("WAWebABProps").getABPropConfigValue("bot_3p_status")===2}function o(){return i()&&d("WAWebABProps").getABPropConfigValue("bonsai_carousel_enabled")}function p(){return h()&&k()&&d("WAWebABProps").getABPropConfigValue("bonsai_chat_list_entry_point_enabled")}function q(){return h()&&k()&&!p()}function r(){return d("WAWebABProps").getABPropConfigValue("wabai_consent_cooldown")}function s(){return d("WAWebABProps").getABPropConfigValue("wabai_consent_required")}function t(){return h()&&d("WAWebABProps").getABPropConfigValue("bot_commands_1p_enabled")}var u,v;function w(){var a;a=(a=d("WAWebABProps").getABPropConfigValue("bonsai_supported_languages"))!=null?a:"en";if(v!==a||u==null){var b=a.toLowerCase().split(",").map(function(a){return a.trim()});v=a;u=b.includes(c("WAWebL10N").getLanguage())}return u}function x(){return d("WAWebABProps").getABPropConfigValue("bonsai_fp_ugc_sender")}function y(){return d("WAWebABProps").getABPropConfigValue("ai_ugc_v1_aihome_enabled")||d("WAWebABProps").getABPropConfigValue("bonsai_composer_new_ai_chat_entrypoint_enabled")}function z(){return d("WAWebABProps").getABPropConfigValue("ai_home_bot_profile_sync_interval_sec")*1e3}g.isBotEnabled=h;g.isBotReceiveEnabled=i;g.isBotMsgParseEnabledForFutureproofOrFullRecv=a;g.isBotPttEnabled=b;g.shouldAnimateAsBotStream=e;g.isBizBot1pEnabled=f;g.isBizBot1pFeedbackEnabled=l;g.isBizBot3pEnabled=m;g.isBizBot3pAvailable=n;g.isBotCarouselEnabled=o;g.isBotShortcutEntryPointEnabled=p;g.isBotNewChatEntryPointEnabled=q;g.bizBotConsentDismissalCooldown=r;g.isBizBotConsentRequired=s;g.isMetaBotCommandsEnabled=t;g.isFbidBotEnabled=x;g.isUgcBotEnabled=y;g.ugcBotProfileSyncInterval=z}),98);
__d("WAWebBotGenTypingIndicatorMsg",["WAWebABProps","WAWebBackendApi","WAWebBotGating","WAWebMsgKey","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){f="bot_typing_placeholder";function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebBotGating").isBotEnabled())return;var b=a.id;if(b instanceof c("WAWebWid")&&!b.isBot()&&!((a=a.contact.businessProfile)==null?void 0:a.isBizBot3p))return;a=new(c("WAWebMsgKey"))({fromMe:!1,remote:b,id:c("WAWebMsgKey").newId_DEPRECATED()});d("WAWebBackendApi").frontendFireAndForget("addInitialBotTypingIndicatorToChat",{chatId:b,msgKey:a})});return h.apply(this,arguments)}function e(){var a=d("WAWebABProps").getABPropConfigValue("bonsai_ti_timeout_duration_ms");return a}g.BOT_TYPING_PLACEHOLDER_MSG_SUBTYPE=f;g.genBotTypingIndicatorMessage=a;g.getBotTypingIndicatorTimeout=e}),98);
__d("WAWebParseChatMessageProto",["WAWebE2EProtoUtils","WAWebMsgType","WAWebParseExtendedTextMessageProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.msgContext;var e=b.conversation,f=b.extendedTextMessage;if(e==null&&f==null)return;if(e!=null)return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.CHAT,kind:d("WAWebMsgType").MsgKind.Chat,body:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(e)}),contextInfo:void 0};if(d("WAWebParseExtendedTextMessageProtoUtils").isUrlExtendedTextMessage(f))return;return d("WAWebParseExtendedTextMessageProtoUtils").parseExtendedTextMessageProto({messageProtobuf:b,baseMessage:c,msgContext:a})}g["default"]=a}),98);
__d("WAWebParseExtendedTextUrlChatMessageProto",["WAWebMsgType","WAWebParseExtendedTextMessageProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage,e=a.rcat;a=a.msgContext;var f=b.extendedTextMessage;if(f==null)return;if(!d("WAWebParseExtendedTextMessageProtoUtils").isUrlExtendedTextMessage(f))return;b=d("WAWebParseExtendedTextMessageProtoUtils").parseExtendedTextMessageProto({messageProtobuf:b,baseMessage:c,msgContext:a});a=babelHelpers["extends"]({},c,b==null?void 0:b.msgData,{type:d("WAWebMsgType").MSG_TYPE.CHAT,kind:d("WAWebMsgType").MsgKind.Chat,subtype:"url",rcat:e});return{msgData:a,contextInfo:f==null?void 0:f.contextInfo}}g["default"]=a}),98);
__d("WAWebParseExtendedTextMessageProtoUtils",["WALongInt","WAWebE2EProtoParserApi","WAWebE2EProtoUtils","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){return Boolean(a==null?void 0:a.matchedText)||Boolean(a==null?void 0:a.description)||Boolean(a==null?void 0:a.title)}function b(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.extendedTextMessage;if(b==null)return;var c=d("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$FontType,e;if((b==null?void 0:b.font)!=null)switch(b.font){case c.SYSTEM:case c.SYSTEM_TEXT:case c.FB_SCRIPT:case c.SYSTEM_BOLD:case c.MORNINGBREEZE_REGULAR:case c.CALISTOGA_REGULAR:case c.EXO2_EXTRABOLD:case c.COURIERPRIME_BOLD:e=b.font;break}c=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.CHAT,kind:d("WAWebMsgType").MsgKind.Chat,body:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis((b==null?void 0:b.text)||""),matchedText:b==null?void 0:b.matchedText,description:b==null?void 0:b.description,title:b==null?void 0:b.title,thumbnail:d("WAWebE2EProtoParserApi").decodeBytes(b==null?void 0:b.jpegThumbnail)||"",richPreviewType:b==null?void 0:b.previewType,doNotPlayInline:b==null?void 0:b.doNotPlayInline,textColor:b==null?void 0:b.textArgb,backgroundColor:b==null?void 0:b.backgroundArgb,mediaKey:d("WAWebE2EProtoParserApi").decodeBytes(b==null?void 0:b.mediaKey),mediaKeyTimestamp:(b==null?void 0:b.mediaKeyTimestamp)!=null?d("WALongInt").numberOrThrowIfTooLarge(b.mediaKeyTimestamp):a.mediaKeyTimestamp,thumbnailDirectPath:b==null?void 0:b.thumbnailDirectPath,thumbnailSha256:d("WAWebE2EProtoParserApi").decodeBytes(b==null?void 0:b.thumbnailSha256),thumbnailEncSha256:d("WAWebE2EProtoParserApi").decodeBytes(b==null?void 0:b.thumbnailEncSha256),thumbnailHeight:b==null?void 0:b.thumbnailHeight,thumbnailWidth:b==null?void 0:b.thumbnailWidth,inviteGrpType:(b==null?void 0:b.inviteLinkGroupTypeV2)!=null?d("WAWebE2EProtoParserApi").parseInviteGrpType(b==null?void 0:b.inviteLinkGroupTypeV2):a.inviteGrpType,font:e!=null?e:a.font});return{msgData:c,contextInfo:b==null?void 0:b.contextInfo}}g.isUrlExtendedTextMessage=a;g.parseExtendedTextMessageProto=b}),98);
__d("WAWebAddonCreateMsgProcessor",["WAWebAddonConstants"],(function(a,b,c,d,e,f,g){function a(a){return babelHelpers["extends"]({},a,{type:d("WAWebAddonConstants").AddonProcessorType.Regular})}function b(a){return babelHelpers["extends"]({},a,{type:d("WAWebAddonConstants").AddonProcessorType.DualEncrypted})}function c(a){return babelHelpers["extends"]({},a,{type:d("WAWebAddonConstants").AddonProcessorType.DualEncryptedWithMessageTraits})}g.createAddonMsgProcessor=a;g.createAddonMsgProcessorDualEncrypted=b;g.createAddonMessageProcessorDualEncryptedWithMessageTraits=c}),98);
__d("WAWebAddonCommentMsgProcessor",["Promise","WAWebAddonConstants","WAWebAddonCreateMsgProcessor","WAWebApiChat","WAWebBackendApi","WAWebCommentParseWebMsgInfoComment","WAWebCommentUtils","WAWebDBCommentMessageSerialization","WAWebLastAddOnDBSerialization","WAWebMsgType","WAWebShouldUpdateLastAddOnPreview","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=d("WAWebAddonCreateMsgProcessor").createAddonMessageProcessorDualEncryptedWithMessageTraits({isEnabled:function(){return!0},convert:{fromHistorySyncMsg:function(a){a=d("WAWebCommentParseWebMsgInfoComment").parseWebMsgInfoComment(a);return(h||(h=b("Promise"))).resolve(a)},toDualEncryptedMsgData:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return a.kind===d("WAWebMsgType").MsgKind.CommentEncrypted?a:d("WAWebCommentUtils").commentMsgDataToEncCommentMsgData(a,b)});function c(b,c){return a.apply(this,arguments)}return c}(),toDualDecryptedMsgData:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return a.kind===d("WAWebMsgType").MsgKind.CommentDecrypted?a:d("WAWebCommentUtils").encCommentMsgDataToCommentMsgData(a,b)});function c(b,c){return a.apply(this,arguments)}return c}()},updateCollection:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebBackendApi").frontendSendAndReceive("upsertCommentModelCollection",{comments:a.add,commentsToRemove:a.remove})});function c(b){return a.apply(this,arguments)}return c}(),beforeUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b.parents;var c=[];for(a of a)if(a.kind===d("WAWebMsgType").MsgKind.CommentEncrypted){var e=(yield i.convert.toDualDecryptedMsgData(a,b.getForAddon(a)));c.push(e)}else c.push(a);return c});function c(b,c){return a.apply(this,arguments)}return c}(),afterUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=b.processMode,e=b.parents,f=b.existingPlaceholderKeys;if(c===d("WAWebAddonConstants").AddonProcessMode.SendRetry)return;yield d("WAWebShouldUpdateLastAddOnPreview").filterAndUpdateChatPreviews(a.map(function(a){return d("WAWebLastAddOnDBSerialization").lastAddOnPreviewCandidateFromCommentRowType(d("WAWebDBCommentMessageSerialization").dbRowFromCommentMessage(a))}));if(c===d("WAWebAddonConstants").AddonProcessMode.HistorySync)return;b=f.size>0?a.filter(function(a){return!f.has(a.id.toString())}):a;yield d("WAWebCommentUtils").updateReplyCount(b,e,[]);c=(yield d("WAWebCommentUtils").genChatIdToLastTimestamp(a));yield d("WAWebApiChat").latestChatBulkUpdates(c);d("WAWebBackendApi").frontendFireAndForget("updateChatToLatest",{chatIdToLatestUpdates:c})});function c(b,c){return a.apply(this,arguments)}return c}(),manageNotifications:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WAWebBackendApi").frontendFireAndForget("handleCommentNotification",{comments:a.add,revokes:a.remove})});function c(b){return a.apply(this,arguments)}return c}()});a=i;g["default"]=a}),98);
__d("WACryptoAesGcm",["WABinary","WACryptoDependencies","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c,e,f,g){var j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:g===void 0&&(g=16);j={name:"AES-GCM",iv:i(c),tagLength:g*8};f!=null&&(j.additionalData=i(f));k.t0=d("WACryptoDependencies").getCrypto().subtle;k.t1=j;k.next=7;return b("regeneratorRuntime").awrap(h(a));case 7:k.t2=k.sent;k.t3=e;return k.abrupt("return",k.t0.encrypt.call(k.t0,k.t1,k.t2,k.t3));case 10:case"end":return k.stop()}},null,this)}function c(a,c,e,f,g){var j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:g===void 0&&(g=16);j={name:"AES-GCM",iv:i(c),tagLength:g*8};f!=null&&(j.additionalData=i(f));k.t0=d("WACryptoDependencies").getCrypto().subtle;k.t1=j;k.next=7;return b("regeneratorRuntime").awrap(h(a));case 7:k.t2=k.sent;k.t3=e;return k.abrupt("return",k.t0.decrypt.call(k.t0,k.t1,k.t2,k.t3));case 10:case"end":return k.stop()}},null,this)}function h(a){return d("WACryptoDependencies").getCrypto().subtle.importKey("raw",a,"AES-GCM",!1,["encrypt","decrypt"])}function i(a){if(a instanceof Uint8Array)return a;if(typeof a==="string"){var b=new(d("WABinary").Binary)();b.writeString(a);return b.readByteArray()}return new Uint8Array(a)}g.gcmEncrypt=a;g.gcmDecrypt=c}),98);
__d("WAWebAddonEncryptionError",["$InternalEnum","WALogger","WAWebAddonInfraError","WAWebHandleMsgError","WAWebMessageSecretErrorsWamEvent","WAWebMsgType","WAWebWamEnumE2eFailureReason","WAWebWamEnumMediaType","WAWebWamEnumMessageSecretAllowedType","WAWebWamEnumMessageSecretErrorType"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[DualEncryptionValidationError] missing media type and allowed list value for ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["parent msg "," secret is not 32 bytes"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["parent msg "," secret is missing"]);j=function(){return a};return a}var k=b("$InternalEnum")({MISSING_MESSAGE_SECRET:"missing_message_secret",WRONG_MESSAGE_SECRET_LENGTH:"wrong_message_secret_length",ENCRYPTION_ERROR:"encryption_error",DECRYPTION_ERROR:"decryption_error"}),l=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c){var d="addonType: "+a+", errorCode: "+String(c);d=b.call(this,d,q(c))||this;d.name="DualEncryptionValidationError";m(a,c);return d}return a}(d("WAWebHandleMsgError").MessageValidationError);a=function(a,b){var c=b.messageSecret;if(c==null){d("WALogger").LOG(j(),b.id);throw new l(a,k.MISSING_MESSAGE_SECRET)}if(c.length!==32){d("WALogger").LOG(i(),b.id);throw new l(a,k.WRONG_MESSAGE_SECRET_LENGTH)}return c};function m(a,b){var c=n(a),e=o(a);if(c==null||e==null){d("WALogger").ERROR(h(),a).sendLogs("dual-encryption-validation-error");throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError)}new(d("WAWebMessageSecretErrorsWamEvent").MessageSecretErrorsWamEvent)({messageSecretError:p(b),messageMediaType:c,messageSecretAllowedList:e}).commit()}function n(a){switch(a){case d("WAWebMsgType").MsgKind.PollVoteEncrypted:case d("WAWebMsgType").MsgKind.PollVoteDecrypted:return d("WAWebWamEnumMediaType").MEDIA_TYPE.POLL_VOTE;case d("WAWebMsgType").MsgKind.ReactionEncrypted:case d("WAWebMsgType").MsgKind.ReactionDecrypted:return d("WAWebWamEnumMediaType").MEDIA_TYPE.REACTION;case d("WAWebMsgType").MsgKind.EventResponseEncrypted:case d("WAWebMsgType").MsgKind.EventResponseDecrypted:return d("WAWebWamEnumMediaType").MEDIA_TYPE.EVENT_RESPOND;case d("WAWebMsgType").MsgKind.EventEditEncrypted:case d("WAWebMsgType").MsgKind.EventEditDecrypted:return d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case d("WAWebMsgType").MsgKind.CommentEncrypted:case d("WAWebMsgType").MsgKind.CommentDecrypted:return d("WAWebWamEnumMediaType").MEDIA_TYPE.COMMENT;default:return}}function o(a){switch(a){case d("WAWebMsgType").MsgKind.PollVoteEncrypted:case d("WAWebMsgType").MsgKind.PollVoteDecrypted:return d("WAWebWamEnumMessageSecretAllowedType").MESSAGE_SECRET_ALLOWED_TYPE.MESSAGE_POLL;case d("WAWebMsgType").MsgKind.ReactionEncrypted:case d("WAWebMsgType").MsgKind.ReactionDecrypted:return d("WAWebWamEnumMessageSecretAllowedType").MESSAGE_SECRET_ALLOWED_TYPE.REACTION;case d("WAWebMsgType").MsgKind.EventResponseEncrypted:case d("WAWebMsgType").MsgKind.EventResponseDecrypted:return d("WAWebWamEnumMessageSecretAllowedType").MESSAGE_SECRET_ALLOWED_TYPE.EVENT_RESPONSE;case d("WAWebMsgType").MsgKind.EventEditEncrypted:case d("WAWebMsgType").MsgKind.EventEditDecrypted:return d("WAWebWamEnumMessageSecretAllowedType").MESSAGE_SECRET_ALLOWED_TYPE.MESSAGE_EVENT_EDIT;case d("WAWebMsgType").MsgKind.CommentEncrypted:case d("WAWebMsgType").MsgKind.CommentDecrypted:return d("WAWebWamEnumMessageSecretAllowedType").MESSAGE_SECRET_ALLOWED_TYPE.COMMENT;default:return}}function p(a){switch(a){case k.MISSING_MESSAGE_SECRET:return d("WAWebWamEnumMessageSecretErrorType").MESSAGE_SECRET_ERROR_TYPE.MISSING_MESSAGE_SECRET;case k.WRONG_MESSAGE_SECRET_LENGTH:return d("WAWebWamEnumMessageSecretErrorType").MESSAGE_SECRET_ERROR_TYPE.WRONG_LENGTH;case k.ENCRYPTION_ERROR:return d("WAWebWamEnumMessageSecretErrorType").MESSAGE_SECRET_ERROR_TYPE.ENCRYPTION_ERROR;case k.DECRYPTION_ERROR:return d("WAWebWamEnumMessageSecretErrorType").MESSAGE_SECRET_ERROR_TYPE.DECRYPTION_ERROR}}function q(a){switch(a){case k.MISSING_MESSAGE_SECRET:return d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.MISSING_MESSAGE_SECRET;case k.WRONG_MESSAGE_SECRET_LENGTH:return d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.MESSAGE_SECRET_INVALID;case k.ENCRYPTION_ERROR:return d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE;case k.DECRYPTION_ERROR:return d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.DECRYPTION_FAILED}}g.DualEncryptionValidationErrorCode=k;g.DualEncryptionValidationError=l;g.getValidatedMessageSecret=a}),98);
__d("WAWebAddonEncryption",["WACryptoAesGcm","WALogger","WANullthrows","WAUseCaseSecret","WAWebAddonEncryptionError","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebWidToJid","asyncToGeneratorRuntime","encodeProtobuf"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed decrypting an addon "," "," ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed encrypting an addon "," "," ",""]);i=function(){return a};return a}function j(a,b){switch(a){case d("WAWebMsgType").MsgKind.PollVoteEncrypted:case d("WAWebMsgType").MsgKind.PollVoteDecrypted:return b.stanzaId+"\0"+b.addOnSenderJid;case d("WAWebMsgType").MsgKind.EventResponseEncrypted:case d("WAWebMsgType").MsgKind.EventResponseDecrypted:return b.stanzaId+"\0"+b.addOnSenderJid;default:return}}function a(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=b.messageSecret,f=b.iv,g=b.stanzaId,h=b.originalMessageSender;b=b.addOnSender;try{b=d("WAWebWidToJid").widToUserJid(b);var k=c("WANullthrows")(m(a.type)),l=k.spec;k=k.usecase;e=(yield d("WAUseCaseSecret").createUseCaseSecret({messageSecret:e,stanzaId:g,parentMsgOriginalSender:d("WAWebWidToJid").widToUserJid(h),modificationSender:b,modificationType:k}));h=d("encodeProtobuf").encodeProtobuf(l,a.encode).readBuffer();k=(yield d("WACryptoAesGcm").gcmEncrypt(e,f,h,j(a.type,{stanzaId:g,addOnSenderJid:b})));return k}catch(b){d("WALogger").LOG(i(),g,a.type,b);throw new(d("WAWebAddonEncryptionError").DualEncryptionValidationError)(a.type,d("WAWebAddonEncryptionError").DualEncryptionValidationErrorCode.ENCRYPTION_ERROR)}});return k.apply(this,arguments)}function e(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=b.messageSecret,f=b.iv,g=b.stanzaId,i=b.originalMessageSender;b=b.addOnSender;try{b=d("WAWebWidToJid").widToUserJid(b);var k=c("WANullthrows")(m(a.type));k=k.usecase;e=(yield d("WAUseCaseSecret").createUseCaseSecret({messageSecret:e,stanzaId:g,parentMsgOriginalSender:d("WAWebWidToJid").widToUserJid(i),modificationSender:b,modificationType:k}));i=(yield d("WACryptoAesGcm").gcmDecrypt(e,f,a.encryptedAddOn,j(a.type,{stanzaId:g,addOnSenderJid:b})));return i}catch(b){d("WALogger").LOG(h(),g,a.type,b);throw new(d("WAWebAddonEncryptionError").DualEncryptionValidationError)(a.type,d("WAWebAddonEncryptionError").DualEncryptionValidationErrorCode.DECRYPTION_ERROR)}});return l.apply(this,arguments)}function m(a){switch(a){case d("WAWebMsgType").MsgKind.ReactionEncrypted:case d("WAWebMsgType").MsgKind.ReactionDecrypted:return{spec:d("WAWebProtobufsE2E.pb").Message$ReactionMessageSpec,usecase:d("WAUseCaseSecret").UseCaseSecretModificationType.ENC_REACTION};case d("WAWebMsgType").MsgKind.PollVoteEncrypted:case d("WAWebMsgType").MsgKind.PollVoteDecrypted:return{spec:d("WAWebProtobufsE2E.pb").Message$PollVoteMessageSpec,usecase:d("WAUseCaseSecret").UseCaseSecretModificationType.POLL_VOTE};case d("WAWebMsgType").MsgKind.CommentEncrypted:case d("WAWebMsgType").MsgKind.CommentDecrypted:return{spec:d("WAWebProtobufsE2E.pb").MessageSpec,usecase:d("WAUseCaseSecret").UseCaseSecretModificationType.ENC_COMMENT};case d("WAWebMsgType").MsgKind.EventResponseEncrypted:case d("WAWebMsgType").MsgKind.EventResponseDecrypted:return{spec:d("WAWebProtobufsE2E.pb").Message$EventResponseMessageSpec,usecase:d("WAUseCaseSecret").UseCaseSecretModificationType.EVENT_RESPONSE};case d("WAWebMsgType").MsgKind.EventEditEncrypted:case d("WAWebMsgType").MsgKind.EventEditDecrypted:return{spec:d("WAWebProtobufsE2E.pb").MessageSpec,usecase:d("WAUseCaseSecret").UseCaseSecretModificationType.EVENT_EDIT_ENCRYPTED}}}g.encryptAddOn=a;g.decryptAddOn=e}),98);
__d("WAWebApiUpdateReplyCount",["WAWebSchemaMessage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=[];for(a of a){var e=a[0],f=a[1],g=b.getByParentMsgKey(e);if(g==null)continue;g=(g=g.replyCount)!=null?g:0;c.push({id:e,replyCount:g+f})}yield d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(c)});return h.apply(this,arguments)}g.updateReplyCountInParentMsgs=a}),98);
__d("WAWebCommentGroupBy",[],(function(a,b,c,d,e,f){function a(a,b){var c=new Map();for(var a=a,d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f,g;if(d){if(e>=a.length)break;g=a[e++]}else{e=a.next();if(e.done)break;g=e.value}g=g;g=g.parentMsgKey.toString();f=(f=c.get(g))!=null?f:0;c.set(g,f+1)}for(g=b,f=Array.isArray(g),e=0,g=f?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(f){if(e>=g.length)break;d=g[e++]}else{e=g.next();if(e.done)break;d=e.value}a=d;b=a.parentMsgKey.toString();a=(d=c.get(b))!=null?d:0;c.set(b,a-1)}return c}f.commentCountByParents=a}),66);
__d("WAWebCommentMessageValidationError",["$InternalEnum","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({MISSING_COMMENT_ENC_IV:"comment_missing_enc_iv",MISSING_COMMENT_ENC_PAYLOAD:"comment_missing_enc_payload",MISSING_COMMENT_MESSAGE_KEY:"comment_missing_target_message_key",INVALID_COMMENT_ENC_IV:"comment_invalid_enc_iv",MISSING_COMMENT_SENDER:"comment_missing_sender",MISSING_MESSAGE_SECRET:"comment_parent_missing_message_secret",MISSING_ORIGINAL_MESSAGE_SENDER:"comment_missing_original_message_sender",MISSING_COMMENT_CONTENT:"comment_missing_comment_content"});c=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="CommentMessageValidationError",b)||babelHelpers.assertThisInitialized(c)}return b}(d("WAWebHandleMsgError").MessageValidationError);g.CommentMessageValidationErrorCode=a;g.CommentMessageValidationError=c}),98);
__d("WAWebCommentMsgDataConversion",["WANullthrows","WAWebCommentMessageValidationError","WAWebMsgType","WAWebViewMode.flow","WAWebWamEnumE2eFailureReason","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function h(a){var b;return(b=a.conversation)!=null?b:(b=a.extendedTextMessage)==null?void 0:b.text}function a(a,b){a=h(a);if(a==null)throw new(d("WAWebCommentMessageValidationError").CommentMessageValidationError)(d("WAWebCommentMessageValidationError").CommentMessageValidationErrorCode.MISSING_COMMENT_CONTENT,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{ack:b.ack,body:a,from:b.from,to:b.to,id:b.id,parentMsgKey:b.targetMessageKey,author:d("WAWebWidFactory").toUserWid(c("WANullthrows")(b.author)),t:b.t,type:d("WAWebMsgType").MSG_TYPE.COMMENT,kind:d("WAWebMsgType").MsgKind.CommentDecrypted,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,read:!1}}g.extractCommentTextFromMessage=h;g.convertMessageToCommentMsgData=a}),98);
__d("WAWebReferentialMsgKey",["WAWebMsgKey","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){if(a.broadcastId&&d("WAWebWidFactory").isWidlike(a.broadcastId)){var b=a.id;return new(c("WAWebMsgKey"))({fromMe:b.fromMe,remote:d("WAWebWidFactory").createWidFromWidLike(a.broadcastId),id:b.id,participant:b.remote})}return a.id}g.getReferentialMsgKey=a}),98);
__d("WAWebCommentUtils",["WANullthrows","WAWebAddonEncryption","WAWebAddonEncryptionError","WAWebApiUpdateReplyCount","WAWebBackendApi","WAWebCommentGroupBy","WAWebCommentMsgDataConversion","WAWebMsgGetters","WAWebMsgKeyUtils","WAWebMsgType","WAWebProcessCommentMsg","WAWebReferentialMsgKey","WAWebSchemaChat","WAWebViewMode.flow","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Map();for(a of a){var c=a.id.remote.toString(),e=a.t;if(e==null)continue;var f=b.get(c);b.set(c,{id:c.toString(),t:Math.max(e,(c=f==null?void 0:f.t)!=null?c:0),unreadCount:(f==null?void 0:f.unreadCount)!=null?f.unreadCount+1:1})}for(e of b.entries()){c=e[0];f=e[1];a=(yield d("WAWebSchemaChat").getChatTable().get(c));a!=null&&f.unreadCount!=null&&(f.unreadCount+=a.unreadCount)}c=Array.from(b.values());return c});return h.apply(this,arguments)}function i(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=self.crypto.getRandomValues(new Uint8Array(12));e={type:d("WAWebMsgType").MsgKind.CommentDecrypted,encode:e};var g=d("WAWebAddonEncryptionError").getValidatedMessageSecret(d("WAWebMsgType").MsgKind.CommentDecrypted,a);e=(yield d("WAWebAddonEncryption").encryptAddOn(e,{messageSecret:g,iv:f,originalMessageSender:d("WAWebWidFactory").toUserWid(c("WANullthrows")(d("WAWebMsgGetters").getSender(a))),addOnSender:d("WAWebWidFactory").toUserWid(b),stanzaId:a.id.id}));return{encIv:f.buffer,encPayload:e,targetMessageKey:d("WAWebReferentialMsgKey").getReferentialMsgKey(a)}});return j.apply(this,arguments)}function e(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=d("WAWebCommentGroupBy").commentCountByParents(a,c);yield d("WAWebApiUpdateReplyCount").updateReplyCountInParentMsgs(a,b);d("WAWebBackendApi").frontendFireAndForget("updateReplyCount",{replyCountMap:a})});return k.apply(this,arguments)}function f(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("WAWebProcessCommentMsg").processEncCommentMsg(a,b));return d("WAWebCommentMsgDataConversion").convertMessageToCommentMsgData(b,a)});return l.apply(this,arguments)}function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e={conversation:a.body},f=d("WAWebWidFactory").toUserWid(c("WANullthrows")(d("WAWebMsgGetters").getSender(a)));return babelHelpers["extends"]({id:a.id},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(a.id,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),yield i(b,f,e),{type:d("WAWebMsgType").MSG_TYPE.COMMENT,kind:d("WAWebMsgType").MsgKind.CommentEncrypted,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,t:a.t,addonEncrypted:!0,ack:a.ack})});return n.apply(this,arguments)}g.genChatIdToLastTimestamp=a;g.getEncCommentsFields=i;g.updateReplyCount=e;g.encCommentMsgDataToCommentMsgData=f;g.commentMsgDataToEncCommentMsgData=m}),98);
__d("WAWebProcessCommentMsg",["WAWebAddonEncryption","WAWebAddonEncryptionError","WAWebCommentMessageValidationError","WAWebMsgGetters","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebWamEnumE2eFailureReason","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=a.targetMessageKey,e=a.encIv,f=a.encPayload;if(e==null)throw new(d("WAWebCommentMessageValidationError").CommentMessageValidationError)(d("WAWebCommentMessageValidationError").CommentMessageValidationErrorCode.MISSING_COMMENT_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(f==null)throw new(d("WAWebCommentMessageValidationError").CommentMessageValidationError)(d("WAWebCommentMessageValidationError").CommentMessageValidationErrorCode.MISSING_COMMENT_ENC_PAYLOAD,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(c==null)throw new(d("WAWebCommentMessageValidationError").CommentMessageValidationError)(d("WAWebCommentMessageValidationError").CommentMessageValidationErrorCode.MISSING_COMMENT_MESSAGE_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);c=a.author?a.author:a.id.participant;a=d("WAWebMsgGetters").getOriginalSender(b);if(c==null)throw new(d("WAWebCommentMessageValidationError").CommentMessageValidationError)(d("WAWebCommentMessageValidationError").CommentMessageValidationErrorCode.MISSING_COMMENT_SENDER,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a==null)throw new(d("WAWebCommentMessageValidationError").CommentMessageValidationError)(d("WAWebCommentMessageValidationError").CommentMessageValidationErrorCode.MISSING_ORIGINAL_MESSAGE_SENDER,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);f={type:d("WAWebMsgType").MsgKind.CommentEncrypted,encryptedAddOn:f};var g=d("WAWebAddonEncryptionError").getValidatedMessageSecret(d("WAWebMsgType").MsgKind.CommentEncrypted,b);f=(yield d("WAWebAddonEncryption").decryptAddOn(f,{messageSecret:g,iv:e,stanzaId:b.id.id,originalMessageSender:a,addOnSender:d("WAWebWidFactory").toUserWid(c)}));return d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsE2E.pb").MessageSpec,f)});return h.apply(this,arguments)}g.processEncCommentMsg=a}),98);
__d("WAWebDBCommentMessageSerialization",["WANullthrows","WAWebDBMessageSerialization","WAWebMsgGetters","WAWebMsgKey","WAWebMsgKeyUtils","WAWebMsgType","WAWebViewMode.flow","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){a=babelHelpers["extends"]({},a);d("WAWebDBMessageSerialization").movEncFieldToOpaqueData(a);return babelHelpers["extends"]({},a,{msgKey:a.id.toString(),parentMsgKey:a.parentMsgKey.toString(),sender:a.author.toString()})}function b(a){var b;return{msgKey:a.id.toString(),sender:c("WANullthrows")(d("WAWebMsgGetters").getSender(a),"undefined sender").toString(),parentMsgKey:a.parentMsgKey.toString(),t:d("WAWebMsgGetters").getT(a),ack:(b=d("WAWebMsgGetters").getAck(a))!=null?b:void 0,read:a.read,isOverwrittenByRevoke:!0,subtype:a.subtype,revokeTimestamp:a.revokeTimestamp,protocolMessageKey:a.protocolMessageKey.toString()}}function e(a){return{isPlaceholder:!0,msgKey:a.id.toString(),sender:c("WANullthrows")(d("WAWebMsgGetters").getSender(a),"undefined sender").toString(),parentMsgKey:a.parentMsgKey.toString(),read:a.read,t:d("WAWebMsgGetters").getT(a)}}function f(a){var b=c("WAWebMsgKey").from(a.msgKey),e=c("WAWebMsgKey").from(a.parentMsgKey);e=babelHelpers["extends"]({id:b,parentMsgKey:e,ack:a.ack,t:a.t},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(b,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE});if(a.isOverwrittenByRevoke===!0){return babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.REVOKED,kind:d("WAWebMsgType").MsgKind.RevokedAddon,subtype:c("WANullthrows")(a.subtype),revokeAddonType:d("WAWebMsgType").MSG_TYPE.COMMENT,revokeTimestamp:(b=a.revokeTimestamp)!=null?b:void 0,protocolMessageKey:c("WAWebMsgKey").from(c("WANullthrows")(a.protocolMessageKey,"undefined protocolMessageKey"))})}if(a.isPlaceholder===!0)return babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.CIPHERTEXT,kind:d("WAWebMsgType").MsgKind.PlaceholderAddon,realType:d("WAWebMsgType").MSG_TYPE.COMMENT});b=babelHelpers["extends"]({},a);d("WAWebDBMessageSerialization").movFieldFromOpaqueDataBackToMsg(b);return babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.COMMENT,kind:d("WAWebMsgType").MsgKind.CommentDecrypted,from:d("WAWebWidFactory").createUserWid(b.sender),body:b.body,author:d("WAWebWidFactory").createUserWid(b.sender),read:(e=a.read)!=null?e:!1})}g.dbRowFromCommentMessage=a;g.dbRowFromRevokedMsgData=b;g.dbRowFromPlaceholderAddon=e;g.commentMessageFromDbRow=f}),98);
__d("WAWebCommentParseWebMsgInfoComment",["WALogger","WALongInt","WANullthrows","WAWebAddOnParseWebMsgInfo","WAWebCommentMsgDataConversion","WAWebMsgKeyUtils","WAWebMsgType","WAWebParseWebMessageInfoApi","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[parseWebMsgInfoComment] failed to parse comment revoke "," with error ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[parseWebMsgInfoComment] has revoke stub ",", parameters ",""]);i=function(){return a};return a}function j(a){var b,e=a.webMsgInfo;a=a.isFromCag;b=e==null?void 0:(b=e.message)==null?void 0:b.commentMessage;var f=e==null?void 0:e.commentMetadata,g=[];if(e==null||(f==null?void 0:f.commentParentKey)==null)return g;a=c("WANullthrows")(d("WAWebAddOnParseWebMsgInfo").buildAddonMsgKey(e.key,a,e.participant));a=a.msgKey;var k=c("WANullthrows")(e.messageTimestamp),l;(b==null?void 0:b.message)!=null&&(l=d("WAWebCommentMsgDataConversion").extractCommentTextFromMessage(b.message));if(l==null){f=c("WANullthrows")(d("WAWebParseWebMessageInfoApi").buildMsgKey(e,c("WANullthrows")(f==null?void 0:f.commentParentKey)));f=f.msgKey;try{var m=d("WAWebParseWebMessageInfoApi").parseMsgStubProto(e,j);f=babelHelpers["extends"]({id:a,parentMsgKey:f},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(a,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{revokeAddonType:d("WAWebMsgType").MSG_TYPE.COMMENT,protocolMessageKey:m.protocolMessageKey,subtype:m.subtype,kind:d("WAWebMsgType").MsgKind.RevokedAddon,revokeTimestamp:d("WALongInt").numberOrThrowIfTooLarge(c("WANullthrows")(e.revokeMessageTimestamp)),type:d("WAWebMsgType").MSG_TYPE.REVOKED,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,t:d("WALongInt").numberOrThrowIfTooLarge(k)});g.push(f)}catch(a){d("WALogger").LOG(i(),Boolean(e.messageStubType),(m=e.messageStubParameters)==null?void 0:m.length);d("WALogger").ERROR(h(),e.key.id,a).sendLogs("parse-comment-revoke",{sampling:.01})}}else if(b!=null){f=c("WANullthrows")(b.targetMessageKey);m=c("WANullthrows")(d("WAWebParseWebMessageInfoApi").buildMsgKey(e,f));b=m.msgKey;g.push(babelHelpers["extends"]({id:a,parentMsgKey:b},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(a,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{body:l,type:d("WAWebMsgType").MSG_TYPE.COMMENT,read:!0,kind:d("WAWebMsgType").MsgKind.CommentDecrypted,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,t:d("WALongInt").numberOrThrowIfTooLarge(k)}))}return g}g.parseWebMsgInfoComment=j}),98);
__d("WAWebParseEncCommentMessageProto",["WAWebCommentMessageValidationError","WAWebE2EProtoUtils","WAWebMsgType","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.encCommentMessage;if(b==null)return;var c=b.encIv,e=b.encPayload;b=b.targetMessageKey;if(c==null)throw new(d("WAWebCommentMessageValidationError").CommentMessageValidationError)(d("WAWebCommentMessageValidationError").CommentMessageValidationErrorCode.MISSING_COMMENT_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(e==null)throw new(d("WAWebCommentMessageValidationError").CommentMessageValidationError)(d("WAWebCommentMessageValidationError").CommentMessageValidationErrorCode.MISSING_COMMENT_ENC_PAYLOAD,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);b=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(b,a);if(b==null)throw new(d("WAWebCommentMessageValidationError").CommentMessageValidationError)(d("WAWebCommentMessageValidationError").CommentMessageValidationErrorCode.MISSING_COMMENT_MESSAGE_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(c.byteLength!==12)throw new(d("WAWebCommentMessageValidationError").CommentMessageValidationError)(d("WAWebCommentMessageValidationError").CommentMessageValidationErrorCode.INVALID_COMMENT_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.COMMENT,kind:d("WAWebMsgType").MsgKind.CommentEncrypted,addonEncrypted:!0,encIv:c,encPayload:e,targetMessageKey:b}),contextInfo:null}}g["default"]=a}),98);
__d("WASmaxInBizCtwaAdAccountIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);
__d("WASmaxInBizCtwaAdAccountHackBaseIQErrorResponseMixin",["WAResultOrError","WASmaxInBizCtwaAdAccountIQErrorResponseMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"to");if(!c.success)return c;a=d("WASmaxInBizCtwaAdAccountIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({to:c.value},a.value))}g.parseHackBaseIQErrorResponseMixin=a}),98);
__d("WASmaxInBizCtwaAdAccountIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","bad-request");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",400);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorBadRequestMixin=a}),98);
__d("WASmaxInBizCtwaAdAccountIQErrorForbiddenMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","forbidden");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",403);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorForbiddenMixin=a}),98);
__d("WASmaxInBizCtwaAdAccountIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","internal-server-error");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",500);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorInternalServerErrorMixin=a}),98);
__d("WASmaxInBizCtwaAdAccountIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","service-unavailable");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",503);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorServiceUnavailableMixin=a}),98);
__d("WASmaxInBizCtwaAdAccountIQErrorBadRequestOrForbiddenOrInternalServerErrorOrServiceUnavailableMixinGroup",["WAResultOrError","WASmaxInBizCtwaAdAccountIQErrorBadRequestMixin","WASmaxInBizCtwaAdAccountIQErrorForbiddenMixin","WASmaxInBizCtwaAdAccountIQErrorInternalServerErrorMixin","WASmaxInBizCtwaAdAccountIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInBizCtwaAdAccountIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:b.value});var c=d("WASmaxInBizCtwaAdAccountIQErrorForbiddenMixin").parseIQErrorForbiddenMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorForbidden",value:c.value});var e=d("WASmaxInBizCtwaAdAccountIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:e.value});var f=d("WASmaxInBizCtwaAdAccountIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(a);return f.success?d("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorBadRequest","IQErrorForbidden","IQErrorInternalServerError","IQErrorServiceUnavailable"],[b,c,e,f])}g.parseIQErrorBadRequestOrForbiddenOrInternalServerErrorOrServiceUnavailableMixinGroup=a}),98);
__d("WASmaxInBizCtwaAdAccountGetAccessTokenAndSessionCookiesResponseError",["WAResultOrError","WASmaxInBizCtwaAdAccountHackBaseIQErrorResponseMixin","WASmaxInBizCtwaAdAccountIQErrorBadRequestOrForbiddenOrInternalServerErrorOrServiceUnavailableMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInBizCtwaAdAccountHackBaseIQErrorResponseMixin").parseHackBaseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInBizCtwaAdAccountIQErrorBadRequestOrForbiddenOrInternalServerErrorOrServiceUnavailableMixinGroup").parseIQErrorBadRequestOrForbiddenOrInternalServerErrorOrServiceUnavailableMixinGroup(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorIQErrorBadRequestOrForbiddenOrInternalServerErrorOrServiceUnavailableMixinGroup:b.value}))}g.parseGetAccessTokenAndSessionCookiesResponseError=a}),98);
__d("WASmaxInBizCtwaAdAccountGetAccessTokenAndSessionCookiesResponseIncorrectNonce",["WAResultOrError","WASmaxInBizCtwaAdAccountHackBaseIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;var e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,c.value,"code","432");if(!e.success)return e;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,c.value,"text","INCORRECT_NONCE");if(!c.success)return c;a=d("WASmaxInBizCtwaAdAccountHackBaseIQErrorResponseMixin").parseHackBaseIQErrorResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorCode:e.value,errorText:c.value},a.value))}g.parseGetAccessTokenAndSessionCookiesResponseIncorrectNonce=a}),98);
__d("WASmaxInBizCtwaAdAccountIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);
__d("WASmaxInBizCtwaAdAccountHackBaseIQResultResponseMixin",["WAResultOrError","WASmaxInBizCtwaAdAccountIQResultResponseMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"to");if(!c.success)return c;a=d("WASmaxInBizCtwaAdAccountIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({to:c.value},a.value))}g.parseHackBaseIQResultResponseMixin=a}),98);
__d("WASmaxInBizCtwaAdAccountGetAccessTokenAndSessionCookiesResponseSuccess",["WAResultOrError","WASmaxInBizCtwaAdAccountHackBaseIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"access_token");if(!c.success)return c;var e=d("WASmaxParseUtils").flattenedChildWithTag(a,"session_cookies");if(!e.success)return e;var f=d("WASmaxParseUtils").flattenedChildWithTag(a,"business_person");if(!f.success)return f;c=d("WASmaxParseUtils").contentString(c.value);if(!c.success)return c;e=d("WASmaxParseUtils").contentString(e.value);if(!e.success)return e;f=d("WASmaxParseUtils").attrString(f.value,"id");if(!f.success)return f;a=d("WASmaxInBizCtwaAdAccountHackBaseIQResultResponseMixin").parseHackBaseIQResultResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({accessTokenElementValue:c.value,sessionCookiesElementValue:e.value,businessPersonId:f.value},a.value))}g.parseGetAccessTokenAndSessionCookiesResponseSuccess=a}),98);
__d("WASmaxInBizCtwaAdAccountGetAccessTokenAndSessionCookiesResponseTooManyAttempts",["WAResultOrError","WASmaxInBizCtwaAdAccountHackBaseIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;var e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,c.value,"code","431");if(!e.success)return e;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,c.value,"text","TOO_MANY_ATTEMPTS");if(!c.success)return c;a=d("WASmaxInBizCtwaAdAccountHackBaseIQErrorResponseMixin").parseHackBaseIQErrorResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorCode:e.value,errorText:c.value},a.value))}g.parseGetAccessTokenAndSessionCookiesResponseTooManyAttempts=a}),98);
__d("WASmaxOutBizCtwaAdAccountBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"get"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQGetRequestMixin=a}),98);
__d("WASmaxOutBizCtwaAdAccountHackBaseIQGetRequestMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutBizCtwaAdAccountBaseIQGetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.iqFrom;a=d("WASmaxOutBizCtwaAdAccountBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(d("WASmaxJsx").smax("iq",{from:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,a),to:d("WAWap").S_WHATSAPP_NET}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeHackBaseIQGetRequestMixin=a}),98);
__d("WASmaxOutBizCtwaAdAccountGetAccessTokenAndSessionCookiesRequest",["WASmaxJsx","WASmaxOutBizCtwaAdAccountHackBaseIQGetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=a.codeElementValue;b=d("WASmaxOutBizCtwaAdAccountHackBaseIQGetRequestMixin").mergeHackBaseIQGetRequestMixin(d("WASmaxJsx").smax("iq",{xmlns:"fb:thrift_iq",smax_id:d("WAWap").INT(104)},d("WASmaxJsx").smax("parameters",null,d("WASmaxJsx").smax("code",null,b))),a);return b}g.makeGetAccessTokenAndSessionCookiesRequest=a}),98);
__d("WASmaxBizCtwaAdAccountGetAccessTokenAndSessionCookiesRPC",["WAComms","WASmaxInBizCtwaAdAccountGetAccessTokenAndSessionCookiesResponseError","WASmaxInBizCtwaAdAccountGetAccessTokenAndSessionCookiesResponseIncorrectNonce","WASmaxInBizCtwaAdAccountGetAccessTokenAndSessionCookiesResponseSuccess","WASmaxInBizCtwaAdAccountGetAccessTokenAndSessionCookiesResponseTooManyAttempts","WASmaxOutBizCtwaAdAccountGetAccessTokenAndSessionCookiesRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:e=d("WASmaxOutBizCtwaAdAccountGetAccessTokenAndSessionCookiesRequest").makeGetAccessTokenAndSessionCookiesRequest(a);k.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=k.sent;g=d("WASmaxInBizCtwaAdAccountGetAccessTokenAndSessionCookiesResponseSuccess").parseGetAccessTokenAndSessionCookiesResponseSuccess(f,e);if(!g.success){k.next=7;break}return k.abrupt("return",{name:"GetAccessTokenAndSessionCookiesResponseSuccess",value:g.value});case 7:h=d("WASmaxInBizCtwaAdAccountGetAccessTokenAndSessionCookiesResponseTooManyAttempts").parseGetAccessTokenAndSessionCookiesResponseTooManyAttempts(f,e);if(!h.success){k.next=10;break}return k.abrupt("return",{name:"GetAccessTokenAndSessionCookiesResponseTooManyAttempts",value:h.value});case 10:i=d("WASmaxInBizCtwaAdAccountGetAccessTokenAndSessionCookiesResponseIncorrectNonce").parseGetAccessTokenAndSessionCookiesResponseIncorrectNonce(f,e);if(!i.success){k.next=13;break}return k.abrupt("return",{name:"GetAccessTokenAndSessionCookiesResponseIncorrectNonce",value:i.value});case 13:j=d("WASmaxInBizCtwaAdAccountGetAccessTokenAndSessionCookiesResponseError").parseGetAccessTokenAndSessionCookiesResponseError(f,e);if(!j.success){k.next=16;break}return k.abrupt("return",{name:"GetAccessTokenAndSessionCookiesResponseError",value:j.value});case 16:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("GetAccessTokenAndSessionCookies",{Success:g,TooManyAttempts:h,IncorrectNonce:i,Error:j}));case 17:case"end":return k.stop()}},null,this)}g.sendGetAccessTokenAndSessionCookiesRPC=a}),98);
__d("WAWebCommonAdsTypes",["$InternalEnum"],(function(a,b,c,d,e,f){e=b("$InternalEnum").Mirrored(["ACTIVE","AUTHENTICATION_NEEDED","CREATING","EXTENDABLE","FINISHED","LIMITED_DELIVERY","NOT_DELIVERING","PAUSED","PENDING","REJECTED","REVIEW_NEEDED","SCHEDULED","ERROR","UNKNOWN"]);function a(a){return a}function c(a){return a}function d(a){return a}f.BoostingStatusEnum=e;f.asAdId=a;f.asAdCampaignGroupId=c;f.asAdAccountToken=d}),66);
__d("WAWebFailureErrorCodes",[],(function(a,b,c,d,e,f){a={REASON_GENERIC_FAILURE:400,REASON_NOT_AUTHORIZED:401,REASON_TEMP_BANNED:402,REASON_LOCKED:403,REASON_CLIENT_TOO_OLD:405,REASON_BANNED:406,REASON_BAD_USER_AGENT:409,REASON_INTERNAL_SERVER_ERROR:500,REASON_EXPERIMENTAL:501,REASON_SERVICE_UNAVAILABLE:503};f.FAILURE_REASON=a}),66);
__d("WAWebFetchAdAccountToken",["WAQplTypes","WAResolvable","WASmaxBizCtwaAdAccountGetAccessTokenAndSessionCookiesRPC","WAWebCTWABizAccessTokenNonceManager","WAWebCommonAdsTypes","WAWebFailureErrorCodes","WAWebGraphQLServerError","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","WAWebUserPrefsCTWA"],(function(a,b,c,d,e,f,g){var h=null,i=1;function a(a){if(h!=null){if(a!==!0)return h.promise;h=null}h;var b=h=new(d("WAResolvable").Resolvable)(),c=d("WAWebUserPrefsCTWA").getAdAccountToken();if(c!=null&&a!==!0){b.resolve({type:"success",token:c});return b.promise}d("WAWebQplQuickPerformanceLoggerModule").QPL.markerStart(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_TOKEN);d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_TOKEN,"request_token_start");void j(i).then(function(a){a.type==="success"?d("WAWebUserPrefsCTWA").setAdAccountToken(a.token):(a.type,h=null),b.resolve(a)})["catch"](function(a){h=null,b.reject(a)});return b.promise}function b(){h=null,d("WAWebUserPrefsCTWA").clearAdAccountToken()}function c(a){if(a instanceof d("WAWebGraphQLServerError").GraphQLServerError){a=a.source.errors.some(function(a){return d("WAWebGraphQLServerError").GraphQLErrorCode.cast(a.code)===d("WAWebGraphQLServerError").GraphQLErrorCode.INVALID_ACCESS_TOKEN||a.code===d("WAWebFailureErrorCodes").FAILURE_REASON.REASON_GENERIC_FAILURE});return a}return!1}function j(a){return d("WAWebCTWABizAccessTokenNonceManager").fetchNonce().then(function(b){switch(b.type){case"error":case"recovery-required":return b;default:b.type;return k(b.nonce).then(function(b){return b.type==="incorrect-nonce"&&a>0?j(a-1).then(function(a){if(a.type==="success")return a;a.type;return b}):b})}})}function k(a){d("WAWebCTWABizAccessTokenNonceManager").markNonceAsUsed();return d("WASmaxBizCtwaAdAccountGetAccessTokenAndSessionCookiesRPC").sendGetAccessTokenAndSessionCookiesRPC({codeElementValue:a}).then(function(a){switch(a.name){case"GetAccessTokenAndSessionCookiesResponseTooManyAttempts":n();return{type:"too-many-attempts"};case"GetAccessTokenAndSessionCookiesResponseIncorrectNonce":n();return{type:"incorrect-nonce"};case"GetAccessTokenAndSessionCookiesResponseError":n();return{type:"error"};default:a.name;m();return{type:"success",token:d("WAWebCommonAdsTypes").asAdAccountToken(a.value.accessTokenElementValue)}}})["catch"](function(a){n();throw a})}function l(a){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_TOKEN,"request_token_end"),d("WAWebQplQuickPerformanceLoggerModule").QPL.markerEnd(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_TOKEN,a)}function m(){l(d("WAQplTypes").QuickLogActionType.SUCCESS)}function n(){l(d("WAQplTypes").QuickLogActionType.FAIL)}function e(){return d("WAWebCTWABizAccessTokenNonceManager").getMaximumNonceFetchTimeoutSeconds()*(i+1)}g.FETCH_AD_ACCOUNT_TOKEN_MAX_RETRIES=i;g.fetchToken=a;g.markTokenAsInvalid=b;g.hasGraphQLAuthError=c;g.getMaximumAdAccountFetchTimeoutSeconds=e}),98);
__d("WAWebJobDismissQuickPromotion",["WALogger","WASmaxInAppCommsEventRPC","WAWebBizGatingUtils","WAWebDefinePersistedJob","WAWebModelStorageUtils","WAWebQuickPromotionActionMutation","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["dismissQuickPromotion: unable to log through IQ"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["dismissQuickPromotion: unable to log through GraphQL"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["dismissQuickPromotion: surface id for GraphQL call not found"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["dismissQuickPromotion: promotion not found"]);k=function(){return a};return a}function a(a){var c=a.id,e=a.ts;return d("WAWebModelStorageUtils").getStorage().lock(["quick-promotions"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.get(c));if(b==null){d("WALogger").WARN(k());return}var f=babelHelpers["extends"]({},b.tracking,{dismisses:b.tracking.dismisses+1}),g=f.lastDismissTs;(g==null||e>g)&&(f.lastDismissTs=e);yield a.merge(c,{tracking:f});return{surfaceId:b.surfaceId,instanceLogData:(g=b.data.qpConfigInstanceLogData)==null?void 0:g.elementValue}});return function(b){return a.apply(this,arguments)}}()).then(function(a){return d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("loadQuickPromotions",{trigger:"user-action"}).then(function(){return a})})}function c(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=b.id;b=b.ts;var e=(a==null?void 0:a.instanceLogData)!=null?String.fromCharCode.apply(null,a.instanceLogData):"";if(d("WAWebBizGatingUtils").qpGraphQLEnabled()){a=a==null?void 0:a.surfaceId;if(a==null)d("WALogger").WARN(j());else{a;var f;try{f=(yield d("WAWebQuickPromotionActionMutation").executeQuickPromotionActionMutation({event:"ACTION",action:"DISMISS",promotion_id:c,surface_nux_id:a,promotion_logging_data:e,client_time:b}))}catch(a){d("WALogger").ERROR(i()).devConsole(a)}if(((a=f)==null?void 0:a.type)!=="not-enabled")return;f.type}}a=(yield d("WASmaxInAppCommsEventRPC").sendEventRPC({eventType:"dismiss",eventPromotionId:c,eventTimestampSec:b,eventLogdata:e}));a.name!=="EventResponseSuccess"&&(a.name,d("WALogger").ERROR(h()).devConsole(a.value))});return l.apply(this,arguments)}e=d("WAWebDefinePersistedJob").defineWebPersistedJob().step("saveToDb",a).finalStep("reportToComms",c).end();g.dismissQuickPromotion=e}),98);
__d("WAWebJobImpressionOnQuickPromotion",["WALogger","WASmaxInAppCommsEventRPC","WAWebBizGatingUtils","WAWebDefinePersistedJob","WAWebModelStorageUtils","WAWebQuickPromotionActionMutation","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["impressionOnQuickPromotion: unable to log"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["impressionOnQuickPromotion: unable to log through GraphQL"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["impressionOnQuickPromotion: surface id for GraphQL call not found"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["impressionOnQuickPromotion: promotion not found"]);k=function(){return a};return a}function a(a){var c=a.id,e=a.ts;return d("WAWebModelStorageUtils").getStorage().lock(["quick-promotions"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.get(c));if(b==null){d("WALogger").WARN(k());return}var f=babelHelpers["extends"]({},b.tracking,{impressions:b.tracking.impressions+1}),g=f.lastImpressionTs;(g==null||e>g)&&(f.lastImpressionTs=e);yield a.merge(c,{tracking:f});return{surfaceId:b.surfaceId,instanceLogData:(g=b.data.qpConfigInstanceLogData)==null?void 0:g.elementValue}});return function(b){return a.apply(this,arguments)}}()).then(function(a){return d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("loadQuickPromotions",{trigger:"user-action"}).then(function(){return a})})}function c(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=b.id;b=b.ts;var e=(a==null?void 0:a.instanceLogData)!=null?String.fromCharCode.apply(null,a.instanceLogData):"";if(d("WAWebBizGatingUtils").qpGraphQLEnabled()){a=a==null?void 0:a.surfaceId;if(a==null)d("WALogger").WARN(j());else{a;var f;try{f=(yield d("WAWebQuickPromotionActionMutation").executeQuickPromotionActionMutation({event:"VIEW",promotion_id:c,surface_nux_id:a,promotion_logging_data:e,client_time:b}))}catch(a){d("WALogger").ERROR(i()).devConsole(a)}if(((a=f)==null?void 0:a.type)!=="not-enabled")return;f.type}}a=(yield d("WASmaxInAppCommsEventRPC").sendEventRPC({eventType:"impression",eventPromotionId:c,eventTimestampSec:b,eventLogdata:e}));a.name!=="EventResponseSuccess"&&(a.name,d("WALogger").ERROR(h()).devConsole(a.value))});return l.apply(this,arguments)}e=d("WAWebDefinePersistedJob").defineWebPersistedJob().step("saveToDb",a).finalStep("reportToComms",c).end();g.impressionOnQuickPromotion=e}),98);
__d("WAWebJobPrimaryActionClickInQuickPromotion",["WALogger","WASmaxInAppCommsEventRPC","WAWebBizGatingUtils","WAWebDefinePersistedJob","WAWebModelStorageUtils","WAWebQuickPromotionActionMutation","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["primaryActionClickInQuickPromotion: unable to log"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["primaryActionClickInQuickPromotion: unable to log through GraphQL"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["primaryActionClickInQuickPromotion: surface id for GraphQL call not found"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["primaryActionClickInQuickPromotion: promotion not found"]);k=function(){return a};return a}function a(a){var c=a.id,e=a.ts;return d("WAWebModelStorageUtils").getStorage().lock(["quick-promotions"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.get(c));if(b==null){d("WALogger").WARN(k());return}var f=babelHelpers["extends"]({},b.tracking,{primaryClicks:b.tracking.primaryClicks+1}),g=f.lastPrimaryClickTs;(g==null||e>g)&&(f.lastPrimaryClickTs=e);yield a.merge(c,{tracking:f});return{surfaceId:b.surfaceId,instanceLogData:(g=b.data.qpConfigInstanceLogData)==null?void 0:g.elementValue}});return function(b){return a.apply(this,arguments)}}()).then(function(a){return d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("loadQuickPromotions",{trigger:"user-action"}).then(function(){return a})})}function c(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=b.id;b=b.ts;var e=(a==null?void 0:a.instanceLogData)!=null?String.fromCharCode.apply(null,a.instanceLogData):"";if(d("WAWebBizGatingUtils").qpGraphQLEnabled()){a=a==null?void 0:a.surfaceId;if(a==null)d("WALogger").WARN(j());else{a;var f;try{f=(yield d("WAWebQuickPromotionActionMutation").executeQuickPromotionActionMutation({event:"ACTION",action:"PRIMARY",promotion_id:c,surface_nux_id:a,promotion_logging_data:e,client_time:b}))}catch(a){d("WALogger").ERROR(i()).devConsole(a)}if(((a=f)==null?void 0:a.type)!=="not-enabled")return;f.type}}a=(yield d("WASmaxInAppCommsEventRPC").sendEventRPC({eventType:"primary_click",eventPromotionId:c,eventTimestampSec:b,eventLogdata:e}));a.name!=="EventResponseSuccess"&&(a.name,d("WALogger").ERROR(h()).devConsole(a.value))});return l.apply(this,arguments)}e=d("WAWebDefinePersistedJob").defineWebPersistedJob().step("saveToDb",a).finalStep("reportToComms",c).end();g.primaryActionClickInQuickPromotion=e}),98);
__d("WASmaxInBizAccessTokenIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);
__d("WASmaxInBizAccessTokenHackBaseIQErrorResponseMixin",["WAResultOrError","WASmaxInBizAccessTokenIQErrorResponseMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"to");if(!c.success)return c;a=d("WASmaxInBizAccessTokenIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({to:c.value},a.value))}g.parseHackBaseIQErrorResponseMixin=a}),98);
__d("WASmaxInBizAccessTokenIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","bad-request");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",400);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorBadRequestMixin=a}),98);
__d("WASmaxInBizAccessTokenIQErrorForbiddenMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","forbidden");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",403);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorForbiddenMixin=a}),98);
__d("WASmaxInBizAccessTokenIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","internal-server-error");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",500);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorInternalServerErrorMixin=a}),98);
__d("WASmaxInBizAccessTokenIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","service-unavailable");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",503);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorServiceUnavailableMixin=a}),98);
__d("WASmaxInBizAccessTokenIQErrorBadRequestOrForbiddenOrInternalServerErrorOrServiceUnavailableMixinGroup",["WAResultOrError","WASmaxInBizAccessTokenIQErrorBadRequestMixin","WASmaxInBizAccessTokenIQErrorForbiddenMixin","WASmaxInBizAccessTokenIQErrorInternalServerErrorMixin","WASmaxInBizAccessTokenIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInBizAccessTokenIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:b.value});var c=d("WASmaxInBizAccessTokenIQErrorForbiddenMixin").parseIQErrorForbiddenMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorForbidden",value:c.value});var e=d("WASmaxInBizAccessTokenIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:e.value});var f=d("WASmaxInBizAccessTokenIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(a);return f.success?d("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorBadRequest","IQErrorForbidden","IQErrorInternalServerError","IQErrorServiceUnavailable"],[b,c,e,f])}g.parseIQErrorBadRequestOrForbiddenOrInternalServerErrorOrServiceUnavailableMixinGroup=a}),98);
__d("WASmaxInBizAccessTokenRequestSilentNonceResponseError",["WAResultOrError","WASmaxInBizAccessTokenHackBaseIQErrorResponseMixin","WASmaxInBizAccessTokenIQErrorBadRequestOrForbiddenOrInternalServerErrorOrServiceUnavailableMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInBizAccessTokenHackBaseIQErrorResponseMixin").parseHackBaseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInBizAccessTokenIQErrorBadRequestOrForbiddenOrInternalServerErrorOrServiceUnavailableMixinGroup").parseIQErrorBadRequestOrForbiddenOrInternalServerErrorOrServiceUnavailableMixinGroup(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorIQErrorBadRequestOrForbiddenOrInternalServerErrorOrServiceUnavailableMixinGroup:b.value}))}g.parseRequestSilentNonceResponseError=a}),98);
__d("WASmaxInBizAccessTokenIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);
__d("WASmaxInBizAccessTokenHackBaseIQResultResponseMixin",["WAResultOrError","WASmaxInBizAccessTokenIQResultResponseMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"to");if(!c.success)return c;a=d("WASmaxInBizAccessTokenIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({to:c.value},a.value))}g.parseHackBaseIQResultResponseMixin=a}),98);
__d("WASmaxInBizAccessTokenRequestSilentNonceResponseRecoveryRequired",["WAResultOrError","WASmaxInBizAccessTokenHackBaseIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"result");if(!c.success)return c;var e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,c.value,"status","RecoveryRequired");if(!e.success)return e;c=d("WASmaxParseUtils").attrString(c.value,"email");if(!c.success)return c;a=d("WASmaxInBizAccessTokenHackBaseIQResultResponseMixin").parseHackBaseIQResultResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({resultStatus:e.value,resultEmail:c.value},a.value))}g.parseRequestSilentNonceResponseRecoveryRequired=a}),98);
__d("WASmaxInBizAccessTokenRequestSilentNonceResponseSuccess",["WAResultOrError","WASmaxInBizAccessTokenHackBaseIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"result");if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,c.value,"status","Success");if(!c.success)return c;a=d("WASmaxInBizAccessTokenHackBaseIQResultResponseMixin").parseHackBaseIQResultResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({resultStatus:c.value},a.value))}g.parseRequestSilentNonceResponseSuccess=a}),98);
__d("WASmaxOutBizAccessTokenBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"get"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQGetRequestMixin=a}),98);
__d("WASmaxOutBizAccessTokenHackBaseIQGetRequestMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutBizAccessTokenBaseIQGetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.iqFrom;a=d("WASmaxOutBizAccessTokenBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(d("WASmaxJsx").smax("iq",{from:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,a),to:d("WAWap").S_WHATSAPP_NET}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeHackBaseIQGetRequestMixin=a}),98);
__d("WASmaxOutBizAccessTokenRequestSilentNonceRequest",["WASmaxJsx","WASmaxOutBizAccessTokenHackBaseIQGetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutBizAccessTokenHackBaseIQGetRequestMixin").mergeHackBaseIQGetRequestMixin(d("WASmaxJsx").smax("iq",{xmlns:"fb:thrift_iq",smax_id:d("WAWap").INT(118)}),a);return a}g.makeRequestSilentNonceRequest=a}),98);
__d("WASmaxBizAccessTokenRequestSilentNonceRPC",["WAComms","WASmaxInBizAccessTokenRequestSilentNonceResponseError","WASmaxInBizAccessTokenRequestSilentNonceResponseRecoveryRequired","WASmaxInBizAccessTokenRequestSilentNonceResponseSuccess","WASmaxOutBizAccessTokenRequestSilentNonceRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=d("WASmaxOutBizAccessTokenRequestSilentNonceRequest").makeRequestSilentNonceRequest(a);j.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=j.sent;g=d("WASmaxInBizAccessTokenRequestSilentNonceResponseSuccess").parseRequestSilentNonceResponseSuccess(f,e);if(!g.success){j.next=7;break}return j.abrupt("return",{name:"RequestSilentNonceResponseSuccess",value:g.value});case 7:h=d("WASmaxInBizAccessTokenRequestSilentNonceResponseRecoveryRequired").parseRequestSilentNonceResponseRecoveryRequired(f,e);if(!h.success){j.next=10;break}return j.abrupt("return",{name:"RequestSilentNonceResponseRecoveryRequired",value:h.value});case 10:i=d("WASmaxInBizAccessTokenRequestSilentNonceResponseError").parseRequestSilentNonceResponseError(f,e);if(!i.success){j.next=13;break}return j.abrupt("return",{name:"RequestSilentNonceResponseError",value:i.value});case 13:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("RequestSilentNonce",{Success:g,RecoveryRequired:h,Error:i}));case 14:case"end":return j.stop()}},null,this)}g.sendRequestSilentNonceRPC=a}),98);
__d("WAWebCTWABizAccessTokenNonceManager",["WACustomError","WALogger","WAPromiseRetryLoop","WAPromiseTimeout","WAQplTypes","WAResolvable","WASmaxBizAccessTokenRequestSilentNonceRPC","WAWebBizGatingUtils","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received a biz token nonce without asking for it"]);h=function(){return a};return a}var i=250,j=1e3,k=null;function a(a){if(k!=null&&a!==!0)return k.promise;var b=d("WAWebBizGatingUtils").adAccountTokenNoncePushWaitTimeoutSeconds(),c=d("WAWebBizGatingUtils").adAccountTokenNonceMaxRetries();d("WAWebQplQuickPerformanceLoggerModule").QPL.markerStart(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_NONCE);d("WAWebQplQuickPerformanceLoggerModule").QPL.markerAnnotate(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_NONCE,{"int":{fetch_nonce_timeout:b,fetch_nonce_max_retries:c}});var e=c;a=function(a){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerAnnotate(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_NONCE,{"int":{fetch_nonce_retry:c-e}});return d("WAPromiseTimeout").promiseTimeout(l(),b*1e3).then(function(b){a(b)})["catch"](function(a){var b=e>0;e--;if(!b){a instanceof d("WACustomError").TimeoutError&&(d("WAWebQplQuickPerformanceLoggerModule").QPL.markerEnd(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_NONCE,d("WAQplTypes").QuickLogActionType.ABORTED),k=null);throw a}})};a=new(d("WAPromiseRetryLoop").PromiseRetryLoop)({name:"fetchAdAccountNonce",timer:{algo:{type:"exponential",first:i},max:j},code:a});a.start();return a.promise()}function l(){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_NONCE,"request_nonce_start");var a=k=new(d("WAResolvable").Resolvable)();return d("WASmaxBizAccessTokenRequestSilentNonceRPC").sendRequestSilentNonceRPC({}).then(function(b){switch(b.name){case"RequestSilentNonceResponseError":d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_NONCE,"request_nonce_end");d("WAWebQplQuickPerformanceLoggerModule").QPL.markerEnd(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_NONCE,d("WAQplTypes").QuickLogActionType.FAIL);k=null;return{type:"error"};case"RequestSilentNonceResponseRecoveryRequired":d("WAWebQplQuickPerformanceLoggerModule").QPL.markerAnnotate(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_NONCE,{bool:{fetch_nonce_recovery_needed:!0}});d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_NONCE,"request_nonce_end");d("WAWebQplQuickPerformanceLoggerModule").QPL.markerEnd(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_NONCE,d("WAQplTypes").QuickLogActionType.FAIL);k=null;return{type:"recovery-required",emailMask:b.value.resultEmail};default:b.name;d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_NONCE,"request_nonce_end");d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_NONCE,"push_nonce_start");return a.promise}})["catch"](function(a){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_NONCE,"request_nonce_end");d("WAWebQplQuickPerformanceLoggerModule").QPL.markerEnd(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_NONCE,d("WAQplTypes").QuickLogActionType.FAIL);k=null;throw a})}function b(a){k==null?(d("WALogger").WARN(h()),k=null,d("WAWebQplQuickPerformanceLoggerModule").QPL.markerStart(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_NONCE),d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_NONCE,"push_nonce_end"),d("WAWebQplQuickPerformanceLoggerModule").QPL.markerEnd(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_NONCE,d("WAQplTypes").QuickLogActionType.DROPPED)):(k.resolve({type:"success",nonce:a}),d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_NONCE,"push_nonce_end"),d("WAWebQplQuickPerformanceLoggerModule").QPL.markerEnd(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_NONCE,d("WAQplTypes").QuickLogActionType.SUCCESS))}function c(a){k==null&&(k=new(d("WAResolvable").Resolvable)()),k.resolve({type:"success",nonce:m(a)})}function e(){k=null}function m(a){return a}function f(){return d("WAWebBizGatingUtils").adAccountTokenNoncePushWaitTimeoutSeconds()*(d("WAWebBizGatingUtils").adAccountTokenNonceMaxRetries()+1)}g.fetchNonce=a;g.setNonceFromPushNotification=b;g.setNonceFromRecoveryCode=c;g.markNonceAsUsed=e;g.castToNonce=m;g.getMaximumNonceFetchTimeoutSeconds=f}),98);
__d("WAWebE2EProtoParserForCtwaContext",["WAWebABProps","WAWebBizGatingUtils","WAWebE2EProtoParserApi","WAWebLinkify"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.externalAdReply==null&&!d("WAWebABProps").getABPropConfigValue("wa_web_parse_always_show_ad_attribution"))return;var c={},e=b.alwaysShowAdAttribution,f=b.conversionSource,g=b.conversionData;e!=null&&(c.alwaysShowAdAttribution=e);f!=null&&(c.conversionSource=f);g!=null&&(c.conversionData=g);e=b.externalAdReply;if(e!=null){c.sourceUrl=e.sourceUrl;c.description=e.body;c.title=e.title;e.thumbnail!=null&&(c.thumbnail=d("WAWebE2EProtoParserApi").decodeBytes(e.thumbnail));c.thumbnailUrl=e.thumbnailUrl;c.mediaType=e.mediaType;c.mediaUrl=e.mediaUrl;f=d("WAWebLinkify").findLink(e.sourceUrl||"",!1,a.from);f!=null&&f.suspiciousCharacters!=null&&f.suspiciousCharacters.size!=null&&(c.isSuspiciousLink=f.suspiciousCharacters.size>0);e.adContextPreviewDismissed!=null&&d("WAWebBizGatingUtils").isHideAdContextIfSoftDismissed()&&(c.adContextPreviewDismissed=e.adContextPreviewDismissed)}Object.keys(c).length>0&&(a.ctwaContext=c)}g.parseCtwaContextProto=a}),98);
__d("WAWebCommonAdEntryPointsTypes",[],(function(a,b,c,d,e,f){function a(a){return a}f.asAdEntryPointContent=a}),66);
__d("WAWebPonyfillsCryptoRandomUUID",[],(function(a,b,c,d,e,f){function a(){return"randomUUID"in self.crypto?self.crypto.randomUUID():([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(a){return(a^crypto.getRandomValues(new Uint8Array(1))[0]&15>>a/4).toString(16)})}f["default"]=a}),66);
__d("WAWebUserPrefsCTWA",["WATimeUtils","WAWebBizGatingUtils","WAWebCommonAdEntryPointsTypes","WAWebCommonAdsTypes","WAWebPonyfillsCryptoRandomUUID","WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(a,b,c,d,e,f,g){function h(){var a=c("WAWebPonyfillsCryptoRandomUUID")();c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.AD_CREATION_FLOW_ID_KEY,a);return a}function a(){var a=c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").KEYS.AD_CREATION_FLOW_ID_KEY);(a==null||typeof a!=="string")&&(a=h());return a}function b(){var a=c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").KEYS.AD_CREATION_SEQUENCE_NUMBER_KEY);(a==null||typeof a!=="number")&&(a=1);c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.AD_CREATION_SEQUENCE_NUMBER_KEY,a+1);return a}function e(){c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.AD_CREATION_SEQUENCE_NUMBER_KEY,1)}function f(a){var b=c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.AD_ENTRY_POINTS_CONFIGURATION);if(b==null||typeof b!=="object")return null;var e=b.configuration,f=b.ts;b=b.locale;if(typeof f!=="number"||typeof b!=="string")return null;f=!d("WATimeUtils").isInFuture(d("WATimeUtils").futureUnixTime(d("WAWebBizGatingUtils").adEntryPointsConfigurationFetchThreshold()/1e3,d("WATimeUtils").castToUnixTime(f)));if(b!==a)return null;if(e==null||typeof e!=="object")return null;b=Object.keys(e).reduce(function(a,b){var c=e[b];if(c==null||typeof c!=="object")return a;var f=c.shouldShow,g=c.content;c=c.subContent;if(typeof f!=="boolean")return a;f={shouldShow:f};if(g!=null){if(typeof g!=="string")return a;f.content=d("WAWebCommonAdEntryPointsTypes").asAdEntryPointContent(g)}if(c!=null){if(typeof c!=="string")return a;f.subContent=d("WAWebCommonAdEntryPointsTypes").asAdEntryPointContent(c)}a[b]=f;return a},{});return{configuration:b,isExpired:f}}function i(a,b){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.AD_ENTRY_POINTS_CONFIGURATION,{configuration:b,ts:d("WATimeUtils").unixTime(),locale:a})}function j(){if(!d("WAWebBizGatingUtils").adAccountTokenStoringEnabled())return null;var a=c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.AD_ACCOUNT_TOKEN);return a==null||typeof a!=="string"?null:d("WAWebCommonAdsTypes").asAdAccountToken(a)}function k(a){if(!d("WAWebBizGatingUtils").adAccountTokenStoringEnabled())return;c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.AD_ACCOUNT_TOKEN,a)}function l(){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.AD_ACCOUNT_TOKEN,null)}g.generateAdCreationFlowId=h;g.getAdCreationFlowId=a;g.getAndIncrementAdCreationSequenceNumber=b;g.resetAdCreationSequenceNumber=e;g.getAdEntryPointsConfiguration=f;g.setAdEntryPointsConfiguration=i;g.getAdAccountToken=j;g.setAdAccountToken=k;g.clearAdAccountToken=l}),98);
__d("WAWebGenerateDocumentReportingTokenContent",["WAWebReportingTokenUtils"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebReportingTokenUtils").getMediaReportingTokenContent(a)}g["default"]=a}),98);
__d("WAWebMediaCleanFileName",["WALogger"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["cleanIncomingFilename:extension: ",""]);h=function(){return a};return a}function i(a){if(!a)return a;a=a.replace(/[\u202a-\u202e\u2066-\u2069\u200E\u200F\u061C]/g,"\ufffd");var b=a.split(".");if(b.length===1)return a;for(var c=b.length-1;c>0;c--){var d=b[c].trim();if(d.length)return b.slice(0,c).join(".")+"."+d}return a}function a(a){if(a==null)return a;var b=i(a);if(a!==b&&b){a=["bat","exe","cmd","com","lnk","pif","scr","vb","vbe","vbs","wsh","js","ps1","hta","sh","csh","msi","app","scpt","applescript","reg","vbe","wsf","sct"];var c=b.split(".");c=c.length>=2&&c.pop();a.includes(c)&&d("WALogger").LOG(h(),c||"").verbose()}return b}g.cleanFilename=i;g.cleanIncomingFilename=a}),98);
__d("WAWebLottieStickersGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("gimmick_phase_two_receiver_enabled")}g.isLottieStickerReceivingEnabled=a}),98);
__d("WAWebStickerMimeUtils",["WAWebLottieStickersGatingUtils"],(function(a,b,c,d,e,f,g){var h="application/was",i="image/webp";function a(){return d("WAWebLottieStickersGatingUtils").isLottieStickerReceivingEnabled()?new Set([i,h]):new Set([i])}g.WhatsAppLottieStickerMimeType=h;g.getValidStickerMimeTypes=a}),98);
__d("WAWebMediaMessageGetValidatedProperties",["$InternalEnum","WALogger","WALongInt","WAWebHandleMsgError","WAWebMsgType","WAWebNewsletterIsNewsletterMsg","WAWebStickerMimeUtils","WAWebURLUtils","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Invalid file length "," with a type "," for "," message"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unexpected "," for "," message"]);i=function(){return a};return a}var j=b("$InternalEnum")({MISSING_MEDIA_KEY:"missing_media_key",INVALID_SHA256:"invalid_sha256",INVALID_ENC_SHA256:"invalid_enc_sha256",INVALID_URL:"invalid_url",INVALID_MIME_TYPE:"invalid_mime_type",INVALID_MEDIA_KEY:"invalid_media_key",INVALID_FILE_LENGTH:"invalid_file_length"}),k=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c,d,e){c=String(c)+" for "+a+" message";a=b.call(this,c,d,e)||this;a.name="MediaMessageValidationError";return a}return a}(d("WAWebHandleMsgError").MessageValidationError),l="audio/ogg; codecs=opus",m="audio/mp4",n="audio/mpeg",o="audio/aac",p="audio/amr",q="image/jpeg",r="image/png",s="image/webp",t="video/mp4",u="video/3gpp",v="video/",w="image/";function a(a){return x(a)||a.startsWith(w)}function x(a){return a.startsWith(v)}function y(a){var b,c;c=(b={},b[(c=d("WAWebMsgType")).MSG_TYPE.IMAGE]=new Set([q,r,s]),b[c.MSG_TYPE.STICKER]=d("WAWebStickerMimeUtils").getValidStickerMimeTypes(),b[c.MSG_TYPE.VIDEO]=new Set([t,u]),b[c.MSG_TYPE.AUDIO]=new Set([l,m,n,o,p]),b[c.MSG_TYPE.PTT]=new Set([l,m,n,o,p]),b);return c[a]}function z(a){a=c("WAWebURLUtils").hostname(a);return a.endsWith(".whatsapp.net")||a==="whatsapp.net"}var A=function(a){return a.id==null};function e(a,b,e,f){var g=a.mediaKey,l=a.fileSha256,m=a.fileEncSha256,n=a.fileLength,o=a.url;a=a.mimetype;e=e==="relay"||e==="outgoing";if(!e){return{mediaKey:g,fileSha256:l,fileEncSha256:m,fileLength:d("WALongInt").numberOrThrowIfTooLarge((e=n)!=null?e:0),url:o,mimetype:a}}if(A(b)){return{mediaKey:g,fileSha256:l,fileEncSha256:m,fileLength:d("WALongInt").numberOrThrowIfTooLarge((e=n)!=null?e:0),url:o,mimetype:a}}if(!c("WAWebNewsletterIsNewsletterMsg")({from:b.from,to:b.to})){if(g==null)throw new k(f,j.MISSING_MEDIA_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_IMAGE_MEDIA_KEY);if(g.byteLength!==32)throw new k(f,j.INVALID_MEDIA_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_IMAGE_MEDIA_KEY);if(m!=null&&m.byteLength!==32)throw new k(f,j.INVALID_ENC_SHA256,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_IMAGE_FILE_SHA256)}if((l==null?void 0:l.byteLength)!==32)throw new k(f,j.INVALID_SHA256,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_IMAGE_FILE_SHA256);if(o!=null&&(!c("WAWebURLUtils").isHttps(o)||!z(o)))throw new k(f,j.INVALID_URL,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_IMAGE_MEDIA_URL);if(f===d("WAWebMsgType").MSG_TYPE.STICKER_PACK&&a!=null)throw new k(f,j.INVALID_MIME_TYPE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_IMAGE_MIME_TYPE);if(a==null&&f!==d("WAWebMsgType").MSG_TYPE.STICKER_PACK)throw new k(f,j.INVALID_MIME_TYPE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_IMAGE_MIME_TYPE);e=y(f);if(a!=null&&e!=null&&!e.has(a)){d("WALogger").LOG(i(),a,f);throw new k(f,j.INVALID_MIME_TYPE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_IMAGE_MIME_TYPE)}var p;f===d("WAWebMsgType").MSG_TYPE.STICKER?n!=null?(p=d("WALongInt").numberOrThrowIfTooLarge(n),b=p>=0):b=!0:f===d("WAWebMsgType").MSG_TYPE.DOCUMENT?n==null?b=!1:(p=d("WALongInt").numberOrThrowIfTooLarge(n),b=p>=0):n==null?b=!1:(p=d("WALongInt").numberOrThrowIfTooLarge(n),b=p>0);if(!b){d("WALogger").LOG(h(),n,typeof n,f);throw new k(f,j.INVALID_FILE_LENGTH,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_IMAGE_FILE_LENGTH,{sendLogs:f===d("WAWebMsgType").MSG_TYPE.IMAGE?.01:!0})}return{mediaKey:g,fileSha256:l,fileEncSha256:m,fileLength:p,url:o,mimetype:a}}g.MediaMessageValidationError=k;g.isMediaMimeType=a;g.isVideoMimeType=x;g.isWhatsAppSubdomain=z;g.getValidatedMediaMessageProperties=e}),98);
__d("WAWebServerPropConstants",[],(function(a,b,c,d,e,f){a=64;b=64;c=5e3;d=5;e=1500;f.MMS_VCARD_AUTODOWNLOAD_SIZE_KB=a;f.VCARD_AS_DOCUMENT_SIZE_KB=b;f.VCARD_MAX_SIZE_KB=c;f.MULTICAST_LIMIT_GLOBAL=d;f.PTT_PLAYBACK_SPEED_HIDE_DELAY=e}),66);
__d("WAWebParseDocumentMessageProto",["WALongInt","WATimeUtils","WAWebE2EProtoParserApi","WAWebE2EProtoUtils","WAWebMediaCleanFileName","WAWebMediaMessageGetValidatedProperties","WAWebMsgType","WAWebServerPropConstants"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.msgContext;b=b.documentMessage;if(b==null)return;a=d("WAWebMediaMessageGetValidatedProperties").getValidatedMediaMessageProperties(b,c,a,d("WAWebMsgType").MSG_TYPE.DOCUMENT);var e=a.mediaKey,f=a.fileSha256,g=a.fileEncSha256,h=a.fileLength;h=h===void 0?0:h;a=a.url;var i=d("WAWebMediaCleanFileName").cleanIncomingFilename(b.fileName||b.title),j=b.caption!=null&&b.caption!=="",k=j?d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(b.caption):i;c=babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.DOCUMENT,kind:d("WAWebMsgType").MsgKind.Document,deprecatedMms3Url:d("WAWebE2EProtoParserApi").decodeUrl(a),directPath:b.directPath,mimetype:b.mimetype,filehash:d("WAWebE2EProtoParserApi").decodeBytes(f),encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(g),size:h,pageCount:b.pageCount||0,mediaKey:d("WAWebE2EProtoParserApi").decodeBytes(e),mediaKeyTimestamp:b.mediaKeyTimestamp!=null?d("WALongInt").numberOrThrowIfTooLarge(b.mediaKeyTimestamp):d("WATimeUtils").unixTime(),filename:i,isCaptionByUser:j,caption:k,body:d("WAWebE2EProtoParserApi").decodeBytes(b.jpegThumbnail)||"",isVcardOverMmsDocument:Boolean(b.contactVcard)&&h<=d("WAWebServerPropConstants").VCARD_MAX_SIZE_KB*1024,thumbnailDirectPath:b.thumbnailDirectPath,thumbnailSha256:d("WAWebE2EProtoParserApi").decodeBytes(b.thumbnailSha256),thumbnailEncSha256:d("WAWebE2EProtoParserApi").decodeBytes(b.thumbnailEncSha256),thumbnailHeight:b.thumbnailHeight,thumbnailWidth:b.thumbnailWidth});return{msgData:c,contextInfo:b.contextInfo}}g["default"]=a}),98);
__d("WAWebParseKeepInChatMessageProto",["WALongInt","WAWebE2EProtoUtils","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.keepInChatMessage;if(b==null)return;var c=b.key,e=b.keepType;b=b.timestampMs;c=babelHelpers["extends"]({},a,{keptMessageKey:d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(c,a),type:d("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT,kind:d("WAWebMsgType").MsgKind.KeepInChat,keepType:e,senderTimestampMs:d("WALongInt").maybeNumberOrThrowIfTooLarge(b)});return{msgData:c,contextInfo:null}}g["default"]=a}),98);
__d("WAWebParseEphemeralSyncResponseMessageProto",["WALogger","WALongInt","WANullthrows","WAWebE2EProtoUtils","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["EPHEMERAL_SYNC_RESPONSE msg does not contain all fields"]);h=function(){return a};return a}function a(a){var b=a.messageProtobuf,e=a.baseMessage;a=a.msgContext;b=b.protocolMessage;if(b==null||a!=="relay"||b.type!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.EPHEMERAL_SYNC_RESPONSE)return;a=b.ephemeralExpiration;var f=b.ephemeralSettingTimestamp,g=b.disappearingMode;if(a==null||f==null||g==null){d("WALogger").WARN(h()).devConsole({protocolMessage:b});return}var i;b.disappearingMode!=null&&(i=d("WAWebE2EProtoUtils").protoToDisappearingMode(b,b.disappearingMode));return{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"ephemeral_sync_response",ephemeralDuration:a,ephemeralSettingTimestamp:d("WALongInt").numberOrThrowIfTooLarge(f),disappearingModeInitiator:c("WANullthrows")(d("WAWebE2EProtoUtils").protoToDisappearingModeInitiator(e,g)),disappearingModeTrigger:(b=i)==null?void 0:b.disappearingModeTrigger,disappearingModeInitiatedByMe:(a=i)==null?void 0:a.initiatedByMe}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebEphemeralKeepInChat",["WANullthrows","WAWebEphemeralKeepInChatUtils","WAWebMsgKey","WAWebWidFactory","err"],(function(a,b,c,d,e,f,g){function a(a){a=a.keepInChat;if(a!=null&&a.key!=null){var b=a.key,e=b.id,f=b.remoteJid,g=b.participant;b=b.fromMe;var h=a.keepType;a=a.serverTimestampMs;if(e==null||h==null||a==null||f==null)throw c("err")("parseKeepInChatHistorySyncMessage: malformed KIC WebMessageInfo");h=d("WAWebEphemeralKeepInChatUtils").parseKeepTypeToKicState(h);if(h==null)throw c("err")("parseKeepInChatHistorySyncMessage: KeepType has unsupported value");return{kicKey:new(c("WAWebMsgKey"))({fromMe:c("WANullthrows")(b),id:c("WANullthrows")(e),remote:c("WANullthrows")(d("WAWebWidFactory").createWidFromWidLike(f)),participant:g!=null?d("WAWebWidFactory").createWidFromWidLike(g):void 0}),kicState:h,kicTimestampMs:parseInt(a,10)}}}g.parseKeepInChatHistorySyncMessage=a}),98);
__d("WAWebEphemeralKeepInChatUtils",["WAWebBackendApi","WAWebEphemeralConstants","WAWebMsgGetters","WAWebProtobufsE2E.pb","WAWebUserPrefsMeUser","WAWebWid","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){if(a!=null&&a===d("WAWebProtobufsE2E.pb").KeepType.KEEP_FOR_ALL)return d("WAWebEphemeralConstants").KeepInChatState.KEPT;else if(a!=null&&a===d("WAWebProtobufsE2E.pb").KeepType.UNDO_KEEP_FOR_ALL)return d("WAWebEphemeralConstants").KeepInChatState.UNKEPT;return null}function b(a){return a===d("WAWebEphemeralConstants").KeepInChatState.KEPT}function h(a){return a===d("WAWebEphemeralConstants").KeepInChatState.UNKEPT}function e(a){var b,c;a.forEach(function(a){(!b||i(a,b)===1)&&(c=b,b=a)});c!=null&&d("WAWebBackendApi").frontendFireAndForget("logTieBreakIgnoredKicWam",{keepInChatMessage:c});return b}function i(a,b){if(a.senderTimestampMs==null)return-1;if(b.senderTimestampMs==null)return 1;if(a.senderTimestampMs>b.senderTimestampMs)return 1;else if(a.senderTimestampMs===b.senderTimestampMs&&a.id.id>b.id.id)return 1;return-1}function j(a){if(a.kicKey!=null){var b,c=d("WAWebMsgGetters").getIsGroupMsg(a);if(((b=a.kicKey)==null?void 0:b.fromMe)===!0)return d("WAWebUserPrefsMeUser").getMaybeMeUser();else if(c&&((b=a.kicKey)==null?void 0:b.participant)!=null)return d("WAWebWidFactory").toUserWid(a.kicKey.participant);else if(!c&&((b=a.kicKey)==null?void 0:b.remote)!=null)return d("WAWebWidFactory").toUserWid(a.kicKey.remote)}}function f(a){return h(a.kicState)&&c("WAWebWid").equals(j(a),d("WAWebMsgGetters").getSender(a))}g.parseKeepTypeToKicState=a;g.isKept=b;g.runKeepInChatTieBreaker=e;g.compareKeepInChatMessages=i;g.kicSenderSuperPowerActive=f}),98);
__d("WAWebEventEditAddonMessageProcessor",["Promise","WAArrayGroupBy","WAWebAddonCreateMsgProcessor","WAWebDBProcessEditProtocolMsgs","WAWebGenerateEventEditSystemMessages","WAWebProcessEncryptedEventEditMsgs","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;a=d("WAWebAddonCreateMsgProcessor").createAddonMsgProcessor({isEnabled:function(){return!0},convert:{fromHistorySyncMsg:function(){return(h||(h=b("Promise"))).resolve([])}},updateCollection:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){});function c(){return a.apply(this,arguments)}return c}(),beforeUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b.parents;a=(yield d("WAWebProcessEncryptedEventEditMsgs").processEncryptedEventEditMsgs(a,b));b=a.filter(function(a){return a.isLatest});yield d("WAWebDBProcessEditProtocolMsgs").updateMessageEditsLocally(a,b);a=d("WAArrayGroupBy").groupBy(b,function(a){return a.protocolMsg.id.remote.toString()});yield d("WAWebGenerateEventEditSystemMessages").generateEventEditSystemMessages(a);return[]});function c(b,c){return a.apply(this,arguments)}return c}(),afterUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){});function c(){return a.apply(this,arguments)}return c}(),manageNotifications:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){});function c(){return a.apply(this,arguments)}return c}()});c=a;g["default"]=c}),98);
__d("WAWebEventResponseAddonMessageProcessor",["WAWebAddonConstants","WAWebAddonCreateMsgProcessor","WAWebBackendApi","WAWebCreateEncryptedEventResponseMsgData","WAWebDBMarkFutureproofMessagesReparsed","WAWebEventResponseMsgDataConversion","WAWebEventsParseWebMsgInfoEventResponse","WAWebMsgType","WAWebPrepareEventResponsesToUpsert","WAWebProcessEncryptedEventResponseMsgs","WAWebShouldUpdateLastAddOnPreview","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){a=d("WAWebAddonCreateMsgProcessor").createAddonMsgProcessorDualEncrypted({isEnabled:function(){return!0},convert:{fromHistorySyncMsg:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebEventsParseWebMsgInfoEventResponse").parseWebMsgInfoEventResponses(a)});function c(b){return a.apply(this,arguments)}return c}(),toDualEncryptedMsgData:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return a.kind===d("WAWebMsgType").MsgKind.EventResponseEncrypted?a:d("WAWebCreateEncryptedEventResponseMsgData").createEncryptedEventResponseMsgData(a,b)});function c(b,c){return a.apply(this,arguments)}return c}(),toDualDecryptedMsgData:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return a.kind===d("WAWebMsgType").MsgKind.EventResponseDecrypted?a:d("WAWebProcessEncryptedEventResponseMsgs").decryptEncryptedEventResponseMsg(a,b)});function c(b,c){return a.apply(this,arguments)}return c}()},updateCollection:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebBackendApi").frontendSendAndReceive("upsertEventResponsesModelCollection",{eventResponses:a.add,eventResponsesToRemove:a.remove})});function c(b){return a.apply(this,arguments)}return c}(),beforeUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b.parents;a=(yield d("WAWebProcessEncryptedEventResponseMsgs").processEncryptedEventResponseMsgs(a,b));b=(yield d("WAWebPrepareEventResponsesToUpsert").prepareEventResponsesToUpsert(a));return b});function c(b,c){return a.apply(this,arguments)}return c}(),afterUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b.processMode;var c=a.map(d("WAWebEventResponseMsgDataConversion").eventResponseMsgDataToResponseData);yield d("WAWebShouldUpdateLastAddOnPreview").filterAndUpdateChatPreviews(c);if(b===d("WAWebAddonConstants").AddonProcessMode.HistorySync)return;b===d("WAWebAddonConstants").AddonProcessMode.OnlineReceive&&(yield d("WAWebDBMarkFutureproofMessagesReparsed").markFutureproofMessagesReparsed(a.map(function(a){return a.id.toString()})))});function c(b,c){return a.apply(this,arguments)}return c}(),manageNotifications:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){});function c(){return a.apply(this,arguments)}return c}()});c=a;g["default"]=c}),98);
__d("WAWebCreateEncryptedEventResponseMsgData",["WANullthrows","WAWebAck","WAWebAddonEncryption","WAWebAddonEncryptionError","WAWebEventsValidationError","WAWebMsgGetters","WAWebMsgKeyUtils","WAWebMsgType","WAWebViewMode.flow","WAWebWamEnumE2eFailureReason","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=self.crypto.getRandomValues(new Uint8Array(12)),f={type:d("WAWebMsgType").MsgKind.EventResponseDecrypted,encode:{response:a.eventResponse,timestampMs:a.senderTimestampMs}},g=d("WAWebMsgGetters").getOriginalSender(b),h=d("WAWebAddonEncryptionError").getValidatedMessageSecret(d("WAWebMsgType").MsgKind.EventResponseDecrypted,b);if(g==null)throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_MISSING_MESSAGE_SENDER,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);f=(yield d("WAWebAddonEncryption").encryptAddOn(f,{messageSecret:h,iv:e,stanzaId:b.id.id,originalMessageSender:g,addOnSender:d("WAWebWidFactory").toUserWid(c("WANullthrows")(d("WAWebMsgGetters").getSender(a)))}));return babelHelpers["extends"]({id:a.id},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(a.id,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{type:d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE,kind:d("WAWebMsgType").MsgKind.EventResponseEncrypted,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,addonEncrypted:!0,t:Math.floor(a.senderTimestampMs/1e3),ack:(h=a.ack)!=null?h:d("WAWebAck").ACK.CLOCK,targetMessageKey:b.id,encPayload:f,encIv:e.buffer})});return h.apply(this,arguments)}g.createEncryptedEventResponseMsgData=a}),98);
__d("WAWebEventEditDecryptedMsgDataConversion",["WALongInt","WANullthrows","WAWebE2EProtoUtils","WAWebEventsParseEventCreationMessageProto","WAWebEventsValidationError","WAWebMsgKeyUtils","WAWebMsgType","WAWebProcessBaseMsgInfo","WAWebProtobufsE2E.pb","WAWebViewMode.flow","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function a(a,b){a=c("WANullthrows")(a.protocolMessage,"[Event][Edit] Missing protocol message");if(a.type!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.MESSAGE_EDIT)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_INVALID_PROTOCOL_MESSAGE_TYPE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.EDIT_TYPE_AND_PROTOCOL_MISMATCH);var e=d("WAWebProcessBaseMsgInfo").msgDataToBaseMsgInfo(b),f=c("WANullthrows")(d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(a.key,e)),g=a.editedMessage;if(g==null)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_MISSING_EDITED_MESSAGE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);a=d("WALongInt").maybeNumberOrThrowIfTooLarge(a.timestampMs);if(a==null)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_MISSING_SENDER_TIMESTAMP,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);g=c("WANullthrows")(c("WAWebEventsParseEventCreationMessageProto")({messageProtobuf:babelHelpers["extends"]({},g,{messageContextInfo:{messageSecret:c("WANullthrows")(b.messageSecret).buffer}}),baseMessage:e,msgContext:"relay"}),"[Event][Edit] Failed to parse edited event fields");e=g.msgData;return babelHelpers["extends"]({},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(b.id,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Message),{id:b.id,t:Math.floor(c("WANullthrows")(a)/1e3),type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,subtype:"event_edit_decrypted",viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,kind:d("WAWebMsgType").MsgKind.ProtocolEventEdit,latestEditSenderTimestampMs:a,latestEditMsgKey:b.id,protocolMessageKey:f,editMsgType:d("WAWebMsgType").MSG_TYPE.EVENT_CREATION,eventName:c("WANullthrows")(e==null?void 0:e.eventName),eventStartTime:c("WANullthrows")(e==null?void 0:e.eventStartTime),isEventCanceled:(g=e==null?void 0:e.isEventCanceled)!=null?g:!1,eventLocation:(a=e==null?void 0:e.eventLocation)!=null?a:void 0,eventDescription:(b=e==null?void 0:e.eventDescription)!=null?b:void 0,eventJoinLink:(f=e==null?void 0:e.eventJoinLink)!=null?f:void 0,eventEndTime:(g=e==null?void 0:e.eventEndTime)!=null?g:void 0})}g.protobufToEventEditDecryptedMsgData=a}),98);
__d("WAWebEventResponseMsgDataConversion",["WANullthrows","WAWebMsgGetters","WAWebMsgKeyUtils","WAWebMsgType","WAWebViewMode.flow","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){var b;return babelHelpers["extends"]({id:a.id},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(a.id,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{type:d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,kind:d("WAWebMsgType").MsgKind.EventResponseDecrypted,parentMsgKey:a.parentMsgKey,eventResponse:c("WANullthrows")(a.responseProtobuf.response,"eventResponse"),senderTimestampMs:a.senderTimestampMs,t:(b=a.t)!=null?b:void 0,read:a.read,ack:(b=a.ack)!=null?b:void 0})}function b(a){var b;return babelHelpers["extends"]({id:a.id},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(a.id,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{type:d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE,kind:d("WAWebMsgType").MsgKind.EventResponseDecrypted,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,parentMsgKey:a.parentMsgKey,eventResponse:a.eventResponse,senderTimestampMs:a.senderTimestampMs,t:(b=a.t)!=null?b:void 0,read:a.read,ack:(b=a.ack)!=null?b:void 0})}function e(a){return{type:"event_response",msgKey:a.id.toString(),parentMsgKey:a.parentMsgKey.toString(),timestamp:a.senderTimestampMs,sender:d("WAWebWidFactory").toUserWid(c("WANullthrows")(d("WAWebMsgGetters").getSender(a))).toString(),eventResponse:a.eventResponse}}g.protobufToEventResponseMsgData=a;g.eventResponseToEventResponseMsgData=b;g.eventResponseMsgDataToResponseData=e}),98);
__d("WAWebGenerateEventEditSystemMessages",["Promise","WANullthrows","WAWebBackendApi","WAWebDBProcessMessage","WAWebMsgGetters","WAWebMsgKey","WAWebMsgType","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield (h||(h=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a[0];a=a[1];var e=d("WAWebWidFactory").createWid(c);c=(yield (h||(h=b("Promise"))).all(a.map(function(a){var b=a.protocolMsg.latestEditSenderTimestampMs;if(b==null||d("WAWebMsgGetters").getIsFailed(a.protocolMsg))return;return j(e,b,a)}).filter(Boolean)));a=(yield d("WAWebBackendApi").frontendSendAndReceive("processMultipleMessages",{chatId:e,msgObjs:c,meta:{add:"after",isHistory:!1},processMessagesOrigin:"eventEditMessage"}));a&&(yield d("WAWebDBProcessMessage").storeMessages(c,e))});return function(b){return a.apply(this,arguments)}}()))});return i.apply(this,arguments)}function j(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f,g=e.editedMsgData,h=e.protocolMsg,i=d("WAWebUserPrefsMeUser").getMeUser(),j=c("WANullthrows")(d("WAWebMsgGetters").getSender(h));g={eventName:c("WANullthrows")(g==null?void 0:g.eventName),eventStartTime:c("WANullthrows")(g==null?void 0:g.eventStartTime),eventEndTime:g==null?void 0:g.eventEndTime,isEventCanceled:(f=g==null?void 0:g.isEventCanceled)!=null?f:!1,eventLocation:(f=g==null?void 0:g.eventLocation)!=null?f:void 0,eventDescription:(f=g==null?void 0:g.eventDescription)!=null?f:void 0,eventJoinLink:(f=g==null?void 0:g.eventJoinLink)!=null?f:void 0};return babelHelpers["extends"]({id:new(c("WAWebMsgKey"))({id:yield c("WAWebMsgKey").newId(),fromMe:d("WAWebUserPrefsMeUser").isMeAccount(j),remote:a,participant:j}),author:j,from:a,to:i,t:h.t,type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,subtype:"event_edit_decrypted",viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,kind:d("WAWebMsgType").MsgKind.ProtocolEventEdit,editMsgType:d("WAWebMsgType").MSG_TYPE.EVENT_CREATION,latestEditMsgKey:h.latestEditMsgKey,latestEditSenderTimestampMs:b,protocolMessageKey:e.parentMsg.id},g)});return k.apply(this,arguments)}g.generateEventEditSystemMessages=a}),98);
__d("WAWebPrepareEventResponsesToUpsert",["WANullthrows","WAWebAddonDBTable","WAWebLidMigrationUtils","WAWebMaxPerGroup","WAWebMsgGetters","WAWebMsgType","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WAWebWidFactory").createWidFromWidLike(c("WANullthrows")(d("WAWebMsgGetters").getSender(a)));return String(a.parentMsgKey)+"|"+String(d("WAWebLidMigrationUtils").toLid(b))+"|"+String(d("WAWebLidMigrationUtils").toPn(b))}function i(a){return d("WAWebMaxPerGroup").maxPerGroup(a,function(a){return a.senderTimestampMs},h)}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.map(function(a){return[a.parentMsgKey,c("WANullthrows")(d("WAWebMsgGetters").getSender(a))]});a=i(a);b=(yield d("WAWebAddonDBTable").addonDBTable.bulkGetByParentAndSender(d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE,b));var e=new Map();b.forEach(function(a){a.kind===d("WAWebMsgType").MsgKind.EventResponseDecrypted&&e.set(h(a),a)});var f=[];a.forEach(function(a){var b=e.get(h(a));if(b!=null&&b.senderTimestampMs>a.senderTimestampMs)return;var c=b!=null&&b.eventResponse===a.eventResponse;b=(b=b==null?void 0:b.read)!=null?b:!1;c=c&&b&&a.read!==b?babelHelpers["extends"]({},a,{read:!0}):a;f.push(c)});return f});return j.apply(this,arguments)}g.getNewestEventResponses=i;g.prepareEventResponsesToUpsert=a}),98);
__d("WAWebProcessEncryptedEventEditMsgs",["Promise","WALogger","WAWebAddonEncryption","WAWebAddonEncryptionError","WAWebAddonInfraError","WAWebDBProcessEditProtocolMsgs","WAWebEventEditDecryptedMsgDataConversion","WAWebEventsValidationError","WAWebLidMigrationUtils","WAWebMsgGetters","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebVerifyProtobufMsgObjectKeys","WAWebWamEnumE2eFailureReason","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Processing encrypted event edit failed: ","\n",""],["Processing encrypted event edit failed: ","\\n",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Processing encrypted event edit failed: ",""]);j=function(){return a};return a}function a(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=new Map();a.forEach(function(a){if(a.kind!==d("WAWebMsgType").MsgKind.EventEditEncrypted)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedMsgType);var b=c.getForAddon(a);e.set(a,b)});if(e.size===0)return[];a=(yield (h||(h=b("Promise"))).allSettled(Array.from(e.entries()).map(function(a){var b=a[0];a=a[1];return l(b,a)})));return a.map(function(a){switch(a.status){case"fulfilled":return a.value;case"rejected":a=a.reason;if(a instanceof d("WAWebEventsValidationError").EventCreationValidationError||a instanceof d("WAWebEventsValidationError").EncryptedEventEditValidationError||a instanceof d("WAWebAddonEncryptionError").DualEncryptionValidationError){d("WALogger").ERROR(j(),a.code).sendLogs(a.code);return}d("WALogger").ERROR(i(),a.message,a.stack).sendLogs("event_edit_unknown_error")}}).filter(Boolean)});return k.apply(this,arguments)}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=a.encIv,f=a.encPayload,g=d("WAWebAddonEncryptionError").getValidatedMessageSecret(d("WAWebMsgType").MsgKind.EventEditEncrypted,b),h=d("WAWebMsgGetters").getOriginalSender(b),i=d("WAWebMsgGetters").getSender(a);if(i==null)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_MISSING_MESSAGE_SENDER,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(h==null)throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_MISSING_MESSAGE_SENDER,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(e==null)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_MISSING_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(f==null)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_MISSING_ENC_PAYLOAD,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(!c("WAWebWid").equals.apply(c("WAWebWid"),d("WAWebLidMigrationUtils").toCommonAddressingMode(i,h)))throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_PARENT_SENDER_MISMATCH,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);f={type:d("WAWebMsgType").MsgKind.EventEditEncrypted,encryptedAddOn:f};i=d("WAWebWidFactory").toUserWid(i);f=(yield d("WAWebAddonEncryption").decryptAddOn(f,{messageSecret:g,iv:e,stanzaId:b.id.id,originalMessageSender:h,addOnSender:i}));g=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsE2E.pb").MessageSpec,f);h=d("WAWebEventEditDecryptedMsgDataConversion").protobufToEventEditDecryptedMsgData((e=d("WAWebVerifyProtobufMsgObjectKeys").getUnwrappedProtobufMessage(g))!=null?e:g,a);return d("WAWebDBProcessEditProtocolMsgs").generateMessageEdit(b,h)});return m.apply(this,arguments)}g.processEncryptedEventEditMsgs=a}),98);
__d("WAWebProcessEncryptedEventResponseMsgs",["Promise","WALogger","WALongInt","WANullthrows","WAWebAddonEncryption","WAWebAddonEncryptionError","WAWebEventResponseMsgDataConversion","WAWebEventsValidationError","WAWebMsgGetters","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebUserPrefsMeUser","WAWebWamEnumE2eFailureReason","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Processing encrypted event response failed: ","\n",""],["Processing encrypted event response failed: ","\\n",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Processing encrypted event response failed: ",""]);j=function(){return a};return a}function a(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=[],f=new Map();a.forEach(function(a){if(a.addonEncrypted){var b=c.getForAddon(a);f.set(a,b)}else e.push(a)});if(f.size===0)return e;a=(yield (h||(h=b("Promise"))).allSettled(Array.from(f.entries()).map(function(a){var b=a[0];a=a[1];return l(b,a)})));return e.concat(a.map(function(a){switch(a.status){case"fulfilled":return a.value;case"rejected":a=a.reason;if(a instanceof d("WAWebEventsValidationError").EventCreationValidationError||a instanceof d("WAWebEventsValidationError").EncryptedEventResponseValidationError){d("WALogger").ERROR(j(),a.code).sendLogs(a.code);return}d("WALogger").ERROR(i(),a.message,a.stack).sendLogs("unknown-error")}}).filter(Boolean))});return k.apply(this,arguments)}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=a.encIv,f=a.encPayload,g=d("WAWebAddonEncryptionError").getValidatedMessageSecret(d("WAWebMsgType").MsgKind.EventResponseEncrypted,b),h=d("WAWebMsgGetters").getOriginalSender(b),i=d("WAWebMsgGetters").getSender(a);if(i==null)throw new(d("WAWebEventsValidationError").EncryptedEventResponseValidationError)(d("WAWebEventsValidationError").EncryptedEventResponseValidationErrorCode.EVENT_RESPONSE_MISSING_MESSAGE_SENDER,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(h==null)throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_MISSING_MESSAGE_SENDER,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(e==null)throw new(d("WAWebEventsValidationError").EncryptedEventResponseValidationError)(d("WAWebEventsValidationError").EncryptedEventResponseValidationErrorCode.EVENT_RESPONSE_MISSING_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(f==null)throw new(d("WAWebEventsValidationError").EncryptedEventResponseValidationError)(d("WAWebEventsValidationError").EncryptedEventResponseValidationErrorCode.EVENT_RESPONSE_MISSING_ENC_PAYLOAD,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);f={type:d("WAWebMsgType").MsgKind.EventResponseEncrypted,encryptedAddOn:f};i=d("WAWebWidFactory").toUserWid(i);f=(yield d("WAWebAddonEncryption").decryptAddOn(f,{messageSecret:g,iv:e,stanzaId:b.id.id,originalMessageSender:h,addOnSender:i}));g=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsE2E.pb").Message$EventResponseMessageSpec,f);return d("WAWebEventResponseMsgDataConversion").protobufToEventResponseMsgData({responseProtobuf:g,parentMsgKey:a.targetMessageKey,id:a.id,senderTimestampMs:d("WALongInt").numberOrThrowIfTooLarge(c("WANullthrows")(g.timestampMs)),t:d("WAWebMsgGetters").getT(a),ack:(e=a.ack)!=null?e:null,read:d("WAWebUserPrefsMeUser").isMeAccount(i)})});return m.apply(this,arguments)}g.processEncryptedEventResponseMsgs=a;g.decryptEncryptedEventResponseMsg=l}),98);
__d("WAWebEventResponseDBSerialization",["WANullthrows","WAWebMsgGetters","WAWebMsgKey","WAWebMsgKeyUtils","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebUserPrefsMeUser","WAWebViewMode.flow","err"],(function(a,b,c,d,e,f,g){function h(a){a=d("WAWebProtobufsE2E.pb").Message$EventResponseMessage$EventResponseType.cast(new Uint8Array(a)[0]);if(a==null)throw c("err")("Value contained in array buffer is not a valid event response");return a}function i(a){var b=new ArrayBuffer(1);b=new Uint8Array(b);b[0]=a;return b.buffer}function a(a){var b=c("WANullthrows")(d("WAWebMsgGetters").getSender(a));return{msgKey:a.id.toString(),parentMsgKey:a.parentMsgKey.toString(),eventResponse:i(a.eventResponse),senderTimestampMs:a.senderTimestampMs,sender:b.toString(),t:a.t,ack:a.ack,read:d("WAWebUserPrefsMeUser").isMeAccount(b)||a.read}}function b(a){var b=c("WAWebMsgKey").from(a.msgKey);return babelHelpers["extends"]({id:b},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(b,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{type:d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE,kind:d("WAWebMsgType").MsgKind.EventResponseDecrypted,ack:a.ack,t:a.t,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,eventResponse:h(a.eventResponse),parentMsgKey:c("WAWebMsgKey").from(a.parentMsgKey),senderTimestampMs:a.senderTimestampMs,read:(b=a.read)!=null?b:!1})}g.dbRowFromEventResponseMessage=a;g.eventResponseMessageFromDBRow=b}),98);
__d("WAWebEventsParseWebMsgInfoEventResponse",["WALogger","WALongInt","WANullthrows","WAWebAddOnParseWebMsgInfo","WAWebEventResponseMsgDataConversion","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[history sync] parseWebMsgInfoEventResponses failed with error "," "," and stack ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Failed to parse eventResponse with error ",""]);i=function(){return a};return a}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.webMsgInfo,e=a.parsedWebMsgInfo,f=a.isFromCag;try{if(!(b==null?void 0:b.eventResponses)||!e||e.type!==d("WAWebMsgType").MSG_TYPE.EVENT_CREATION)return[];var g=e;return b.eventResponses.map(function(a){try{var b,e=(b=c("WANullthrows"))(a.eventResponseMessageKey,"eventResponseMessageKey"),h=b(a.eventResponseMessage,"eventResponseMessage");e=b(d("WAWebAddOnParseWebMsgInfo").buildAddonMsgKey(e,f));e=e.msgKey;return d("WAWebEventResponseMsgDataConversion").protobufToEventResponseMsgData({responseProtobuf:h,id:e,parentMsgKey:g.id,senderTimestampMs:d("WALongInt").numberOrThrowIfTooLarge(b(h.timestampMs,"senderTimestampMs")),t:d("WAWebAddOnParseWebMsgInfo").getAddonServerTimestamp(a.timestampMs),ack:null,read:a.unread!==!0})}catch(a){d("WALogger").ERROR(i(),a.message).devConsole(a).sendLogs("parseWebMsgInfoEventResponses-responses-parse-error");return null}}).filter(Boolean)}catch(a){d("WALogger").ERROR(h(),a==null?void 0:a.name,a==null?void 0:a.code,a==null?void 0:a.stack).sendLogs("parseWebMsgInfoEventResponses-error");return[]}});return j.apply(this,arguments)}g.parseWebMsgInfoEventResponses=a}),98);
__d("WAWebEventsParseEventEditEncryptedMessageProto",["WAWebE2EProtoUtils","WAWebEventsValidationError","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage;a.msgContext;a=b.secretEncryptedMessage;b=b.messageContextInfo;if(a==null||a.secretEncType!==d("WAWebProtobufsE2E.pb").Message$SecretEncryptedMessage$SecretEncType.EVENT_EDIT)return;var e=a.targetMessageKey,f=a.encPayload;a=a.encIv;e=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(e,c);if(e==null)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_MISSING_TARGET_MESSAGE_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a==null)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_MISSING_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a.byteLength!==12)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_INVALID_SIZE_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(f==null)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_MISSING_ENC_PAYLOAD,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if((b==null?void 0:b.messageSecret)==null)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_MISSING_MESSAGE_SECRET,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.MISSING_MESSAGE_SECRET);return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.EVENT_EDIT_ENCRYPTED,kind:d("WAWebMsgType").MsgKind.EventEditEncrypted,encIv:a,encPayload:f,targetMessageKey:e}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebEventsParseEventResponseMessageProto",["WAWebE2EProtoUtils","WAWebEventsValidationError","WAWebMsgType","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.encEventResponseMessage;if(b==null)return null;var c=b.eventCreationMessageKey,e=b.encPayload;b=b.encIv;c=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(c,a);if(c==null)throw new(d("WAWebEventsValidationError").EncryptedEventResponseValidationError)(d("WAWebEventsValidationError").EncryptedEventResponseValidationErrorCode.EVENT_RESPONSE_MISSING_MESSAGE_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(b==null)throw new(d("WAWebEventsValidationError").EncryptedEventResponseValidationError)(d("WAWebEventsValidationError").EncryptedEventResponseValidationErrorCode.EVENT_RESPONSE_MISSING_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(b.byteLength!==12)throw new(d("WAWebEventsValidationError").EncryptedEventResponseValidationError)(d("WAWebEventsValidationError").EncryptedEventResponseValidationErrorCode.EVENT_RESPONSE_INVALID_SIZE_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(e==null)throw new(d("WAWebEventsValidationError").EncryptedEventResponseValidationError)(d("WAWebEventsValidationError").EncryptedEventResponseValidationErrorCode.EVENT_RESPONSE_MISSING_ENC_PAYLOAD,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE,kind:d("WAWebMsgType").MsgKind.EventResponseEncrypted,addonEncrypted:!0,encIv:b,encPayload:e,targetMessageKey:c}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebGenerateInteractiveResponseReportingTokenContent",["WAWebReportingTokenUtils"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebReportingTokenUtils").getMediaReportingTokenContent(a)}g["default"]=a}),98);
__d("WAWebParseButtonsResponseMessageProto",["WAWebE2EProtoUtils","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.buttonsResponseMessage;if(b==null)return;if(b.type===d("WAWebProtobufsE2E.pb").Message$ButtonsResponseMessage$Type.DISPLAY_TEXT){var c=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.BUTTONS_RESPONSE,kind:d("WAWebMsgType").MsgKind.ButtonsResponse,selectedButtonId:b.selectedButtonId,body:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(b.selectedDisplayText)});return{msgData:c,contextInfo:b.contextInfo}}return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown}),contextInfo:b.contextInfo}}g["default"]=a}),98);
__d("WAWebParseHsmMessageProto",["WAWebE2EProtoUtils","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.highlyStructuredMessage;if(b==null)return;b=(b=b.hydratedHsm)==null?void 0:b.hydratedTemplate;return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.HSM,kind:d("WAWebMsgType").MsgKind.Hsm,body:b?d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(b.hydratedContentText):a.body}),contextInfo:void 0}}g["default"]=a}),98);
__d("WAWebParseInteractiveMessageProto",["WAWebE2EProtoParserApi","WAWebE2EProtoUtils","WAWebHandleMsgError","WAWebInteractiveMessageHeaderMediaType","WAWebInteractiveMessageType","WAWebInteractiveMessagesNativeFlowName","WAWebMsgKey","WAWebMsgType","WAWebNativeFlowValidation","WAWebParseDocumentMessageProto","WAWebParseImageMessageProto","WAWebParseVideoMessageProto","WAWebWamEnumE2eFailureReason","filterNulls"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,e=a.baseMessage,f=a.bizInfo,g=a.bizSource;a=a.msgContext;b=b.interactiveMessage;if(b==null)return;var j=d("WAWebE2EProtoUtils").getInteractiveMessageTypeForProto(b);if(!j||!d("WAWebE2EProtoUtils").isInteractiveMessageTypeEnabled(j))return k(e,b);var l=b.body,m=b.footer,n=d("WAWebE2EProtoUtils").getInteractiveMessageFieldNameForType(j);l={type:d("WAWebMsgType").MSG_TYPE.INTERACTIVE,kind:d("WAWebMsgType").MsgKind.Interactive,caption:(l=d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(l==null?void 0:l.text))!=null?l:"",interactiveType:j,interactivePayload:b[n],pmCampaignId:f==null?void 0:f.campaignId,bizSource:g};if(!d("WAWebE2EProtoUtils").isSupportedInteractiveMessageVersion(j,b[n]))return k(e,b);n=null;var o=b.carouselMessage;if(o!=null){n=i(e,o,a,f,g);if(n==null)return k(e,b)}if(j===c("WAWebInteractiveMessageType").NATIVE_FLOW){o=c("WAWebInteractiveMessagesNativeFlowName").cast(d("WAWebE2EProtoUtils").getBizNativeFlowName({interactiveMessage:b}));l=babelHelpers["extends"]({},l,{nativeFlowName:o});if(!d("WAWebE2EProtoUtils").isValidNativeFlowName(o,f)||!d("WAWebNativeFlowValidation").isValidNativeFlowMessage(l,g,e==null?void 0:(j=e.id)==null?void 0:j.fromMe))return k(e,b)}o=b.header!=null?h(b.header,e,a):void 0;return{msgData:babelHelpers["extends"]({},e,(f=o==null?void 0:o.headerMessage)!=null?f:{},l,{interactiveHeader:o==null?void 0:o.interactiveHeader,footer:m?d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(m.text):e.footer,carouselCardsParsed:(g=n)!=null?g:void 0}),contextInfo:b.contextInfo}}function h(a,b,e){var f=function(){if(a.imageMessage){var f;f=(f=c("WAWebParseImageMessageProto")({messageProtobuf:{imageMessage:a.imageMessage},baseMessage:b,msgContext:e}))==null?void 0:f.msgData;if(f&&f.kind!==d("WAWebMsgType").MsgKind.Image)throw new(d("WAWebHandleMsgError").MessageValidationError)("parseInteractiveHeaderMessageProto: header imageMessage is not an ImageMsgData",d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{headerMessage:f,mediaType:d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.IMAGE}}if(a.documentMessage){return{headerMessage:(f=c("WAWebParseDocumentMessageProto")({messageProtobuf:{documentMessage:a.documentMessage},baseMessage:b,msgContext:e}))==null?void 0:f.msgData,mediaType:d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.DOCUMENT}}if(a.videoMessage){f=(f=c("WAWebParseVideoMessageProto")({messageProtobuf:{videoMessage:a.videoMessage},baseMessage:b,msgContext:e}))==null?void 0:f.msgData;if(f&&f.kind!==d("WAWebMsgType").MsgKind.Video)throw new(d("WAWebHandleMsgError").MessageValidationError)("parseInteractiveHeaderMessageProto: header videoMessage is not an VideoMsgData",d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{headerMessage:f,mediaType:d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.VIDEO}}};f=a.hasMediaAttachment===!0?f():void 0;return{headerMessage:f==null?void 0:f.headerMessage,interactiveHeader:{title:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(a.title),subtitle:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(a.subtitle),thumbnail:d("WAWebE2EProtoParserApi").decodeBytes(a.jpegThumbnail),hasMediaAttachment:Boolean(a.hasMediaAttachment),mediaType:f==null?void 0:f.mediaType}}}function i(a,b,d,e,f){b=b.cards.map(function(b){return j(b,a,d,e,f)});b=c("filterNulls")(b);return b.length===0?null:b}function j(a,b,e,f,g){var i=a.body,j=a.header,k=d("WAWebE2EProtoUtils").getInteractiveMessageTypeForProto(a);if(!k||!d("WAWebE2EProtoUtils").isInteractiveMessageTypeEnabled(k))return null;i=babelHelpers["extends"]({},j,{type:d("WAWebMsgType").MSG_TYPE.INTERACTIVE,kind:d("WAWebMsgType").MsgKind.Interactive,caption:(i=d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(i==null?void 0:i.text))!=null?i:"",interactiveType:k,interactivePayload:a.nativeFlowMessage,pmCampaignId:f==null?void 0:f.campaignId,bizSource:g});k=j!=null?h(j,b,e):void 0;a=k==null?void 0:k.headerMessage;if(k==null||a==null)return null;f=babelHelpers["extends"]({},k.interactiveHeader,{title:null,subtitle:null});g=new(c("WAWebMsgKey"))({fromMe:a.id.fromMe,remote:a.id.remote,participant:a.id.participant,id:c("WAWebMsgKey").newId_DEPRECATED()});if(a.type===d("WAWebMsgType").MSG_TYPE.VIDEO)return babelHelpers["extends"]({},a,i,{id:g,interactiveHeader:f,footer:null,isCarouselCard:!0,parentMsgId:b.id.clone()});if(a.type===d("WAWebMsgType").MSG_TYPE.IMAGE)return babelHelpers["extends"]({},a,i,{id:g,interactiveHeader:f,footer:null,isCarouselCard:!0,parentMsgId:b.id.clone()})}function k(a,b){return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"phone_only_feature"}),contextInfo:b.contextInfo}}g["default"]=a}),98);
__d("WAWebParseInteractiveResponseMessageProto",["WAWebBizGatingUtils","WAWebE2EProtoUtils","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.bizInfo;b=b.interactiveResponseMessage;if(b==null)return;var e=d("WAWebE2EProtoUtils").getInteractiveResponseMessageTypeForProto(b);if(!d("WAWebBizGatingUtils").interactiveNativeFlowResponseMessagesEnabled()||!e||!d("WAWebE2EProtoUtils").isInteractiveResponseMessageTypeEnabled(e))return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"phone_only_feature"}),contextInfo:b.contextInfo};try{var f;return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.INTERACTIVE_RESPONSE,kind:d("WAWebMsgType").MsgKind.InteractiveResponse,body:(f=d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis((f=b.body)==null?void 0:f.text))!=null?f:"",interactivePayload:d("WAWebE2EProtoUtils").getInteractiveResponsePayload(e,b,a)}),contextInfo:b.contextInfo}}catch(a){return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"phone_only_feature"}),contextInfo:b.contextInfo}}}g["default"]=a}),98);
__d("WAWebParseListResponseMessageProto",["WAWebE2EProtoUtils","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.listResponseMessage;if(b==null)return;if(b.listType===d("WAWebProtobufsE2E.pb").Message$ListResponseMessage$ListType.SINGLE_SELECT){var c=babelHelpers["extends"]({},b,{contextInfo:void 0}),e=b.title||"";b.description!=null&&b.description!==""&&(e+="\n"+b.description);a=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.LIST_RESPONSE,kind:d("WAWebMsgType").MsgKind.ListResponse,listResponse:c,body:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(e)});return{msgData:a,contextInfo:b.contextInfo}}}g["default"]=a}),98);
__d("WAWebParseNativeFlowButtonsMessageProto",["WAWebButtonsMessageProtoUtils","WAWebE2EProtoUtils","WAWebInteractiveMessagesNativeFlowName","WAWebMsgType","WAWebNativeFlowValidation","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,e=a.baseMessage,f=a.bizInfo,g=a.bizSource;a=a.msgContext;b=b.buttonsMessage;if(b==null)return;var h=b.buttons;h=h===void 0?[]:h;var i=b.headerType,j=c("WAWebInteractiveMessagesNativeFlowName").cast(d("WAWebE2EProtoUtils").getBizNativeFlowName({buttonsMessage:b}));if(j==null&&(f==null?void 0:f.nativeFlowName)==null)return;if(!d("WAWebE2EProtoUtils").shouldParseNFM(j,f)||d("WAWebE2EProtoUtils").hasUnsupportedButtons(h))return{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"phone_only_feature"}),contextInfo:b.contextInfo};if(i===d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.UNKNOWN||!new Set(d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.members()).has(i))return{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:void 0}),contextInfo:b.contextInfo};f=d("WAWebButtonsMessageProtoUtils").parseButtonsMessageProto({buttonsMessage:b,baseMessage:e,msgContext:a});if(j==null)return;i=babelHelpers["extends"]({},f,{type:d("WAWebMsgType").MSG_TYPE.NATIVE_FLOW,kind:d("WAWebMsgType").MsgKind.NativeFlow,nativeFlowName:c("WAWebInteractiveMessagesNativeFlowName").cast(j),nativeFlowButtons:h});return!i.nativeFlowName||!d("WAWebNativeFlowValidation").isValidNativeFlowMessage(i,g)?{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"phone_only_feature"}),contextInfo:b.contextInfo}:{msgData:i,contextInfo:b.contextInfo}}g["default"]=a}),98);
__d("WAWebParseTemplateButtonReplyMessageProto",["WAWebE2EProtoUtils","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.templateButtonReplyMessage;if(b==null)return;a=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.TEMPLATE_BUTTON_REPLY,kind:d("WAWebMsgType").MsgKind.TemplateButtonReply,body:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(b.selectedDisplayText),selectedIndex:b.selectedIndex,selectedId:b.selectedId,selectedCarouselCardIndex:b.selectedCarouselCardIndex});return{msgData:a,contextInfo:b.contextInfo}}g["default"]=a}),98);
__d("WAWebParseLocationMessageProto",["WALongInt","WAWebE2EProtoParserApi","WAWebE2EProtoUtils","WAWebMsgType"],(function(a,b,c,d,e,f,g){function h(a,b){var c;c=((c=a.name)!=null?c:"")||((c=a.address)!=null?c:"");a.name!=null&&a.name!==""&&a.address!=null&&a.address!==""&&(c=a.name+"\n"+a.address);var e=a.degreesLatitude!==void 0?a.degreesLatitude:void 0,f=a.degreesLongitude!==void 0?a.degreesLongitude:void 0;b=babelHelpers["extends"]({},b,{type:d("WAWebMsgType").MSG_TYPE.LOCATION,kind:d("WAWebMsgType").MsgKind.Location,loc:c,lat:e,lng:f,body:d("WAWebE2EProtoParserApi").decodeBytes(a.jpegThumbnail)||"",clientUrl:a.url});return{msgData:b,contextInfo:a.contextInfo}}function i(a,b,c){var e={};c&&(e={finalLat:c.degreesLatitude,finalLng:c.degreesLongitude,finalThumbnail:d("WAWebE2EProtoParserApi").decodeBytes(c.jpegThumbnail)||"",finalAccuracy:c.accuracyInMeters,finalSpeed:c.speedInMps,finalDegrees:c.degreesClockwiseFromMagneticNorth,finalTimeOffset:c.timeOffset});c=babelHelpers["extends"]({},b,e,{type:d("WAWebMsgType").MSG_TYPE.LOCATION,kind:d("WAWebMsgType").MsgKind.LocationLive,isLive:!0,lat:a.degreesLatitude,lng:a.degreesLongitude,body:d("WAWebE2EProtoParserApi").decodeBytes(a.jpegThumbnail)||"",accuracy:a.accuracyInMeters,speed:a.speedInMps,degrees:a.degreesClockwiseFromMagneticNorth,comment:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(a.caption),sequence:d("WALongInt").maybeNumberOrThrowIfTooLarge(a.sequenceNumber)});return{msgData:c,contextInfo:a.contextInfo}}function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.finalLocation;var d=b.locationMessage;b=b.liveLocationMessage;var e=null;d!=null&&(e=h(d,c));b!=null&&(e=i(b,c,a));return e}g["default"]=a}),98);
__d("WAWebAssociationProtoUtils",["WANullthrows","WAWebAssociationProcessor","WAWebE2EProtoUtils","WAWebMessageAssociation.flow","WAWebMessageAssociationValidation","WAWebProtobufsE2E.pb","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){"use strict";function h(a){a=d("WAWebMessageAssociation.flow").MessageAssociationType.cast(d("WAWebProtobufsE2E.pb").MessageAssociation$AssociationType.getName(a));return(a=a)!=null?a:d("WAWebMessageAssociation.flow").MessageAssociationType.UNKNOWN}function a(a,b){b=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(a.parentMessageKey,b);a=h(a.associationType);var e=d("WAWebAssociationProcessor").getAssociationProcessorByAssociationType(a);if(e==null)throw new(d("WAWebMessageAssociationValidation").MessageAssociationValidationError)(d("WAWebMessageAssociationValidation").MessageAssociationValidationErrorCode.UNSUPPORTED_ASSOCIATION_TYPE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{associationParentMsgKey:c("WANullthrows")(b),associationType:a,viewMode:e.viewMode}}g.convertAssociationTypeFromProtoToClientSupportedAssociationType=h;g.getValidatedAssociationFieldsFromProto=a}),98);
__d("WAWebProcessMessageAssociationMessages",["WALogger","WAWebAddonProcessMsgsUtils","WAWebAddonSortUtils","WAWebAssociationProcessor","WAWebAssociationProcessorConstants","WAWebMessageAssociationGatingUtils","WAWebMessageAssociationValidation","WAWebViewMode.flow","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["classifyAssociatedMsgs: processor not found for ",""]);h=function(){return a};return a}function a(a,b){if(!d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled())return;a=a;a=j(a,b);b=a.orphans;a=a.nonOrphansFromCache;return l(b,a)}function c(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(!d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled())return;var c=(yield d("WAWebAddonProcessMsgsUtils").queryParentMsgs(a)),e=c[0];c=c[1];c=d("WAWebAddonSortUtils").collectValidAndOrphans(c,e);e=c.nonOrphans;c=c.orphans;a=e.length+c.length===a.length;if(!a)throw new(d("WAWebMessageAssociationValidation").MessageAssociationInfraError)(d("WAWebMessageAssociationValidation").MessageAssociationInfraErrorCode.MESSAGE_ASSOCIATIONS_MISMATCH);a=k(c,b);c=a.orphans;b=a.nonOrphansFromCache;return l(c,[].concat(e,b))});return i.apply(this,arguments)}function j(a,b){var c=[],d=[];a.forEach(function(a){b.has(a.parentMsgKey.toString())?c.push(a):d.push(a)});return{orphans:c,nonOrphansFromCache:d}}function k(a,b){var c=[],d=[];a.forEach(function(a){b.has(a.parentMsgKey.toString())?d.push(a):c.push(a)});return{orphans:c,nonOrphansFromCache:d}}function l(a,b){var c=[],e=[];a.forEach(function(a){var b=d("WAWebAssociationProcessor").getAssociationProcessor(a);b||d("WALogger").ERROR(h(),a.id.toString());(b==null?void 0:b.processorType)===d("WAWebAssociationProcessorConstants").AssociationProcessorType.WithDetachedMessages?e.push(a):c.push(a)});a=e.map(function(a){return babelHelpers["extends"]({},a,{viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE})});b=[].concat(b,a);var f=new Map();b.forEach(function(a){f.set(a.id.toString(),a)});return{orphanAssociatedMsgs:c,validAssociatedMsgs:f,detachedAssociatedMsgs:a}}g.classifyAssociatedMsgsFromHistorySyncUsingMissingParentsCache=a;g.classifyAssociatedMsgsUsingExistingParentsCache=c}),98);
__d("WAWebMessageEditValidationError",["$InternalEnum","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({MISSING_PROTOCOL_KEY:"missing_protocol_key",MISSING_EDITED_MESSAGE:"missing_edited_message"});c=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="MessageEditValidationError",b)||babelHelpers.assertThisInitialized(c)}return b}(d("WAWebHandleMsgError").MessageValidationError);g.MessageEditValidationErrorCode=a;g.MessageEditValidationError=c}),98);
__d("WAWebParseHistorySyncProtocolMessageEditProto",["WALogger","WALongInt","WAWebE2EProtoParser","WAWebE2EProtoUtils","WAWebMessageEditGatingUtils","WAWebMessageEditValidationError","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseHistorySyncEditedMessageProto: error:",", stack: ",""]);h=function(){return a};return a}function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.msgContext;b=b.protocolMessage;if(b==null||(b==null?void 0:b.type)!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.MESSAGE_EDIT)return;if(a!=="history"&&a!=="history_quoted")return;try{if(!d("WAWebMessageEditGatingUtils").receiveTextEditEnabled())return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"message_edit",futureproofType:d("WAWebMsgType").MSG_TYPE.PROTOCOL,futureproofSubtype:"message_edit"}),contextInfo:null};c=babelHelpers["extends"]({},c,{latestEditSenderTimestampMs:d("WALongInt").maybeNumberOrThrowIfTooLarge(b.timestampMs),latestEditMsgKey:c.id});var e=b.editedMessage;if(e==null)throw new(d("WAWebMessageEditValidationError").MessageEditValidationError)(d("WAWebMessageEditValidationError").MessageEditValidationErrorCode.MISSING_EDITED_MESSAGE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);b=b.key;if(b==null)throw new(d("WAWebMessageEditValidationError").MessageEditValidationError)(d("WAWebMessageEditValidationError").MessageEditValidationErrorCode.MISSING_PROTOCOL_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);Object.assign(c,d("WAWebE2EProtoParser").parseMsgProto(e,c,a));c.id=d("WAWebE2EProtoUtils").protobufToMsgKey(b,c.author);return{msgData:c,contextInfo:null}}catch(a){d("WALogger").WARN(h(),a==null?void 0:a.name,a==null?void 0:a.stack).tags("messaging").sendLogs("parseHistorySyncEditedMessageProto: EditParseError");throw a}}g["default"]=a}),98);
__d("WAWebParseProtocolMessageEditProto",["WALogger","WALongInt","WANullthrows","WAWebE2EProtoParser","WAWebE2EProtoUtils","WAWebFutureproofingEdit","WAWebMessageEditGatingUtils","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseProtocolMessageEditProto: error:",", stack: ",""]);h=function(){return a};return a}function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.msgContext;b=b.protocolMessage;if(b==null||(b==null?void 0:b.type)!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.MESSAGE_EDIT)return;if(a!=="relay"&&a!=="outgoing")return;try{a=(a=i(c,b))!=null?a:j(c,b);return!a?null:a}catch(a){d("WALogger").WARN(h(),a==null?void 0:a.name,a==null?void 0:a.stack).tags("messaging").sendLogs("parseProtocolMessageEditProto: EditParseError");throw a}}function i(a,b){var e;e=(e=(e=b.editedMessage)==null?void 0:(e=e.groupMentionedMessage)==null?void 0:e.message)!=null?e:b.editedMessage;var f=Boolean(e==null?void 0:e.conversation)||Boolean(e==null?void 0:e.extendedTextMessage);if(!f)return null;if(!d("WAWebMessageEditGatingUtils").receiveTextEditEnabled())return{msgData:d("WAWebFutureproofingEdit").futureproofEdit(a),contextInfo:null};f=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(b.key,a);e=babelHelpers["extends"]({},d("WAWebE2EProtoParser").parseMsgProto(c("WANullthrows")(e),a),{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"message_edit",editMsgType:d("WAWebMsgType").MSG_TYPE.CHAT,latestEditSenderTimestampMs:d("WALongInt").maybeNumberOrThrowIfTooLarge(b.timestampMs),latestEditMsgKey:a.id,protocolMessageKey:f});return{msgData:e,contextInfo:null}}function j(a,b){var c;c=(c=(c=b.editedMessage)==null?void 0:(c=c.groupMentionedMessage)==null?void 0:c.message)!=null?c:b.editedMessage;var e,f,g;if(c==null?void 0:c.imageMessage)e=d("WAWebMsgType").MSG_TYPE.IMAGE,f=c.imageMessage.caption,g=c.imageMessage.contextInfo;else if(c==null?void 0:c.videoMessage)e=d("WAWebMsgType").MSG_TYPE.VIDEO,f=c.videoMessage.caption,g=c.videoMessage.contextInfo;else if(c==null?void 0:c.documentMessage)e=d("WAWebMsgType").MSG_TYPE.DOCUMENT,f=c.documentMessage.caption,g=c.documentMessage.contextInfo;else if(c==null?void 0:c.documentWithCaptionMessage){var h;e=d("WAWebMsgType").MSG_TYPE.DOCUMENT;f=(h=c.documentWithCaptionMessage)==null?void 0:(h=h.message)==null?void 0:(h=h.documentMessage)==null?void 0:h.caption;g=(h=c.documentWithCaptionMessage)==null?void 0:(c=h.message)==null?void 0:(h=c.documentMessage)==null?void 0:h.contextInfo}if(!e||f===""||f==null)return null;if(!d("WAWebMessageEditGatingUtils").receiveCaptionEditEnabled())return{msgData:d("WAWebFutureproofingEdit").futureproofEdit(a),contextInfo:null};c=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"message_edit",editMsgType:e,caption:f,latestEditSenderTimestampMs:d("WALongInt").maybeNumberOrThrowIfTooLarge(b.timestampMs),latestEditMsgKey:a.id,protocolMessageKey:d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(b.key,a)});return{msgData:c,contextInfo:g}}g["default"]=a}),98);
__d("WAWebDBStoreNewsletterEncryptedMsgs",["WALogger","WAPromiseMap","WAWebDBStoreMessage","WAWebDBStoreMsgsUtils","WAWebModelStorageUtils","WAWebMsgKey","WAWebNewsletterDBUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[newsletter-store] Failed to store messages"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][storage] serverId is missing from message"]);i=function(){return a};return a}function a(a){return d("WAWebModelStorageUtils").getStorage().lock(["message","chat"],function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e){e=e[0];var f=(yield d("WAWebDBStoreMsgsUtils").getLastRowId(e)),g=(yield d("WAPromiseMap").promiseMap(a,function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e,g=a[0];a=a[1];e=(e=g.serverId)!=null?e:yield d("WAWebNewsletterDBUtils").getTemporaryServerId(g.to);if(e==null){d("WALogger").ERROR(i()).tags("newsletter").devConsole(g).sendLogs("newsletter-missing-serverId");return null}var h=c("WAWebMsgKey").fromString(g.id),j=d("WAWebDBStoreMessage").isPendingUnreadReceipt(h,g);g=d("WAWebDBStoreMessage").addMsgMetadataToMsgRow({msg:g,chatId:h.remote.toString(),hasLink:a,inChatMsgId:e,rowId:f+b+1,pendingReadReceipt:j});delete g.serverId;return g});return function(b,c){return a.apply(this,arguments)}}())).filter(Boolean);try{yield e.bulkCreateWith_ALREADY_ENCRYPTED_RECORDS_ONLY(g)}catch(a){d("WALogger").ERROR(h()).tags("newsletter").devConsole(a)}});return function(a){return e.apply(this,arguments)}}())}g.storeEncryptedNewsletterMessages=a}),98);
__d("WAWebNewsletterDBConstants",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({Subscriber:0,Admin:1,Guest:2,Owner:3});f.NewsletterDBMembership=a}),66);
__d("WAWebNewsletterDBUtils",["WATimeUtils","WAWebApiChat","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebDBMsgUtils","WAWebJidToWid","WAWebMsgKey","WAWebMsgType","WAWebNewsletterDBConstants","WAWebSchemaMessage","WAWebSchemaNewsletterMetadata","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return(yield d("WAWebApiChat").getChatRecord(d("WAWebJidToWid").newsletterJidToWid(a)))!=null});return h.apply(this,arguments)}function i(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().get(a));return a==null||a.membershipType===d("WAWebNewsletterDBConstants").NewsletterDBMembership.Guest});return j.apply(this,arguments)}function e(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield i(a));return!a});return k.apply(this,arguments)}var l=Number.MAX_SAFE_INTEGER-1e4;function f(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=d("WAWebDBMessageUtils").craftInternalId(b,a);a=(yield d("WAWebSchemaMessage").getMessageTable().anyOf(["internalId"],[b]));b=a[0];return b==null?null:d("WAWebDBMessageSerialization").messageFromDbRow(b)});return m.apply(this,arguments)}function n(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=new Map(),e=new Map(a.map(function(a){return[d("WAWebDBMessageUtils").craftInternalId(b,a),a]}));a=(yield d("WAWebSchemaMessage").getMessageTable().anyOf(["internalId"],Array.from(e.keys())));a.forEach(function(a){if(a.internalId==null)return;var b=e.get(a.internalId);if(b==null)return;c.set(b,d("WAWebDBMessageSerialization").messageFromDbRow(a))});return c});return o.apply(this,arguments)}function p(a,b){b=b instanceof c("WAWebWid")?b:d("WAWebWidFactory").createWid(b);return new(c("WAWebMsgKey"))({remote:b,fromMe:!0,id:a.toString(10)})}function q(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebDBMessageUtils").craftInternalId(a.toJid(),l);a=d("WAWebDBMessageUtils").endOfChat(a);b=(yield d("WAWebSchemaMessage").getMessageTable().between(["internalId"],b,a,{lowerInclusive:!0,upperInclusive:!1,limit:1,reverse:!0}));if(b.length===0)return l;if(b[0].internalId==null)return l;a=d("WAWebDBMessageUtils").getInChatMsgId(b[0].internalId);return Math.min(a+1,Number.MAX_SAFE_INTEGER)});return r.apply(this,arguments)}function s(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet(a.map(String)));a=a.filter(Boolean).map(function(a){return{id:a.id,viewed:!0}});yield d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(a)});return t.apply(this,arguments)}function u(a,b,c){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=(yield d("WAWebDBMsgUtils").getMsgsByChatId(b));var e=d("WATimeUtils").unixTime();b=b.filter(function(a){return a.type===d("WAWebMsgType").MSG_TYPE.NEWSLETTER_ADMIN_INVITE}).map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)});return b.filter(function(b){if(!b.from.equals(c))return!1;b=(b=b.newsletterAdminInviteInfo)!=null?b:{};var d=b.newsletterId;b=b.inviteExpiration;return d==null||b==null?!1:e<b&&a.equals(d)})});return v.apply(this,arguments)}g.doesNewsletterExistInStorage=a;g.isPreviewNewsletter=i;g.isSubscribedNewsletter=e;g.TEMPORARY_SERVER_ID_LOWER_BOUND=l;g.getMessageByServerId=f;g.bulkGetMessagesByServerIds=n;g.craftNewsletterMsgKeyFromServerId=p;g.getTemporaryServerId=q;g.updateMsgViewReceipt=s;g.getUnexpiredNewsletterAdminInviteMessageRecordsFromChat=u}),98);
__d("WAWebNewsletterLogExposureJob",["WAJobOrchestratorTypes","WAWebMexLogNewsletterExposureJob","WAWebOrchestratorNonPersistedJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("logNewsletterExposure",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebMexLogNewsletterExposureJob").mexLogNewsletterExposure(a,c)}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW}).waitUntilCompleted()}g.logNewsletterExposure=a}),98);
__d("WAWebNewsletterAdminInviteMessageValidationError",["$InternalEnum","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({MISSING_NEWSLETTER_JID:"newsletter_admin_invite_missing_newsletter_jid",MISSING_NEWSLETTER_NAME:"newsletter_admin_invite_missing_newsletter_name",MISSING_INVITE_EXPIRATION:"newsletter_admin_invite_missing_invite_expiration",INVALID_NEWSLETTER_JID:"newsletter_admin_invite_invalid_newsletter_jid"});c=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="NewsletterAdminInviteMessageValidationError",b)||babelHelpers.assertThisInitialized(c)}return b}(d("WAWebHandleMsgError").MessageValidationError);g.NewsletterAdminInviteMessageValidationErrorCode=a;g.NewsletterAdminInviteMessageValidationError=c}),98);
__d("WAWebParseNewsletterAdminInviteMessageProto",["WATimeUtils","WAWebE2EProtoUtils","WAWebMsgType","WAWebNewsletterAdminInviteMessageValidationError","WAWebNewsletterGatingUtils","WAWebWamEnumE2eFailureReason","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.newsletterAdminInviteMessage;if(b==null)return;if(!d("WAWebNewsletterGatingUtils").isNewsletterCreationEnabled())return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,futureproofType:d("WAWebMsgType").MSG_TYPE.NEWSLETTER_ADMIN_INVITE}),contextInfo:b.contextInfo};var c=b.caption,e=b.inviteExpiration,f=b.newsletterJid,g=b.newsletterName;b=b.contextInfo;if(f==null)throw new(d("WAWebNewsletterAdminInviteMessageValidationError").NewsletterAdminInviteMessageValidationError)(d("WAWebNewsletterAdminInviteMessageValidationError").NewsletterAdminInviteMessageValidationErrorCode.MISSING_NEWSLETTER_JID,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(g==null)throw new(d("WAWebNewsletterAdminInviteMessageValidationError").NewsletterAdminInviteMessageValidationError)(d("WAWebNewsletterAdminInviteMessageValidationError").NewsletterAdminInviteMessageValidationErrorCode.MISSING_NEWSLETTER_NAME,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(e==null)throw new(d("WAWebNewsletterAdminInviteMessageValidationError").NewsletterAdminInviteMessageValidationError)(d("WAWebNewsletterAdminInviteMessageValidationError").NewsletterAdminInviteMessageValidationErrorCode.MISSING_NEWSLETTER_JID,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);f=d("WAWebE2EProtoUtils").strictDecodeJid(f);if(f==null)throw new(d("WAWebNewsletterAdminInviteMessageValidationError").NewsletterAdminInviteMessageValidationError)(d("WAWebNewsletterAdminInviteMessageValidationError").NewsletterAdminInviteMessageValidationErrorCode.INVALID_NEWSLETTER_JID,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.NEWSLETTER_ADMIN_INVITE,kind:d("WAWebMsgType").MsgKind.NewsletterAdminInvite,newsletterAdminInviteInfo:{newsletterId:d("WAWebWidFactory").toNewsletterWid(f),newsletterName:g,inviteExpiration:d("WATimeUtils").castLongIntToUnixTime(e),inviteMessage:(a=c)!=null?a:"",pictureThumbnail:null}}),contextInfo:b}}g["default"]=a}),98);
__d("WAWebNewsletterFutureProofUtils",["WAWebABProps","WAWebMsgGetters","WAWebMsgType","WAWebNewsletterGatingUtils","WAWebPollsGatingUtils"],(function(a,b,c,d,e,f,g){var h=new Map([[1,(b=d("WAWebMsgType")).MSG_TYPE.CHAT],[2,b.MSG_TYPE.IMAGE],[3,b.MSG_TYPE.VIDEO],[4,b.MSG_TYPE.AUDIO],[5,b.MSG_TYPE.PTT],[6,b.MSG_TYPE.LOCATION],[7,b.MSG_TYPE.VCARD],[8,b.MSG_TYPE.DOCUMENT],[11,b.MSG_TYPE.MULTI_VCARD],[12,b.MSG_TYPE.REACTION],[13,b.MSG_TYPE.POLL_CREATION],[14,b.MSG_TYPE.POLL_UPDATE],[15,b.MSG_TYPE.STICKER],[16,b.MSG_TYPE.POLL_RESULT_SNAPSHOT]]);function i(){return d("WAWebABProps").getABPropConfigValue("channel_supported_message_types").split(",").map(function(a){return Number.parseInt(a.trim(),10)}).filter(Number.isSafeInteger).reduce(function(a,b){b=h.get(b);b!=null&&a.add(b);return a},new Set())}function j(a){var b=i().has(a);switch(a){case d("WAWebMsgType").MSG_TYPE.STICKER:return d("WAWebNewsletterGatingUtils").isNewsletterStickerReceivingEnabled();case d("WAWebMsgType").MSG_TYPE.PTT:return d("WAWebNewsletterGatingUtils").isNewsletterPTTReceivingEnabled();case d("WAWebMsgType").MSG_TYPE.POLL_CREATION:case d("WAWebMsgType").MSG_TYPE.POLL_UPDATE:return d("WAWebNewsletterGatingUtils").isNewsletterPollsReceivingEnabled();case d("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT:return d("WAWebPollsGatingUtils").isPollResultSnapshotReceivingEnabled();case d("WAWebMsgType").MSG_TYPE.AUDIO:return d("WAWebNewsletterGatingUtils").isNewsletterAudioFileReceivingEnabled();default:return b}}function a(a){var b=a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN?a.futureproofType:a.type;if(b==null)return!1;if(!j(b))return!1;return d("WAWebMsgGetters").getIsReply(a)&&!d("WAWebNewsletterGatingUtils").isNewsletterReceivingAdminRepliesEnabled()?!1:!0}g.isMsgTypeSupported=j;g.isMsgSupported=a}),98);
__d("WAWebParseForwardedNewsletterMessageInfo",["WALogger","WAWebChatEntryPoint","WAWebE2EProtoUtils","WAWebProtobufsE2E.pb","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Did not receive content type from newsletter annotation"]);h=function(){return a};return a}function a(a){var b=a.newsletterJid,c=a.newsletterName;a=a.serverMessageId;b=d("WAWebE2EProtoUtils").strictDecodeJid(b);return{newsletterId:b!=null?d("WAWebWidFactory").toNewsletterWid(b):void 0,newsletterName:c,serverMessageId:a}}function b(a){var b;b=a==null?void 0:(b=a.newsletter)==null?void 0:b.contentType;if(b==null){var c;d("WALogger").WARN(h()).tags("newsletter-logging").devConsole(a).sendLogs("Missing content type in newsletter annotation");return(a==null?void 0:(c=a.newsletter)==null?void 0:c.serverMessageId)==null?d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterLinkCard:d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterPostLinkCard}return b===d("WAWebProtobufsE2E.pb").ContextInfo$ForwardedNewsletterMessageInfo$ContentType.LINK_CARD?a.shouldSkipConfirmation===!0?d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterLinkCardButton:d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterLinkCard:d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterPostLinkCard}g.parseForwardedNewsletterMessageInfo=a;g.getChatEntryPointFromNewsletterLinkAnnotation=b}),98);
__d("WAWebGetEnumValuesFromConfig",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=a.config,c=a.enumCastFunction,d=new Set();return b.split(",").map(function(a){return Number.parseInt(a.trim(),10)}).filter(Number.isSafeInteger).map(function(a){if(d.has(a))return null;d.add(a);return c(a)}).filter(Boolean)}f.getEnumValuesFromConfig=a}),66);
__d("WAWebNewsletterDirectoryCategoryUtils",["$InternalEnum","WALogger","WAWebGetEnumValuesFromConfig"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Encountered unexpected category: ",""]);h=function(){return a};return a}var i=b("$InternalEnum")({Business:1,Entertainment:2,Lifestyle:3,News:4,Organizations:5,People:6,Sports:7,SpecialEvents:8,SpecialEvents2:9,SpecialEvents3:10,SpecialEvents4:11,SpecialEvents5:12});function a(a){switch(a){case"BUSINESS":return i.Business;case"ENTERTAINMENT":return i.Entertainment;case"LIFESTYLE":return i.Lifestyle;case"NEWS":return i.News;case"ORGANIZATIONS":return i.Organizations;case"PEOPLE":return i.People;case"SPORTS":return i.Sports;case"SPECIAL_EVENTS":return i.SpecialEvents;case"SPECIAL_EVENTS_2":return i.SpecialEvents2;case"SPECIAL_EVENTS_3":return i.SpecialEvents3;case"SPECIAL_EVENTS_4":return i.SpecialEvents4;case"SPECIAL_EVENTS_5":return i.SpecialEvents5;default:a;d("WALogger").WARN(h(),a).tags("newsletter-directory-category").sendLogs("Unexpected newsletter directory category");return i.Business}}function c(a){switch(a){case i.Business:return"BUSINESS";case i.Entertainment:return"ENTERTAINMENT";case i.Lifestyle:return"LIFESTYLE";case i.News:return"NEWS";case i.Organizations:return"ORGANIZATIONS";case i.People:return"PEOPLE";case i.Sports:return"SPORTS";case i.SpecialEvents:return"SPECIAL_EVENTS";case i.SpecialEvents2:return"SPECIAL_EVENTS_2";case i.SpecialEvents3:return"SPECIAL_EVENTS_3";case i.SpecialEvents4:return"SPECIAL_EVENTS_4";case i.SpecialEvents5:return"SPECIAL_EVENTS_5"}}function e(a){return d("WAWebGetEnumValuesFromConfig").getEnumValuesFromConfig({config:a,enumCastFunction:function(a){return i.cast(a)}})}g.NewsletterDirectoryCategoryType=i;g.getNewsletterDirectoryCategoryTypeFromValue=a;g.getCategoryValueFromEnum=c;g.getNewsletterDirectoryCategoryTypesFromConfig=e}),98);
__d("WAWebWamEnumChannelDirectoryPillSelected",[],(function(a,b,c,d,e,f){a=Object.freeze({RECOMMENDED:1,TRENDING:2,FEATURED:3,NEW:4,POPULAR:5});f.CHANNEL_DIRECTORY_PILL_SELECTED=a}),66);
__d("WAWebNewsletterDirectoryFilterUtils",["$InternalEnum","WAWebWamEnumChannelDirectoryPillSelected"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum")({Featured:"FEATURED",New:"NEW",Popular:"POPULAR",Recommended:"RECOMMENDED",Trending:"TRENDING"}),i=b("$InternalEnum")({Recommended:1,Trending:2,Featured:3,New:4,Popular:5,Country:6});function a(a){switch(a){case i.Recommended:case i.Country:return h.Recommended;case i.Trending:return h.Trending;case i.Featured:return h.Featured;case i.New:return h.New;case i.Popular:return h.Popular}}function c(a){switch(a){case h.Recommended:return i.Recommended;case h.Trending:return i.Trending;case h.Featured:return i.Featured;case h.New:return i.New;case h.Popular:return i.Popular}}function e(a){if(a==null)return void 0;switch(a){case h.Recommended:return d("WAWebWamEnumChannelDirectoryPillSelected").CHANNEL_DIRECTORY_PILL_SELECTED.RECOMMENDED;case h.New:return d("WAWebWamEnumChannelDirectoryPillSelected").CHANNEL_DIRECTORY_PILL_SELECTED.NEW;case h.Popular:return d("WAWebWamEnumChannelDirectoryPillSelected").CHANNEL_DIRECTORY_PILL_SELECTED.POPULAR;case h.Trending:return d("WAWebWamEnumChannelDirectoryPillSelected").CHANNEL_DIRECTORY_PILL_SELECTED.TRENDING;case h.Featured:return d("WAWebWamEnumChannelDirectoryPillSelected").CHANNEL_DIRECTORY_PILL_SELECTED.FEATURED}}g.NewsletterDirectoryListView=h;g.NewsletterDirectoryFilterType=i;g.getNewsletterDirectoryListViewFromFilter=a;g.getNewsletterDirectoryFilterFromListView=c;g.getNewsletterSelectedPill=e}),98);
__d("WAWebNewsletterMembershipUtil",["WAWebCommonNewsletterEnums"],(function(a,b,c,d,e,f,g){function a(a){return(a==null?void 0:a.membershipType)===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Subscriber}function b(a){return h(a)||i(a)}function h(a){return(a==null?void 0:a.membershipType)===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner}function i(a){return(a==null?void 0:a.membershipType)===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin}function c(a){return(a==null?void 0:a.membershipType)===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Guest}g.iAmSubscriber=a;g.iAmAdminOrOwner=b;g.iAmOwner=h;g.iAmAdmin=i;g.iAmGuest=c}),98);
__d("WAWebNewsletterGatingUtils",["$InternalEnum","WAWebABProps","WAWebCommonNewsletterEnums","WAWebGetEnumValuesFromConfig","WAWebLogNewsletterExposureAction","WAWebMobilePlatforms","WAWebMsgType","WAWebNewsletterDirectoryCategoryUtils","WAWebNewsletterDirectoryFilterUtils","WAWebNewsletterFutureProofUtils","WAWebNewsletterMembershipUtil","WAWebPrimaryFeatures","WAWebStateUtils","gkx"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum")({Disabled:0,NeedsUpgrade:1,Enabled:2}),i=b("$InternalEnum")({Disabled:0,NeedsUpgrade:1,Enabled:2,AvailableOnPhone:3}),j=b("$InternalEnum")({Disabled:0,EnabledAdminsOnly:1,EnabledAdminsAndFollowers:2,EnabledEveryone:3});function k(){return d("WAWebPrimaryFeatures").primaryFeatureEnabled("newsletter")||c("gkx")("26256")}function a(){var a=h.cast(d("WAWebABProps").getABPropConfigValue("channels_enabled"));if(a==null)return i.Disabled;if(!k())return i.Disabled;switch(a){case h.Disabled:return i.AvailableOnPhone;case h.Enabled:return i.Enabled;case h.NeedsUpgrade:return i.NeedsUpgrade}}function l(){return d("WAWebABProps").getABPropConfigValue("channels_enabled")===i.Enabled}function m(a){return l()&&d("WAWebABProps").getABPropConfigValue(a)===!0}var n=5e3;function e(){return n}function f(){return m("dsa_information_for_eu_only_enabled")}function o(){return m("dsa_channels_report_unlawful_content_enabled")}function p(a){var b=!1;if(a==null)return!1;switch(a){case d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner:case d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin:b=d("WAWebABProps").getABPropConfigValue("channel_view_counts_enabled")>=j.EnabledAdminsOnly;break;case d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Subscriber:b=d("WAWebABProps").getABPropConfigValue("channel_view_counts_enabled")>=j.EnabledAdminsAndFollowers;break;case d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Guest:b=d("WAWebABProps").getABPropConfigValue("channel_view_counts_enabled")===j.EnabledEveryone;break}return l()&&b}function q(){return m("channels_send_view_receipt_enabled")}function r(){return l()&&d("WAWebABProps").getABPropConfigValue("channels_creation_enabled")===i.Enabled}function s(){return m("channels_creation_logging_enabled")}function t(a){return((a=a.newsletterMetadata)==null?void 0:a.reactionCodesSetting)===d("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.All&&v()}function u(){return m("channel_reactions_enabled")&&d("WAWebNewsletterFutureProofUtils").isMsgTypeSupported(d("WAWebMsgType").MSG_TYPE.REACTION)}function v(){return m("channel_reactions_settings_enabled")}function w(a,b){return u()&&!b&&d("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(a==null?void 0:a.newsletterMetadata)&&d("WAWebABProps").getABPropConfigValue("channel_reactions_sender_list_enabled")}function x(){return d("WAWebMobilePlatforms").isSMB()?d("WAWebABProps").getABPropConfigValue("newsletter_tos_notice_id_smb_web"):d("WAWebABProps").getABPropConfigValue("newsletter_tos_notice_id")}function y(){return d("WAWebMobilePlatforms").isSMB()?d("WAWebABProps").getABPropConfigValue("newsletter_creation_tos_id_smb_web"):d("WAWebABProps").getABPropConfigValue("newsletter_creation_tos_id")}function z(){return d("WAWebMobilePlatforms").isSMB()?d("WAWebABProps").getABPropConfigValue("newsletter_admin_invite_tos_id_smb_web"):d("WAWebABProps").getABPropConfigValue("newsletter_admin_invite_tos_id")}function A(){return d("WAWebABProps").getABPropConfigValue("newsletter_creation_nux_id")}function B(){return!1}function C(){return l()&&d("WAWebABProps").getABPropConfigValue("channels_directory_enabled")===h.Enabled}function D(){return d("WAWebABProps").getABPropConfigValue("channels_directory_page_size")}function E(){return d("WAWebABProps").getABPropConfigValue("channels_directory_search_debounce_ms")}function F(){var a=d("WAWebABProps").getABPropConfigValue("channels_directory_v2_filter_types");return d("WAWebGetEnumValuesFromConfig").getEnumValuesFromConfig({config:a,enumCastFunction:function(a){return d("WAWebNewsletterDirectoryFilterUtils").NewsletterDirectoryFilterType.cast(a)}})}function G(){return m("channels_filter_out_subscribed_in_directory_null_state")}function H(){return d("WAWebABProps").getABPropConfigValue("channels_directory_v2_cache_refresh_interval_ms")}function I(){return m("channels_directory_categories_enabled")}function J(){return d("WAWebABProps").getABPropConfigValue("directory_categories_newsletters_per_category_limit")}function K(){return d("WAWebABProps").getABPropConfigValue("channels_directory_categories_cache_refresh_interval_ms")}function L(){var a=d("WAWebABProps").getABPropConfigValue("channels_directory_category_types");return d("WAWebGetEnumValuesFromConfig").getEnumValuesFromConfig({config:a,enumCastFunction:function(a){return d("WAWebNewsletterDirectoryCategoryUtils").NewsletterDirectoryCategoryType.cast(a)}})}function M(){return d("WAWebABProps").getABPropConfigValue("directory_categories_display_newsletters_per_category_limit")}function N(){return d("WAWebABProps").getABPropConfigValue("recommended_channels_background_refresh")}function O(){return d("WAWebABProps").getABPropConfigValue("channels_followers_list_cache_refresh_seconds")*1e3}function P(){return m("channel_forward_to_chat_enabled")}function Q(){return m("channels_forward_logging_v2_enabled")}function R(){return m("channel_to_channel_forwarding_logging_enabled")}function S(){return m("channel_forward_to_chat_v2_message_navigation_enabled")}function T(a){return a.isNewsletter()?U():V()}function U(){return m("channels_forward_to_channel_enabled")}function V(){return m("channels_forward_from_chat_to_channel_enabled")}function aa(){return m("channel_forward_bottom_button_enabled")}function ba(){return m("channels_message_edit_enabled")}function ca(){return m("channels_hide_news_url_preview")}function da(){return d("WAWebABProps").getABPropConfigValue("channels_max_messages_batch_pull")}function ea(){return d("WAWebABProps").getABPropConfigValue("channel_pull_message_updates_threshold_seconds")}function fa(){return m("channels_recommended_v3_ui_enabled")}function ga(){return d("WAWebABProps").getABPropConfigValue("channels_recommended_v3_ui_limit")}function ha(){return m("channels_share_link_logging_enabled")}function ia(a){return a===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner||a===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin}function ja(){return m("channels_send_album_enabled")}function ka(){return m("channels_inbox_filters_web_enabled")}function la(){return m("channels_proactive_message_gap_handling_enabled")}function W(){return m("channels_ptt_receiver_enabled")}function ma(){return W()&&d("WAWebABProps").getABPropConfigValue("channels_ptt_sender_enabled")}function na(){return m("channels_ptt_logging_enabled")}function oa(){return m("channels_poll_creation_enabled")}function pa(){return m("channels_poll_receive_enabled")}function qa(a){return!d("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(a==null?void 0:a.newsletterMetadata)?!1:X()}function X(){return m("channels_poll_voter_list_enabled")}function ra(){return m("channel_poll_forwarding_enabled")}function sa(){return m("channels_poll_single_option_control_enable")}function ta(){return m("channels_sticker_sending_enabled")}function ua(){return m("channels_sticker_receiving_enabled")}function va(){return m("channels_non_basic_stickers_enabled")}function wa(){return d("WAWebABProps").getABPropConfigValue("channels_multi_admin_max_admin_count")}function xa(){return m("channels_audio_files_receiver_enabled")}function ya(){return m("channels_audio_files_sender_enabled")}function za(){return m("channels_audio_files_sender_waveform_enabled")}function Aa(){return m("channels_audio_files_display_waveform_enabled")}function Ba(){return m("channels_status_updates_consumption_enabled")}function Ca(){return m("channels_admin_reply_enabled")}function Da(){return m("channels_admin_reply_receiver_enabled")}function Ea(){return m("similar_channels_in_thread_on_follow_enabled")}function Fa(){return m("similar_channels_in_channel_details_enabled")}function Ga(){return d("WAWebABProps").getABPropConfigValue("similar_channels_max_limit")}function Ha(){return d("WAWebABProps").getABPropConfigValue("similar_channels_min_limit")}function Ia(){return m("channels_qpl_logging")}function Ja(){return m("channels_reactions_bottomsheet_tap_to_react_enabled")}function Ka(a){a=d("WAWebStateUtils").unproxy(a);return((a=a.newsletterMetadata)==null?void 0:a.isSuspendedOrTerminated)?!1:m("channels_updates_tab_swipe_actions_enabled")}function La(a){if(a==null)return!1;if(a.isSuspendedOrTerminated)return!1;if(!c("gkx")("26258")&&d("WAWebABProps").getABPropConfigValue("channels_admin_insights_gizmos_enabled"))return!0;if(!d("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(a))return!1;if(m("channels_producer_insights_enabled"))return!0;Y()&&void d("WAWebLogNewsletterExposureAction").logNewsletterExposureAction(a,d("WAWebCommonNewsletterEnums").NewsletterCapability.Insights);return a.capabilities.has(d("WAWebCommonNewsletterEnums").NewsletterCapability.Insights)&&d("WAWebABProps").getABPropConfigValue("channels_capabilities_enabled")}function Ma(a){if(a==null)return!1;a=d("WAWebStateUtils").unproxy(a);a=a.size;return a>=d("WAWebABProps").getABPropConfigValue("channels_producer_insights_min_followers")}function Na(){return d("WAWebABProps").getABPropConfigValue("channels_producer_insights_hide_deltas")}function Y(){return m("channels_fetch_and_log_capabilities")}function Oa(){return m("hide_channel_tombstone_messages_enabled")}function Pa(){return m("channel_tombstone_messages_visibility_disabled")}function Z(){return d("WAWebABProps").getABPropConfigValue("whatsapp_vpv_logging_enabled")}function $(){return m("channels_vpv_logging_enabled")}function Qa(){return Z()&&$()}g.NewsletterCompanionGating=i;g.isNewsletterEnabledOnPrimary=k;g.getNewsletterDeeplinkGating=a;g.isNewsletterEnabled=l;g.getMaxSubscriberNumber=e;g.isDSAEUOnlyNoticeEnabled=f;g.isNewsletterReportUnlawfulContentEnabled=o;g.isNewsletterViewCountEnabled=p;g.isNewsletterViewCountSendEnabled=q;g.isNewsletterCreationEnabled=r;g.isNewsletterCreationLoggingEnabled=s;g.shouldShowAllReactionsForNewsletter=t;g.isNewsletterReactionEnabled=u;g.isNewsletterReactionSettingsEnabled=v;g.isNewsletterReactionSenderListEnabled=w;g.getNewsletterConsumerTos=x;g.getNewsletterProducerTos=y;g.getNewsletterAdminInviteTos=z;g.getNewsletterProducerNux=A;g.shouldHideProducerNewsletterDisclosure=B;g.isNewsletterDirectoryEnabled=C;g.getNewsletterDirectoryPageSize=D;g.getNewsletterDirectorySearchDebounce=E;g.getNewsletterDirectoryV2FilterTypes=F;g.isFilteringOutSubscribedNewslettersFromDirectoryListEnabled=G;g.getNewsletterDirectoryPageRefreshInterval=H;g.isNewsletterDirectoryCategoriesEnabled=I;g.getNewslettersPerDirectoryCategoryLimit=J;g.getNewsletterDirectoryCategoriesPreviewRefreshIntervalMs=K;g.getNewsletterDirectoryCategoryTypes=L;g.getDisplayNewsletterPerCategoryLimit=M;g.getRecommendedNewslettersRefreshInterval=N;g.getNewsletterSubscriberListCacheRefreshMs=O;g.isNewsletterMessageForwardSendingEnabled=P;g.isNewsletterMessageForwardLoggingEnabled=Q;g.isNewsletterForwardToChannelLoggingEnabled=R;g.isNavigationToForwardedNewsletterMessageEnabled=S;g.isForwardToNewsletterEnabled=T;g.isNewsletterForwardBottomButtonEnabled=aa;g.isNewsletterMessageEditingEnabled=ba;g.isNewsletterHideNewsUrlPreviewEnabled=ca;g.getMaxMsgCountFromServer=da;g.getPullMessageUpdatesThresholdSeconds=ea;g.isRecommendedUnitV3Enabled=fa;g.getRecommendedUnitRowCount=ga;g.isNewsletterLinkShareLoggingEnabled=ha;g.isNewsletterAdminContextCardEnabled=ia;g.isNewsletterMediaAlbumUploadEnabled=ja;g.isNewsletterInboxFiltersEnabled=ka;g.isProactiveGapFillingEnabled=la;g.isNewsletterPTTReceivingEnabled=W;g.isNewsletterPTTSendingEnabled=ma;g.isNewsletterPTTLoggingEnabled=na;g.isNewsletterPollsCreationEnabled=oa;g.isNewsletterPollsReceivingEnabled=pa;g.isNewsletterPollsVotersEnabledForChat=qa;g.isNewsletterPollsVotersEnabled=X;g.isNewsletterPollForwardingEnabled=ra;g.isNewsletterPollsSingleOptionEnabled=sa;g.isNewsletterStickerSendingEnabled=ta;g.isNewsletterStickerReceivingEnabled=ua;g.isNewsletterSendingNonBasicStickersEnabled=va;g.getMaxNumberOfAdmins=wa;g.isNewsletterAudioFileReceivingEnabled=xa;g.isNewsletterAudioFileSendingEnabled=ya;g.isAudioFileWaveformSenderEnabled=za;g.isAudioFileWaveformDisplayEnabled=Aa;g.isNewsletterLinksOnStatusConsumptionEnabled=Ba;g.isNewsletterSendingAdminRepliesEnabled=Ca;g.isNewsletterReceivingAdminRepliesEnabled=Da;g.isSimilarNewsletterInThreadEnabled=Ea;g.isSimilarNewsletterInInfoDrawersEnabled=Fa;g.getSimilarNewslettersMaxFetchLimit=Ga;g.getSimilarNewslettersMinDisplayLimit=Ha;g.isNewsletterQPLLoggingEnabled=Ia;g.isNewsletterQuickReactionsEnabled=Ja;g.isNewsletterContextMenuEnabled=Ka;g.isNewsletterProducerInsightsEnabled=La;g.canFetchProducerInsights=Ma;g.shouldHideProducerInsightsDeltas=Na;g.shouldFetchAndLogCapabilities=Y;g.isNewsletterTombstoneMessageHidingEnabled=Oa;g.shouldSetViewModeForNewsletterTombstone=Pa;g.isVPVLoggingEnabled=Z;g.isNewsletterVPVLoggingEnabled=$;g.isNewsletterDiscoveryVisibilityLoggingEnabled=Qa}),98);
__d("WAWebCreateViewModeProcessor",[],(function(a,b,c,d,e,f){function a(a){return babelHelpers["extends"]({},a)}function b(a){return babelHelpers["extends"]({},a,{messageVisibleInChat:function(){return!0},messageVisibleInChatlistPreview:function(){return!0},shouldShowInNotification:function(){return!0},shouldShowInSearch:function(){return!0}})}function c(a){return babelHelpers["extends"]({},a,{messageVisibleInChat:function(){return!1},messageVisibleInChatlistPreview:function(){return!1},shouldShowInNotification:function(){return!1},shouldShowInSearch:function(){return!1}})}f.createViewModeProcessor=a;f.createFullyVisibleViewModeProcessor=b;f.createFullyHiddenViewModeProcessor=c}),66);
__d("WAWebNewsletterTombstoneViewModeProcessor",["WAWebCreateViewModeProcessor","WAWebNewsletterGatingUtils","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){a=d("WAWebCreateViewModeProcessor").createViewModeProcessor({type:d("WAWebViewMode.flow").ViewModeType.NEWSLETTER_TOMBSTONE,messageVisibleInChat:function(){return!d("WAWebNewsletterGatingUtils").isNewsletterTombstoneMessageHidingEnabled()},messageVisibleInChatlistPreview:function(){return!d("WAWebNewsletterGatingUtils").isNewsletterTombstoneMessageHidingEnabled()},shouldShowInNotification:function(){return!1},shouldShowInSearch:function(){return!1}});b=a;g["default"]=b}),98);
__d("WAWebNewsletterErrors",["WACustomError"],(function(a,b,c,d,e,f,g){b=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}((a=d("WACustomError")).customError("UnexpectedNonNewsletterJidError"));c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(a.customError("UnexpectedNonNewsletterJidError"));e=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(a.customError("MissingNewsletterServerIdError"));f=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(a.customError("NewsletterMediaUploadError"));d=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(a.customError("UnexpectedNewsletterQuotedParticipantMismatchError"));g.UnexpectedNonNewsletterJidError=b;g.UnexpectedNonNewsletterChatError=c;g.MissingNewsletterServerIdError=e;g.NewsletterMediaUploadError=f;g.UnexpectedNewsletterQuotedParticipantMismatchError=d}),98);
__d("WAWebNewsletterValidationUtils",["WAJids","WALogger","WAWebNewsletterErrors"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose([""," is not a valid newsletter JID"]);h=function(){return a};return a}function a(a){i(a);return d("WAJids").toNewsletterJid(a)}function i(a){var b=d("WAJids").validateNewsletterJid(a)!=null;if(!b){d("WALogger").ERROR(h(),a);throw new(d("WAWebNewsletterErrors").UnexpectedNonNewsletterJidError)()}}g.toNewsletterJidOrThrow=a;g.validateNewsletterJidOrThrow=i}),98);
__d("WAWebLogNewsletterExposureAction",["WALogger","WAWebNewsletterLogExposureJob","WAWebNewsletterValidationUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][logNewsletterExposureAction] failed to log exposure"]);h=function(){return a};return a}function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{var c=d("WAWebNewsletterValidationUtils").toNewsletterJidOrThrow(a.id.toJid());return d("WAWebNewsletterLogExposureJob").logNewsletterExposure(c,b)}catch(c){d("WALogger").ERROR(h()).tags("newsletter").devConsole(c,a.id,b).sendLogs("log-newsletter-exposure-failed")}});return i.apply(this,arguments)}g.logNewsletterExposureAction=a}),98);
__d("WAWebDBProcessPaymentMessages",["WAWebDBMsgUtils","WAWebModelStorageUtils","WAWebMsgType","WAWebProtobufsWeb.pb","WAWebSchemaMessage","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=[],e=[],f=a.map(function(a){return a.paymentRequestMessageKey?a.paymentRequestMessageKey.toString():""}).filter(function(a){return a!==""}),g=a.filter(function(a){return a.subtype==="payment_action_request_declined"||a.subtype==="payment_transaction_request_cancelled"}).map(function(a){return a.id.toString()});return d("WAWebModelStorageUtils").getStorage().lock(["message"],function(){var h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b[0];b=(yield d("WAWebDBMsgUtils").getMsgsByMsgKey(f.concat(g)));var h=new Map();b.forEach(function(a){a!=null&&h.set(a.id.toString(),a)});a.forEach(function(a){var b;b=(b=a.paymentRequestMessageKey)==null?void 0:b.toString();var f=h.get(b||"");if(f&&b!=null)if(a.subtype==="send"&&a.paymentTxnStatus!=null)c.push({id:b,paymentTxnStatus:a.paymentTxnStatus});else{var g=f.from.isGroup()?f.author:f.from;g=f.paymentMessageReceiverJid.equals(d("WAWebUserPrefsMeUser").getMeUser())?g:f.paymentMessageReceiverJid;a.subtype==="payment_action_request_declined"?c.push({id:b,paymentStatus:d("WAWebProtobufsWeb.pb").PaymentInfo$Status.REJECTED,paymentTxnStatus:d("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.COLLECT_REJECTED}):a.subtype==="payment_transaction_request_cancelled"&&c.push({id:b,paymentStatus:d("WAWebProtobufsWeb.pb").PaymentInfo$Status.CANCELLED,paymentTxnStatus:d("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.COLLECT_CANCELED});c.push({id:a.id.toString(),type:d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE,templateParams:[g||"",f.paymentCurrency||"",String(f.paymentAmount1000)]})}else h.get(a.id.toString())&&!a.isMdHistoryMsg&&e.push(a.id.toString())});yield d("WAWebSchemaMessage").getMessageTable().bulkRemove(e);yield d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(c);return c});return function(a){return h.apply(this,arguments)}}())});return h.apply(this,arguments)}g.processPaymentMessages=a}),98);
__d("WAWebParseCancelPaymentMessageProto",["WAWebE2EProtoUtils","WAWebMsgKey","WAWebMsgType","WAWebUserPrefsMeUser","err"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.cancelPaymentRequestMessage;if(b==null)return;b=b.key;if(b==null)return;b=h(b,a);return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"payment_transaction_request_cancelled",paymentRequestMessageKey:b}),contextInfo:null}}function h(a,b){if(!a)throw c("err")("parseProtocolMessageProto: no message key is defined for cancel payment request message");var e=a.id;if(!e)throw c("err")("parseProtocolMessageProto: no message id is defined for cancel payment request message");var f=void 0;if(b.id.remote.isGroup()){f=b.id.participant;if(b.id.fromMe)f=d("WAWebE2EProtoUtils").decodeJid(b.from);else if(!((a=d("WAWebE2EProtoUtils").decodeJid(a.participant))==null?void 0:a.equals(d("WAWebUserPrefsMeUser").getMeUser())))return null}a=new(c("WAWebMsgKey"))({id:e,fromMe:b.id.fromMe,remote:b.id.remote,participant:f});return a}g["default"]=a}),98);
__d("WAWebParseDeclinePaymentMessageProto",["WAWebE2EProtoUtils","WAWebMsgKey","WAWebMsgType","WAWebUserPrefsMeUser","err"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.declinePaymentRequestMessage;if(b==null)return;b=h(b.key,a);return{msgData:babelHelpers["extends"]({},a,{type:"unknown",kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"payment_action_request_declined",paymentRequestMessageKey:b}),contextInfo:null}}function h(a,b){if(!a)throw c("err")("parseProtocolMessageProto: no message key is defined for decline payment request message");var e=a.id;if(!e)throw c("err")("parseProtocolMessageProto: no message id is defined for decline payment request message");var f;if(b.id.remote.isGroup()){var g;if(b.id.fromMe||((g=d("WAWebE2EProtoUtils").decodeJid(a.participant))==null?void 0:g.equals(d("WAWebUserPrefsMeUser").getMeUser()))||b.subtype==="send")f=d("WAWebE2EProtoUtils").decodeJid(a.participant);else return null}g=new(c("WAWebMsgKey"))({fromMe:!b.id.fromMe,remote:b.id.remote,id:e,participant:f});return g}g["default"]=a}),98);
__d("WAWebParseRequestPaymentMessageProto",["WALogger","WALongInt","WANullthrows","WAWebE2EProtoParser","WAWebE2EProtoUtils","WAWebMsgType","WAWebProtobufsWeb.pb"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseRequestPaymentMessageProto: does not support novi transactions"]);h=function(){return a};return a}function a(a){var b,e=a.messageProtobuf,f=a.baseMessage,g=a.paymentInfo;a=a.msgContext;e=e.requestPaymentMessage;if(e==null)return;b=(b=e.noteMessage)==null?void 0:(b=b.extendedTextMessage)==null?void 0:b.contextInfo;if((g==null?void 0:g.futureproofed)||d("WAWebE2EProtoUtils").hasUnsupportedCurrency(g)){d("WALogger").LOG(h());return{msgData:babelHelpers["extends"]({},f,{type:d("WAWebMsgType").MSG_TYPE.PAYMENT,kind:d("WAWebMsgType").MsgKind.Payment,subtype:"phone_only_feature"}),contextInfo:b}}var i=e.background,j=e.noteMessage,k=(j==null?void 0:j.extendedTextMessage)!=null||(j==null?void 0:j.conversation)!=null||(j==null?void 0:j.stickerMessage)!=null;j=j&&k?d("WAWebE2EProtoParser").parseMsgProto(j,{},a):void 0;a=g!=null?d("WAWebE2EProtoUtils").parseMsgPaymentInfo(g):{};if(e.amount==null)e.currencyCodeIso4217!=null&&a.paymentCurrency==null&&(a.paymentCurrency=e.currencyCodeIso4217),e.amount1000!=null&&a.paymentAmount1000==null&&(a.paymentAmount1000=d("WALongInt").numberOrThrowIfTooLarge(e.amount1000));else{e.amount.currencyCode!=null&&a.paymentCurrency==null&&(a.paymentCurrency=e.amount.currencyCode);if(e.amount.value!=null&&a.paymentAmount1000==null){g=e.amount;var l=g.offset==null||g.offset===0?1e3:g.offset;a.paymentAmount1000=parseFloat(g.value)*1e3/l}}e.requestFrom!=null&&(a==null?void 0:a.paymentMessageReceiverJid)==null&&(a.paymentMessageReceiverJid=d("WAWebE2EProtoUtils").decodeJid(e.requestFrom));((a==null?void 0:a.paymentStatus)==null||(a==null?void 0:a.paymentTxnStatus)==null)&&d("WAWebE2EProtoUtils").isEitherSenderOrReceiverOfPaymentMessage(f.id,c("WANullthrows")(a.paymentMessageReceiverJid))&&(a.paymentStatus=d("WAWebProtobufsWeb.pb").PaymentInfo$Status.WAITING,a.paymentTxnStatus=d("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.COLLECT_INIT);e.expiryTimestamp!=null&&(a==null?void 0:a.paymentExpiryTimestamp)==null&&(a.paymentExpiryTimestamp=d("WALongInt").numberOrThrowIfTooLarge(e.expiryTimestamp));return!k?{msgData:babelHelpers["extends"]({},f,{type:d("WAWebMsgType").MSG_TYPE.PAYMENT,kind:d("WAWebMsgType").MsgKind.Payment,subtype:"futureproof"},a,{paymentBackground:i}),contextInfo:b}:{msgData:babelHelpers["extends"]({},f,{type:d("WAWebMsgType").MSG_TYPE.PAYMENT,kind:d("WAWebMsgType").MsgKind.Payment,subtype:"request"},a,{paymentBackground:i,paymentNoteMsg:j}),contextInfo:b}}g["default"]=a}),98);
__d("WAWebParseSendPaymentMessageProto",["WALogger","WAWebE2EProtoParser","WAWebE2EProtoUtils","WAWebMsgKey","WAWebMsgType","WAWebUserPrefsMeUser","err"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["getPaymentRequestMessageKey: no message id is defined"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseSendPaymentMessageProto: does not support novi transactions"]);i=function(){return a};return a}function a(a){var b,c=a.messageProtobuf,e=a.baseMessage,f=a.paymentInfo;a=a.msgContext;c=c.sendPaymentMessage;if(c==null)return;b=(b=c.noteMessage)==null?void 0:(b=b.extendedTextMessage)==null?void 0:b.contextInfo;if((f==null?void 0:f.futureproofed)===!0||d("WAWebE2EProtoUtils").hasUnsupportedCurrency(f)){d("WALogger").LOG(i());return{msgData:babelHelpers["extends"]({},e,{type:"unknown",kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"phone_only_feature"}),contextInfo:b}}var g=c.background,h=c.noteMessage;c=c.requestMessageKey;var k=(h==null?void 0:h.extendedTextMessage)!=null||(h==null?void 0:h.conversation)!=null||(h==null?void 0:h.stickerMessage)!=null,l=k?"send":"futureproof";h=h&&k?d("WAWebE2EProtoParser").parseMsgProto(h,{},a):void 0;a=f!=null?d("WAWebE2EProtoUtils").parseMsgPaymentInfo(f):null;f=c?j(c,e.id,l):null;return!k?{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.PAYMENT,kind:d("WAWebMsgType").MsgKind.Payment,subtype:"futureproof"},a,{paymentBackground:g,paymentRequestMessageKey:f}),contextInfo:b}:{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.PAYMENT,kind:d("WAWebMsgType").MsgKind.Payment,subtype:"send"},a,{paymentBackground:g,paymentRequestMessageKey:f,paymentNoteMsg:h}),contextInfo:b}}function j(a,b,e){if(!a)throw c("err")("getPaymentRequestMessageKey: no message key is defined");var f=a.id;if(!f)throw c("err")("getPaymentRequestMessageKey: no key id is defined");if(!b){d("WALogger").WARN(h());return null}var g;if(b.remote.isGroup()){var i;if(b.fromMe||((i=d("WAWebE2EProtoUtils").decodeJid(a.participant))==null?void 0:i.equals(d("WAWebUserPrefsMeUser").getMeUser()))||e==="send")g=d("WAWebE2EProtoUtils").decodeJid(a.participant);else return null}i=new(c("WAWebMsgKey"))({fromMe:!b.fromMe,remote:b.remote,id:f,participant:g});return i}g["default"]=a}),98);
__d("WAWebPinAddonMessageProcessor",["Promise","WAArrayGroupBy","WANullthrows","WATimeUtils","WAWebAddonConstants","WAWebAddonCreateMsgProcessor","WAWebBackendApi","WAWebDBMarkFutureproofMessagesReparsed","WAWebDBProcessMessage","WAWebMsgGetters","WAWebMsgType","WAWebPinMessageProcessor","WAWebPinMsgGatingUtils","WAWebPinMsgParseWebMsgInfoPinInChat","WAWebPinsDbSerialization","WAWebProtobufsE2E.pb","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=60*d("WATimeUtils").DAY_SECONDS;a=d("WAWebAddonCreateMsgProcessor").createAddonMsgProcessor({isEnabled:function(){return d("WAWebPinMsgGatingUtils").isPinnedMessagesM1ReceiverEnabled()},convert:{fromHistorySyncMsg:function(a){a=d("WAWebPinMsgParseWebMsgInfoPinInChat").parseWebMsgInfoPinInChat(a.webMsgInfo,a.parsedWebMsgInfo);a=a.map(function(a){return d("WAWebPinsDbSerialization").deserializePinInChatMsgData(d("WAWebPinsDbSerialization").serializePinInChat(a))});return(h||(h=b("Promise"))).resolve(a)}},updateCollection:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.add;yield d("WAWebBackendApi").frontendSendAndReceive("updatePinCollection",{msgs:b,removeMsgs:a.remove})});function c(b){return a.apply(this,arguments)}return c}(),beforeUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=b.processMode,e=b.parents;return a.filter(function(a){var b;b=(b=a.pinExpiryDuration)!=null?b:0;if(c!==d("WAWebAddonConstants").AddonProcessMode.HistorySync){a=e.getForAddon(a);if(a.type===d("WAWebMsgType").MSG_TYPE.EVENT_CREATION)return!0}return b<=i})});function c(b,c){return a.apply(this,arguments)}return c}(),afterUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){e=e.processMode;if(e===d("WAWebAddonConstants").AddonProcessMode.HistorySync)return;e=d("WAArrayGroupBy").groupBy(a,function(a){return a.id.remote.toString()});a=[d("WAWebDBMarkFutureproofMessagesReparsed").markFutureproofMessagesReparsed(a.map(function(a){return a.id.toString()}))].concat(e.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a[0];a=a[1];var f=d("WAWebWidFactory").createWid(e);e=(yield (h||(h=b("Promise"))).all(a.map(function(a){var b=d("WAWebMsgGetters").getT(a);if(a.pinMessageType!==d("WAWebProtobufsE2E.pb").Message$PinInChatMessage$Type.PIN_FOR_ALL||b==null||d("WAWebMsgGetters").getIsFailed(a))return;return d("WAWebPinMessageProcessor").genSystemMessage(f,b,c("WANullthrows")(d("WAWebMsgGetters").getSender(a)))}).filter(Boolean)));a=(yield d("WAWebBackendApi").frontendSendAndReceive("processMultipleMessages",{chatId:f,msgObjs:e,meta:{add:"after",isHistory:!1},processMessagesOrigin:"pinMessage"}));a&&(yield d("WAWebDBProcessMessage").storeMessages(e,f))});return function(b){return a.apply(this,arguments)}}()));yield (h||(h=b("Promise"))).all(a)});function e(b,c){return a.apply(this,arguments)}return e}(),manageNotifications:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){});function c(){return a.apply(this,arguments)}return c}()});e=a;g["default"]=e}),98);
__d("WAWebPinMsgConstants",["$InternalEnum","WATimeUtils","err"],(function(a,b,c,d,e,f,g){f={INVALID:0,PIN:1,UNPIN:2};var h=b("$InternalEnum").Mirrored(["FiveSeconds","FifteenSeconds","OneMinute","OneDay","SevenDays","ThirtyDays"]);b=h.SevenDays;function a(a){switch(a){case h.FiveSeconds:return 5;case h.FifteenSeconds:return 15;case h.OneMinute:return d("WATimeUtils").MINUTE_SECONDS;case h.OneDay:return d("WATimeUtils").DAY_SECONDS;case h.SevenDays:return 7*d("WATimeUtils").DAY_SECONDS;case h.ThirtyDays:return 30*d("WATimeUtils").DAY_SECONDS}}function e(a){switch(a){case 5:return h.FiveSeconds;case 15:return h.FifteenSeconds;case d("WATimeUtils").MINUTE_SECONDS:return h.OneMinute;case d("WATimeUtils").DAY_SECONDS:return h.OneDay;case 7*d("WATimeUtils").DAY_SECONDS:return h.SevenDays;case 30*d("WATimeUtils").DAY_SECONDS:return h.ThirtyDays;default:throw c("err")("Unexpeded pin expiry duration")}}g.PIN_STATE=f;g.PinExpiryDurationOption=h;g.DEFAULT_PIN_EXPIRY_DURATION_OPTION=b;g.getPinExpiryDuration=a;g.getPinExpiryOption=e}),98);
__d("WAWebDBCRUDOperationsPinInChat",["WAWebModelStorageUtils","WAWebPinInChatSchema","WAWebPinMsgConstants","WAWebPinMsgGatingUtils","WAWebPinsDbSerialization","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e=new Map();c.forEach(function(a){var b=a.parentMsgKey;b=b;var c=e.get(b);(!c||(c==null?void 0:c.senderTimestampMs)<=a.senderTimestampMs)&&e.set(b,a)});return d("WAWebModelStorageUtils").getStorage().lock(["pinned-messages"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var c=(yield b.anyOf(["chatId"],[a.toString()]));c.forEach(function(a){var b=a.parentMsgKey,c=e.get(b);c&&(c.senderTimestampMs<=a.senderTimestampMs&&e["delete"](b))});var f=new Map(c.map(function(a){return[a.parentMsgKey,a]}));e.forEach(function(a,b){f.set(b,a)});c=Array.from(f.values());c=c.filter(function(a){return a.pinType===d("WAWebPinMsgConstants").PIN_STATE.PIN}).sort(function(a,b){return b.senderTimestampMs-a.senderTimestampMs}).slice(d("WAWebPinMsgGatingUtils").getMaxPins());c.forEach(function(a){e.set(a.parentMsgKey,babelHelpers["extends"]({},a,{pinType:d("WAWebPinMsgConstants").PIN_STATE.UNPIN}))});c=Array.from(e.values());yield b.bulkCreateOrReplace(c);return c});return function(a){return c.apply(this,arguments)}}())}function c(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebPinInChatSchema").getTable().get(a.toString()));return a==null?null:d("WAWebPinsDbSerialization").deserializePinInChat(a)});return h.apply(this,arguments)}g.createOrUpdatePinInChat=a;g.getPinInChatByParentKey=c}),98);
__d("WAWebPinMessageProcessor",["Promise","WANullthrows","WAWebBackendApi","WAWebDBCRUDOperationsPinInChat","WAWebDBMarkFutureproofMessagesReparsed","WAWebDBMsgUtils","WAWebDBProcessMessage","WAWebDBStoreMessageOrphans","WAWebMsgGetters","WAWebMsgKey","WAWebMsgType","WAWebPinsDbSerialization","WAWebProtobufsE2E.pb","WAWebUserPrefsMeUser","WAWebViewMode.flow","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(function(a){return a.pinParentKey}).filter(Boolean).map(function(a){return a.toString()});a=(yield d("WAWebDBMsgUtils").getMsgsByMsgKey(a));a=new Map(a.map(function(a){return[a.id.toString(),a]}));return a});return j.apply(this,arguments)}function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebDBStoreMessageOrphans").storeMessageOrphans(a,function(a){return c("WANullthrows")(a.pinParentKey)})});return l.apply(this,arguments)}function a(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=(yield i(e)),g=[],j=[];for(e of e){var l=f.get(c("WANullthrows")(e.pinParentKey).toString());!l?g.push(e):j.push(e)}yield (h||(h=b("Promise"))).all([b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(g.length===0)return;yield k(g);yield d("WAWebDBMarkFutureproofMessagesReparsed").markFutureproofMessagesReparsed(g.map(function(a){return a.id.toString()}))})(),b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(j.length===0)return;var e=(yield d("WAWebBackendApi").frontendSendAndReceive("updatePinCollection",{msgs:j,removeMsgs:[]}));e&&(yield d("WAWebDBCRUDOperationsPinInChat").createOrUpdatePinInChat(a,e.map(function(a){return d("WAWebPinsDbSerialization").serializePinInChat(a)})),yield d("WAWebDBMarkFutureproofMessagesReparsed").markFutureproofMessagesReparsed(e.map(function(a){return a.msgKey.toString()})));e=(yield (h||(h=b("Promise"))).all(j.map(function(b){return b.pinMessageType===d("WAWebProtobufsE2E.pb").Message$PinInChatMessage$Type.PIN_FOR_ALL?n(a,c("WANullthrows")(b.t),c("WANullthrows")(d("WAWebMsgGetters").getSender(b))):null}).filter(Boolean)));var f=(yield d("WAWebBackendApi").frontendSendAndReceive("processMultipleMessages",{chatId:a,msgObjs:e,meta:{add:"after",isHistory:!1},processMessagesOrigin:"pinMessage"}));f&&(yield d("WAWebDBProcessMessage").storeMessages(e,a))})()])});return m.apply(this,arguments)}function n(a,b,c){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=d("WAWebUserPrefsMeUser").getMeUser(),g=e.equals(f);return{id:new(c("WAWebMsgKey"))({id:yield c("WAWebMsgKey").newId(),fromMe:g,remote:a,participant:e}),author:e,from:a,to:f,recipients:[],t:b,type:d("WAWebMsgType").MSG_TYPE.PINNED_MESSAGE,kind:d("WAWebMsgType").MsgKind.PinnedMessage,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,templateParams:[e]}});return o.apply(this,arguments)}g.processPinMessages=a;g.genSystemMessage=n}),98);
__d("WAWebPinsDbSerialization",["WANullthrows","WAWebAddonConstants","WAWebAddonDBSerializationUtils","WAWebMsgGetters","WAWebMsgKey","WAWebMsgKeyUtils","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebViewMode.flow","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){return babelHelpers["extends"]({},a,{msgKey:a.msgKey.toString(),parentMsgKey:a.parentMsgKey.toString(),chatId:a.chatId.toString(),sender:a.sender.toString()})}function b(a){return babelHelpers["extends"]({},a,{msgKey:c("WAWebMsgKey").fromString(a.msgKey),parentMsgKey:c("WAWebMsgKey").fromString(a.parentMsgKey),chatId:d("WAWebWidFactory").toChatWid(d("WAWebWidFactory").createWid(a.chatId)),sender:d("WAWebWidFactory").createUserWid(a.sender)})}function e(a){var b=d("WAWebWidFactory").toUserWid(c("WANullthrows")(d("WAWebMsgGetters").getSender(a))).toString();return{msgKey:a.id.toString(),ack:a.ack,t:a.t,read:a.read,parentMsgKey:a.pinParentKey.toString(),senderTimestampMs:a.pinSenderTimestampMs,chatId:a.id.remote.toString(),sender:b,pinType:a.pinMessageType,pinExpiryDuration:a.pinExpiryDuration}}function f(a){var b=d("WAWebAddonDBSerializationUtils").extractAddonForUnifiedTable(a),c=b.base;b=b.addonProps;return babelHelpers["extends"]({},c,{rowType:d("WAWebAddonConstants").AddonMinimizedType.PinInChat,arbitraryIndex:a.id.remote.toString(),addonProps:b})}function h(a){var b=c("WAWebMsgKey").fromString(a.msgKey),e=a.addonProps;return babelHelpers["extends"]({id:b},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(b,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{type:d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE,kind:d("WAWebMsgType").MsgKind.PinInChat,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,ack:a.ack,t:a.t,read:a.read,pinParentKey:c("WAWebMsgKey").fromString(a.targetMsgKey),pinSenderTimestampMs:e.pinSenderTimestampMs,pinMessageType:(b=d("WAWebProtobufsE2E.pb").Message$PinInChatMessage$Type.cast(e.pinMessageType))!=null?b:d("WAWebProtobufsE2E.pb").Message$PinInChatMessage$Type.UNKNOWN_TYPE,pinExpiryDuration:e.pinExpiryDuration})}function i(a){var b=c("WAWebMsgKey").fromString(a.msgKey);b=d("WAWebMsgKeyUtils").msgKeyToTargetInfo(b,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon);var e=b.from,f=b.to;b=b.author;return{id:c("WAWebMsgKey").fromString(a.msgKey),from:e,to:f,author:b,type:d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE,kind:d("WAWebMsgType").MsgKind.PinInChat,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,ack:a.ack,t:a.t,read:a.read,pinSenderTimestampMs:a.senderTimestampMs,pinParentKey:c("WAWebMsgKey").fromString(a.parentMsgKey),pinMessageType:(e=d("WAWebProtobufsE2E.pb").Message$PinInChatMessage$Type.cast(a.pinType))!=null?e:d("WAWebProtobufsE2E.pb").Message$PinInChatMessage$Type.UNKNOWN_TYPE,pinExpiryDuration:a.pinExpiryDuration}}g.serializePinInChat=a;g.deserializePinInChat=b;g.serializePinInChatMsgData=e;g.pinInChatMsgDatIntoUnifiedAddonRow=f;g.unifiedAddonRowIntoPinInChatMsgData=h;g.deserializePinInChatMsgData=i}),98);
__d("WAWebPinMsgParseWebMsgInfoPinInChat",["WALogger","WALongInt","WANullthrows","WAWebAddOnParseWebMsgInfo","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[history sync] parseWebMsgInfoPinInChat failed with error "," and stack ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseWebMsgInfoPinInChat: pinInChat sender should be a wid."]);i=function(){return a};return a}function a(a,b){var e=[];try{if(a==null||a.pinInChat==null)return e;if(b==null||b.pinInChat==null)return e;a=b.pinInChat;var f=a.key,g=a.type,j=a.senderTimestampMs,k=a.serverTimestampMs;a=a.messageAddOnContextInfo;f=c("WANullthrows")(d("WAWebAddOnParseWebMsgInfo").buildAddonMsgKey(c("WANullthrows")(f)));var l=f.msgKey;f=f.sender;if(f==null)d("WALogger").ERROR(i());else{e.push({msgKey:l,parentMsgKey:b.id,chatId:d("WAWebWidFactory").toChatWid(l.remote),senderTimestampMs:d("WALongInt").numberOrThrowIfTooLarge(c("WANullthrows")(j)),t:(b=d("WAWebAddOnParseWebMsgInfo").getAddonServerTimestamp(k))!=null?b:void 0,pinType:c("WANullthrows")(g),sender:f,pinExpiryDuration:a==null?void 0:a.messageAddOnDurationInSecs})}}catch(a){d("WALogger").ERROR(h(),a==null?void 0:a.name,a==null?void 0:a.stack)}return e}g.parseWebMsgInfoPinInChat=a}),98);
__d("WAWebPinInChatValidationError",["$InternalEnum","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({INVALID_PIN_IN_CHAT_EXPIRY_DURATION:"pin_in_chat_invalid_expiry_duration",INVALID_PIN_IN_CHAT_MSG_REMOTE:"pin_in_chat_invalid_msg_remote",MISSING_PARENT_MSG_KEY:"pin_in_chat_missing_parent_msg_key",MISSING_TYPE:"pin_in_chat_missing_type",MISSING_SENDER_TIMESTAMP:"pin_in_chat_missing_timestamp"});c=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="PinInChatValidationError",b)||babelHelpers.assertThisInitialized(c)}return b}(d("WAWebHandleMsgError").MessageValidationError);g.PinInChatValidationErrorCode=a;g.PinInChatValidationError=c}),98);
__d("WAWebParsePinMessageProto",["WALongInt","WAWebE2EProtoUtils","WAWebMsgType","WAWebPinInChatValidationError","WAWebPinMsgGatingUtils","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;var c=b.pinInChatMessage;if(c==null)return;if(!d("WAWebPinMsgGatingUtils").isPinnedMessagesM1ReceiverEnabled())return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,futureproofType:d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE}),contextInfo:null};var e=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(c.key,a);if(e==null)throw new(d("WAWebPinInChatValidationError").PinInChatValidationError)(d("WAWebPinInChatValidationError").PinInChatValidationErrorCode.MISSING_PARENT_MSG_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a.id.remote.toString()!==e.remote.toString()&&!e.remote.isBroadcast())throw new(d("WAWebPinInChatValidationError").PinInChatValidationError)(d("WAWebPinInChatValidationError").PinInChatValidationErrorCode.INVALID_PIN_IN_CHAT_MSG_REMOTE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);b=(b=b.messageContextInfo)==null?void 0:b.messageAddOnDurationInSecs;if(b!=null&&b<0)throw new(d("WAWebPinInChatValidationError").PinInChatValidationError)(d("WAWebPinInChatValidationError").PinInChatValidationErrorCode.INVALID_PIN_IN_CHAT_EXPIRY_DURATION,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);var f=c.type;if(f==null)throw new(d("WAWebPinInChatValidationError").PinInChatValidationError)(d("WAWebPinInChatValidationError").PinInChatValidationErrorCode.MISSING_TYPE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);c=d("WALongInt").maybeNumberOrThrowIfTooLarge(c.senderTimestampMs);if(c==null)throw new(d("WAWebPinInChatValidationError").PinInChatValidationError)(d("WAWebPinInChatValidationError").PinInChatValidationErrorCode.MISSING_SENDER_TIMESTAMP,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);a=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE,kind:d("WAWebMsgType").MsgKind.PinInChat,pinParentKey:e,pinMessageType:f,pinSenderTimestampMs:c,pinExpiryDuration:b});return{msgData:a,contextInfo:null}}g["default"]=a}),98);
__d("WAWebPollVoteAddonMessageProcessor",["Promise","WALogger","WAWebABProps","WAWebAddonConstants","WAWebAddonCreateMsgProcessor","WAWebAddonInfraError","WAWebAddonLogUtils","WAWebBackendApi","WAWebDBMarkFutureproofMessagesReparsed","WAWebLastAddOnDBSerialization","WAWebMsgType","WAWebPollVoteEncryptMsgData","WAWebPollsExtractVotes","WAWebPollsParseWebMsgInfoPollUpdates","WAWebPollsVoteDataUtils","WAWebShouldUpdateLastAddOnPreview","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[pollVoteMsgProcessor] Failed to decrypt poll vote message"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot decrypt poll vote message: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[pollVoteMsgProcessor] Decrypting poll vote message"]);k=function(){return a};return a}var l=d("WAWebAddonCreateMsgProcessor").createAddonMsgProcessorDualEncrypted({isEnabled:function(){return d("WAWebABProps").getABPropConfigValue("unified_poll_vote_addon_infra_enabled")},convert:{fromHistorySyncMsg:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebPollsParseWebMsgInfoPollUpdates").parseWebMsgInfoPollUpdates(a).then(function(a){return a.map(d("WAWebPollsVoteDataUtils").voteDataToPollVoteMsgData)})});function c(b){return a.apply(this,arguments)}return c}(),toDualEncryptedMsgData:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return a.kind===d("WAWebMsgType").MsgKind.PollVoteEncrypted?a:d("WAWebPollVoteEncryptMsgData").encryptPollVoteMsgData(a,b)});function c(b,c){return a.apply(this,arguments)}return c}(),toDualDecryptedMsgData:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return a.kind===d("WAWebMsgType").MsgKind.PollVoteDecrypted?a:d("WAWebPollsExtractVotes").extractVote(a,b).then(d("WAWebPollsVoteDataUtils").voteDataToPollVoteMsgData)});function c(b,c){return a.apply(this,arguments)}return c}()},updateCollection:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return d("WAWebBackendApi").frontendSendAndReceive("upsertVotesModelCollection",{votes:a.add.map(d("WAWebPollsVoteDataUtils").pollVoteMsgDataToVoteData),votesToRemove:a.remove,restoredFromDb:b===d("WAWebAddonConstants").AddonProcessMode.Hydration||b===d("WAWebAddonConstants").AddonProcessMode.HistorySync})});function c(b,c){return a.apply(this,arguments)}return c}(),beforeUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){c=c.parents;var e=[],f=[];for(a of a)if(a.addonEncrypted){var g=c.getForAddon(a);if(g==null)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.MissingParentMsg);f.push(l.convert.toDualDecryptedMsgData(a,g));d("WALogger").LOG(k()).sendLogs("unexpected encrypted poll vote",{sampling:.01})}else e.push(a);if(f.length!==0){g=(yield (h||(h=b("Promise"))).allSettled(f));for(c of g)c.status==="fulfilled"&&c.value.kind===d("WAWebMsgType").MsgKind.PollVoteDecrypted?e.push(c.value):d("WALogger").LOG(j(),c.reason);d("WAWebAddonLogUtils").hasSettledWithError(g)&&d("WALogger").ERROR(i()).tags("messagings","addons").sendLogs("poll-vote-decryption-error",{sampling:.01})}return e});function c(b,c){return a.apply(this,arguments)}return c}(),afterUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b.processMode;yield d("WAWebShouldUpdateLastAddOnPreview").filterAndUpdateChatPreviews(a.map(function(a){return d("WAWebLastAddOnDBSerialization").lastAddOnPreviewCandidateFromVoteData(d("WAWebPollsVoteDataUtils").pollVoteMsgDataToVoteData(a),!1)}));if(b===d("WAWebAddonConstants").AddonProcessMode.HistorySync)return;b===d("WAWebAddonConstants").AddonProcessMode.OnlineReceive&&(yield d("WAWebDBMarkFutureproofMessagesReparsed").markFutureproofMessagesReparsed(a.map(function(a){return a.id.toString()})))});function c(b,c){return a.apply(this,arguments)}return c}(),manageNotifications:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){});function c(){return a.apply(this,arguments)}return c}()});a=l;g["default"]=a}),98);
__d("WAWebPollsCreateOptionLocalIdMap",["Promise","WAHex","WANullthrows","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield (h||(h=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield j(a)),c=d("WAHex").toHex(new Uint8Array(b));return{hash:b,hexHash:c,localId:a.localId}});return function(b){return a.apply(this,arguments)}}())));var e=new Map(),f=new Map();for(a of a){var g=a.hash,i=a.hexHash,k=a.localId;e.set(i,k);f.set(k,g)}return{getLocalIdForHexHash:function(a){return c("WANullthrows")(e.get(a))},getLocalIdForHash:function(a){return c("WANullthrows")(e.get(d("WAHex").toHex(new Uint8Array(a))))},getHashForLocalId:function(a){return c("WANullthrows")(f.get(a))},includesHashes:function(a){return a.every(function(a){return e.has(d("WAHex").toHex(new Uint8Array(a)))})}}});return i.apply(this,arguments)}function j(a){return self.crypto.subtle.digest("SHA-256",new TextEncoder().encode(a.name))}g.createOptionLocalIdMap=a}),98);
__d("WAWebPollsProtobufConversion",["WALongInt","WANullthrows","WAWebPollsCreateOptionLocalIdMap","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("WAWebPollsCreateOptionLocalIdMap").createOptionLocalIdMap(b));a=a.selectedOptionLocalIds.map(b.getHashForLocalId);return{selectedOptions:a.length===0?null:a}});return h.apply(this,arguments)}function e(a){var b=a.voteProtobuf,e=a.pollVoteMsgKey,f=a.parentMsgKey,g=a.sender,h=a.senderTimestampMs,i=a.t,j=a.optionLocalIdMap,k=a.ack;a=a.read;return{msgKey:e,parentMsgKey:c("WANullthrows")(f),selectedOptionLocalIds:b.selectedOptions.map(j.getLocalIdForHash),senderTimestampMs:d("WALongInt").numberOrThrowIfTooLarge(h),t:d("WALongInt").maybeNumberOrThrowIfTooLarge(i),sender:g,ack:k,read:a}}g.protobufFromVote=a;g.voteFromProtobuf=e}),98);
__d("WAWebPollsVoteEncryption",["WAWebAddonEncryption","WAWebApiContact","WAWebLidMigrationUtils","WAWebMsgType","WAWebPnhGatingUtils","WAWebProtobufsE2E.pb","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){function a(a){return i(a)["catch"](function(b){if(d("WAWebPnhGatingUtils").isMatFullyEnabled()&&a.pollCreationOriginalSender.isUser()){var c=d("WAWebApiContact").getAlternateUserWid(a.pollCreationOriginalSender);if(c!=null)return i(babelHelpers["extends"]({},a,{pollCreationOriginalSender:d("WAWebWidFactory").toUserWid(c)}))}else if(a.isOneOnOne){c=h(a.pollCreationOriginalSender,a.voteSender);var e=c.alignedPollCreator;c=c.alignedVoteSender;if(e!=null&&c!=null)return i(babelHelpers["extends"]({},a,{pollCreationOriginalSender:e,voteSender:c}))}throw b})}function c(a){var b={type:d("WAWebMsgType").MsgKind.PollVoteDecrypted,encode:a.encodedProtobuf};if(a.isOneOnOne){var c=h(a.pollCreationOriginalSender,a.voteSender),e=c.alignedPollCreator;c=c.alignedVoteSender;e!=null&&c!=null&&(a.pollCreationOriginalSender=e,a.voteSender=c)}return d("WAWebAddonEncryption").encryptAddOn(b,{messageSecret:a.messageSecret,iv:a.iv,stanzaId:a.stanzaId,originalMessageSender:a.pollCreationOriginalSender,addOnSender:a.voteSender})}function h(a,b){a=d("WAWebLidMigrationUtils").toCommonAddressingMode(a,b);b=a[0];a=a[1];return{alignedVoteSender:a!=null?d("WAWebWidFactory").toUserWid(a):null,alignedPollCreator:b!=null?d("WAWebWidFactory").toUserWid(b):null}}function i(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b={type:d("WAWebMsgType").MsgKind.PollVoteEncrypted,encryptedAddOn:a.encryptedVote};b=(yield d("WAWebAddonEncryption").decryptAddOn(b,{messageSecret:a.messageSecret,iv:a.iv,stanzaId:a.stanzaId,originalMessageSender:a.pollCreationOriginalSender,addOnSender:a.voteSender}));return d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsE2E.pb").Message$PollVoteMessageSpec,b)});return j.apply(this,arguments)}g.decryptVote=a;g.encryptVote=c}),98);
__d("WAWebPollVoteEncryptMsgData",["WANullthrows","WAWebAck","WAWebMsgGetters","WAWebMsgKeyUtils","WAWebMsgType","WAWebPollsProtobufConversion","WAWebPollsVoteEncryption","WAWebViewMode.flow","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e,f,g=(f=c("WANullthrows"))((e=d("WAWebMsgGetters")).getPollOptions(b)),h=f(e.getMessageSecret(b),"Poll creation missing message secret"),i=f(e.getOriginalSender(b)),j=self.crypto.getRandomValues(new Uint8Array(12));g=(yield d("WAWebPollsVoteEncryption").encryptVote({encodedProtobuf:yield d("WAWebPollsProtobufConversion").protobufFromVote(a,g),iv:j,messageSecret:h,pollCreationOriginalSender:i,stanzaId:b.id.id,voteSender:d("WAWebWidFactory").toUserWid(f(e.getSender(a))),isOneOnOne:e.getRemote(b).isUser()}));return babelHelpers["extends"]({id:a.id,type:d("WAWebMsgType").MSG_TYPE.POLL_UPDATE,kind:d("WAWebMsgType").MsgKind.PollVoteEncrypted,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:"poll_vote",addonEncrypted:!0,t:Math.floor(a.senderTimestampMs/1e3)},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(a.id,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{isNewMsg:!0,local:!0,ack:(h=a.ack)!=null?h:d("WAWebAck").ACK.CLOCK,pollUpdateParentKey:b.id,encPollVote:{encPayload:g,encIv:j.buffer},senderTimestampMs:a.senderTimestampMs})});return h.apply(this,arguments)}g.encryptPollVoteMsgData=a}),98);
__d("WAWebDBPollsDeleteVotes",["Promise","WAWebDBMessageDelete","WAWebPollsVotesSchema","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebPollsVotesSchema").getTable().anyOf(["parentMsgKey"],a));if(a.length===0)return;var c=a.map(function(a){return a.msgKey});a=a.map(function(a){return[a.parentMsgKey,a.sender]});c=(yield (h||(h=b("Promise"))).allSettled([d("WAWebDBMessageDelete").removeMessagesFromHistory(c,{deleteAssociatedMsgs:!1}),d("WAWebPollsVotesSchema").getTable().bulkRemove(a)]));for(a of c)if(a.status==="rejected")throw a.reason});return i.apply(this,arguments)}g.deleteVotesByParentMsgKeys=a}),98);
__d("WAWebDBPollsGetParentMessages",["WANullthrows","WAWebAddonProcessMsgsUtils","WAWebMsgType","WAWebPnhGatingUtils","WAWebProcessMatMessages","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Set(a.map(i)),c=d("WAWebProcessMatMessages").getAlternateWidMapForPolls(a),e=c.matParentMsgKeys;c=c.alternateWidMap;e.forEach(function(a){b.add(a)});e=(yield d("WAWebAddonProcessMsgsUtils").queryAddonParentMsgs(a,null));a=e[0];e=e[1];var f=new Map(),g=[];for(e of e){var h=a.get(i(e));if(h==null&&d("WAWebPnhGatingUtils").isMatFullyEnabled()){var j=c.get(i(e));j!=null&&(h=a.get(j.id.toString()))}h==null||h.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN?g.push(e):f.set(e,h)}return{pollUpdateMsgsToParentMsgs:f,orphans:g}});return h.apply(this,arguments)}function i(a){return c("WANullthrows")(a.pollUpdateParentKey).toString()}g.getParentMessages=a}),98);
__d("WAWebPollsParseWebMsgInfoPollUpdates",["WALogger","WALongInt","WANullthrows","WAWebAddOnParseWebMsgInfo","WAWebMsgType","WAWebPollsCreateOptionLocalIdMap","WAWebPollsProtobufConversion","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[history sync] parseWebMsgInfoPollUpdates failed with error "," and stack ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Failed to parse pollUpdate with error ",""]);i=function(){return a};return a}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.webMsgInfo,e=a.parsedWebMsgInfo,f=a.isFromCag;try{if(b==null||b.pollUpdates==null)return[];if(e==null||e.type!==d("WAWebMsgType").MSG_TYPE.POLL_CREATION)return[];var g=e,j=(yield d("WAWebPollsCreateOptionLocalIdMap").createOptionLocalIdMap(g.pollOptions));return b.pollUpdates.map(function(a){try{var b,e=(b=c("WANullthrows"))(a.pollUpdateMessageKey),h=b(a.vote);e=b(d("WAWebAddOnParseWebMsgInfo").buildAddonMsgKey(e,f));var k=e.msgKey;e=e.sender;return d("WAWebPollsProtobufConversion").voteFromProtobuf({voteProtobuf:h,pollVoteMsgKey:k,parentMsgKey:g.id,sender:e,senderTimestampMs:d("WALongInt").numberOrThrowIfTooLarge(b(a.senderTimestampMs)),t:d("WAWebAddOnParseWebMsgInfo").getAddonServerTimestamp(a.serverTimestampMs),optionLocalIdMap:j,ack:null,read:a.unread!==!0})}catch(a){d("WALogger").ERROR(i(),a).devConsole(a).sendLogs("parseWebMsgInfoPollUpdates-vote-parse-error");return null}}).filter(Boolean)}catch(a){d("WALogger").ERROR(h(),a==null?void 0:a.name,a==null?void 0:a.stack).sendLogs("parseWebMsgInfoPollUpdates-error");return[]}});return j.apply(this,arguments)}g.parseWebMsgInfoPollUpdates=a}),98);
__d("WAWebPollsValidationError",["$InternalEnum","WACustomError","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){c=(a=b("$InternalEnum"))({DUPLICATE_OPTIONS:"poll_creation_duplicate_options"});e=a({INVALID_MESSAGE_SECRET:"poll_creation_invalid_message_secret",INVALID_NAME:"poll_creation_invalid_name",INVALID_OPTIONS_COUNT:"poll_creation_invalid_options_count",INVALID_OPTION:"poll_creation_invalid_option",INVALID_SELECTABLE_OPTIONS_COUNT:"poll_creation_invalid_selectable_options_count",MISSING_MESSAGE_SECRET:"poll_creation_missing_message_secret",MISSING_NAME:"poll_creation_missing_name",MISSING_OPTIONS:"poll_creation_missing_options",MISSING_SELECTABLE_OPTIONS_COUNT:"poll_creation_missing_selectable_options_count"});f=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="PollCreationValidationError",b)||babelHelpers.assertThisInitialized(c)}return b}(d("WAWebHandleMsgError").MessageValidationError);b=a({INVALID_VOTE_ENC_IV:"poll_update_invalid_vote_enc_iv",MISSING_POLL_MESSAGE_KEY:"poll_update_missing_poll_message_key",MISSING_SENDER_TIMESTAMP:"poll_update_missing_sender_timestamp",MISSING_UPDATE:"poll_update_missing_update",MISSING_VOTE_ENC_IV:"poll_update_missing_vote_enc_iv",MISSING_VOTE_ENC_PAYLOAD:"poll_update_missing_vote_enc_payload",MESSAGE_STANZA_INVALID:"poll_update_message_stanza_invalid"});var h=function(b){babelHelpers.inheritsLoose(a,b);function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(a=c=b.call.apply(b,[this].concat(e))||this,c.name="PollUpdateValidationError",a)||babelHelpers.assertThisInitialized(c)}return a}(d("WAWebHandleMsgError").MessageValidationError),i=a({INVALID_MESSAGE_SECRET:"poll_vote_invalid_message_secret",INVALID_OPTION:"poll_vote_invalid_option",INVALID_OPTIONS_COUNT:"poll_vote_invalid_options_count",OPTION_NOT_FOUND:"poll_vote_option_not_found"}),j=function(b){babelHelpers.inheritsLoose(a,b);function a(a){var c;c=b.call(this,a)||this;c.code=a;return c}return a}(d("WACustomError").customError("PollVoteValidationError"));a=a({INVALID_NAME:"poll_result_snapshot_invalid_name",INVALID_POLL_VOTES_SNAPSHOTS_COUNT:"poll_result_snapshot_invalid_poll_votes_snapshots_count",INVALID_OPTIONS_COUNT:"poll_result_snapshot_invalid_options_count",INVALID_OPTION:"poll_result_snapshot_invalid_option",INVALID_OPTION_VOTE_COUNT:"poll_result_snapshot_invalid_option_vote_count",MISSING_NAME:"poll_result_snapshot_missing_name",MISSING_POLL_VOTES:"poll_result_snapshot_missing_poll_votes",MISSING_OPTION:"poll_result_snapshot_missing_option",MISSING_OPTIONS:"poll_result_snapshot_missing_options",MISSING_OPTION_VOTE_COUNT:"poll_result_snapshot_missing_option_vote_count",DUPLICATE_OPTIONS:"poll_result_snapshot_duplicate_options"});d=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="PollResultSnapshotValidationError",b)||babelHelpers.assertThisInitialized(c)}return b}(d("WAWebHandleMsgError").MessageValidationError);g.PollCreationValidationWarningCode=c;g.PollCreationValidationErrorCode=e;g.PollCreationValidationError=f;g.PollUpdateValidationErrorCode=b;g.PollUpdateValidationError=h;g.PollVoteValidationErrorCode=i;g.PollVoteValidationError=j;g.PollResultSnapshotValidationErrorCode=a;g.PollResultSnapshotValidationError=d}),98);
__d("WAWebPollsExtractVotes",["Promise","WALogger","WANullthrows","WAWebAddonEncryptionError","WAWebMsgGetters","WAWebMsgType","WAWebPollsCreateOptionLocalIdMap","WAWebPollsProtobufConversion","WAWebPollsValidationError","WAWebPollsVoteEncryption","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Poll vote extraction failed: ","\n",""],["Poll vote extraction failed: ","\\n",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Poll vote extraction failed: ",""]);j=function(){return a};return a}function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield (h||(h=b("Promise"))).allSettled(Array.from(a.entries()).map(function(a){var b=a[0];a=a[1];return l(b,a)})));return a.map(function(a){switch(a.status){case"fulfilled":return a.value;case"rejected":a=a.reason;if(a instanceof d("WAWebPollsValidationError").PollVoteValidationError){d("WALogger").ERROR(j(),a.code).sendLogs(a.code);return}d("WALogger").ERROR(i(),a.message,a.stack).sendLogs("poll-vote-extraction-unknown-error")}}).filter(Boolean)});return k.apply(this,arguments)}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=d("WAWebAddonEncryptionError").getValidatedMessageSecret(d("WAWebMsgType").MsgKind.PollVoteEncrypted,b),f=c("WANullthrows")(b.pollSelectableOptionsCount),g=c("WANullthrows")(b.pollOptions),h=c("WANullthrows")(a.encPollVote),i=d("WAWebWidFactory").toUserWid(d("WAWebMsgGetters").getSender(a));h=(yield d("WAWebPollsVoteEncryption").decryptVote({encryptedVote:h.encPayload,iv:h.encIv,messageSecret:e,stanzaId:b.id.id,pollCreationOriginalSender:d("WAWebMsgGetters").getOriginalSender(b),voteSender:i,isOneOnOne:d("WAWebMsgGetters").getRemote(b).isUser()}));e=h.selectedOptions.length;if(e>g.length||f!==0&&e>f)throw new(d("WAWebPollsValidationError").PollVoteValidationError)(d("WAWebPollsValidationError").PollVoteValidationErrorCode.INVALID_OPTIONS_COUNT);if(h.selectedOptions.some(function(a){return a.byteLength!==32}))throw new(d("WAWebPollsValidationError").PollVoteValidationError)(d("WAWebPollsValidationError").PollVoteValidationErrorCode.INVALID_OPTION);b=(yield d("WAWebPollsCreateOptionLocalIdMap").createOptionLocalIdMap(g));if(!b.includesHashes(h.selectedOptions))throw new(d("WAWebPollsValidationError").PollVoteValidationError)(d("WAWebPollsValidationError").PollVoteValidationErrorCode.OPTION_NOT_FOUND);return d("WAWebPollsProtobufConversion").voteFromProtobuf({voteProtobuf:h,pollVoteMsgKey:a.id,parentMsgKey:a.pollUpdateParentKey,sender:i,senderTimestampMs:a.senderTimestampMs,t:c("WANullthrows")(a.t),optionLocalIdMap:b,ack:a.ack,read:d("WAWebUserPrefsMeUser").isMeAccount(i)})});return m.apply(this,arguments)}g.extractVotes=a;g.extractVote=l}),98);
__d("WAWebParsePollResultSnapshotMessageProto",["WALongInt","WAWebMsgType","WAWebPollsGatingUtils","WAWebPollsValidationError","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.msgContext;b=b.pollResultSnapshotMessage;if(b==null)return;if(!d("WAWebPollsGatingUtils").isPollResultSnapshotReceivingEnabled())return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,futureproofType:d("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT}),contextInfo:b.contextInfo};var e=b.name,f=b.pollVotes;b=b.contextInfo;if(e==null)throw new(d("WAWebPollsValidationError").PollResultSnapshotValidationError)(d("WAWebPollsValidationError").PollResultSnapshotValidationErrorCode.MISSING_NAME,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(e.length===0||e.length>d("WAWebPollsGatingUtils").getMaxPollNameLengthForIncomingMessages())throw new(d("WAWebPollsValidationError").PollResultSnapshotValidationError)(d("WAWebPollsValidationError").PollResultSnapshotValidationErrorCode.INVALID_NAME,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a==="quoted"||a==="history_quoted"){a=babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT,kind:d("WAWebMsgType").MsgKind.PollResultSnapshot,pollName:e,pollVotesSnapshot:null});return{msgData:a,contextInfo:b}}if(f==null||f.length===0)throw new(d("WAWebPollsValidationError").PollResultSnapshotValidationError)(d("WAWebPollsValidationError").PollResultSnapshotValidationErrorCode.MISSING_POLL_VOTES,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);var g=new Set();a=f.map(function(a){var b=a.optionName;a=a.optionVoteCount;if(b==null)throw new(d("WAWebPollsValidationError").PollResultSnapshotValidationError)(d("WAWebPollsValidationError").PollResultSnapshotValidationErrorCode.MISSING_OPTION,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(b.length===0||b.length>d("WAWebPollsGatingUtils").getMaxPollOptionLengthForIncomingMessages())throw new(d("WAWebPollsValidationError").PollResultSnapshotValidationError)(d("WAWebPollsValidationError").PollResultSnapshotValidationErrorCode.INVALID_OPTION,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a==null)throw new(d("WAWebPollsValidationError").PollResultSnapshotValidationError)(d("WAWebPollsValidationError").PollResultSnapshotValidationErrorCode.MISSING_OPTION_VOTE_COUNT,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);a=d("WALongInt").maybeNumberOrThrowIfTooLarge(a);if(a==null)throw new(d("WAWebPollsValidationError").PollResultSnapshotValidationError)(d("WAWebPollsValidationError").PollResultSnapshotValidationErrorCode.INVALID_OPTION_VOTE_COUNT,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(g.has(b))throw new(d("WAWebPollsValidationError").PollResultSnapshotValidationError)(d("WAWebPollsValidationError").PollResultSnapshotValidationErrorCode.DUPLICATE_OPTIONS,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);var c=g.size;g.add(b);return{option:{localId:c,name:b},optionVoteCount:a}}).filter(Boolean);if(a.length<2||a.length>d("WAWebPollsGatingUtils").getMaxPollOptionCount())throw new(d("WAWebPollsValidationError").PollResultSnapshotValidationError)(d("WAWebPollsValidationError").PollResultSnapshotValidationErrorCode.INVALID_POLL_VOTES_SNAPSHOTS_COUNT,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);f=babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT,kind:d("WAWebMsgType").MsgKind.PollResultSnapshot,pollName:e,pollVotesSnapshot:{pollVotes:a}});return{msgData:f,contextInfo:b}}g["default"]=a}),98);
__d("WAWebPollsParsePollCreationMessageProto",["WALogger","WAWebMessageSecretErrorsWamEvent","WAWebMsgType","WAWebNewsletterIsNewsletterMsg","WAWebPollsGatingUtils","WAWebPollsValidationError","WAWebWamEnumE2eFailureReason","WAWebWamEnumMessageSecretAllowedType","WAWebWamEnumMessageSecretErrorType"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["PollCreationValidationWarning: ",""]);h=function(){return a};return a}function a(a){var b=a.messageProtobuf,e=a.baseMessage;a=a.msgContext;var f=b.pollCreationMessage,g=b.pollCreationMessageV2,i=b.pollCreationMessageV3;f=(f=(f=f)!=null?f:g)!=null?f:i;var j=!c("WAWebNewsletterIsNewsletterMsg")({from:e.from,to:e.to});if(f==null)return null;if(f===g&&!d("WAWebPollsGatingUtils").isPollsReceivingEnabledInCags())return null;if(f===i&&!d("WAWebPollsGatingUtils").isSingleOptionPollsReceivingEnabled())return null;g=f.name;i=f.options;var k=f.selectableOptionsCount;f=f.contextInfo;if(g==null)throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.MISSING_NAME,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(g.length===0||g.length>d("WAWebPollsGatingUtils").getMaxPollNameLengthForIncomingMessages())throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.INVALID_NAME,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a==="quoted"||a==="history_quoted"){a=babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.POLL_CREATION,kind:d("WAWebMsgType").MsgKind.PollCreation,pollName:g,pollOptions:null,pollSelectableOptionsCount:null});return{msgData:a,contextInfo:f}}b=(a=b.messageContextInfo)==null?void 0:a.messageSecret;if(j&&b==null){new(d("WAWebMessageSecretErrorsWamEvent").MessageSecretErrorsWamEvent)({messageSecretAllowedList:d("WAWebWamEnumMessageSecretAllowedType").MESSAGE_SECRET_ALLOWED_TYPE.MESSAGE_POLL,messageSecretError:d("WAWebWamEnumMessageSecretErrorType").MESSAGE_SECRET_ERROR_TYPE.MISSING_MESSAGE_SECRET}).commit();throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.MISSING_MESSAGE_SECRET,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.MISSING_MESSAGE_SECRET)}if(j&&(b==null?void 0:b.byteLength)!==32){new(d("WAWebMessageSecretErrorsWamEvent").MessageSecretErrorsWamEvent)({messageSecretAllowedList:d("WAWebWamEnumMessageSecretAllowedType").MESSAGE_SECRET_ALLOWED_TYPE.MESSAGE_POLL,messageSecretError:d("WAWebWamEnumMessageSecretErrorType").MESSAGE_SECRET_ERROR_TYPE.WRONG_LENGTH}).commit();throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.INVALID_MESSAGE_SECRET,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.MESSAGE_SECRET_INVALID)}if(i==null)throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.MISSING_OPTIONS,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(k==null)throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.MISSING_SELECTABLE_OPTIONS_COUNT,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);var l=new Set();a=i.map(function(a){a=a.optionName;if(a==null||a.length===0||a.length>d("WAWebPollsGatingUtils").getMaxPollOptionLengthForIncomingMessages())throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.INVALID_OPTION,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(l.has(a)){d("WALogger").WARN(h(),d("WAWebPollsValidationError").PollCreationValidationWarningCode.DUPLICATE_OPTIONS).tags("polls").sendLogs(d("WAWebPollsValidationError").PollCreationValidationWarningCode.DUPLICATE_OPTIONS);return null}var b=l.size;l.add(a);return{name:a,localId:b}}).filter(Boolean);if(a.length<2||a.length>d("WAWebPollsGatingUtils").getMaxPollOptionCount())throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.INVALID_OPTIONS_COUNT,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(k<0||k>a.length)throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.INVALID_SELECTABLE_OPTIONS_COUNT,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);j=babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.POLL_CREATION,kind:d("WAWebMsgType").MsgKind.PollCreation,pollName:g,pollOptions:a,pollSelectableOptionsCount:k});return{msgData:j,contextInfo:f}}g["default"]=a}),98);
__d("WAWebPollsParsePollVoteMessageProto",["WALongInt","WAWebE2EProtoUtils","WAWebMsgType","WAWebPollsValidationError","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.pollUpdateMessage;if(!b)return null;var c=b.$$unknownFieldCount;c=c===void 0?0:c;var e=b.vote,f=b.senderTimestampMs;b=b.pollCreationMessageKey;if(c>0)return null;if(b==null)throw new(d("WAWebPollsValidationError").PollUpdateValidationError)(d("WAWebPollsValidationError").PollUpdateValidationErrorCode.MISSING_POLL_MESSAGE_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);c=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(b,a);if(c==null)throw new(d("WAWebPollsValidationError").PollUpdateValidationError)(d("WAWebPollsValidationError").PollUpdateValidationErrorCode.MISSING_POLL_MESSAGE_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(f==null)throw new(d("WAWebPollsValidationError").PollUpdateValidationError)(d("WAWebPollsValidationError").PollUpdateValidationErrorCode.MISSING_SENDER_TIMESTAMP,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(e==null)throw new(d("WAWebPollsValidationError").PollUpdateValidationError)(d("WAWebPollsValidationError").PollUpdateValidationErrorCode.MISSING_UPDATE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);b=e.encPayload;e=e.encIv;if(b==null)throw new(d("WAWebPollsValidationError").PollUpdateValidationError)(d("WAWebPollsValidationError").PollUpdateValidationErrorCode.MISSING_VOTE_ENC_PAYLOAD,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(e==null)throw new(d("WAWebPollsValidationError").PollUpdateValidationError)(d("WAWebPollsValidationError").PollUpdateValidationErrorCode.MISSING_VOTE_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(e.byteLength!==12)throw new(d("WAWebPollsValidationError").PollUpdateValidationError)(d("WAWebPollsValidationError").PollUpdateValidationErrorCode.INVALID_VOTE_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.POLL_UPDATE,kind:d("WAWebMsgType").MsgKind.PollVoteEncrypted,subtype:"poll_vote",addonEncrypted:!0,pollUpdateParentKey:c,encPollVote:{encPayload:b,encIv:e},senderTimestampMs:d("WALongInt").numberOrThrowIfTooLarge(f)}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebPollsVoteDataUtils",["WANullthrows","WAWebMsgGetters","WAWebMsgKeyUtils","WAWebMsgType","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WAWebMsgKeyUtils").msgKeyToTargetInfo(a.msgKey,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),c=b.from,e=b.to;b=b.author;return{id:a.msgKey,to:e,from:c,author:b,type:d("WAWebMsgType").MSG_TYPE.POLL_UPDATE,kind:d("WAWebMsgType").MsgKind.PollVoteDecrypted,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,pollUpdateParentKey:a.parentMsgKey,selectedOptionLocalIds:a.selectedOptionLocalIds,senderTimestampMs:a.senderTimestampMs,t:(e=a.t)!=null?e:void 0,ack:(c=a.ack)!=null?c:void 0,read:(b=a.read)!=null?b:!1}}function b(a){return{msgKey:a.id,parentMsgKey:a.pollUpdateParentKey,selectedOptionLocalIds:a.selectedOptionLocalIds,senderTimestampMs:a.senderTimestampMs,t:a.t,sender:d("WAWebWidFactory").toUserWid(c("WANullthrows")(d("WAWebMsgGetters").getSender(a))),ack:d("WAWebMsgGetters").getAck(a),read:d("WAWebUserPrefsMeUser").isMeAccount(a.from)||a.read}}g.voteDataToPollVoteMsgData=a;g.pollVoteMsgDataToVoteData=b}),98);
__d("WAWebPollsGatingUtils",["WAWebABProps","WAWebMobilePlatforms","WAWebNewsletterGatingUtils","WAWebPrimaryFeatures","WAWebWid"],(function(a,b,c,d,e,f,g){function h(){if(d("WAWebMobilePlatforms").isSMB()&&!d("WAWebABProps").getABPropConfigValue("parent_group_view_enabled_for_smb_on_web"))return!1;return!d("WAWebPrimaryFeatures").primaryFeatureEnabled("poll_creation_cag")?!1:d("WAWebABProps").getABPropConfigValue("poll_creation_cag_enabled")}function a(){return h()?!0:d("WAWebABProps").getABPropConfigValue("poll_receiving_cag_enabled")}function b(){return Math.min(d("WAWebABProps").getABPropConfigValue("poll_name_length"),500)}function e(){return 5e3}function f(){return Math.min(d("WAWebABProps").getABPropConfigValue("poll_option_length"),255)}function i(){return 2500}function j(){return Math.min(d("WAWebABProps").getABPropConfigValue("poll_option_count"),20)}function k(){return d("WAWebABProps").getABPropConfigValue("poll_result_details_view_enabled")}function l(){return d("WAWebABProps").getABPropConfigValue("polls_fast_follow_enabled")}function m(){return l()}function n(){return l()}function o(){return d("WAWebABProps").getABPropConfigValue("polls_single_option_control_enabled")}function p(a){return c("WAWebWid").isNewsletter(a)===!0?d("WAWebNewsletterGatingUtils").isNewsletterPollsSingleOptionEnabled():o()||d("WAWebABProps").getABPropConfigValue("polls_single_option_sender_control_enabled")}function q(a){return p(a)||d("WAWebABProps").getABPropConfigValue("polls_single_option_receiver_control_enabled")}function r(){return d("WAWebABProps").getABPropConfigValue("polls_notification_enabled")}function s(){return d("WAWebABProps").getABPropConfigValue("poll_result_snapshot_message_receiver_enabled")}g.isPollsCreationEnabledInCags=h;g.isPollsReceivingEnabledInCags=a;g.getMaxPollNameLength=b;g.getMaxPollNameLengthForIncomingMessages=e;g.getMaxPollOptionLength=f;g.getMaxPollOptionLengthForIncomingMessages=i;g.getMaxPollOptionCount=j;g.isPollResultDetailsViewEnabled=k;g.arePollsFastFollowsEnabled=l;g.isPrefillPollQuestionEnabled=m;g.isPollsCancellationPromptEnabled=n;g.isSingleOptionPollsSendingEnabled=p;g.isSingleOptionPollsReceivingEnabled=q;g.arePollsNotificationsEnabled=r;g.isPollResultSnapshotReceivingEnabled=s}),98);
__d("WAWebParseOrderMessageProto",["WALongInt","WAWebE2EProtoParserApi","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.orderMessage;if(b==null)return;var c=b.thumbnail,e=b.message,f=b.orderId,g=b.itemCount,h=b.status,i=b.surface,j=b.sellerJid,k=b.orderTitle,l=b.token,m=b.totalAmount1000,n=b.totalCurrencyCode;b=b.contextInfo;c=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.ORDER,kind:d("WAWebMsgType").MsgKind.Order,thumbnail:d("WAWebE2EProtoParserApi").decodeBytes(c),message:e||"",orderId:f,itemCount:g||0,status:h,surface:i,sellerJid:j,orderTitle:k||"",token:l||"",totalAmount1000:d("WALongInt").numberOrThrowIfTooLarge((a=m)!=null?a:0),totalCurrencyCode:n,body:""});return{msgData:c,contextInfo:b}}g["default"]=a}),98);
__d("WAWebParseProductMessageProto",["WALongInt","WAWebMsgType","WAWebParseImageMessageProto"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,e=a.baseMessage;a=a.msgContext;b=b.productMessage;if(b==null)return;var f=b.product,g=b.businessOwnerJid,h=b.body,i=b.footer;b=b.contextInfo;if(f==null)return;var j=f.productImage,k=f.productId,l=f.currencyCode,m=f.priceAmount1000,n=f.salePriceAmount1000,o=f.retailerId,p=f.url,q=f.productImageCount,r=f.title;f=f.description;var s={};if(j!=null){j=c("WAWebParseImageMessageProto")({messageProtobuf:{imageMessage:j},baseMessage:e,msgContext:a});if(j!=null){a=j.msgData;s={deprecatedMms3Url:a.deprecatedMms3Url,directPath:a.directPath,staticUrl:a.staticUrl,mimetype:a.mimetype,filehash:a.filehash,encFilehash:a.encFilehash,size:a.size,height:a.height,width:a.width,mediaKey:a.mediaKey,mediaKeyTimestamp:a.mediaKeyTimestamp,body:a.body,interactiveAnnotations:a.interactiveAnnotations,scanLengths:a.scanLengths,scansSidecar:a.scansSidecar,isViewOnce:a.isViewOnce,thumbnailDirectPath:a.thumbnailDirectPath,thumbnailSha256:a.thumbnailSha256,thumbnailEncSha256:a.thumbnailEncSha256}}}e=babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.PRODUCT,kind:d("WAWebMsgType").MsgKind.Product,businessOwnerJid:g,productId:k,currencyCode:l,priceAmount1000:d("WALongInt").numberOrThrowIfTooLarge((j=m)!=null?j:0)||void 0,salePriceAmount1000:d("WALongInt").numberOrThrowIfTooLarge((a=n)!=null?a:0)||void 0,retailerId:o,url:p,productImageCount:q,title:r,description:f,caption:h,footer:i},s);return{msgData:e,contextInfo:b}}g["default"]=a}),98);
__d("WAWebBizCatalogManagementFetchProductListQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="28180876438178514"}),null);
__d("WAWebBizCatalogManagementFetchProductListQuery.graphql",["WAWebBizCatalogManagementFetchProductListQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"request"}],c=[{kind:"Variable",name:"request",variableName:"request"}],d={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null};d=[{alias:null,args:null,kind:"ScalarField",name:"availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},d,{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[d,{alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[d,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},e,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null},e,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null}],storageKey:null},f,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},f],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementFetchProductListQuery",selections:[{alias:null,args:c,concreteType:"XFBWhatsAppCatalogGetProductListResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_product_list",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductListResponse",kind:"LinkedField",name:"product_list",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"products",plural:!0,selections:[{kind:"InlineDataFragmentSpread",name:"WAWebBizCatalogManagementParseProductGraphql_product",selections:d,args:null,argumentDefinitions:[]}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebBizCatalogManagementFetchProductListQuery",selections:[{alias:null,args:c,concreteType:"XFBWhatsAppCatalogGetProductListResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_product_list",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductListResponse",kind:"LinkedField",name:"product_list",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"products",plural:!0,selections:d,storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:b("WAWebBizCatalogManagementFetchProductListQuery_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementFetchProductListQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebBizCatalogManagementFetchProductList",["Promise","WALogger","WAWebBizCatalogManagementFetchProductListQuery.graphql","WAWebBizCatalogManagementParseProductGraphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient"],(function(a,b,c,d,e,f,g){var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["fetchProductListWithToken: failed with error"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(['fetchProductList: failed as "','"']);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["fetchProductList: success"]);l=function(){return a};return a}var m={type:"error"},n=h!==void 0?h:h=b("WAWebBizCatalogManagementFetchProductListQuery.graphql");function a(a){return!d("WAWebBizGatingUtils").graphQLForGetProductListEnabled()?(i||(i=b("Promise"))).resolve({type:"not-enabled"}):o(a).then(function(a){if(a.type==="success"){d("WALogger").LOG(l());return a}a.type;d("WALogger").LOG(k(),a.type);return a})}function o(a){return d("WAWebFetchAdAccountToken").fetchToken().then(function(b){if(b.type==="success")return p(b.token,a).then(function(a){a.type!=="success"?a.type==="auth-failure"?d("WAWebFetchAdAccountToken").markTokenAsInvalid():a.type:a.type;return a});b.type;return b})}function p(a,b){var e;return c("WAWebNetworkStatus").waitIfOffline({signal:new AbortController().signal}).then(function(){return d("WAWebRelayClient").fetchQuery(n,{request:b},{environmentType:"facebook",accessToken:a,getInlineDataReader:function(a){e=a}})}).then(function(a){if(a==null)return m;a=(a=a.xfb_whatsapp_catalog_product_list)==null?void 0:(a=a.product_list)==null?void 0:a.products;if(a==null)return m;a=a.map(function(a){return e(d("WAWebBizCatalogManagementParseProductGraphql").PARSE_PRODUCT_FRAGMENT,a)}).map(d("WAWebBizCatalogManagementParseProductGraphql").parseProductGraphQL);return{type:"success",productsResult:a}})["catch"](function(a){d("WALogger").LOG(j()).devConsole(a);if(d("WAWebFetchAdAccountToken").hasGraphQLAuthError(a))return{type:"auth-failure"};return a instanceof d("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:a}:m})}g.fetchProductList=a}),98);
__d("WAWebBizCatalogManagementParseProductGraphql_product.graphql",[],(function(a,b,c,d,e,f){"use strict";a={kind:"InlineDataFragment",name:"WAWebBizCatalogManagementParseProductGraphql_product"};e.exports=a}),null);
__d("WAWebBizCatalogManagementParseProductGraphql",["WAWebBizCatalogManagementParseProductGraphql_product.graphql","WAWebBizCatalogParseProduct","WAWebBizParseProductGraphql","WAWebNonEmptyString","WAWebProductTypes.flow","WAWebSyntheticCountryCode","err"],(function(a,b,c,d,e,f,g){var h;f=h!==void 0?h:h=b("WAWebBizCatalogManagementParseProductGraphql_product.graphql");function a(a){var b;return d("WAWebBizParseProductGraphql").parseProductGraphQL({id:a.id,name:a.name,description:a.description,url:a.url,shimmed_url:a.shimmed_url,price:a.price,currency:a.currency,retailer_id:a.retailer_id,belongs_to:a.belongs_to,status_info:{can_appeal:(b=a.status_info)==null?void 0:b.can_appeal,status:(b=a.status_info)==null?void 0:b.status},product_availability:a.availability,max_available:a.max_available,sale_price:{start_date:(b=a.sale_price)==null?void 0:b.start_date,end_date:(b=a.sale_price)==null?void 0:b.end_date,price:(b=a.sale_price)==null?void 0:b.price},media:{images:(b=(b=a.media)==null?void 0:b.images.map(function(a){return{id:a.id,original_image_url:a.original_image_url,request_image_url:a.request_image_url}}))!=null?b:[],videos:((b=(b=a.media)==null?void 0:b.videos)!=null?b:[]).map(function(a){return{id:a.id,original_video_url:a.original_video_url,thumbnail_url:a.thumbnail_url}})},compliance_info:a.compliance_info!=null?{country_code_origin:a.compliance_info.country_code_origin,importer_name:a.compliance_info.importer_name,importer_address:{street1:(b=a.compliance_info.importer_address)==null?void 0:b.street1,street2:(b=a.compliance_info.importer_address)==null?void 0:b.street2,postal_code:(b=a.compliance_info.importer_address)==null?void 0:b.postal_code,city:(b=a.compliance_info.importer_address)==null?void 0:b.city,region:(b=a.compliance_info.importer_address)==null?void 0:b.region,country_code:(b=a.compliance_info.importer_address)==null?void 0:b.country_code}}:null,compliance_category:d("WAWebProductTypes.flow").mapComplianceCategoryToWASchema(a.compliance_category),is_hidden:d("WAWebProductTypes.flow").mapIsHiddenToWASchema(a.is_hidden)})}function e(a){if(a.imageCdnUrl==null)throw c("err")("productModelToGraphQLInput: imageCdnUrl is null");var b=[{url:a.imageCdnUrl}];a.additionalImageCdnUrl!=null&&b.push.apply(b,a.additionalImageCdnUrl.map(function(a){return{url:a}}));b={name:a.name,media:{image:b},is_hidden:a.isHidden};d("WAWebNonEmptyString").isNonEmptyString(a.description)&&(b.description=a.description);d("WAWebNonEmptyString").isNonEmptyString(a.url)&&(b.url=a.url);d("WAWebNonEmptyString").isNonEmptyString(a.retailerId)&&(b.retailer_id=a.retailerId);a.priceAmount1000!=null&&(b.currency=a.currency,b.price=a.priceAmount1000.toString());a.salePriceAmount1000!=null&&(b.sale_price=a.salePriceAmount1000.toString());a.videos!=null&&(b.media.video=a.videos.map(function(a){return{url:a.original_video_url}}));var e=a.complianceInfo&&i(a.complianceInfo);e!=null&&(b.compliance_info=e);((e=a.complianceInfo)==null?void 0:e.countryCodeOrigin)===d("WAWebSyntheticCountryCode").SyntheticCountryCode.NotApplicable&&(b.compliance_category=d("WAWebProductTypes.flow").ProductComplianceCategory.CountryOriginExempt);return b}function i(a){var b=d("WAWebBizCatalogParseProduct").scanComplianceInfoForMissingData(a),c=b.isExempt,e=b.hasCountryCodeOrigin,f=b.hasImporterName;b=b.hasImporterAddress;if(c||!(e&&f&&b))return;c={country_code_origin:e&&a.countryCodeOrigin!=null?a.countryCodeOrigin:""};f&&(c.importer_name=a.importerName);if(b){e={country_code:(f=(e=a.importerAddress)==null?void 0:e.countryCode)!=null?f:"",city:(e=(b=a.importerAddress)==null?void 0:b.city)!=null?e:"",street1:(b=(f=a.importerAddress)==null?void 0:f.street1)!=null?b:""};d("WAWebNonEmptyString").isNonEmptyString((f=a.importerAddress)==null?void 0:f.street2)&&(e.street2=a.importerAddress.street2);d("WAWebNonEmptyString").isNonEmptyString((b=a.importerAddress)==null?void 0:b.region)&&(e.region=a.importerAddress.region);d("WAWebNonEmptyString").isNonEmptyString((f=a.importerAddress)==null?void 0:f.postalCode)&&(e.postal_code=a.importerAddress.postalCode)}return c}g.PARSE_PRODUCT_FRAGMENT=f;g.parseProductGraphQL=a;g.productModelToGraphQLInput=e}),98);
__d("WAWebParseProtocolEphemeralSettingMessageProto",["WAWebE2EProtoUtils","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.protocolMessage;if(b==null)return;if(b.type!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.EPHEMERAL_SETTING)return;var c;b.disappearingMode!=null&&(c=d("WAWebE2EProtoUtils").protoToDisappearingMode(a,b.disappearingMode));a=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"ephemeral_setting",ephemeralDuration:b.ephemeralExpiration,disappearingModeTrigger:(a=c)==null?void 0:a.disappearingModeTrigger,disappearingModeInitiatedByMe:(b=c)==null?void 0:b.initiatedByMe});return{msgData:a,contextInfo:void 0}}g["default"]=a}),98);
__d("WAWebParseProtocolHistorySyncNotificationMessageProto",["WAWebE2EProtoParserApi","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.msgContext;b=b.protocolMessage;if(b==null)return;if(a!=="relay")return;if(b.type!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.HISTORY_SYNC_NOTIFICATION)return;a=b.historySyncNotification;if(a==null)return;var e={directPath:a.directPath,encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(a.fileEncSha256),filehash:d("WAWebE2EProtoParserApi").decodeBytes(a.fileSha256),mediaKey:d("WAWebE2EProtoParserApi").decodeBytes(a.mediaKey),type:"md-msg-hist"};a=babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"history_sync_notification",historySyncMetaData:{historySyncNotification:a,downloadOptions:e,progress:(b==null?void 0:(c=b.historySyncNotification)==null?void 0:c.progress)||0}});return{msgData:a,contextInfo:void 0}}g["default"]=a}),98);
__d("WAWebGenerateAudioOrPttReportingTokenContent",["WAWebReportingTokenUtils"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebReportingTokenUtils").getMediaReportingTokenContent(a)}g["default"]=a}),98);
__d("WAWebPttParseAudioMessageProto",["WALongInt","WATimeUtils","WAWebAudioMessageProtoUtils","WAWebE2EProtoParserApi","WAWebMediaMessageGetValidatedProperties","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.msgContext;b=b.audioMessage;if(b==null)return;var e=b.ptt;if(e===!0)return;e=b.contextInfo;var f=b.directPath,g=b.mimetype,h=b.seconds,i=b.mediaKeyTimestamp,j=b.streamingSidecar,k=b.waveform,l=b.backgroundArgb,m=b.viewOnce;a=d("WAWebMediaMessageGetValidatedProperties").getValidatedMediaMessageProperties(b,c,a,d("WAWebMsgType").MSG_TYPE.AUDIO);var n=a.mediaKey,o=a.fileSha256,p=a.fileEncSha256,q=a.fileLength;a=a.url;c=babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.AUDIO,kind:d("WAWebMsgType").MsgKind.Audio,deprecatedMms3Url:d("WAWebE2EProtoParserApi").decodeUrl(a),directPath:f,mimetype:g,filehash:d("WAWebE2EProtoParserApi").decodeBytes(o),encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(p),size:q,duration:""+(h||0),mediaKey:d("WAWebE2EProtoParserApi").decodeBytes(n),mediaKeyTimestamp:i!=null?d("WALongInt").numberOrThrowIfTooLarge(i):d("WATimeUtils").unixTime(),streamingSidecar:j,waveform:k&&d("WAWebAudioMessageProtoUtils").validateWaveform(k)?new Uint8Array(k):void 0,backgroundColor:l,isViewOnce:m===!0});d("WAWebE2EProtoParserApi").validateRequiredMediaProperties(c,b);d("WAWebAudioMessageProtoUtils").validateRequiredAudioProperties(c,b);return{msgData:c,contextInfo:e}}g["default"]=a}),98);
__d("WAWebPttParsePttMessageProto",["WALongInt","WATimeUtils","WAWebAudioMessageProtoUtils","WAWebE2EProtoParserApi","WAWebMediaMessageGetValidatedProperties","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.msgContext;b=b.audioMessage;if(b==null)return;var e=b.ptt;if(e!==!0)return;e=b.contextInfo;var f=b.directPath,g=b.mimetype,h=b.seconds,i=b.mediaKeyTimestamp,j=b.streamingSidecar,k=b.waveform,l=b.backgroundArgb,m=b.viewOnce;a=d("WAWebMediaMessageGetValidatedProperties").getValidatedMediaMessageProperties(b,c,a,d("WAWebMsgType").MSG_TYPE.PTT);var n=a.mediaKey,o=a.fileSha256,p=a.fileEncSha256,q=a.fileLength;a=a.url;c=babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.PTT,kind:d("WAWebMsgType").MsgKind.Ptt,deprecatedMms3Url:d("WAWebE2EProtoParserApi").decodeUrl(a),directPath:f,mimetype:g,filehash:d("WAWebE2EProtoParserApi").decodeBytes(o),encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(p),size:q,duration:""+(h||0),mediaKey:d("WAWebE2EProtoParserApi").decodeBytes(n),mediaKeyTimestamp:i!=null?d("WALongInt").numberOrThrowIfTooLarge(i):d("WATimeUtils").unixTime(),streamingSidecar:j,waveform:k&&d("WAWebAudioMessageProtoUtils").validateWaveform(k)?new Uint8Array(k):void 0,backgroundColor:l,isViewOnce:m===!0});d("WAWebE2EProtoParserApi").validateRequiredMediaProperties(c,b);d("WAWebAudioMessageProtoUtils").validateRequiredAudioProperties(c,b);return{msgData:c,contextInfo:e}}g["default"]=a}),98);
__d("WAWebGeneratePtvReportingTokenContent",["WAWebReportingTokenUtils"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebReportingTokenUtils").getMediaReportingTokenContent(a)}g["default"]=a}),98);
__d("WAWebPtvGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("ptv_receiving_enabled")}function b(){return d("WAWebABProps").getABPropConfigValue("ptv_autoplay_enabled")}function c(){var a=d("WAWebABProps").getABPropConfigValue("ptv_autoplay_loop_limit");return a===0?Infinity:a}function e(){return d("WAWebABProps").getABPropConfigValue("ptv_max_duration_seconds")}g.isPtvReceivingEnabled=a;g.isPtvAutoplayEnabled=b;g.getPtvAutoplayLoopLimit=c;g.getPtvMaxDurationSeconds=e}),98);
__d("WAWebPtvParsePtvMessageProto",["WALongInt","WATimeUtils","WAWebE2EProtoParserApi","WAWebE2EProtoUtils","WAWebMsgType","WAWebPtvGatingUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.ptvMessage;if(b==null)return;if(!d("WAWebPtvGatingUtils").isPtvReceivingEnabled())return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,futureproofType:d("WAWebMsgType").MSG_TYPE.PTV}),contextInfo:b==null?void 0:b.contextInfo};var c=b.url,e=b.directPath,f=b.staticUrl,g=b.mimetype,h=b.caption,i=b.fileSha256,j=b.fileEncSha256,k=b.fileLength,l=b.height,m=b.width,n=b.mediaKey,o=b.mediaKeyTimestamp,p=b.jpegThumbnail,q=b.annotations,r=b.viewOnce,s=b.thumbnailDirectPath,t=b.thumbnailSha256,u=b.thumbnailEncSha256,v=b.contextInfo,w=b.gifPlayback,x=b.gifAttribution,y=b.seconds,z=b.streamingSidecar;a=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PTV,kind:d("WAWebMsgType").MsgKind.Ptv,deprecatedMms3Url:d("WAWebE2EProtoParserApi").decodeUrl(c),directPath:e,staticUrl:f||"",mimetype:g,caption:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(h),filehash:d("WAWebE2EProtoParserApi").decodeBytes(i),encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(j),size:d("WALongInt").numberOrThrowIfTooLarge(k||0),height:l,width:m,mediaKey:d("WAWebE2EProtoParserApi").decodeBytes(n),mediaKeyTimestamp:o!=null?d("WALongInt").numberOrThrowIfTooLarge(o):d("WATimeUtils").unixTime(),duration:""+(y||0),body:d("WAWebE2EProtoParserApi").decodeBytes(p)||"",interactiveAnnotations:q,isViewOnce:r===!0,thumbnailDirectPath:s,thumbnailSha256:d("WAWebE2EProtoParserApi").decodeBytes(t),thumbnailEncSha256:d("WAWebE2EProtoParserApi").decodeBytes(u),isGif:w,gifAttribution:x,streamingSidecar:z});d("WAWebE2EProtoParserApi").validateRequiredMediaProperties(a,b);return{msgData:a,contextInfo:v}}g["default"]=a}),98);
__d("WAWebQuickPromotionActionMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="6907502319358470"}),null);
__d("WAWebQuickPromotionActionMutation.graphql",["WAWebQuickPromotionActionMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"WaQuickPromotionLogEventResponsePayload",kind:"LinkedField",name:"wa_quick_promotion_log_event",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"client_mutation_id",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebQuickPromotionActionMutation",selections:c,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebQuickPromotionActionMutation",selections:c},params:{id:b("WAWebQuickPromotionActionMutation_facebookRelayOperation"),metadata:{},name:"WAWebQuickPromotionActionMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("WAWebQuickPromotionActionMutation",["Promise","WACustomError","WALogger","WAPromiseTimeout","WAWebBizGatingUtils","WAWebCTWAConstants","WAWebFetchAdAccountToken","WAWebOrchestratorNonPersistedJob","WAWebQuickPromotionActionMutation.graphql","WAWebRelayClient"],(function(a,b,c,d,e,f,g){var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(['executeQuickPromotionActionMutation: failed as "timeout"']);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(['executeQuickPromotionActionMutation: failed as "','"']);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["executeQuickPromotionActionMutation: success"]);l=function(){return a};return a}var m={type:"error"},n=h!==void 0?h:h=b("WAWebQuickPromotionActionMutation.graphql");function a(a){if(!d("WAWebBizGatingUtils").qpGraphQLEnabled())return(i||(i=b("Promise"))).resolve({type:"not-enabled"});var c=d("WAWebCTWAConstants").KNOWN_QP_SURFACES.get(a.surface_nux_id);return c==null||!d("WAWebBizGatingUtils").qpSurfaceIdsUsingGraphQL().has(c)?(i||(i=b("Promise"))).resolve({type:"not-enabled"}):d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("quickPromotionActionMutation",function(){return o(a)}).waitUntilCompleted()}function o(a){return d("WAPromiseTimeout").promiseTimeout(p(a),d("WAWebCTWAConstants").QP_ACTION_MUTATION_TIMEOUT_MS).then(function(a){if(a.type==="success"){d("WALogger").LOG(l());return a}a.type;d("WALogger").WARN(k(),a.type);return a})["catch"](function(a){if(a instanceof d("WACustomError").TimeoutError){d("WALogger").WARN(j());return{type:"timeout"}}throw a})}function p(a){return d("WAWebFetchAdAccountToken").fetchToken().then(function(b){if(b.type==="success")return q(a,b.token).then(function(a){a.type==="auth-failure"?d("WAWebFetchAdAccountToken").markTokenAsInvalid():a.type;return a});b.type;return b})}function q(a,b){return d("WAWebRelayClient").commitMutation(n,{input:a},{environmentType:"facebook",accessToken:b}).then(function(a){if(a==null)return m;return a.wa_quick_promotion_log_event==null?m:{type:"success"}})["catch"](function(a){return d("WAWebFetchAdAccountToken").hasGraphQLAuthError(a)?{type:"auth-failure"}:m})}g.executeQuickPromotionActionMutation=a}),98);
__d("WAWebReactAddonMessageProcessorUtils",["WANullthrows","WAWebAddonDBTable","WAWebCastToReactionMsg","WAWebMsgGetters","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(a){return[a.reactionParentKey,c("WANullthrows")(d("WAWebMsgGetters").getSender(a))]}function i(a){return h(a).map(function(a){return a.toString()}).join("-")}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Map();a=a.map(h);a=(yield d("WAWebAddonDBTable").addonDBTable.bulkGetByParentAndSender(d("WAWebMsgType").MSG_TYPE.REACTION,a));for(a of a){var c=d("WAWebCastToReactionMsg").assertReactionMsgData(a),e=i(c);b.set(e,c.reactionTimestamp)}return function(a){a=i(a);return b.get(a)}});return j.apply(this,arguments)}g.createGetReactionTimestamp=a}),98);
__d("WAWebReactionAddonMessageProcessor",["Promise","WALogger","WAWebABProps","WAWebAddonConstants","WAWebAddonCreateMsgProcessor","WAWebBackendApi","WAWebDBMarkFutureproofMessagesReparsed","WAWebLastAddOnDBSerialization","WAWebMsgType","WAWebReactAddonMessageProcessorUtils","WAWebReactionDataUtils","WAWebReactionEncryptMsgData","WAWebReactionGatingUtils","WAWebReactionsEncryption","WAWebReactionsParseWebMsgInfoReaction","WAWebShouldUpdateLastAddOnPreview","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed decrypted enc reactions"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot decrypt reaction: ",""]);j=function(){return a};return a}function k(a){return!new Set([d("WAWebAddonConstants").AddonProcessMode.HistorySync,d("WAWebAddonConstants").AddonProcessMode.Hydration]).has(a)}a=d("WAWebAddonCreateMsgProcessor").createAddonMsgProcessorDualEncrypted({isEnabled:function(){return d("WAWebABProps").getABPropConfigValue("unified_reaction_addon_infra_enabled")},convert:{fromHistorySyncMsg:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebReactionsParseWebMsgInfoReaction").parseWebMsgInfoReaction(a.webMsgInfo,a.parsedWebMsgInfo).map(function(a){return d("WAWebReactionDataUtils").reactionRowToReactionMsgData(d("WAWebReactionDataUtils").webMsgInfoReactionTypeToReactionsRow(a))})});function c(b){return a.apply(this,arguments)}return c}(),toDualEncryptedMsgData:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return a.kind===d("WAWebMsgType").MsgKind.ReactionEncrypted?a:d("WAWebReactionEncryptMsgData").encryptReactionMsgData(a,b)});function c(b,c){return a.apply(this,arguments)}return c}(),toDualDecryptedMsgData:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return a.kind===d("WAWebMsgType").MsgKind.ReactionDecrypted?a:d("WAWebReactionsEncryption").decryptReactionMsgData(a,b)});function c(b,c){return a.apply(this,arguments)}return c}()},updateCollection:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(d("WAWebReactionGatingUtils").isFlattenedReactionsEnabled()&&b===d("WAWebAddonConstants").AddonProcessMode.Hydration){yield d("WAWebBackendApi").frontendSendAndReceive("reactionUIUpdate",a);return}yield d("WAWebBackendApi").frontendSendAndReceive("updateReactionCollection",{msgs:a.add,removeReactions:a.remove,allowNotifications:k(b)})});function c(b,c){return a.apply(this,arguments)}return c}(),beforeUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=c.parents,f=[];c=[];for(a of a)a.kind===d("WAWebMsgType").MsgKind.ReactionEncrypted?c.push(a):a.kind===d("WAWebMsgType").MsgKind.ReactionDecrypted&&f.push(a);yield (h||(h=b("Promise"))).allSettled(c.map(function(a){return d("WAWebReactionsEncryption").decryptReactionMsgData(a,e.getForAddon(a))})).then(function(a){for(var b of a)b.status==="fulfilled"&&b.value!=null?f.push(b.value):d("WALogger").LOG(j(),b.reason);a.some(function(a){return a.status==="rejected"})&&d("WALogger").WARN(i()).tags("messaging","addons").sendLogs("decrypt-enc-reaction-failed",{sampling:.01})});var g=(yield d("WAWebReactAddonMessageProcessorUtils").createGetReactionTimestamp(f));a=f.filter(function(a){var b=g(a);return b==null||b<a.reactionTimestamp});return a});function c(b,c){return a.apply(this,arguments)}return c}(),afterUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b.processMode;yield d("WAWebShouldUpdateLastAddOnPreview").filterAndUpdateChatPreviews(a.map(function(a){return d("WAWebLastAddOnDBSerialization").lastAddOnPreviewCandidateFromReactionRowType(d("WAWebReactionDataUtils").reactionMsgDataToReactionRow(a))}));b===d("WAWebAddonConstants").AddonProcessMode.OnlineReceive&&(yield d("WAWebDBMarkFutureproofMessagesReparsed").markFutureproofMessagesReparsed(a.map(function(a){return a.id.toString()})))});function c(b,c){return a.apply(this,arguments)}return c}(),manageNotifications:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b.processMode;if(!k(b)||!d("WAWebReactionGatingUtils").isReactionNotificationAddOnApiEnabled())return;d("WAWebBackendApi").frontendFireAndForget("handleReactionNotification",{reactions:a.add})});function c(b,c){return a.apply(this,arguments)}return c}()});c=a;g["default"]=c}),98);
__d("WAWebReactionEncryptMsgData",["WANullthrows","WAWebAddonEncryption","WAWebAddonEncryptionError","WAWebBackendApi","WAWebMsgGetters","WAWebMsgType","WAWebProcessBaseMsgInfo","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=(yield d("WAWebBackendApi").frontendSendAndReceive("getGroupMetadata",{groupWid:a.id.remote}));if(e==null?void 0:e.isCag){var f;e=self.crypto.getRandomValues(new Uint8Array(12));var g={type:(f=d("WAWebMsgType")).MsgKind.ReactionDecrypted,encode:{text:a.reactionText,senderTimestampMs:a.reactionTimestamp}},h=d("WAWebAddonEncryptionError").getValidatedMessageSecret(f.MsgKind.ReactionDecrypted,b);g=(yield d("WAWebAddonEncryption").encryptAddOn(g,{messageSecret:h,iv:e,stanzaId:b.id.id,originalMessageSender:c("WANullthrows")(d("WAWebMsgGetters").getOriginalSender(b)),addOnSender:d("WAWebWidFactory").toUserWid(c("WANullthrows")(d("WAWebMsgGetters").getSender(a)))}));return babelHelpers["extends"]({},d("WAWebProcessBaseMsgInfo").msgDataToBaseMsgInfo(a),{type:f.MSG_TYPE.REACTION_ENC,kind:f.MsgKind.ReactionEncrypted,targetMessageKey:b.id,encPayload:g,encIv:e.buffer})}return a});return h.apply(this,arguments)}g.encryptReactionMsgData=a}),98);
__d("WAWebReactionEncMessageValidationError",["$InternalEnum","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({INVALID_ENC_IV:"enc_reaction_invalid_iv",INVALID_ENC_PAYLOAD:"enc_reaction_invalid_payload",MISSING_TARGET_MSG_KEY:"enc_reaction_missing_target_msg_key",MISSING_MESSAGE_SECRET:"enc_reaction_missing_message_secret",MISSING_SENDER:"enc_reaction_missing_sender",MISSING_PARENT_MESSAGE:"enc_reaction_missing_parent_message",MISSING_PARENT_MESSAGE_SENDER:"enc_reaction_missing_parent_message_sender",DECRYPTION_FAILED:"enc_reaction_decryption_failed"});c=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="ReactionEncMessageValidationError",b)||babelHelpers.assertThisInitialized(c)}return b}(d("WAWebHandleMsgError").MessageValidationError);g.ReactionEncValidationErrorCode=a;g.ReactionEncMessageValidationError=c}),98);
__d("WAWebReactionsValidationError",["$InternalEnum","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({INVALID_REACTION_TEXT_LENGTH:"reaction_invalid_text_length",MISSING_PARENT_MSG_KEY:"reaction_missing_parent_msg_key",MISSING_TIMESTAMP:"reaction_missing_timestamp"});c=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="ReactionValidationError",b)||babelHelpers.assertThisInitialized(c)}return b}(d("WAWebHandleMsgError").MessageValidationError);g.ReactionValidationErrorCode=a;g.ReactionValidationError=c}),98);
__d("WAWebReactionsEncryption",["WALongInt","WANullthrows","WAWebAddonEncryption","WAWebAddonEncryptionError","WAWebE2EProtoUtils","WAWebMsgGetters","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebReactionEncMessageValidationError","WAWebReactionsBEUtils","WAWebReactionsValidationError","WAWebWamEnumE2eFailureReason","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){function h(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b={type:d("WAWebMsgType").MsgKind.ReactionEncrypted,encryptedAddOn:a.encryptedReaction};b=(yield d("WAWebAddonEncryption").decryptAddOn(b,{messageSecret:a.messageSecret,iv:a.iv,stanzaId:a.stanzaId,originalMessageSender:a.originalMessageSender,addOnSender:a.reactionSender}));return d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsE2E.pb").Message$ReactionMessageSpec,b)});return i.apply(this,arguments)}function a(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=a.targetMessageKey,f=a.encIv,g=a.encPayload,i=d("WAWebAddonEncryptionError").getValidatedMessageSecret(d("WAWebMsgType").MsgKind.ReactionEncrypted,b),j=d("WAWebMsgGetters").getOriginalSender(b);if(j==null)throw new(d("WAWebReactionEncMessageValidationError").ReactionEncMessageValidationError)(d("WAWebReactionEncMessageValidationError").ReactionEncValidationErrorCode.MISSING_PARENT_MESSAGE_SENDER,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);g={encryptedReaction:g,messageSecret:i,iv:f,stanzaId:b.id.id,originalMessageSender:j,reactionSender:d("WAWebWidFactory").toUserWid(c("WANullthrows")(d("WAWebMsgGetters").getSender(a)))};var k;try{k=(yield h(g))}catch(a){throw new(d("WAWebReactionEncMessageValidationError").ReactionEncMessageValidationError)(d("WAWebReactionEncMessageValidationError").ReactionEncValidationErrorCode.DECRYPTION_FAILED,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE)}f=(i=d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(k.text))!=null?i:d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT;b=k.senderTimestampMs;if(b==null)throw new(d("WAWebReactionsValidationError").ReactionValidationError)(d("WAWebReactionsValidationError").ReactionValidationErrorCode.MISSING_TIMESTAMP,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.REACTION,kind:d("WAWebMsgType").MsgKind.ReactionDecrypted,reactionParentKey:e,reactionText:f,reactionTimestamp:d("WALongInt").numberOrThrowIfTooLarge(b),encPayload:void 0,encIv:void 0,read:!1})});return j.apply(this,arguments)}g.parseEncReaction=h;g.decryptReactionMsgData=a}),98);
__d("WAWebDBGetReactions",["WAWebApiContact","WAWebEmoji","WAWebLidMigrationUtils","WAWebModelStorageUtils","WAWebMsgKey","WAWebParseMsgKeyString","WAWebReactionsBEUtils","WAWebSchemaReactions","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaReactions").getReactionsTable().equals(["parentMsgKey"],a));var b={reactions:[],reactionByMe:null},e=new Map();a.forEach(function(a){var f=a.reactionText,g=a.orphan;if(f!==d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT&&g!==1){g=d("WAWebEmoji").EmojiUtil.getEmojiAggregate(f);f=(f=e.get(g))!=null?f:[];e.set(g,[].concat(f,[a]));g=c("WAWebParseMsgKeyString")(a.msgKey);g.fromMe&&(b.reactionByMe=a)}});var f=b.reactionByMe?d("WAWebEmoji").EmojiUtil.getEmojiAggregate(b.reactionByMe.reactionText):"";e.forEach(function(a,c){var d=!1;c===f&&(d=!0);b.reactions.push({aggregateEmoji:c,senders:a,hasReactionByMe:d})});return b});return h.apply(this,arguments)}function e(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=new Map();yield d("WAWebModelStorageUtils").getStorage().lock(["reactions"],function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];b=(yield b.anyOf(["parentMsgKey"],a));b.forEach(function(a){var b=a.reactionText,e=a.orphan;if(b!==d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT&&e!==1){e=(b=c.get(a.parentMsgKey))!=null?b:[];e.push(a);c.set(a.parentMsgKey,e)}})});return function(a){return e.apply(this,arguments)}}());return c});return i.apply(this,arguments)}function f(a){return d("WAWebModelStorageUtils").getStorage().lock(["reactions"],function(b){b=b[0];return b.anyOf(["parentMsgKey"],a)})}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,e,f=a.parentMsgKey;a=a.senderUserJid;var g=[];b=(b=d("WAWebLidMigrationUtils").getAlternateMsgKey(c("WAWebMsgKey").from(f)))==null?void 0:b.toString();e=(e=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").createUserWid(a)))==null?void 0:e.toString();f=[f,b].filter(Boolean);b=[a,e].filter(Boolean);for(a of f)for(e of b)g.push([a,e]);f=(yield d("WAWebSchemaReactions").getReactionsTable().anyOf(["parentMsgKey","senderUserJid"],g,{limit:1}));return f[0]});return k.apply(this,arguments)}g.getReactions=a;g.getFilteredReactionsFromParentMsgs=e;g.getAllReactionsFromParentMsgs=f;g.existsReactionAddressingModeInsensitive=j}),98);
__d("WAWebDBCreateOrUpdateReactions",["WAWebApiContact","WAWebLidMigrationUtils","WAWebModelStorageUtils","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){var c=new Map();a.forEach(function(a){d("WAWebUserPrefsMeUser").isSerializedWidMe(a.senderUserJid)&&(a.read=!0);var b=h(a),e=c.get(b);e?e.timestamp<=a.timestamp&&c.set(b,a):c.set(b,a)});return d("WAWebModelStorageUtils").getStorage().lock(["reactions"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=[],e=[];Array.from(c.values()).forEach(function(a){e.push([a.parentMsgKey,a.senderUserJid]);var b=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").createUserWid(a.senderUserJid));b!=null&&e.push([a.parentMsgKey,b.toString()])});var f=(yield a.anyOf(["parentMsgKey","senderUserJid"],e));f.forEach(function(a){var d=h(a),e=c.get(d);e&&(e.timestamp<=a.timestamp?c["delete"](d):e.senderUserJid!==a.senderUserJid&&b.push([a.parentMsgKey,a.senderUserJid]))});b.length>0&&(yield a.bulkRemove(b));yield a.bulkCreateOrReplace(Array.from(c.values()));return Array.from(c.values())});return function(b){return a.apply(this,arguments)}}())}function h(a){var b=d("WAWebWidFactory").createUserWid(a.senderUserJid),c=String(d("WAWebLidMigrationUtils").toPn(b));b=String(d("WAWebLidMigrationUtils").toLid(b));return a.parentMsgKey+","+c+","+b}g.createOrUpdateReactions=a}),98);
__d("WAWebDBProcessReactionsMsgs",["WAWebApiChat","WAWebBackendApi","WAWebDBCreateOrUpdateReactions","WAWebDBMarkFutureproofMessagesReparsed","WAWebLastAddOnDBSerialization","WAWebReactionsBEUtils","WAWebShouldUpdateLastAddOnPreview","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length>0){var b=(yield d("WAWebReactionsBEUtils").createReactionsRowFromMsg(a));b=(yield d("WAWebDBCreateOrUpdateReactions").createOrUpdateReactions(b));d("WAWebReactionsBEUtils").updateHasReactionFromParent(b);a=a.map(function(a){return a.id.toString()});yield d("WAWebDBMarkFutureproofMessagesReparsed").markFutureproofMessagesReparsed(a);a=(yield d("WAWebShouldUpdateLastAddOnPreview").filterChatsWithAddOnPreviewUpdates(b.map(function(a){return d("WAWebLastAddOnDBSerialization").lastAddOnPreviewCandidateFromReactionRowType(a)})));yield d("WAWebApiChat").bulkUpdateChatLastAddOnPreview(a);d("WAWebBackendApi").frontendFireAndForget("updateChatLastAddOnPreview",{chatMap:a})}});return h.apply(this,arguments)}g.processReactionMsgs=a}),98);
__d("WAWebDeleteReactionsJob",["WALogger","WAWebDBDeleteReactions","WAWebDBMessageDelete","WAWebDefinePersistedJob","WAWebMsgKey","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Persisted: Deleting reactions from Msg table for chat: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Persisted: Deleting reactions from Msg table, reactionMsgKeys is undefined, parentMsgKeys length ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Persisted: Deleting reactions from Reactions table returned undefined, parentMsgKeys length ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Persisted: Deleting reactions from Reactions table for chat: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Persisted: NOOP step for ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Persisted: deleteReaction persisted job started"]);m=function(){return a};return a}a=d("WAWebDefinePersistedJob").defineWebPersistedJob().step("deleteReactions",function(a){var b=a.chatId;a=a.parentMsgKeys;d("WALogger").LOG(m());d("WALogger").DEV(l(),b);return{chatId:b,parentMsgKeys:a}}).step("deleteReactionsFromReactionsTable",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.chatId;a=a.parentMsgKeys;d("WALogger").DEV(k(),b);b=(yield d("WAWebDBDeleteReactions").deleteReactionsByParentMessageKeys(a));if(!b){d("WALogger").LOG(j(),a.length);return[]}return b});return function(b){return a.apply(this,arguments)}}()).finalStep("deleteReactionsFromMessageTable",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=b.chatId;b=b.parentMsgKeys;var f=[];a||d("WALogger").LOG(i(),b.length);a.forEach(function(a){c("WAWebMsgKey").fromString(a).fromMe&&f.push(a)});f.length>0&&(d("WALogger").DEV(h(),e),yield d("WAWebDBMessageDelete").removeMessagesFromHistory(f,{deleteAssociatedMsgs:!1}));return a});return function(b,c){return a.apply(this,arguments)}}()).end();g.deleteReactions=a}),98);
__d("WAWebReactionsParseWebMsgInfoReaction",["WALogger","WANullthrows","WAWebAddOnParseWebMsgInfo","WAWebE2EProtoUtils","WAWebWid","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[history sync] parseWebMsgInfoReaction failed with error "," and stack ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseWebMsgInfoReaction:convertToTextWithoutSpecialEmojis reaction text is null."]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseWebMsgInfoReaction: reaction sender should be a wid."]);j=function(){return a};return a}function a(a,b){var e=[];try{if(a==null||a.reactions==null)return e;if(b==null||b.reactions==null)return e;b.reactions.forEach(function(a){var f=a.key,g=a.senderTimestampMs,h=a.text;a=a.unread;h=d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis((h=h)!=null?h:"");f=c("WANullthrows")(d("WAWebAddOnParseWebMsgInfo").buildAddonMsgKey(f));var k=f.msgKey;f=f.sender;f==null||!(f instanceof c("WAWebWid"))?d("WALogger").ERROR(j()):h==null?d("WALogger").ERROR(i()):e.push({id:k,reactionTimestamp:g,reactionText:h,reactionParentKey:b.id,sender:d("WAWebWidFactory").createWid(f.toString()),unread:k.fromMe?!1:a===!0})})}catch(a){d("WALogger").ERROR(h(),a==null?void 0:a.name,a==null?void 0:a.stack)}return e}g.parseWebMsgInfoReaction=a}),98);
__d("WAWebDBChangeOrphanStateReactions",["WAWebModelStorageUtils","WAWebSchemaReactions","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebModelStorageUtils").getStorage().lock(["reactions"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var c=a.map(function(a){return[a,1]});c=(yield d("WAWebSchemaReactions").getReactionsTable().anyOf(["parentMsgKey","orphan"],c));c.forEach(function(a){a.orphan=0,a.orphanReason=void 0});yield b.bulkCreateOrReplace(c);return c});return function(a){return c.apply(this,arguments)}}())}g.changeOrphanStateReactions=a}),98);
__d("WAWebCheckUpdateOrphanReactions",["WALogger","WAWebAddonGatingUtils","WAWebAddonProcessMsgs","WAWebBackendApi","WAWebDBChangeOrphanStateReactions","WAWebMsgType","WAWebReactionDataUtils","WAWebStoreOrphans","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["checkUpdateForOrphanReactions: error ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Updating reaction orphans"]);i=function(){return a};return a}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{a=(yield d("WAWebDBChangeOrphanStateReactions").changeOrphanStateReactions(a));d("WALogger").DEV(i()).tags("checkUpdateForOrphanReactions");if(d("WAWebAddonGatingUtils").isUnifiedInfraEnabledForType(d("WAWebMsgType").MSG_TYPE.REACTION)){var b=(yield d("WAWebAddonProcessMsgs").processMsgsAndGetOrphans(a.map(function(a){return d("WAWebReactionDataUtils").reactionRowToReactionMsgData(a)})));b=b.orphans;yield d("WAWebStoreOrphans").storeOrphans(b)}else d("WAWebBackendApi").frontendFireAndForget("checkUpdateForOrphanReactions",{updatedRecords:a})}catch(a){d("WALogger").WARN(h(),a)}});return j.apply(this,arguments)}g.checkUpdateForOrphanReactions=a}),98);
__d("WAWebReactionsParseReactionEncMessageProto",["WAWebE2EProtoUtils","WAWebMsgType","WAWebReactionEncMessageValidationError","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.encReactionMessage;if(b==null)return;var c=b.encIv,e=b.encPayload;b=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(b.targetMessageKey,a);if(b==null)throw new(d("WAWebReactionEncMessageValidationError").ReactionEncMessageValidationError)(d("WAWebReactionEncMessageValidationError").ReactionEncValidationErrorCode.MISSING_TARGET_MSG_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_PROTOCOL_BUFFER);if(c==null)throw new(d("WAWebReactionEncMessageValidationError").ReactionEncMessageValidationError)(d("WAWebReactionEncMessageValidationError").ReactionEncValidationErrorCode.INVALID_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_PROTOCOL_BUFFER);if(e==null)throw new(d("WAWebReactionEncMessageValidationError").ReactionEncMessageValidationError)(d("WAWebReactionEncMessageValidationError").ReactionEncValidationErrorCode.INVALID_ENC_PAYLOAD,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_PROTOCOL_BUFFER);return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.REACTION_ENC,kind:d("WAWebMsgType").MsgKind.ReactionEncrypted,encIv:c,encPayload:e,targetMessageKey:b}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebReactionsParseReactionMessageProto",["WALongInt","WAWebConstantsDeprecated","WAWebE2EProtoUtils","WAWebMsgType","WAWebReactionsBEUtils","WAWebReactionsValidationError","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.reactionMessage;if(b==null)return;var c=h(b),e=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(b.key,a);b=d("WALongInt").maybeNumberOrThrowIfTooLarge(b.senderTimestampMs);if(e==null)throw new(d("WAWebReactionsValidationError").ReactionValidationError)(d("WAWebReactionsValidationError").ReactionValidationErrorCode.MISSING_PARENT_MSG_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(b==null)throw new(d("WAWebReactionsValidationError").ReactionValidationError)(d("WAWebReactionsValidationError").ReactionValidationErrorCode.MISSING_TIMESTAMP,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.REACTION,kind:d("WAWebMsgType").MsgKind.ReactionDecrypted,reactionParentKey:e,reactionText:c,reactionTimestamp:b,read:!1}),contextInfo:null}}function h(a){a=a.text;if(a!=null&&a.length>c("WAWebConstantsDeprecated").REACTION_CONTENT_MAX_LENGTH)throw new(d("WAWebReactionsValidationError").ReactionValidationError)(d("WAWebReactionsValidationError").ReactionValidationErrorCode.INVALID_REACTION_TEXT_LENGTH,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_REACTION_TEXT);return(a=d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(a))!=null?a:d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT}g["default"]=a}),98);
__d("WAWebReactionDataUtils",["WANullthrows","WAWebMsgGetters","WAWebMsgKey","WAWebMsgKeyUtils","WAWebMsgType","WAWebReactionsBEUtils","WAWebViewMode.flow","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){var b=c("WAWebMsgKey").fromString(a.msgKey),e=d("WAWebMsgKeyUtils").msgKeyToTargetInfo(b,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),f=e.from,g=e.to;e=e.author;return{id:b,to:g,from:f,author:e,type:d("WAWebMsgType").MSG_TYPE.REACTION,kind:d("WAWebMsgType").MsgKind.ReactionDecrypted,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,reactionParentKey:c("WAWebMsgKey").fromString(a.parentMsgKey),reactionText:a.reactionText,reactionTimestamp:a.timestamp,t:(b=a.t)!=null?b:void 0,ack:(g=a.ack)!=null?g:void 0,read:(f=a.read)!=null?f:!1}}function b(a){var b;return{msgKey:a.id.toString(),parentMsgKey:a.reactionParentKey.toString(),senderUserJid:c("WANullthrows")(d("WAWebMsgGetters").getSender(a)).toString(),reactionText:a.reactionText,timestamp:a.reactionTimestamp,t:d("WAWebMsgGetters").getT(a),ack:(b=d("WAWebMsgGetters").getAck(a))!=null?b:void 0,orphan:0,read:a.read}}function e(a){var b=a.id,c=a.reactionTimestamp,e=a.reactionText,f=a.reactionParentKey,g=a.sender;a=a.unread;g=d("WAWebWidFactory").toUserWid(g);var h=0;return{msgKey:b.toString(),parentMsgKey:f.toString(),senderUserJid:g.toString(),reactionText:(b=e)!=null?b:d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT,timestamp:c,orphan:h,read:!a}}g.reactionRowToReactionMsgData=a;g.reactionMsgDataToReactionRow=b;g.webMsgInfoReactionTypeToReactionsRow=e}),98);
__d("WAWebReactionsBEUtils",["WALogger","WALongInt","WANullthrows","WAWebAddonQueryUtils","WAWebBotGenTypingIndicatorMsg","WAWebDBGetReactions","WAWebMessageAssociationConstants","WAWebMsgGetters","WAWebMsgKey","WAWebMsgType","WAWebPnhGatingUtils","WAWebSchemaMessage","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["createReactionsRowFromMsg: reactions not allowed for this message type ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["createReactionsRowFromMsg: sender or reactionMsg are null"]);i=function(){return a};return a}var j="",k=new Set([(f=d("WAWebMsgType")).MSG_TYPE.CIPHERTEXT,f.MSG_TYPE.REVOKED,f.MSG_TYPE.DEBUG,f.MSG_TYPE.DEBUG_PLACEHOLDER,f.MSG_TYPE.GP2,f.MSG_TYPE.NOTIFICATION,f.MSG_TYPE.NEWSLETTER_NOTIFICATION,f.MSG_TYPE.NOTIFICATION_TEMPLATE,f.MSG_TYPE.E2E_NOTIFICATION,f.MSG_TYPE.CALL_LOG]);function l(a){var b=a.type,c=a.subtype;a=a.futureproofType;if(b===d("WAWebMsgType").MSG_TYPE.UNKNOWN)return a!=null&&d("WAWebMessageAssociationConstants").orphanIneligibleFutureproofTypes.has(a);return k.has(b)||b===d("WAWebMsgType").MSG_TYPE.CHAT&&c===d("WAWebBotGenTypingIndicatorMsg").BOT_TYPING_PLACEHOLDER_MSG_SUBTYPE?!1:!0}function a(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[],e=[];a.forEach(function(a){a&&e.push(a.reactionParentKey)});var f=new Map();d("WAWebPnhGatingUtils").isMatFullyEnabled()&&a.forEach(function(a){var b=a.reactionParentKey,g=d("WAWebMsgGetters").getOriginalSender(a);if(b!=null&&g!=null&&b.remote.isUser()&&!c("WAWebWid").equals(g,b.remote)){b=c("WAWebMsgKey").from({fromMe:b.fromMe,id:b.id,participant:b.participant,remote:g});e.push(b);f.set(a.reactionParentKey.remote,b.toString())}});var g=(yield d("WAWebAddonQueryUtils").getParentMsgsByMsgKey(e));a.forEach(function(a){var e;e=(e=a.author)!=null?e:a.from;if(!e||!a){d("WALogger").WARN(i());return}var k=g.get(a.reactionParentKey.toString());if(d("WAWebPnhGatingUtils").isMatFullyEnabled()&&!k){var m=f.get(a.reactionParentKey.remote);m!=null&&(k=g.get(m))}if(k&&!l(k)){d("WALogger").WARN(h(),k.type);return}m=d("WAWebWidFactory").toUserWid(e);k={msgKey:a.id.toString(),parentMsgKey:(k=(e=k)==null?void 0:e.id.toString())!=null?k:a.reactionParentKey.toString(),senderUserJid:m.toString(),reactionText:(e=a.reactionText)!=null?e:j,timestamp:a.reactionTimestamp,orphan:0,orphanReason:void 0,read:!1,t:c("WANullthrows")(d("WALongInt").maybeNumberOrThrowIfTooLarge(a.t))};b.push(k)});return b});return m.apply(this,arguments)}function e(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[],c=[];a.forEach(function(a){var d=a.parentMsgKey,e=a.orphan;a=a.reactionText;if(e!==1)if(a!==j){e={id:d,hasReaction:!0};c.push(e)}else b.push(d)});var e=(yield d("WAWebDBGetReactions").getFilteredReactionsFromParentMsgs(b));b.forEach(function(a){var b=e.get(a);b=b&&b.length>0||!1;a={id:a,hasReaction:b};c.push(a)});return d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(c)});return n.apply(this,arguments)}g.REVOKED_REACTION_TEXT=j;g.canHaveReactions=l;g.createReactionsRowFromMsg=a;g.updateHasReactionFromParent=e}),98);
__d("WAWebParseProtocolAdminRevokeMessageProto",["WAWebAck","WAWebProtocolRevokeMessageUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage,e=a.editAttr,f=a.msgContext;a=a.msgMeta;if(e!==d("WAWebAck").EDIT_ATTR.ADMIN_REVOKE)return;return d("WAWebProtocolRevokeMessageUtils").parseProtocolRevokeMessageProto({messageProtobuf:b,baseMessage:c,editAttr:e,msgContext:f,msgMeta:a})}g["default"]=a}),98);
__d("WAWebParseProtocolSenderRevokeMessageProto",["WAWebAck","WAWebProtocolRevokeMessageUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage,e=a.editAttr,f=a.msgContext;a=a.msgMeta;if(e!==d("WAWebAck").EDIT_ATTR.SENDER_REVOKE)return;return d("WAWebProtocolRevokeMessageUtils").parseProtocolRevokeMessageProto({messageProtobuf:b,baseMessage:c,editAttr:e,msgContext:f,msgMeta:a})}g["default"]=a}),98);
__d("WAWebProtocolRevokeMessageUtils",["WALogger","WAWebAck","WAWebE2EProtoUtils","WAWebHandleMsgError","WAWebHandleMsgMetaUtils","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["parseProtocolRevokeMessageProto: error:",", stack: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["missing a revoke message key "," (",") for "," from "," for ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["found comment revoke"]);j=function(){return a};return a}var k=function(b){babelHelpers.inheritsLoose(a,b);function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(a=c=b.call.apply(b,[this].concat(e))||this,c.name="ProtocolRevokeMessageValidationError",a)||babelHelpers.assertThisInitialized(c)}return a}(d("WAWebHandleMsgError").MessageValidationError);function a(a){var b=a.messageProtobuf,c=a.baseMessage,e=a.editAttr,f=a.msgContext;a=a.msgMeta;b=b.protocolMessage;if(b==null)return;var g=b.type;b=b.key;if(f!=="relay"&&g!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.EPHEMERAL_SETTING)return;if(g!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REVOKE)return;((f=c.author)==null?void 0:f.isLid())&&d("WAWebHandleMsgMetaUtils").isCommentMsgMeta(a)?(d("WALogger").LOG(j()),f=d("WAWebE2EProtoUtils").translateAddonMessageKeyToLocalReference(b,c)):f=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(b,c);if(f==null){d("WALogger").LOG(i(),b==null?void 0:b.id,Boolean(b),c.id,c.author,g);throw new k("protocol_revoke_missing_key",d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_PROTOCOL_BUFFER)}if(e===d("WAWebAck").EDIT_ATTR.ADMIN_REVOKE)a="admin_revoke";else if(e===d("WAWebAck").EDIT_ATTR.SENDER_REVOKE)a="sender_revoke";else throw new k("protocol_revoke_missing_edit_attr",d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_PROTOCOL_BUFFER);try{return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.ProtocolRevoke,subtype:a,protocolMessageKey:f}),contextInfo:null}}catch(a){d("WALogger").WARN(h(),a==null?void 0:a.name,a==null?void 0:a.stack).tags("messaging").sendLogs("ProtocolRevokeParseError");throw a}}g.ProtocolRevokeMessageValidationError=k;g.parseProtocolRevokeMessageProto=a}),98);
__d("WAWebGenerateImageReportingTokenContent",["WAWebReportingTokenUtils"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebReportingTokenUtils").getMediaReportingTokenContent(a)}g["default"]=a}),98);
__d("WAWebGenerateVideoReportingTokenContent",["WAWebReportingTokenUtils"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebReportingTokenUtils").getMediaReportingTokenContent(a)}g["default"]=a}),98);
__d("WAWebParseImageMessageProto",["WALongInt","WATimeUtils","WAWebAssociationProtoUtils","WAWebE2EProtoParserApi","WAWebE2EProtoUtils","WAWebMediaMessageGetValidatedProperties","WAWebMessageAssociationGatingUtils","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage,e=a.msgContext,f=a.messageAssociation;a=a.msgMeta;b=b.imageMessage;if(b==null)return;var g=b.directPath,h=b.staticUrl,i=b.mimetype,j=b.caption,k=b.height,l=b.width,m=b.mediaKeyTimestamp,n=b.jpegThumbnail,o=b.scanLengths,p=b.scansSidecar,q=b.viewOnce,r=b.thumbnailDirectPath,s=b.thumbnailSha256,t=b.thumbnailEncSha256,u=b.contextInfo,v=b.annotations;e=d("WAWebMediaMessageGetValidatedProperties").getValidatedMediaMessageProperties(b,c,e,d("WAWebMsgType").MSG_TYPE.IMAGE);var w=e.mediaKey,x=e.fileSha256,y=e.fileEncSha256,z=e.fileLength;e=e.url;e=babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.IMAGE,kind:d("WAWebMsgType").MsgKind.Image,deprecatedMms3Url:d("WAWebE2EProtoParserApi").decodeUrl(e),directPath:g||"",staticUrl:h||"",mimetype:i||"",caption:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(j),filehash:d("WAWebE2EProtoParserApi").decodeBytes(x),encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(y),size:z,height:k||0,width:l||0,mediaKey:d("WAWebE2EProtoParserApi").decodeBytes(w),mediaKeyTimestamp:m!=null?d("WALongInt").numberOrThrowIfTooLarge(m):d("WATimeUtils").unixTime(),body:d("WAWebE2EProtoParserApi").decodeBytes(n)||"",interactiveAnnotations:v,scanLengths:o,scansSidecar:p,isViewOnce:q===!0,thumbnailDirectPath:r,thumbnailSha256:d("WAWebE2EProtoParserApi").decodeBytes(s),thumbnailEncSha256:d("WAWebE2EProtoParserApi").decodeBytes(t),statusMentioned:a==null?void 0:a.statusMentioned});d("WAWebE2EProtoParserApi").validateRequiredMediaProperties(e,b);if(f&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){g=d("WAWebAssociationProtoUtils").getValidatedAssociationFieldsFromProto(f,c);h=g.associationParentMsgKey;i=g.associationType;j=g.viewMode;x=babelHelpers["extends"]({},e,{kind:"associatedImage",parentMsgKey:h,associationType:i,viewMode:j});return{msgData:x,contextInfo:u}}return{msgData:e,contextInfo:u}}g["default"]=a}),98);
__d("WAWebParseVideoMessageProto",["WALongInt","WATimeUtils","WAWebAssociationProtoUtils","WAWebE2EProtoParserApi","WAWebE2EProtoUtils","WAWebMediaMessageGetValidatedProperties","WAWebMessageAssociationGatingUtils","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage,e=a.msgContext,f=a.messageAssociation;a=a.msgMeta;b=b.videoMessage;if(b==null)return;var g=b.directPath,h=b.staticUrl,i=b.mimetype,j=b.caption,k=b.height,l=b.width,m=b.mediaKeyTimestamp,n=b.jpegThumbnail,o=b.viewOnce,p=b.thumbnailDirectPath,q=b.thumbnailSha256,r=b.thumbnailEncSha256,s=b.contextInfo,t=b.gifPlayback,u=b.gifAttribution,v=b.seconds,w=b.streamingSidecar,x=b.annotations;e=d("WAWebMediaMessageGetValidatedProperties").getValidatedMediaMessageProperties(b,c,e,d("WAWebMsgType").MSG_TYPE.VIDEO);var y=e.mediaKey,z=e.fileSha256,A=e.fileEncSha256,B=e.fileLength;e=e.url;e=babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.VIDEO,kind:d("WAWebMsgType").MsgKind.Video,deprecatedMms3Url:d("WAWebE2EProtoParserApi").decodeUrl(e),directPath:g,staticUrl:h||"",mimetype:i,caption:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(j),filehash:d("WAWebE2EProtoParserApi").decodeBytes(z),encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(A),size:B,height:k,width:l,mediaKey:d("WAWebE2EProtoParserApi").decodeBytes(y),mediaKeyTimestamp:m!=null?d("WALongInt").numberOrThrowIfTooLarge(m):d("WATimeUtils").unixTime(),duration:""+(v||0),body:d("WAWebE2EProtoParserApi").decodeBytes(n)||"",interactiveAnnotations:x,isViewOnce:o===!0,thumbnailDirectPath:p,thumbnailSha256:d("WAWebE2EProtoParserApi").decodeBytes(q),thumbnailEncSha256:d("WAWebE2EProtoParserApi").decodeBytes(r),isGif:t,gifAttribution:u,streamingSidecar:w,statusMentioned:a==null?void 0:a.statusMentioned});d("WAWebE2EProtoParserApi").validateRequiredMediaProperties(e,b);if(f&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){g=d("WAWebAssociationProtoUtils").getValidatedAssociationFieldsFromProto(f,c);h=g.associationParentMsgKey;i=g.associationType;j=g.viewMode;z=babelHelpers["extends"]({},e,{kind:"associatedVideo",parentMsgKey:h,associationType:i,viewMode:j});return{msgData:z,contextInfo:s}}return{msgData:e,contextInfo:s}}g["default"]=a}),98);
__d("WAWebStickerPackGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("receive_sticker_pack")}g.isStickerPackReceivingEnabled=a}),98);
__d("WAWebParseStickerPackMessageProto",["WALongInt","WATimeUtils","WAWebE2EProtoParserApi","WAWebMediaMessageGetValidatedProperties","WAWebMsgType","WAWebStickerPackGatingUtils"],(function(a,b,c,d,e,f,g){function a(a){var b,c=a.messageProtobuf,e=a.baseMessage;a=a.msgContext;c=c.stickerPackMessage;if(c==null)return null;if(!d("WAWebStickerPackGatingUtils").isStickerPackReceivingEnabled())return{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,futureproofType:d("WAWebMsgType").MSG_TYPE.STICKER_PACK}),contextInfo:null};var f=c.caption;a=d("WAWebMediaMessageGetValidatedProperties").getValidatedMediaMessageProperties(c,e,a,d("WAWebMsgType").MSG_TYPE.STICKER_PACK);var g=a.mediaKey,h=a.fileSha256,i=a.fileEncSha256;a=a.url;var j=[];(b=c.stickers)==null?void 0:b.forEach(function(a){j.push({fileName:a.fileName,emojis:a.emojis,isLottie:a.isLottie,mimetype:a.mimetype,isAnimated:a.isAnimated})});a=babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.STICKER_PACK,kind:d("WAWebMsgType").MsgKind.StickerPack,caption:f,deprecatedMms3Url:d("WAWebE2EProtoParserApi").decodeUrl(a),description:c.packDescription,isCaptionByUser:f!=null,filename:c.name,filehash:d("WAWebE2EProtoParserApi").decodeBytes(h),encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(i),mediaKey:d("WAWebE2EProtoParserApi").decodeBytes(g),directPath:c.directPath,stickerPackId:c.stickerPackId,thumbnailDirectPath:c.thumbnailDirectPath,thumbnailSha256:d("WAWebE2EProtoParserApi").decodeBytes(c.thumbnailSha256),thumbnailEncSha256:d("WAWebE2EProtoParserApi").decodeBytes(c.thumbnailEncSha256),mediaKeyTimestamp:c.mediaKeyTimestamp!=null?d("WALongInt").numberOrThrowIfTooLarge(c.mediaKeyTimestamp):d("WATimeUtils").unixTime(),stickers:j,stickerPackPublisher:c.publisher,stickerPackSize:d("WALongInt").numberOrThrowIfTooLarge((b=c.stickerPackSize)!=null?b:0),trayIconFileName:c.trayIconFileName,size:d("WALongInt").numberOrThrowIfTooLarge((e=c.fileLength)!=null?e:0)});return{msgData:a,contextInfo:null}}g["default"]=a}),98);
__d("WAWebGenerateStickerReportingTokenContent",["WAWebReportingTokenUtils"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebReportingTokenUtils").getMediaReportingTokenContent(a)}g["default"]=a}),98);
__d("WABase64Sanitize",["WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["base64 sanitized due to extra whitespace"]);h=function(){return a};return a}function a(a){if(a==null)return null;var b=a.replace(/\s+$/,"");a!==b&&Math.random()<1e-5&&d("WALogger").WARN(h()).sendLogs("media-key-sanitize");return b}g["default"]=a}),98);
__d("WAWebStickersParseStickerMessageProto",["WABase64Sanitize","WALongInt","WATimeUtils","WAWebE2EProtoParserApi","WAWebLottieStickersGatingUtils","WAWebMediaMessageGetValidatedProperties","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,e=a.baseMessage;a=a.msgContext;var f=b==null?void 0:b.lottieStickerMessage;f=f==null?void 0:(f=f.message)==null?void 0:f.stickerMessage;b=b==null?void 0:b.stickerMessage;if(f!=null){if(!d("WAWebLottieStickersGatingUtils").isLottieStickerReceivingEnabled())return{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,futureproofType:d("WAWebMsgType").MSG_TYPE.STICKER}),contextInfo:f==null?void 0:f.contextInfo};b=f}if(b==null)return;f=d("WAWebMediaMessageGetValidatedProperties").getValidatedMediaMessageProperties(b,e,a,d("WAWebMsgType").MSG_TYPE.STICKER);a=f.mediaKey;var g=f.fileSha256,h=f.fileEncSha256;f=f.url;e=babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.STICKER,kind:d("WAWebMsgType").MsgKind.Sticker,deprecatedMms3Url:d("WAWebE2EProtoParserApi").decodeUrl(f),directPath:b.directPath||"",mimetype:b.mimetype||"",filehash:d("WAWebE2EProtoParserApi").decodeBytes(g),encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(h),mediaKey:c("WABase64Sanitize")(d("WAWebE2EProtoParserApi").decodeBytes(a)),mediaKeyTimestamp:b.mediaKeyTimestamp!=null?d("WALongInt").numberOrThrowIfTooLarge(b.mediaKeyTimestamp):d("WATimeUtils").unixTime(),height:b.height||0,width:b.width||0,firstFrameLength:b.firstFrameLength,firstFrameSidecar:b.firstFrameSidecar,isAnimated:b.isAnimated,isLottie:b.isLottie,stickerSentTs:d("WALongInt").maybeNumberOrThrowIfTooLarge(b.stickerSentTs),isAvatar:b.isAvatar});d("WAWebE2EProtoParserApi").validateRequiredMediaProperties(e,b);return{msgData:e,contextInfo:b.contextInfo}}g["default"]=a}),98);
__d("WAWebHiddenViewModeProcessor",["WAWebCreateViewModeProcessor","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){a=d("WAWebCreateViewModeProcessor").createFullyHiddenViewModeProcessor({type:d("WAWebViewMode.flow").ViewModeType.HIDDEN});b=a;g["default"]=b}),98);
__d("WAWebInvisiblePlaceholderViewModeProcessor",["WAWebCreateViewModeProcessor","WAWebMsgType","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){a=d("WAWebCreateViewModeProcessor").createFullyHiddenViewModeProcessor({type:d("WAWebViewMode.flow").ViewModeType.INVISIBLE_PLACEHOLDER,compatibleMessageTypes:[d("WAWebMsgType").MSG_TYPE.ALBUM]});g.InvisiblePlaceholderViewModeProcessor=a}),98);
__d("WAWebMediaAlbumViewModeProcessor",["WAWebAlbumsGatingUtils","WAWebCreateViewModeProcessor","WAWebMsgType","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){a=d("WAWebCreateViewModeProcessor").createViewModeProcessor({type:d("WAWebViewMode.flow").ViewModeType.MEDIA_ALBUM,compatibleMessageTypes:[d("WAWebMsgType").MSG_TYPE.IMAGE,d("WAWebMsgType").MSG_TYPE.VIDEO],messageVisibleInChat:function(){return!d("WAWebAlbumsGatingUtils").isAlbumsReceivingEnabled()},messageVisibleInChatlistPreview:function(){return!d("WAWebAlbumsGatingUtils").isAlbumsReceivingEnabled()},shouldShowInNotification:function(){return!d("WAWebAlbumsGatingUtils").isAlbumsReceivingEnabled()},shouldShowInSearch:function(){return!0}});g.mediaAlbumViewModeProcessor=a}),98);
__d("WAWebVisibleViewModeProcessor",["WAWebCreateViewModeProcessor","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){a=d("WAWebCreateViewModeProcessor").createFullyVisibleViewModeProcessor({type:d("WAWebViewMode.flow").ViewModeType.VISIBLE});b=a;g["default"]=b}),98);
__d("WAWebViewModeProcessor",["WAWebABProps","WAWebHiddenViewModeProcessor","WAWebInvisiblePlaceholderViewModeProcessor","WAWebMediaAlbumViewModeProcessor","WAWebNewsletterTombstoneViewModeProcessor","WAWebViewMode.flow","WAWebVisibleViewModeProcessor"],(function(a,b,c,d,e,f,g){function a(a){if(a==null||!d("WAWebABProps").getABPropConfigValue("web_view_mode_usage_enabled"))return c("WAWebVisibleViewModeProcessor");switch(a){case d("WAWebViewMode.flow").ViewModeType.VISIBLE:return c("WAWebVisibleViewModeProcessor");case d("WAWebViewMode.flow").ViewModeType.HIDDEN:return c("WAWebHiddenViewModeProcessor");case d("WAWebViewMode.flow").ViewModeType.MEDIA_ALBUM:return d("WAWebMediaAlbumViewModeProcessor").mediaAlbumViewModeProcessor;case d("WAWebViewMode.flow").ViewModeType.INVISIBLE_PLACEHOLDER:return d("WAWebInvisiblePlaceholderViewModeProcessor").InvisiblePlaceholderViewModeProcessor;case d("WAWebViewMode.flow").ViewModeType.NEWSLETTER_TOMBSTONE:return c("WAWebNewsletterTombstoneViewModeProcessor")}}g.getViewModeProcessor=a}),98);
__d("WAWebViewModeUtils",["WAWebViewMode.flow","WAWebViewModeProcessor"],(function(a,b,c,d,e,f,g){function a(a,b){b=d("WAWebViewModeProcessor").getViewModeProcessor(b);switch(a){case d("WAWebViewMode.flow").ViewModeSurface.CHAT:return b.messageVisibleInChat();case d("WAWebViewMode.flow").ViewModeSurface.SEARCH:return b.shouldShowInSearch();case d("WAWebViewMode.flow").ViewModeSurface.CHAT_LIST:return b.messageVisibleInChatlistPreview();case d("WAWebViewMode.flow").ViewModeSurface.NOTIFICATION:return b.shouldShowInNotification()}}g.isViewModeVisibleInSurface=a}),98);
__d("WAWebBizUpdateVerifiedInfoAction",["WAWebApiVerifiedBusinessName","WAWebBackendApi","WAWebHandlePrivacyModeUpdateMsgAction","WAWebQueryExistsJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=b.name,e=b.level,f=b.isApi,g=b.isSmb,h=b.serial;b=b.privacyMode;b!=null&&(yield d("WAWebHandlePrivacyModeUpdateMsgAction").handlePrivacyModeTransition(a,b,{bypassVerifiedNameUpdate:!0}));d("WAWebBackendApi").frontendFireAndForget("updateContactWithVerifiedName",{contactId:a,verifiedNameInfo:{id:a,name:c,level:e,isApi:f,isSmb:g,privacyMode:b}});yield d("WAWebApiVerifiedBusinessName").createOrUpdateVerifiedBusinessNameLidAware(a,{level:e,serial:h,name:c,isApi:f,isSmb:g,privacyMode:b?{actualActors:b.actualActors,hostStorage:b.hostStorage,privacyModeTs:b.privacyModeTs}:null})});return i.apply(this,arguments)}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebQueryExistsJob").queryWidExists(a));if(b==null)return;b=b.bizInfo;b&&(yield h(a,b.verifiedName))});return j.apply(this,arguments)}g.updateVerifiedInfo=h;g.queryAndUpdateContactPropertiesOnNewChat=a}),98);
__d("WAWebPrivacyModeSystemMsg",["$InternalEnum","WAWebHandleMsgTypes.flow"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum").Mirrored(["E2EE","BSP","FB","HOSTED_GROUP"]);function a(a){if(a==null||a.actualActors===d("WAWebHandleMsgTypes.flow").ActualActorsEnumType.Self&&a.hostStorage===d("WAWebHandleMsgTypes.flow").HostStorageEnumType.OnPremise)return h.E2EE;else if(a.actualActors===d("WAWebHandleMsgTypes.flow").ActualActorsEnumType.Capi)return h.HOSTED_GROUP;else if(a.hostStorage===d("WAWebHandleMsgTypes.flow").HostStorageEnumType.Facebook)return h.FB;return h.BSP}function c(a,b){if(a==null)return b;return b==null?a:a.privacyModeTs>b.privacyModeTs?a:b}function e(a,b){if(a==null&&b==null)return 0;if(b==null)return 1;return a==null?-1:a.privacyModeTs-b.privacyModeTs}function f(a){var b;b=(b=a.bizInfo)==null?void 0:b.verifiedName;return b==null?null:a.biz&&b.isApi===!0?b.privacyMode:null}g.ReducedPrivacyMode=h;g.getReducedPrivacyMode=a;g.getLatestPrivacyMode=c;g.comparePrivacyMode=e;g.getPrivacyModeFromQueryExistResponse=f}),98);
__d("WAWebBizCreateBizStateChangeNotificationMsgsAction",["WAWebBackendApi","WAWebContactSystemMsg","WAWebPrivacyModeSystemMsg","WAWebUserPrefsNotifications","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b,c){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=k(b);c=k(c);b=[j(a,b,c),i(a,b,c)].filter(Boolean);d("WAWebBackendApi").frontendFireAndForget("updatePrivacySystemMessages",{wid:a,systemMsgs:b})});return h.apply(this,arguments)}function i(a,b,c){if(d("WAWebUserPrefsNotifications").getGlobalSecurityNotifications()!==!0)return;if(b===d("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.E2EE&&c!==d("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.E2EE)return d("WAWebContactSystemMsg").genEncryptNotificationMsg(a,"e2e_identity_unavailable")}function j(a,b,c){if(b===c)return;switch(c){case d("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.E2EE:return d("WAWebContactSystemMsg").genEncryptNotificationMsg(a,"encrypt_now");case d("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.BSP:return d("WAWebContactSystemMsg").genNonE2ENotificationMsg(a,"biz_privacy_mode_to_bsp");case d("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.FB:return d("WAWebContactSystemMsg").genNonE2ENotificationMsg(a,"biz_privacy_mode_to_fb");case d("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.HOSTED_GROUP:return d("WAWebContactSystemMsg").genNonE2ENotificationMsg(a,"is_capi_hosted_group")}}function k(a){return d("WAWebPrivacyModeSystemMsg").getReducedPrivacyMode(a.isBusiness?a.privacyMode:null)}g["default"]=a}),98);
__d("WAWebHandlePrivacyModeUpdateMsgAction",["Promise","WAWebApiChat","WAWebApiVerifiedBusinessName","WAWebBackendApi","WAWebBizCreateBizStateChangeNotificationMsgsAction","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a,b,c){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g;f===void 0&&(f={});if(!a.isUserNotPSA()||a.isCAPISupportAccount())return;var i=(yield j(a,f.chat));if(i==null)return;if(i.isBusiness===!1)return;if(i.privacyMode==null&&e==null)return;if(i.privacyMode!=null&&e!=null&&i.privacyMode.privacyModeTs>=e.privacyModeTs)return;f=f;f=f.bypassVerifiedNameUpdate;f=f===void 0?!1:f;g={isBusiness:(g=i.isBusiness)!=null?g:!1,privacyMode:i.privacyMode};i={isBusiness:!0,privacyMode:e};d("WAWebBackendApi").frontendFireAndForget("updateBusinessInfo",{contactId:a,businessInfo:{isBusiness:!0,isEnterprise:!0,privacyMode:e}});yield (h||(h=b("Promise"))).all([f?null:d("WAWebApiVerifiedBusinessName").createOrUpdateVerifiedBusinessNameLidAware(a,{isApi:!0,isSmb:!1,privacyMode:e?{actualActors:e.actualActors,hostStorage:e.hostStorage,privacyModeTs:e.privacyModeTs}:null},d("WAWebApiVerifiedBusinessName").VerifiedBusinessNameUpdateType.Merge),c("WAWebBizCreateBizStateChangeNotificationMsgsAction")(a,g,i)])});return i.apply(this,arguments)}function j(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){if(c!=null){var e=c.contact.isBusiness;return{isBusiness:e,privacyMode:e?c.contact.privacyMode:null}}e=(yield (h||(h=b("Promise"))).all([d("WAWebApiChat").getChatRecord(a),d("WAWebApiVerifiedBusinessName").getVerifiedBusinessNameRecordLidAware(a)]));c=e[0];a=e[1];if(c==null)return null;return a==null?{isBusiness:null}:{isBusiness:!0,privacyMode:a.privacyMode==null?null:d("WAWebApiVerifiedBusinessName").convertPrivacyModeFromStorageType(a.privacyMode)}});return k.apply(this,arguments)}g.handlePrivacyModeTransition=a;g.getChatInfo=j}),98);
__d("WAWebNuxAction",["Promise","WAWebNux","WAWebNuxSync","WAWebUserPrefsNuxPreferences"],(function(a,b,c,d,e,f,g){var h;function i(){return{views:0}}function j(a,e){e===void 0&&(e=!1);var f=d("WAWebUserPrefsNuxPreferences").getNUX(a);f=(f=f)!=null?f:i();var g=d("WAWebUserPrefsNuxPreferences").getNuxMaxViews(a);e=e?g:f.views+1;d("WAWebUserPrefsNuxPreferences").setNUX(a,{views:e});if(e>=g){f=d("WAWebNux").getNuxSyncKey(a);if(f!=null)return c("WAWebNuxSync").acknowledgeNux(f)}return(h||(h=b("Promise"))).resolve()}function a(a){return j(a,!0)}function e(a){d("WAWebUserPrefsNuxPreferences").removeNUX(a);a=d("WAWebNux").getNuxSyncKey(a);return a!=null?c("WAWebNuxSync").unAcknowledgeNux(a):(h||(h=b("Promise"))).resolve()}g.viewNux=j;g.dismissNux=a;g.resetNux=e}),98);
__d("WAWebPrimaryFeaturesModel",["WAWebBaseModel"],(function(a,b,c,d,e,f,g){a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=c=a.call.apply(a,[this].concat(f))||this,c.features=d("WAWebBaseModel").prop(),c.ddmSettings=d("WAWebBaseModel").prop(!1),c.clearAndDeleteChatSync=d("WAWebBaseModel").prop(!1),c.viewOnceSpReceiver=d("WAWebBaseModel").prop(!1),c.recentSticker=d("WAWebBaseModel").prop(!1),c.favoriteSticker=d("WAWebBaseModel").prop(!1),c.linkPreview=d("WAWebBaseModel").prop(!1),c.hqLinkPreview=d("WAWebBaseModel").prop(!1),c.pollCreationInCags=d("WAWebBaseModel").prop(!1),c.newsletter=d("WAWebBaseModel").prop(!1),c.externalWebBetaOptIn=d("WAWebBaseModel").prop(!1),c.historySyncOnDemand=d("WAWebBaseModel").prop(!1),c.webLinkPreviewNseSupport=d("WAWebBaseModel").prop(!1),c.messagePlaceholderResendNseSupport=d("WAWebBaseModel").prop(!1),c.isPrimaryBetaBuild=d("WAWebBaseModel").prop(!1),c.primaryCampaignIdInHistorySyncSupport=d("WAWebBaseModel").prop(!1),c.contactManagement=d("WAWebBaseModel").prop(!1),c.paymentInfoSyncSupport=d("WAWebBaseModel").prop(!1),c.customPaymentMethodsSyncSupport=d("WAWebBaseModel").prop(!1),c.merchantPaymentPartnerSyncSupport=d("WAWebBaseModel").prop(!1),c.isContactsBackupOn=d("WAWebBaseModel").prop(!1),c.primaryHasAddressbookPermission=d("WAWebBaseModel").prop(!1),c.primaryHasAgreedToNativeContactsNux=d("WAWebBaseModel").prop(!1),c.isAccountIntegrityStatePending=d("WAWebBaseModel").prop(!1),c.isAccountIntegrityStateTimelock=d("WAWebBaseModel").prop(!1),b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.setPrimaryFeatures=function(a){this.features=a;a=new Set(a);this.ddmSettings=a.has("ddm_settings");this.clearAndDeleteChatSync=a.has("clear_and_delete_chat_sync");this.viewOnceSpReceiver=a.has("vo_sp_receiver");this.recentSticker=a.has("recent_sticker");this.favoriteSticker=a.has("favorite_sticker");this.linkPreview=a.has("link_preview");this.hqLinkPreview=a.has("link_preview_hq_thumbnail");this.pollCreationInCags=a.has("poll_creation_cag");this.newsletter=a.has("newsletter");this.externalWebBetaOptIn=a.has("external_web_beta_opt_in");this.historySyncOnDemand=a.has("history_sync_on_demand");this.webLinkPreviewNseSupport=a.has("web_link_preview_nse_support");this.messagePlaceholderResendNseSupport=a.has("message_placeholder_resend_nse_support");this.isPrimaryBetaBuild=a.has("is_primary_beta_build");this.primaryCampaignIdInHistorySyncSupport=a.has("primary_campaign_id_in_history_sync_support");this.contactManagement=a.has("contact_management");this.paymentInfoSyncSupport=a.has("payment_info_sync_support");this.customPaymentMethodsSyncSupport=a.has("custom_payment_methods_sync_support");this.isContactsBackupOn=a.has("is_contacts_backup_on");this.primaryHasAddressbookPermission=a.has("primary_has_addressbook_permission");this.primaryHasAgreedToNativeContactsNux=a.has("primary_has_agreed_to_native_contacts_nux");this.isAccountIntegrityStatePending=a.has("is_account_integrity_state_pending");this.isAccountIntegrityStateTimelock=a.has("is_account_integrity_state_timelock");this.merchantPaymentPartnerSyncSupport=a.has("merchant_payment_partner_sync_support")};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="primaryFeatures";b=d("WAWebBaseModel").defineModel(a);c=new b({id:"1"});g.PrimaryFeatures=c}),98);
__d("WAWebComposeBoxActions",["WAWebEventEmitter","WAWebStateUtils"],(function(a,b,c,d,e,f,g){a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.focus=function(a){a=d("WAWebStateUtils").unproxy(a);a?this.trigger("focus_"+a.id.toString()):this.trigger("focus")};c.send=function(a){a=d("WAWebStateUtils").unproxy(a);this.trigger("send_"+a.id.toString())};c.paste=function(a,b,c){if(a){a=d("WAWebStateUtils").unproxy(a);this.trigger("paste_"+a.id.toString(),b,c)}else this.trigger("paste",b,c)};c.sendPaste=function(a,b){a=d("WAWebStateUtils").unproxy(a);this.trigger("send_paste_"+a.id.toString(),b)};c.toggleQuickReplies=function(){this.trigger("toggle_quick_replies")};c.addMsgSendingLogAttributes=function(a,b){this.trigger("add_sending_log_attributes_"+a.id.toString(),b)};c.setCtwaContextLinkData=function(a,b){this.trigger("set_ctwa_context_link_data_"+a.id.toString(),b)};c.setTextContent=function(a,b){this.trigger("set_text_content_"+a.id.toString(),b)};return b}(c("WAWebEventEmitter"));b=new a();g.ComposeBoxActions=b}),98);
__d("WAWebCurrentUser",["WAWebABProps","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("gkx")("26258")===!1||d("WAWebABProps").getABPropConfigValue("is_meta_employee_or_internal_tester")}g.isEmployee=a}),98);
__d("WAWebDocumentFlushed",["Promise","WAAbortError","once"],(function(a,b,c,d,e,f,g){var h,i=[],j=c("once")(function(){return new AbortController().signal});function k(){while(i.length>0){var a=i.shift();a()}}function l(){var a,b=window.requestAnimationFrame(function(){a=self.setTimeout(function(){k()},0)});return function(){window.cancelAnimationFrame(b),self.clearTimeout(a)}}function a(a){var c=(a=a==null?void 0:a.signal)!=null?a:j();return new(h||(h=b("Promise")))(function(a,b){if(c.aborted){b(new(d("WAAbortError").AbortError)());return}var e;function f(){c.removeEventListener("abort",h);var a=i.indexOf(g);a!==-1&&i.splice(a,1);i.length===0&&e!=null&&(e(),e=null)}function g(){f(),a()}function h(){f(),b(new(d("WAAbortError").AbortError)())}i.push(g);c.addEventListener("abort",h);i.length===1&&(e=l())})}e=function(){k();return(h||(h=b("Promise"))).resolve()};g.documentFlushed=a;g.resolveAllForTestingOnly=e}),98);
__d("WAWebMain.scss",["cx"],(function(a,b,c,d,e,f,g,h){a={"-viewport-width-stop-xl":"1300px;","-viewport-width-stop-l":"1024px;","-viewport-width-stop-m":"900px;",app:"_aigs",skipGlobalPaneStyles:"_as6h",paneThree:"_aig-",paneOne:"_aigw",paneThreeWithNavBarExpanded:"_as5a"};b=a;g["default"]=b}),98);
__d("WAWebStylePropertiesDeprecated",[],(function(a,b,c,d,e,f){function g(a,b){return a[b]}function a(a,b){return parseInt(g(a,b),10)}function b(a,b){return parseFloat(g(a,b))}f.getIntFromStylesProp=a;f.getFloatFromStylesProp=b}),66);
__d("WAWebDrawerManager",["Promise","WAWebEventEmitter","WAWebMain.scss","WAWebStylePropertiesDeprecated"],(function(a,b,c,d,e,f,g){var h,i=d("WAWebStylePropertiesDeprecated").getIntFromStylesProp(c("WAWebMain.scss"),"-viewport-width-stop-xl");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.setDrawerContext=function(a,b){this.trigger("update_context_"+a,b)};d.openDrawerRight=function(a,b){this.trigger("open_drawer_right",a,b)};d.openDrawerMid=function(a,b){this.trigger("open_drawer_mid",a,b)};d.openDrawerLeft=function(a,b){this.trigger("open_drawer_left",a,b)};d.existsDrawerRight=function(a){this.trigger("exists_drawer_right",a)};d.existsDrawerMid=function(a){this.trigger("exists_drawer_mid",a)};d.existsDrawerLeft=function(a){this.trigger("exists_drawer_left",a)};d.closeDrawerRight=function(){this.trigger("close_drawer_right")};d.closeDrawerMid=function(){this.trigger("close_drawer_mid")};d.closeDrawerLeft=function(){this.trigger("close_drawer_left")};d.isDrawerRightOverlappingCoversationPanel=function(){var a=this;return new(h||(h=b("Promise")))(function(b){a.existsDrawerRight(function(a){b(a&&window.matchMedia("(max-width: "+i+"px)").matches)})})};return c}(c("WAWebEventEmitter"));e=new a();g.DrawerManager=e}),98);
__d("WAWebWamEnumWebcRuntimeEnvCode",[],(function(a,b,c,d,e,f){a=Object.freeze({MAIN:1,WEB_WORKER:2,SERVICE_WORKER:3});f.WEBC_RUNTIME_ENV_CODE=a}),66);
__d("WAWebWebcMemoryStatWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumWebcRuntimeEnvCode","WAWebWamEnumWebcScenarioType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({WebcMemoryStat:[1188,{chatCollectionSize:[17,a.TYPES.INTEGER],chatDbSize:[18,a.TYPES.INTEGER],contactCollectionSize:[19,a.TYPES.INTEGER],contactDbSize:[20,a.TYPES.INTEGER],isForeground:[13,a.TYPES.BOOLEAN],jsHeapSizeLimit:[9,a.TYPES.INTEGER],messageCollectionSize:[24,a.TYPES.INTEGER],messageDbSize:[25,a.TYPES.INTEGER],peakUsedJsHeapSize:[14,a.TYPES.INTEGER],scenario:[15,d("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE],totalJsHeapSize:[10,a.TYPES.INTEGER],uptime:[6,a.TYPES.NUMBER],usedJsHeapSize:[11,a.TYPES.INTEGER],usedJsHeapSizeDelta:[16,a.TYPES.INTEGER],webcRuntimeEnv:[23,d("WAWebWamEnumWebcRuntimeEnvCode").WEBC_RUNTIME_ENV_CODE]},[1,1,10],"regular"]},{WebcMemoryStat:[]});g.WebcMemoryStatWamEvent=b}),98);
__d("WAWebWamMemoryStat",["Promise","WALogger","WANullthrows","WAShiftTimer","WAWebBackendApi","WAWebLidAwareContactsDB","WAWebRuntimeEnvironmentUtils","WAWebSchemaChat","WAWebSchemaMessage","WAWebWamEnumWebcScenarioType","WAWebWebcMemoryStatWamEvent","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[MemoryStat] failed to set new scenario: ",""]);i=function(){return a};return a}var j=self.performance.now();function k(){var a;a=(a=self.performance)==null?void 0:a.memory;if(!a)return;o=Math.max(o,a.usedJSHeapSize);p+=a.usedJSHeapSize;q++;return{uptime:Math.round((self.performance.now()-j)/1e3),jsHeapSizeLimit:Math.round(a.jsHeapSizeLimit/1e3/1e3),totalJsHeapSize:Math.round(a.totalJSHeapSize/1e3/1e3),usedJsHeapSize:Math.round(a.usedJSHeapSize/1e3/1e3)}}function a(){var a=k();return!a?(h||(h=b("Promise"))).resolve():(h||(h=b("Promise"))).resolve([{label:"Main Window",memory:a.usedJsHeapSize,uptime:a.uptime}])}var l=5e3,m=60,n=d("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.IDLE,o=0,p=0,q=0,r;function e(a){try{var b;if(d("WAWebRuntimeEnvironmentUtils").isWorker()||((b=self.performance)==null?void 0:b.memory)==null)return;if(a!==n){if(n!==d("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.IDLE){(b=r)==null?void 0:b.cancel();r=null;void w();j=self.performance.now()}n=a;v()}r==null&&u()}catch(a){d("WALogger").ERROR(i(),a).sendLogs("set-memory-stat-scenario-failed",{sampling:.01})}}var s=null;function f(a){s!=null&&!s.equals(a)&&t(),s=a}function t(){if(d("WAWebRuntimeEnvironmentUtils").isWorker())return;var a=k();if(a==null)return;void B().then(function(b){var c;c=new(d("WAWebWebcMemoryStatWamEvent").WebcMemoryStatWamEvent)(babelHelpers["extends"]({},a,{scenario:d("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.CHAT_NAVIGATION,peakUsedJsHeapSize:Math.round(o/1e3/1e3),usedJsHeapSize:Math.round(p/q/1e3/1e3),isForeground:((c=self.document)==null?void 0:c.visibilityState)==="visible"},b,y));c.commit()})}function u(){r=new(d("WAShiftTimer").ShiftTimer)(function(){k(),n===d("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.IDLE&&q!==0&&q%m===0&&(void w(),v()),u()}),r.onOrAfter(l)}function v(){o=0,p=0,q=0}function w(){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a,e=(yield (h||(h=b("Promise"))).all([B(),z()])),f=e[0];e=e[1];a=new(d("WAWebWebcMemoryStatWamEvent").WebcMemoryStatWamEvent)(babelHelpers["extends"]({},c("WANullthrows")(k()),{scenario:n,peakUsedJsHeapSize:Math.round(o/1e3/1e3),usedJsHeapSize:Math.round(p/q/1e3/1e3),isForeground:((a=self.document)==null?void 0:a.visibilityState)==="visible"},f,e));a.commit()});return x.apply(this,arguments)}var y=null;function z(){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield (h||(h=b("Promise"))).all([d("WAWebSchemaChat").getChatTable().count(),c("WAWebLidAwareContactsDB").count(),d("WAWebSchemaMessage").getMessageTable().count()])),e=a[0],f=a[1];a=a[2];y={chatDbSize:D(e),contactDbSize:D(f),messageDbSize:D(a)};return y});return A.apply(this,arguments)}function B(){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebBackendApi").frontendSendAndReceive("getCollectionSizes"));return{chatCollectionSize:D(a.chat),contactCollectionSize:D(a.contact),messageCollectionSize:D(a.message)}});return C.apply(this,arguments)}function D(a){return a>1e3?Math.round(a/100)*100:Math.round(a/10)*10}g.getMemoryTableRows=a;g.setCurrentMemoryScenario=e;g.uploadMemoryIfChatWasOpened=f;g.uploadMemoryInfoOnChatClose=t}),98);
__d("WAWebCmd",["invariant","$InternalEnum","Promise","WAAbortError","WALogger","WAPromiseDelays","WAWebChatEntryPoint","WAWebComposeBoxActions","WAWebCurrentUser","WAWebDocumentFlushed","WAWebDrawerManager","WAWebEventEmitter","WAWebMsgTunnelBridge","WAWebPageLoadLogging","WAWebStateUtils","WAWebWamMemoryStat","asyncToGeneratorRuntime","err","gkx","lodash"],(function(a,b,c,d,e,f,g,h){var i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cmd: botTogglePluginSearchDetailsToggle called w/ null target id."]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cmd: offline_process_ready"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["CMD.logout debug: \n ",""],["CMD.logout debug: \\n ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unexpected scrollChatToBottom error: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unexpected_scrollToFocusedMsg error: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["openChatBottom"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["openChatFromUnread with chat unreadMsgAnchor: ",",  chat unreadCount:  ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unexpected openChat error: ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cmd: initialLoadReady"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["cmd:clearUIBusy uibusy timeout"]);s=function(){return a};return a}a=b("$InternalEnum").Mirrored(["Sender","Admin"]);e="app_state_sync_completed";var t=400;f=function(a){babelHelpers.inheritsLoose(e,a);function e(){var b,e;for(var f=arguments.length,g=new Array(f),i=0;i<f;i++)g[i]=arguments[i];return(b=e=a.call.apply(a,[this].concat(g))||this,e.isMainLoaded=!1,e.uiBusy=0,e.isMainStreamReadyMd=!1,e.isOfflineDeliveryEnd=!1,e.$CmdImpl4=c("lodash").debounce(function(){e.uiBusy&&(d("WALogger").LOG(s()),e.uiBusy=0,e.$CmdImpl5())},1e3,{maxWait:5e3}),e.$CmdImpl5=v(function(){e.uiBusy===0||h(0,75716,e.uiBusy);if(e.uiBusy!==0)return;e.$CmdImpl4.cancel();e.trigger("ui_idle")}),b)||babelHelpers.assertThisInitialized(e)}var f=e.prototype;f.mainLoaded=function(){this.isMainLoaded=!0,this.trigger("main_loaded")};f.initialLoadReady=function(){d("WALogger").LOG(r()),this.trigger("initial_load_ready")};f.logSocketSummary=function(){this.trigger("log_socket_summary")};f.muteAll=function(a,b,c,d){this.trigger("mute_all",a,b,c,d)};f.muteChat=function(a,b,c){this.trigger("mute_chat",d("WAWebStateUtils").unproxy(a),b,c)};f.muteChatMultiselect=function(a,b,c){this.trigger("mute_chat_multiselect",a,b,c)};f.muteChatFromEntryPoint=function(a,b,c,e){this.trigger("mute_chat_from_entrypoint",d("WAWebStateUtils").unproxy(a),b,c,e)};f.assignChat=function(a,b){this.trigger("assign_chat",d("WAWebStateUtils").unproxy(a),b)};f.deleteOrExitChat=function(a,b){this.trigger("delete_or_exit_chat",d("WAWebStateUtils").unproxy(a),b)};f.deleteOrExitChatFromEntryPoint=function(a,b,c){this.trigger("delete_or_exit_chat_from_entrypoint",d("WAWebStateUtils").unproxy(a),b,c)};f.clearChat=function(a,b){this.trigger("clear_chat",d("WAWebStateUtils").unproxy(a),b)};f.archiveChat=function(a,b,c){c===void 0&&(c=!0),this.trigger("archive_chat",d("WAWebStateUtils").unproxy(a),b,c)};f.archiveChatFromEntryPoint=function(a,b,c,e){e===void 0&&(e=!0),this.trigger("archive_chat_from_entrypoint",d("WAWebStateUtils").unproxy(a),b,c,e)};f.pinChat=function(a,b){this.trigger("pin_chat",d("WAWebStateUtils").unproxy(a),b)};f.favoriteChat=function(a,b,c){this.trigger("favorite_chat",d("WAWebStateUtils").unproxy(a),b,c)};f.markChatUnread=function(a,b){this.trigger("mark_chat_unread",d("WAWebStateUtils").unproxy(a),b)};f.msgInfoDrawer=function(a){this.trigger("msg_info_drawer",d("WAWebStateUtils").unproxy(a))};f.chatSearch=function(a){this.trigger("chat_search",d("WAWebStateUtils").unproxy(a))};f.scrollChatHeight=function(a){this.trigger("scroll_chat_by_height",a)};f.chatInfoDrawer=function(a,b){this.trigger("chat_info_drawer",d("WAWebStateUtils").unproxy(a),b==null?void 0:b.showFullGroupDescription,b==null?void 0:b.scrollToParticipantList,b==null?void 0:b.sourceGroupChatOrNewsletter,b==null?void 0:b.focusNewsletterDescriptionOnMount,b==null?void 0:b.focusGroupSubjectOnMount,b==null?void 0:b.focusGroupDescriptionOnMount)};f.editGroupDescription=function(){this.trigger("edit_group_description")};f.attachMediaDrawer=function(a){var b=d("WAWebStateUtils").unproxy(a.chat),c=function(c){c.length>0&&d("WAWebComposeBoxActions").ComposeBoxActions.setTextContent(b,c.join("\n\n")),a.onCancel==null?void 0:a.onCancel()};if(b.id.isBot())return;c=babelHelpers["extends"]({},a,{chat:b,onCancel:c});this.trigger("attach_media_drawer",c)};f.attachProduct=function(a){this.trigger("attach_product",a)};f.verificationDrawer=function(a){this.trigger("verification_drawer",a)};f.mediaViewerModal=function(a){var b=a.msg,c=a.getZoomNode,d=a.currentTime;a=a.highlightedMsgIds;this.trigger("media_viewer_modal",{msg:b,getZoomNode:c,currentTime:d,highlightedMsgIds:a})};f.openMediaViewerForAlbumMedia=function(a){this.trigger("open_media_viewer_for_album_media",a)};f.productImageViewerModal=function(a,b){this.trigger("product_image_viewer_modal",a,b)};f.ephemeralDrawer=function(a,b,c){this.trigger("ephemeral_drawer",a,b,c)};f.openCommunityHome=function(a,b){this.trigger("open_community_home",a,b)};f.openCommunityTabbedInfo=function(a,b,c,d){this.trigger("open_community_tabbed_info",a,b,c,d)};f.openCommunityPendingGroupsDrawer=function(a){this.trigger("open_community_pending_groups_drawer",a)};f.openCommunityHomeManageGroups=function(a){this.trigger("open_community_home_manage_groups",a)};f.openCommunitySettingsDrawer=function(a){this.trigger("open_community_settings_drawer",a)};f.openCommunitySubgroupJoinModal=function(a,b){this.trigger("open_subgroup_join_modal",a,b)};f.openProfile=function(a){this.trigger("open_profile",a)};f.communityAddNewGroup=function(a,b,c){this.trigger("open_community_add_new_group",a,b,c)};f.openCreatedNewsletter=function(a){this.trigger("open_created_newsletter",a)};f.openNewsletterProfile=function(a,b){this.trigger("open_newsletter_profile",a,b)};f.editNewsletterDescription=function(){this.trigger("edit_newsletter_description")};f.openEventInfoDrawer=function(a,b,c,d){this.trigger("open_event_info_drawer",a,b,c,d)};f.sendStarMsgs=function(a,b,c,e){this.trigger("send_star_msgs",d("WAWebStateUtils").unproxy(a),b,c,e)};f.sendUnstarMsgs=function(a,b,c,e){this.trigger("send_unstar_msgs",d("WAWebStateUtils").unproxy(a),b,c,e)};f.sendDeleteMsgs=function(a,b,c,e,f){this.trigger("send_delete_msgs",d("WAWebStateUtils").unproxy(a),b,c,e,f)};f.sendRevokeMsgs=function(a,b,c){this.trigger("send_revoke_msgs",d("WAWebStateUtils").unproxy(a),b,c)};f.$CmdImpl1=function(a,c,e){var f=this;e===void 0&&(e=d("WAWebChatEntryPoint").ChatEntryPoint.Unknown);var g=d("WAWebStateUtils").unproxy(a);g.chatEntryPoint=e;d("WAWebMsgTunnelBridge").msgSyncTunnelBridge.setActiveChat(g.id);d("WAWebWamMemoryStat").uploadMemoryIfChatWasOpened(g.id);return new(i||(i=b("Promise")))(function(a){f.trigger("open_chat",g,c,e,function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){(yield d("WAWebDrawerManager").DrawerManager.isDrawerRightOverlappingCoversationPanel())&&d("WAWebDrawerManager").DrawerManager.closeDrawerRight(),a(b)});return function(a){return c.apply(this,arguments)}}())})["catch"](function(a){d("WALogger").LOG(q(),String(a));throw a})};f.openChatAt=function(a){var c=this,e=a.chat,f=a.msgContext,g=a.chatEntryPoint,h=a.onSuccess;a=d("WAWebStateUtils").unproxy(e);if(!f)return this.openChatBottom(a,g);this.setUiBusy(!0);e=this.$CmdImpl1(a,f,g).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var d,e,g=f.enableAnimation!=null?f.enableAnimation:!0;if(a)if(a.wasVisible)d=function(){return c.$CmdImpl2({pos:"offset",offset:a.offset})},e=function(){return c.$CmdImpl2({pos:"center",animate:g,duration:t,easing:[.7,0,.3,1]})};else{d=function(){return c.$CmdImpl2({pos:a.alignAt,scrollIfNeeded:!0})};switch(a.alignAt){case"top":case"bottom":e=function(){return c.$CmdImpl2({pos:"center",animate:g,duration:t,easing:[.88,.64,.13,.99]})};break;case"center":default:e=function(){return(i||(i=b("Promise"))).resolve()}}}else d=function(){return c.$CmdImpl2({pos:"center"})},e=function(){return(i||(i=b("Promise"))).resolve()};yield d();return e()});return function(b){return a.apply(this,arguments)}}()).then(function(){var a;if((f==null?void 0:(a=f.msg)==null?void 0:a.botPluginReferenceIndex)!=null){a=f==null?void 0:(a=f.msg)==null?void 0:a.botResponseTargetId;a!=null&&c.botTogglePluginSearchDetailsToggle(a,!0)}(f==null?void 0:f.highlightMsg)===!0&&c.flashFocusedMsg(f.highlightMentionMsg)}).then(function(){if(h){var a=h.mediaMsgToOpenInMediaViewer,b=h.onScrollToQuotedCarouselCard;a&&void d("WAPromiseDelays").delayMs(500).then(function(){u.openMediaViewerForAlbumMedia(d("WAWebStateUtils").unproxy(a)),b==null?void 0:b()})}return!0})["catch"](d("WAAbortError").catchAbort(function(){return!1}));e["finally"](function(){c.setUiBusy(!1)});return e};f.openChatFromUnread=function(a,e){var f=this;a=d("WAWebStateUtils").unproxy(a);if(!c("gkx")("26258")){window.chat=a;var g=a.unreadMsgAnchor&&a.unreadMsgAnchor.id.toString()||"No unreadMsgAnchor found";d("WALogger").LOG(p(),g,a.unreadCount)}var h;a.unreadMsgAnchor&&(h={collection:a.unreadMsgAnchor.msgChunk,promise:(i||(i=b("Promise"))).resolve(),msg:a.unreadMsgAnchor,isUnreadDivider:a.shouldShowUnreadDivider});if(h||a.unreadCount>0){this.setUiBusy(!0);g=this.$CmdImpl1(a,h,e).then(function(){return f.$CmdImpl2({pos:"top",offset:-120})}).then(function(){return!0})["catch"](d("WAAbortError").catchAbort(function(){return!1}));g["finally"](function(){f.setUiBusy(!1)});return g}return this.openChatBottom(a,e)};f.openChatBottom=function(a,b){var e=this;a=d("WAWebStateUtils").unproxy(a);c("gkx")("26258")||d("WALogger").LOG(o());this.setUiBusy(!0);var f;a.msgs.length>0&&(f={collection:a.msgs,msg:a.msgs.last(),isUnreadDivider:!1});a=this.$CmdImpl1(a,f,b).then(function(){return e.$CmdImpl3()}).then(function(){return!0})["catch"](d("WAAbortError").catchAbort(function(){return!1}));a["finally"](function(){e.setUiBusy(!1)});return a};f.$CmdImpl2=function(a){var c=this;return new(i||(i=b("Promise")))(function(b){c.trigger("scroll_to_focused_msg",b,a)})["catch"](function(a){d("WALogger").WARN(n(),String(a))})};f.$CmdImpl3=function(){var a=this;return new(i||(i=b("Promise")))(function(b){a.trigger("scroll_chat_to_bottom",b)})["catch"](function(a){d("WALogger").WARN(m(),String(a))})};f.scrollToActiveChat=function(){this.trigger("scroll_to_active_chat")};f.flashFocusedMsg=function(a){var b=this;self.setTimeout(function(){b.trigger("flash_focused_msg"),a&&b.trigger("flash_mention_msg")},0)};f.setActiveNavBarItem=function(a){this.trigger("set_active_nav_bar",a)};f.setActiveFilter=function(a,b,c){this.trigger("set_active_filter",a,b,c)};f.updateChatlistSelection=function(a){a=d("WAWebStateUtils").unproxy(a);this.trigger("update_chatlist_selection",a)};f.closeChat=function(a){a=d("WAWebStateUtils").unproxy(a);this.trigger("close_chat",a);d("WAWebWamMemoryStat").uploadMemoryInfoOnChatClose();d("WAWebMsgTunnelBridge").msgSyncTunnelBridge.resetActiveChat(a.id)};f.focusNextChat=function(a){this.trigger("focus_next_chat",a)};f.focusPrevChat=function(a){this.trigger("focus_prev_chat",a)};f.focusChatSearch=function(){this.trigger("focus_chat_search")};f.closeStatusViewer=function(){this.trigger("close_status_viewer")};f.openComposeBoxExpressionPanel=function(a){this.trigger("open_compose_box_panel",a)};f.closeExpressionPanels=function(){this.trigger("close_expression_panels")};f.logout=function(){if(!c("gkx")("26258"))try{throw c("err")("Non Error - CMD logout, thrown only for getting logout stack trace")}catch(a){a instanceof Error&&d("WALogger").LOG(l(),a.stack).verbose()}this.trigger("logout")};f.openContextMenu=function(a,b){this.trigger("open_context_menu",a,b)};f.closeContextMenu=function(a){this.trigger("close_context_menu",a)};f.openTooltip=function(a,b){this.trigger("open_tooltip",a,b)};f.closeTooltip=function(a){this.trigger("close_tooltip",a)};f.alertNewMsg=function(a){this.trigger("alert_new_msg",a)};f.newMediaMsg=function(a){this.trigger("new_media_msg",a)};f.alertCall=function(a,b,c,d,e){this.trigger("alert_call",{wid:a,msgId:b,isVideo:c,isGroup:d,isSilenced:e})};f.cancelCall=function(a){this.trigger("cancel_call",a)};f.windowError=function(a){c("gkx")("26258")||this.trigger("window_error",a)};f.onPanesWillChange=function(a){this.trigger("panes_will_change",a)};f.onPanesDidChange=function(a){this.trigger("panes_did_change",a)};f.reactionChangeLastMessage=function(){this.trigger("reaction_changed_last_msg")};f.openGroupsV4InviteRequestFlow=function(a,b,c,d){this.trigger("open_groups_v4_invite_request_flow",a,b,c,d)};f.toggleLidDebugBadge=function(){this.trigger("toggle_lid_debug_badge")};f.openCommandPalette=function(){this.trigger("open_command_palette")};f.closeCommandPalette=function(){this.trigger("close_command_palette")};f.setUiBusy=function(a){var b=this.uiBusy||0;a?(++b,this.$CmdImpl4(),this.$CmdImpl5.cancel()):b&&--b;this.uiBusy=b;b===0&&(this.$CmdImpl4.cancel(),this.$CmdImpl5())};f.windowMouseDown=function(a){this.trigger("window_mousedown",a)};f.windowClick=function(a){this.trigger("window_click",a)};f.midnight=function(){this.trigger("midnight")};f.serverUpdatedClientExpiration=function(){this.trigger("serverUpdatedClientExpiration")};f.scrollMessages=function(){this.trigger("scroll_messages")};f.getConversationHeaderOffset=function(a){this.trigger("get_conversation_header_offset",a)};f.floaterEscapeOverlap=function(a,b){this.trigger("floater_escape_overlap",a,b)};f.refreshMessages=function(){this.trigger("refresh_messages")};f.storageInitializationError=function(){this.trigger("storage_initialization_error")};f.editGroupSubject=function(){this.trigger("edit_group_subject")};f.endFlow=function(){this.trigger("end_flow")};f.refreshQR=function(){this.trigger("md_refresh_qr")};f.setSocketState=function(a){this.trigger("set_socket_state",a)};f.socketStreamDisconnected=function(){this.trigger("socket_stream_disconnected")};f.openSocketStream=function(){this.trigger("open_socket_stream")};f.reconnectSocket=function(){this.trigger("reconnect_socket")};f.openLongLinkModal=function(){this.trigger("open_long_link_modal")};f.closeLongLinkModal=function(a){a===void 0&&(a=!1),this.trigger("close_long_link_modal",a)};f.openLockScreenModal=function(){this.trigger("open_lock_screen_modal")};f.correctPasscodeLockScreen=function(a){this.trigger("correct_passcode_lock_screen",a)};f.incorrectPasscodeLockScreen=function(){this.trigger("incorrect_passcode_lock_screen")};f.offlineDeliveryEnd=function(){this.isOfflineDeliveryEnd=!0,this.trigger("offline_delivery_end")};f.resetOfflineDeliveryState=function(){this.isOfflineDeliveryEnd=!1,this.trigger("offline_delivery_state_reset")};f.readyForProcessOffline=function(){d("WALogger").LOG(k()),this.trigger("offline_process_ready")};f.readyForMainStreamMode=function(){d("WAWebPageLoadLogging").addPageLoadQplPoint("main_stream_mode_ready"),this.isMainStreamReadyMd=!0,this.trigger("main_stream_mode_ready")};f.onInitialChatHistorySynced=function(){this.trigger("on_initial_chat_synced")};f.onRecentChatHistorySynced=function(){this.trigger("on_recent_chat_history_synced")};f.onFullChatHistorySynced=function(){this.trigger("on_full_chat_history_synced")};f.onHistorySyncChunkProcessed=function(a){this.trigger("new_history_sync_chunk_processed",a)};f.handleOfflineProgressUpdate=function(){this.trigger("offline_progress_update")};f.criticalSyncDone=function(){this.trigger("on_critical_sync_done")};f.onTemporaryBan=function(a){this.trigger("account_temporarily_banned",a)};f.onStartingLogout=function(){this.trigger("starting_logout")};f.showServiceUnavailableError=function(){this.trigger("service_unavailable_503")};f.merchantDetailsDrawer=function(a){this.trigger("merchant_details_drawer",a)};f.showMerchantDetailsEntityTypePopup=function(a,b){this.trigger("show_merchant_details_entity_type_popup",a,b)};f.showCountrySelector=function(a,b,c,d){this.trigger("show_country_selector_popup",a,b,c,d)};f.toggleStickerMaker=function(){this.trigger("toggle_sticker_maker")};f.onAccountSyncForPrivacy=function(a){this.trigger("account_sync_for_privacy",a)};f.updateStatusPrivacySettings=function(a){this.trigger("update_status_privacy_settings",a)};f.openStickerPack=function(a){this.trigger("open_sticker_pack",a)};f.onStatusViewerOpen=function(){this.trigger("status_viewer_open")};f.onStatusPostingFlow=function(){this.trigger("status_posting_flow")};f.triggerStorageAlert=function(){c("gkx")("26258")||this.trigger("handle_low_storage_butter_bar")};f.triggerBugReportV2=function(){d("WAWebCurrentUser").isEmployee()&&this.trigger("trigger_bugreport_v2")};f.onAbPropsUpdate=function(a){this.trigger("on_ab_props_update",a)};f.abPropsLoaded=function(){this.trigger("ab_props_loaded")};f.onNotificationPermissionChange=function(){this.trigger("on_notification_permission_change")};f.onBrigadingStateChange=function(a){this.trigger("on_brigading_state_change",a)};f.playNextPtv=function(a){this.trigger("sequential_ptv_playback",a)};f.groupNotificationContextCardRendered=function(a){this.trigger("group_notification_context_card_rendered",a)};f.botTogglePluginSearchDetailsToggle=function(a,b){if(a==null){d("WALogger").WARN(j());return}this.trigger("bot_toggle_plugin_search_details_for_target_id_"+a,b)};f.rerenderApp=function(){this.trigger("rerender_app")};return e}(c("WAWebEventEmitter"));var u=new f();function v(a){var b,c=function(){if(b)return;b=new AbortController();var c=b,e=c.signal;d("WAWebDocumentFlushed").documentFlushed({signal:e}).then(function(){if(e.aborted)return;b=null;a()},function(a){if(a instanceof Error&&a.name===d("WAAbortError").ABORT_ERROR)return;throw a})};c.cancel=function(){if(!b)return;b.abort();b=null};return c}g.Revoke=a;g.APP_STATE_SYNC_COMPLETED=e;g.CmdImpl=f;g.Cmd=u}),98);
__d("WAWebContactManagementGating",["WAWebABProps","WAWebPrimaryFeatures"],(function(a,b,c,d,e,f,g){function a(){return h()&&i()}function h(){return d("WAWebPrimaryFeatures").primaryFeatureEnabled("companion_contact_change_enabled")}function i(){return d("WAWebABProps").getABPropConfigValue("native_contact_companion_change_enabled")}function b(){var a=Number.parseInt(d("WAWebABProps").getABPropConfigValue("native_contact_companion_nux_learn_more_article_id"),10);Number.isNaN(a)&&(a=1191526044909364);return a}g.contactManagementEnabled=a;g.getNativeContactLearnMoreArticleId=b}),98);
__d("WAWebFaqUrl",["WAWebBizGatingUtils","WAWebContactManagementGating","WAWebL10N"],(function(a,b,c,d,e,f,g){var h="https://faq.whatsapp.com",i="web";function j(a){return h+"/"+a+"?lang="+c("WAWebL10N").getNormalizedLocale()}function a(){return h+"/"+i+"?lang="+c("WAWebL10N").getNormalizedLocale()}function b(){return j(2138577903196467)}function e(){return j(6480469855345352)}function f(){return j(643460927283235)}function k(){return j(852892549070029)}function l(){return j(3398056720476987)}function m(){return j(835452491239734)}function n(){return j(1524220618005378)}function o(){return j(820124435853543)}function p(){return j(820124435853543)}function q(){return j(1148840052398648)}function r(){return j(1293093778117781)}function s(){return j(1053543185312573)}function t(){return j(1110600769849613)}function u(){return j(1317564962315842)}function v(){return j(677428350267326)}function w(){return j(819881299156447)}function x(){return j(531205362155587)}function y(){return j(2322556321235831)}function z(){return j(1130443730921732)}function A(){return j(807378207138241)}function B(){return j(1370476507114859)}function C(){return j(393169153028916)}function D(){return j(806293963922749)}function E(){return j(794517045178057)}function F(){return j(3872729742954601)}function G(){return j(1074237659908080)}function H(){return j(673193694148537)}function I(){return j(728928448599090)}function J(){return j(1077018839582332)}function K(){return j(676672070766141)}function L(){return j(854037192262196)}function M(){return j(1184376605821468)}function N(){return j(570221114584995)}function O(){return j(366296225670044)}function P(){return j(625069579217642)}function Q(){return j(812356880201038)}function R(){return j(2234976186844686)}function S(){return j(1317564962315842)}function T(){return j(1324084875126592)}function U(){return j(832060577920049)}function V(){return j(821275555582352)}function W(){return j(498814665492149)}function X(){return j(1874151452788882)}function Y(){return j(2917597651792702)}function Z(){return j(626403979060997)}function $(){return j(831150864932965)}function aa(){return j(138730494968892)}function ba(){return j(6614640168569481)}function ca(){return j(1549633222110625)}function da(){return j(231869526393268)}function ea(){return j(671443411431514)}function fa(){return j(1318001139066835)}function ga(){return j(245599461477281)}function ha(){return j(682987820062997)}function ia(){return j(1446688872845683)}function ja(){return j(652713330395407)}function ka(){return j(205306122327447)}function la(){return j(919039336073667)}function ma(){return j(673193694148537)}function na(){return j(1313491802751163)}function oa(){return j(422435220869520)}function pa(){return j(1726618467788240)}function qa(){return j(653480766448040)}function ra(){return j(526463418847093)}function sa(){return j(1262764931172994)}function ta(){return"https://www.facebook.com/privacy/policy"}function ua(){return"https://www.facebook.com/policies/other-policies/ais-terms"}function va(){return j(1111412106858632)}function wa(){return j(6485307734928964)}function xa(){var a=d("WAWebBizGatingUtils").isUpdatedConsumerDisclosureUiRowEnabled()||d("WAWebBizGatingUtils").isUpdatedConsumerDisclosureUiIndiaEnabled();return j(a?6485307734928964:1270536656989145)}function ya(){return j(332114409462050)}function za(){return j(306908962283012)}function Aa(){return j(785493319976156)}function Ba(){return j(704225315054890)}function Ca(){return j(835833917556304)}function Da(){return j(434854355461483)}function Ea(){return j(1314318822729539)}function Fa(){return j(1083092416402722)}function Ga(){return j(360977646301595)}function Ha(){return j(684323127185056)}function Ia(){return j(1520500555178162)}function Ja(){return j(414631957536067)}function Ka(){return j(445453537819972)}function La(){return j(764072925284841)}function Ma(){return j(515115256843064)}function Na(){return j(d("WAWebContactManagementGating").getNativeContactLearnMoreArticleId())}function Oa(){return j(3379690015658337)}function Pa(){return j(2127363544304650)}function Qa(){return j(1889908094810167)}function Ra(){return j(1791149784551042)}g.FAQ_BASE_URL=h;g.PLATFORM=i;g.getFaqUrl=a;g.getDeleteAccountUrl=b;g.getNewsletterActivityInforUrl=e;g.getBusinessFaqUrl=f;g.getCannotConnectFaqUrl=k;g.getCiphertextFaqUrl=l;g.getFanoutPlaceholderFaqUrl=m;g.getCodeChangeFaqUrl=n;g.getMDCodeChangeFaqUrl=o;g.getE2EFaqUrl=p;g.getE2EEnterpriseFaqUrl=q;g.getWAChatFaqUrl=r;g.getFrequentlyForwardedFaqUrl=s;g.getMembershipApprovalModeFaqUrl=t;g.getLoginFaqUrl=u;g.getNonVerifiedTransitionFaqUrl=v;g.getNotificationChromeFaqUrl=w;g.getNotificationEdgeFaqUrl=x;g.getNotificationFirefoxFaqUrl=y;g.getNotificationOperaFaqUrl=z;g.getNotificationSafariFaqUrl=A;g.getRevokeFaqUrl=B;g.getSuspiciousLinkFaqUrl=C;g.getUnverifiedTransitionFaqUrl=D;g.getVerifiedHighFaqUrl=E;g.getBlueFaqUrl=F;g.getVerifiedLowUnknownFaqUrl=G;g.getEphemeralFaqUrl=H;g.getKICFaqUrl=I;g.getViewOnceFaqUrl=J;g.getSupportChatFaqUrl=K;g.getSupportChatSafetyFaqUrl=L;g.getCatalogCartOnOffFaqUrl=M;g.getCommunityHomeNuxUrl=N;g.getExitCommunityUrl=O;g.getCommunityCreatorPrivacyUrl=P;g.getCommunityMemberPrivacyUrl=Q;g.getCommunityBecomingOwnerUrl=R;g.getLinkDeviceFaqUrl=S;g.getLinkDeviceUsingPhoneNumberFaqUrl=T;g.getJioMartPostcodeChangeLearnMoreLink=U;g.getDBErrorFaqUrl=V;g.getHowToExitAndDeleteGroupsFaq=W;g.getRemoveFromCommunityFaqUrl=X;g.getViewOnceScreenshotProtectionUrl=Y;g.getPhoneNumberHidingFaqUrl=Z;g.getCagPhoneNumberHidingFaqUrl=$;g.getControlsWhenMessagingBusinessFaqUrl=aa;g.getMessageEditFaqUrl=ba;g.getNewsletterUpdateEditFaqUrl=ca;g.getAboutCommunitiesFaqUrl=da;g.getNewsletterPrivacyLegacyFaqUrl=ea;g.getNewsletterPrivacyMultiAdminFaqUrl=fa;g.getNewsletterGuidelinesFaqUrl=ga;g.getNewsletterGeosuspendFaqUrl=ha;g.getNewsletterMetricsEstimatedFaqUrl=ia;g.getNewsletterMetricsUnavailableFaqUrl=ja;g.getMemberAddedGroupsUrl=ka;g.getReportToAdminFaqUrl=la;g.getOrderEphemeralExemptionUrl=ma;g.getSafetyToolsFaqUrl=na;g.getSearchTheWebFaqUrl=oa;g.getScreenLockLearnMoreUrl=pa;g.getMessageHistoryOnLinkedDevicesFAQUrl=qa;g.getRequestAccountInfoFAQUrl=ra;g.getIndiaEcommerceComplianceFaqUrl=sa;g.getBotPrivacyPolicyUrl=ta;g.getBotTermsUrl=ua;g.getBotLearnMoreUrl=va;g.getBizBot1pLearnMoreUrl=wa;g.getBizBotTosLearnMoreUrl=xa;g.getBizBot3pLearnMoreUrl=ya;g.getBizBot3pDataSharingUrl=za;g.getConsumerTransparencyHCAUrl=Aa;g.getAvatarFaqUrl=Ba;g.getWhatsAppBusinessPremiumFaqUrl=Ca;g.getSharingBusinessInfoForAdsFaqUrl=Da;g.getFbShopsSunsetFaqUrl=Ea;g.getSagaFaqUrl=Fa;g.getNewsletterAdminInviteFaqUrlV2=Ga;g.getReportUnlawfulContentWebFormUrl=Ha;g.getCoexHostedFaqUrl=Ia;g.getBlockingReportingFaqUrl=Ja;g.getDisableLinkPreviewsFaqUrl=Ka;g.getChatLockSecretCodeFaqUrl=La;g.getAccountTakeOverFaqUrl=Ma;g.getNativeContactLearnMoreFaqUrl=Na;g.getAntiBrigadingFaqUrl=Oa;g.getEventsLearnMoreFaqUrl=Pa;g.getCommunityGroupsVisibilityFaqUrl=Qa;g.getBizQuickRepliesFaqUrl=Ra}),98);